# Comparing `tmp/Ais-cryoET-1.0.24.tar.gz` & `tmp/Ais-cryoET-1.0.25.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "Ais-cryoET-1.0.24.tar", last modified: Wed May  1 07:35:45 2024, max compression
+gzip compressed data, was "Ais-cryoET-1.0.25.tar", last modified: Thu May 30 15:06:40 2024, max compression
```

## Comparing `Ais-cryoET-1.0.24.tar` & `Ais-cryoET-1.0.25.tar`

### file list

```diff
@@ -1,77 +1,77 @@
-drwxrwxrwx   0        0        0        0 2024-05-01 07:35:45.539061 Ais-cryoET-1.0.24/
-drwxrwxrwx   0        0        0        0 2024-05-01 07:35:45.259590 Ais-cryoET-1.0.24/Ais/
--rw-rw-rw-   0        0        0    36025 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.24/Ais/LICENSE.txt
--rw-rw-rw-   0        0        0        0 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.24/Ais/__init__.py
-drwxrwxrwx   0        0        0        0 2024-05-01 07:35:45.371909 Ais-cryoET-1.0.24/Ais/core/
--rw-rw-rw-   0        0        0        0 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.24/Ais/core/__init__.py
--rw-rw-rw-   0        0        0     5069 2024-05-01 07:35:39.000000 Ais-cryoET-1.0.24/Ais/core/config.py
--rw-rw-rw-   0        0        0     1637 2024-01-02 08:48:51.000000 Ais-cryoET-1.0.24/Ais/core/extract.py
--rw-rw-rw-   0        0        0     2640 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.24/Ais/core/open_in_blender.py
--rw-rw-rw-   0        0        0      625 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.24/Ais/core/open_in_chimerax.py
--rw-rw-rw-   0        0        0    17600 2023-12-13 11:43:47.000000 Ais-cryoET-1.0.24/Ais/core/opengl_classes.py
--rw-rw-rw-   0        0        0    33047 2024-04-15 16:00:16.000000 Ais-cryoET-1.0.24/Ais/core/se_frame.py
--rw-rw-rw-   0        0        0    24255 2024-03-26 11:05:39.000000 Ais-cryoET-1.0.24/Ais/core/se_model.py
--rw-rw-rw-   0        0        0   192280 2024-03-28 11:17:34.000000 Ais-cryoET-1.0.24/Ais/core/segmentation_editor.py
--rw-rw-rw-   0        0        0      331 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.24/Ais/core/settings.py
--rw-rw-rw-   0        0        0      130 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.24/Ais/core/settings.txt
--rw-rw-rw-   0        0        0       98 2024-01-02 10:33:08.000000 Ais-cryoET-1.0.24/Ais/core/start.py
--rw-rw-rw-   0        0        0    22298 2024-03-28 11:18:29.000000 Ais-cryoET-1.0.24/Ais/core/util.py
--rw-rw-rw-   0        0        0     2572 2023-12-21 15:04:18.000000 Ais-cryoET-1.0.24/Ais/core/widgets.py
--rw-rw-rw-   0        0        0     7961 2024-05-01 07:34:37.000000 Ais-cryoET-1.0.24/Ais/core/window.py
-drwxrwxrwx   0        0        0        0 2024-05-01 07:35:45.423770 Ais-cryoET-1.0.24/Ais/icons/
--rw-rw-rw-   0        0        0  1098617 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.24/Ais/icons/LOGO_Pom_1024.png
--rw-rw-rw-   0        0        0    19430 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.24/Ais/icons/LOGO_Pom_128.png
--rw-rw-rw-   0        0        0  2960366 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.24/Ais/icons/LOGO_Pom_2048.png
--rw-rw-rw-   0        0        0   134990 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.24/Ais/icons/LOGO_Pom_256.png
--rw-rw-rw-   0        0        0   401274 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.24/Ais/icons/LOGO_Pom_512.png
--rw-rw-rw-   0        0        0        0 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.24/Ais/icons/__init__.py
--rw-rw-rw-   0        0        0     8843 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.24/Ais/icons/icon_blender_256.png
--rw-rw-rw-   0        0        0    30131 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.24/Ais/icons/icon_chimerax_256.png
--rw-rw-rw-   0        0        0     1563 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.24/Ais/icons/icon_close_256.png
--rw-rw-rw-   0        0        0      954 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.24/Ais/icons/icon_crop_256.png
--rw-rw-rw-   0        0        0     5113 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.24/Ais/icons/icon_obj_256.png
--rw-rw-rw-   0        0        0      784 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.24/Ais/icons/icon_stop_256.png
--rw-rw-rw-   0        0        0     2001 2024-01-02 08:48:51.000000 Ais-cryoET-1.0.24/Ais/main.py
-drwxrwxrwx   0        0        0        0 2024-05-01 07:35:45.471504 Ais-cryoET-1.0.24/Ais/models/
--rw-rw-rw-   0        0        0       15 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.24/Ais/models/__init__.py
--rw-rw-rw-   0        0        0      819 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.24/Ais/models/eman2.py
--rw-rw-rw-   0        0        0     1359 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.24/Ais/models/inceptionnet.py
--rw-rw-rw-   0        0        0     2149 2024-02-06 08:17:58.000000 Ais-cryoET-1.0.24/Ais/models/model_template.py
--rw-rw-rw-   0        0        0     7759 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.24/Ais/models/pix2pix.py
--rw-rw-rw-   0        0        0     1562 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.24/Ais/models/resnet.py
--rw-rw-rw-   0        0        0     1166 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.24/Ais/models/unet_deep.py
--rw-rw-rw-   0        0        0      973 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.24/Ais/models/unet_dropout.py
--rw-rw-rw-   0        0        0      889 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.24/Ais/models/unet_lite.py
--rw-rw-rw-   0        0        0     1559 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.24/Ais/models/vggnet.py
--rw-rw-rw-   0        0        0     1568 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.24/Ais/models/vggnet_plus.py
--rw-rw-rw-   0        0        0      207 2024-01-02 08:48:52.000000 Ais-cryoET-1.0.24/Ais/requirements.txt
-drwxrwxrwx   0        0        0        0 2024-05-01 07:35:45.522431 Ais-cryoET-1.0.24/Ais/shaders/
--rw-rw-rw-   0        0        0        0 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.24/Ais/shaders/__init__.py
--rw-rw-rw-   0        0        0      372 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.24/Ais/shaders/ce_line_shader.glsl
--rw-rw-rw-   0        0        0      725 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.24/Ais/shaders/se_binary_segmentation_shader.glsl
--rw-rw-rw-   0        0        0      424 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.24/Ais/shaders/se_border_shader.glsl
--rw-rw-rw-   0        0        0      929 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.24/Ais/shaders/se_compute_kernel_filter.glsl
--rw-rw-rw-   0        0        0      808 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.24/Ais/shaders/se_compute_mix.glsl
--rw-rw-rw-   0        0        0      487 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.24/Ais/shaders/se_depth_mask_shader.glsl
--rw-rw-rw-   0        0        0      696 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.24/Ais/shaders/se_float_segmentation_shader.glsl
--rw-rw-rw-   0        0        0      649 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.24/Ais/shaders/se_icon_shader.glsl
--rw-rw-rw-   0        0        0      286 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.24/Ais/shaders/se_line_3d_shader.glsl
--rw-rw-rw-   0        0        0      449 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.24/Ais/shaders/se_overlay_blend_shader.glsl
--rw-rw-rw-   0        0        0     3359 2023-11-30 12:28:22.000000 Ais-cryoET-1.0.24/Ais/shaders/se_overlay_ray_trace_shader.glsl
--rw-rw-rw-   0        0        0     1188 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.24/Ais/shaders/se_overlay_shader.glsl
--rw-rw-rw-   0        0        0      454 2024-01-02 13:56:12.000000 Ais-cryoET-1.0.24/Ais/shaders/se_particle_shader.glsl
--rw-rw-rw-   0        0        0      827 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.24/Ais/shaders/se_quad_3d_shader.glsl
--rw-rw-rw-   0        0        0     1019 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.24/Ais/shaders/se_quad_shader.glsl
--rw-rw-rw-   0        0        0     1950 2023-12-03 15:17:59.000000 Ais-cryoET-1.0.24/Ais/shaders/se_surface_model_shader.glsl
-drwxrwxrwx   0        0        0        0 2024-05-01 07:35:45.523436 Ais-cryoET-1.0.24/Ais_cryoET.egg-info/
--rw-rw-rw-   0        0        0     5068 2024-05-01 07:35:44.000000 Ais-cryoET-1.0.24/Ais_cryoET.egg-info/PKG-INFO
--rw-rw-rw-   0        0        0     1861 2024-05-01 07:35:44.000000 Ais-cryoET-1.0.24/Ais_cryoET.egg-info/SOURCES.txt
--rw-rw-rw-   0        0        0        1 2024-05-01 07:35:44.000000 Ais-cryoET-1.0.24/Ais_cryoET.egg-info/dependency_links.txt
--rw-rw-rw-   0        0        0       66 2024-05-01 07:35:44.000000 Ais-cryoET-1.0.24/Ais_cryoET.egg-info/entry_points.txt
--rw-rw-rw-   0        0        0      196 2024-05-01 07:35:44.000000 Ais-cryoET-1.0.24/Ais_cryoET.egg-info/requires.txt
--rw-rw-rw-   0        0        0        4 2024-05-01 07:35:44.000000 Ais-cryoET-1.0.24/Ais_cryoET.egg-info/top_level.txt
--rw-rw-rw-   0        0        0      108 2023-10-23 08:03:57.000000 Ais-cryoET-1.0.24/MANIFEST.in
--rw-rw-rw-   0        0        0     5068 2024-05-01 07:35:45.523436 Ais-cryoET-1.0.24/PKG-INFO
--rw-rw-rw-   0        0        0     4706 2023-12-14 16:04:51.000000 Ais-cryoET-1.0.24/README.md
--rw-rw-rw-   0        0        0       42 2024-05-01 07:35:45.539061 Ais-cryoET-1.0.24/setup.cfg
--rw-rw-rw-   0        0        0     1396 2024-05-01 07:35:39.000000 Ais-cryoET-1.0.24/setup.py
+drwxrwxrwx   0        0        0        0 2024-05-30 15:06:40.336702 Ais-cryoET-1.0.25/
+drwxrwxrwx   0        0        0        0 2024-05-30 15:06:39.936156 Ais-cryoET-1.0.25/Ais/
+-rw-rw-rw-   0        0        0    36025 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.25/Ais/LICENSE.txt
+-rw-rw-rw-   0        0        0        0 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.25/Ais/__init__.py
+drwxrwxrwx   0        0        0        0 2024-05-30 15:06:40.073601 Ais-cryoET-1.0.25/Ais/core/
+-rw-rw-rw-   0        0        0        0 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.25/Ais/core/__init__.py
+-rw-rw-rw-   0        0        0     5069 2024-05-30 15:06:33.000000 Ais-cryoET-1.0.25/Ais/core/config.py
+-rw-rw-rw-   0        0        0     1637 2024-01-02 08:48:51.000000 Ais-cryoET-1.0.25/Ais/core/extract.py
+-rw-rw-rw-   0        0        0     2640 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.25/Ais/core/open_in_blender.py
+-rw-rw-rw-   0        0        0      625 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.25/Ais/core/open_in_chimerax.py
+-rw-rw-rw-   0        0        0    17535 2024-05-01 07:43:42.000000 Ais-cryoET-1.0.25/Ais/core/opengl_classes.py
+-rw-rw-rw-   0        0        0    34279 2024-05-30 15:02:55.000000 Ais-cryoET-1.0.25/Ais/core/se_frame.py
+-rw-rw-rw-   0        0        0    24255 2024-03-26 11:05:39.000000 Ais-cryoET-1.0.25/Ais/core/se_model.py
+-rw-rw-rw-   0        0        0   194036 2024-05-30 14:59:24.000000 Ais-cryoET-1.0.25/Ais/core/segmentation_editor.py
+-rw-rw-rw-   0        0        0      331 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.25/Ais/core/settings.py
+-rw-rw-rw-   0        0        0      130 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.25/Ais/core/settings.txt
+-rw-rw-rw-   0        0        0       98 2024-01-02 10:33:08.000000 Ais-cryoET-1.0.25/Ais/core/start.py
+-rw-rw-rw-   0        0        0    22298 2024-03-28 11:18:29.000000 Ais-cryoET-1.0.25/Ais/core/util.py
+-rw-rw-rw-   0        0        0     2572 2023-12-21 15:04:18.000000 Ais-cryoET-1.0.25/Ais/core/widgets.py
+-rw-rw-rw-   0        0        0     7961 2024-05-01 07:34:37.000000 Ais-cryoET-1.0.25/Ais/core/window.py
+drwxrwxrwx   0        0        0        0 2024-05-30 15:06:40.139782 Ais-cryoET-1.0.25/Ais/icons/
+-rw-rw-rw-   0        0        0  1098617 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.25/Ais/icons/LOGO_Pom_1024.png
+-rw-rw-rw-   0        0        0    19430 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.25/Ais/icons/LOGO_Pom_128.png
+-rw-rw-rw-   0        0        0  2960366 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.25/Ais/icons/LOGO_Pom_2048.png
+-rw-rw-rw-   0        0        0   134990 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.25/Ais/icons/LOGO_Pom_256.png
+-rw-rw-rw-   0        0        0   401274 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.25/Ais/icons/LOGO_Pom_512.png
+-rw-rw-rw-   0        0        0        0 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.25/Ais/icons/__init__.py
+-rw-rw-rw-   0        0        0     8843 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.25/Ais/icons/icon_blender_256.png
+-rw-rw-rw-   0        0        0    30131 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.25/Ais/icons/icon_chimerax_256.png
+-rw-rw-rw-   0        0        0     1563 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.25/Ais/icons/icon_close_256.png
+-rw-rw-rw-   0        0        0      954 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.25/Ais/icons/icon_crop_256.png
+-rw-rw-rw-   0        0        0     5113 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.25/Ais/icons/icon_obj_256.png
+-rw-rw-rw-   0        0        0      784 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.25/Ais/icons/icon_stop_256.png
+-rw-rw-rw-   0        0        0     2001 2024-01-02 08:48:51.000000 Ais-cryoET-1.0.25/Ais/main.py
+drwxrwxrwx   0        0        0        0 2024-05-30 15:06:40.226703 Ais-cryoET-1.0.25/Ais/models/
+-rw-rw-rw-   0        0        0       15 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.25/Ais/models/__init__.py
+-rw-rw-rw-   0        0        0      819 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.25/Ais/models/eman2.py
+-rw-rw-rw-   0        0        0     1359 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.25/Ais/models/inceptionnet.py
+-rw-rw-rw-   0        0        0     2149 2024-02-06 08:17:58.000000 Ais-cryoET-1.0.25/Ais/models/model_template.py
+-rw-rw-rw-   0        0        0     7759 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.25/Ais/models/pix2pix.py
+-rw-rw-rw-   0        0        0     1562 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.25/Ais/models/resnet.py
+-rw-rw-rw-   0        0        0     1166 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.25/Ais/models/unet_deep.py
+-rw-rw-rw-   0        0        0      973 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.25/Ais/models/unet_dropout.py
+-rw-rw-rw-   0        0        0      889 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.25/Ais/models/unet_lite.py
+-rw-rw-rw-   0        0        0     1559 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.25/Ais/models/vggnet.py
+-rw-rw-rw-   0        0        0     1568 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.25/Ais/models/vggnet_plus.py
+-rw-rw-rw-   0        0        0      207 2024-01-02 08:48:52.000000 Ais-cryoET-1.0.25/Ais/requirements.txt
+drwxrwxrwx   0        0        0        0 2024-05-30 15:06:40.306702 Ais-cryoET-1.0.25/Ais/shaders/
+-rw-rw-rw-   0        0        0        0 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.25/Ais/shaders/__init__.py
+-rw-rw-rw-   0        0        0      372 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.25/Ais/shaders/ce_line_shader.glsl
+-rw-rw-rw-   0        0        0      725 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.25/Ais/shaders/se_binary_segmentation_shader.glsl
+-rw-rw-rw-   0        0        0      424 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.25/Ais/shaders/se_border_shader.glsl
+-rw-rw-rw-   0        0        0      929 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.25/Ais/shaders/se_compute_kernel_filter.glsl
+-rw-rw-rw-   0        0        0      808 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.25/Ais/shaders/se_compute_mix.glsl
+-rw-rw-rw-   0        0        0      487 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.25/Ais/shaders/se_depth_mask_shader.glsl
+-rw-rw-rw-   0        0        0      696 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.25/Ais/shaders/se_float_segmentation_shader.glsl
+-rw-rw-rw-   0        0        0      649 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.25/Ais/shaders/se_icon_shader.glsl
+-rw-rw-rw-   0        0        0      286 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.25/Ais/shaders/se_line_3d_shader.glsl
+-rw-rw-rw-   0        0        0      449 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.25/Ais/shaders/se_overlay_blend_shader.glsl
+-rw-rw-rw-   0        0        0     3359 2023-11-30 12:28:22.000000 Ais-cryoET-1.0.25/Ais/shaders/se_overlay_ray_trace_shader.glsl
+-rw-rw-rw-   0        0        0     1188 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.25/Ais/shaders/se_overlay_shader.glsl
+-rw-rw-rw-   0        0        0      454 2024-01-02 13:56:12.000000 Ais-cryoET-1.0.25/Ais/shaders/se_particle_shader.glsl
+-rw-rw-rw-   0        0        0      827 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.25/Ais/shaders/se_quad_3d_shader.glsl
+-rw-rw-rw-   0        0        0     1019 2023-11-29 15:57:43.000000 Ais-cryoET-1.0.25/Ais/shaders/se_quad_shader.glsl
+-rw-rw-rw-   0        0        0     1950 2023-12-03 15:17:59.000000 Ais-cryoET-1.0.25/Ais/shaders/se_surface_model_shader.glsl
+drwxrwxrwx   0        0        0        0 2024-05-30 15:06:40.336702 Ais-cryoET-1.0.25/Ais_cryoET.egg-info/
+-rw-rw-rw-   0        0        0     5068 2024-05-30 15:06:39.000000 Ais-cryoET-1.0.25/Ais_cryoET.egg-info/PKG-INFO
+-rw-rw-rw-   0        0        0     1861 2024-05-30 15:06:39.000000 Ais-cryoET-1.0.25/Ais_cryoET.egg-info/SOURCES.txt
+-rw-rw-rw-   0        0        0        1 2024-05-30 15:06:39.000000 Ais-cryoET-1.0.25/Ais_cryoET.egg-info/dependency_links.txt
+-rw-rw-rw-   0        0        0       66 2024-05-30 15:06:39.000000 Ais-cryoET-1.0.25/Ais_cryoET.egg-info/entry_points.txt
+-rw-rw-rw-   0        0        0      196 2024-05-30 15:06:39.000000 Ais-cryoET-1.0.25/Ais_cryoET.egg-info/requires.txt
+-rw-rw-rw-   0        0        0        4 2024-05-30 15:06:39.000000 Ais-cryoET-1.0.25/Ais_cryoET.egg-info/top_level.txt
+-rw-rw-rw-   0        0        0      108 2023-10-23 08:03:57.000000 Ais-cryoET-1.0.25/MANIFEST.in
+-rw-rw-rw-   0        0        0     5068 2024-05-30 15:06:40.336702 Ais-cryoET-1.0.25/PKG-INFO
+-rw-rw-rw-   0        0        0     4706 2023-12-14 16:04:51.000000 Ais-cryoET-1.0.25/README.md
+-rw-rw-rw-   0        0        0       42 2024-05-30 15:06:40.336702 Ais-cryoET-1.0.25/setup.cfg
+-rw-rw-rw-   0        0        0     1396 2024-05-30 15:06:33.000000 Ais-cryoET-1.0.25/setup.py
```

### Comparing `Ais-cryoET-1.0.24/Ais/LICENSE.txt` & `Ais-cryoET-1.0.25/Ais/LICENSE.txt`

 * *Files identical despite different names*

### Comparing `Ais-cryoET-1.0.24/Ais/core/config.py` & `Ais-cryoET-1.0.25/Ais/core/config.py`

 * *Files 1% similar despite different names*

```diff
@@ -6,15 +6,15 @@
 import platform
 
 # TODO: .tif files as input
 
 frozen = False
 root = os.path.dirname(os.path.dirname(__file__))
 app_name = "Ais"
-version = "1.0.24"
+version = "1.0.25"
 license = "GNU GPL v3"
 log_title = "Ais.log"
 log_path = os.path.join(root, log_title)
 
 filetype_segmentation = ".scns"
 filetype_traindata = ".scnt"
 filetype_semodel = ".scnm"
```

### Comparing `Ais-cryoET-1.0.24/Ais/core/extract.py` & `Ais-cryoET-1.0.25/Ais/core/extract.py`

 * *Files identical despite different names*

### Comparing `Ais-cryoET-1.0.24/Ais/core/open_in_blender.py` & `Ais-cryoET-1.0.25/Ais/core/open_in_blender.py`

 * *Files identical despite different names*

### Comparing `Ais-cryoET-1.0.24/Ais/core/open_in_chimerax.py` & `Ais-cryoET-1.0.25/Ais/core/open_in_chimerax.py`

 * *Files identical despite different names*

### Comparing `Ais-cryoET-1.0.24/Ais/core/opengl_classes.py` & `Ais-cryoET-1.0.25/Ais/core/opengl_classes.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,9 @@
 from OpenGL.GL import *
 from OpenGL.GLUT import *
-#OpenGL.ERROR_CHECKING = False  # TODO: validate speed increase
 from itertools import count
 import numpy as np
 import ctypes
 
 """All classes here are fairly straightforward implementations of standard OpenGL objects. Some notes:
 in Texture/Framebuffer constructor there is a format parameter, which can be any of 'rgbu16', 'ru16', or 'rgba32f'.
 For vertex and index buffers, the input vertices/indices data has to be a default python list [x1, y1, z1, x2, y2, ...]
```

### Comparing `Ais-cryoET-1.0.24/Ais/core/se_frame.py` & `Ais-cryoET-1.0.25/Ais/core/se_frame.py`

 * *Files 2% similar despite different names*

```diff
@@ -504,14 +504,38 @@
                     vol[i] = self.slices[i]
                 outf.set_data(vol * 255)
                 outf.voxel_size = self.parent.pixel_size * 10.0
             print(f"Volume saved to: {fpath}")
         except Exception as e:
             print(e)
 
+    def import_slice(self, path, threshold=128):
+        data = mrcfile.mmap(path).data[self.current_slice, :, :]
+        if data.shape != (self.height, self.width):
+            raise Exception("Selected .mrc does not have the same dimensions as this Feature's parent .mrc")
+        self.slices[self.current_slice] = (data > threshold).astype(np.uint8)
+        self.edited_slices.append(self.current_slice)
+        self.boxes[self.current_slice] = list()
+        self.data = self.slices[self.current_slice]
+        self.texture.update(self.data, self.width, self.height)
+
+    def import_mrc(self, path, threshold=128):
+        data = mrcfile.read(path)
+        if data.shape != (self.parent.n_slices, self.height, self.width):
+            raise Exception("Selected .mrc does not have the same dimensions as this Feature's parent .mrc")
+        self.slices = dict()
+        self.edited_slices = list()
+        for i in range(data.shape[0]):
+            self.edited_slices.append(i)
+            self.slices[i] = (data[i, :, :] > threshold).astype(np.uint8)
+            self.boxes[i] = list()
+        self.data = self.slices[self.current_slice]
+        self.texture.update(self.data, self.width, self.height)
+
+
 
 class Transform:
     def __init__(self):
         self.translation = np.array([0.0, 0.0])
         self.rotation = 0.0
         self.scale = 1.0
         self.matrix = np.identity(4)
```

### Comparing `Ais-cryoET-1.0.24/Ais/core/se_model.py` & `Ais-cryoET-1.0.25/Ais/core/se_model.py`

 * *Files identical despite different names*

### Comparing `Ais-cryoET-1.0.24/Ais/core/segmentation_editor.py` & `Ais-cryoET-1.0.25/Ais/core/segmentation_editor.py`

 * *Files 0% similar despite different names*

```diff
@@ -220,11799 +220,11909 @@
 00000db0: 4354 5f4d 494e 5f53 5041 4349 4e47 203d  CT_MIN_SPACING =
 00000dc0: 2031 302e 3020 2023 2041 6e67 7374 726f   10.0  # Angstro
 00000dd0: 6d0d 0a20 2020 2020 2020 2045 5854 5241  m..        EXTRA
 00000de0: 4354 5f53 454c 4543 5445 445f 4645 4154  CT_SELECTED_FEAT
 00000df0: 5552 455f 5449 544c 4520 3d20 2222 0d0a  URE_TITLE = ""..
 00000e00: 2020 2020 2020 2020 4558 5452 4143 545f          EXTRACT_
 00000e10: 414c 4c20 3d20 5472 7565 0d0a 2020 2020  ALL = True..    
-00000e20: 2020 2020 4558 5452 4143 545f 4d49 4e5f      EXTRACT_MIN_
-00000e30: 5350 4143 494e 4720 3d20 3130 2e30 0d0a  SPACING = 10.0..
-00000e40: 2020 2020 2020 2020 7175 6575 6564 5f65          queued_e
-00000e50: 7870 6f72 7473 203d 206c 6973 7428 290d  xports = list().
-00000e60: 0a20 2020 2020 2020 2065 7870 6f72 745f  .        export_
-00000e70: 6469 7220 3d20 2222 0d0a 0d0a 2020 2020  dir = ""....    
-00000e80: 2020 2020 7472 6169 6e73 6574 5f61 7069      trainset_api
-00000e90: 7820 3d20 3130 2e30 0d0a 2020 2020 2020  x = 10.0..      
-00000ea0: 2020 7365 675f 666f 6c64 6572 203d 2022    seg_folder = "
-00000eb0: 220d 0a0d 0a20 2020 2020 2020 2053 484f  "....        SHO
-00000ec0: 575f 424f 4f54 5f53 5052 4954 4520 3d20  W_BOOT_SPRITE = 
-00000ed0: 5472 7565 0d0a 2020 2020 2020 2020 4943  True..        IC
-00000ee0: 4f4e 203d 2049 6d61 6765 2e6f 7065 6e28  ON = Image.open(
-00000ef0: 6f73 2e70 6174 682e 6a6f 696e 2863 6667  os.path.join(cfg
-00000f00: 2e72 6f6f 742c 2022 6963 6f6e 7322 2c20  .root, "icons", 
-00000f10: 224c 4f47 4f5f 506f 6d5f 3132 382e 706e  "LOGO_Pom_128.pn
-00000f20: 6722 2929 0d0a 0d0a 2020 2020 6465 6620  g"))....    def 
-00000f30: 5f5f 696e 6974 5f5f 2873 656c 662c 2077  __init__(self, w
-00000f40: 696e 646f 772c 2069 6d67 7569 5f63 6f6e  indow, imgui_con
-00000f50: 7465 7874 2c20 696d 6775 695f 696d 706c  text, imgui_impl
-00000f60: 293a 0d0a 2020 2020 2020 2020 7365 6c66  ):..        self
-00000f70: 2e77 696e 646f 7720 3d20 7769 6e64 6f77  .window = window
-00000f80: 0d0a 2020 2020 2020 2020 7365 6c66 2e77  ..        self.w
-00000f90: 696e 646f 772e 636c 6561 725f 636f 6c6f  indow.clear_colo
-00000fa0: 7220 3d20 6366 672e 434f 4c4f 5552 5f57  r = cfg.COLOUR_W
-00000fb0: 494e 444f 575f 4241 434b 4752 4f55 4e44  INDOW_BACKGROUND
-00000fc0: 0d0a 2020 2020 2020 2020 7365 6c66 2e77  ..        self.w
-00000fd0: 696e 646f 772e 6d61 6b65 5f63 7572 7265  indow.make_curre
-00000fe0: 6e74 2829 0d0a 2020 2020 2020 2020 7365  nt()..        se
-00000ff0: 6c66 2e69 6d67 7569 5f63 6f6e 7465 7874  lf.imgui_context
-00001000: 203d 2069 6d67 7569 5f63 6f6e 7465 7874   = imgui_context
-00001010: 0d0a 2020 2020 2020 2020 7365 6c66 2e69  ..        self.i
-00001020: 6d67 7569 5f69 6d70 6c65 6d65 6e74 6174  mgui_implementat
-00001030: 696f 6e20 3d20 696d 6775 695f 696d 706c  ion = imgui_impl
-00001040: 0d0a 0d0a 2020 2020 2020 2020 7365 6c66  ....        self
-00001050: 2e63 616d 6572 6120 3d20 4361 6d65 7261  .camera = Camera
-00001060: 2829 0d0a 2020 2020 2020 2020 7365 6c66  ()..        self
-00001070: 2e63 616d 6572 6133 6420 3d20 4361 6d65  .camera3d = Came
-00001080: 7261 3344 2829 0d0a 2020 2020 2020 2020  ra3D()..        
-00001090: 5365 676d 656e 7461 7469 6f6e 4564 6974  SegmentationEdit
-000010a0: 6f72 2e4c 4947 4854 5f53 504f 5420 3d20  or.LIGHT_SPOT = 
-000010b0: 4c69 6768 7433 4428 290d 0a20 2020 2020  Light3D()..     
-000010c0: 2020 2053 6567 6d65 6e74 6174 696f 6e45     SegmentationE
-000010d0: 6469 746f 722e 4445 4641 554c 545f 5a4f  ditor.DEFAULT_ZO
-000010e0: 4f4d 203d 2063 6667 2e77 696e 646f 775f  OM = cfg.window_
-000010f0: 6865 6967 6874 202f 2053 6567 6d65 6e74  height / Segment
-00001100: 6174 696f 6e45 6469 746f 722e 4445 4641  ationEditor.DEFA
-00001110: 554c 545f 484f 5249 5a4f 4e54 414c 5f46  ULT_HORIZONTAL_F
-00001120: 4f56 5f57 4944 5448 2020 2320 6e6f 7720  OV_WIDTH  # now 
-00001130: 6974 2069 7320 4445 4641 554c 545f 484f  it is DEFAULT_HO
-00001140: 5249 5a4f 4e54 414c 5f46 4f56 5f57 4944  RIZONTAL_FOV_WID
-00001150: 5448 0d0a 2020 2020 2020 2020 5365 676d  TH..        Segm
-00001160: 656e 7461 7469 6f6e 4564 6974 6f72 2e44  entationEditor.D
-00001170: 4546 4155 4c54 5f57 4f52 4c44 5f50 4958  EFAULT_WORLD_PIX
-00001180: 454c 5f53 495a 4520 3d20 312e 3020 2f20  EL_SIZE = 1.0 / 
-00001190: 5365 676d 656e 7461 7469 6f6e 4564 6974  SegmentationEdit
-000011a0: 6f72 2e44 4546 4155 4c54 5f5a 4f4f 4d0d  or.DEFAULT_ZOOM.
-000011b0: 0a20 2020 2020 2020 2073 656c 662e 6361  .        self.ca
-000011c0: 6d65 7261 2e7a 6f6f 6d20 3d20 5365 676d  mera.zoom = Segm
-000011d0: 656e 7461 7469 6f6e 4564 6974 6f72 2e44  entationEditor.D
-000011e0: 4546 4155 4c54 5f5a 4f4f 4d0d 0a20 2020  EFAULT_ZOOM..   
-000011f0: 2020 2020 2053 6567 6d65 6e74 6174 696f       Segmentatio
-00001200: 6e45 6469 746f 722e 7265 6e64 6572 6572  nEditor.renderer
-00001210: 203d 2052 656e 6465 7265 7228 290d 0a20   = Renderer().. 
-00001220: 2020 2020 2020 2073 656c 662e 6669 6c74         self.filt
-00001230: 6572 7320 3d20 6c69 7374 2829 0d0a 2020  ers = list()..  
-00001240: 2020 2020 2020 7365 6c66 2e61 6374 6976        self.activ
-00001250: 655f 7461 6220 3d20 2253 6567 6d65 6e74  e_tab = "Segment
-00001260: 6174 696f 6e22 0d0a 2020 2020 2020 2020  ation"..        
-00001270: 2320 7472 6169 6e69 6e67 2064 6174 6173  # training datas
-00001280: 6574 2070 6172 616d 730d 0a20 2020 2020  et params..     
-00001290: 2020 2073 656c 662e 616c 6c5f 6665 6174     self.all_feat
-000012a0: 7572 655f 6e61 6d65 7320 3d20 6c69 7374  ure_names = list
-000012b0: 2829 0d0a 2020 2020 2020 2020 7365 6c66  ()..        self
-000012c0: 2e66 6561 7475 7265 5f63 6f6c 6f75 725f  .feature_colour_
-000012d0: 6469 6374 203d 2064 6963 7428 290d 0a20  dict = dict().. 
-000012e0: 2020 2020 2020 2073 656c 662e 7472 6169         self.trai
-000012f0: 6e73 6574 5f66 6561 7475 7265 5f73 656c  nset_feature_sel
-00001300: 6563 7469 6f6e 203d 2064 6963 7428 290d  ection = dict().
-00001310: 0a20 2020 2020 2020 2073 656c 662e 7472  .        self.tr
-00001320: 6169 6e73 6574 5f73 656c 6563 7469 6f6e  ainset_selection
-00001330: 203d 206c 6973 7428 290d 0a20 2020 2020   = list()..     
-00001340: 2020 2073 656c 662e 7472 6169 6e73 6574     self.trainset
-00001350: 5f6e 756d 5f62 6f78 6573 5f70 6f73 6974  _num_boxes_posit
-00001360: 6976 6520 3d20 300d 0a20 2020 2020 2020  ive = 0..       
-00001370: 2073 656c 662e 7472 6169 6e73 6574 5f6e   self.trainset_n
-00001380: 756d 5f62 6f78 6573 5f6e 6567 6174 6976  um_boxes_negativ
-00001390: 6520 3d20 300d 0a20 2020 2020 2020 2073  e = 0..        s
-000013a0: 656c 662e 7472 6169 6e73 6574 5f62 6f78  elf.trainset_box
-000013b0: 7369 7a65 203d 2036 340d 0a20 2020 2020  size = 64..     
-000013c0: 2020 2073 656c 662e 7368 6f77 5f74 7261     self.show_tra
-000013d0: 696e 7365 745f 626f 7865 7320 3d20 4661  inset_boxes = Fa
-000013e0: 6c73 650d 0a20 2020 2020 2020 2073 656c  lse..        sel
-000013f0: 662e 6163 7469 7665 5f74 7261 696e 7365  f.active_trainse
-00001400: 745f 6578 706f 7274 7320 3d20 6c69 7374  t_exports = list
-00001410: 2829 0d0a 0d0a 2020 2020 2020 2020 2320  ()....        # 
-00001420: 6472 6f70 2066 696c 6573 0d0a 2020 2020  drop files..    
-00001430: 2020 2020 7365 6c66 2e69 6e63 6f6d 696e      self.incomin
-00001440: 675f 6669 6c65 7320 3d20 6c69 7374 2829  g_files = list()
-00001450: 0d0a 0d0a 2020 2020 2020 2020 2320 6578  ....        # ex
-00001460: 706f 7274 2026 2065 7874 7261 6374 0d0a  port & extract..
-00001470: 2020 2020 2020 2020 7365 6c66 2e65 7870          self.exp
-00001480: 6f72 745f 6c69 6d69 745f 7261 6e67 6520  ort_limit_range 
-00001490: 3d20 5472 7565 0d0a 2020 2020 2020 2020  = True..        
-000014a0: 7365 6c66 2e65 7870 6f72 745f 6f76 6572  self.export_over
-000014b0: 6c61 7973 203d 2046 616c 7365 0d0a 2020  lays = False..  
-000014c0: 2020 2020 2020 7365 6c66 2e65 7870 6f72        self.expor
-000014d0: 745f 6261 7463 685f 7369 7a65 203d 2031  t_batch_size = 1
-000014e0: 0d0a 0d0a 2020 2020 2020 2020 2320 6372  ....        # cr
-000014f0: 6f70 2068 616e 646c 6573 0d0a 2020 2020  op handles..    
-00001500: 2020 2020 7365 6c66 2e63 726f 705f 6861      self.crop_ha
-00001510: 6e64 6c65 7320 3d20 6c69 7374 2829 0d0a  ndles = list()..
-00001520: 0d0a 2020 2020 2020 2020 2320 7069 636b  ..        # pick
-00001530: 696e 6720 2f20 3364 2072 656e 6465 7273  ing / 3d renders
-00001540: 0d0a 0d0a 2020 2020 2020 2020 7365 6c66  ....        self
-00001550: 2e70 6963 6b5f 626f 785f 7661 203d 2056  .pick_box_va = V
-00001560: 6572 7465 7841 7272 6179 2861 7474 7269  ertexArray(attri
-00001570: 6275 7465 5f66 6f72 6d61 743d 2278 797a  bute_format="xyz
-00001580: 2229 2020 2320 7265 6e64 6572 2062 6f78  ")  # render box
-00001590: 206c 696e 6573 0d0a 2020 2020 2020 2020   lines..        
-000015a0: 7365 6c66 2e70 6963 6b5f 626f 785f 7175  self.pick_box_qu
-000015b0: 6164 5f76 6120 3d20 5665 7274 6578 4172  ad_va = VertexAr
-000015c0: 7261 7928 6174 7472 6962 7574 655f 666f  ray(attribute_fo
-000015d0: 726d 6174 3d22 7879 7a22 2920 2023 2072  rmat="xyz")  # r
-000015e0: 656e 6465 7220 626f 7820 6661 6365 730d  ender box faces.
-000015f0: 0a20 2020 2020 2020 2073 656c 662e 7069  .        self.pi
-00001600: 636b 5f62 6f78 5f76 612e 7570 6461 7465  ck_box_va.update
-00001610: 2856 6572 7465 7842 7566 6665 7228 5b30  (VertexBuffer([0
-00001620: 2e30 2c20 302e 305d 292c 2049 6e64 6578  .0, 0.0]), Index
-00001630: 4275 6666 6572 285b 5d29 290d 0a20 2020  Buffer([]))..   
-00001640: 2020 2020 2073 656c 662e 7069 636b 5f62       self.pick_b
-00001650: 6f78 5f71 7561 645f 7661 2e75 7064 6174  ox_quad_va.updat
-00001660: 6528 5665 7274 6578 4275 6666 6572 285b  e(VertexBuffer([
-00001670: 302e 302c 2030 2e30 5d29 2c20 496e 6465  0.0, 0.0]), Inde
-00001680: 7842 7566 6665 7228 5b5d 2929 0d0a 2020  xBuffer([]))..  
-00001690: 2020 2020 2020 7365 6c66 2e70 6963 6b5f        self.pick_
-000016a0: 6f76 6572 6c61 795f 3364 203d 2054 7275  overlay_3d = Tru
-000016b0: 650d 0a0d 0a20 2020 2020 2020 2066 6f72  e....        for
-000016c0: 2069 2069 6e20 7261 6e67 6528 3429 3a0d   i in range(4):.
-000016d0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-000016e0: 662e 6372 6f70 5f68 616e 646c 6573 2e61  f.crop_handles.a
-000016f0: 7070 656e 6428 576f 726c 6453 7061 6365  ppend(WorldSpace
-00001700: 4963 6f6e 2869 2929 0d0a 0d0a 0d0a 2020  Icon(i))......  
-00001710: 2020 2020 2020 6966 2054 7275 653a 0d0a        if True:..
-00001720: 2020 2020 2020 2020 2020 2020 6963 6f6e              icon
-00001730: 5f64 6972 203d 206f 732e 7061 7468 2e6a  _dir = os.path.j
-00001740: 6f69 6e28 6366 672e 726f 6f74 2c20 2269  oin(cfg.root, "i
-00001750: 636f 6e73 2229 0d0a 0d0a 2020 2020 2020  cons")....      
-00001760: 2020 2020 2020 7365 6c66 2e69 636f 6e5f        self.icon_
-00001770: 636c 6f73 6520 3d20 5465 7874 7572 6528  close = Texture(
-00001780: 666f 726d 6174 3d22 7267 6261 3332 6622  format="rgba32f"
-00001790: 290d 0a20 2020 2020 2020 2020 2020 2070  )..            p
-000017a0: 7864 5f69 636f 6e5f 636c 6f73 6520 3d20  xd_icon_close = 
-000017b0: 6e70 2e61 7361 7272 6179 2849 6d61 6765  np.asarray(Image
-000017c0: 2e6f 7065 6e28 6f73 2e70 6174 682e 6a6f  .open(os.path.jo
-000017d0: 696e 2869 636f 6e5f 6469 722c 2022 6963  in(icon_dir, "ic
-000017e0: 6f6e 5f63 6c6f 7365 5f32 3536 2e70 6e67  on_close_256.png
-000017f0: 2229 2929 2e61 7374 7970 6528 6e70 2e66  "))).astype(np.f
-00001800: 6c6f 6174 3332 2920 2f20 3235 352e 300d  loat32) / 255.0.
-00001810: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00001820: 662e 6963 6f6e 5f63 6c6f 7365 2e75 7064  f.icon_close.upd
-00001830: 6174 6528 7078 645f 6963 6f6e 5f63 6c6f  ate(pxd_icon_clo
-00001840: 7365 290d 0a20 2020 2020 2020 2020 2020  se)..           
-00001850: 2073 656c 662e 6963 6f6e 5f63 6c6f 7365   self.icon_close
-00001860: 2e73 6574 5f6c 696e 6561 725f 696e 7465  .set_linear_inte
-00001870: 7270 6f6c 6174 696f 6e28 290d 0a0d 0a20  rpolation().... 
-00001880: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00001890: 6963 6f6e 5f73 746f 7020 3d20 5465 7874  icon_stop = Text
-000018a0: 7572 6528 666f 726d 6174 3d22 7267 6261  ure(format="rgba
-000018b0: 3332 6622 290d 0a20 2020 2020 2020 2020  32f")..         
-000018c0: 2020 2070 7864 5f69 636f 6e5f 7374 6f70     pxd_icon_stop
-000018d0: 203d 206e 702e 6173 6172 7261 7928 496d   = np.asarray(Im
-000018e0: 6167 652e 6f70 656e 286f 732e 7061 7468  age.open(os.path
-000018f0: 2e6a 6f69 6e28 6963 6f6e 5f64 6972 2c20  .join(icon_dir, 
-00001900: 2269 636f 6e5f 7374 6f70 5f32 3536 2e70  "icon_stop_256.p
-00001910: 6e67 2229 2929 2e61 7374 7970 6528 6e70  ng"))).astype(np
-00001920: 2e66 6c6f 6174 3332 2920 2f20 3235 352e  .float32) / 255.
-00001930: 300d 0a20 2020 2020 2020 2020 2020 2073  0..            s
-00001940: 656c 662e 6963 6f6e 5f73 746f 702e 7570  elf.icon_stop.up
-00001950: 6461 7465 2870 7864 5f69 636f 6e5f 7374  date(pxd_icon_st
-00001960: 6f70 290d 0a20 2020 2020 2020 2020 2020  op)..           
-00001970: 2073 656c 662e 6963 6f6e 5f73 746f 702e   self.icon_stop.
-00001980: 7365 745f 6c69 6e65 6172 5f69 6e74 6572  set_linear_inter
-00001990: 706f 6c61 7469 6f6e 2829 0d0a 0d0a 2020  polation()....  
-000019a0: 2020 2020 2020 2020 2020 7365 6c66 2e69            self.i
-000019b0: 636f 6e5f 6f62 6a20 3d20 5465 7874 7572  con_obj = Textur
-000019c0: 6528 666f 726d 6174 3d22 7267 6261 3332  e(format="rgba32
-000019d0: 6622 290d 0a20 2020 2020 2020 2020 2020  f")..           
-000019e0: 2073 656c 662e 6963 6f6e 5f62 6c65 6e64   self.icon_blend
-000019f0: 6572 203d 2054 6578 7475 7265 2866 6f72  er = Texture(for
-00001a00: 6d61 743d 2272 6762 6133 3266 2229 0d0a  mat="rgba32f")..
-00001a10: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00001a20: 2e69 636f 6e5f 6368 696d 6572 6178 203d  .icon_chimerax =
-00001a30: 2054 6578 7475 7265 2866 6f72 6d61 743d   Texture(format=
-00001a40: 2272 6762 6133 3266 2229 0d0a 2020 2020  "rgba32f")..    
-00001a50: 2020 2020 2020 2020 7078 6420 3d20 6e70          pxd = np
-00001a60: 2e61 7361 7272 6179 2849 6d61 6765 2e6f  .asarray(Image.o
-00001a70: 7065 6e28 6f73 2e70 6174 682e 6a6f 696e  pen(os.path.join
-00001a80: 2869 636f 6e5f 6469 722c 2022 6963 6f6e  (icon_dir, "icon
-00001a90: 5f6f 626a 5f32 3536 2e70 6e67 2229 2929  _obj_256.png")))
-00001aa0: 2e61 7374 7970 6528 6e70 2e66 6c6f 6174  .astype(np.float
-00001ab0: 3332 2920 2f20 3235 352e 300d 0a20 2020  32) / 255.0..   
-00001ac0: 2020 2020 2020 2020 2073 656c 662e 6963           self.ic
-00001ad0: 6f6e 5f6f 626a 2e75 7064 6174 6528 7078  on_obj.update(px
-00001ae0: 6429 0d0a 2020 2020 2020 2020 2020 2020  d)..            
-00001af0: 7078 6420 3d20 6e70 2e61 7361 7272 6179  pxd = np.asarray
-00001b00: 2849 6d61 6765 2e6f 7065 6e28 6f73 2e70  (Image.open(os.p
-00001b10: 6174 682e 6a6f 696e 2869 636f 6e5f 6469  ath.join(icon_di
-00001b20: 722c 2022 6963 6f6e 5f62 6c65 6e64 6572  r, "icon_blender
-00001b30: 5f32 3536 2e70 6e67 2229 2929 2e61 7374  _256.png"))).ast
-00001b40: 7970 6528 6e70 2e66 6c6f 6174 3332 2920  ype(np.float32) 
-00001b50: 2f20 3235 352e 300d 0a20 2020 2020 2020  / 255.0..       
-00001b60: 2020 2020 2073 656c 662e 6963 6f6e 5f62       self.icon_b
-00001b70: 6c65 6e64 6572 2e75 7064 6174 6528 7078  lender.update(px
-00001b80: 6429 0d0a 2020 2020 2020 2020 2020 2020  d)..            
-00001b90: 7078 6420 3d20 6e70 2e61 7361 7272 6179  pxd = np.asarray
-00001ba0: 2849 6d61 6765 2e6f 7065 6e28 6f73 2e70  (Image.open(os.p
-00001bb0: 6174 682e 6a6f 696e 2869 636f 6e5f 6469  ath.join(icon_di
-00001bc0: 722c 2022 6963 6f6e 5f63 6869 6d65 7261  r, "icon_chimera
-00001bd0: 785f 3235 362e 706e 6722 2929 292e 6173  x_256.png"))).as
-00001be0: 7479 7065 286e 702e 666c 6f61 7433 3229  type(np.float32)
-00001bf0: 202f 2032 3535 2e30 0d0a 2020 2020 2020   / 255.0..      
-00001c00: 2020 2020 2020 7365 6c66 2e69 636f 6e5f        self.icon_
-00001c10: 6368 696d 6572 6178 2e75 7064 6174 6528  chimerax.update(
-00001c20: 7078 6429 0d0a 2020 2020 2020 2020 2020  pxd)..          
-00001c30: 2020 7365 6c66 2e69 636f 6e5f 6f62 6a2e    self.icon_obj.
-00001c40: 7365 745f 6c69 6e65 6172 5f69 6e74 6572  set_linear_inter
-00001c50: 706f 6c61 7469 6f6e 2829 0d0a 2020 2020  polation()..    
-00001c60: 2020 2020 2020 2020 7365 6c66 2e69 636f          self.ico
-00001c70: 6e5f 6368 696d 6572 6178 2e73 6574 5f6c  n_chimerax.set_l
-00001c80: 696e 6561 725f 696e 7465 7270 6f6c 6174  inear_interpolat
-00001c90: 696f 6e28 290d 0a20 2020 2020 2020 2020  ion()..         
-00001ca0: 2020 2073 656c 662e 6963 6f6e 5f62 6c65     self.icon_ble
-00001cb0: 6e64 6572 2e73 6574 5f6c 696e 6561 725f  nder.set_linear_
-00001cc0: 696e 7465 7270 6f6c 6174 696f 6e28 290d  interpolation().
-00001cd0: 0a0d 0a20 2020 2020 2020 2020 2020 2073  ...            s
-00001ce0: 656c 662e 626f 6f74 5f73 7072 6974 655f  elf.boot_sprite_
-00001cf0: 7465 7874 7572 6520 3d20 5465 7874 7572  texture = Textur
-00001d00: 6528 666f 726d 6174 3d22 7267 6261 3332  e(format="rgba32
-00001d10: 6622 290d 0a20 2020 2020 2020 2020 2020  f")..           
-00001d20: 2070 7864 203d 206e 702e 6173 6172 7261   pxd = np.asarra
-00001d30: 7928 496d 6167 652e 6f70 656e 286f 732e  y(Image.open(os.
-00001d40: 7061 7468 2e6a 6f69 6e28 6963 6f6e 5f64  path.join(icon_d
-00001d50: 6972 2c20 224c 4f47 4f5f 506f 6d5f 3230  ir, "LOGO_Pom_20
-00001d60: 3438 2e70 6e67 2229 2929 2e61 7374 7970  48.png"))).astyp
-00001d70: 6528 6e70 2e66 6c6f 6174 3332 2920 2f20  e(np.float32) / 
-00001d80: 3235 352e 300d 0a20 2020 2020 2020 2020  255.0..         
-00001d90: 2020 2073 656c 662e 626f 6f74 5f73 7072     self.boot_spr
-00001da0: 6974 655f 7465 7874 7572 652e 7570 6461  ite_texture.upda
-00001db0: 7465 2870 7864 290d 0a20 2020 2020 2020  te(pxd)..       
-00001dc0: 2020 2020 2073 656c 662e 626f 6f74 5f73       self.boot_s
-00001dd0: 7072 6974 655f 7769 6474 682c 2073 656c  prite_width, sel
-00001de0: 662e 626f 6f74 5f73 7072 6974 655f 6865  f.boot_sprite_he
-00001df0: 6967 6874 203d 2070 7864 2e73 6861 7065  ight = pxd.shape
-00001e00: 5b30 3a32 5d0d 0a20 2020 2020 2020 2020  [0:2]..         
-00001e10: 2020 2073 656c 662e 626f 6f74 5f73 7072     self.boot_spr
-00001e20: 6974 655f 7465 7874 7572 652e 7365 745f  ite_texture.set_
-00001e30: 6c69 6e65 6172 5f69 6e74 6572 706f 6c61  linear_interpola
-00001e40: 7469 6f6e 2829 0d0a 0d0a 2020 2020 4073  tion()....    @s
-00001e50: 7461 7469 636d 6574 686f 640d 0a20 2020  taticmethod..   
-00001e60: 2064 6566 2073 6574 5f61 6374 6976 655f   def set_active_
-00001e70: 6461 7461 7365 7428 6461 7461 7365 7429  dataset(dataset)
-00001e80: 3a0d 0a20 2020 2020 2020 2053 6567 6d65  :..        Segme
-00001e90: 6e74 6174 696f 6e45 6469 746f 722e 7069  ntationEditor.pi
-00001ea0: 636b 5f74 6162 5f69 6e64 6578 5f64 6174  ck_tab_index_dat
-00001eb0: 6173 6574 735f 7365 6773 203d 2054 7275  asets_segs = Tru
-00001ec0: 650d 0a20 2020 2020 2020 2063 6667 2e73  e..        cfg.s
-00001ed0: 655f 6163 7469 7665 5f66 7261 6d65 203d  e_active_frame =
-00001ee0: 2064 6174 6173 6574 0d0a 2020 2020 2020   dataset..      
-00001ef0: 2020 5365 676d 656e 7461 7469 6f6e 4564    SegmentationEd
-00001f00: 6974 6f72 2e46 5241 4d45 5f54 4558 5455  itor.FRAME_TEXTU
-00001f10: 5245 5f52 4551 5549 5245 535f 5550 4441  RE_REQUIRES_UPDA
-00001f20: 5445 207c 3d20 5472 7565 0d0a 2020 2020  TE |= True..    
-00001f30: 2020 2020 6366 672e 7365 5f61 6374 6976      cfg.se_activ
-00001f40: 655f 6672 616d 652e 736c 6963 655f 6368  e_frame.slice_ch
-00001f50: 616e 6765 6420 3d20 5472 7565 0d0a 2020  anged = True..  
-00001f60: 2020 2020 2020 6966 206c 656e 2863 6667        if len(cfg
-00001f70: 2e73 655f 6672 616d 6573 2920 3d3d 2031  .se_frames) == 1
-00001f80: 3a0d 0a20 2020 2020 2020 2020 2020 2053  :..            S
-00001f90: 6567 6d65 6e74 6174 696f 6e45 6469 746f  egmentationEdito
-00001fa0: 722e 7472 6169 6e73 6574 5f61 7069 7820  r.trainset_apix 
-00001fb0: 3d20 6366 672e 7365 5f61 6374 6976 655f  = cfg.se_active_
-00001fc0: 6672 616d 652e 7069 7865 6c5f 7369 7a65  frame.pixel_size
-00001fd0: 202a 2031 302e 300d 0a20 2020 2020 2020   * 10.0..       
-00001fe0: 2020 2020 2053 6567 6d65 6e74 6174 696f       Segmentatio
-00001ff0: 6e45 6469 746f 722e 7365 675f 666f 6c64  nEditor.seg_fold
-00002000: 6572 203d 206f 732e 7061 7468 2e64 6972  er = os.path.dir
-00002010: 6e61 6d65 2863 6667 2e73 655f 6163 7469  name(cfg.se_acti
-00002020: 7665 5f66 7261 6d65 2e70 6174 6829 0d0a  ve_frame.path)..
-00002030: 2020 2020 2020 2020 5365 676d 656e 7461          Segmenta
-00002040: 7469 6f6e 4564 6974 6f72 2e72 656e 6465  tionEditor.rende
-00002050: 7265 722e 6662 6f31 203d 2046 7261 6d65  rer.fbo1 = Frame
-00002060: 4275 6666 6572 2864 6174 6173 6574 2e77  Buffer(dataset.w
-00002070: 6964 7468 2c20 6461 7461 7365 742e 6865  idth, dataset.he
-00002080: 6967 6874 2c20 2272 6762 6133 3266 2229  ight, "rgba32f")
-00002090: 0d0a 2020 2020 2020 2020 5365 676d 656e  ..        Segmen
-000020a0: 7461 7469 6f6e 4564 6974 6f72 2e72 656e  tationEditor.ren
-000020b0: 6465 7265 722e 6662 6f32 203d 2046 7261  derer.fbo2 = Fra
-000020c0: 6d65 4275 6666 6572 2864 6174 6173 6574  meBuffer(dataset
-000020d0: 2e77 6964 7468 2c20 6461 7461 7365 742e  .width, dataset.
-000020e0: 6865 6967 6874 2c20 2272 6762 6133 3266  height, "rgba32f
-000020f0: 2229 0d0a 2020 2020 2020 2020 5365 676d  ")..        Segm
-00002100: 656e 7461 7469 6f6e 4564 6974 6f72 2e72  entationEditor.r
-00002110: 656e 6465 7265 722e 6662 6f33 203d 2046  enderer.fbo3 = F
-00002120: 7261 6d65 4275 6666 6572 2864 6174 6173  rameBuffer(datas
-00002130: 6574 2e77 6964 7468 2c20 6461 7461 7365  et.width, datase
-00002140: 742e 6865 6967 6874 2c20 2272 6762 6133  t.height, "rgba3
-00002150: 3266 2229 0d0a 2020 2020 2020 2020 6966  2f")..        if
-00002160: 2064 6174 6173 6574 2e69 6e74 6572 706f   dataset.interpo
-00002170: 6c61 7465 3a0d 0a20 2020 2020 2020 2020  late:..         
-00002180: 2020 2053 6567 6d65 6e74 6174 696f 6e45     SegmentationE
-00002190: 6469 746f 722e 7265 6e64 6572 6572 2e66  ditor.renderer.f
-000021a0: 626f 312e 7465 7874 7572 652e 7365 745f  bo1.texture.set_
-000021b0: 6c69 6e65 6172 5f69 6e74 6572 706f 6c61  linear_interpola
-000021c0: 7469 6f6e 2829 0d0a 2020 2020 2020 2020  tion()..        
-000021d0: 2020 2020 5365 676d 656e 7461 7469 6f6e      Segmentation
-000021e0: 4564 6974 6f72 2e72 656e 6465 7265 722e  Editor.renderer.
-000021f0: 6662 6f32 2e74 6578 7475 7265 2e73 6574  fbo2.texture.set
-00002200: 5f6c 696e 6561 725f 696e 7465 7270 6f6c  _linear_interpol
-00002210: 6174 696f 6e28 290d 0a20 2020 2020 2020  ation()..       
-00002220: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-00002230: 2020 2020 5365 676d 656e 7461 7469 6f6e      Segmentation
-00002240: 4564 6974 6f72 2e72 656e 6465 7265 722e  Editor.renderer.
-00002250: 6662 6f31 2e74 6578 7475 7265 2e73 6574  fbo1.texture.set
-00002260: 5f6e 6f5f 696e 7465 7270 6f6c 6174 696f  _no_interpolatio
-00002270: 6e28 290d 0a20 2020 2020 2020 2020 2020  n()..           
-00002280: 2053 6567 6d65 6e74 6174 696f 6e45 6469   SegmentationEdi
-00002290: 746f 722e 7265 6e64 6572 6572 2e66 626f  tor.renderer.fbo
-000022a0: 322e 7465 7874 7572 652e 7365 745f 6e6f  2.texture.set_no
-000022b0: 5f69 6e74 6572 706f 6c61 7469 6f6e 2829  _interpolation()
-000022c0: 0d0a 0d0a 2020 2020 6465 6620 6f6e 5f75  ....    def on_u
-000022d0: 7064 6174 6528 7365 6c66 293a 0d0a 2020  pdate(self):..  
-000022e0: 2020 2020 2020 696d 6775 692e 7365 745f        imgui.set_
-000022f0: 6375 7272 656e 745f 636f 6e74 6578 7428  current_context(
-00002300: 7365 6c66 2e69 6d67 7569 5f63 6f6e 7465  self.imgui_conte
-00002310: 7874 290d 0a20 2020 2020 2020 2069 6d67  xt)..        img
-00002320: 7569 2e43 4f4e 4649 475f 444f 434b 494e  ui.CONFIG_DOCKIN
-00002330: 475f 454e 4142 4c45 203d 2054 7275 6520  G_ENABLE = True 
-00002340: 2023 2320 6d61 6179 7979 7962 6520 6e6f   ## maayyyybe no
-00002350: 743f 0d0a 0d0a 2020 2020 2020 2020 7365  t?....        se
-00002360: 6c66 2e77 696e 646f 772e 6d61 6b65 5f63  lf.window.make_c
-00002370: 7572 7265 6e74 2829 0d0a 2020 2020 2020  urrent()..      
-00002380: 2020 7365 6c66 2e77 696e 646f 772e 7365    self.window.se
-00002390: 745f 6675 6c6c 5f76 6965 7770 6f72 7428  t_full_viewport(
-000023a0: 290d 0a20 2020 2020 2020 2069 6620 7365  )..        if se
-000023b0: 6c66 2e77 696e 646f 772e 666f 6375 7365  lf.window.focuse
-000023c0: 643a 0d0a 2020 2020 2020 2020 2020 2020  d:..            
-000023d0: 7365 6c66 2e69 6d67 7569 5f69 6d70 6c65  self.imgui_imple
-000023e0: 6d65 6e74 6174 696f 6e2e 7072 6f63 6573  mentation.proces
-000023f0: 735f 696e 7075 7473 2829 0d0a 0d0a 2020  s_inputs()....  
-00002400: 2020 2020 2020 6966 2045 4d42 4544 4445        if EMBEDDE
-00002410: 443a 0d0a 2020 2020 2020 2020 2020 2020  D:..            
-00002420: 6966 206e 6f74 2069 6d67 7569 2e67 6574  if not imgui.get
-00002430: 5f69 6f28 292e 7761 6e74 5f63 6170 7475  _io().want_captu
-00002440: 7265 5f6b 6579 626f 6172 6420 616e 6420  re_keyboard and 
-00002450: 696d 6775 692e 6973 5f6b 6579 5f70 7265  imgui.is_key_pre
-00002460: 7373 6564 2867 6c66 772e 4b45 595f 5441  ssed(glfw.KEY_TA
-00002470: 4229 3a0d 0a20 2020 2020 2020 2020 2020  B):..           
-00002480: 2020 2020 2069 6620 5365 676d 656e 7461       if Segmenta
-00002490: 7469 6f6e 4564 6974 6f72 2e69 735f 7368  tionEditor.is_sh
-000024a0: 6966 745f 646f 776e 2829 3a0d 0a20 2020  ift_down():..   
-000024b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000024c0: 2073 636e 5f63 6667 2e61 6374 6976 655f   scn_cfg.active_
-000024d0: 6564 6974 6f72 203d 2028 7363 6e5f 6366  editor = (scn_cf
-000024e0: 672e 6163 7469 7665 5f65 6469 746f 7220  g.active_editor 
-000024f0: 2d20 3129 2025 206c 656e 2873 636e 5f63  - 1) % len(scn_c
-00002500: 6667 2e65 6469 746f 7273 290d 0a20 2020  fg.editors)..   
-00002510: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-00002520: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00002530: 2020 2020 2020 2020 7363 6e5f 6366 672e          scn_cfg.
-00002540: 6163 7469 7665 5f65 6469 746f 7220 3d20  active_editor = 
-00002550: 2873 636e 5f63 6667 2e61 6374 6976 655f  (scn_cfg.active_
-00002560: 6564 6974 6f72 202b 2031 2920 2520 6c65  editor + 1) % le
-00002570: 6e28 7363 6e5f 6366 672e 6564 6974 6f72  n(scn_cfg.editor
-00002580: 7329 0d0a 0d0a 2020 2020 2020 2020 666f  s)....        fo
-00002590: 7220 6669 6c65 7061 7468 2069 6e20 7365  r filepath in se
-000025a0: 6c66 2e77 696e 646f 772e 6472 6f70 7065  lf.window.droppe
-000025b0: 645f 6669 6c65 733a 0d0a 2020 2020 2020  d_files:..      
-000025c0: 2020 2020 2020 7365 6c66 2e69 6d70 6f72        self.impor
-000025d0: 745f 6461 7461 7365 7428 6669 6c65 7061  t_dataset(filepa
-000025e0: 7468 290d 0a0d 0a20 2020 2020 2020 2073  th)....        s
-000025f0: 656c 662e 7769 6e64 6f77 2e6f 6e5f 7570  elf.window.on_up
-00002600: 6461 7465 2829 0d0a 0d0a 2020 2020 2020  date()....      
-00002610: 2020 6966 2073 656c 662e 7769 6e64 6f77    if self.window
-00002620: 2e77 696e 646f 775f 7369 7a65 5f63 6861  .window_size_cha
-00002630: 6e67 6564 3a0d 0a20 2020 2020 2020 2020  nged:..         
-00002640: 2020 2063 6667 2e77 696e 646f 775f 7769     cfg.window_wi
-00002650: 6474 6820 3d20 7365 6c66 2e77 696e 646f  dth = self.windo
-00002660: 772e 7769 6474 680d 0a20 2020 2020 2020  w.width..       
-00002670: 2020 2020 2063 6667 2e77 696e 646f 775f       cfg.window_
-00002680: 6865 6967 6874 203d 2073 656c 662e 7769  height = self.wi
-00002690: 6e64 6f77 2e68 6569 6768 740d 0a20 2020  ndow.height..   
-000026a0: 2020 2020 2020 2020 2073 656c 662e 6361           self.ca
-000026b0: 6d65 7261 2e73 6574 5f70 726f 6a65 6374  mera.set_project
-000026c0: 696f 6e5f 6d61 7472 6978 2863 6667 2e77  ion_matrix(cfg.w
-000026d0: 696e 646f 775f 7769 6474 682c 2063 6667  indow_width, cfg
-000026e0: 2e77 696e 646f 775f 6865 6967 6874 290d  .window_height).
-000026f0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00002700: 662e 6361 6d65 7261 3364 2e73 6574 5f70  f.camera3d.set_p
-00002710: 726f 6a65 6374 696f 6e5f 6d61 7472 6978  rojection_matrix
-00002720: 2863 6667 2e77 696e 646f 775f 7769 6474  (cfg.window_widt
-00002730: 682c 2063 6667 2e77 696e 646f 775f 6865  h, cfg.window_he
-00002740: 6967 6874 290d 0a0d 0a20 2020 2020 2020  ight)....       
-00002750: 2069 6620 7365 6c66 2e61 6374 6976 655f   if self.active_
-00002760: 7461 6220 696e 205b 2245 7870 6f72 7422  tab in ["Export"
-00002770: 2c20 224d 6f64 656c 7322 5d20 616e 6420  , "Models"] and 
-00002780: 6366 672e 7365 5f61 6374 6976 655f 6672  cfg.se_active_fr
-00002790: 616d 6520 6973 206e 6f74 204e 6f6e 6520  ame is not None 
-000027a0: 616e 6420 6366 672e 7365 5f61 6374 6976  and cfg.se_activ
-000027b0: 655f 6672 616d 652e 736c 6963 655f 6368  e_frame.slice_ch
-000027c0: 616e 6765 643a 0d0a 2020 2020 2020 2020  anged:..        
-000027d0: 2020 2020 656d 6973 7369 6f6e 7320 3d20      emissions = 
-000027e0: 6c69 7374 2829 0d0a 2020 2020 2020 2020  list()..        
-000027f0: 2020 2020 6162 736f 7262 696e 675f 6d6f      absorbing_mo
-00002800: 6465 6c73 203d 206c 6973 7428 290d 0a20  dels = list().. 
-00002810: 2020 2020 2020 2020 2020 2023 206c 6175             # lau
-00002820: 6e63 6820 7468 6520 6d6f 6465 6c73 0d0a  nch the models..
-00002830: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00002840: 6d6f 6465 6c20 696e 2063 6667 2e73 655f  model in cfg.se_
-00002850: 6d6f 6465 6c73 3a0d 0a20 2020 2020 2020  models:..       
-00002860: 2020 2020 2020 2020 206d 6f64 656c 2e73           model.s
-00002870: 6574 5f73 6c69 6365 2863 6667 2e73 655f  et_slice(cfg.se_
-00002880: 6163 7469 7665 5f66 7261 6d65 2e64 6174  active_frame.dat
-00002890: 612c 2063 6667 2e73 655f 6163 7469 7665  a, cfg.se_active
-000028a0: 5f66 7261 6d65 2e70 6978 656c 5f73 697a  _frame.pixel_siz
-000028b0: 652c 2063 6667 2e73 655f 6163 7469 7665  e, cfg.se_active
-000028c0: 5f66 7261 6d65 2e67 6574 5f72 6f69 5f69  _frame.get_roi_i
-000028d0: 6e64 6963 6573 2829 2c20 6366 672e 7365  ndices(), cfg.se
-000028e0: 5f61 6374 6976 655f 6672 616d 652e 6461  _active_frame.da
-000028f0: 7461 2e73 6861 7065 290d 0a20 2020 2020  ta.shape)..     
-00002900: 2020 2020 2020 2020 2020 2069 6620 6d6f             if mo
-00002910: 6465 6c2e 656d 6974 3a0d 0a20 2020 2020  del.emit:..     
-00002920: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00002930: 6d69 7373 696f 6e73 2e61 7070 656e 6428  missions.append(
-00002940: 6d6f 6465 6c2e 6461 7461 290d 0a20 2020  model.data)..   
-00002950: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00002960: 6d6f 6465 6c2e 6162 736f 7262 3a0d 0a20  model.absorb:.. 
-00002970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002980: 2020 2061 6273 6f72 6269 6e67 5f6d 6f64     absorbing_mod
-00002990: 656c 732e 6170 7065 6e64 286d 6f64 656c  els.append(model
-000029a0: 290d 0a20 2020 2020 2020 2020 2020 2023  )..            #
-000029b0: 2068 6176 6520 6d6f 6465 6c73 2063 6f6d   have models com
-000029c0: 7065 7465 2066 6f72 2070 6978 656c 730d  pete for pixels.
-000029d0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000029e0: 6c65 6e28 656d 6973 7369 6f6e 7329 203e  len(emissions) >
-000029f0: 2030 2061 6e64 206c 656e 2861 6273 6f72   0 and len(absor
-00002a00: 6269 6e67 5f6d 6f64 656c 7329 203e 2030  bing_models) > 0
-00002a10: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00002a20: 2020 2023 2068 6176 6520 6d6f 6465 6c73     # have models
-00002a30: 2063 6f6d 7065 7465 0d0a 2020 2020 2020   compete..      
-00002a40: 2020 2020 2020 2020 2020 7374 6163 6b65            stacke
-00002a50: 645f 6172 7261 7920 3d20 6e70 2e73 7461  d_array = np.sta
-00002a60: 636b 2865 6d69 7373 696f 6e73 290d 0a20  ck(emissions).. 
-00002a70: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00002a80: 6178 696d 6120 3d20 6e70 2e6d 6178 2873  axima = np.max(s
-00002a90: 7461 636b 6564 5f61 7272 6179 2c20 6178  tacked_array, ax
-00002aa0: 6973 3d30 290d 0a20 2020 2020 2020 2020  is=0)..         
-00002ab0: 2020 2020 2020 2066 6f72 206d 6f64 656c         for model
-00002ac0: 2069 6e20 6162 736f 7262 696e 675f 6d6f   in absorbing_mo
-00002ad0: 6465 6c73 3a0d 0a20 2020 2020 2020 2020  dels:..         
-00002ae0: 2020 2020 2020 2020 2020 206d 6f64 656c             model
-00002af0: 2e64 6174 615b 6d6f 6465 6c2e 6461 7461  .data[model.data
-00002b00: 203c 206d 6178 696d 615d 203d 2030 0d0a   < maxima] = 0..
-00002b10: 2020 2020 2020 2020 2020 2020 2320 6170              # ap
-00002b20: 706c 7920 696e 7465 7261 6374 696f 6e73  ply interactions
-00002b30: 0d0a 2020 2020 2020 2020 2020 2020 666f  ..            fo
-00002b40: 7220 6d6f 6465 6c20 696e 2063 6667 2e73  r model in cfg.s
-00002b50: 655f 6d6f 6465 6c73 3a0d 0a20 2020 2020  e_models:..     
-00002b60: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
-00002b70: 6e74 6572 6163 7469 6f6e 2069 6e20 6d6f  nteraction in mo
-00002b80: 6465 6c2e 696e 7465 7261 6374 696f 6e73  del.interactions
-00002b90: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00002ba0: 2020 2020 2020 2069 6e74 6572 6163 7469         interacti
-00002bb0: 6f6e 2e61 7070 6c79 2863 6667 2e73 655f  on.apply(cfg.se_
-00002bc0: 6163 7469 7665 5f66 7261 6d65 2e70 6978  active_frame.pix
-00002bd0: 656c 5f73 697a 6529 0d0a 2020 2020 2020  el_size)..      
-00002be0: 2020 2020 2020 2020 2020 6d6f 6465 6c2e            model.
-00002bf0: 7570 6461 7465 5f74 6578 7475 7265 2829  update_texture()
-00002c00: 0d0a 2020 2020 2020 2020 2020 2020 6366  ..            cf
-00002c10: 672e 7365 5f61 6374 6976 655f 6672 616d  g.se_active_fram
-00002c20: 652e 736c 6963 655f 6368 616e 6765 6420  e.slice_changed 
-00002c30: 3d20 4661 6c73 650d 0a0d 0a20 2020 2020  = False....     
-00002c40: 2020 2069 6d67 7569 2e67 6574 5f69 6f28     imgui.get_io(
-00002c50: 292e 6469 7370 6c61 795f 7369 7a65 203d  ).display_size =
-00002c60: 2073 656c 662e 7769 6e64 6f77 2e77 6964   self.window.wid
-00002c70: 7468 2c20 7365 6c66 2e77 696e 646f 772e  th, self.window.
-00002c80: 6865 6967 6874 0d0a 2020 2020 2020 2020  height..        
-00002c90: 696d 6775 692e 6e65 775f 6672 616d 6528  imgui.new_frame(
-00002ca0: 290d 0a0d 0a20 2020 2020 2020 2069 6620  )....        if 
-00002cb0: 5365 676d 656e 7461 7469 6f6e 4564 6974  SegmentationEdit
-00002cc0: 6f72 2e71 7565 7565 645f 6578 706f 7274  or.queued_export
-00002cd0: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
-00002ce0: 6966 2053 6567 6d65 6e74 6174 696f 6e45  if SegmentationE
-00002cf0: 6469 746f 722e 7175 6575 6564 5f65 7870  ditor.queued_exp
-00002d00: 6f72 7473 5b30 5d2e 7072 6f63 6573 732e  orts[0].process.
-00002d10: 7072 6f67 7265 7373 203e 3d20 312e 303a  progress >= 1.0:
-00002d20: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00002d30: 2020 5365 676d 656e 7461 7469 6f6e 4564    SegmentationEd
-00002d40: 6974 6f72 2e71 7565 7565 645f 6578 706f  itor.queued_expo
-00002d50: 7274 732e 706f 7028 3029 0d0a 2020 2020  rts.pop(0)..    
-00002d60: 2020 2020 2020 2020 6966 2053 6567 6d65          if Segme
-00002d70: 6e74 6174 696f 6e45 6469 746f 722e 7175  ntationEditor.qu
-00002d80: 6575 6564 5f65 7870 6f72 7473 3a0d 0a20  eued_exports:.. 
-00002d90: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00002da0: 6620 5365 676d 656e 7461 7469 6f6e 4564  f SegmentationEd
-00002db0: 6974 6f72 2e71 7565 7565 645f 6578 706f  itor.queued_expo
-00002dc0: 7274 735b 305d 2e70 726f 6365 7373 2e70  rts[0].process.p
-00002dd0: 726f 6772 6573 7320 3d3d 2030 2e30 3a0d  rogress == 0.0:.
-00002de0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00002df0: 2020 2020 2053 6567 6d65 6e74 6174 696f       Segmentatio
-00002e00: 6e45 6469 746f 722e 7175 6575 6564 5f65  nEditor.queued_e
-00002e10: 7870 6f72 7473 5b30 5d2e 7374 6172 7428  xports[0].start(
-00002e20: 290d 0a0d 0a20 2020 2020 2020 2023 2047  )....        # G
-00002e30: 5549 2063 616c 6c73 0d0a 2020 2020 2020  UI calls..      
-00002e40: 2020 6966 206e 6f74 2073 656c 662e 7769    if not self.wi
-00002e50: 6e64 6f77 2e69 735f 6d69 6e69 6d69 7a65  ndow.is_minimize
-00002e60: 6428 293a 0d0a 2020 2020 2020 2020 2020  d():..          
-00002e70: 2020 7365 6c66 2e63 616d 6572 615f 636f    self.camera_co
-00002e80: 6e74 726f 6c28 290d 0a20 2020 2020 2020  ntrol()..       
-00002e90: 2020 2020 2073 656c 662e 6361 6d65 7261       self.camera
-00002ea0: 2e6f 6e5f 7570 6461 7465 2829 0d0a 2020  .on_update()..  
-00002eb0: 2020 2020 2020 2020 2020 7365 6c66 2e63            self.c
-00002ec0: 616d 6572 6133 642e 6f6e 5f75 7064 6174  amera3d.on_updat
-00002ed0: 6528 290d 0a20 2020 2020 2020 2020 2020  e()..           
-00002ee0: 2073 656c 662e 6775 695f 6d61 696e 2829   self.gui_main()
-00002ef0: 0d0a 2020 2020 2020 2020 2020 2020 5365  ..            Se
-00002f00: 676d 656e 7461 7469 6f6e 4564 6974 6f72  gmentationEditor
-00002f10: 2e72 656e 6465 7265 722e 7265 6e64 6572  .renderer.render
-00002f20: 5f64 7261 775f 6c69 7374 2873 656c 662e  _draw_list(self.
-00002f30: 6361 6d65 7261 290d 0a20 2020 2020 2020  camera)..       
-00002f40: 2020 2020 2073 656c 662e 696e 7075 7428       self.input(
-00002f50: 290d 0a0d 0a20 2020 2020 2020 2069 6d67  )....        img
-00002f60: 7569 2e72 656e 6465 7228 290d 0a20 2020  ui.render()..   
-00002f70: 2020 2020 2073 656c 662e 696d 6775 695f       self.imgui_
-00002f80: 696d 706c 656d 656e 7461 7469 6f6e 2e72  implementation.r
-00002f90: 656e 6465 7228 696d 6775 692e 6765 745f  ender(imgui.get_
-00002fa0: 6472 6177 5f64 6174 6128 2929 0d0a 2020  draw_data())..  
-00002fb0: 2020 2020 2020 696d 6775 692e 434f 4e46        imgui.CONF
-00002fc0: 4947 5f44 4f43 4b49 4e47 5f45 4e41 424c  IG_DOCKING_ENABL
-00002fd0: 4520 3d20 4661 6c73 650d 0a0d 0a20 2020  E = False....   
-00002fe0: 2064 6566 2069 6e70 7574 2873 656c 6629   def input(self)
-00002ff0: 3a0d 0a20 2020 2020 2020 2069 6620 7365  :..        if se
-00003000: 6c66 2e61 6374 6976 655f 7461 6220 6e6f  lf.active_tab no
-00003010: 7420 696e 205b 2253 6567 6d65 6e74 6174  t in ["Segmentat
-00003020: 696f 6e22 2c20 2252 656e 6465 7222 5d20  ion", "Render"] 
-00003030: 616e 6420 6366 672e 7365 5f61 6374 6976  and cfg.se_activ
-00003040: 655f 6672 616d 6520 6973 206e 6f74 204e  e_frame is not N
-00003050: 6f6e 6520 616e 6420 6366 672e 7365 5f61  one and cfg.se_a
-00003060: 6374 6976 655f 6672 616d 652e 6372 6f70  ctive_frame.crop
-00003070: 3a0d 0a20 2020 2020 2020 2020 2020 2053  :..            S
-00003080: 6567 6d65 6e74 6174 696f 6e45 6469 746f  egmentationEdito
-00003090: 722e 7265 6e64 6572 6572 2e72 656e 6465  r.renderer.rende
-000030a0: 725f 6372 6f70 5f68 616e 646c 6573 2863  r_crop_handles(c
-000030b0: 6667 2e73 655f 6163 7469 7665 5f66 7261  fg.se_active_fra
-000030c0: 6d65 2c20 7365 6c66 2e63 616d 6572 612c  me, self.camera,
-000030d0: 2073 656c 662e 6372 6f70 5f68 616e 646c   self.crop_handl
-000030e0: 6573 290d 0a20 2020 2020 2020 2069 6620  es)..        if 
-000030f0: 696d 6775 692e 6765 745f 696f 2829 2e77  imgui.get_io().w
-00003100: 616e 745f 6361 7074 7572 655f 6b65 7962  ant_capture_keyb
-00003110: 6f61 7264 3a0d 0a20 2020 2020 2020 2020  oard:..         
-00003120: 2020 2072 6574 7572 6e0d 0a20 2020 2020     return..     
-00003130: 2020 2069 6620 6366 672e 7365 5f61 6374     if cfg.se_act
-00003140: 6976 655f 6672 616d 6520 6973 206e 6f74  ive_frame is not
-00003150: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
-00003160: 2020 2020 7365 6620 3d20 6366 672e 7365      sef = cfg.se
-00003170: 5f61 6374 6976 655f 6672 616d 650d 0a20  _active_frame.. 
-00003180: 2020 2020 2020 2020 2020 2069 6620 696d             if im
-00003190: 6775 692e 6973 5f6b 6579 5f70 7265 7373  gui.is_key_press
-000031a0: 6564 2867 6c66 772e 4b45 595f 4329 3a0d  ed(glfw.KEY_C):.
-000031b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000031c0: 2073 6566 2e63 726f 7020 3d20 6e6f 7420   sef.crop = not 
-000031d0: 7365 662e 6372 6f70 0d0a 2020 2020 2020  sef.crop..      
-000031e0: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
-000031f0: 2073 6566 2e63 726f 703a 0d0a 2020 2020   sef.crop:..    
-00003200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003210: 7365 662e 6372 6f70 5f72 6f69 203d 205b  sef.crop_roi = [
-00003220: 302c 2030 2c20 7365 662e 7769 6474 682c  0, 0, sef.width,
-00003230: 2073 6566 2e68 6569 6768 745d 0d0a 2020   sef.height]..  
-00003240: 2020 2020 2020 2020 2020 6966 2069 6d67            if img
-00003250: 7569 2e69 735f 6b65 795f 7072 6573 7365  ui.is_key_presse
-00003260: 6428 676c 6677 2e4b 4559 5f53 2920 616e  d(glfw.KEY_S) an
-00003270: 6420 5365 676d 656e 7461 7469 6f6e 4564  d SegmentationEd
-00003280: 6974 6f72 2e69 735f 6374 726c 5f64 6f77  itor.is_ctrl_dow
-00003290: 6e28 293a 0d0a 2020 2020 2020 2020 2020  n():..          
-000032a0: 2020 2020 2020 5365 676d 656e 7461 7469        Segmentati
-000032b0: 6f6e 4564 6974 6f72 2e73 6176 655f 6461  onEditor.save_da
-000032c0: 7461 7365 7428 6469 616c 6f67 3d46 616c  taset(dialog=Fal
-000032d0: 7365 290d 0a20 2020 2020 2020 2020 2020  se)..           
-000032e0: 2069 6620 696d 6775 692e 6973 5f6b 6579   if imgui.is_key
-000032f0: 5f70 7265 7373 6564 2867 6c66 772e 4b45  _pressed(glfw.KE
-00003300: 595f 4929 3a0d 0a20 2020 2020 2020 2020  Y_I):..         
-00003310: 2020 2020 2020 2069 6620 5365 676d 656e         if Segmen
-00003320: 7461 7469 6f6e 4564 6974 6f72 2e69 735f  tationEditor.is_
-00003330: 7368 6966 745f 646f 776e 2829 3a0d 0a20  shift_down():.. 
-00003340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003350: 2020 2073 6566 2e69 6e74 6572 706f 6c61     sef.interpola
-00003360: 7465 203d 206e 6f74 2073 6566 2e69 6e74  te = not sef.int
-00003370: 6572 706f 6c61 7465 0d0a 2020 2020 2020  erpolate..      
-00003380: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00003390: 2073 6566 2e69 6e74 6572 706f 6c61 7465   sef.interpolate
-000033a0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-000033b0: 2020 2020 2020 2020 2020 2073 6566 2e74             sef.t
-000033c0: 6578 7475 7265 2e73 6574 5f6c 696e 6561  exture.set_linea
-000033d0: 725f 696e 7465 7270 6f6c 6174 696f 6e28  r_interpolation(
-000033e0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-000033f0: 2020 2020 2020 2020 2020 2053 6567 6d65             Segme
-00003400: 6e74 6174 696f 6e45 6469 746f 722e 7265  ntationEditor.re
-00003410: 6e64 6572 6572 2e66 626f 312e 7465 7874  nderer.fbo1.text
-00003420: 7572 652e 7365 745f 6c69 6e65 6172 5f69  ure.set_linear_i
-00003430: 6e74 6572 706f 6c61 7469 6f6e 2829 0d0a  nterpolation()..
-00003440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003450: 2020 2020 2020 2020 5365 676d 656e 7461          Segmenta
-00003460: 7469 6f6e 4564 6974 6f72 2e72 656e 6465  tionEditor.rende
-00003470: 7265 722e 6662 6f32 2e74 6578 7475 7265  rer.fbo2.texture
-00003480: 2e73 6574 5f6c 696e 6561 725f 696e 7465  .set_linear_inte
-00003490: 7270 6f6c 6174 696f 6e28 290d 0a20 2020  rpolation()..   
-000034a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000034b0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-000034c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000034d0: 7365 662e 7465 7874 7572 652e 7365 745f  sef.texture.set_
-000034e0: 6e6f 5f69 6e74 6572 706f 6c61 7469 6f6e  no_interpolation
-000034f0: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
-00003500: 2020 2020 2020 2020 2020 2020 5365 676d              Segm
-00003510: 656e 7461 7469 6f6e 4564 6974 6f72 2e72  entationEditor.r
-00003520: 656e 6465 7265 722e 6662 6f31 2e74 6578  enderer.fbo1.tex
-00003530: 7475 7265 2e73 6574 5f6e 6f5f 696e 7465  ture.set_no_inte
-00003540: 7270 6f6c 6174 696f 6e28 290d 0a20 2020  rpolation()..   
-00003550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003560: 2020 2020 2053 6567 6d65 6e74 6174 696f       Segmentatio
-00003570: 6e45 6469 746f 722e 7265 6e64 6572 6572  nEditor.renderer
-00003580: 2e66 626f 322e 7465 7874 7572 652e 7365  .fbo2.texture.se
-00003590: 745f 6e6f 5f69 6e74 6572 706f 6c61 7469  t_no_interpolati
-000035a0: 6f6e 2829 0d0a 2020 2020 2020 2020 2020  on()..          
-000035b0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-000035c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000035d0: 2073 6566 2e69 6e76 6572 7420 3d20 6e6f   sef.invert = no
-000035e0: 7420 7365 662e 696e 7665 7274 0d0a 2020  t sef.invert..  
-000035f0: 2020 2020 2020 2020 2020 6966 2069 6d67            if img
-00003600: 7569 2e69 735f 6b65 795f 7072 6573 7365  ui.is_key_presse
-00003610: 6428 676c 6677 2e4b 4559 5f4f 293a 0d0a  d(glfw.KEY_O):..
-00003620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003630: 5365 676d 656e 7461 7469 6f6e 4564 6974  SegmentationEdit
-00003640: 6f72 2e4f 5645 524c 4159 5f41 4c50 4841  or.OVERLAY_ALPHA
-00003650: 203d 2066 6c6f 6174 286e 6f74 2062 6f6f   = float(not boo
-00003660: 6c28 5365 676d 656e 7461 7469 6f6e 4564  l(SegmentationEd
-00003670: 6974 6f72 2e4f 5645 524c 4159 5f41 4c50  itor.OVERLAY_ALP
-00003680: 4841 2929 0d0a 2020 2020 2020 2020 2020  HA))..          
-00003690: 2020 6966 2069 6d67 7569 2e69 735f 6b65    if imgui.is_ke
-000036a0: 795f 7072 6573 7365 6428 676c 6677 2e4b  y_pressed(glfw.K
-000036b0: 4559 5f41 2920 616e 6420 6e6f 7420 5365  EY_A) and not Se
-000036c0: 676d 656e 7461 7469 6f6e 4564 6974 6f72  gmentationEditor
-000036d0: 2e69 735f 6374 726c 5f64 6f77 6e28 293a  .is_ctrl_down():
-000036e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000036f0: 2020 7365 662e 6175 746f 636f 6e74 7261    sef.autocontra
-00003700: 7374 203d 206e 6f74 2073 6566 2e61 7574  st = not sef.aut
-00003710: 6f63 6f6e 7472 6173 740d 0a20 2020 2020  ocontrast..     
-00003720: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-00003730: 662e 6175 746f 636f 6e74 7261 7374 3a0d  f.autocontrast:.
-00003740: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00003750: 2020 2020 2073 6566 2e63 6f6d 7075 7465       sef.compute
-00003760: 5f61 7574 6f63 6f6e 7472 6173 7428 290d  _autocontrast().
-00003770: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00003780: 696d 6775 692e 6973 5f6b 6579 5f70 7265  imgui.is_key_pre
-00003790: 7373 6564 2867 6c66 772e 4b45 595f 5350  ssed(glfw.KEY_SP
-000037a0: 4143 4529 3a0d 0a20 2020 2020 2020 2020  ACE):..         
-000037b0: 2020 2020 2020 2073 656c 662e 6361 6d65         self.came
-000037c0: 7261 203d 2043 616d 6572 6128 290d 0a20  ra = Camera().. 
-000037d0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-000037e0: 656c 662e 6361 6d65 7261 3364 203d 2043  elf.camera3d = C
-000037f0: 616d 6572 6133 4428 290d 0a20 2020 2020  amera3D()..     
-00003800: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00003810: 6361 6d65 7261 2e7a 6f6f 6d20 3d20 5365  camera.zoom = Se
-00003820: 676d 656e 7461 7469 6f6e 4564 6974 6f72  gmentationEditor
-00003830: 2e44 4546 4155 4c54 5f5a 4f4f 4d0d 0a20  .DEFAULT_ZOOM.. 
-00003840: 2020 2020 2020 2020 2020 2020 2020 2053                 S
-00003850: 6567 6d65 6e74 6174 696f 6e45 6469 746f  egmentationEdito
-00003860: 722e 5649 4557 5f52 4551 5549 5245 535f  r.VIEW_REQUIRES_
-00003870: 5550 4441 5445 203d 2054 7275 650d 0a20  UPDATE = True.. 
-00003880: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-00003890: 6c66 2e61 6374 6976 655f 7461 6220 3d3d  lf.active_tab ==
-000038a0: 2022 5365 676d 656e 7461 7469 6f6e 2220   "Segmentation" 
-000038b0: 616e 6420 6366 672e 7365 5f61 6374 6976  and cfg.se_activ
-000038c0: 655f 6672 616d 652e 6163 7469 7665 5f66  e_frame.active_f
-000038d0: 6561 7475 7265 2069 7320 6e6f 7420 4e6f  eature is not No
-000038e0: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
-000038f0: 2020 2020 2069 6620 696d 6775 692e 6973       if imgui.is
-00003900: 5f6b 6579 5f70 7265 7373 6564 2867 6c66  _key_pressed(glf
-00003910: 772e 4b45 595f 4629 3a0d 0a20 2020 2020  w.KEY_F):..     
-00003920: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00003930: 6667 2e73 655f 6163 7469 7665 5f66 7261  fg.se_active_fra
-00003940: 6d65 2e61 6374 6976 655f 6665 6174 7572  me.active_featur
-00003950: 652e 6d61 6769 6320 3d20 6e6f 7420 6366  e.magic = not cf
-00003960: 672e 7365 5f61 6374 6976 655f 6672 616d  g.se_active_fram
-00003970: 652e 6163 7469 7665 5f66 6561 7475 7265  e.active_feature
-00003980: 2e6d 6167 6963 0d0a 2020 2020 2020 2020  .magic..        
-00003990: 2020 2020 2020 2020 6966 2063 6667 2e73          if cfg.s
-000039a0: 655f 6163 7469 7665 5f66 7261 6d65 2e61  e_active_frame.a
-000039b0: 6374 6976 655f 6665 6174 7572 652e 6d61  ctive_feature.ma
-000039c0: 6769 633a 0d0a 2020 2020 2020 2020 2020  gic:..          
-000039d0: 2020 2020 2020 2020 2020 6966 2069 6d67            if img
-000039e0: 7569 2e69 735f 6b65 795f 7072 6573 7365  ui.is_key_presse
-000039f0: 6428 676c 6677 2e4b 4559 5f4d 494e 5553  d(glfw.KEY_MINUS
-00003a00: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-00003a10: 2020 2020 2020 2020 2020 2020 6366 672e              cfg.
-00003a20: 7365 5f61 6374 6976 655f 6672 616d 652e  se_active_frame.
-00003a30: 6163 7469 7665 5f66 6561 7475 7265 2e6d  active_feature.m
-00003a40: 6167 6963 5f73 7472 656e 6774 6820 2d3d  agic_strength -=
-00003a50: 2035 2e30 0d0a 2020 2020 2020 2020 2020   5.0..          
-00003a60: 2020 2020 2020 2020 2020 2020 2020 6366                cf
-00003a70: 672e 7365 5f61 6374 6976 655f 6672 616d  g.se_active_fram
-00003a80: 652e 6163 7469 7665 5f66 6561 7475 7265  e.active_feature
-00003a90: 2e6d 6167 6963 5f73 7472 656e 6774 6820  .magic_strength 
-00003aa0: 3d20 6d61 7828 5b35 2e30 2c20 6366 672e  = max([5.0, cfg.
-00003ab0: 7365 5f61 6374 6976 655f 6672 616d 652e  se_active_frame.
-00003ac0: 6163 7469 7665 5f66 6561 7475 7265 2e6d  active_feature.m
-00003ad0: 6167 6963 5f73 7472 656e 6774 685d 290d  agic_strength]).
-00003ae0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00003af0: 2020 2020 2065 6c69 6620 696d 6775 692e       elif imgui.
-00003b00: 6973 5f6b 6579 5f70 7265 7373 6564 2867  is_key_pressed(g
-00003b10: 6c66 772e 4b45 595f 4551 5541 4c29 3a0d  lfw.KEY_EQUAL):.
-00003b20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00003b30: 2020 2020 2020 2020 2063 6667 2e73 655f           cfg.se_
-00003b40: 6163 7469 7665 5f66 7261 6d65 2e61 6374  active_frame.act
-00003b50: 6976 655f 6665 6174 7572 652e 6d61 6769  ive_feature.magi
-00003b60: 635f 7374 7265 6e67 7468 202b 3d20 352e  c_strength += 5.
-00003b70: 300d 0a20 2020 2020 2020 2020 2020 2020  0..             
-00003b80: 2020 2020 2020 2020 2020 2063 6667 2e73             cfg.s
-00003b90: 655f 6163 7469 7665 5f66 7261 6d65 2e61  e_active_frame.a
-00003ba0: 6374 6976 655f 6665 6174 7572 652e 6d61  ctive_feature.ma
-00003bb0: 6769 635f 7374 7265 6e67 7468 203d 206d  gic_strength = m
-00003bc0: 696e 285b 3130 302e 302c 2063 6667 2e73  in([100.0, cfg.s
-00003bd0: 655f 6163 7469 7665 5f66 7261 6d65 2e61  e_active_frame.a
-00003be0: 6374 6976 655f 6665 6174 7572 652e 6d61  ctive_feature.ma
-00003bf0: 6769 635f 7374 7265 6e67 7468 5d29 0d0a  gic_strength])..
-00003c00: 0d0a 0d0a 2020 2020 2020 2020 2320 6b65  ....        # ke
-00003c10: 7920 696e 7075 740d 0a20 2020 2020 2020  y input..       
-00003c20: 2061 6374 6976 655f 6672 616d 6520 3d20   active_frame = 
-00003c30: 6366 672e 7365 5f61 6374 6976 655f 6672  cfg.se_active_fr
-00003c40: 616d 650d 0a20 2020 2020 2020 2069 6620  ame..        if 
-00003c50: 6e6f 7420 7365 6c66 2e61 6374 6976 655f  not self.active_
-00003c60: 7461 6220 3d3d 2022 5265 6e64 6572 223a  tab == "Render":
-00003c70: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-00003c80: 2061 6374 6976 655f 6672 616d 6520 696e   active_frame in
-00003c90: 2063 6667 2e73 655f 6672 616d 6573 3a0d   cfg.se_frames:.
-00003ca0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00003cb0: 2069 6620 696d 6775 692e 6973 5f6b 6579   if imgui.is_key
-00003cc0: 5f70 7265 7373 6564 2867 6c66 772e 4b45  _pressed(glfw.KE
-00003cd0: 595f 5550 293a 0d0a 2020 2020 2020 2020  Y_UP):..        
-00003ce0: 2020 2020 2020 2020 2020 2020 6964 7820              idx 
-00003cf0: 3d20 6366 672e 7365 5f66 7261 6d65 732e  = cfg.se_frames.
-00003d00: 696e 6465 7828 6163 7469 7665 5f66 7261  index(active_fra
-00003d10: 6d65 2920 2d20 310d 0a20 2020 2020 2020  me) - 1..       
-00003d20: 2020 2020 2020 2020 2020 2020 2069 6478               idx
-00003d30: 203d 206d 6178 2830 2c20 6964 7829 0d0a   = max(0, idx)..
-00003d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003d50: 2020 2020 5365 676d 656e 7461 7469 6f6e      Segmentation
-00003d60: 4564 6974 6f72 2e73 6574 5f61 6374 6976  Editor.set_activ
-00003d70: 655f 6461 7461 7365 7428 6366 672e 7365  e_dataset(cfg.se
-00003d80: 5f66 7261 6d65 735b 6964 785d 290d 0a20  _frames[idx]).. 
-00003d90: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00003da0: 6c69 6620 696d 6775 692e 6973 5f6b 6579  lif imgui.is_key
-00003db0: 5f70 7265 7373 6564 2867 6c66 772e 4b45  _pressed(glfw.KE
-00003dc0: 595f 444f 574e 293a 0d0a 2020 2020 2020  Y_DOWN):..      
-00003dd0: 2020 2020 2020 2020 2020 2020 2020 6964                id
-00003de0: 7820 3d20 6366 672e 7365 5f66 7261 6d65  x = cfg.se_frame
-00003df0: 732e 696e 6465 7828 6163 7469 7665 5f66  s.index(active_f
-00003e00: 7261 6d65 2920 2b20 310d 0a20 2020 2020  rame) + 1..     
-00003e10: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00003e20: 6478 203d 206d 696e 2869 6478 2c20 6c65  dx = min(idx, le
-00003e30: 6e28 6366 672e 7365 5f66 7261 6d65 7329  n(cfg.se_frames)
-00003e40: 202d 2031 290d 0a20 2020 2020 2020 2020   - 1)..         
-00003e50: 2020 2020 2020 2020 2020 2053 6567 6d65             Segme
-00003e60: 6e74 6174 696f 6e45 6469 746f 722e 7365  ntationEditor.se
-00003e70: 745f 6163 7469 7665 5f64 6174 6173 6574  t_active_dataset
-00003e80: 2863 6667 2e73 655f 6672 616d 6573 5b69  (cfg.se_frames[i
-00003e90: 6478 5d29 0d0a 2020 2020 2020 2020 2020  dx])..          
-00003ea0: 2020 2020 2020 656c 6966 2069 6d67 7569        elif imgui
-00003eb0: 2e69 735f 6b65 795f 7072 6573 7365 6428  .is_key_pressed(
-00003ec0: 676c 6677 2e4b 4559 5f4c 4546 542c 2054  glfw.KEY_LEFT, T
-00003ed0: 7275 6529 3a0d 0a20 2020 2020 2020 2020  rue):..         
-00003ee0: 2020 2020 2020 2020 2020 2061 6374 6976             activ
-00003ef0: 655f 6672 616d 652e 7365 745f 736c 6963  e_frame.set_slic
-00003f00: 6528 6163 7469 7665 5f66 7261 6d65 2e63  e(active_frame.c
-00003f10: 7572 7265 6e74 5f73 6c69 6365 202d 2031  urrent_slice - 1
-00003f20: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00003f30: 2020 2020 2020 2053 6567 6d65 6e74 6174         Segmentat
-00003f40: 696f 6e45 6469 746f 722e 4652 414d 455f  ionEditor.FRAME_
-00003f50: 5445 5854 5552 455f 5245 5155 4952 4553  TEXTURE_REQUIRES
-00003f60: 5f55 5044 4154 4520 7c3d 2054 7275 650d  _UPDATE |= True.
-00003f70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00003f80: 2065 6c69 6620 696d 6775 692e 6973 5f6b   elif imgui.is_k
-00003f90: 6579 5f70 7265 7373 6564 2867 6c66 772e  ey_pressed(glfw.
-00003fa0: 4b45 595f 5249 4748 542c 2054 7275 6529  KEY_RIGHT, True)
-00003fb0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00003fc0: 2020 2020 2020 2061 6374 6976 655f 6672         active_fr
-00003fd0: 616d 652e 7365 745f 736c 6963 6528 6163  ame.set_slice(ac
-00003fe0: 7469 7665 5f66 7261 6d65 2e63 7572 7265  tive_frame.curre
-00003ff0: 6e74 5f73 6c69 6365 202b 2031 290d 0a20  nt_slice + 1).. 
-00004000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004010: 2020 2053 6567 6d65 6e74 6174 696f 6e45     SegmentationE
-00004020: 6469 746f 722e 4652 414d 455f 5445 5854  ditor.FRAME_TEXT
-00004030: 5552 455f 5245 5155 4952 4553 5f55 5044  URE_REQUIRES_UPD
-00004040: 4154 4520 7c3d 2054 7275 650d 0a20 2020  ATE |= True..   
-00004050: 2020 2020 2061 6374 6976 655f 6665 6174       active_feat
-00004060: 7572 6520 3d20 4e6f 6e65 0d0a 2020 2020  ure = None..    
-00004070: 2020 2020 6966 2061 6374 6976 655f 6672      if active_fr
-00004080: 616d 6520 6973 206e 6f74 204e 6f6e 653a  ame is not None:
-00004090: 0d0a 2020 2020 2020 2020 2020 2020 6163  ..            ac
-000040a0: 7469 7665 5f66 6561 7475 7265 203d 2063  tive_feature = c
-000040b0: 6667 2e73 655f 6163 7469 7665 5f66 7261  fg.se_active_fra
-000040c0: 6d65 2e61 6374 6976 655f 6665 6174 7572  me.active_featur
-000040d0: 650d 0a0d 0a20 2020 2020 2020 2023 204b  e....        # K
-000040e0: 6579 2069 6e70 7574 7320 7468 6174 2061  ey inputs that a
-000040f0: 6666 6563 7420 7468 6520 6163 7469 7665  ffect the active
-00004100: 2066 6561 7475 7265 3a0d 0a20 2020 2020   feature:..     
-00004110: 2020 2069 6620 6163 7469 7665 5f66 7261     if active_fra
-00004120: 6d65 2069 7320 6e6f 7420 4e6f 6e65 3a0d  me is not None:.
-00004130: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00004140: 6e6f 7420 5365 676d 656e 7461 7469 6f6e  not Segmentation
-00004150: 4564 6974 6f72 2e69 735f 7368 6966 745f  Editor.is_shift_
-00004160: 646f 776e 2829 2061 6e64 206e 6f74 2053  down() and not S
-00004170: 6567 6d65 6e74 6174 696f 6e45 6469 746f  egmentationEdito
-00004180: 722e 6973 5f63 7472 6c5f 646f 776e 2829  r.is_ctrl_down()
-00004190: 2061 6e64 2061 6374 6976 655f 6672 616d   and active_fram
-000041a0: 6520 6973 206e 6f74 204e 6f6e 653a 0d0a  e is not None:..
-000041b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000041c0: 6966 2073 656c 662e 7769 6e64 6f77 2e73  if self.window.s
-000041d0: 6372 6f6c 6c5f 6465 6c74 615b 315d 2021  croll_delta[1] !
-000041e0: 3d20 302e 303a 0d0a 2020 2020 2020 2020  = 0.0:..        
-000041f0: 2020 2020 2020 2020 2020 2020 6964 7820              idx 
-00004200: 3d20 696e 7428 6163 7469 7665 5f66 7261  = int(active_fra
-00004210: 6d65 2e63 7572 7265 6e74 5f73 6c69 6365  me.current_slice
-00004220: 202d 2073 656c 662e 7769 6e64 6f77 2e73   - self.window.s
-00004230: 6372 6f6c 6c5f 6465 6c74 615b 315d 290d  croll_delta[1]).
-00004240: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004250: 2020 2020 2069 6478 203d 2069 6478 2025       idx = idx %
-00004260: 2061 6374 6976 655f 6672 616d 652e 6e5f   active_frame.n_
-00004270: 736c 6963 6573 0d0a 2020 2020 2020 2020  slices..        
-00004280: 2020 2020 2020 2020 2020 2020 6163 7469              acti
-00004290: 7665 5f66 7261 6d65 2e73 6574 5f73 6c69  ve_frame.set_sli
-000042a0: 6365 2869 6478 290d 0a20 2020 2020 2020  ce(idx)..       
-000042b0: 2020 2020 2020 2020 2020 2020 2053 6567               Seg
-000042c0: 6d65 6e74 6174 696f 6e45 6469 746f 722e  mentationEditor.
-000042d0: 4652 414d 455f 5445 5854 5552 455f 5245  FRAME_TEXTURE_RE
-000042e0: 5155 4952 4553 5f55 5044 4154 4520 7c3d  QUIRES_UPDATE |=
-000042f0: 2054 7275 650d 0a0d 0a20 2020 2020 2020   True....       
-00004300: 2069 6620 7365 6c66 2e61 6374 6976 655f   if self.active_
-00004310: 7461 6220 3d3d 2022 5365 676d 656e 7461  tab == "Segmenta
-00004320: 7469 6f6e 223a 0d0a 2020 2020 2020 2020  tion":..        
-00004330: 2020 2020 6966 2061 6374 6976 655f 6665      if active_fe
-00004340: 6174 7572 6520 6973 206e 6f74 204e 6f6e  ature is not Non
-00004350: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00004360: 2020 2020 6966 2053 6567 6d65 6e74 6174      if Segmentat
-00004370: 696f 6e45 6469 746f 722e 6973 5f63 7472  ionEditor.is_ctr
-00004380: 6c5f 646f 776e 2829 2061 6e64 2061 6374  l_down() and act
-00004390: 6976 655f 6665 6174 7572 6520 6973 206e  ive_feature is n
-000043a0: 6f74 204e 6f6e 653a 0d0a 2020 2020 2020  ot None:..      
-000043b0: 2020 2020 2020 2020 2020 2020 2020 6163                ac
-000043c0: 7469 7665 5f66 6561 7475 7265 2e62 7275  tive_feature.bru
-000043d0: 7368 5f73 697a 6520 2b3d 2073 656c 662e  sh_size += self.
-000043e0: 7769 6e64 6f77 2e73 6372 6f6c 6c5f 6465  window.scroll_de
-000043f0: 6c74 615b 315d 0d0a 2020 2020 2020 2020  lta[1]..        
-00004400: 2020 2020 2020 2020 2020 2020 6163 7469              acti
-00004410: 7665 5f66 6561 7475 7265 2e62 7275 7368  ve_feature.brush
-00004420: 5f73 697a 6520 3d20 6d61 7828 5b31 2c20  _size = max([1, 
-00004430: 6163 7469 7665 5f66 6561 7475 7265 2e62  active_feature.b
-00004440: 7275 7368 5f73 697a 655d 290d 0a20 2020  rush_size])..   
-00004450: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00004460: 696d 6775 692e 6973 5f6b 6579 5f70 7265  imgui.is_key_pre
-00004470: 7373 6564 2867 6c66 772e 4b45 595f 5329  ssed(glfw.KEY_S)
-00004480: 2061 6e64 206e 6f74 2069 6d67 7569 2e69   and not imgui.i
-00004490: 735f 6b65 795f 646f 776e 2867 6c66 772e  s_key_down(glfw.
-000044a0: 4b45 595f 4c45 4654 5f43 4f4e 5452 4f4c  KEY_LEFT_CONTROL
-000044b0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-000044c0: 2020 2020 2020 2020 6964 7820 3d20 3020          idx = 0 
-000044d0: 6966 2061 6374 6976 655f 6665 6174 7572  if active_featur
-000044e0: 6520 6e6f 7420 696e 2061 6374 6976 655f  e not in active_
-000044f0: 6672 616d 652e 6665 6174 7572 6573 2065  frame.features e
-00004500: 6c73 6520 6163 7469 7665 5f66 7261 6d65  lse active_frame
-00004510: 2e66 6561 7475 7265 732e 696e 6465 7828  .features.index(
-00004520: 6163 7469 7665 5f66 6561 7475 7265 290d  active_feature).
-00004530: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004540: 2020 2020 2069 6478 203d 2028 6964 7820       idx = (idx 
-00004550: 2b20 3129 2025 206c 656e 2861 6374 6976  + 1) % len(activ
-00004560: 655f 6672 616d 652e 6665 6174 7572 6573  e_frame.features
-00004570: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00004580: 2020 2020 2020 2063 6667 2e73 655f 6163         cfg.se_ac
-00004590: 7469 7665 5f66 7261 6d65 2e61 6374 6976  tive_frame.activ
-000045a0: 655f 6665 6174 7572 6520 3d20 6366 672e  e_feature = cfg.
-000045b0: 7365 5f61 6374 6976 655f 6672 616d 652e  se_active_frame.
-000045c0: 6665 6174 7572 6573 5b69 6478 5d0d 0a20  features[idx].. 
-000045d0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-000045e0: 6c69 6620 696d 6775 692e 6973 5f6b 6579  lif imgui.is_key
-000045f0: 5f70 7265 7373 6564 2867 6c66 772e 4b45  _pressed(glfw.KE
-00004600: 595f 5729 3a0d 0a20 2020 2020 2020 2020  Y_W):..         
-00004610: 2020 2020 2020 2020 2020 2069 6478 203d             idx =
-00004620: 2030 2069 6620 6163 7469 7665 5f66 6561   0 if active_fea
-00004630: 7475 7265 206e 6f74 2069 6e20 6163 7469  ture not in acti
-00004640: 7665 5f66 7261 6d65 2e66 6561 7475 7265  ve_frame.feature
-00004650: 7320 656c 7365 2061 6374 6976 655f 6672  s else active_fr
-00004660: 616d 652e 6665 6174 7572 6573 2e69 6e64  ame.features.ind
-00004670: 6578 2861 6374 6976 655f 6665 6174 7572  ex(active_featur
-00004680: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
-00004690: 2020 2020 2020 2020 6964 7820 3d20 2869          idx = (i
-000046a0: 6478 202d 2031 2920 2520 6c65 6e28 6163  dx - 1) % len(ac
-000046b0: 7469 7665 5f66 7261 6d65 2e66 6561 7475  tive_frame.featu
-000046c0: 7265 7329 0d0a 2020 2020 2020 2020 2020  res)..          
-000046d0: 2020 2020 2020 2020 2020 6366 672e 7365            cfg.se
-000046e0: 5f61 6374 6976 655f 6672 616d 652e 6163  _active_frame.ac
-000046f0: 7469 7665 5f66 6561 7475 7265 203d 2063  tive_feature = c
-00004700: 6667 2e73 655f 6163 7469 7665 5f66 7261  fg.se_active_fra
-00004710: 6d65 2e66 6561 7475 7265 735b 6964 785d  me.features[idx]
-00004720: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-00004730: 2320 4472 6177 696e 6720 2f20 6d6f 7573  # Drawing / mous
-00004740: 6520 696e 7075 740d 0a20 2020 2020 2020  e input..       
-00004750: 2020 2020 2069 6620 6163 7469 7665 5f66       if active_f
-00004760: 6561 7475 7265 2069 7320 6e6f 7420 4e6f  eature is not No
-00004770: 6e65 2061 6e64 206e 6f74 2069 6d67 7569  ne and not imgui
-00004780: 2e67 6574 5f69 6f28 292e 7761 6e74 5f63  .get_io().want_c
-00004790: 6170 7475 7265 5f6d 6f75 7365 3a0d 0a20  apture_mouse:.. 
-000047a0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-000047b0: 7572 736f 725f 776f 726c 645f 706f 7369  ursor_world_posi
-000047c0: 7469 6f6e 203d 2073 656c 662e 6361 6d65  tion = self.came
-000047d0: 7261 2e63 7572 736f 725f 746f 5f77 6f72  ra.cursor_to_wor
-000047e0: 6c64 5f70 6f73 6974 696f 6e28 7365 6c66  ld_position(self
-000047f0: 2e77 696e 646f 772e 6375 7273 6f72 5f70  .window.cursor_p
-00004800: 6f73 290d 0a20 2020 2020 2020 2020 2020  os)..           
-00004810: 2020 2020 2070 6978 656c 5f63 6f6f 7264       pixel_coord
-00004820: 696e 6174 6520 3d20 6163 7469 7665 5f66  inate = active_f
-00004830: 6561 7475 7265 2e70 6172 656e 742e 776f  eature.parent.wo
-00004840: 726c 645f 746f 5f70 6978 656c 5f63 6f6f  rld_to_pixel_coo
-00004850: 7264 696e 6174 6528 6375 7273 6f72 5f77  rdinate(cursor_w
-00004860: 6f72 6c64 5f70 6f73 6974 696f 6e29 0d0a  orld_position)..
-00004870: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-00004880: 2020 2020 6966 206e 6f74 2053 6567 6d65      if not Segme
-00004890: 6e74 6174 696f 6e45 6469 746f 722e 6973  ntationEditor.is
-000048a0: 5f73 6869 6674 5f64 6f77 6e28 293a 0d0a  _shift_down():..
-000048b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000048c0: 2020 2020 6966 2069 6d67 7569 2e69 735f      if imgui.is_
-000048d0: 6d6f 7573 655f 646f 776e 2830 293a 0d0a  mouse_down(0):..
-000048e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000048f0: 2020 2020 2020 2020 6163 7469 7665 5f66          active_f
-00004900: 6561 7475 7265 2e68 6964 6520 3d20 4661  eature.hide = Fa
-00004910: 6c73 650d 0a20 2020 2020 2020 2020 2020  lse..           
-00004920: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00004930: 6163 7469 7665 5f66 6561 7475 7265 2e6d  active_feature.m
-00004940: 6167 6963 3a0d 0a20 2020 2020 2020 2020  agic:..         
-00004950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004960: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
-00004970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004980: 2020 2020 2020 2020 2042 7275 7368 2e61           Brush.a
-00004990: 7070 6c79 5f6d 6167 6963 2861 6374 6976  pply_magic(activ
-000049a0: 655f 6665 6174 7572 652c 2061 6374 6976  e_feature, activ
-000049b0: 655f 6665 6174 7572 652e 7061 7265 6e74  e_feature.parent
-000049c0: 2e72 656e 6465 7265 645f 6461 7461 2c20  .rendered_data, 
-000049d0: 7069 7865 6c5f 636f 6f72 6469 6e61 7465  pixel_coordinate
-000049e0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-000049f0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00004a00: 7863 6570 7420 4578 6365 7074 696f 6e20  xcept Exception 
-00004a10: 6173 2065 3a0d 0a20 2020 2020 2020 2020  as e:..         
-00004a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004a30: 2020 2020 2020 2070 6173 7320 2023 2062         pass  # b
-00004a40: 6974 2065 7870 6572 696d 656e 7461 6c20  it experimental 
-00004a50: 7374 696c 6c2e 2054 4f44 4f3a 2066 6978  still. TODO: fix
-00004a60: 2065 7272 6f72 2074 6872 6f77 6e20 7768   error thrown wh
-00004a70: 656e 2066 6c6f 6f64 2066 696c 6c20 524f  en flood fill RO
-00004a80: 4920 7061 7274 6961 6c6c 7920 6661 6c6c  I partially fall
-00004a90: 7320 6f75 7473 6964 6520 696d 6167 652e  s outside image.
-00004aa0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00004ab0: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
-00004ac0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004ad0: 2020 2020 2020 2020 2020 2020 2042 7275               Bru
-00004ae0: 7368 2e61 7070 6c79 5f63 6972 6375 6c61  sh.apply_circula
-00004af0: 7228 6163 7469 7665 5f66 6561 7475 7265  r(active_feature
-00004b00: 2c20 7069 7865 6c5f 636f 6f72 6469 6e61  , pixel_coordina
-00004b10: 7465 2c20 5472 7565 290d 0a20 2020 2020  te, True)..     
-00004b20: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00004b30: 6c69 6620 696d 6775 692e 6973 5f6d 6f75  lif imgui.is_mou
-00004b40: 7365 5f64 6f77 6e28 3129 3a0d 0a20 2020  se_down(1):..   
-00004b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004b60: 2020 2020 2042 7275 7368 2e61 7070 6c79       Brush.apply
-00004b70: 5f63 6972 6375 6c61 7228 6163 7469 7665  _circular(active
-00004b80: 5f66 6561 7475 7265 2c20 7069 7865 6c5f  _feature, pixel_
-00004b90: 636f 6f72 6469 6e61 7465 2c20 4661 6c73  coordinate, Fals
-00004ba0: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
-00004bb0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00004bc0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00004bd0: 6620 696d 6775 692e 6973 5f6d 6f75 7365  f imgui.is_mouse
-00004be0: 5f63 6c69 636b 6564 2830 293a 0d0a 2020  _clicked(0):..  
-00004bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004c00: 2020 2020 2020 6163 7469 7665 5f66 6561        active_fea
-00004c10: 7475 7265 2e61 6464 5f62 6f78 2870 6978  ture.add_box(pix
-00004c20: 656c 5f63 6f6f 7264 696e 6174 6529 0d0a  el_coordinate)..
-00004c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004c40: 2020 2020 656c 6966 2069 6d67 7569 2e69      elif imgui.i
-00004c50: 735f 6d6f 7573 655f 636c 6963 6b65 6428  s_mouse_clicked(
-00004c60: 3129 3a0d 0a20 2020 2020 2020 2020 2020  1):..           
-00004c70: 2020 2020 2020 2020 2020 2020 2061 6374               act
-00004c80: 6976 655f 6665 6174 7572 652e 7265 6d6f  ive_feature.remo
-00004c90: 7665 5f62 6f78 2870 6978 656c 5f63 6f6f  ve_box(pixel_coo
-00004ca0: 7264 696e 6174 6529 0d0a 2020 2020 2020  rdinate)..      
-00004cb0: 2020 656c 6966 2073 656c 662e 6163 7469    elif self.acti
-00004cc0: 7665 5f74 6162 2021 3d20 2252 656e 6465  ve_tab != "Rende
-00004cd0: 7222 2061 6e64 2061 6374 6976 655f 6672  r" and active_fr
-00004ce0: 616d 6520 6973 206e 6f74 204e 6f6e 6520  ame is not None 
-00004cf0: 616e 6420 6163 7469 7665 5f66 7261 6d65  and active_frame
-00004d00: 2e63 726f 7020 616e 6420 6e6f 7420 696d  .crop and not im
-00004d10: 6775 692e 6765 745f 696f 2829 2e77 616e  gui.get_io().wan
-00004d20: 745f 6361 7074 7572 655f 6d6f 7573 653a  t_capture_mouse:
-00004d30: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-00004d40: 206e 6f74 2073 656c 662e 6372 6f70 5f68   not self.crop_h
-00004d50: 616e 646c 6573 5b30 5d2e 6d6f 7669 6e67  andles[0].moving
-00004d60: 5f65 6e74 6972 655f 726f 693a 0d0a 2020  _entire_roi:..  
-00004d70: 2020 2020 2020 2020 2020 2020 2020 616e                an
-00004d80: 795f 6861 6e64 6c65 5f61 6374 6976 6520  y_handle_active 
-00004d90: 3d20 4661 6c73 650d 0a20 2020 2020 2020  = False..       
-00004da0: 2020 2020 2020 2020 2066 6f72 2068 2069           for h i
-00004db0: 6e20 7365 6c66 2e63 726f 705f 6861 6e64  n self.crop_hand
-00004dc0: 6c65 733a 0d0a 2020 2020 2020 2020 2020  les:..          
-00004dd0: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
-00004de0: 2068 2e61 6374 6976 6520 616e 6420 682e   h.active and h.
-00004df0: 6973 5f68 6f76 6572 6564 2873 656c 662e  is_hovered(self.
-00004e00: 6361 6d65 7261 2c20 7365 6c66 2e77 696e  camera, self.win
-00004e10: 646f 772e 6375 7273 6f72 5f70 6f73 2920  dow.cursor_pos) 
-00004e20: 616e 6420 696d 6775 692e 6973 5f6d 6f75  and imgui.is_mou
-00004e30: 7365 5f63 6c69 636b 6564 2830 293a 0d0a  se_clicked(0):..
-00004e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004e50: 2020 2020 2020 2020 682e 6163 7469 7665          h.active
-00004e60: 203d 2054 7275 650d 0a20 2020 2020 2020   = True..       
-00004e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004e80: 2061 6e79 5f68 616e 646c 655f 6163 7469   any_handle_acti
-00004e90: 7665 203d 2046 616c 7365 0d0a 2020 2020  ve = False..    
-00004ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004eb0: 6966 2068 2e61 6374 6976 653a 0d0a 2020  if h.active:..  
-00004ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004ed0: 2020 2020 2020 616e 795f 6861 6e64 6c65        any_handle
-00004ee0: 5f61 6374 6976 6520 3d20 5472 7565 0d0a  _active = True..
-00004ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004f00: 2020 2020 2020 2020 776f 726c 645f 706f          world_po
-00004f10: 7320 3d20 7365 6c66 2e63 616d 6572 612e  s = self.camera.
-00004f20: 6375 7273 6f72 5f74 6f5f 776f 726c 645f  cursor_to_world_
-00004f30: 706f 7369 7469 6f6e 2873 656c 662e 7769  position(self.wi
-00004f40: 6e64 6f77 2e63 7572 736f 725f 706f 7329  ndow.cursor_pos)
-00004f50: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00004f60: 2020 2020 2020 2020 2020 7069 7865 6c5f            pixel_
-00004f70: 706f 7320 3d20 6163 7469 7665 5f66 7261  pos = active_fra
-00004f80: 6d65 2e77 6f72 6c64 5f74 6f5f 7069 7865  me.world_to_pixe
-00004f90: 6c5f 636f 6f72 6469 6e61 7465 2877 6f72  l_coordinate(wor
-00004fa0: 6c64 5f70 6f73 290d 0a20 2020 2020 2020  ld_pos)..       
-00004fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004fc0: 2068 2e61 6666 6563 745f 6372 6f70 2870   h.affect_crop(p
-00004fd0: 6978 656c 5f70 6f73 290d 0a20 2020 2020  ixel_pos)..     
-00004fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004ff0: 2020 2069 6620 6e6f 7420 696d 6775 692e     if not imgui.
-00005000: 6973 5f6d 6f75 7365 5f64 6f77 6e28 3029  is_mouse_down(0)
-00005010: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00005020: 2020 2020 2020 2020 2020 2020 2020 2068                 h
-00005030: 2e61 6374 6976 6520 3d20 4661 6c73 650d  .active = False.
-00005040: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00005050: 2020 2020 2020 2020 2020 2020 2068 2e63               h.c
-00005060: 6f6e 7665 7274 5f63 726f 705f 726f 695f  onvert_crop_roi_
-00005070: 746f 5f69 6e74 6567 6572 7328 290d 0a20  to_integers().. 
-00005080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005090: 2020 2020 2020 2020 2020 2063 6667 2e73             cfg.s
-000050a0: 655f 6163 7469 7665 5f66 7261 6d65 2e73  e_active_frame.s
-000050b0: 6c69 6365 5f63 6861 6e67 6564 203d 2054  lice_changed = T
-000050c0: 7275 6520 2023 206e 6f74 2072 6561 6c6c  rue  # not reall
-000050d0: 792c 2062 7574 2074 6869 7320 666c 6167  y, but this flag
-000050e0: 2069 7320 616c 736f 2075 7365 6420 746f   is also used to
-000050f0: 2074 7269 6767 6572 2061 206d 6f64 656c   trigger a model
-00005100: 2075 7064 6174 652e 0d0a 2020 2020 2020   update...      
-00005110: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
-00005120: 2061 6e79 5f68 616e 646c 655f 6163 7469   any_handle_acti
-00005130: 7665 2061 6e64 2069 6d67 7569 2e69 735f  ve and imgui.is_
-00005140: 6d6f 7573 655f 636c 6963 6b65 6428 3029  mouse_clicked(0)
-00005150: 3a20 2323 2054 4f44 4f3a 206f 6e6c 7920  : ## TODO: only 
-00005160: 7768 656e 206d 6f75 7365 2069 7320 636c  when mouse is cl
-00005170: 6963 6b65 6420 7769 7468 696e 2052 4f49  icked within ROI
-00005180: 210d 0a20 2020 2020 2020 2020 2020 2020  !..             
-00005190: 2020 2020 2020 2073 656c 662e 6372 6f70         self.crop
-000051a0: 5f68 616e 646c 6573 5b30 5d2e 6d6f 7669  _handles[0].movi
-000051b0: 6e67 5f65 6e74 6972 655f 726f 6920 3d20  ng_entire_roi = 
-000051c0: 5472 7565 0d0a 2020 2020 2020 2020 2020  True..          
-000051d0: 2020 2020 2020 2020 2020 7365 6c66 2e63            self.c
-000051e0: 726f 705f 6861 6e64 6c65 735b 305d 2e63  rop_handles[0].c
-000051f0: 6f6e 7665 7274 5f63 726f 705f 726f 695f  onvert_crop_roi_
-00005200: 746f 5f69 6e74 6567 6572 7328 290d 0a20  to_integers().. 
-00005210: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00005220: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00005230: 2020 6966 206e 6f74 2069 6d67 7569 2e69    if not imgui.i
-00005240: 735f 6d6f 7573 655f 646f 776e 2830 293a  s_mouse_down(0):
-00005250: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00005260: 2020 2020 2020 7365 6c66 2e63 726f 705f        self.crop_
-00005270: 6861 6e64 6c65 735b 305d 2e6d 6f76 696e  handles[0].movin
-00005280: 675f 656e 7469 7265 5f72 6f69 203d 2046  g_entire_roi = F
-00005290: 616c 7365 0d0a 2020 2020 2020 2020 2020  alse..          
-000052a0: 2020 2020 2020 2020 2020 7365 6c66 2e63            self.c
-000052b0: 726f 705f 6861 6e64 6c65 735b 305d 2e63  rop_handles[0].c
-000052c0: 6f6e 7665 7274 5f63 726f 705f 726f 695f  onvert_crop_roi_
-000052d0: 746f 5f69 6e74 6567 6572 7328 290d 0a20  to_integers().. 
-000052e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000052f0: 2020 2063 6667 2e73 655f 6163 7469 7665     cfg.se_active
-00005300: 5f66 7261 6d65 2e73 6c69 6365 5f63 6861  _frame.slice_cha
-00005310: 6e67 6564 203d 2054 7275 6520 2023 206e  nged = True  # n
-00005320: 6f74 2072 6561 6c6c 792c 2062 7574 2074  ot really, but t
-00005330: 6869 7320 666c 6167 2069 7320 616c 736f  his flag is also
-00005340: 2075 7365 6420 746f 2074 7269 6767 6572   used to trigger
-00005350: 2061 206d 6f64 656c 2075 7064 6174 652e   a model update.
-00005360: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00005370: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-00005380: 2020 2020 2020 2020 2020 2020 2077 6f72               wor
-00005390: 6c64 5f70 6f73 5f6f 6c64 203d 2073 656c  ld_pos_old = sel
-000053a0: 662e 6361 6d65 7261 2e63 7572 736f 725f  f.camera.cursor_
-000053b0: 746f 5f77 6f72 6c64 5f70 6f73 6974 696f  to_world_positio
-000053c0: 6e28 7365 6c66 2e77 696e 646f 772e 6375  n(self.window.cu
-000053d0: 7273 6f72 5f70 6f73 5f70 7265 7669 6f75  rsor_pos_previou
-000053e0: 735f 6672 616d 6529 0d0a 2020 2020 2020  s_frame)..      
-000053f0: 2020 2020 2020 2020 2020 2020 2020 776f                wo
-00005400: 726c 645f 706f 7320 3d20 7365 6c66 2e63  rld_pos = self.c
-00005410: 616d 6572 612e 6375 7273 6f72 5f74 6f5f  amera.cursor_to_
-00005420: 776f 726c 645f 706f 7369 7469 6f6e 2873  world_position(s
-00005430: 656c 662e 7769 6e64 6f77 2e63 7572 736f  elf.window.curso
-00005440: 725f 706f 7329 0d0a 2020 2020 2020 2020  r_pos)..        
-00005450: 2020 2020 2020 2020 2020 2020 776f 726c              worl
-00005460: 645f 6465 6c74 6120 3d20 6e70 2e61 7272  d_delta = np.arr
-00005470: 6179 285b 2d28 776f 726c 645f 706f 735f  ay([-(world_pos_
-00005480: 6f6c 645b 305d 202d 2077 6f72 6c64 5f70  old[0] - world_p
-00005490: 6f73 5b30 5d29 2c20 776f 726c 645f 706f  os[0]), world_po
-000054a0: 735f 6f6c 645b 315d 202d 2077 6f72 6c64  s_old[1] - world
-000054b0: 5f70 6f73 5b31 5d5d 2920 2f20 6366 672e  _pos[1]]) / cfg.
-000054c0: 7365 5f61 6374 6976 655f 6672 616d 652e  se_active_frame.
-000054d0: 7069 7865 6c5f 7369 7a65 0d0a 2020 2020  pixel_size..    
-000054e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000054f0: 7365 6c66 2e63 726f 705f 6861 6e64 6c65  self.crop_handle
-00005500: 735b 305d 2e6d 6f76 655f 6372 6f70 5f72  s[0].move_crop_r
-00005510: 6f69 2877 6f72 6c64 5f64 656c 7461 5b30  oi(world_delta[0
-00005520: 5d2c 2077 6f72 6c64 5f64 656c 7461 5b31  ], world_delta[1
-00005530: 5d29 0d0a 0d0a 2020 2020 6465 6620 696d  ])....    def im
-00005540: 706f 7274 5f64 6174 6173 6574 2873 656c  port_dataset(sel
-00005550: 662c 2066 696c 656e 616d 6529 3a0d 0a20  f, filename):.. 
-00005560: 2020 2020 2020 2023 2054 4f44 4f3a 2075         # TODO: u
-00005570: 706f 6e20 696d 706f 7274 2c20 6966 2073  pon import, if s
-00005580: 634e 6f64 6573 2c20 6966 2068 6173 206f  cNodes, if has o
-00005590: 7665 726c 6179 2061 6e64 206f 7665 726c  verlay and overl
-000055a0: 6179 2e63 6c65 6d5f 6672 616d 652e 7061  ay.clem_frame.pa
-000055b0: 7468 2066 6f75 6e64 2069 6e20 616e 7920  th found in any 
-000055c0: 434c 454d 4672 616d 6527 7320 7061 7468  CLEMFrame's path
-000055d0: 2c20 6c69 6e6b 2043 4c45 4d46 7261 6d65  , link CLEMFrame
-000055e0: 2061 6e64 2053 4546 7261 6d65 2073 2e74   and SEFrame s.t
-000055f0: 2e20 6f76 6572 6c61 7920 6361 6e20 6265  . overlay can be
-00005600: 2075 7064 6174 6564 2e0d 0a20 2020 2020   updated...     
-00005610: 2020 2053 6567 6d65 6e74 6174 696f 6e45     SegmentationE
-00005620: 6469 746f 722e 5348 4f57 5f42 4f4f 545f  ditor.SHOW_BOOT_
-00005630: 5350 5249 5445 203d 2046 616c 7365 0d0a  SPRITE = False..
-00005640: 2020 2020 2020 2020 7472 793a 0d0a 2020          try:..  
-00005650: 2020 2020 2020 2020 2020 5f2c 2065 7874            _, ext
-00005660: 203d 206f 732e 7061 7468 2e73 706c 6974   = os.path.split
-00005670: 6578 7428 6669 6c65 6e61 6d65 290d 0a20  ext(filename).. 
-00005680: 2020 2020 2020 2020 2020 2069 6620 6578             if ex
-00005690: 7420 3d3d 2022 2e6d 7263 223a 0d0a 2020  t == ".mrc":..  
-000056a0: 2020 2020 2020 2020 2020 2020 2020 6366                cf
-000056b0: 672e 7365 5f66 7261 6d65 732e 6170 7065  g.se_frames.appe
-000056c0: 6e64 2853 4546 7261 6d65 2866 696c 656e  nd(SEFrame(filen
-000056d0: 616d 6529 290d 0a20 2020 2020 2020 2020  ame))..         
-000056e0: 2020 2020 2020 2053 6567 6d65 6e74 6174         Segmentat
-000056f0: 696f 6e45 6469 746f 722e 7365 745f 6163  ionEditor.set_ac
-00005700: 7469 7665 5f64 6174 6173 6574 2863 6667  tive_dataset(cfg
-00005710: 2e73 655f 6672 616d 6573 5b2d 315d 290d  .se_frames[-1]).
-00005720: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00005730: 2073 656c 662e 7061 7273 655f 6176 6169   self.parse_avai
-00005740: 6c61 626c 655f 6665 6174 7572 6573 2829  lable_features()
-00005750: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
-00005760: 6966 2065 7874 203d 3d20 6366 672e 6669  if ext == cfg.fi
-00005770: 6c65 7479 7065 5f73 6567 6d65 6e74 6174  letype_segmentat
-00005780: 696f 6e3a 0d0a 2020 2020 2020 2020 2020  ion:..          
-00005790: 2020 2020 2020 7769 7468 206f 7065 6e28        with open(
-000057a0: 6669 6c65 6e61 6d65 2c20 2772 6227 2920  filename, 'rb') 
-000057b0: 6173 2070 6963 6b6c 655f 6669 6c65 3a0d  as pickle_file:.
-000057c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000057d0: 2020 2020 2073 6566 7261 6d65 203d 2070       seframe = p
-000057e0: 6963 6b6c 652e 6c6f 6164 2870 6963 6b6c  ickle.load(pickl
-000057f0: 655f 6669 6c65 290d 0a20 2020 2020 2020  e_file)..       
-00005800: 2020 2020 2020 2020 2020 2020 2073 6566               sef
-00005810: 7261 6d65 2e6f 6e5f 6c6f 6164 2829 0d0a  rame.on_load()..
-00005820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005830: 2020 2020 7365 6672 616d 652e 736c 6963      seframe.slic
-00005840: 655f 6368 616e 6765 6420 3d20 4661 6c73  e_changed = Fals
-00005850: 650d 0a20 2020 2020 2020 2020 2020 2020  e..             
-00005860: 2020 2020 2020 2063 6667 2e73 655f 6672         cfg.se_fr
-00005870: 616d 6573 2e61 7070 656e 6428 7365 6672  ames.append(sefr
-00005880: 616d 6529 0d0a 2020 2020 2020 2020 2020  ame)..          
-00005890: 2020 2020 2020 2020 2020 5365 676d 656e            Segmen
-000058a0: 7461 7469 6f6e 4564 6974 6f72 2e73 6574  tationEditor.set
-000058b0: 5f61 6374 6976 655f 6461 7461 7365 7428  _active_dataset(
-000058c0: 6366 672e 7365 5f66 7261 6d65 735b 2d31  cfg.se_frames[-1
-000058d0: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
-000058e0: 2020 2020 2020 2020 6966 2073 6566 7261          if sefra
-000058f0: 6d65 2e69 6e63 6c75 6465 735f 6d61 703a  me.includes_map:
-00005900: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00005910: 2020 2020 2020 2020 2020 7365 6672 616d            sefram
-00005920: 652e 7061 7468 203d 2066 696c 656e 616d  e.path = filenam
-00005930: 655b 3a2d 6c65 6e28 6366 672e 6669 6c65  e[:-len(cfg.file
-00005940: 7479 7065 5f73 6567 6d65 6e74 6174 696f  type_segmentatio
-00005950: 6e29 5d2b 222e 6d72 6322 2020 2320 2776  n)]+".mrc"  # 'v
-00005960: 6972 7475 616c 2720 6669 6c65 2070 6174  irtual' file pat
-00005970: 682c 2070 6f69 6e74 696e 6720 6174 2074  h, pointing at t
-00005980: 6865 206c 6f63 6174 696f 6e20 6f66 2074  he location of t
-00005990: 6865 202e 7363 6e73 2066 696c 6520 6275  he .scns file bu
-000059a0: 7420 656e 6469 6e67 2077 6974 6820 2e6d  t ending with .m
-000059b0: 7263 2073 2e74 2e20 6d6f 6465 6c20 6f75  rc s.t. model ou
-000059c0: 7470 7574 2072 6567 6578 2064 6f65 736e  tput regex doesn
-000059d0: 2774 2067 6574 206d 6573 7365 6420 7570  't get messed up
-000059e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000059f0: 2020 7365 6c66 2e70 6172 7365 5f61 7661    self.parse_ava
-00005a00: 696c 6162 6c65 5f66 6561 7475 7265 7328  ilable_features(
-00005a10: 290d 0a20 2020 2020 2020 2065 7863 6570  )..        excep
-00005a20: 7420 4578 6365 7074 696f 6e20 6173 2065  t Exception as e
-00005a30: 3a0d 0a20 2020 2020 2020 2020 2020 2063  :..            c
-00005a40: 6667 2e73 6574 5f65 7272 6f72 2865 2c20  fg.set_error(e, 
-00005a50: 2245 7272 6f72 2069 6d70 6f72 7469 6e67  "Error importing
-00005a60: 2064 6174 6173 6574 2c20 7365 6520 6465   dataset, see de
-00005a70: 7461 696c 7320 6265 6c6f 773a 2229 0d0a  tails below:")..
-00005a80: 0d0a 2020 2020 4073 7461 7469 636d 6574  ..    @staticmet
-00005a90: 686f 640d 0a20 2020 2064 6566 2073 6176  hod..    def sav
-00005aa0: 655f 6461 7461 7365 7428 6469 616c 6f67  e_dataset(dialog
-00005ab0: 3d46 616c 7365 293a 0d0a 2020 2020 2020  =False):..      
-00005ac0: 2020 7472 793a 0d0a 2020 2020 2020 2020    try:..        
-00005ad0: 2020 2020 6465 6661 756c 745f 6e61 6d65      default_name
-00005ae0: 203d 2063 6667 2e73 655f 6163 7469 7665   = cfg.se_active
-00005af0: 5f66 7261 6d65 2e70 6174 685b 3a2d 345d  _frame.path[:-4]
-00005b00: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-00005b10: 2064 6961 6c6f 673a 0d0a 2020 2020 2020   dialog:..      
-00005b20: 2020 2020 2020 2020 2020 6669 6c65 6e61            filena
-00005b30: 6d65 203d 2066 696c 6564 6961 6c6f 672e  me = filedialog.
-00005b40: 6173 6b73 6176 6561 7366 696c 656e 616d  asksaveasfilenam
-00005b50: 6528 0d0a 2020 2020 2020 2020 2020 2020  e(..            
-00005b60: 2020 2020 2020 2020 6669 6c65 7479 7065          filetype
-00005b70: 733d 5b28 2273 634e 6f64 6573 2073 6567  s=[("scNodes seg
-00005b80: 6d65 6e74 6174 696f 6e22 2c20 6622 7b63  mentation", f"{c
-00005b90: 6667 2e66 696c 6574 7970 655f 7365 676d  fg.filetype_segm
-00005ba0: 656e 7461 7469 6f6e 7d22 295d 2c0d 0a20  entation}")],.. 
-00005bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005bc0: 2020 2069 6e69 7469 616c 6669 6c65 3d64     initialfile=d
-00005bd0: 6566 6175 6c74 5f6e 616d 6529 0d0a 2020  efault_name)..  
-00005be0: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
-00005bf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00005c00: 2066 696c 656e 616d 6520 3d20 6465 6661   filename = defa
-00005c10: 756c 745f 6e61 6d65 0d0a 2020 2020 2020  ult_name..      
-00005c20: 2020 2020 2020 6966 2066 696c 656e 616d        if filenam
-00005c30: 6520 213d 2027 273a 0d0a 2020 2020 2020  e != '':..      
-00005c40: 2020 2020 2020 2020 2020 6966 2066 696c            if fil
-00005c50: 656e 616d 655b 2d6c 656e 2863 6667 2e66  ename[-len(cfg.f
-00005c60: 696c 6574 7970 655f 7365 676d 656e 7461  iletype_segmenta
-00005c70: 7469 6f6e 293a 5d20 213d 2063 6667 2e66  tion):] != cfg.f
-00005c80: 696c 6574 7970 655f 7365 676d 656e 7461  iletype_segmenta
-00005c90: 7469 6f6e 3a0d 0a20 2020 2020 2020 2020  tion:..         
-00005ca0: 2020 2020 2020 2020 2020 2066 696c 656e             filen
-00005cb0: 616d 6520 2b3d 2063 6667 2e66 696c 6574  ame += cfg.filet
-00005cc0: 7970 655f 7365 676d 656e 7461 7469 6f6e  ype_segmentation
-00005cd0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00005ce0: 2020 7769 7468 206f 7065 6e28 6669 6c65    with open(file
-00005cf0: 6e61 6d65 2c20 2777 6227 2920 6173 2070  name, 'wb') as p
-00005d00: 6963 6b6c 655f 6669 6c65 3a0d 0a20 2020  ickle_file:..   
-00005d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005d20: 2070 6963 6b6c 652e 6475 6d70 2863 6667   pickle.dump(cfg
-00005d30: 2e73 655f 6163 7469 7665 5f66 7261 6d65  .se_active_frame
-00005d40: 2c20 7069 636b 6c65 5f66 696c 6529 0d0a  , pickle_file)..
-00005d50: 0d0a 0d0a 2020 2020 2020 2020 6578 6365  ....        exce
-00005d60: 7074 2045 7863 6570 7469 6f6e 2061 7320  pt Exception as 
-00005d70: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00005d80: 6366 672e 7365 745f 6572 726f 7228 652c  cfg.set_error(e,
-00005d90: 2022 436f 756c 6420 6e6f 7420 7361 7665   "Could not save
-00005da0: 2064 6961 6c6f 6720 2d20 7365 6520 6465   dialog - see de
-00005db0: 7461 696c 7320 6265 6c6f 772e 2229 0d0a  tails below.")..
-00005dc0: 0d0a 2020 2020 6465 6620 6775 695f 6d61  ..    def gui_ma
-00005dd0: 696e 2873 656c 6629 3a0d 0a20 2020 2020  in(self):..     
-00005de0: 2020 2069 6620 5472 7565 3a0d 0a20 2020     if True:..   
-00005df0: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
-00005e00: 7573 685f 7374 796c 655f 636f 6c6f 7228  ush_style_color(
-00005e10: 696d 6775 692e 434f 4c4f 525f 5749 4e44  imgui.COLOR_WIND
-00005e20: 4f57 5f42 4143 4b47 524f 554e 442c 202a  OW_BACKGROUND, *
-00005e30: 6366 672e 434f 4c4f 5552 5f50 414e 454c  cfg.COLOUR_PANEL
-00005e40: 5f42 4143 4b47 524f 554e 4429 0d0a 2020  _BACKGROUND)..  
-00005e50: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
-00005e60: 7075 7368 5f73 7479 6c65 5f63 6f6c 6f72  push_style_color
-00005e70: 2869 6d67 7569 2e43 4f4c 4f52 5f54 4558  (imgui.COLOR_TEX
-00005e80: 542c 202a 6366 672e 434f 4c4f 5552 5f54  T, *cfg.COLOUR_T
-00005e90: 4558 5429 0d0a 2020 2020 2020 2020 2020  EXT)..          
-00005ea0: 2020 696d 6775 692e 7075 7368 5f73 7479    imgui.push_sty
-00005eb0: 6c65 5f63 6f6c 6f72 2869 6d67 7569 2e43  le_color(imgui.C
-00005ec0: 4f4c 4f52 5f54 4954 4c45 5f42 4143 4b47  OLOR_TITLE_BACKG
-00005ed0: 524f 554e 445f 4143 5449 5645 2c20 2a63  ROUND_ACTIVE, *c
-00005ee0: 6667 2e43 4f4c 4f55 525f 5449 544c 455f  fg.COLOUR_TITLE_
-00005ef0: 4241 434b 4752 4f55 4e44 290d 0a20 2020  BACKGROUND)..   
-00005f00: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
-00005f10: 7573 685f 7374 796c 655f 636f 6c6f 7228  ush_style_color(
-00005f20: 696d 6775 692e 434f 4c4f 525f 5449 544c  imgui.COLOR_TITL
-00005f30: 455f 4241 434b 4752 4f55 4e44 2c20 2a63  E_BACKGROUND, *c
-00005f40: 6667 2e43 4f4c 4f55 525f 5449 544c 455f  fg.COLOUR_TITLE_
-00005f50: 4241 434b 4752 4f55 4e44 290d 0a20 2020  BACKGROUND)..   
-00005f60: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
-00005f70: 7573 685f 7374 796c 655f 636f 6c6f 7228  ush_style_color(
-00005f80: 696d 6775 692e 434f 4c4f 525f 5449 544c  imgui.COLOR_TITL
-00005f90: 455f 4241 434b 4752 4f55 4e44 5f43 4f4c  E_BACKGROUND_COL
-00005fa0: 4c41 5053 4544 2c20 2a63 6667 2e43 4f4c  LAPSED, *cfg.COL
-00005fb0: 4f55 525f 5449 544c 455f 4241 434b 4752  OUR_TITLE_BACKGR
-00005fc0: 4f55 4e44 290d 0a20 2020 2020 2020 2020  OUND)..         
-00005fd0: 2020 2069 6d67 7569 2e70 7573 685f 7374     imgui.push_st
-00005fe0: 796c 655f 636f 6c6f 7228 696d 6775 692e  yle_color(imgui.
-00005ff0: 434f 4c4f 525f 4255 5454 4f4e 5f48 4f56  COLOR_BUTTON_HOV
-00006000: 4552 4544 2c20 2a63 6667 2e43 4f4c 4f55  ERED, *cfg.COLOU
-00006010: 525f 5449 544c 455f 4241 434b 4752 4f55  R_TITLE_BACKGROU
-00006020: 4e44 290d 0a20 2020 2020 2020 2020 2020  ND)..           
-00006030: 2069 6d67 7569 2e70 7573 685f 7374 796c   imgui.push_styl
-00006040: 655f 636f 6c6f 7228 696d 6775 692e 434f  e_color(imgui.CO
-00006050: 4c4f 525f 4255 5454 4f4e 5f41 4354 4956  LOR_BUTTON_ACTIV
-00006060: 452c 202a 6366 672e 434f 4c4f 5552 5f54  E, *cfg.COLOUR_T
-00006070: 4954 4c45 5f42 4143 4b47 524f 554e 4429  ITLE_BACKGROUND)
-00006080: 0d0a 2020 2020 2020 2020 2020 2020 696d  ..            im
-00006090: 6775 692e 7075 7368 5f73 7479 6c65 5f63  gui.push_style_c
-000060a0: 6f6c 6f72 2869 6d67 7569 2e43 4f4c 4f52  olor(imgui.COLOR
-000060b0: 5f46 5241 4d45 5f42 4143 4b47 524f 554e  _FRAME_BACKGROUN
-000060c0: 442c 202a 6366 672e 434f 4c4f 5552 5f46  D, *cfg.COLOUR_F
-000060d0: 5241 4d45 5f42 4143 4b47 524f 554e 4429  RAME_BACKGROUND)
-000060e0: 0d0a 2020 2020 2020 2020 2020 2020 696d  ..            im
-000060f0: 6775 692e 7075 7368 5f73 7479 6c65 5f63  gui.push_style_c
-00006100: 6f6c 6f72 2869 6d67 7569 2e43 4f4c 4f52  olor(imgui.COLOR
-00006110: 5f46 5241 4d45 5f42 4143 4b47 524f 554e  _FRAME_BACKGROUN
-00006120: 445f 484f 5645 5245 442c 202a 6366 672e  D_HOVERED, *cfg.
-00006130: 434f 4c4f 5552 5f46 5241 4d45 5f42 4143  COLOUR_FRAME_BAC
-00006140: 4b47 524f 554e 4429 0d0a 2020 2020 2020  KGROUND)..      
-00006150: 2020 2020 2020 696d 6775 692e 7075 7368        imgui.push
-00006160: 5f73 7479 6c65 5f63 6f6c 6f72 2869 6d67  _style_color(img
-00006170: 7569 2e43 4f4c 4f52 5f46 5241 4d45 5f42  ui.COLOR_FRAME_B
-00006180: 4143 4b47 524f 554e 445f 4143 5449 5645  ACKGROUND_ACTIVE
-00006190: 2c20 2a63 6667 2e43 4f4c 4f55 525f 4652  , *cfg.COLOUR_FR
-000061a0: 414d 455f 4143 5449 5645 290d 0a20 2020  AME_ACTIVE)..   
-000061b0: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
-000061c0: 7573 685f 7374 796c 655f 636f 6c6f 7228  ush_style_color(
-000061d0: 696d 6775 692e 434f 4c4f 525f 4255 5454  imgui.COLOR_BUTT
-000061e0: 4f4e 5f41 4354 4956 452c 202a 6366 672e  ON_ACTIVE, *cfg.
-000061f0: 434f 4c4f 5552 5f46 5241 4d45 5f41 4354  COLOUR_FRAME_ACT
-00006200: 4956 4529 0d0a 2020 2020 2020 2020 2020  IVE)..          
-00006210: 2020 696d 6775 692e 7075 7368 5f73 7479    imgui.push_sty
-00006220: 6c65 5f63 6f6c 6f72 2869 6d67 7569 2e43  le_color(imgui.C
-00006230: 4f4c 4f52 5f42 5554 544f 4e2c 202a 6366  OLOR_BUTTON, *cf
-00006240: 672e 434f 4c4f 5552 5f46 5241 4d45 5f42  g.COLOUR_FRAME_B
-00006250: 4143 4b47 524f 554e 4429 0d0a 2020 2020  ACKGROUND)..    
-00006260: 2020 2020 2020 2020 696d 6775 692e 7075          imgui.pu
-00006270: 7368 5f73 7479 6c65 5f63 6f6c 6f72 2869  sh_style_color(i
-00006280: 6d67 7569 2e43 4f4c 4f52 5f42 5554 544f  mgui.COLOR_BUTTO
-00006290: 4e5f 484f 5645 5245 442c 202a 6366 672e  N_HOVERED, *cfg.
-000062a0: 434f 4c4f 5552 5f46 5241 4d45 5f42 4143  COLOUR_FRAME_BAC
-000062b0: 4b47 524f 554e 4429 0d0a 2020 2020 2020  KGROUND)..      
-000062c0: 2020 2020 2020 696d 6775 692e 7075 7368        imgui.push
-000062d0: 5f73 7479 6c65 5f63 6f6c 6f72 2869 6d67  _style_color(img
-000062e0: 7569 2e43 4f4c 4f52 5f53 4c49 4445 525f  ui.COLOR_SLIDER_
-000062f0: 4752 4142 2c20 2a63 6667 2e43 4f4c 4f55  GRAB, *cfg.COLOU
-00006300: 525f 4652 414d 455f 4558 5452 415f 4441  R_FRAME_EXTRA_DA
-00006310: 524b 290d 0a20 2020 2020 2020 2020 2020  RK)..           
-00006320: 2069 6d67 7569 2e70 7573 685f 7374 796c   imgui.push_styl
-00006330: 655f 636f 6c6f 7228 696d 6775 692e 434f  e_color(imgui.CO
-00006340: 4c4f 525f 534c 4944 4552 5f47 5241 425f  LOR_SLIDER_GRAB_
-00006350: 4143 5449 5645 2c20 2a63 6667 2e43 4f4c  ACTIVE, *cfg.COL
-00006360: 4f55 525f 4652 414d 455f 4441 524b 290d  OUR_FRAME_DARK).
-00006370: 0a20 2020 2020 2020 2020 2020 2069 6d67  .            img
-00006380: 7569 2e70 7573 685f 7374 796c 655f 636f  ui.push_style_co
-00006390: 6c6f 7228 696d 6775 692e 434f 4c4f 525f  lor(imgui.COLOR_
-000063a0: 504f 5055 505f 4241 434b 4752 4f55 4e44  POPUP_BACKGROUND
-000063b0: 2c20 2a63 6667 2e43 4f4c 4f55 525f 4652  , *cfg.COLOUR_FR
-000063c0: 414d 455f 4241 434b 4752 4f55 4e44 290d  AME_BACKGROUND).
-000063d0: 0a20 2020 2020 2020 2020 2020 2069 6d67  .            img
-000063e0: 7569 2e70 7573 685f 7374 796c 655f 636f  ui.push_style_co
-000063f0: 6c6f 7228 696d 6775 692e 434f 4c4f 525f  lor(imgui.COLOR_
-00006400: 5343 524f 4c4c 4241 525f 4752 4142 2c20  SCROLLBAR_GRAB, 
-00006410: 2a63 6667 2e43 4f4c 4f55 525f 4652 414d  *cfg.COLOUR_FRAM
-00006420: 455f 4441 524b 290d 0a20 2020 2020 2020  E_DARK)..       
-00006430: 2020 2020 2069 6d67 7569 2e70 7573 685f       imgui.push_
-00006440: 7374 796c 655f 636f 6c6f 7228 696d 6775  style_color(imgu
-00006450: 692e 434f 4c4f 525f 5343 524f 4c4c 4241  i.COLOR_SCROLLBA
-00006460: 525f 4752 4142 5f48 4f56 4552 4544 2c20  R_GRAB_HOVERED, 
-00006470: 2a63 6667 2e43 4f4c 4f55 525f 4652 414d  *cfg.COLOUR_FRAM
-00006480: 455f 4441 524b 290d 0a20 2020 2020 2020  E_DARK)..       
-00006490: 2020 2020 2069 6d67 7569 2e70 7573 685f       imgui.push_
-000064a0: 7374 796c 655f 636f 6c6f 7228 696d 6775  style_color(imgu
-000064b0: 692e 434f 4c4f 525f 5343 524f 4c4c 4241  i.COLOR_SCROLLBA
-000064c0: 525f 4752 4142 5f41 4354 4956 452c 202a  R_GRAB_ACTIVE, *
-000064d0: 6366 672e 434f 4c4f 5552 5f46 5241 4d45  cfg.COLOUR_FRAME
-000064e0: 5f42 4143 4b47 524f 554e 4429 0d0a 2020  _BACKGROUND)..  
-000064f0: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
-00006500: 7075 7368 5f73 7479 6c65 5f63 6f6c 6f72  push_style_color
-00006510: 2869 6d67 7569 2e43 4f4c 4f52 5f53 4352  (imgui.COLOR_SCR
-00006520: 4f4c 4c42 4152 5f42 4143 4b47 524f 554e  OLLBAR_BACKGROUN
-00006530: 442c 202a 6366 672e 434f 4c4f 5552 5f46  D, *cfg.COLOUR_F
-00006540: 5241 4d45 5f45 5854 5241 5f44 4152 4b29  RAME_EXTRA_DARK)
-00006550: 0d0a 2020 2020 2020 2020 2020 2020 696d  ..            im
-00006560: 6775 692e 7075 7368 5f73 7479 6c65 5f63  gui.push_style_c
-00006570: 6f6c 6f72 2869 6d67 7569 2e43 4f4c 4f52  olor(imgui.COLOR
-00006580: 5f50 4c4f 545f 4849 5354 4f47 5241 4d2c  _PLOT_HISTOGRAM,
-00006590: 202a 6366 672e 434f 4c4f 5552 5f54 4558   *cfg.COLOUR_TEX
-000065a0: 5429 0d0a 2020 2020 2020 2020 2020 2020  T)..            
-000065b0: 696d 6775 692e 7075 7368 5f73 7479 6c65  imgui.push_style
-000065c0: 5f63 6f6c 6f72 2869 6d67 7569 2e43 4f4c  _color(imgui.COL
-000065d0: 4f52 5f50 4c4f 545f 4849 5354 4f47 5241  OR_PLOT_HISTOGRA
-000065e0: 4d5f 484f 5645 5245 442c 202a 6366 672e  M_HOVERED, *cfg.
-000065f0: 434f 4c4f 5552 5f54 4558 5429 0d0a 2020  COLOUR_TEXT)..  
-00006600: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
-00006610: 7075 7368 5f73 7479 6c65 5f63 6f6c 6f72  push_style_color
-00006620: 2869 6d67 7569 2e43 4f4c 4f52 5f43 4845  (imgui.COLOR_CHE
-00006630: 434b 5f4d 4152 4b2c 2030 2e30 2c20 302e  CK_MARK, 0.0, 0.
-00006640: 302c 2030 2e30 2c20 312e 3029 0d0a 2020  0, 0.0, 1.0)..  
-00006650: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
-00006660: 7075 7368 5f73 7479 6c65 5f63 6f6c 6f72  push_style_color
-00006670: 2869 6d67 7569 2e43 4f4c 4f52 5f4d 454e  (imgui.COLOR_MEN
-00006680: 5542 4152 5f42 4143 4b47 524f 554e 442c  UBAR_BACKGROUND,
-00006690: 202a 6366 672e 434f 4c4f 5552 5f4d 4149   *cfg.COLOUR_MAI
-000066a0: 4e5f 4d45 4e55 5f42 4152 290d 0a20 2020  N_MENU_BAR)..   
-000066b0: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
-000066c0: 7573 685f 7374 796c 655f 636f 6c6f 7228  ush_style_color(
-000066d0: 696d 6775 692e 434f 4c4f 525f 4845 4144  imgui.COLOR_HEAD
-000066e0: 4552 2c20 2a63 6667 2e43 4f4c 4f55 525f  ER, *cfg.COLOUR_
-000066f0: 4845 4144 4552 290d 0a20 2020 2020 2020  HEADER)..       
-00006700: 2020 2020 2069 6d67 7569 2e70 7573 685f       imgui.push_
-00006710: 7374 796c 655f 636f 6c6f 7228 696d 6775  style_color(imgu
-00006720: 692e 434f 4c4f 525f 4845 4144 4552 5f48  i.COLOR_HEADER_H
-00006730: 4f56 4552 4544 2c20 2a63 6667 2e43 4f4c  OVERED, *cfg.COL
-00006740: 4f55 525f 4845 4144 4552 5f48 4f56 4552  OUR_HEADER_HOVER
-00006750: 4544 290d 0a20 2020 2020 2020 2020 2020  ED)..           
-00006760: 2069 6d67 7569 2e70 7573 685f 7374 796c   imgui.push_styl
-00006770: 655f 636f 6c6f 7228 696d 6775 692e 434f  e_color(imgui.CO
-00006780: 4c4f 525f 4845 4144 4552 5f41 4354 4956  LOR_HEADER_ACTIV
-00006790: 452c 202a 6366 672e 434f 4c4f 5552 5f48  E, *cfg.COLOUR_H
-000067a0: 4541 4445 525f 4143 5449 5645 290d 0a20  EADER_ACTIVE).. 
-000067b0: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
-000067c0: 2e70 7573 685f 7374 796c 655f 636f 6c6f  .push_style_colo
-000067d0: 7228 696d 6775 692e 434f 4c4f 525f 5441  r(imgui.COLOR_TA
-000067e0: 422c 202a 6366 672e 434f 4c4f 5552 5f48  B, *cfg.COLOUR_H
-000067f0: 4541 4445 525f 4143 5449 5645 290d 0a20  EADER_ACTIVE).. 
-00006800: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
-00006810: 2e70 7573 685f 7374 796c 655f 636f 6c6f  .push_style_colo
-00006820: 7228 696d 6775 692e 434f 4c4f 525f 5441  r(imgui.COLOR_TA
-00006830: 425f 4143 5449 5645 2c20 2a63 6667 2e43  B_ACTIVE, *cfg.C
-00006840: 4f4c 4f55 525f 4845 4144 4552 290d 0a20  OLOUR_HEADER).. 
-00006850: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
-00006860: 2e70 7573 685f 7374 796c 655f 636f 6c6f  .push_style_colo
-00006870: 7228 696d 6775 692e 434f 4c4f 525f 5441  r(imgui.COLOR_TA
-00006880: 425f 484f 5645 5245 442c 202a 6366 672e  B_HOVERED, *cfg.
-00006890: 434f 4c4f 5552 5f48 4541 4445 5229 0d0a  COLOUR_HEADER)..
-000068a0: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
-000068b0: 692e 7075 7368 5f73 7479 6c65 5f63 6f6c  i.push_style_col
-000068c0: 6f72 2869 6d67 7569 2e43 4f4c 4f52 5f44  or(imgui.COLOR_D
-000068d0: 5241 475f 4452 4f50 5f54 4152 4745 542c  RAG_DROP_TARGET,
-000068e0: 202a 6366 672e 434f 4c4f 5552 5f44 524f   *cfg.COLOUR_DRO
-000068f0: 505f 5441 5247 4554 290d 0a20 2020 2020  P_TARGET)..     
-00006900: 2020 2020 2020 2069 6d67 7569 2e70 7573         imgui.pus
-00006910: 685f 7374 796c 655f 636f 6c6f 7228 696d  h_style_color(im
-00006920: 6775 692e 434f 4c4f 525f 5343 524f 4c4c  gui.COLOR_SCROLL
-00006930: 4241 525f 4241 434b 4752 4f55 4e44 2c20  BAR_BACKGROUND, 
-00006940: 2a63 6667 2e43 4f4c 4f55 525f 5749 4e44  *cfg.COLOUR_WIND
-00006950: 4f57 5f42 4143 4b47 524f 554e 445b 3a33  OW_BACKGROUND[:3
-00006960: 5d2c 2030 2e30 290d 0a20 2020 2020 2020  ], 0.0)..       
-00006970: 2020 2020 2069 6d67 7569 2e70 7573 685f       imgui.push_
-00006980: 7374 796c 655f 7661 7228 696d 6775 692e  style_var(imgui.
-00006990: 5354 594c 455f 5749 4e44 4f57 5f52 4f55  STYLE_WINDOW_ROU
-000069a0: 4e44 494e 472c 2063 6667 2e57 494e 444f  NDING, cfg.WINDO
-000069b0: 575f 524f 554e 4449 4e47 290d 0a0d 0a20  W_ROUNDING).... 
-000069c0: 2020 2020 2020 2064 6566 2062 6f6f 745f         def boot_
-000069d0: 7370 7269 7465 2829 3a0d 0a20 2020 2020  sprite():..     
-000069e0: 2020 2020 2020 2069 6620 5365 676d 656e         if Segmen
-000069f0: 7461 7469 6f6e 4564 6974 6f72 2e53 484f  tationEditor.SHO
-00006a00: 575f 424f 4f54 5f53 5052 4954 453a 0d0a  W_BOOT_SPRITE:..
-00006a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006a20: 696d 6775 692e 7075 7368 5f73 7479 6c65  imgui.push_style
-00006a30: 5f63 6f6c 6f72 2869 6d67 7569 2e43 4f4c  _color(imgui.COL
-00006a40: 4f52 5f54 4954 4c45 5f42 4143 4b47 524f  OR_TITLE_BACKGRO
-00006a50: 554e 442c 202a 6366 672e 434f 4c4f 5552  UND, *cfg.COLOUR
-00006a60: 5f57 494e 444f 575f 4241 434b 4752 4f55  _WINDOW_BACKGROU
-00006a70: 4e44 5b30 3a33 5d2c 2030 2e30 290d 0a20  ND[0:3], 0.0).. 
-00006a80: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00006a90: 6d67 7569 2e70 7573 685f 7374 796c 655f  mgui.push_style_
-00006aa0: 636f 6c6f 7228 696d 6775 692e 434f 4c4f  color(imgui.COLO
-00006ab0: 525f 5449 544c 455f 4241 434b 4752 4f55  R_TITLE_BACKGROU
-00006ac0: 4e44 5f41 4354 4956 452c 202a 6366 672e  ND_ACTIVE, *cfg.
-00006ad0: 434f 4c4f 5552 5f57 494e 444f 575f 4241  COLOUR_WINDOW_BA
-00006ae0: 434b 4752 4f55 4e44 5b30 3a33 5d2c 2030  CKGROUND[0:3], 0
-00006af0: 2e30 290d 0a20 2020 2020 2020 2020 2020  .0)..           
-00006b00: 2020 2020 2069 6d67 7569 2e70 7573 685f       imgui.push_
-00006b10: 7374 796c 655f 636f 6c6f 7228 696d 6775  style_color(imgu
-00006b20: 692e 434f 4c4f 525f 5445 5854 2c20 2a28  i.COLOR_TEXT, *(
-00006b30: 302e 302c 2030 2e30 2c20 302e 302c 2031  0.0, 0.0, 0.0, 1
-00006b40: 2e30 2929 0d0a 0d0a 2020 2020 2020 2020  .0))....        
-00006b50: 2020 2020 2020 2020 5f77 203d 2073 656c          _w = sel
-00006b60: 662e 626f 6f74 5f73 7072 6974 655f 7769  f.boot_sprite_wi
-00006b70: 6474 6820 2a20 302e 3235 0d0a 2020 2020  dth * 0.25..    
-00006b80: 2020 2020 2020 2020 2020 2020 5f68 203d              _h =
-00006b90: 2073 656c 662e 626f 6f74 5f73 7072 6974   self.boot_sprit
-00006ba0: 655f 6865 6967 6874 202a 2030 2e32 350d  e_height * 0.25.
-00006bb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006bc0: 2069 6d67 7569 2e73 6574 5f6e 6578 745f   imgui.set_next_
-00006bd0: 7769 6e64 6f77 5f70 6f73 6974 696f 6e28  window_position(
-00006be0: 5365 676d 656e 7461 7469 6f6e 4564 6974  SegmentationEdit
-00006bf0: 6f72 2e4d 4149 4e5f 5749 4e44 4f57 5f57  or.MAIN_WINDOW_W
-00006c00: 4944 5448 202b 2028 6366 672e 7769 6e64  IDTH + (cfg.wind
-00006c10: 6f77 5f77 6964 7468 202d 2053 6567 6d65  ow_width - Segme
-00006c20: 6e74 6174 696f 6e45 6469 746f 722e 4d41  ntationEditor.MA
-00006c30: 494e 5f57 494e 444f 575f 5749 4454 4829  IN_WINDOW_WIDTH)
-00006c40: 202f 2032 2e30 202d 2028 5f77 202f 2032   / 2.0 - (_w / 2
-00006c50: 2e30 292c 2028 6366 672e 7769 6e64 6f77  .0), (cfg.window
-00006c60: 5f68 6569 6768 7420 2d20 5f68 2920 2f20  _height - _h) / 
-00006c70: 322e 3020 2d20 3235 290d 0a20 2020 2020  2.0 - 25)..     
-00006c80: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00006c90: 7368 6f77 5f62 6f6f 745f 696d 6720 3d20  show_boot_img = 
-00006ca0: 696d 6775 692e 6265 6769 6e28 2223 2362  imgui.begin("##b
-00006cb0: 6f6f 745f 7370 7269 7465 222c 2054 7275  oot_sprite", Tru
-00006cc0: 652c 696d 6775 692e 5749 4e44 4f57 5f4e  e,imgui.WINDOW_N
-00006cd0: 4f5f 434f 4c4c 4150 5345 207c 2069 6d67  O_COLLAPSE | img
-00006ce0: 7569 2e57 494e 444f 575f 4e4f 5f52 4553  ui.WINDOW_NO_RES
-00006cf0: 495a 4520 7c20 696d 6775 692e 5749 4e44  IZE | imgui.WIND
-00006d00: 4f57 5f4e 4f5f 5245 5349 5a45 207c 2069  OW_NO_RESIZE | i
-00006d10: 6d67 7569 2e57 494e 444f 575f 414c 5741  mgui.WINDOW_ALWA
-00006d20: 5953 5f41 5554 4f5f 5245 5349 5a45 207c  YS_AUTO_RESIZE |
-00006d30: 2069 6d67 7569 2e57 494e 444f 575f 4e4f   imgui.WINDOW_NO
-00006d40: 5f42 4143 4b47 524f 554e 4420 7c20 696d  _BACKGROUND | im
-00006d50: 6775 692e 5749 4e44 4f57 5f4e 4f5f 5343  gui.WINDOW_NO_SC
-00006d60: 524f 4c4c 4241 5229 5b31 5d0d 0a20 2020  ROLLBAR)[1]..   
-00006d70: 2020 2020 2020 2020 2020 2020 2069 6d67               img
-00006d80: 7569 2e69 6d61 6765 2873 656c 662e 626f  ui.image(self.bo
-00006d90: 6f74 5f73 7072 6974 655f 7465 7874 7572  ot_sprite_textur
-00006da0: 652e 7265 6e64 6572 6572 5f69 642c 205f  e.renderer_id, _
-00006db0: 772c 205f 6829 0d0a 2020 2020 2020 2020  w, _h)..        
-00006dc0: 2020 2020 2020 2020 696d 6775 692e 7075          imgui.pu
-00006dd0: 7368 5f73 7479 6c65 5f63 6f6c 6f72 2869  sh_style_color(i
-00006de0: 6d67 7569 2e43 4f4c 4f52 5f50 4f50 5550  mgui.COLOR_POPUP
-00006df0: 5f42 4143 4b47 524f 554e 442c 202a 6366  _BACKGROUND, *cf
-00006e00: 672e 434f 4c4f 5552 5f57 494e 444f 575f  g.COLOUR_WINDOW_
-00006e10: 4241 434b 4752 4f55 4e44 290d 0a20 2020  BACKGROUND)..   
-00006e20: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00006e30: 696d 6775 692e 6265 6769 6e5f 706f 7075  imgui.begin_popu
-00006e40: 705f 636f 6e74 6578 745f 7769 6e64 6f77  p_context_window
-00006e50: 2829 3a0d 0a20 2020 2020 2020 2020 2020  ():..           
-00006e60: 2020 2020 2020 2020 2069 6d67 7569 2e74           imgui.t
-00006e70: 6578 7428 6622 5765 6c63 6f6d 6520 746f  ext(f"Welcome to
-00006e80: 207b 6366 672e 6170 705f 6e61 6d65 7d21   {cfg.app_name}!
-00006e90: 2229 0d0a 2020 2020 2020 2020 2020 2020  ")..            
-00006ea0: 2020 2020 2020 2020 696d 6775 692e 7465          imgui.te
-00006eb0: 7874 2866 2276 6572 7369 6f6e 207b 6366  xt(f"version {cf
-00006ec0: 672e 7665 7273 696f 6e7d 5c6e 736f 7572  g.version}\nsour
-00006ed0: 6365 3a20 6769 7468 7562 2e63 6f6d 2f62  ce: github.com/b
-00006ee0: 696f 6e61 6e6f 7061 7474 6572 6e69 6e67  ionanopatterning
-00006ef0: 2f41 6973 5c6e 6d61 6e75 616c 3a20 6169  /Ais\nmanual: ai
-00006f00: 732d 6372 796f 6574 2e72 6561 6474 6865  s-cryoet.readthe
-00006f10: 646f 6373 2e6f 7267 2229 0d0a 2020 2020  docs.org")..    
-00006f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006f30: 696d 6775 692e 656e 645f 706f 7075 7028  imgui.end_popup(
-00006f40: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00006f50: 2020 2069 6620 7365 6c66 2e77 696e 646f     if self.windo
-00006f60: 772e 666f 6375 7365 6420 616e 6420 696d  w.focused and im
-00006f70: 6775 692e 6973 5f6d 6f75 7365 5f63 6c69  gui.is_mouse_cli
-00006f80: 636b 6564 2867 6c66 772e 4d4f 5553 455f  cked(glfw.MOUSE_
-00006f90: 4255 5454 4f4e 5f4c 4546 5429 2061 6e64  BUTTON_LEFT) and
-00006fa0: 206e 6f74 2069 6d67 7569 2e69 735f 7769   not imgui.is_wi
-00006fb0: 6e64 6f77 5f68 6f76 6572 6564 2829 3a0d  ndow_hovered():.
-00006fc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006fd0: 2020 2020 2053 6567 6d65 6e74 6174 696f       Segmentatio
-00006fe0: 6e45 6469 746f 722e 5348 4f57 5f42 4f4f  nEditor.SHOW_BOO
-00006ff0: 545f 5350 5249 5445 203d 2046 616c 7365  T_SPRITE = False
-00007000: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00007010: 2020 696d 6775 692e 706f 705f 7374 796c    imgui.pop_styl
-00007020: 655f 636f 6c6f 7228 3129 0d0a 2020 2020  e_color(1)..    
-00007030: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
-00007040: 692e 656e 6428 290d 0a20 2020 2020 2020  i.end()..       
-00007050: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
-00007060: 6f70 5f73 7479 6c65 5f63 6f6c 6f72 2833  op_style_color(3
-00007070: 290d 0a0d 0a20 2020 2020 2020 2064 6566  )....        def
-00007080: 2073 6861 7265 645f 6775 6928 293a 0d0a   shared_gui():..
-00007090: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-000070a0: 6d67 7569 2e63 6f6c 6c61 7073 696e 675f  mgui.collapsing_
-000070b0: 6865 6164 6572 2822 4461 7461 7365 7473  header("Datasets
-000070c0: 222c 204e 6f6e 652c 2069 6d67 7569 2e54  ", None, imgui.T
-000070d0: 5245 455f 4e4f 4445 5f44 4546 4155 4c54  REE_NODE_DEFAULT
-000070e0: 5f4f 5045 4e29 5b30 5d3a 0d0a 2020 2020  _OPEN)[0]:..    
-000070f0: 2020 2020 2020 2020 2020 2020 7061 6e65              pane
-00007100: 6c5f 6865 6967 6874 203d 2031 3230 2069  l_height = 120 i
-00007110: 6620 6e6f 7420 5365 676d 656e 7461 7469  f not Segmentati
-00007120: 6f6e 4564 6974 6f72 2e44 4154 4153 4554  onEditor.DATASET
-00007130: 535f 5749 4e44 4f57 5f45 5850 414e 4445  S_WINDOW_EXPANDE
-00007140: 4420 656c 7365 2053 6567 6d65 6e74 6174  D else Segmentat
-00007150: 696f 6e45 6469 746f 722e 4441 5441 5345  ionEditor.DATASE
-00007160: 5453 5f57 494e 444f 575f 4558 5041 4e44  TS_WINDOW_EXPAND
-00007170: 4544 5f48 4549 4748 540d 0a20 2020 2020  ED_HEIGHT..     
-00007180: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
-00007190: 2e62 6567 696e 5f63 6869 6c64 2822 6176  .begin_child("av
-000071a0: 6169 6c61 626c 655f 6461 7461 7365 7473  ailable_datasets
-000071b0: 222c 2030 2e30 2c20 7061 6e65 6c5f 6865  ", 0.0, panel_he
-000071c0: 6967 6874 2c20 5472 7565 2c20 696d 6775  ight, True, imgu
-000071d0: 692e 5749 4e44 4f57 5f41 4c57 4159 535f  i.WINDOW_ALWAYS_
-000071e0: 5645 5254 4943 414c 5f53 4352 4f4c 4c42  VERTICAL_SCROLLB
-000071f0: 4152 290d 0a20 2020 2020 2020 2020 2020  AR)..           
-00007200: 2020 2020 2066 6f72 2073 2069 6e20 6366       for s in cf
-00007210: 672e 7365 5f66 7261 6d65 733a 0d0a 2020  g.se_frames:..  
-00007220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007230: 2020 696d 6775 692e 7075 7368 5f69 6428    imgui.push_id(
-00007240: 6622 7365 7b73 2e75 6964 7d22 290d 0a0d  f"se{s.uid}")...
-00007250: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00007260: 2020 2020 2062 6173 655f 7469 746c 6520       base_title 
-00007270: 3d20 732e 7469 746c 652e 7370 6c69 7428  = s.title.split(
-00007280: 222e 2229 5b30 5d0d 0a20 2020 2020 2020  ".")[0]..       
-00007290: 2020 2020 2020 2020 2020 2020 205f 6368               _ch
-000072a0: 616e 6765 2c20 5f73 656c 6563 7465 6420  ange, _selected 
-000072b0: 3d20 696d 6775 692e 7365 6c65 6374 6162  = imgui.selectab
-000072c0: 6c65 2862 6173 655f 7469 746c 655b 2d31  le(base_title[-1
-000072d0: 373a 5d20 2b20 6622 202d 207b 732e 7069  7:] + f" - {s.pi
-000072e0: 7865 6c5f 7369 7a65 202a 2031 302e 303a  xel_size * 10.0:
-000072f0: 2e32 667d 2041 2f70 6978 2022 2c20 6366  .2f} A/pix ", cf
-00007300: 672e 7365 5f61 6374 6976 655f 6672 616d  g.se_active_fram
-00007310: 6520 3d3d 2073 290d 0a20 2020 2020 2020  e == s)..       
-00007320: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00007330: 696d 6775 692e 6265 6769 6e5f 706f 7075  imgui.begin_popu
-00007340: 705f 636f 6e74 6578 745f 6974 656d 2822  p_context_item("
-00007350: 2323 6461 7461 7365 7443 6f6e 7465 7874  ##datasetContext
-00007360: 2229 3a0d 0a20 2020 2020 2020 2020 2020  "):..           
-00007370: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00007380: 696d 6775 692e 6d65 6e75 5f69 7465 6d28  imgui.menu_item(
-00007390: 2255 6e6c 696e 6b20 6461 7461 7365 7422  "Unlink dataset"
-000073a0: 295b 305d 3a0d 0a20 2020 2020 2020 2020  )[0]:..         
-000073b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000073c0: 2020 2053 6567 6d65 6e74 6174 696f 6e45     SegmentationE
-000073d0: 6469 746f 722e 7069 636b 5f74 6162 5f69  ditor.pick_tab_i
-000073e0: 6e64 6578 5f64 6174 6173 6574 735f 7365  ndex_datasets_se
-000073f0: 6773 203d 2054 7275 650d 0a20 2020 2020  gs = True..     
-00007400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007410: 2020 2020 2020 2063 6667 2e73 655f 6672         cfg.se_fr
-00007420: 616d 6573 2e72 656d 6f76 6528 7329 0d0a  ames.remove(s)..
-00007430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007440: 2020 2020 2020 2020 2020 2020 6966 2063              if c
-00007450: 6667 2e73 655f 6163 7469 7665 5f66 7261  fg.se_active_fra
-00007460: 6d65 203d 3d20 733a 0d0a 2020 2020 2020  me == s:..      
-00007470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007480: 2020 2020 2020 2020 2020 6366 672e 7365            cfg.se
-00007490: 5f61 6374 6976 655f 6672 616d 6520 3d20  _active_frame = 
-000074a0: 4e6f 6e65 0d0a 2020 2020 2020 2020 2020  None..          
+00000e20: 2020 2020 7175 6575 6564 5f65 7870 6f72      queued_expor
+00000e30: 7473 203d 206c 6973 7428 290d 0a20 2020  ts = list()..   
+00000e40: 2020 2020 2065 7870 6f72 745f 6469 7220       export_dir 
+00000e50: 3d20 2222 0d0a 0d0a 2020 2020 2020 2020  = ""....        
+00000e60: 7472 6169 6e73 6574 5f61 7069 7820 3d20  trainset_apix = 
+00000e70: 3130 2e30 0d0a 2020 2020 2020 2020 7365  10.0..        se
+00000e80: 675f 666f 6c64 6572 203d 2022 220d 0a0d  g_folder = ""...
+00000e90: 0a20 2020 2020 2020 2053 484f 575f 424f  .        SHOW_BO
+00000ea0: 4f54 5f53 5052 4954 4520 3d20 5472 7565  OT_SPRITE = True
+00000eb0: 0d0a 2020 2020 2020 2020 4943 4f4e 203d  ..        ICON =
+00000ec0: 2049 6d61 6765 2e6f 7065 6e28 6f73 2e70   Image.open(os.p
+00000ed0: 6174 682e 6a6f 696e 2863 6667 2e72 6f6f  ath.join(cfg.roo
+00000ee0: 742c 2022 6963 6f6e 7322 2c20 224c 4f47  t, "icons", "LOG
+00000ef0: 4f5f 506f 6d5f 3132 382e 706e 6722 2929  O_Pom_128.png"))
+00000f00: 0d0a 0d0a 2020 2020 2020 2020 4645 4154  ....        FEAT
+00000f10: 5552 455f 494d 504f 5254 5f4d 5243 5f54  URE_IMPORT_MRC_T
+00000f20: 4852 4553 484f 4c44 203d 2031 3238 0d0a  HRESHOLD = 128..
+00000f30: 0d0a 2020 2020 6465 6620 5f5f 696e 6974  ..    def __init
+00000f40: 5f5f 2873 656c 662c 2077 696e 646f 772c  __(self, window,
+00000f50: 2069 6d67 7569 5f63 6f6e 7465 7874 2c20   imgui_context, 
+00000f60: 696d 6775 695f 696d 706c 293a 0d0a 2020  imgui_impl):..  
+00000f70: 2020 2020 2020 7365 6c66 2e77 696e 646f        self.windo
+00000f80: 7720 3d20 7769 6e64 6f77 0d0a 2020 2020  w = window..    
+00000f90: 2020 2020 7365 6c66 2e77 696e 646f 772e      self.window.
+00000fa0: 636c 6561 725f 636f 6c6f 7220 3d20 6366  clear_color = cf
+00000fb0: 672e 434f 4c4f 5552 5f57 494e 444f 575f  g.COLOUR_WINDOW_
+00000fc0: 4241 434b 4752 4f55 4e44 0d0a 2020 2020  BACKGROUND..    
+00000fd0: 2020 2020 7365 6c66 2e77 696e 646f 772e      self.window.
+00000fe0: 6d61 6b65 5f63 7572 7265 6e74 2829 0d0a  make_current()..
+00000ff0: 2020 2020 2020 2020 7365 6c66 2e69 6d67          self.img
+00001000: 7569 5f63 6f6e 7465 7874 203d 2069 6d67  ui_context = img
+00001010: 7569 5f63 6f6e 7465 7874 0d0a 2020 2020  ui_context..    
+00001020: 2020 2020 7365 6c66 2e69 6d67 7569 5f69      self.imgui_i
+00001030: 6d70 6c65 6d65 6e74 6174 696f 6e20 3d20  mplementation = 
+00001040: 696d 6775 695f 696d 706c 0d0a 0d0a 2020  imgui_impl....  
+00001050: 2020 2020 2020 7365 6c66 2e63 616d 6572        self.camer
+00001060: 6120 3d20 4361 6d65 7261 2829 0d0a 2020  a = Camera()..  
+00001070: 2020 2020 2020 7365 6c66 2e63 616d 6572        self.camer
+00001080: 6133 6420 3d20 4361 6d65 7261 3344 2829  a3d = Camera3D()
+00001090: 0d0a 2020 2020 2020 2020 5365 676d 656e  ..        Segmen
+000010a0: 7461 7469 6f6e 4564 6974 6f72 2e4c 4947  tationEditor.LIG
+000010b0: 4854 5f53 504f 5420 3d20 4c69 6768 7433  HT_SPOT = Light3
+000010c0: 4428 290d 0a20 2020 2020 2020 2053 6567  D()..        Seg
+000010d0: 6d65 6e74 6174 696f 6e45 6469 746f 722e  mentationEditor.
+000010e0: 4445 4641 554c 545f 5a4f 4f4d 203d 2063  DEFAULT_ZOOM = c
+000010f0: 6667 2e77 696e 646f 775f 6865 6967 6874  fg.window_height
+00001100: 202f 2053 6567 6d65 6e74 6174 696f 6e45   / SegmentationE
+00001110: 6469 746f 722e 4445 4641 554c 545f 484f  ditor.DEFAULT_HO
+00001120: 5249 5a4f 4e54 414c 5f46 4f56 5f57 4944  RIZONTAL_FOV_WID
+00001130: 5448 2020 2320 6e6f 7720 6974 2069 7320  TH  # now it is 
+00001140: 4445 4641 554c 545f 484f 5249 5a4f 4e54  DEFAULT_HORIZONT
+00001150: 414c 5f46 4f56 5f57 4944 5448 0d0a 2020  AL_FOV_WIDTH..  
+00001160: 2020 2020 2020 5365 676d 656e 7461 7469        Segmentati
+00001170: 6f6e 4564 6974 6f72 2e44 4546 4155 4c54  onEditor.DEFAULT
+00001180: 5f57 4f52 4c44 5f50 4958 454c 5f53 495a  _WORLD_PIXEL_SIZ
+00001190: 4520 3d20 312e 3020 2f20 5365 676d 656e  E = 1.0 / Segmen
+000011a0: 7461 7469 6f6e 4564 6974 6f72 2e44 4546  tationEditor.DEF
+000011b0: 4155 4c54 5f5a 4f4f 4d0d 0a20 2020 2020  AULT_ZOOM..     
+000011c0: 2020 2073 656c 662e 6361 6d65 7261 2e7a     self.camera.z
+000011d0: 6f6f 6d20 3d20 5365 676d 656e 7461 7469  oom = Segmentati
+000011e0: 6f6e 4564 6974 6f72 2e44 4546 4155 4c54  onEditor.DEFAULT
+000011f0: 5f5a 4f4f 4d0d 0a20 2020 2020 2020 2053  _ZOOM..        S
+00001200: 6567 6d65 6e74 6174 696f 6e45 6469 746f  egmentationEdito
+00001210: 722e 7265 6e64 6572 6572 203d 2052 656e  r.renderer = Ren
+00001220: 6465 7265 7228 290d 0a20 2020 2020 2020  derer()..       
+00001230: 2073 656c 662e 6669 6c74 6572 7320 3d20   self.filters = 
+00001240: 6c69 7374 2829 0d0a 2020 2020 2020 2020  list()..        
+00001250: 7365 6c66 2e61 6374 6976 655f 7461 6220  self.active_tab 
+00001260: 3d20 2253 6567 6d65 6e74 6174 696f 6e22  = "Segmentation"
+00001270: 0d0a 2020 2020 2020 2020 2320 7472 6169  ..        # trai
+00001280: 6e69 6e67 2064 6174 6173 6574 2070 6172  ning dataset par
+00001290: 616d 730d 0a20 2020 2020 2020 2073 656c  ams..        sel
+000012a0: 662e 616c 6c5f 6665 6174 7572 655f 6e61  f.all_feature_na
+000012b0: 6d65 7320 3d20 6c69 7374 2829 0d0a 2020  mes = list()..  
+000012c0: 2020 2020 2020 7365 6c66 2e66 6561 7475        self.featu
+000012d0: 7265 5f63 6f6c 6f75 725f 6469 6374 203d  re_colour_dict =
+000012e0: 2064 6963 7428 290d 0a20 2020 2020 2020   dict()..       
+000012f0: 2073 656c 662e 7472 6169 6e73 6574 5f66   self.trainset_f
+00001300: 6561 7475 7265 5f73 656c 6563 7469 6f6e  eature_selection
+00001310: 203d 2064 6963 7428 290d 0a20 2020 2020   = dict()..     
+00001320: 2020 2073 656c 662e 7472 6169 6e73 6574     self.trainset
+00001330: 5f73 656c 6563 7469 6f6e 203d 206c 6973  _selection = lis
+00001340: 7428 290d 0a20 2020 2020 2020 2073 656c  t()..        sel
+00001350: 662e 7472 6169 6e73 6574 5f6e 756d 5f62  f.trainset_num_b
+00001360: 6f78 6573 5f70 6f73 6974 6976 6520 3d20  oxes_positive = 
+00001370: 300d 0a20 2020 2020 2020 2073 656c 662e  0..        self.
+00001380: 7472 6169 6e73 6574 5f6e 756d 5f62 6f78  trainset_num_box
+00001390: 6573 5f6e 6567 6174 6976 6520 3d20 300d  es_negative = 0.
+000013a0: 0a20 2020 2020 2020 2073 656c 662e 7472  .        self.tr
+000013b0: 6169 6e73 6574 5f62 6f78 7369 7a65 203d  ainset_boxsize =
+000013c0: 2036 340d 0a20 2020 2020 2020 2073 656c   64..        sel
+000013d0: 662e 7368 6f77 5f74 7261 696e 7365 745f  f.show_trainset_
+000013e0: 626f 7865 7320 3d20 4661 6c73 650d 0a20  boxes = False.. 
+000013f0: 2020 2020 2020 2073 656c 662e 6163 7469         self.acti
+00001400: 7665 5f74 7261 696e 7365 745f 6578 706f  ve_trainset_expo
+00001410: 7274 7320 3d20 6c69 7374 2829 0d0a 0d0a  rts = list()....
+00001420: 2020 2020 2020 2020 2320 6472 6f70 2066          # drop f
+00001430: 696c 6573 0d0a 2020 2020 2020 2020 7365  iles..        se
+00001440: 6c66 2e69 6e63 6f6d 696e 675f 6669 6c65  lf.incoming_file
+00001450: 7320 3d20 6c69 7374 2829 0d0a 0d0a 2020  s = list()....  
+00001460: 2020 2020 2020 2320 6578 706f 7274 2026        # export &
+00001470: 2065 7874 7261 6374 0d0a 2020 2020 2020   extract..      
+00001480: 2020 7365 6c66 2e65 7870 6f72 745f 6c69    self.export_li
+00001490: 6d69 745f 7261 6e67 6520 3d20 5472 7565  mit_range = True
+000014a0: 0d0a 2020 2020 2020 2020 7365 6c66 2e65  ..        self.e
+000014b0: 7870 6f72 745f 6f76 6572 6c61 7973 203d  xport_overlays =
+000014c0: 2046 616c 7365 0d0a 2020 2020 2020 2020   False..        
+000014d0: 7365 6c66 2e65 7870 6f72 745f 6261 7463  self.export_batc
+000014e0: 685f 7369 7a65 203d 2031 0d0a 0d0a 2020  h_size = 1....  
+000014f0: 2020 2020 2020 2320 6372 6f70 2068 616e        # crop han
+00001500: 646c 6573 0d0a 2020 2020 2020 2020 7365  dles..        se
+00001510: 6c66 2e63 726f 705f 6861 6e64 6c65 7320  lf.crop_handles 
+00001520: 3d20 6c69 7374 2829 0d0a 0d0a 2020 2020  = list()....    
+00001530: 2020 2020 2320 7069 636b 696e 6720 2f20      # picking / 
+00001540: 3364 2072 656e 6465 7273 0d0a 0d0a 2020  3d renders....  
+00001550: 2020 2020 2020 7365 6c66 2e70 6963 6b5f        self.pick_
+00001560: 626f 785f 7661 203d 2056 6572 7465 7841  box_va = VertexA
+00001570: 7272 6179 2861 7474 7269 6275 7465 5f66  rray(attribute_f
+00001580: 6f72 6d61 743d 2278 797a 2229 2020 2320  ormat="xyz")  # 
+00001590: 7265 6e64 6572 2062 6f78 206c 696e 6573  render box lines
+000015a0: 0d0a 2020 2020 2020 2020 7365 6c66 2e70  ..        self.p
+000015b0: 6963 6b5f 626f 785f 7175 6164 5f76 6120  ick_box_quad_va 
+000015c0: 3d20 5665 7274 6578 4172 7261 7928 6174  = VertexArray(at
+000015d0: 7472 6962 7574 655f 666f 726d 6174 3d22  tribute_format="
+000015e0: 7879 7a22 2920 2023 2072 656e 6465 7220  xyz")  # render 
+000015f0: 626f 7820 6661 6365 730d 0a20 2020 2020  box faces..     
+00001600: 2020 2073 656c 662e 7069 636b 5f62 6f78     self.pick_box
+00001610: 5f76 612e 7570 6461 7465 2856 6572 7465  _va.update(Verte
+00001620: 7842 7566 6665 7228 5b30 2e30 2c20 302e  xBuffer([0.0, 0.
+00001630: 305d 292c 2049 6e64 6578 4275 6666 6572  0]), IndexBuffer
+00001640: 285b 5d29 290d 0a20 2020 2020 2020 2073  ([]))..        s
+00001650: 656c 662e 7069 636b 5f62 6f78 5f71 7561  elf.pick_box_qua
+00001660: 645f 7661 2e75 7064 6174 6528 5665 7274  d_va.update(Vert
+00001670: 6578 4275 6666 6572 285b 302e 302c 2030  exBuffer([0.0, 0
+00001680: 2e30 5d29 2c20 496e 6465 7842 7566 6665  .0]), IndexBuffe
+00001690: 7228 5b5d 2929 0d0a 2020 2020 2020 2020  r([]))..        
+000016a0: 7365 6c66 2e70 6963 6b5f 6f76 6572 6c61  self.pick_overla
+000016b0: 795f 3364 203d 2054 7275 650d 0a0d 0a20  y_3d = True.... 
+000016c0: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
+000016d0: 7261 6e67 6528 3429 3a0d 0a20 2020 2020  range(4):..     
+000016e0: 2020 2020 2020 2073 656c 662e 6372 6f70         self.crop
+000016f0: 5f68 616e 646c 6573 2e61 7070 656e 6428  _handles.append(
+00001700: 576f 726c 6453 7061 6365 4963 6f6e 2869  WorldSpaceIcon(i
+00001710: 2929 0d0a 0d0a 0d0a 2020 2020 2020 2020  ))......        
+00001720: 6966 2054 7275 653a 0d0a 2020 2020 2020  if True:..      
+00001730: 2020 2020 2020 6963 6f6e 5f64 6972 203d        icon_dir =
+00001740: 206f 732e 7061 7468 2e6a 6f69 6e28 6366   os.path.join(cf
+00001750: 672e 726f 6f74 2c20 2269 636f 6e73 2229  g.root, "icons")
+00001760: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+00001770: 7365 6c66 2e69 636f 6e5f 636c 6f73 6520  self.icon_close 
+00001780: 3d20 5465 7874 7572 6528 666f 726d 6174  = Texture(format
+00001790: 3d22 7267 6261 3332 6622 290d 0a20 2020  ="rgba32f")..   
+000017a0: 2020 2020 2020 2020 2070 7864 5f69 636f           pxd_ico
+000017b0: 6e5f 636c 6f73 6520 3d20 6e70 2e61 7361  n_close = np.asa
+000017c0: 7272 6179 2849 6d61 6765 2e6f 7065 6e28  rray(Image.open(
+000017d0: 6f73 2e70 6174 682e 6a6f 696e 2869 636f  os.path.join(ico
+000017e0: 6e5f 6469 722c 2022 6963 6f6e 5f63 6c6f  n_dir, "icon_clo
+000017f0: 7365 5f32 3536 2e70 6e67 2229 2929 2e61  se_256.png"))).a
+00001800: 7374 7970 6528 6e70 2e66 6c6f 6174 3332  stype(np.float32
+00001810: 2920 2f20 3235 352e 300d 0a20 2020 2020  ) / 255.0..     
+00001820: 2020 2020 2020 2073 656c 662e 6963 6f6e         self.icon
+00001830: 5f63 6c6f 7365 2e75 7064 6174 6528 7078  _close.update(px
+00001840: 645f 6963 6f6e 5f63 6c6f 7365 290d 0a20  d_icon_close).. 
+00001850: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00001860: 6963 6f6e 5f63 6c6f 7365 2e73 6574 5f6c  icon_close.set_l
+00001870: 696e 6561 725f 696e 7465 7270 6f6c 6174  inear_interpolat
+00001880: 696f 6e28 290d 0a0d 0a20 2020 2020 2020  ion()....       
+00001890: 2020 2020 2073 656c 662e 6963 6f6e 5f73       self.icon_s
+000018a0: 746f 7020 3d20 5465 7874 7572 6528 666f  top = Texture(fo
+000018b0: 726d 6174 3d22 7267 6261 3332 6622 290d  rmat="rgba32f").
+000018c0: 0a20 2020 2020 2020 2020 2020 2070 7864  .            pxd
+000018d0: 5f69 636f 6e5f 7374 6f70 203d 206e 702e  _icon_stop = np.
+000018e0: 6173 6172 7261 7928 496d 6167 652e 6f70  asarray(Image.op
+000018f0: 656e 286f 732e 7061 7468 2e6a 6f69 6e28  en(os.path.join(
+00001900: 6963 6f6e 5f64 6972 2c20 2269 636f 6e5f  icon_dir, "icon_
+00001910: 7374 6f70 5f32 3536 2e70 6e67 2229 2929  stop_256.png")))
+00001920: 2e61 7374 7970 6528 6e70 2e66 6c6f 6174  .astype(np.float
+00001930: 3332 2920 2f20 3235 352e 300d 0a20 2020  32) / 255.0..   
+00001940: 2020 2020 2020 2020 2073 656c 662e 6963           self.ic
+00001950: 6f6e 5f73 746f 702e 7570 6461 7465 2870  on_stop.update(p
+00001960: 7864 5f69 636f 6e5f 7374 6f70 290d 0a20  xd_icon_stop).. 
+00001970: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00001980: 6963 6f6e 5f73 746f 702e 7365 745f 6c69  icon_stop.set_li
+00001990: 6e65 6172 5f69 6e74 6572 706f 6c61 7469  near_interpolati
+000019a0: 6f6e 2829 0d0a 0d0a 2020 2020 2020 2020  on()....        
+000019b0: 2020 2020 7365 6c66 2e69 636f 6e5f 6f62      self.icon_ob
+000019c0: 6a20 3d20 5465 7874 7572 6528 666f 726d  j = Texture(form
+000019d0: 6174 3d22 7267 6261 3332 6622 290d 0a20  at="rgba32f").. 
+000019e0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000019f0: 6963 6f6e 5f62 6c65 6e64 6572 203d 2054  icon_blender = T
+00001a00: 6578 7475 7265 2866 6f72 6d61 743d 2272  exture(format="r
+00001a10: 6762 6133 3266 2229 0d0a 2020 2020 2020  gba32f")..      
+00001a20: 2020 2020 2020 7365 6c66 2e69 636f 6e5f        self.icon_
+00001a30: 6368 696d 6572 6178 203d 2054 6578 7475  chimerax = Textu
+00001a40: 7265 2866 6f72 6d61 743d 2272 6762 6133  re(format="rgba3
+00001a50: 3266 2229 0d0a 2020 2020 2020 2020 2020  2f")..          
+00001a60: 2020 7078 6420 3d20 6e70 2e61 7361 7272    pxd = np.asarr
+00001a70: 6179 2849 6d61 6765 2e6f 7065 6e28 6f73  ay(Image.open(os
+00001a80: 2e70 6174 682e 6a6f 696e 2869 636f 6e5f  .path.join(icon_
+00001a90: 6469 722c 2022 6963 6f6e 5f6f 626a 5f32  dir, "icon_obj_2
+00001aa0: 3536 2e70 6e67 2229 2929 2e61 7374 7970  56.png"))).astyp
+00001ab0: 6528 6e70 2e66 6c6f 6174 3332 2920 2f20  e(np.float32) / 
+00001ac0: 3235 352e 300d 0a20 2020 2020 2020 2020  255.0..         
+00001ad0: 2020 2073 656c 662e 6963 6f6e 5f6f 626a     self.icon_obj
+00001ae0: 2e75 7064 6174 6528 7078 6429 0d0a 2020  .update(pxd)..  
+00001af0: 2020 2020 2020 2020 2020 7078 6420 3d20            pxd = 
+00001b00: 6e70 2e61 7361 7272 6179 2849 6d61 6765  np.asarray(Image
+00001b10: 2e6f 7065 6e28 6f73 2e70 6174 682e 6a6f  .open(os.path.jo
+00001b20: 696e 2869 636f 6e5f 6469 722c 2022 6963  in(icon_dir, "ic
+00001b30: 6f6e 5f62 6c65 6e64 6572 5f32 3536 2e70  on_blender_256.p
+00001b40: 6e67 2229 2929 2e61 7374 7970 6528 6e70  ng"))).astype(np
+00001b50: 2e66 6c6f 6174 3332 2920 2f20 3235 352e  .float32) / 255.
+00001b60: 300d 0a20 2020 2020 2020 2020 2020 2073  0..            s
+00001b70: 656c 662e 6963 6f6e 5f62 6c65 6e64 6572  elf.icon_blender
+00001b80: 2e75 7064 6174 6528 7078 6429 0d0a 2020  .update(pxd)..  
+00001b90: 2020 2020 2020 2020 2020 7078 6420 3d20            pxd = 
+00001ba0: 6e70 2e61 7361 7272 6179 2849 6d61 6765  np.asarray(Image
+00001bb0: 2e6f 7065 6e28 6f73 2e70 6174 682e 6a6f  .open(os.path.jo
+00001bc0: 696e 2869 636f 6e5f 6469 722c 2022 6963  in(icon_dir, "ic
+00001bd0: 6f6e 5f63 6869 6d65 7261 785f 3235 362e  on_chimerax_256.
+00001be0: 706e 6722 2929 292e 6173 7479 7065 286e  png"))).astype(n
+00001bf0: 702e 666c 6f61 7433 3229 202f 2032 3535  p.float32) / 255
+00001c00: 2e30 0d0a 2020 2020 2020 2020 2020 2020  .0..            
+00001c10: 7365 6c66 2e69 636f 6e5f 6368 696d 6572  self.icon_chimer
+00001c20: 6178 2e75 7064 6174 6528 7078 6429 0d0a  ax.update(pxd)..
+00001c30: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00001c40: 2e69 636f 6e5f 6f62 6a2e 7365 745f 6c69  .icon_obj.set_li
+00001c50: 6e65 6172 5f69 6e74 6572 706f 6c61 7469  near_interpolati
+00001c60: 6f6e 2829 0d0a 2020 2020 2020 2020 2020  on()..          
+00001c70: 2020 7365 6c66 2e69 636f 6e5f 6368 696d    self.icon_chim
+00001c80: 6572 6178 2e73 6574 5f6c 696e 6561 725f  erax.set_linear_
+00001c90: 696e 7465 7270 6f6c 6174 696f 6e28 290d  interpolation().
+00001ca0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00001cb0: 662e 6963 6f6e 5f62 6c65 6e64 6572 2e73  f.icon_blender.s
+00001cc0: 6574 5f6c 696e 6561 725f 696e 7465 7270  et_linear_interp
+00001cd0: 6f6c 6174 696f 6e28 290d 0a0d 0a20 2020  olation()....   
+00001ce0: 2020 2020 2020 2020 2073 656c 662e 626f           self.bo
+00001cf0: 6f74 5f73 7072 6974 655f 7465 7874 7572  ot_sprite_textur
+00001d00: 6520 3d20 5465 7874 7572 6528 666f 726d  e = Texture(form
+00001d10: 6174 3d22 7267 6261 3332 6622 290d 0a20  at="rgba32f").. 
+00001d20: 2020 2020 2020 2020 2020 2070 7864 203d             pxd =
+00001d30: 206e 702e 6173 6172 7261 7928 496d 6167   np.asarray(Imag
+00001d40: 652e 6f70 656e 286f 732e 7061 7468 2e6a  e.open(os.path.j
+00001d50: 6f69 6e28 6963 6f6e 5f64 6972 2c20 224c  oin(icon_dir, "L
+00001d60: 4f47 4f5f 506f 6d5f 3230 3438 2e70 6e67  OGO_Pom_2048.png
+00001d70: 2229 2929 2e61 7374 7970 6528 6e70 2e66  "))).astype(np.f
+00001d80: 6c6f 6174 3332 2920 2f20 3235 352e 300d  loat32) / 255.0.
+00001d90: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00001da0: 662e 626f 6f74 5f73 7072 6974 655f 7465  f.boot_sprite_te
+00001db0: 7874 7572 652e 7570 6461 7465 2870 7864  xture.update(pxd
+00001dc0: 290d 0a20 2020 2020 2020 2020 2020 2073  )..            s
+00001dd0: 656c 662e 626f 6f74 5f73 7072 6974 655f  elf.boot_sprite_
+00001de0: 7769 6474 682c 2073 656c 662e 626f 6f74  width, self.boot
+00001df0: 5f73 7072 6974 655f 6865 6967 6874 203d  _sprite_height =
+00001e00: 2070 7864 2e73 6861 7065 5b30 3a32 5d0d   pxd.shape[0:2].
+00001e10: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00001e20: 662e 626f 6f74 5f73 7072 6974 655f 7465  f.boot_sprite_te
+00001e30: 7874 7572 652e 7365 745f 6c69 6e65 6172  xture.set_linear
+00001e40: 5f69 6e74 6572 706f 6c61 7469 6f6e 2829  _interpolation()
+00001e50: 0d0a 0d0a 2020 2020 4073 7461 7469 636d  ....    @staticm
+00001e60: 6574 686f 640d 0a20 2020 2064 6566 2073  ethod..    def s
+00001e70: 6574 5f61 6374 6976 655f 6461 7461 7365  et_active_datase
+00001e80: 7428 6461 7461 7365 7429 3a0d 0a20 2020  t(dataset):..   
+00001e90: 2020 2020 2053 6567 6d65 6e74 6174 696f       Segmentatio
+00001ea0: 6e45 6469 746f 722e 7069 636b 5f74 6162  nEditor.pick_tab
+00001eb0: 5f69 6e64 6578 5f64 6174 6173 6574 735f  _index_datasets_
+00001ec0: 7365 6773 203d 2054 7275 650d 0a20 2020  segs = True..   
+00001ed0: 2020 2020 2063 6667 2e73 655f 6163 7469       cfg.se_acti
+00001ee0: 7665 5f66 7261 6d65 203d 2064 6174 6173  ve_frame = datas
+00001ef0: 6574 0d0a 2020 2020 2020 2020 5365 676d  et..        Segm
+00001f00: 656e 7461 7469 6f6e 4564 6974 6f72 2e46  entationEditor.F
+00001f10: 5241 4d45 5f54 4558 5455 5245 5f52 4551  RAME_TEXTURE_REQ
+00001f20: 5549 5245 535f 5550 4441 5445 207c 3d20  UIRES_UPDATE |= 
+00001f30: 5472 7565 0d0a 2020 2020 2020 2020 6366  True..        cf
+00001f40: 672e 7365 5f61 6374 6976 655f 6672 616d  g.se_active_fram
+00001f50: 652e 736c 6963 655f 6368 616e 6765 6420  e.slice_changed 
+00001f60: 3d20 5472 7565 0d0a 2020 2020 2020 2020  = True..        
+00001f70: 6966 206c 656e 2863 6667 2e73 655f 6672  if len(cfg.se_fr
+00001f80: 616d 6573 2920 3d3d 2031 3a0d 0a20 2020  ames) == 1:..   
+00001f90: 2020 2020 2020 2020 2053 6567 6d65 6e74           Segment
+00001fa0: 6174 696f 6e45 6469 746f 722e 7472 6169  ationEditor.trai
+00001fb0: 6e73 6574 5f61 7069 7820 3d20 6366 672e  nset_apix = cfg.
+00001fc0: 7365 5f61 6374 6976 655f 6672 616d 652e  se_active_frame.
+00001fd0: 7069 7865 6c5f 7369 7a65 202a 2031 302e  pixel_size * 10.
+00001fe0: 300d 0a20 2020 2020 2020 2020 2020 2053  0..            S
+00001ff0: 6567 6d65 6e74 6174 696f 6e45 6469 746f  egmentationEdito
+00002000: 722e 7365 675f 666f 6c64 6572 203d 206f  r.seg_folder = o
+00002010: 732e 7061 7468 2e64 6972 6e61 6d65 2863  s.path.dirname(c
+00002020: 6667 2e73 655f 6163 7469 7665 5f66 7261  fg.se_active_fra
+00002030: 6d65 2e70 6174 6829 0d0a 2020 2020 2020  me.path)..      
+00002040: 2020 5365 676d 656e 7461 7469 6f6e 4564    SegmentationEd
+00002050: 6974 6f72 2e72 656e 6465 7265 722e 6662  itor.renderer.fb
+00002060: 6f31 203d 2046 7261 6d65 4275 6666 6572  o1 = FrameBuffer
+00002070: 2864 6174 6173 6574 2e77 6964 7468 2c20  (dataset.width, 
+00002080: 6461 7461 7365 742e 6865 6967 6874 2c20  dataset.height, 
+00002090: 2272 6762 6133 3266 2229 0d0a 2020 2020  "rgba32f")..    
+000020a0: 2020 2020 5365 676d 656e 7461 7469 6f6e      Segmentation
+000020b0: 4564 6974 6f72 2e72 656e 6465 7265 722e  Editor.renderer.
+000020c0: 6662 6f32 203d 2046 7261 6d65 4275 6666  fbo2 = FrameBuff
+000020d0: 6572 2864 6174 6173 6574 2e77 6964 7468  er(dataset.width
+000020e0: 2c20 6461 7461 7365 742e 6865 6967 6874  , dataset.height
+000020f0: 2c20 2272 6762 6133 3266 2229 0d0a 2020  , "rgba32f")..  
+00002100: 2020 2020 2020 5365 676d 656e 7461 7469        Segmentati
+00002110: 6f6e 4564 6974 6f72 2e72 656e 6465 7265  onEditor.rendere
+00002120: 722e 6662 6f33 203d 2046 7261 6d65 4275  r.fbo3 = FrameBu
+00002130: 6666 6572 2864 6174 6173 6574 2e77 6964  ffer(dataset.wid
+00002140: 7468 2c20 6461 7461 7365 742e 6865 6967  th, dataset.heig
+00002150: 6874 2c20 2272 6762 6133 3266 2229 0d0a  ht, "rgba32f")..
+00002160: 2020 2020 2020 2020 6966 2064 6174 6173          if datas
+00002170: 6574 2e69 6e74 6572 706f 6c61 7465 3a0d  et.interpolate:.
+00002180: 0a20 2020 2020 2020 2020 2020 2053 6567  .            Seg
+00002190: 6d65 6e74 6174 696f 6e45 6469 746f 722e  mentationEditor.
+000021a0: 7265 6e64 6572 6572 2e66 626f 312e 7465  renderer.fbo1.te
+000021b0: 7874 7572 652e 7365 745f 6c69 6e65 6172  xture.set_linear
+000021c0: 5f69 6e74 6572 706f 6c61 7469 6f6e 2829  _interpolation()
+000021d0: 0d0a 2020 2020 2020 2020 2020 2020 5365  ..            Se
+000021e0: 676d 656e 7461 7469 6f6e 4564 6974 6f72  gmentationEditor
+000021f0: 2e72 656e 6465 7265 722e 6662 6f32 2e74  .renderer.fbo2.t
+00002200: 6578 7475 7265 2e73 6574 5f6c 696e 6561  exture.set_linea
+00002210: 725f 696e 7465 7270 6f6c 6174 696f 6e28  r_interpolation(
+00002220: 290d 0a20 2020 2020 2020 2065 6c73 653a  )..        else:
+00002230: 0d0a 2020 2020 2020 2020 2020 2020 5365  ..            Se
+00002240: 676d 656e 7461 7469 6f6e 4564 6974 6f72  gmentationEditor
+00002250: 2e72 656e 6465 7265 722e 6662 6f31 2e74  .renderer.fbo1.t
+00002260: 6578 7475 7265 2e73 6574 5f6e 6f5f 696e  exture.set_no_in
+00002270: 7465 7270 6f6c 6174 696f 6e28 290d 0a20  terpolation().. 
+00002280: 2020 2020 2020 2020 2020 2053 6567 6d65             Segme
+00002290: 6e74 6174 696f 6e45 6469 746f 722e 7265  ntationEditor.re
+000022a0: 6e64 6572 6572 2e66 626f 322e 7465 7874  nderer.fbo2.text
+000022b0: 7572 652e 7365 745f 6e6f 5f69 6e74 6572  ure.set_no_inter
+000022c0: 706f 6c61 7469 6f6e 2829 0d0a 0d0a 2020  polation()....  
+000022d0: 2020 6465 6620 6f6e 5f75 7064 6174 6528    def on_update(
+000022e0: 7365 6c66 293a 0d0a 2020 2020 2020 2020  self):..        
+000022f0: 696d 6775 692e 7365 745f 6375 7272 656e  imgui.set_curren
+00002300: 745f 636f 6e74 6578 7428 7365 6c66 2e69  t_context(self.i
+00002310: 6d67 7569 5f63 6f6e 7465 7874 290d 0a20  mgui_context).. 
+00002320: 2020 2020 2020 2069 6d67 7569 2e43 4f4e         imgui.CON
+00002330: 4649 475f 444f 434b 494e 475f 454e 4142  FIG_DOCKING_ENAB
+00002340: 4c45 203d 2054 7275 6520 2023 2320 6d61  LE = True  ## ma
+00002350: 6179 7979 7962 6520 6e6f 743f 0d0a 0d0a  ayyyybe not?....
+00002360: 2020 2020 2020 2020 7365 6c66 2e77 696e          self.win
+00002370: 646f 772e 6d61 6b65 5f63 7572 7265 6e74  dow.make_current
+00002380: 2829 0d0a 2020 2020 2020 2020 7365 6c66  ()..        self
+00002390: 2e77 696e 646f 772e 7365 745f 6675 6c6c  .window.set_full
+000023a0: 5f76 6965 7770 6f72 7428 290d 0a20 2020  _viewport()..   
+000023b0: 2020 2020 2069 6620 7365 6c66 2e77 696e       if self.win
+000023c0: 646f 772e 666f 6375 7365 643a 0d0a 2020  dow.focused:..  
+000023d0: 2020 2020 2020 2020 2020 7365 6c66 2e69            self.i
+000023e0: 6d67 7569 5f69 6d70 6c65 6d65 6e74 6174  mgui_implementat
+000023f0: 696f 6e2e 7072 6f63 6573 735f 696e 7075  ion.process_inpu
+00002400: 7473 2829 0d0a 0d0a 2020 2020 2020 2020  ts()....        
+00002410: 6966 2045 4d42 4544 4445 443a 0d0a 2020  if EMBEDDED:..  
+00002420: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
+00002430: 2069 6d67 7569 2e67 6574 5f69 6f28 292e   imgui.get_io().
+00002440: 7761 6e74 5f63 6170 7475 7265 5f6b 6579  want_capture_key
+00002450: 626f 6172 6420 616e 6420 696d 6775 692e  board and imgui.
+00002460: 6973 5f6b 6579 5f70 7265 7373 6564 2867  is_key_pressed(g
+00002470: 6c66 772e 4b45 595f 5441 4229 3a0d 0a20  lfw.KEY_TAB):.. 
+00002480: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00002490: 6620 5365 676d 656e 7461 7469 6f6e 4564  f SegmentationEd
+000024a0: 6974 6f72 2e69 735f 7368 6966 745f 646f  itor.is_shift_do
+000024b0: 776e 2829 3a0d 0a20 2020 2020 2020 2020  wn():..         
+000024c0: 2020 2020 2020 2020 2020 2073 636e 5f63             scn_c
+000024d0: 6667 2e61 6374 6976 655f 6564 6974 6f72  fg.active_editor
+000024e0: 203d 2028 7363 6e5f 6366 672e 6163 7469   = (scn_cfg.acti
+000024f0: 7665 5f65 6469 746f 7220 2d20 3129 2025  ve_editor - 1) %
+00002500: 206c 656e 2873 636e 5f63 6667 2e65 6469   len(scn_cfg.edi
+00002510: 746f 7273 290d 0a20 2020 2020 2020 2020  tors)..         
+00002520: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+00002530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002540: 2020 7363 6e5f 6366 672e 6163 7469 7665    scn_cfg.active
+00002550: 5f65 6469 746f 7220 3d20 2873 636e 5f63  _editor = (scn_c
+00002560: 6667 2e61 6374 6976 655f 6564 6974 6f72  fg.active_editor
+00002570: 202b 2031 2920 2520 6c65 6e28 7363 6e5f   + 1) % len(scn_
+00002580: 6366 672e 6564 6974 6f72 7329 0d0a 0d0a  cfg.editors)....
+00002590: 2020 2020 2020 2020 666f 7220 6669 6c65          for file
+000025a0: 7061 7468 2069 6e20 7365 6c66 2e77 696e  path in self.win
+000025b0: 646f 772e 6472 6f70 7065 645f 6669 6c65  dow.dropped_file
+000025c0: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
+000025d0: 7365 6c66 2e69 6d70 6f72 745f 6461 7461  self.import_data
+000025e0: 7365 7428 6669 6c65 7061 7468 290d 0a0d  set(filepath)...
+000025f0: 0a20 2020 2020 2020 2073 656c 662e 7769  .        self.wi
+00002600: 6e64 6f77 2e6f 6e5f 7570 6461 7465 2829  ndow.on_update()
+00002610: 0d0a 0d0a 2020 2020 2020 2020 6966 2073  ....        if s
+00002620: 656c 662e 7769 6e64 6f77 2e77 696e 646f  elf.window.windo
+00002630: 775f 7369 7a65 5f63 6861 6e67 6564 3a0d  w_size_changed:.
+00002640: 0a20 2020 2020 2020 2020 2020 2063 6667  .            cfg
+00002650: 2e77 696e 646f 775f 7769 6474 6820 3d20  .window_width = 
+00002660: 7365 6c66 2e77 696e 646f 772e 7769 6474  self.window.widt
+00002670: 680d 0a20 2020 2020 2020 2020 2020 2063  h..            c
+00002680: 6667 2e77 696e 646f 775f 6865 6967 6874  fg.window_height
+00002690: 203d 2073 656c 662e 7769 6e64 6f77 2e68   = self.window.h
+000026a0: 6569 6768 740d 0a20 2020 2020 2020 2020  eight..         
+000026b0: 2020 2073 656c 662e 6361 6d65 7261 2e73     self.camera.s
+000026c0: 6574 5f70 726f 6a65 6374 696f 6e5f 6d61  et_projection_ma
+000026d0: 7472 6978 2863 6667 2e77 696e 646f 775f  trix(cfg.window_
+000026e0: 7769 6474 682c 2063 6667 2e77 696e 646f  width, cfg.windo
+000026f0: 775f 6865 6967 6874 290d 0a20 2020 2020  w_height)..     
+00002700: 2020 2020 2020 2073 656c 662e 6361 6d65         self.came
+00002710: 7261 3364 2e73 6574 5f70 726f 6a65 6374  ra3d.set_project
+00002720: 696f 6e5f 6d61 7472 6978 2863 6667 2e77  ion_matrix(cfg.w
+00002730: 696e 646f 775f 7769 6474 682c 2063 6667  indow_width, cfg
+00002740: 2e77 696e 646f 775f 6865 6967 6874 290d  .window_height).
+00002750: 0a0d 0a20 2020 2020 2020 2069 6620 7365  ...        if se
+00002760: 6c66 2e61 6374 6976 655f 7461 6220 696e  lf.active_tab in
+00002770: 205b 2245 7870 6f72 7422 2c20 224d 6f64   ["Export", "Mod
+00002780: 656c 7322 5d20 616e 6420 6366 672e 7365  els"] and cfg.se
+00002790: 5f61 6374 6976 655f 6672 616d 6520 6973  _active_frame is
+000027a0: 206e 6f74 204e 6f6e 6520 616e 6420 6366   not None and cf
+000027b0: 672e 7365 5f61 6374 6976 655f 6672 616d  g.se_active_fram
+000027c0: 652e 736c 6963 655f 6368 616e 6765 643a  e.slice_changed:
+000027d0: 0d0a 2020 2020 2020 2020 2020 2020 656d  ..            em
+000027e0: 6973 7369 6f6e 7320 3d20 6c69 7374 2829  issions = list()
+000027f0: 0d0a 2020 2020 2020 2020 2020 2020 6162  ..            ab
+00002800: 736f 7262 696e 675f 6d6f 6465 6c73 203d  sorbing_models =
+00002810: 206c 6973 7428 290d 0a20 2020 2020 2020   list()..       
+00002820: 2020 2020 2023 206c 6175 6e63 6820 7468       # launch th
+00002830: 6520 6d6f 6465 6c73 0d0a 2020 2020 2020  e models..      
+00002840: 2020 2020 2020 666f 7220 6d6f 6465 6c20        for model 
+00002850: 696e 2063 6667 2e73 655f 6d6f 6465 6c73  in cfg.se_models
+00002860: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00002870: 2020 206d 6f64 656c 2e73 6574 5f73 6c69     model.set_sli
+00002880: 6365 2863 6667 2e73 655f 6163 7469 7665  ce(cfg.se_active
+00002890: 5f66 7261 6d65 2e64 6174 612c 2063 6667  _frame.data, cfg
+000028a0: 2e73 655f 6163 7469 7665 5f66 7261 6d65  .se_active_frame
+000028b0: 2e70 6978 656c 5f73 697a 652c 2063 6667  .pixel_size, cfg
+000028c0: 2e73 655f 6163 7469 7665 5f66 7261 6d65  .se_active_frame
+000028d0: 2e67 6574 5f72 6f69 5f69 6e64 6963 6573  .get_roi_indices
+000028e0: 2829 2c20 6366 672e 7365 5f61 6374 6976  (), cfg.se_activ
+000028f0: 655f 6672 616d 652e 6461 7461 2e73 6861  e_frame.data.sha
+00002900: 7065 290d 0a20 2020 2020 2020 2020 2020  pe)..           
+00002910: 2020 2020 2069 6620 6d6f 6465 6c2e 656d       if model.em
+00002920: 6974 3a0d 0a20 2020 2020 2020 2020 2020  it:..           
+00002930: 2020 2020 2020 2020 2065 6d69 7373 696f           emissio
+00002940: 6e73 2e61 7070 656e 6428 6d6f 6465 6c2e  ns.append(model.
+00002950: 6461 7461 290d 0a20 2020 2020 2020 2020  data)..         
+00002960: 2020 2020 2020 2069 6620 6d6f 6465 6c2e         if model.
+00002970: 6162 736f 7262 3a0d 0a20 2020 2020 2020  absorb:..       
+00002980: 2020 2020 2020 2020 2020 2020 2061 6273               abs
+00002990: 6f72 6269 6e67 5f6d 6f64 656c 732e 6170  orbing_models.ap
+000029a0: 7065 6e64 286d 6f64 656c 290d 0a20 2020  pend(model)..   
+000029b0: 2020 2020 2020 2020 2023 2068 6176 6520           # have 
+000029c0: 6d6f 6465 6c73 2063 6f6d 7065 7465 2066  models compete f
+000029d0: 6f72 2070 6978 656c 730d 0a20 2020 2020  or pixels..     
+000029e0: 2020 2020 2020 2069 6620 6c65 6e28 656d         if len(em
+000029f0: 6973 7369 6f6e 7329 203e 2030 2061 6e64  issions) > 0 and
+00002a00: 206c 656e 2861 6273 6f72 6269 6e67 5f6d   len(absorbing_m
+00002a10: 6f64 656c 7329 203e 2030 3a0d 0a20 2020  odels) > 0:..   
+00002a20: 2020 2020 2020 2020 2020 2020 2023 2068               # h
+00002a30: 6176 6520 6d6f 6465 6c73 2063 6f6d 7065  ave models compe
+00002a40: 7465 0d0a 2020 2020 2020 2020 2020 2020  te..            
+00002a50: 2020 2020 7374 6163 6b65 645f 6172 7261      stacked_arra
+00002a60: 7920 3d20 6e70 2e73 7461 636b 2865 6d69  y = np.stack(emi
+00002a70: 7373 696f 6e73 290d 0a20 2020 2020 2020  ssions)..       
+00002a80: 2020 2020 2020 2020 206d 6178 696d 6120           maxima 
+00002a90: 3d20 6e70 2e6d 6178 2873 7461 636b 6564  = np.max(stacked
+00002aa0: 5f61 7272 6179 2c20 6178 6973 3d30 290d  _array, axis=0).
+00002ab0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00002ac0: 2066 6f72 206d 6f64 656c 2069 6e20 6162   for model in ab
+00002ad0: 736f 7262 696e 675f 6d6f 6465 6c73 3a0d  sorbing_models:.
+00002ae0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00002af0: 2020 2020 206d 6f64 656c 2e64 6174 615b       model.data[
+00002b00: 6d6f 6465 6c2e 6461 7461 203c 206d 6178  model.data < max
+00002b10: 696d 615d 203d 2030 0d0a 2020 2020 2020  ima] = 0..      
+00002b20: 2020 2020 2020 2320 6170 706c 7920 696e        # apply in
+00002b30: 7465 7261 6374 696f 6e73 0d0a 2020 2020  teractions..    
+00002b40: 2020 2020 2020 2020 666f 7220 6d6f 6465          for mode
+00002b50: 6c20 696e 2063 6667 2e73 655f 6d6f 6465  l in cfg.se_mode
+00002b60: 6c73 3a0d 0a20 2020 2020 2020 2020 2020  ls:..           
+00002b70: 2020 2020 2066 6f72 2069 6e74 6572 6163       for interac
+00002b80: 7469 6f6e 2069 6e20 6d6f 6465 6c2e 696e  tion in model.in
+00002b90: 7465 7261 6374 696f 6e73 3a0d 0a20 2020  teractions:..   
+00002ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002bb0: 2069 6e74 6572 6163 7469 6f6e 2e61 7070   interaction.app
+00002bc0: 6c79 2863 6667 2e73 655f 6163 7469 7665  ly(cfg.se_active
+00002bd0: 5f66 7261 6d65 2e70 6978 656c 5f73 697a  _frame.pixel_siz
+00002be0: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
+00002bf0: 2020 2020 6d6f 6465 6c2e 7570 6461 7465      model.update
+00002c00: 5f74 6578 7475 7265 2829 0d0a 2020 2020  _texture()..    
+00002c10: 2020 2020 2020 2020 6366 672e 7365 5f61          cfg.se_a
+00002c20: 6374 6976 655f 6672 616d 652e 736c 6963  ctive_frame.slic
+00002c30: 655f 6368 616e 6765 6420 3d20 4661 6c73  e_changed = Fals
+00002c40: 650d 0a0d 0a20 2020 2020 2020 2069 6d67  e....        img
+00002c50: 7569 2e67 6574 5f69 6f28 292e 6469 7370  ui.get_io().disp
+00002c60: 6c61 795f 7369 7a65 203d 2073 656c 662e  lay_size = self.
+00002c70: 7769 6e64 6f77 2e77 6964 7468 2c20 7365  window.width, se
+00002c80: 6c66 2e77 696e 646f 772e 6865 6967 6874  lf.window.height
+00002c90: 0d0a 2020 2020 2020 2020 696d 6775 692e  ..        imgui.
+00002ca0: 6e65 775f 6672 616d 6528 290d 0a0d 0a20  new_frame().... 
+00002cb0: 2020 2020 2020 2069 6620 5365 676d 656e         if Segmen
+00002cc0: 7461 7469 6f6e 4564 6974 6f72 2e71 7565  tationEditor.que
+00002cd0: 7565 645f 6578 706f 7274 733a 0d0a 2020  ued_exports:..  
+00002ce0: 2020 2020 2020 2020 2020 6966 2053 6567            if Seg
+00002cf0: 6d65 6e74 6174 696f 6e45 6469 746f 722e  mentationEditor.
+00002d00: 7175 6575 6564 5f65 7870 6f72 7473 5b30  queued_exports[0
+00002d10: 5d2e 7072 6f63 6573 732e 7072 6f67 7265  ].process.progre
+00002d20: 7373 203e 3d20 312e 303a 0d0a 2020 2020  ss >= 1.0:..    
+00002d30: 2020 2020 2020 2020 2020 2020 5365 676d              Segm
+00002d40: 656e 7461 7469 6f6e 4564 6974 6f72 2e71  entationEditor.q
+00002d50: 7565 7565 645f 6578 706f 7274 732e 706f  ueued_exports.po
+00002d60: 7028 3029 0d0a 2020 2020 2020 2020 2020  p(0)..          
+00002d70: 2020 6966 2053 6567 6d65 6e74 6174 696f    if Segmentatio
+00002d80: 6e45 6469 746f 722e 7175 6575 6564 5f65  nEditor.queued_e
+00002d90: 7870 6f72 7473 3a0d 0a20 2020 2020 2020  xports:..       
+00002da0: 2020 2020 2020 2020 2069 6620 5365 676d           if Segm
+00002db0: 656e 7461 7469 6f6e 4564 6974 6f72 2e71  entationEditor.q
+00002dc0: 7565 7565 645f 6578 706f 7274 735b 305d  ueued_exports[0]
+00002dd0: 2e70 726f 6365 7373 2e70 726f 6772 6573  .process.progres
+00002de0: 7320 3d3d 2030 2e30 3a0d 0a20 2020 2020  s == 0.0:..     
+00002df0: 2020 2020 2020 2020 2020 2020 2020 2053                 S
+00002e00: 6567 6d65 6e74 6174 696f 6e45 6469 746f  egmentationEdito
+00002e10: 722e 7175 6575 6564 5f65 7870 6f72 7473  r.queued_exports
+00002e20: 5b30 5d2e 7374 6172 7428 290d 0a0d 0a20  [0].start().... 
+00002e30: 2020 2020 2020 2023 2047 5549 2063 616c         # GUI cal
+00002e40: 6c73 0d0a 2020 2020 2020 2020 6966 206e  ls..        if n
+00002e50: 6f74 2073 656c 662e 7769 6e64 6f77 2e69  ot self.window.i
+00002e60: 735f 6d69 6e69 6d69 7a65 6428 293a 0d0a  s_minimized():..
+00002e70: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00002e80: 2e63 616d 6572 615f 636f 6e74 726f 6c28  .camera_control(
+00002e90: 290d 0a20 2020 2020 2020 2020 2020 2073  )..            s
+00002ea0: 656c 662e 6361 6d65 7261 2e6f 6e5f 7570  elf.camera.on_up
+00002eb0: 6461 7465 2829 0d0a 2020 2020 2020 2020  date()..        
+00002ec0: 2020 2020 7365 6c66 2e63 616d 6572 6133      self.camera3
+00002ed0: 642e 6f6e 5f75 7064 6174 6528 290d 0a20  d.on_update().. 
+00002ee0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00002ef0: 6775 695f 6d61 696e 2829 0d0a 2020 2020  gui_main()..    
+00002f00: 2020 2020 2020 2020 5365 676d 656e 7461          Segmenta
+00002f10: 7469 6f6e 4564 6974 6f72 2e72 656e 6465  tionEditor.rende
+00002f20: 7265 722e 7265 6e64 6572 5f64 7261 775f  rer.render_draw_
+00002f30: 6c69 7374 2873 656c 662e 6361 6d65 7261  list(self.camera
+00002f40: 290d 0a20 2020 2020 2020 2020 2020 2073  )..            s
+00002f50: 656c 662e 696e 7075 7428 290d 0a0d 0a20  elf.input().... 
+00002f60: 2020 2020 2020 2069 6d67 7569 2e72 656e         imgui.ren
+00002f70: 6465 7228 290d 0a20 2020 2020 2020 2073  der()..        s
+00002f80: 656c 662e 696d 6775 695f 696d 706c 656d  elf.imgui_implem
+00002f90: 656e 7461 7469 6f6e 2e72 656e 6465 7228  entation.render(
+00002fa0: 696d 6775 692e 6765 745f 6472 6177 5f64  imgui.get_draw_d
+00002fb0: 6174 6128 2929 0d0a 2020 2020 2020 2020  ata())..        
+00002fc0: 696d 6775 692e 434f 4e46 4947 5f44 4f43  imgui.CONFIG_DOC
+00002fd0: 4b49 4e47 5f45 4e41 424c 4520 3d20 4661  KING_ENABLE = Fa
+00002fe0: 6c73 650d 0a0d 0a20 2020 2064 6566 2069  lse....    def i
+00002ff0: 6e70 7574 2873 656c 6629 3a0d 0a20 2020  nput(self):..   
+00003000: 2020 2020 2069 6620 7365 6c66 2e61 6374       if self.act
+00003010: 6976 655f 7461 6220 6e6f 7420 696e 205b  ive_tab not in [
+00003020: 2253 6567 6d65 6e74 6174 696f 6e22 2c20  "Segmentation", 
+00003030: 2252 656e 6465 7222 5d20 616e 6420 6366  "Render"] and cf
+00003040: 672e 7365 5f61 6374 6976 655f 6672 616d  g.se_active_fram
+00003050: 6520 6973 206e 6f74 204e 6f6e 6520 616e  e is not None an
+00003060: 6420 6366 672e 7365 5f61 6374 6976 655f  d cfg.se_active_
+00003070: 6672 616d 652e 6372 6f70 3a0d 0a20 2020  frame.crop:..   
+00003080: 2020 2020 2020 2020 2053 6567 6d65 6e74           Segment
+00003090: 6174 696f 6e45 6469 746f 722e 7265 6e64  ationEditor.rend
+000030a0: 6572 6572 2e72 656e 6465 725f 6372 6f70  erer.render_crop
+000030b0: 5f68 616e 646c 6573 2863 6667 2e73 655f  _handles(cfg.se_
+000030c0: 6163 7469 7665 5f66 7261 6d65 2c20 7365  active_frame, se
+000030d0: 6c66 2e63 616d 6572 612c 2073 656c 662e  lf.camera, self.
+000030e0: 6372 6f70 5f68 616e 646c 6573 290d 0a20  crop_handles).. 
+000030f0: 2020 2020 2020 2069 6620 696d 6775 692e         if imgui.
+00003100: 6765 745f 696f 2829 2e77 616e 745f 6361  get_io().want_ca
+00003110: 7074 7572 655f 6b65 7962 6f61 7264 3a0d  pture_keyboard:.
+00003120: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00003130: 7572 6e0d 0a20 2020 2020 2020 2069 6620  urn..        if 
+00003140: 6366 672e 7365 5f61 6374 6976 655f 6672  cfg.se_active_fr
+00003150: 616d 6520 6973 206e 6f74 204e 6f6e 653a  ame is not None:
+00003160: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+00003170: 6620 3d20 6366 672e 7365 5f61 6374 6976  f = cfg.se_activ
+00003180: 655f 6672 616d 650d 0a20 2020 2020 2020  e_frame..       
+00003190: 2020 2020 2069 6620 696d 6775 692e 6973       if imgui.is
+000031a0: 5f6b 6579 5f70 7265 7373 6564 2867 6c66  _key_pressed(glf
+000031b0: 772e 4b45 595f 4329 3a0d 0a20 2020 2020  w.KEY_C):..     
+000031c0: 2020 2020 2020 2020 2020 2073 6566 2e63             sef.c
+000031d0: 726f 7020 3d20 6e6f 7420 7365 662e 6372  rop = not sef.cr
+000031e0: 6f70 0d0a 2020 2020 2020 2020 2020 2020  op..            
+000031f0: 2020 2020 6966 206e 6f74 2073 6566 2e63      if not sef.c
+00003200: 726f 703a 0d0a 2020 2020 2020 2020 2020  rop:..          
+00003210: 2020 2020 2020 2020 2020 7365 662e 6372            sef.cr
+00003220: 6f70 5f72 6f69 203d 205b 302c 2030 2c20  op_roi = [0, 0, 
+00003230: 7365 662e 7769 6474 682c 2073 6566 2e68  sef.width, sef.h
+00003240: 6569 6768 745d 0d0a 2020 2020 2020 2020  eight]..        
+00003250: 2020 2020 6966 2069 6d67 7569 2e69 735f      if imgui.is_
+00003260: 6b65 795f 7072 6573 7365 6428 676c 6677  key_pressed(glfw
+00003270: 2e4b 4559 5f53 2920 616e 6420 5365 676d  .KEY_S) and Segm
+00003280: 656e 7461 7469 6f6e 4564 6974 6f72 2e69  entationEditor.i
+00003290: 735f 6374 726c 5f64 6f77 6e28 293a 0d0a  s_ctrl_down():..
+000032a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000032b0: 5365 676d 656e 7461 7469 6f6e 4564 6974  SegmentationEdit
+000032c0: 6f72 2e73 6176 655f 6461 7461 7365 7428  or.save_dataset(
+000032d0: 6469 616c 6f67 3d46 616c 7365 290d 0a20  dialog=False).. 
+000032e0: 2020 2020 2020 2020 2020 2069 6620 696d             if im
+000032f0: 6775 692e 6973 5f6b 6579 5f70 7265 7373  gui.is_key_press
+00003300: 6564 2867 6c66 772e 4b45 595f 4929 3a0d  ed(glfw.KEY_I):.
+00003310: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00003320: 2069 6620 5365 676d 656e 7461 7469 6f6e   if Segmentation
+00003330: 4564 6974 6f72 2e69 735f 7368 6966 745f  Editor.is_shift_
+00003340: 646f 776e 2829 3a0d 0a20 2020 2020 2020  down():..       
+00003350: 2020 2020 2020 2020 2020 2020 2073 6566               sef
+00003360: 2e69 6e74 6572 706f 6c61 7465 203d 206e  .interpolate = n
+00003370: 6f74 2073 6566 2e69 6e74 6572 706f 6c61  ot sef.interpola
+00003380: 7465 0d0a 2020 2020 2020 2020 2020 2020  te..            
+00003390: 2020 2020 2020 2020 6966 2073 6566 2e69          if sef.i
+000033a0: 6e74 6572 706f 6c61 7465 3a0d 0a20 2020  nterpolate:..   
+000033b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000033c0: 2020 2020 2073 6566 2e74 6578 7475 7265       sef.texture
+000033d0: 2e73 6574 5f6c 696e 6561 725f 696e 7465  .set_linear_inte
+000033e0: 7270 6f6c 6174 696f 6e28 290d 0a20 2020  rpolation()..   
+000033f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003400: 2020 2020 2053 6567 6d65 6e74 6174 696f       Segmentatio
+00003410: 6e45 6469 746f 722e 7265 6e64 6572 6572  nEditor.renderer
+00003420: 2e66 626f 312e 7465 7874 7572 652e 7365  .fbo1.texture.se
+00003430: 745f 6c69 6e65 6172 5f69 6e74 6572 706f  t_linear_interpo
+00003440: 6c61 7469 6f6e 2829 0d0a 2020 2020 2020  lation()..      
+00003450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003460: 2020 5365 676d 656e 7461 7469 6f6e 4564    SegmentationEd
+00003470: 6974 6f72 2e72 656e 6465 7265 722e 6662  itor.renderer.fb
+00003480: 6f32 2e74 6578 7475 7265 2e73 6574 5f6c  o2.texture.set_l
+00003490: 696e 6561 725f 696e 7465 7270 6f6c 6174  inear_interpolat
+000034a0: 696f 6e28 290d 0a20 2020 2020 2020 2020  ion()..         
+000034b0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+000034c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000034d0: 2020 2020 2020 2020 2020 7365 662e 7465            sef.te
+000034e0: 7874 7572 652e 7365 745f 6e6f 5f69 6e74  xture.set_no_int
+000034f0: 6572 706f 6c61 7469 6f6e 2829 0d0a 2020  erpolation()..  
+00003500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003510: 2020 2020 2020 5365 676d 656e 7461 7469        Segmentati
+00003520: 6f6e 4564 6974 6f72 2e72 656e 6465 7265  onEditor.rendere
+00003530: 722e 6662 6f31 2e74 6578 7475 7265 2e73  r.fbo1.texture.s
+00003540: 6574 5f6e 6f5f 696e 7465 7270 6f6c 6174  et_no_interpolat
+00003550: 696f 6e28 290d 0a20 2020 2020 2020 2020  ion()..         
+00003560: 2020 2020 2020 2020 2020 2020 2020 2053                 S
+00003570: 6567 6d65 6e74 6174 696f 6e45 6469 746f  egmentationEdito
+00003580: 722e 7265 6e64 6572 6572 2e66 626f 322e  r.renderer.fbo2.
+00003590: 7465 7874 7572 652e 7365 745f 6e6f 5f69  texture.set_no_i
+000035a0: 6e74 6572 706f 6c61 7469 6f6e 2829 0d0a  nterpolation()..
+000035b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000035c0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+000035d0: 2020 2020 2020 2020 2020 2073 6566 2e69             sef.i
+000035e0: 6e76 6572 7420 3d20 6e6f 7420 7365 662e  nvert = not sef.
+000035f0: 696e 7665 7274 0d0a 2020 2020 2020 2020  invert..        
+00003600: 2020 2020 6966 2069 6d67 7569 2e69 735f      if imgui.is_
+00003610: 6b65 795f 7072 6573 7365 6428 676c 6677  key_pressed(glfw
+00003620: 2e4b 4559 5f4f 293a 0d0a 2020 2020 2020  .KEY_O):..      
+00003630: 2020 2020 2020 2020 2020 5365 676d 656e            Segmen
+00003640: 7461 7469 6f6e 4564 6974 6f72 2e4f 5645  tationEditor.OVE
+00003650: 524c 4159 5f41 4c50 4841 203d 2066 6c6f  RLAY_ALPHA = flo
+00003660: 6174 286e 6f74 2062 6f6f 6c28 5365 676d  at(not bool(Segm
+00003670: 656e 7461 7469 6f6e 4564 6974 6f72 2e4f  entationEditor.O
+00003680: 5645 524c 4159 5f41 4c50 4841 2929 0d0a  VERLAY_ALPHA))..
+00003690: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+000036a0: 6d67 7569 2e69 735f 6b65 795f 7072 6573  mgui.is_key_pres
+000036b0: 7365 6428 676c 6677 2e4b 4559 5f41 2920  sed(glfw.KEY_A) 
+000036c0: 616e 6420 6e6f 7420 5365 676d 656e 7461  and not Segmenta
+000036d0: 7469 6f6e 4564 6974 6f72 2e69 735f 6374  tionEditor.is_ct
+000036e0: 726c 5f64 6f77 6e28 293a 0d0a 2020 2020  rl_down():..    
+000036f0: 2020 2020 2020 2020 2020 2020 7365 662e              sef.
+00003700: 6175 746f 636f 6e74 7261 7374 203d 206e  autocontrast = n
+00003710: 6f74 2073 6566 2e61 7574 6f63 6f6e 7472  ot sef.autocontr
+00003720: 6173 740d 0a20 2020 2020 2020 2020 2020  ast..           
+00003730: 2020 2020 2069 6620 7365 662e 6175 746f       if sef.auto
+00003740: 636f 6e74 7261 7374 3a0d 0a20 2020 2020  contrast:..     
+00003750: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00003760: 6566 2e63 6f6d 7075 7465 5f61 7574 6f63  ef.compute_autoc
+00003770: 6f6e 7472 6173 7428 290d 0a20 2020 2020  ontrast()..     
+00003780: 2020 2020 2020 2069 6620 696d 6775 692e         if imgui.
+00003790: 6973 5f6b 6579 5f70 7265 7373 6564 2867  is_key_pressed(g
+000037a0: 6c66 772e 4b45 595f 5350 4143 4529 3a0d  lfw.KEY_SPACE):.
+000037b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000037c0: 2073 656c 662e 6361 6d65 7261 203d 2043   self.camera = C
+000037d0: 616d 6572 6128 290d 0a20 2020 2020 2020  amera()..       
+000037e0: 2020 2020 2020 2020 2073 656c 662e 6361           self.ca
+000037f0: 6d65 7261 3364 203d 2043 616d 6572 6133  mera3d = Camera3
+00003800: 4428 290d 0a20 2020 2020 2020 2020 2020  D()..           
+00003810: 2020 2020 2073 656c 662e 6361 6d65 7261       self.camera
+00003820: 2e7a 6f6f 6d20 3d20 5365 676d 656e 7461  .zoom = Segmenta
+00003830: 7469 6f6e 4564 6974 6f72 2e44 4546 4155  tionEditor.DEFAU
+00003840: 4c54 5f5a 4f4f 4d0d 0a20 2020 2020 2020  LT_ZOOM..       
+00003850: 2020 2020 2020 2020 2053 6567 6d65 6e74           Segment
+00003860: 6174 696f 6e45 6469 746f 722e 5649 4557  ationEditor.VIEW
+00003870: 5f52 4551 5549 5245 535f 5550 4441 5445  _REQUIRES_UPDATE
+00003880: 203d 2054 7275 650d 0a20 2020 2020 2020   = True..       
+00003890: 2020 2020 2069 6620 7365 6c66 2e61 6374       if self.act
+000038a0: 6976 655f 7461 6220 3d3d 2022 5365 676d  ive_tab == "Segm
+000038b0: 656e 7461 7469 6f6e 2220 616e 6420 6366  entation" and cf
+000038c0: 672e 7365 5f61 6374 6976 655f 6672 616d  g.se_active_fram
+000038d0: 652e 6163 7469 7665 5f66 6561 7475 7265  e.active_feature
+000038e0: 2069 7320 6e6f 7420 4e6f 6e65 3a0d 0a20   is not None:.. 
+000038f0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00003900: 6620 696d 6775 692e 6973 5f6b 6579 5f70  f imgui.is_key_p
+00003910: 7265 7373 6564 2867 6c66 772e 4b45 595f  ressed(glfw.KEY_
+00003920: 4629 3a0d 0a20 2020 2020 2020 2020 2020  F):..           
+00003930: 2020 2020 2020 2020 2063 6667 2e73 655f           cfg.se_
+00003940: 6163 7469 7665 5f66 7261 6d65 2e61 6374  active_frame.act
+00003950: 6976 655f 6665 6174 7572 652e 6d61 6769  ive_feature.magi
+00003960: 6320 3d20 6e6f 7420 6366 672e 7365 5f61  c = not cfg.se_a
+00003970: 6374 6976 655f 6672 616d 652e 6163 7469  ctive_frame.acti
+00003980: 7665 5f66 6561 7475 7265 2e6d 6167 6963  ve_feature.magic
+00003990: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000039a0: 2020 6966 2063 6667 2e73 655f 6163 7469    if cfg.se_acti
+000039b0: 7665 5f66 7261 6d65 2e61 6374 6976 655f  ve_frame.active_
+000039c0: 6665 6174 7572 652e 6d61 6769 633a 0d0a  feature.magic:..
+000039d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000039e0: 2020 2020 6966 2069 6d67 7569 2e69 735f      if imgui.is_
+000039f0: 6b65 795f 7072 6573 7365 6428 676c 6677  key_pressed(glfw
+00003a00: 2e4b 4559 5f4d 494e 5553 293a 0d0a 2020  .KEY_MINUS):..  
+00003a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003a20: 2020 2020 2020 6366 672e 7365 5f61 6374        cfg.se_act
+00003a30: 6976 655f 6672 616d 652e 6163 7469 7665  ive_frame.active
+00003a40: 5f66 6561 7475 7265 2e6d 6167 6963 5f73  _feature.magic_s
+00003a50: 7472 656e 6774 6820 2d3d 2035 2e30 0d0a  trength -= 5.0..
+00003a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003a70: 2020 2020 2020 2020 6366 672e 7365 5f61          cfg.se_a
+00003a80: 6374 6976 655f 6672 616d 652e 6163 7469  ctive_frame.acti
+00003a90: 7665 5f66 6561 7475 7265 2e6d 6167 6963  ve_feature.magic
+00003aa0: 5f73 7472 656e 6774 6820 3d20 6d61 7828  _strength = max(
+00003ab0: 5b35 2e30 2c20 6366 672e 7365 5f61 6374  [5.0, cfg.se_act
+00003ac0: 6976 655f 6672 616d 652e 6163 7469 7665  ive_frame.active
+00003ad0: 5f66 6561 7475 7265 2e6d 6167 6963 5f73  _feature.magic_s
+00003ae0: 7472 656e 6774 685d 290d 0a20 2020 2020  trength])..     
+00003af0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00003b00: 6c69 6620 696d 6775 692e 6973 5f6b 6579  lif imgui.is_key
+00003b10: 5f70 7265 7373 6564 2867 6c66 772e 4b45  _pressed(glfw.KE
+00003b20: 595f 4551 5541 4c29 3a0d 0a20 2020 2020  Y_EQUAL):..     
+00003b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003b40: 2020 2063 6667 2e73 655f 6163 7469 7665     cfg.se_active
+00003b50: 5f66 7261 6d65 2e61 6374 6976 655f 6665  _frame.active_fe
+00003b60: 6174 7572 652e 6d61 6769 635f 7374 7265  ature.magic_stre
+00003b70: 6e67 7468 202b 3d20 352e 300d 0a20 2020  ngth += 5.0..   
+00003b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003b90: 2020 2020 2063 6667 2e73 655f 6163 7469       cfg.se_acti
+00003ba0: 7665 5f66 7261 6d65 2e61 6374 6976 655f  ve_frame.active_
+00003bb0: 6665 6174 7572 652e 6d61 6769 635f 7374  feature.magic_st
+00003bc0: 7265 6e67 7468 203d 206d 696e 285b 3130  rength = min([10
+00003bd0: 302e 302c 2063 6667 2e73 655f 6163 7469  0.0, cfg.se_acti
+00003be0: 7665 5f66 7261 6d65 2e61 6374 6976 655f  ve_frame.active_
+00003bf0: 6665 6174 7572 652e 6d61 6769 635f 7374  feature.magic_st
+00003c00: 7265 6e67 7468 5d29 0d0a 0d0a 0d0a 2020  rength])......  
+00003c10: 2020 2020 2020 2320 6b65 7920 696e 7075        # key inpu
+00003c20: 740d 0a20 2020 2020 2020 2061 6374 6976  t..        activ
+00003c30: 655f 6672 616d 6520 3d20 6366 672e 7365  e_frame = cfg.se
+00003c40: 5f61 6374 6976 655f 6672 616d 650d 0a20  _active_frame.. 
+00003c50: 2020 2020 2020 2069 6620 6e6f 7420 7365         if not se
+00003c60: 6c66 2e61 6374 6976 655f 7461 6220 3d3d  lf.active_tab ==
+00003c70: 2022 5265 6e64 6572 223a 0d0a 2020 2020   "Render":..    
+00003c80: 2020 2020 2020 2020 6966 2061 6374 6976          if activ
+00003c90: 655f 6672 616d 6520 696e 2063 6667 2e73  e_frame in cfg.s
+00003ca0: 655f 6672 616d 6573 3a0d 0a20 2020 2020  e_frames:..     
+00003cb0: 2020 2020 2020 2020 2020 2069 6620 696d             if im
+00003cc0: 6775 692e 6973 5f6b 6579 5f70 7265 7373  gui.is_key_press
+00003cd0: 6564 2867 6c66 772e 4b45 595f 5550 293a  ed(glfw.KEY_UP):
+00003ce0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00003cf0: 2020 2020 2020 6964 7820 3d20 6366 672e        idx = cfg.
+00003d00: 7365 5f66 7261 6d65 732e 696e 6465 7828  se_frames.index(
+00003d10: 6163 7469 7665 5f66 7261 6d65 2920 2d20  active_frame) - 
+00003d20: 310d 0a20 2020 2020 2020 2020 2020 2020  1..             
+00003d30: 2020 2020 2020 2069 6478 203d 206d 6178         idx = max
+00003d40: 2830 2c20 6964 7829 0d0a 2020 2020 2020  (0, idx)..      
+00003d50: 2020 2020 2020 2020 2020 2020 2020 5365                Se
+00003d60: 676d 656e 7461 7469 6f6e 4564 6974 6f72  gmentationEditor
+00003d70: 2e73 6574 5f61 6374 6976 655f 6461 7461  .set_active_data
+00003d80: 7365 7428 6366 672e 7365 5f66 7261 6d65  set(cfg.se_frame
+00003d90: 735b 6964 785d 290d 0a20 2020 2020 2020  s[idx])..       
+00003da0: 2020 2020 2020 2020 2065 6c69 6620 696d           elif im
+00003db0: 6775 692e 6973 5f6b 6579 5f70 7265 7373  gui.is_key_press
+00003dc0: 6564 2867 6c66 772e 4b45 595f 444f 574e  ed(glfw.KEY_DOWN
+00003dd0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+00003de0: 2020 2020 2020 2020 6964 7820 3d20 6366          idx = cf
+00003df0: 672e 7365 5f66 7261 6d65 732e 696e 6465  g.se_frames.inde
+00003e00: 7828 6163 7469 7665 5f66 7261 6d65 2920  x(active_frame) 
+00003e10: 2b20 310d 0a20 2020 2020 2020 2020 2020  + 1..           
+00003e20: 2020 2020 2020 2020 2069 6478 203d 206d           idx = m
+00003e30: 696e 2869 6478 2c20 6c65 6e28 6366 672e  in(idx, len(cfg.
+00003e40: 7365 5f66 7261 6d65 7329 202d 2031 290d  se_frames) - 1).
+00003e50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00003e60: 2020 2020 2053 6567 6d65 6e74 6174 696f       Segmentatio
+00003e70: 6e45 6469 746f 722e 7365 745f 6163 7469  nEditor.set_acti
+00003e80: 7665 5f64 6174 6173 6574 2863 6667 2e73  ve_dataset(cfg.s
+00003e90: 655f 6672 616d 6573 5b69 6478 5d29 0d0a  e_frames[idx])..
+00003ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003eb0: 656c 6966 2069 6d67 7569 2e69 735f 6b65  elif imgui.is_ke
+00003ec0: 795f 7072 6573 7365 6428 676c 6677 2e4b  y_pressed(glfw.K
+00003ed0: 4559 5f4c 4546 542c 2054 7275 6529 3a0d  EY_LEFT, True):.
+00003ee0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00003ef0: 2020 2020 2061 6374 6976 655f 6672 616d       active_fram
+00003f00: 652e 7365 745f 736c 6963 6528 6163 7469  e.set_slice(acti
+00003f10: 7665 5f66 7261 6d65 2e63 7572 7265 6e74  ve_frame.current
+00003f20: 5f73 6c69 6365 202d 2031 290d 0a20 2020  _slice - 1)..   
+00003f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003f40: 2053 6567 6d65 6e74 6174 696f 6e45 6469   SegmentationEdi
+00003f50: 746f 722e 4652 414d 455f 5445 5854 5552  tor.FRAME_TEXTUR
+00003f60: 455f 5245 5155 4952 4553 5f55 5044 4154  E_REQUIRES_UPDAT
+00003f70: 4520 7c3d 2054 7275 650d 0a20 2020 2020  E |= True..     
+00003f80: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+00003f90: 696d 6775 692e 6973 5f6b 6579 5f70 7265  imgui.is_key_pre
+00003fa0: 7373 6564 2867 6c66 772e 4b45 595f 5249  ssed(glfw.KEY_RI
+00003fb0: 4748 542c 2054 7275 6529 3a0d 0a20 2020  GHT, True):..   
+00003fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003fd0: 2061 6374 6976 655f 6672 616d 652e 7365   active_frame.se
+00003fe0: 745f 736c 6963 6528 6163 7469 7665 5f66  t_slice(active_f
+00003ff0: 7261 6d65 2e63 7572 7265 6e74 5f73 6c69  rame.current_sli
+00004000: 6365 202b 2031 290d 0a20 2020 2020 2020  ce + 1)..       
+00004010: 2020 2020 2020 2020 2020 2020 2053 6567               Seg
+00004020: 6d65 6e74 6174 696f 6e45 6469 746f 722e  mentationEditor.
+00004030: 4652 414d 455f 5445 5854 5552 455f 5245  FRAME_TEXTURE_RE
+00004040: 5155 4952 4553 5f55 5044 4154 4520 7c3d  QUIRES_UPDATE |=
+00004050: 2054 7275 650d 0a20 2020 2020 2020 2061   True..        a
+00004060: 6374 6976 655f 6665 6174 7572 6520 3d20  ctive_feature = 
+00004070: 4e6f 6e65 0d0a 2020 2020 2020 2020 6966  None..        if
+00004080: 2061 6374 6976 655f 6672 616d 6520 6973   active_frame is
+00004090: 206e 6f74 204e 6f6e 653a 0d0a 2020 2020   not None:..    
+000040a0: 2020 2020 2020 2020 6163 7469 7665 5f66          active_f
+000040b0: 6561 7475 7265 203d 2063 6667 2e73 655f  eature = cfg.se_
+000040c0: 6163 7469 7665 5f66 7261 6d65 2e61 6374  active_frame.act
+000040d0: 6976 655f 6665 6174 7572 650d 0a0d 0a20  ive_feature.... 
+000040e0: 2020 2020 2020 2023 204b 6579 2069 6e70         # Key inp
+000040f0: 7574 7320 7468 6174 2061 6666 6563 7420  uts that affect 
+00004100: 7468 6520 6163 7469 7665 2066 6561 7475  the active featu
+00004110: 7265 3a0d 0a20 2020 2020 2020 2069 6620  re:..        if 
+00004120: 6163 7469 7665 5f66 7261 6d65 2069 7320  active_frame is 
+00004130: 6e6f 7420 4e6f 6e65 3a0d 0a20 2020 2020  not None:..     
+00004140: 2020 2020 2020 2069 6620 6e6f 7420 5365         if not Se
+00004150: 676d 656e 7461 7469 6f6e 4564 6974 6f72  gmentationEditor
+00004160: 2e69 735f 7368 6966 745f 646f 776e 2829  .is_shift_down()
+00004170: 2061 6e64 206e 6f74 2053 6567 6d65 6e74   and not Segment
+00004180: 6174 696f 6e45 6469 746f 722e 6973 5f63  ationEditor.is_c
+00004190: 7472 6c5f 646f 776e 2829 2061 6e64 2061  trl_down() and a
+000041a0: 6374 6976 655f 6672 616d 6520 6973 206e  ctive_frame is n
+000041b0: 6f74 204e 6f6e 653a 0d0a 2020 2020 2020  ot None:..      
+000041c0: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+000041d0: 662e 7769 6e64 6f77 2e73 6372 6f6c 6c5f  f.window.scroll_
+000041e0: 6465 6c74 615b 315d 2021 3d20 302e 303a  delta[1] != 0.0:
+000041f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00004200: 2020 2020 2020 6964 7820 3d20 696e 7428        idx = int(
+00004210: 6163 7469 7665 5f66 7261 6d65 2e63 7572  active_frame.cur
+00004220: 7265 6e74 5f73 6c69 6365 202d 2073 656c  rent_slice - sel
+00004230: 662e 7769 6e64 6f77 2e73 6372 6f6c 6c5f  f.window.scroll_
+00004240: 6465 6c74 615b 315d 290d 0a20 2020 2020  delta[1])..     
+00004250: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00004260: 6478 203d 2069 6478 2025 2061 6374 6976  dx = idx % activ
+00004270: 655f 6672 616d 652e 6e5f 736c 6963 6573  e_frame.n_slices
+00004280: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00004290: 2020 2020 2020 6163 7469 7665 5f66 7261        active_fra
+000042a0: 6d65 2e73 6574 5f73 6c69 6365 2869 6478  me.set_slice(idx
+000042b0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+000042c0: 2020 2020 2020 2053 6567 6d65 6e74 6174         Segmentat
+000042d0: 696f 6e45 6469 746f 722e 4652 414d 455f  ionEditor.FRAME_
+000042e0: 5445 5854 5552 455f 5245 5155 4952 4553  TEXTURE_REQUIRES
+000042f0: 5f55 5044 4154 4520 7c3d 2054 7275 650d  _UPDATE |= True.
+00004300: 0a0d 0a20 2020 2020 2020 2069 6620 7365  ...        if se
+00004310: 6c66 2e61 6374 6976 655f 7461 6220 3d3d  lf.active_tab ==
+00004320: 2022 5365 676d 656e 7461 7469 6f6e 223a   "Segmentation":
+00004330: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+00004340: 2061 6374 6976 655f 6665 6174 7572 6520   active_feature 
+00004350: 6973 206e 6f74 204e 6f6e 653a 0d0a 2020  is not None:..  
+00004360: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00004370: 2053 6567 6d65 6e74 6174 696f 6e45 6469   SegmentationEdi
+00004380: 746f 722e 6973 5f63 7472 6c5f 646f 776e  tor.is_ctrl_down
+00004390: 2829 2061 6e64 2061 6374 6976 655f 6665  () and active_fe
+000043a0: 6174 7572 6520 6973 206e 6f74 204e 6f6e  ature is not Non
+000043b0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+000043c0: 2020 2020 2020 2020 6163 7469 7665 5f66          active_f
+000043d0: 6561 7475 7265 2e62 7275 7368 5f73 697a  eature.brush_siz
+000043e0: 6520 2b3d 2073 656c 662e 7769 6e64 6f77  e += self.window
+000043f0: 2e73 6372 6f6c 6c5f 6465 6c74 615b 315d  .scroll_delta[1]
+00004400: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00004410: 2020 2020 2020 6163 7469 7665 5f66 6561        active_fea
+00004420: 7475 7265 2e62 7275 7368 5f73 697a 6520  ture.brush_size 
+00004430: 3d20 6d61 7828 5b31 2c20 6163 7469 7665  = max([1, active
+00004440: 5f66 6561 7475 7265 2e62 7275 7368 5f73  _feature.brush_s
+00004450: 697a 655d 290d 0a20 2020 2020 2020 2020  ize])..         
+00004460: 2020 2020 2020 2069 6620 696d 6775 692e         if imgui.
+00004470: 6973 5f6b 6579 5f70 7265 7373 6564 2867  is_key_pressed(g
+00004480: 6c66 772e 4b45 595f 5329 2061 6e64 206e  lfw.KEY_S) and n
+00004490: 6f74 2069 6d67 7569 2e69 735f 6b65 795f  ot imgui.is_key_
+000044a0: 646f 776e 2867 6c66 772e 4b45 595f 4c45  down(glfw.KEY_LE
+000044b0: 4654 5f43 4f4e 5452 4f4c 293a 0d0a 2020  FT_CONTROL):..  
+000044c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000044d0: 2020 6964 7820 3d20 3020 6966 2061 6374    idx = 0 if act
+000044e0: 6976 655f 6665 6174 7572 6520 6e6f 7420  ive_feature not 
+000044f0: 696e 2061 6374 6976 655f 6672 616d 652e  in active_frame.
+00004500: 6665 6174 7572 6573 2065 6c73 6520 6163  features else ac
+00004510: 7469 7665 5f66 7261 6d65 2e66 6561 7475  tive_frame.featu
+00004520: 7265 732e 696e 6465 7828 6163 7469 7665  res.index(active
+00004530: 5f66 6561 7475 7265 290d 0a20 2020 2020  _feature)..     
+00004540: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00004550: 6478 203d 2028 6964 7820 2b20 3129 2025  dx = (idx + 1) %
+00004560: 206c 656e 2861 6374 6976 655f 6672 616d   len(active_fram
+00004570: 652e 6665 6174 7572 6573 290d 0a20 2020  e.features)..   
+00004580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004590: 2063 6667 2e73 655f 6163 7469 7665 5f66   cfg.se_active_f
+000045a0: 7261 6d65 2e61 6374 6976 655f 6665 6174  rame.active_feat
+000045b0: 7572 6520 3d20 6366 672e 7365 5f61 6374  ure = cfg.se_act
+000045c0: 6976 655f 6672 616d 652e 6665 6174 7572  ive_frame.featur
+000045d0: 6573 5b69 6478 5d0d 0a20 2020 2020 2020  es[idx]..       
+000045e0: 2020 2020 2020 2020 2065 6c69 6620 696d           elif im
+000045f0: 6775 692e 6973 5f6b 6579 5f70 7265 7373  gui.is_key_press
+00004600: 6564 2867 6c66 772e 4b45 595f 5729 3a0d  ed(glfw.KEY_W):.
+00004610: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00004620: 2020 2020 2069 6478 203d 2030 2069 6620       idx = 0 if 
+00004630: 6163 7469 7665 5f66 6561 7475 7265 206e  active_feature n
+00004640: 6f74 2069 6e20 6163 7469 7665 5f66 7261  ot in active_fra
+00004650: 6d65 2e66 6561 7475 7265 7320 656c 7365  me.features else
+00004660: 2061 6374 6976 655f 6672 616d 652e 6665   active_frame.fe
+00004670: 6174 7572 6573 2e69 6e64 6578 2861 6374  atures.index(act
+00004680: 6976 655f 6665 6174 7572 6529 0d0a 2020  ive_feature)..  
+00004690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000046a0: 2020 6964 7820 3d20 2869 6478 202d 2031    idx = (idx - 1
+000046b0: 2920 2520 6c65 6e28 6163 7469 7665 5f66  ) % len(active_f
+000046c0: 7261 6d65 2e66 6561 7475 7265 7329 0d0a  rame.features)..
+000046d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000046e0: 2020 2020 6366 672e 7365 5f61 6374 6976      cfg.se_activ
+000046f0: 655f 6672 616d 652e 6163 7469 7665 5f66  e_frame.active_f
+00004700: 6561 7475 7265 203d 2063 6667 2e73 655f  eature = cfg.se_
+00004710: 6163 7469 7665 5f66 7261 6d65 2e66 6561  active_frame.fea
+00004720: 7475 7265 735b 6964 785d 0d0a 0d0a 2020  tures[idx]....  
+00004730: 2020 2020 2020 2020 2020 2320 4472 6177            # Draw
+00004740: 696e 6720 2f20 6d6f 7573 6520 696e 7075  ing / mouse inpu
+00004750: 740d 0a20 2020 2020 2020 2020 2020 2069  t..            i
+00004760: 6620 6163 7469 7665 5f66 6561 7475 7265  f active_feature
+00004770: 2069 7320 6e6f 7420 4e6f 6e65 2061 6e64   is not None and
+00004780: 206e 6f74 2069 6d67 7569 2e67 6574 5f69   not imgui.get_i
+00004790: 6f28 292e 7761 6e74 5f63 6170 7475 7265  o().want_capture
+000047a0: 5f6d 6f75 7365 3a0d 0a20 2020 2020 2020  _mouse:..       
+000047b0: 2020 2020 2020 2020 2063 7572 736f 725f           cursor_
+000047c0: 776f 726c 645f 706f 7369 7469 6f6e 203d  world_position =
+000047d0: 2073 656c 662e 6361 6d65 7261 2e63 7572   self.camera.cur
+000047e0: 736f 725f 746f 5f77 6f72 6c64 5f70 6f73  sor_to_world_pos
+000047f0: 6974 696f 6e28 7365 6c66 2e77 696e 646f  ition(self.windo
+00004800: 772e 6375 7273 6f72 5f70 6f73 290d 0a20  w.cursor_pos).. 
+00004810: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00004820: 6978 656c 5f63 6f6f 7264 696e 6174 6520  ixel_coordinate 
+00004830: 3d20 6163 7469 7665 5f66 6561 7475 7265  = active_feature
+00004840: 2e70 6172 656e 742e 776f 726c 645f 746f  .parent.world_to
+00004850: 5f70 6978 656c 5f63 6f6f 7264 696e 6174  _pixel_coordinat
+00004860: 6528 6375 7273 6f72 5f77 6f72 6c64 5f70  e(cursor_world_p
+00004870: 6f73 6974 696f 6e29 0d0a 0d0a 0d0a 2020  osition)......  
+00004880: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00004890: 206e 6f74 2053 6567 6d65 6e74 6174 696f   not Segmentatio
+000048a0: 6e45 6469 746f 722e 6973 5f73 6869 6674  nEditor.is_shift
+000048b0: 5f64 6f77 6e28 293a 0d0a 2020 2020 2020  _down():..      
+000048c0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+000048d0: 2069 6d67 7569 2e69 735f 6d6f 7573 655f   imgui.is_mouse_
+000048e0: 646f 776e 2830 293a 0d0a 2020 2020 2020  down(0):..      
+000048f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004900: 2020 6163 7469 7665 5f66 6561 7475 7265    active_feature
+00004910: 2e68 6964 6520 3d20 4661 6c73 650d 0a20  .hide = False.. 
+00004920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004930: 2020 2020 2020 2069 6620 6163 7469 7665         if active
+00004940: 5f66 6561 7475 7265 2e6d 6167 6963 3a0d  _feature.magic:.
+00004950: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00004960: 2020 2020 2020 2020 2020 2020 2074 7279               try
+00004970: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00004980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004990: 2020 2042 7275 7368 2e61 7070 6c79 5f6d     Brush.apply_m
+000049a0: 6167 6963 2861 6374 6976 655f 6665 6174  agic(active_feat
+000049b0: 7572 652c 2061 6374 6976 655f 6665 6174  ure, active_feat
+000049c0: 7572 652e 7061 7265 6e74 2e72 656e 6465  ure.parent.rende
+000049d0: 7265 645f 6461 7461 2c20 7069 7865 6c5f  red_data, pixel_
+000049e0: 636f 6f72 6469 6e61 7465 290d 0a20 2020  coordinate)..   
+000049f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004a00: 2020 2020 2020 2020 2065 7863 6570 7420           except 
+00004a10: 4578 6365 7074 696f 6e20 6173 2065 3a0d  Exception as e:.
+00004a20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00004a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004a40: 2070 6173 7320 2023 2062 6974 2065 7870   pass  # bit exp
+00004a50: 6572 696d 656e 7461 6c20 7374 696c 6c2e  erimental still.
+00004a60: 2054 4f44 4f3a 2066 6978 2065 7272 6f72   TODO: fix error
+00004a70: 2074 6872 6f77 6e20 7768 656e 2066 6c6f   thrown when flo
+00004a80: 6f64 2066 696c 6c20 524f 4920 7061 7274  od fill ROI part
+00004a90: 6961 6c6c 7920 6661 6c6c 7320 6f75 7473  ially falls outs
+00004aa0: 6964 6520 696d 6167 652e 0d0a 2020 2020  ide image...    
+00004ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004ac0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00004ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004ae0: 2020 2020 2020 2042 7275 7368 2e61 7070         Brush.app
+00004af0: 6c79 5f63 6972 6375 6c61 7228 6163 7469  ly_circular(acti
+00004b00: 7665 5f66 6561 7475 7265 2c20 7069 7865  ve_feature, pixe
+00004b10: 6c5f 636f 6f72 6469 6e61 7465 2c20 5472  l_coordinate, Tr
+00004b20: 7565 290d 0a20 2020 2020 2020 2020 2020  ue)..           
+00004b30: 2020 2020 2020 2020 2065 6c69 6620 696d           elif im
+00004b40: 6775 692e 6973 5f6d 6f75 7365 5f64 6f77  gui.is_mouse_dow
+00004b50: 6e28 3129 3a0d 0a20 2020 2020 2020 2020  n(1):..         
+00004b60: 2020 2020 2020 2020 2020 2020 2020 2042                 B
+00004b70: 7275 7368 2e61 7070 6c79 5f63 6972 6375  rush.apply_circu
+00004b80: 6c61 7228 6163 7469 7665 5f66 6561 7475  lar(active_featu
+00004b90: 7265 2c20 7069 7865 6c5f 636f 6f72 6469  re, pixel_coordi
+00004ba0: 6e61 7465 2c20 4661 6c73 6529 0d0a 2020  nate, False)..  
+00004bb0: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00004bc0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+00004bd0: 2020 2020 2020 2020 2069 6620 696d 6775           if imgu
+00004be0: 692e 6973 5f6d 6f75 7365 5f63 6c69 636b  i.is_mouse_click
+00004bf0: 6564 2830 293a 0d0a 2020 2020 2020 2020  ed(0):..        
+00004c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004c10: 6163 7469 7665 5f66 6561 7475 7265 2e61  active_feature.a
+00004c20: 6464 5f62 6f78 2870 6978 656c 5f63 6f6f  dd_box(pixel_coo
+00004c30: 7264 696e 6174 6529 0d0a 2020 2020 2020  rdinate)..      
+00004c40: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00004c50: 6966 2069 6d67 7569 2e69 735f 6d6f 7573  if imgui.is_mous
+00004c60: 655f 636c 6963 6b65 6428 3129 3a0d 0a20  e_clicked(1):.. 
+00004c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004c80: 2020 2020 2020 2061 6374 6976 655f 6665         active_fe
+00004c90: 6174 7572 652e 7265 6d6f 7665 5f62 6f78  ature.remove_box
+00004ca0: 2870 6978 656c 5f63 6f6f 7264 696e 6174  (pixel_coordinat
+00004cb0: 6529 0d0a 2020 2020 2020 2020 656c 6966  e)..        elif
+00004cc0: 2073 656c 662e 6163 7469 7665 5f74 6162   self.active_tab
+00004cd0: 2021 3d20 2252 656e 6465 7222 2061 6e64   != "Render" and
+00004ce0: 2061 6374 6976 655f 6672 616d 6520 6973   active_frame is
+00004cf0: 206e 6f74 204e 6f6e 6520 616e 6420 6163   not None and ac
+00004d00: 7469 7665 5f66 7261 6d65 2e63 726f 7020  tive_frame.crop 
+00004d10: 616e 6420 6e6f 7420 696d 6775 692e 6765  and not imgui.ge
+00004d20: 745f 696f 2829 2e77 616e 745f 6361 7074  t_io().want_capt
+00004d30: 7572 655f 6d6f 7573 653a 0d0a 2020 2020  ure_mouse:..    
+00004d40: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
+00004d50: 656c 662e 6372 6f70 5f68 616e 646c 6573  elf.crop_handles
+00004d60: 5b30 5d2e 6d6f 7669 6e67 5f65 6e74 6972  [0].moving_entir
+00004d70: 655f 726f 693a 0d0a 2020 2020 2020 2020  e_roi:..        
+00004d80: 2020 2020 2020 2020 616e 795f 6861 6e64          any_hand
+00004d90: 6c65 5f61 6374 6976 6520 3d20 4661 6c73  le_active = Fals
+00004da0: 650d 0a20 2020 2020 2020 2020 2020 2020  e..             
+00004db0: 2020 2066 6f72 2068 2069 6e20 7365 6c66     for h in self
+00004dc0: 2e63 726f 705f 6861 6e64 6c65 733a 0d0a  .crop_handles:..
+00004dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004de0: 2020 2020 6966 206e 6f74 2068 2e61 6374      if not h.act
+00004df0: 6976 6520 616e 6420 682e 6973 5f68 6f76  ive and h.is_hov
+00004e00: 6572 6564 2873 656c 662e 6361 6d65 7261  ered(self.camera
+00004e10: 2c20 7365 6c66 2e77 696e 646f 772e 6375  , self.window.cu
+00004e20: 7273 6f72 5f70 6f73 2920 616e 6420 696d  rsor_pos) and im
+00004e30: 6775 692e 6973 5f6d 6f75 7365 5f63 6c69  gui.is_mouse_cli
+00004e40: 636b 6564 2830 293a 0d0a 2020 2020 2020  cked(0):..      
+00004e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004e60: 2020 682e 6163 7469 7665 203d 2054 7275    h.active = Tru
+00004e70: 650d 0a20 2020 2020 2020 2020 2020 2020  e..             
+00004e80: 2020 2020 2020 2020 2020 2061 6e79 5f68             any_h
+00004e90: 616e 646c 655f 6163 7469 7665 203d 2046  andle_active = F
+00004ea0: 616c 7365 0d0a 2020 2020 2020 2020 2020  alse..          
+00004eb0: 2020 2020 2020 2020 2020 6966 2068 2e61            if h.a
+00004ec0: 6374 6976 653a 0d0a 2020 2020 2020 2020  ctive:..        
+00004ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004ee0: 616e 795f 6861 6e64 6c65 5f61 6374 6976  any_handle_activ
+00004ef0: 6520 3d20 5472 7565 0d0a 2020 2020 2020  e = True..      
+00004f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004f10: 2020 776f 726c 645f 706f 7320 3d20 7365    world_pos = se
+00004f20: 6c66 2e63 616d 6572 612e 6375 7273 6f72  lf.camera.cursor
+00004f30: 5f74 6f5f 776f 726c 645f 706f 7369 7469  _to_world_positi
+00004f40: 6f6e 2873 656c 662e 7769 6e64 6f77 2e63  on(self.window.c
+00004f50: 7572 736f 725f 706f 7329 0d0a 2020 2020  ursor_pos)..    
+00004f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004f70: 2020 2020 7069 7865 6c5f 706f 7320 3d20      pixel_pos = 
+00004f80: 6163 7469 7665 5f66 7261 6d65 2e77 6f72  active_frame.wor
+00004f90: 6c64 5f74 6f5f 7069 7865 6c5f 636f 6f72  ld_to_pixel_coor
+00004fa0: 6469 6e61 7465 2877 6f72 6c64 5f70 6f73  dinate(world_pos
+00004fb0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00004fc0: 2020 2020 2020 2020 2020 2068 2e61 6666             h.aff
+00004fd0: 6563 745f 6372 6f70 2870 6978 656c 5f70  ect_crop(pixel_p
+00004fe0: 6f73 290d 0a20 2020 2020 2020 2020 2020  os)..           
+00004ff0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00005000: 6e6f 7420 696d 6775 692e 6973 5f6d 6f75  not imgui.is_mou
+00005010: 7365 5f64 6f77 6e28 3029 3a0d 0a20 2020  se_down(0):..   
+00005020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005030: 2020 2020 2020 2020 2068 2e61 6374 6976           h.activ
+00005040: 6520 3d20 4661 6c73 650d 0a20 2020 2020  e = False..     
+00005050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005060: 2020 2020 2020 2068 2e63 6f6e 7665 7274         h.convert
+00005070: 5f63 726f 705f 726f 695f 746f 5f69 6e74  _crop_roi_to_int
+00005080: 6567 6572 7328 290d 0a20 2020 2020 2020  egers()..       
+00005090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000050a0: 2020 2020 2063 6667 2e73 655f 6163 7469       cfg.se_acti
+000050b0: 7665 5f66 7261 6d65 2e73 6c69 6365 5f63  ve_frame.slice_c
+000050c0: 6861 6e67 6564 203d 2054 7275 6520 2023  hanged = True  #
+000050d0: 206e 6f74 2072 6561 6c6c 792c 2062 7574   not really, but
+000050e0: 2074 6869 7320 666c 6167 2069 7320 616c   this flag is al
+000050f0: 736f 2075 7365 6420 746f 2074 7269 6767  so used to trigg
+00005100: 6572 2061 206d 6f64 656c 2075 7064 6174  er a model updat
+00005110: 652e 0d0a 2020 2020 2020 2020 2020 2020  e...            
+00005120: 2020 2020 6966 206e 6f74 2061 6e79 5f68      if not any_h
+00005130: 616e 646c 655f 6163 7469 7665 2061 6e64  andle_active and
+00005140: 2069 6d67 7569 2e69 735f 6d6f 7573 655f   imgui.is_mouse_
+00005150: 636c 6963 6b65 6428 3029 3a20 2323 2054  clicked(0): ## T
+00005160: 4f44 4f3a 206f 6e6c 7920 7768 656e 206d  ODO: only when m
+00005170: 6f75 7365 2069 7320 636c 6963 6b65 6420  ouse is clicked 
+00005180: 7769 7468 696e 2052 4f49 210d 0a20 2020  within ROI!..   
+00005190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000051a0: 2073 656c 662e 6372 6f70 5f68 616e 646c   self.crop_handl
+000051b0: 6573 5b30 5d2e 6d6f 7669 6e67 5f65 6e74  es[0].moving_ent
+000051c0: 6972 655f 726f 6920 3d20 5472 7565 0d0a  ire_roi = True..
+000051d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000051e0: 2020 2020 7365 6c66 2e63 726f 705f 6861      self.crop_ha
+000051f0: 6e64 6c65 735b 305d 2e63 6f6e 7665 7274  ndles[0].convert
+00005200: 5f63 726f 705f 726f 695f 746f 5f69 6e74  _crop_roi_to_int
+00005210: 6567 6572 7328 290d 0a20 2020 2020 2020  egers()..       
+00005220: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+00005230: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+00005240: 6f74 2069 6d67 7569 2e69 735f 6d6f 7573  ot imgui.is_mous
+00005250: 655f 646f 776e 2830 293a 0d0a 2020 2020  e_down(0):..    
+00005260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005270: 7365 6c66 2e63 726f 705f 6861 6e64 6c65  self.crop_handle
+00005280: 735b 305d 2e6d 6f76 696e 675f 656e 7469  s[0].moving_enti
+00005290: 7265 5f72 6f69 203d 2046 616c 7365 0d0a  re_roi = False..
+000052a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000052b0: 2020 2020 7365 6c66 2e63 726f 705f 6861      self.crop_ha
+000052c0: 6e64 6c65 735b 305d 2e63 6f6e 7665 7274  ndles[0].convert
+000052d0: 5f63 726f 705f 726f 695f 746f 5f69 6e74  _crop_roi_to_int
+000052e0: 6567 6572 7328 290d 0a20 2020 2020 2020  egers()..       
+000052f0: 2020 2020 2020 2020 2020 2020 2063 6667               cfg
+00005300: 2e73 655f 6163 7469 7665 5f66 7261 6d65  .se_active_frame
+00005310: 2e73 6c69 6365 5f63 6861 6e67 6564 203d  .slice_changed =
+00005320: 2054 7275 6520 2023 206e 6f74 2072 6561   True  # not rea
+00005330: 6c6c 792c 2062 7574 2074 6869 7320 666c  lly, but this fl
+00005340: 6167 2069 7320 616c 736f 2075 7365 6420  ag is also used 
+00005350: 746f 2074 7269 6767 6572 2061 206d 6f64  to trigger a mod
+00005360: 656c 2075 7064 6174 652e 0d0a 2020 2020  el update...    
+00005370: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00005380: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00005390: 2020 2020 2020 2077 6f72 6c64 5f70 6f73         world_pos
+000053a0: 5f6f 6c64 203d 2073 656c 662e 6361 6d65  _old = self.came
+000053b0: 7261 2e63 7572 736f 725f 746f 5f77 6f72  ra.cursor_to_wor
+000053c0: 6c64 5f70 6f73 6974 696f 6e28 7365 6c66  ld_position(self
+000053d0: 2e77 696e 646f 772e 6375 7273 6f72 5f70  .window.cursor_p
+000053e0: 6f73 5f70 7265 7669 6f75 735f 6672 616d  os_previous_fram
+000053f0: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
+00005400: 2020 2020 2020 2020 776f 726c 645f 706f          world_po
+00005410: 7320 3d20 7365 6c66 2e63 616d 6572 612e  s = self.camera.
+00005420: 6375 7273 6f72 5f74 6f5f 776f 726c 645f  cursor_to_world_
+00005430: 706f 7369 7469 6f6e 2873 656c 662e 7769  position(self.wi
+00005440: 6e64 6f77 2e63 7572 736f 725f 706f 7329  ndow.cursor_pos)
+00005450: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00005460: 2020 2020 2020 776f 726c 645f 6465 6c74        world_delt
+00005470: 6120 3d20 6e70 2e61 7272 6179 285b 2d28  a = np.array([-(
+00005480: 776f 726c 645f 706f 735f 6f6c 645b 305d  world_pos_old[0]
+00005490: 202d 2077 6f72 6c64 5f70 6f73 5b30 5d29   - world_pos[0])
+000054a0: 2c20 776f 726c 645f 706f 735f 6f6c 645b  , world_pos_old[
+000054b0: 315d 202d 2077 6f72 6c64 5f70 6f73 5b31  1] - world_pos[1
+000054c0: 5d5d 2920 2f20 6366 672e 7365 5f61 6374  ]]) / cfg.se_act
+000054d0: 6976 655f 6672 616d 652e 7069 7865 6c5f  ive_frame.pixel_
+000054e0: 7369 7a65 0d0a 2020 2020 2020 2020 2020  size..          
+000054f0: 2020 2020 2020 2020 2020 7365 6c66 2e63            self.c
+00005500: 726f 705f 6861 6e64 6c65 735b 305d 2e6d  rop_handles[0].m
+00005510: 6f76 655f 6372 6f70 5f72 6f69 2877 6f72  ove_crop_roi(wor
+00005520: 6c64 5f64 656c 7461 5b30 5d2c 2077 6f72  ld_delta[0], wor
+00005530: 6c64 5f64 656c 7461 5b31 5d29 0d0a 0d0a  ld_delta[1])....
+00005540: 2020 2020 6465 6620 696d 706f 7274 5f64      def import_d
+00005550: 6174 6173 6574 2873 656c 662c 2066 696c  ataset(self, fil
+00005560: 656e 616d 6529 3a0d 0a20 2020 2020 2020  ename):..       
+00005570: 2023 2054 4f44 4f3a 2075 706f 6e20 696d   # TODO: upon im
+00005580: 706f 7274 2c20 6966 2073 634e 6f64 6573  port, if scNodes
+00005590: 2c20 6966 2068 6173 206f 7665 726c 6179  , if has overlay
+000055a0: 2061 6e64 206f 7665 726c 6179 2e63 6c65   and overlay.cle
+000055b0: 6d5f 6672 616d 652e 7061 7468 2066 6f75  m_frame.path fou
+000055c0: 6e64 2069 6e20 616e 7920 434c 454d 4672  nd in any CLEMFr
+000055d0: 616d 6527 7320 7061 7468 2c20 6c69 6e6b  ame's path, link
+000055e0: 2043 4c45 4d46 7261 6d65 2061 6e64 2053   CLEMFrame and S
+000055f0: 4546 7261 6d65 2073 2e74 2e20 6f76 6572  EFrame s.t. over
+00005600: 6c61 7920 6361 6e20 6265 2075 7064 6174  lay can be updat
+00005610: 6564 2e0d 0a20 2020 2020 2020 2053 6567  ed...        Seg
+00005620: 6d65 6e74 6174 696f 6e45 6469 746f 722e  mentationEditor.
+00005630: 5348 4f57 5f42 4f4f 545f 5350 5249 5445  SHOW_BOOT_SPRITE
+00005640: 203d 2046 616c 7365 0d0a 2020 2020 2020   = False..      
+00005650: 2020 7472 793a 0d0a 2020 2020 2020 2020    try:..        
+00005660: 2020 2020 5f2c 2065 7874 203d 206f 732e      _, ext = os.
+00005670: 7061 7468 2e73 706c 6974 6578 7428 6669  path.splitext(fi
+00005680: 6c65 6e61 6d65 290d 0a20 2020 2020 2020  lename)..       
+00005690: 2020 2020 2069 6620 6578 7420 3d3d 2022       if ext == "
+000056a0: 2e6d 7263 223a 0d0a 2020 2020 2020 2020  .mrc":..        
+000056b0: 2020 2020 2020 2020 6366 672e 7365 5f66          cfg.se_f
+000056c0: 7261 6d65 732e 6170 7065 6e64 2853 4546  rames.append(SEF
+000056d0: 7261 6d65 2866 696c 656e 616d 6529 290d  rame(filename)).
+000056e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000056f0: 2053 6567 6d65 6e74 6174 696f 6e45 6469   SegmentationEdi
+00005700: 746f 722e 7365 745f 6163 7469 7665 5f64  tor.set_active_d
+00005710: 6174 6173 6574 2863 6667 2e73 655f 6672  ataset(cfg.se_fr
+00005720: 616d 6573 5b2d 315d 290d 0a20 2020 2020  ames[-1])..     
+00005730: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00005740: 7061 7273 655f 6176 6169 6c61 626c 655f  parse_available_
+00005750: 6665 6174 7572 6573 2829 0d0a 2020 2020  features()..    
+00005760: 2020 2020 2020 2020 656c 6966 2065 7874          elif ext
+00005770: 203d 3d20 6366 672e 6669 6c65 7479 7065   == cfg.filetype
+00005780: 5f73 6567 6d65 6e74 6174 696f 6e3a 0d0a  _segmentation:..
+00005790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000057a0: 7769 7468 206f 7065 6e28 6669 6c65 6e61  with open(filena
+000057b0: 6d65 2c20 2772 6227 2920 6173 2070 6963  me, 'rb') as pic
+000057c0: 6b6c 655f 6669 6c65 3a0d 0a20 2020 2020  kle_file:..     
+000057d0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+000057e0: 6566 7261 6d65 203d 2070 6963 6b6c 652e  eframe = pickle.
+000057f0: 6c6f 6164 2870 6963 6b6c 655f 6669 6c65  load(pickle_file
+00005800: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00005810: 2020 2020 2020 2073 6566 7261 6d65 2e6f         seframe.o
+00005820: 6e5f 6c6f 6164 2829 0d0a 2020 2020 2020  n_load()..      
+00005830: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00005840: 6672 616d 652e 736c 6963 655f 6368 616e  frame.slice_chan
+00005850: 6765 6420 3d20 4661 6c73 650d 0a20 2020  ged = False..   
+00005860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005870: 2063 6667 2e73 655f 6672 616d 6573 2e61   cfg.se_frames.a
+00005880: 7070 656e 6428 7365 6672 616d 6529 0d0a  ppend(seframe)..
+00005890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000058a0: 2020 2020 5365 676d 656e 7461 7469 6f6e      Segmentation
+000058b0: 4564 6974 6f72 2e73 6574 5f61 6374 6976  Editor.set_activ
+000058c0: 655f 6461 7461 7365 7428 6366 672e 7365  e_dataset(cfg.se
+000058d0: 5f66 7261 6d65 735b 2d31 5d29 0d0a 2020  _frames[-1])..  
+000058e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000058f0: 2020 6966 2073 6566 7261 6d65 2e69 6e63    if seframe.inc
+00005900: 6c75 6465 735f 6d61 703a 0d0a 2020 2020  ludes_map:..    
+00005910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005920: 2020 2020 7365 6672 616d 652e 7061 7468      seframe.path
+00005930: 203d 2066 696c 656e 616d 655b 3a2d 6c65   = filename[:-le
+00005940: 6e28 6366 672e 6669 6c65 7479 7065 5f73  n(cfg.filetype_s
+00005950: 6567 6d65 6e74 6174 696f 6e29 5d2b 222e  egmentation)]+".
+00005960: 6d72 6322 2020 2320 2776 6972 7475 616c  mrc"  # 'virtual
+00005970: 2720 6669 6c65 2070 6174 682c 2070 6f69  ' file path, poi
+00005980: 6e74 696e 6720 6174 2074 6865 206c 6f63  nting at the loc
+00005990: 6174 696f 6e20 6f66 2074 6865 202e 7363  ation of the .sc
+000059a0: 6e73 2066 696c 6520 6275 7420 656e 6469  ns file but endi
+000059b0: 6e67 2077 6974 6820 2e6d 7263 2073 2e74  ng with .mrc s.t
+000059c0: 2e20 6d6f 6465 6c20 6f75 7470 7574 2072  . model output r
+000059d0: 6567 6578 2064 6f65 736e 2774 2067 6574  egex doesn't get
+000059e0: 206d 6573 7365 6420 7570 0d0a 2020 2020   messed up..    
+000059f0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00005a00: 2e70 6172 7365 5f61 7661 696c 6162 6c65  .parse_available
+00005a10: 5f66 6561 7475 7265 7328 290d 0a20 2020  _features()..   
+00005a20: 2020 2020 2065 7863 6570 7420 4578 6365       except Exce
+00005a30: 7074 696f 6e20 6173 2065 3a0d 0a20 2020  ption as e:..   
+00005a40: 2020 2020 2020 2020 2063 6667 2e73 6574           cfg.set
+00005a50: 5f65 7272 6f72 2865 2c20 2245 7272 6f72  _error(e, "Error
+00005a60: 2069 6d70 6f72 7469 6e67 2064 6174 6173   importing datas
+00005a70: 6574 2c20 7365 6520 6465 7461 696c 7320  et, see details 
+00005a80: 6265 6c6f 773a 2229 0d0a 0d0a 2020 2020  below:")....    
+00005a90: 4073 7461 7469 636d 6574 686f 640d 0a20  @staticmethod.. 
+00005aa0: 2020 2064 6566 2073 6176 655f 6461 7461     def save_data
+00005ab0: 7365 7428 6469 616c 6f67 3d46 616c 7365  set(dialog=False
+00005ac0: 293a 0d0a 2020 2020 2020 2020 7472 793a  ):..        try:
+00005ad0: 0d0a 2020 2020 2020 2020 2020 2020 6465  ..            de
+00005ae0: 6661 756c 745f 6e61 6d65 203d 2063 6667  fault_name = cfg
+00005af0: 2e73 655f 6163 7469 7665 5f66 7261 6d65  .se_active_frame
+00005b00: 2e70 6174 685b 3a2d 345d 0d0a 2020 2020  .path[:-4]..    
+00005b10: 2020 2020 2020 2020 6966 2064 6961 6c6f          if dialo
+00005b20: 673a 0d0a 2020 2020 2020 2020 2020 2020  g:..            
+00005b30: 2020 2020 6669 6c65 6e61 6d65 203d 2066      filename = f
+00005b40: 696c 6564 6961 6c6f 672e 6173 6b73 6176  iledialog.asksav
+00005b50: 6561 7366 696c 656e 616d 6528 0d0a 2020  easfilename(..  
+00005b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005b70: 2020 6669 6c65 7479 7065 733d 5b28 2273    filetypes=[("s
+00005b80: 634e 6f64 6573 2073 6567 6d65 6e74 6174  cNodes segmentat
+00005b90: 696f 6e22 2c20 6622 7b63 6667 2e66 696c  ion", f"{cfg.fil
+00005ba0: 6574 7970 655f 7365 676d 656e 7461 7469  etype_segmentati
+00005bb0: 6f6e 7d22 295d 2c0d 0a20 2020 2020 2020  on}")],..       
+00005bc0: 2020 2020 2020 2020 2020 2020 2069 6e69               ini
+00005bd0: 7469 616c 6669 6c65 3d64 6566 6175 6c74  tialfile=default
+00005be0: 5f6e 616d 6529 0d0a 2020 2020 2020 2020  _name)..        
+00005bf0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00005c00: 2020 2020 2020 2020 2020 2066 696c 656e             filen
+00005c10: 616d 6520 3d20 6465 6661 756c 745f 6e61  ame = default_na
+00005c20: 6d65 0d0a 2020 2020 2020 2020 2020 2020  me..            
+00005c30: 6966 2066 696c 656e 616d 6520 213d 2027  if filename != '
+00005c40: 273a 0d0a 2020 2020 2020 2020 2020 2020  ':..            
+00005c50: 2020 2020 6966 2066 696c 656e 616d 655b      if filename[
+00005c60: 2d6c 656e 2863 6667 2e66 696c 6574 7970  -len(cfg.filetyp
+00005c70: 655f 7365 676d 656e 7461 7469 6f6e 293a  e_segmentation):
+00005c80: 5d20 213d 2063 6667 2e66 696c 6574 7970  ] != cfg.filetyp
+00005c90: 655f 7365 676d 656e 7461 7469 6f6e 3a0d  e_segmentation:.
+00005ca0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005cb0: 2020 2020 2066 696c 656e 616d 6520 2b3d       filename +=
+00005cc0: 2063 6667 2e66 696c 6574 7970 655f 7365   cfg.filetype_se
+00005cd0: 676d 656e 7461 7469 6f6e 0d0a 2020 2020  gmentation..    
+00005ce0: 2020 2020 2020 2020 2020 2020 7769 7468              with
+00005cf0: 206f 7065 6e28 6669 6c65 6e61 6d65 2c20   open(filename, 
+00005d00: 2777 6227 2920 6173 2070 6963 6b6c 655f  'wb') as pickle_
+00005d10: 6669 6c65 3a0d 0a20 2020 2020 2020 2020  file:..         
+00005d20: 2020 2020 2020 2020 2020 2070 6963 6b6c             pickl
+00005d30: 652e 6475 6d70 2863 6667 2e73 655f 6163  e.dump(cfg.se_ac
+00005d40: 7469 7665 5f66 7261 6d65 2c20 7069 636b  tive_frame, pick
+00005d50: 6c65 5f66 696c 6529 0d0a 0d0a 0d0a 2020  le_file)......  
+00005d60: 2020 2020 2020 6578 6365 7074 2045 7863        except Exc
+00005d70: 6570 7469 6f6e 2061 7320 653a 0d0a 2020  eption as e:..  
+00005d80: 2020 2020 2020 2020 2020 6366 672e 7365            cfg.se
+00005d90: 745f 6572 726f 7228 652c 2022 436f 756c  t_error(e, "Coul
+00005da0: 6420 6e6f 7420 7361 7665 2064 6961 6c6f  d not save dialo
+00005db0: 6720 2d20 7365 6520 6465 7461 696c 7320  g - see details 
+00005dc0: 6265 6c6f 772e 2229 0d0a 0d0a 2020 2020  below.")....    
+00005dd0: 6465 6620 6775 695f 6d61 696e 2873 656c  def gui_main(sel
+00005de0: 6629 3a0d 0a20 2020 2020 2020 2069 6620  f):..        if 
+00005df0: 5472 7565 3a0d 0a20 2020 2020 2020 2020  True:..         
+00005e00: 2020 2069 6d67 7569 2e70 7573 685f 7374     imgui.push_st
+00005e10: 796c 655f 636f 6c6f 7228 696d 6775 692e  yle_color(imgui.
+00005e20: 434f 4c4f 525f 5749 4e44 4f57 5f42 4143  COLOR_WINDOW_BAC
+00005e30: 4b47 524f 554e 442c 202a 6366 672e 434f  KGROUND, *cfg.CO
+00005e40: 4c4f 5552 5f50 414e 454c 5f42 4143 4b47  LOUR_PANEL_BACKG
+00005e50: 524f 554e 4429 0d0a 2020 2020 2020 2020  ROUND)..        
+00005e60: 2020 2020 696d 6775 692e 7075 7368 5f73      imgui.push_s
+00005e70: 7479 6c65 5f63 6f6c 6f72 2869 6d67 7569  tyle_color(imgui
+00005e80: 2e43 4f4c 4f52 5f54 4558 542c 202a 6366  .COLOR_TEXT, *cf
+00005e90: 672e 434f 4c4f 5552 5f54 4558 5429 0d0a  g.COLOUR_TEXT)..
+00005ea0: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
+00005eb0: 692e 7075 7368 5f73 7479 6c65 5f63 6f6c  i.push_style_col
+00005ec0: 6f72 2869 6d67 7569 2e43 4f4c 4f52 5f54  or(imgui.COLOR_T
+00005ed0: 4954 4c45 5f42 4143 4b47 524f 554e 445f  ITLE_BACKGROUND_
+00005ee0: 4143 5449 5645 2c20 2a63 6667 2e43 4f4c  ACTIVE, *cfg.COL
+00005ef0: 4f55 525f 5449 544c 455f 4241 434b 4752  OUR_TITLE_BACKGR
+00005f00: 4f55 4e44 290d 0a20 2020 2020 2020 2020  OUND)..         
+00005f10: 2020 2069 6d67 7569 2e70 7573 685f 7374     imgui.push_st
+00005f20: 796c 655f 636f 6c6f 7228 696d 6775 692e  yle_color(imgui.
+00005f30: 434f 4c4f 525f 5449 544c 455f 4241 434b  COLOR_TITLE_BACK
+00005f40: 4752 4f55 4e44 2c20 2a63 6667 2e43 4f4c  GROUND, *cfg.COL
+00005f50: 4f55 525f 5449 544c 455f 4241 434b 4752  OUR_TITLE_BACKGR
+00005f60: 4f55 4e44 290d 0a20 2020 2020 2020 2020  OUND)..         
+00005f70: 2020 2069 6d67 7569 2e70 7573 685f 7374     imgui.push_st
+00005f80: 796c 655f 636f 6c6f 7228 696d 6775 692e  yle_color(imgui.
+00005f90: 434f 4c4f 525f 5449 544c 455f 4241 434b  COLOR_TITLE_BACK
+00005fa0: 4752 4f55 4e44 5f43 4f4c 4c41 5053 4544  GROUND_COLLAPSED
+00005fb0: 2c20 2a63 6667 2e43 4f4c 4f55 525f 5449  , *cfg.COLOUR_TI
+00005fc0: 544c 455f 4241 434b 4752 4f55 4e44 290d  TLE_BACKGROUND).
+00005fd0: 0a20 2020 2020 2020 2020 2020 2069 6d67  .            img
+00005fe0: 7569 2e70 7573 685f 7374 796c 655f 636f  ui.push_style_co
+00005ff0: 6c6f 7228 696d 6775 692e 434f 4c4f 525f  lor(imgui.COLOR_
+00006000: 4255 5454 4f4e 5f48 4f56 4552 4544 2c20  BUTTON_HOVERED, 
+00006010: 2a63 6667 2e43 4f4c 4f55 525f 5449 544c  *cfg.COLOUR_TITL
+00006020: 455f 4241 434b 4752 4f55 4e44 290d 0a20  E_BACKGROUND).. 
+00006030: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
+00006040: 2e70 7573 685f 7374 796c 655f 636f 6c6f  .push_style_colo
+00006050: 7228 696d 6775 692e 434f 4c4f 525f 4255  r(imgui.COLOR_BU
+00006060: 5454 4f4e 5f41 4354 4956 452c 202a 6366  TTON_ACTIVE, *cf
+00006070: 672e 434f 4c4f 5552 5f54 4954 4c45 5f42  g.COLOUR_TITLE_B
+00006080: 4143 4b47 524f 554e 4429 0d0a 2020 2020  ACKGROUND)..    
+00006090: 2020 2020 2020 2020 696d 6775 692e 7075          imgui.pu
+000060a0: 7368 5f73 7479 6c65 5f63 6f6c 6f72 2869  sh_style_color(i
+000060b0: 6d67 7569 2e43 4f4c 4f52 5f46 5241 4d45  mgui.COLOR_FRAME
+000060c0: 5f42 4143 4b47 524f 554e 442c 202a 6366  _BACKGROUND, *cf
+000060d0: 672e 434f 4c4f 5552 5f46 5241 4d45 5f42  g.COLOUR_FRAME_B
+000060e0: 4143 4b47 524f 554e 4429 0d0a 2020 2020  ACKGROUND)..    
+000060f0: 2020 2020 2020 2020 696d 6775 692e 7075          imgui.pu
+00006100: 7368 5f73 7479 6c65 5f63 6f6c 6f72 2869  sh_style_color(i
+00006110: 6d67 7569 2e43 4f4c 4f52 5f46 5241 4d45  mgui.COLOR_FRAME
+00006120: 5f42 4143 4b47 524f 554e 445f 484f 5645  _BACKGROUND_HOVE
+00006130: 5245 442c 202a 6366 672e 434f 4c4f 5552  RED, *cfg.COLOUR
+00006140: 5f46 5241 4d45 5f42 4143 4b47 524f 554e  _FRAME_BACKGROUN
+00006150: 4429 0d0a 2020 2020 2020 2020 2020 2020  D)..            
+00006160: 696d 6775 692e 7075 7368 5f73 7479 6c65  imgui.push_style
+00006170: 5f63 6f6c 6f72 2869 6d67 7569 2e43 4f4c  _color(imgui.COL
+00006180: 4f52 5f46 5241 4d45 5f42 4143 4b47 524f  OR_FRAME_BACKGRO
+00006190: 554e 445f 4143 5449 5645 2c20 2a63 6667  UND_ACTIVE, *cfg
+000061a0: 2e43 4f4c 4f55 525f 4652 414d 455f 4143  .COLOUR_FRAME_AC
+000061b0: 5449 5645 290d 0a20 2020 2020 2020 2020  TIVE)..         
+000061c0: 2020 2069 6d67 7569 2e70 7573 685f 7374     imgui.push_st
+000061d0: 796c 655f 636f 6c6f 7228 696d 6775 692e  yle_color(imgui.
+000061e0: 434f 4c4f 525f 4255 5454 4f4e 5f41 4354  COLOR_BUTTON_ACT
+000061f0: 4956 452c 202a 6366 672e 434f 4c4f 5552  IVE, *cfg.COLOUR
+00006200: 5f46 5241 4d45 5f41 4354 4956 4529 0d0a  _FRAME_ACTIVE)..
+00006210: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
+00006220: 692e 7075 7368 5f73 7479 6c65 5f63 6f6c  i.push_style_col
+00006230: 6f72 2869 6d67 7569 2e43 4f4c 4f52 5f42  or(imgui.COLOR_B
+00006240: 5554 544f 4e2c 202a 6366 672e 434f 4c4f  UTTON, *cfg.COLO
+00006250: 5552 5f46 5241 4d45 5f42 4143 4b47 524f  UR_FRAME_BACKGRO
+00006260: 554e 4429 0d0a 2020 2020 2020 2020 2020  UND)..          
+00006270: 2020 696d 6775 692e 7075 7368 5f73 7479    imgui.push_sty
+00006280: 6c65 5f63 6f6c 6f72 2869 6d67 7569 2e43  le_color(imgui.C
+00006290: 4f4c 4f52 5f42 5554 544f 4e5f 484f 5645  OLOR_BUTTON_HOVE
+000062a0: 5245 442c 202a 6366 672e 434f 4c4f 5552  RED, *cfg.COLOUR
+000062b0: 5f46 5241 4d45 5f42 4143 4b47 524f 554e  _FRAME_BACKGROUN
+000062c0: 4429 0d0a 2020 2020 2020 2020 2020 2020  D)..            
+000062d0: 696d 6775 692e 7075 7368 5f73 7479 6c65  imgui.push_style
+000062e0: 5f63 6f6c 6f72 2869 6d67 7569 2e43 4f4c  _color(imgui.COL
+000062f0: 4f52 5f53 4c49 4445 525f 4752 4142 2c20  OR_SLIDER_GRAB, 
+00006300: 2a63 6667 2e43 4f4c 4f55 525f 4652 414d  *cfg.COLOUR_FRAM
+00006310: 455f 4558 5452 415f 4441 524b 290d 0a20  E_EXTRA_DARK).. 
+00006320: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
+00006330: 2e70 7573 685f 7374 796c 655f 636f 6c6f  .push_style_colo
+00006340: 7228 696d 6775 692e 434f 4c4f 525f 534c  r(imgui.COLOR_SL
+00006350: 4944 4552 5f47 5241 425f 4143 5449 5645  IDER_GRAB_ACTIVE
+00006360: 2c20 2a63 6667 2e43 4f4c 4f55 525f 4652  , *cfg.COLOUR_FR
+00006370: 414d 455f 4441 524b 290d 0a20 2020 2020  AME_DARK)..     
+00006380: 2020 2020 2020 2069 6d67 7569 2e70 7573         imgui.pus
+00006390: 685f 7374 796c 655f 636f 6c6f 7228 696d  h_style_color(im
+000063a0: 6775 692e 434f 4c4f 525f 504f 5055 505f  gui.COLOR_POPUP_
+000063b0: 4241 434b 4752 4f55 4e44 2c20 2a63 6667  BACKGROUND, *cfg
+000063c0: 2e43 4f4c 4f55 525f 4652 414d 455f 4241  .COLOUR_FRAME_BA
+000063d0: 434b 4752 4f55 4e44 290d 0a20 2020 2020  CKGROUND)..     
+000063e0: 2020 2020 2020 2069 6d67 7569 2e70 7573         imgui.pus
+000063f0: 685f 7374 796c 655f 636f 6c6f 7228 696d  h_style_color(im
+00006400: 6775 692e 434f 4c4f 525f 5343 524f 4c4c  gui.COLOR_SCROLL
+00006410: 4241 525f 4752 4142 2c20 2a63 6667 2e43  BAR_GRAB, *cfg.C
+00006420: 4f4c 4f55 525f 4652 414d 455f 4441 524b  OLOUR_FRAME_DARK
+00006430: 290d 0a20 2020 2020 2020 2020 2020 2069  )..            i
+00006440: 6d67 7569 2e70 7573 685f 7374 796c 655f  mgui.push_style_
+00006450: 636f 6c6f 7228 696d 6775 692e 434f 4c4f  color(imgui.COLO
+00006460: 525f 5343 524f 4c4c 4241 525f 4752 4142  R_SCROLLBAR_GRAB
+00006470: 5f48 4f56 4552 4544 2c20 2a63 6667 2e43  _HOVERED, *cfg.C
+00006480: 4f4c 4f55 525f 4652 414d 455f 4441 524b  OLOUR_FRAME_DARK
+00006490: 290d 0a20 2020 2020 2020 2020 2020 2069  )..            i
+000064a0: 6d67 7569 2e70 7573 685f 7374 796c 655f  mgui.push_style_
+000064b0: 636f 6c6f 7228 696d 6775 692e 434f 4c4f  color(imgui.COLO
+000064c0: 525f 5343 524f 4c4c 4241 525f 4752 4142  R_SCROLLBAR_GRAB
+000064d0: 5f41 4354 4956 452c 202a 6366 672e 434f  _ACTIVE, *cfg.CO
+000064e0: 4c4f 5552 5f46 5241 4d45 5f42 4143 4b47  LOUR_FRAME_BACKG
+000064f0: 524f 554e 4429 0d0a 2020 2020 2020 2020  ROUND)..        
+00006500: 2020 2020 696d 6775 692e 7075 7368 5f73      imgui.push_s
+00006510: 7479 6c65 5f63 6f6c 6f72 2869 6d67 7569  tyle_color(imgui
+00006520: 2e43 4f4c 4f52 5f53 4352 4f4c 4c42 4152  .COLOR_SCROLLBAR
+00006530: 5f42 4143 4b47 524f 554e 442c 202a 6366  _BACKGROUND, *cf
+00006540: 672e 434f 4c4f 5552 5f46 5241 4d45 5f45  g.COLOUR_FRAME_E
+00006550: 5854 5241 5f44 4152 4b29 0d0a 2020 2020  XTRA_DARK)..    
+00006560: 2020 2020 2020 2020 696d 6775 692e 7075          imgui.pu
+00006570: 7368 5f73 7479 6c65 5f63 6f6c 6f72 2869  sh_style_color(i
+00006580: 6d67 7569 2e43 4f4c 4f52 5f50 4c4f 545f  mgui.COLOR_PLOT_
+00006590: 4849 5354 4f47 5241 4d2c 202a 6366 672e  HISTOGRAM, *cfg.
+000065a0: 434f 4c4f 5552 5f54 4558 5429 0d0a 2020  COLOUR_TEXT)..  
+000065b0: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
+000065c0: 7075 7368 5f73 7479 6c65 5f63 6f6c 6f72  push_style_color
+000065d0: 2869 6d67 7569 2e43 4f4c 4f52 5f50 4c4f  (imgui.COLOR_PLO
+000065e0: 545f 4849 5354 4f47 5241 4d5f 484f 5645  T_HISTOGRAM_HOVE
+000065f0: 5245 442c 202a 6366 672e 434f 4c4f 5552  RED, *cfg.COLOUR
+00006600: 5f54 4558 5429 0d0a 2020 2020 2020 2020  _TEXT)..        
+00006610: 2020 2020 696d 6775 692e 7075 7368 5f73      imgui.push_s
+00006620: 7479 6c65 5f63 6f6c 6f72 2869 6d67 7569  tyle_color(imgui
+00006630: 2e43 4f4c 4f52 5f43 4845 434b 5f4d 4152  .COLOR_CHECK_MAR
+00006640: 4b2c 2030 2e30 2c20 302e 302c 2030 2e30  K, 0.0, 0.0, 0.0
+00006650: 2c20 312e 3029 0d0a 2020 2020 2020 2020  , 1.0)..        
+00006660: 2020 2020 696d 6775 692e 7075 7368 5f73      imgui.push_s
+00006670: 7479 6c65 5f63 6f6c 6f72 2869 6d67 7569  tyle_color(imgui
+00006680: 2e43 4f4c 4f52 5f4d 454e 5542 4152 5f42  .COLOR_MENUBAR_B
+00006690: 4143 4b47 524f 554e 442c 202a 6366 672e  ACKGROUND, *cfg.
+000066a0: 434f 4c4f 5552 5f4d 4149 4e5f 4d45 4e55  COLOUR_MAIN_MENU
+000066b0: 5f42 4152 290d 0a20 2020 2020 2020 2020  _BAR)..         
+000066c0: 2020 2069 6d67 7569 2e70 7573 685f 7374     imgui.push_st
+000066d0: 796c 655f 636f 6c6f 7228 696d 6775 692e  yle_color(imgui.
+000066e0: 434f 4c4f 525f 4845 4144 4552 2c20 2a63  COLOR_HEADER, *c
+000066f0: 6667 2e43 4f4c 4f55 525f 4845 4144 4552  fg.COLOUR_HEADER
+00006700: 290d 0a20 2020 2020 2020 2020 2020 2069  )..            i
+00006710: 6d67 7569 2e70 7573 685f 7374 796c 655f  mgui.push_style_
+00006720: 636f 6c6f 7228 696d 6775 692e 434f 4c4f  color(imgui.COLO
+00006730: 525f 4845 4144 4552 5f48 4f56 4552 4544  R_HEADER_HOVERED
+00006740: 2c20 2a63 6667 2e43 4f4c 4f55 525f 4845  , *cfg.COLOUR_HE
+00006750: 4144 4552 5f48 4f56 4552 4544 290d 0a20  ADER_HOVERED).. 
+00006760: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
+00006770: 2e70 7573 685f 7374 796c 655f 636f 6c6f  .push_style_colo
+00006780: 7228 696d 6775 692e 434f 4c4f 525f 4845  r(imgui.COLOR_HE
+00006790: 4144 4552 5f41 4354 4956 452c 202a 6366  ADER_ACTIVE, *cf
+000067a0: 672e 434f 4c4f 5552 5f48 4541 4445 525f  g.COLOUR_HEADER_
+000067b0: 4143 5449 5645 290d 0a20 2020 2020 2020  ACTIVE)..       
+000067c0: 2020 2020 2069 6d67 7569 2e70 7573 685f       imgui.push_
+000067d0: 7374 796c 655f 636f 6c6f 7228 696d 6775  style_color(imgu
+000067e0: 692e 434f 4c4f 525f 5441 422c 202a 6366  i.COLOR_TAB, *cf
+000067f0: 672e 434f 4c4f 5552 5f48 4541 4445 525f  g.COLOUR_HEADER_
+00006800: 4143 5449 5645 290d 0a20 2020 2020 2020  ACTIVE)..       
+00006810: 2020 2020 2069 6d67 7569 2e70 7573 685f       imgui.push_
+00006820: 7374 796c 655f 636f 6c6f 7228 696d 6775  style_color(imgu
+00006830: 692e 434f 4c4f 525f 5441 425f 4143 5449  i.COLOR_TAB_ACTI
+00006840: 5645 2c20 2a63 6667 2e43 4f4c 4f55 525f  VE, *cfg.COLOUR_
+00006850: 4845 4144 4552 290d 0a20 2020 2020 2020  HEADER)..       
+00006860: 2020 2020 2069 6d67 7569 2e70 7573 685f       imgui.push_
+00006870: 7374 796c 655f 636f 6c6f 7228 696d 6775  style_color(imgu
+00006880: 692e 434f 4c4f 525f 5441 425f 484f 5645  i.COLOR_TAB_HOVE
+00006890: 5245 442c 202a 6366 672e 434f 4c4f 5552  RED, *cfg.COLOUR
+000068a0: 5f48 4541 4445 5229 0d0a 2020 2020 2020  _HEADER)..      
+000068b0: 2020 2020 2020 696d 6775 692e 7075 7368        imgui.push
+000068c0: 5f73 7479 6c65 5f63 6f6c 6f72 2869 6d67  _style_color(img
+000068d0: 7569 2e43 4f4c 4f52 5f44 5241 475f 4452  ui.COLOR_DRAG_DR
+000068e0: 4f50 5f54 4152 4745 542c 202a 6366 672e  OP_TARGET, *cfg.
+000068f0: 434f 4c4f 5552 5f44 524f 505f 5441 5247  COLOUR_DROP_TARG
+00006900: 4554 290d 0a20 2020 2020 2020 2020 2020  ET)..           
+00006910: 2069 6d67 7569 2e70 7573 685f 7374 796c   imgui.push_styl
+00006920: 655f 636f 6c6f 7228 696d 6775 692e 434f  e_color(imgui.CO
+00006930: 4c4f 525f 5343 524f 4c4c 4241 525f 4241  LOR_SCROLLBAR_BA
+00006940: 434b 4752 4f55 4e44 2c20 2a63 6667 2e43  CKGROUND, *cfg.C
+00006950: 4f4c 4f55 525f 5749 4e44 4f57 5f42 4143  OLOUR_WINDOW_BAC
+00006960: 4b47 524f 554e 445b 3a33 5d2c 2030 2e30  KGROUND[:3], 0.0
+00006970: 290d 0a20 2020 2020 2020 2020 2020 2069  )..            i
+00006980: 6d67 7569 2e70 7573 685f 7374 796c 655f  mgui.push_style_
+00006990: 7661 7228 696d 6775 692e 5354 594c 455f  var(imgui.STYLE_
+000069a0: 5749 4e44 4f57 5f52 4f55 4e44 494e 472c  WINDOW_ROUNDING,
+000069b0: 2063 6667 2e57 494e 444f 575f 524f 554e   cfg.WINDOW_ROUN
+000069c0: 4449 4e47 290d 0a0d 0a20 2020 2020 2020  DING)....       
+000069d0: 2064 6566 2062 6f6f 745f 7370 7269 7465   def boot_sprite
+000069e0: 2829 3a0d 0a20 2020 2020 2020 2020 2020  ():..           
+000069f0: 2069 6620 5365 676d 656e 7461 7469 6f6e   if Segmentation
+00006a00: 4564 6974 6f72 2e53 484f 575f 424f 4f54  Editor.SHOW_BOOT
+00006a10: 5f53 5052 4954 453a 0d0a 2020 2020 2020  _SPRITE:..      
+00006a20: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
+00006a30: 7075 7368 5f73 7479 6c65 5f63 6f6c 6f72  push_style_color
+00006a40: 2869 6d67 7569 2e43 4f4c 4f52 5f54 4954  (imgui.COLOR_TIT
+00006a50: 4c45 5f42 4143 4b47 524f 554e 442c 202a  LE_BACKGROUND, *
+00006a60: 6366 672e 434f 4c4f 5552 5f57 494e 444f  cfg.COLOUR_WINDO
+00006a70: 575f 4241 434b 4752 4f55 4e44 5b30 3a33  W_BACKGROUND[0:3
+00006a80: 5d2c 2030 2e30 290d 0a20 2020 2020 2020  ], 0.0)..       
+00006a90: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
+00006aa0: 7573 685f 7374 796c 655f 636f 6c6f 7228  ush_style_color(
+00006ab0: 696d 6775 692e 434f 4c4f 525f 5449 544c  imgui.COLOR_TITL
+00006ac0: 455f 4241 434b 4752 4f55 4e44 5f41 4354  E_BACKGROUND_ACT
+00006ad0: 4956 452c 202a 6366 672e 434f 4c4f 5552  IVE, *cfg.COLOUR
+00006ae0: 5f57 494e 444f 575f 4241 434b 4752 4f55  _WINDOW_BACKGROU
+00006af0: 4e44 5b30 3a33 5d2c 2030 2e30 290d 0a20  ND[0:3], 0.0).. 
+00006b00: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00006b10: 6d67 7569 2e70 7573 685f 7374 796c 655f  mgui.push_style_
+00006b20: 636f 6c6f 7228 696d 6775 692e 434f 4c4f  color(imgui.COLO
+00006b30: 525f 5445 5854 2c20 2a28 302e 302c 2030  R_TEXT, *(0.0, 0
+00006b40: 2e30 2c20 302e 302c 2031 2e30 2929 0d0a  .0, 0.0, 1.0))..
+00006b50: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00006b60: 2020 5f77 203d 2073 656c 662e 626f 6f74    _w = self.boot
+00006b70: 5f73 7072 6974 655f 7769 6474 6820 2a20  _sprite_width * 
+00006b80: 302e 3235 0d0a 2020 2020 2020 2020 2020  0.25..          
+00006b90: 2020 2020 2020 5f68 203d 2073 656c 662e        _h = self.
+00006ba0: 626f 6f74 5f73 7072 6974 655f 6865 6967  boot_sprite_heig
+00006bb0: 6874 202a 2030 2e32 350d 0a20 2020 2020  ht * 0.25..     
+00006bc0: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
+00006bd0: 2e73 6574 5f6e 6578 745f 7769 6e64 6f77  .set_next_window
+00006be0: 5f70 6f73 6974 696f 6e28 5365 676d 656e  _position(Segmen
+00006bf0: 7461 7469 6f6e 4564 6974 6f72 2e4d 4149  tationEditor.MAI
+00006c00: 4e5f 5749 4e44 4f57 5f57 4944 5448 202b  N_WINDOW_WIDTH +
+00006c10: 2028 6366 672e 7769 6e64 6f77 5f77 6964   (cfg.window_wid
+00006c20: 7468 202d 2053 6567 6d65 6e74 6174 696f  th - Segmentatio
+00006c30: 6e45 6469 746f 722e 4d41 494e 5f57 494e  nEditor.MAIN_WIN
+00006c40: 444f 575f 5749 4454 4829 202f 2032 2e30  DOW_WIDTH) / 2.0
+00006c50: 202d 2028 5f77 202f 2032 2e30 292c 2028   - (_w / 2.0), (
+00006c60: 6366 672e 7769 6e64 6f77 5f68 6569 6768  cfg.window_heigh
+00006c70: 7420 2d20 5f68 2920 2f20 322e 3020 2d20  t - _h) / 2.0 - 
+00006c80: 3235 290d 0a20 2020 2020 2020 2020 2020  25)..           
+00006c90: 2020 2020 2073 656c 662e 7368 6f77 5f62       self.show_b
+00006ca0: 6f6f 745f 696d 6720 3d20 696d 6775 692e  oot_img = imgui.
+00006cb0: 6265 6769 6e28 2223 2362 6f6f 745f 7370  begin("##boot_sp
+00006cc0: 7269 7465 222c 2054 7275 652c 696d 6775  rite", True,imgu
+00006cd0: 692e 5749 4e44 4f57 5f4e 4f5f 434f 4c4c  i.WINDOW_NO_COLL
+00006ce0: 4150 5345 207c 2069 6d67 7569 2e57 494e  APSE | imgui.WIN
+00006cf0: 444f 575f 4e4f 5f52 4553 495a 4520 7c20  DOW_NO_RESIZE | 
+00006d00: 696d 6775 692e 5749 4e44 4f57 5f4e 4f5f  imgui.WINDOW_NO_
+00006d10: 5245 5349 5a45 207c 2069 6d67 7569 2e57  RESIZE | imgui.W
+00006d20: 494e 444f 575f 414c 5741 5953 5f41 5554  INDOW_ALWAYS_AUT
+00006d30: 4f5f 5245 5349 5a45 207c 2069 6d67 7569  O_RESIZE | imgui
+00006d40: 2e57 494e 444f 575f 4e4f 5f42 4143 4b47  .WINDOW_NO_BACKG
+00006d50: 524f 554e 4420 7c20 696d 6775 692e 5749  ROUND | imgui.WI
+00006d60: 4e44 4f57 5f4e 4f5f 5343 524f 4c4c 4241  NDOW_NO_SCROLLBA
+00006d70: 5229 5b31 5d0d 0a20 2020 2020 2020 2020  R)[1]..         
+00006d80: 2020 2020 2020 2069 6d67 7569 2e69 6d61         imgui.ima
+00006d90: 6765 2873 656c 662e 626f 6f74 5f73 7072  ge(self.boot_spr
+00006da0: 6974 655f 7465 7874 7572 652e 7265 6e64  ite_texture.rend
+00006db0: 6572 6572 5f69 642c 205f 772c 205f 6829  erer_id, _w, _h)
+00006dc0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00006dd0: 2020 696d 6775 692e 7075 7368 5f73 7479    imgui.push_sty
+00006de0: 6c65 5f63 6f6c 6f72 2869 6d67 7569 2e43  le_color(imgui.C
+00006df0: 4f4c 4f52 5f50 4f50 5550 5f42 4143 4b47  OLOR_POPUP_BACKG
+00006e00: 524f 554e 442c 202a 6366 672e 434f 4c4f  ROUND, *cfg.COLO
+00006e10: 5552 5f57 494e 444f 575f 4241 434b 4752  UR_WINDOW_BACKGR
+00006e20: 4f55 4e44 290d 0a20 2020 2020 2020 2020  OUND)..         
+00006e30: 2020 2020 2020 2069 6620 696d 6775 692e         if imgui.
+00006e40: 6265 6769 6e5f 706f 7075 705f 636f 6e74  begin_popup_cont
+00006e50: 6578 745f 7769 6e64 6f77 2829 3a0d 0a20  ext_window():.. 
+00006e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006e70: 2020 2069 6d67 7569 2e74 6578 7428 6622     imgui.text(f"
+00006e80: 5765 6c63 6f6d 6520 746f 207b 6366 672e  Welcome to {cfg.
+00006e90: 6170 705f 6e61 6d65 7d21 2229 0d0a 2020  app_name}!")..  
+00006ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006eb0: 2020 696d 6775 692e 7465 7874 2866 2276    imgui.text(f"v
+00006ec0: 6572 7369 6f6e 207b 6366 672e 7665 7273  ersion {cfg.vers
+00006ed0: 696f 6e7d 5c6e 736f 7572 6365 3a20 6769  ion}\nsource: gi
+00006ee0: 7468 7562 2e63 6f6d 2f62 696f 6e61 6e6f  thub.com/bionano
+00006ef0: 7061 7474 6572 6e69 6e67 2f41 6973 5c6e  patterning/Ais\n
+00006f00: 6d61 6e75 616c 3a20 6169 732d 6372 796f  manual: ais-cryo
+00006f10: 6574 2e72 6561 6474 6865 646f 6373 2e6f  et.readthedocs.o
+00006f20: 7267 2229 0d0a 2020 2020 2020 2020 2020  rg")..          
+00006f30: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
+00006f40: 656e 645f 706f 7075 7028 290d 0a20 2020  end_popup()..   
+00006f50: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00006f60: 7365 6c66 2e77 696e 646f 772e 666f 6375  self.window.focu
+00006f70: 7365 6420 616e 6420 696d 6775 692e 6973  sed and imgui.is
+00006f80: 5f6d 6f75 7365 5f63 6c69 636b 6564 2867  _mouse_clicked(g
+00006f90: 6c66 772e 4d4f 5553 455f 4255 5454 4f4e  lfw.MOUSE_BUTTON
+00006fa0: 5f4c 4546 5429 2061 6e64 206e 6f74 2069  _LEFT) and not i
+00006fb0: 6d67 7569 2e69 735f 7769 6e64 6f77 5f68  mgui.is_window_h
+00006fc0: 6f76 6572 6564 2829 3a0d 0a20 2020 2020  overed():..     
+00006fd0: 2020 2020 2020 2020 2020 2020 2020 2053                 S
+00006fe0: 6567 6d65 6e74 6174 696f 6e45 6469 746f  egmentationEdito
+00006ff0: 722e 5348 4f57 5f42 4f4f 545f 5350 5249  r.SHOW_BOOT_SPRI
+00007000: 5445 203d 2046 616c 7365 0d0a 2020 2020  TE = False..    
+00007010: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
+00007020: 692e 706f 705f 7374 796c 655f 636f 6c6f  i.pop_style_colo
+00007030: 7228 3129 0d0a 2020 2020 2020 2020 2020  r(1)..          
+00007040: 2020 2020 2020 696d 6775 692e 656e 6428        imgui.end(
+00007050: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00007060: 2020 2069 6d67 7569 2e70 6f70 5f73 7479     imgui.pop_sty
+00007070: 6c65 5f63 6f6c 6f72 2833 290d 0a0d 0a20  le_color(3).... 
+00007080: 2020 2020 2020 2064 6566 2073 6861 7265         def share
+00007090: 645f 6775 6928 293a 0d0a 2020 2020 2020  d_gui():..      
+000070a0: 2020 2020 2020 6966 2069 6d67 7569 2e63        if imgui.c
+000070b0: 6f6c 6c61 7073 696e 675f 6865 6164 6572  ollapsing_header
+000070c0: 2822 4461 7461 7365 7473 222c 204e 6f6e  ("Datasets", Non
+000070d0: 652c 2069 6d67 7569 2e54 5245 455f 4e4f  e, imgui.TREE_NO
+000070e0: 4445 5f44 4546 4155 4c54 5f4f 5045 4e29  DE_DEFAULT_OPEN)
+000070f0: 5b30 5d3a 0d0a 2020 2020 2020 2020 2020  [0]:..          
+00007100: 2020 2020 2020 7061 6e65 6c5f 6865 6967        panel_heig
+00007110: 6874 203d 2031 3230 2069 6620 6e6f 7420  ht = 120 if not 
+00007120: 5365 676d 656e 7461 7469 6f6e 4564 6974  SegmentationEdit
+00007130: 6f72 2e44 4154 4153 4554 535f 5749 4e44  or.DATASETS_WIND
+00007140: 4f57 5f45 5850 414e 4445 4420 656c 7365  OW_EXPANDED else
+00007150: 2053 6567 6d65 6e74 6174 696f 6e45 6469   SegmentationEdi
+00007160: 746f 722e 4441 5441 5345 5453 5f57 494e  tor.DATASETS_WIN
+00007170: 444f 575f 4558 5041 4e44 4544 5f48 4549  DOW_EXPANDED_HEI
+00007180: 4748 540d 0a20 2020 2020 2020 2020 2020  GHT..           
+00007190: 2020 2020 2069 6d67 7569 2e62 6567 696e       imgui.begin
+000071a0: 5f63 6869 6c64 2822 6176 6169 6c61 626c  _child("availabl
+000071b0: 655f 6461 7461 7365 7473 222c 2030 2e30  e_datasets", 0.0
+000071c0: 2c20 7061 6e65 6c5f 6865 6967 6874 2c20  , panel_height, 
+000071d0: 5472 7565 2c20 696d 6775 692e 5749 4e44  True, imgui.WIND
+000071e0: 4f57 5f41 4c57 4159 535f 5645 5254 4943  OW_ALWAYS_VERTIC
+000071f0: 414c 5f53 4352 4f4c 4c42 4152 290d 0a20  AL_SCROLLBAR).. 
+00007200: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00007210: 6f72 2073 2069 6e20 6366 672e 7365 5f66  or s in cfg.se_f
+00007220: 7261 6d65 733a 0d0a 2020 2020 2020 2020  rames:..        
+00007230: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
+00007240: 692e 7075 7368 5f69 6428 6622 7365 7b73  i.push_id(f"se{s
+00007250: 2e75 6964 7d22 290d 0a0d 0a20 2020 2020  .uid}")....     
+00007260: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+00007270: 6173 655f 7469 746c 6520 3d20 732e 7469  ase_title = s.ti
+00007280: 746c 652e 7370 6c69 7428 222e 2229 5b30  tle.split(".")[0
+00007290: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
+000072a0: 2020 2020 2020 205f 6368 616e 6765 2c20         _change, 
+000072b0: 5f73 656c 6563 7465 6420 3d20 696d 6775  _selected = imgu
+000072c0: 692e 7365 6c65 6374 6162 6c65 2862 6173  i.selectable(bas
+000072d0: 655f 7469 746c 655b 2d31 373a 5d20 2b20  e_title[-17:] + 
+000072e0: 6622 202d 207b 732e 7069 7865 6c5f 7369  f" - {s.pixel_si
+000072f0: 7a65 202a 2031 302e 303a 2e32 667d 2041  ze * 10.0:.2f} A
+00007300: 2f70 6978 2022 2c20 6366 672e 7365 5f61  /pix ", cfg.se_a
+00007310: 6374 6976 655f 6672 616d 6520 3d3d 2073  ctive_frame == s
+00007320: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00007330: 2020 2020 2020 2069 6620 696d 6775 692e         if imgui.
+00007340: 6265 6769 6e5f 706f 7075 705f 636f 6e74  begin_popup_cont
+00007350: 6578 745f 6974 656d 2822 2323 6461 7461  ext_item("##data
+00007360: 7365 7443 6f6e 7465 7874 2229 3a0d 0a20  setContext"):.. 
+00007370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007380: 2020 2020 2020 2069 6620 696d 6775 692e         if imgui.
+00007390: 6d65 6e75 5f69 7465 6d28 2255 6e6c 696e  menu_item("Unlin
+000073a0: 6b20 6461 7461 7365 7422 295b 305d 3a0d  k dataset")[0]:.
+000073b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000073c0: 2020 2020 2020 2020 2020 2020 2053 6567               Seg
+000073d0: 6d65 6e74 6174 696f 6e45 6469 746f 722e  mentationEditor.
+000073e0: 7069 636b 5f74 6162 5f69 6e64 6578 5f64  pick_tab_index_d
+000073f0: 6174 6173 6574 735f 7365 6773 203d 2054  atasets_segs = T
+00007400: 7275 650d 0a20 2020 2020 2020 2020 2020  rue..           
+00007410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007420: 2063 6667 2e73 655f 6672 616d 6573 2e72   cfg.se_frames.r
+00007430: 656d 6f76 6528 7329 0d0a 2020 2020 2020  emove(s)..      
+00007440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007450: 2020 2020 2020 6966 2063 6667 2e73 655f        if cfg.se_
+00007460: 6163 7469 7665 5f66 7261 6d65 203d 3d20  active_frame == 
+00007470: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
+00007480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007490: 2020 2020 6366 672e 7365 5f61 6374 6976      cfg.se_activ
+000074a0: 655f 6672 616d 6520 3d20 4e6f 6e65 0d0a  e_frame = None..
 000074b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000074c0: 2020 7365 6c66 2e70 6172 7365 5f61 7661    self.parse_ava
-000074d0: 696c 6162 6c65 5f66 6561 7475 7265 7328  ilable_features(
-000074e0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-000074f0: 2020 2020 2020 2020 2020 2069 6620 696d             if im
-00007500: 6775 692e 6d65 6e75 5f69 7465 6d28 2252  gui.menu_item("R
-00007510: 656c 696e 6b20 6461 7461 7365 7422 295b  elink dataset")[
-00007520: 305d 3a0d 0a20 2020 2020 2020 2020 2020  0]:..           
+000074c0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000074d0: 2e70 6172 7365 5f61 7661 696c 6162 6c65  .parse_available
+000074e0: 5f66 6561 7475 7265 7328 290d 0a20 2020  _features()..   
+000074f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007500: 2020 2020 2069 6620 696d 6775 692e 6d65       if imgui.me
+00007510: 6e75 5f69 7465 6d28 2252 656c 696e 6b20  nu_item("Relink 
+00007520: 6461 7461 7365 7422 295b 305d 3a0d 0a20  dataset")[0]:.. 
 00007530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007540: 2073 656c 6563 7465 645f 6669 6c65 203d   selected_file =
-00007550: 2066 696c 6564 6961 6c6f 672e 6173 6b6f   filedialog.asko
-00007560: 7065 6e66 696c 656e 616d 6528 6669 6c65  penfilename(file
-00007570: 7479 7065 733d 5b28 226d 7263 6669 6c65  types=[("mrcfile
-00007580: 222c 2022 2e6d 7263 2229 5d29 0d0a 2020  ", ".mrc")])..  
-00007590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000075a0: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-000075b0: 6563 7465 645f 6669 6c65 2021 3d20 2222  ected_file != ""
-000075c0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00007540: 2020 2020 2020 2020 2020 2073 656c 6563             selec
+00007550: 7465 645f 6669 6c65 203d 2066 696c 6564  ted_file = filed
+00007560: 6961 6c6f 672e 6173 6b6f 7065 6e66 696c  ialog.askopenfil
+00007570: 656e 616d 6528 6669 6c65 7479 7065 733d  ename(filetypes=
+00007580: 5b28 226d 7263 6669 6c65 222c 2022 2e6d  [("mrcfile", ".m
+00007590: 7263 2229 5d29 0d0a 2020 2020 2020 2020  rc")])..        
+000075a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000075b0: 2020 2020 6966 2073 656c 6563 7465 645f      if selected_
+000075c0: 6669 6c65 2021 3d20 2222 3a0d 0a20 2020  file != "":..   
 000075d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000075e0: 2020 2073 2e70 6174 6820 3d20 7365 6c65     s.path = sele
-000075f0: 6374 6564 5f66 696c 650d 0a20 2020 2020  cted_file..     
-00007600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007610: 2020 2020 2020 2020 2020 2073 2e74 6974             s.tit
-00007620: 6c65 203d 206f 732e 7061 7468 2e73 706c  le = os.path.spl
-00007630: 6974 6578 7428 6f73 2e70 6174 682e 6261  itext(os.path.ba
-00007640: 7365 6e61 6d65 2873 2e70 6174 6829 295b  sename(s.path))[
-00007650: 305d 0d0a 2020 2020 2020 2020 2020 2020  0]..            
-00007660: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-00007670: 6d67 7569 2e6d 656e 755f 6974 656d 2822  mgui.menu_item("
-00007680: 436f 7079 2070 6174 6820 746f 202e 6d72  Copy path to .mr
-00007690: 6322 295b 305d 3a0d 0a20 2020 2020 2020  c")[0]:..       
-000076a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000076b0: 2020 2020 2070 7970 6572 636c 6970 2e63       pyperclip.c
-000076c0: 6f70 7928 732e 7061 7468 290d 0a20 2020  opy(s.path)..   
-000076d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000076e0: 2020 2020 2069 6620 732e 6f76 6572 6c61       if s.overla
-000076f0: 7920 6973 206e 6f74 204e 6f6e 6520 616e  y is not None an
-00007700: 6420 732e 6f76 6572 6c61 792e 7570 6461  d s.overlay.upda
-00007710: 7465 5f66 756e 6374 696f 6e20 6973 206e  te_function is n
-00007720: 6f74 204e 6f6e 6520 616e 6420 696d 6775  ot None and imgu
-00007730: 692e 6d65 6e75 5f69 7465 6d28 2255 7064  i.menu_item("Upd
-00007740: 6174 6520 6f76 6572 6c61 7922 295b 305d  ate overlay")[0]
-00007750: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00007760: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00007770: 2e6f 7665 726c 6179 2e75 7064 6174 6528  .overlay.update(
-00007780: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00007790: 2020 2020 2020 2020 2020 2069 6620 696d             if im
-000077a0: 6775 692e 6265 6769 6e5f 6d65 6e75 2822  gui.begin_menu("
-000077b0: 4765 6e65 7261 7465 2062 696e 6e65 6420  Generate binned 
-000077c0: 7665 7273 696f 6e22 293a 0d0a 2020 2020  version"):..    
-000077d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000077e0: 2020 2020 2020 2020 7061 7468 203d 2073          path = s
-000077f0: 2e70 6174 680d 0a20 2020 2020 2020 2020  .path..         
-00007800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007810: 2020 2066 6f72 2069 2069 6e20 5b32 2c20     for i in [2, 
-00007820: 332c 2034 2c20 385d 3a0d 0a20 2020 2020  3, 4, 8]:..     
-00007830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007840: 2020 2020 2020 2020 2020 2069 6620 696d             if im
-00007850: 6775 692e 6d65 6e75 5f69 7465 6d28 6622  gui.menu_item(f"
-00007860: 6269 6e20 7b69 7d22 295b 305d 3a0d 0a20  bin {i}")[0]:.. 
-00007870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000075e0: 2020 2020 2020 2020 2020 2020 2073 2e70               s.p
+000075f0: 6174 6820 3d20 7365 6c65 6374 6564 5f66  ath = selected_f
+00007600: 696c 650d 0a20 2020 2020 2020 2020 2020  ile..           
+00007610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007620: 2020 2020 2073 2e74 6974 6c65 203d 206f       s.title = o
+00007630: 732e 7061 7468 2e73 706c 6974 6578 7428  s.path.splitext(
+00007640: 6f73 2e70 6174 682e 6261 7365 6e61 6d65  os.path.basename
+00007650: 2873 2e70 6174 6829 295b 305d 0d0a 2020  (s.path))[0]..  
+00007660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007670: 2020 2020 2020 6966 2069 6d67 7569 2e6d        if imgui.m
+00007680: 656e 755f 6974 656d 2822 436f 7079 2070  enu_item("Copy p
+00007690: 6174 6820 746f 202e 6d72 6322 295b 305d  ath to .mrc")[0]
+000076a0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000076b0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+000076c0: 7970 6572 636c 6970 2e63 6f70 7928 732e  yperclip.copy(s.
+000076d0: 7061 7468 290d 0a20 2020 2020 2020 2020  path)..         
+000076e0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000076f0: 6620 732e 6f76 6572 6c61 7920 6973 206e  f s.overlay is n
+00007700: 6f74 204e 6f6e 6520 616e 6420 732e 6f76  ot None and s.ov
+00007710: 6572 6c61 792e 7570 6461 7465 5f66 756e  erlay.update_fun
+00007720: 6374 696f 6e20 6973 206e 6f74 204e 6f6e  ction is not Non
+00007730: 6520 616e 6420 696d 6775 692e 6d65 6e75  e and imgui.menu
+00007740: 5f69 7465 6d28 2255 7064 6174 6520 6f76  _item("Update ov
+00007750: 6572 6c61 7922 295b 305d 3a0d 0a20 2020  erlay")[0]:..   
+00007760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007770: 2020 2020 2020 2020 2073 2e6f 7665 726c           s.overl
+00007780: 6179 2e75 7064 6174 6528 290d 0a20 2020  ay.update()..   
+00007790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000077a0: 2020 2020 2069 6620 696d 6775 692e 6265       if imgui.be
+000077b0: 6769 6e5f 6d65 6e75 2822 4765 6e65 7261  gin_menu("Genera
+000077c0: 7465 2062 696e 6e65 6420 7665 7273 696f  te binned versio
+000077d0: 6e22 293a 0d0a 2020 2020 2020 2020 2020  n"):..          
+000077e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000077f0: 2020 7061 7468 203d 2073 2e70 6174 680d    path = s.path.
+00007800: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00007810: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00007820: 2069 2069 6e20 5b32 2c20 332c 2034 2c20   i in [2, 3, 4, 
+00007830: 385d 3a0d 0a20 2020 2020 2020 2020 2020  8]:..           
+00007840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007850: 2020 2020 2069 6620 696d 6775 692e 6d65       if imgui.me
+00007860: 6e75 5f69 7465 6d28 6622 6269 6e20 7b69  nu_item(f"bin {i
+00007870: 7d22 295b 305d 3a0d 0a20 2020 2020 2020  }")[0]:..       
 00007880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007890: 2020 2062 7061 7468 203d 2062 696e 5f6d     bpath = bin_m
-000078a0: 7263 2870 6174 682c 2069 290d 0a20 2020  rc(path, i)..   
-000078b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007890: 2020 2020 2020 2020 2020 2020 2062 7061               bpa
+000078a0: 7468 203d 2062 696e 5f6d 7263 2870 6174  th = bin_mrc(pat
+000078b0: 682c 2069 290d 0a20 2020 2020 2020 2020  h, i)..         
 000078c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000078d0: 2073 656c 662e 696d 706f 7274 5f64 6174   self.import_dat
-000078e0: 6173 6574 2862 7061 7468 290d 0a20 2020  aset(bpath)..   
-000078f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007900: 2020 2020 2020 2020 2069 6d67 7569 2e65           imgui.e
-00007910: 6e64 5f6d 656e 7528 290d 0a20 2020 2020  nd_menu()..     
-00007920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007930: 2020 2069 6620 696d 6775 692e 6265 6769     if imgui.begi
-00007940: 6e5f 6d65 6e75 2822 4f76 6572 7275 6c65  n_menu("Overrule
-00007950: 2070 6978 656c 2073 697a 6522 293a 0d0a   pixel size"):..
-00007960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007970: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
-00007980: 692e 7365 745f 6e65 7874 5f69 7465 6d5f  i.set_next_item_
-00007990: 7769 6474 6828 3130 3029 0d0a 2020 2020  width(100)..    
-000079a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000079b0: 2020 2020 2020 2020 7078 735f 616e 6720          pxs_ang 
-000079c0: 3d20 732e 7069 7865 6c5f 7369 7a65 202a  = s.pixel_size *
-000079d0: 2031 302e 300d 0a20 2020 2020 2020 2020   10.0..         
-000079e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000079f0: 2020 205f 2c20 7078 735f 616e 6720 3d20     _, pxs_ang = 
-00007a00: 696d 6775 692e 696e 7075 745f 666c 6f61  imgui.input_floa
-00007a10: 7428 2223 2341 7070 6978 222c 2073 2e70  t("##Appix", s.p
-00007a20: 6978 656c 5f73 697a 652c 2030 2e30 2c20  ixel_size, 0.0, 
-00007a30: 3030 2e30 2c20 666f 726d 6174 203d 2066  00.0, format = f
-00007a40: 227b 7078 735f 616e 673a 2e32 667d 2041  "{pxs_ang:.2f} A
-00007a50: 2f70 6978 656c 2229 0d0a 2020 2020 2020  /pixel")..      
-00007a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007a70: 2020 2020 2020 6966 205f 3a0d 0a20 2020        if _:..   
-00007a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007a90: 2020 2020 2020 2020 2020 2020 2073 2e70               s.p
-00007aa0: 6978 656c 5f73 697a 6520 3d20 7078 735f  ixel_size = pxs_
-00007ab0: 616e 6720 2f20 3130 2e30 0d0a 2020 2020  ang / 10.0..    
-00007ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007ad0: 2020 2020 2020 2020 696d 6775 692e 656e          imgui.en
-00007ae0: 645f 6d65 6e75 2829 0d0a 2020 2020 2020  d_menu()..      
-00007af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007b00: 2020 696d 6775 692e 656e 645f 706f 7075    imgui.end_popu
-00007b10: 7028 290d 0a20 2020 2020 2020 2020 2020  p()..           
-00007b20: 2020 2020 2020 2020 2073 656c 662e 746f           self.to
-00007b30: 6f6c 7469 7028 6622 7b73 2e74 6974 6c65  oltip(f"{s.title
-00007b40: 7d5c 6e50 6978 656c 2073 697a 653a 207b  }\nPixel size: {
-00007b50: 732e 7069 7865 6c5f 7369 7a65 202a 2031  s.pixel_size * 1
-00007b60: 302e 303a 2e34 667d 2041 6e67 7374 726f  0.0:.4f} Angstro
-00007b70: 6d5c 6e4c 6f63 6174 696f 6e3a 207b 732e  m\nLocation: {s.
-00007b80: 7061 7468 7d22 290d 0a20 2020 2020 2020  path}")..       
-00007b90: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00007ba0: 5f63 6861 6e67 6520 616e 6420 5f73 656c  _change and _sel
-00007bb0: 6563 7465 643a 0d0a 2020 2020 2020 2020  ected:..        
-00007bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007bd0: 5365 676d 656e 7461 7469 6f6e 4564 6974  SegmentationEdit
-00007be0: 6f72 2e73 6574 5f61 6374 6976 655f 6461  or.set_active_da
-00007bf0: 7461 7365 7428 7329 0d0a 2020 2020 2020  taset(s)..      
-00007c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007c10: 2020 666f 7220 6d6f 6465 6c20 696e 2063    for model in c
-00007c20: 6667 2e73 655f 6d6f 6465 6c73 3a0d 0a20  fg.se_models:.. 
-00007c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007c40: 2020 2020 2020 2020 2020 206d 6f64 656c             model
-00007c50: 2e72 6573 6574 5f74 6578 7475 7265 7328  .reset_textures(
-00007c60: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00007c70: 2020 2020 2020 2020 2020 2053 6567 6d65             Segme
-00007c80: 6e74 6174 696f 6e45 6469 746f 722e 7472  ntationEditor.tr
-00007c90: 6169 6e73 6574 5f61 7069 7820 3d20 732e  ainset_apix = s.
-00007ca0: 7069 7865 6c5f 7369 7a65 202a 2031 302e  pixel_size * 10.
-00007cb0: 300d 0a0d 0a20 2020 2020 2020 2020 2020  0....           
-00007cc0: 2020 2020 2020 2020 2066 6f72 2066 2069           for f i
-00007cd0: 6e20 732e 6665 6174 7572 6573 3a0d 0a20  n s.features:.. 
-00007ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007cf0: 2020 2020 2020 2069 6d67 7569 2e73 616d         imgui.sam
-00007d00: 655f 6c69 6e65 2873 7061 6369 6e67 3d31  e_line(spacing=1
-00007d10: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00007d20: 2020 2020 2020 2020 2020 2069 6620 696d             if im
-00007d30: 6775 692e 636f 6c6f 725f 6275 7474 6f6e  gui.color_button
-00007d40: 2866 2223 237b 662e 7569 647d 222c 2066  (f"##{f.uid}", f
-00007d50: 2e63 6f6c 6f75 725b 305d 2c20 662e 636f  .colour[0], f.co
-00007d60: 6c6f 7572 5b31 5d2c 2066 2e63 6f6c 6f75  lour[1], f.colou
-00007d70: 725b 325d 2c20 312c 2069 6d67 7569 2e43  r[2], 1, imgui.C
-00007d80: 4f4c 4f52 5f45 4449 545f 4e4f 5f54 4f4f  OLOR_EDIT_NO_TOO
-00007d90: 4c54 4950 2c20 362c 2031 3329 3a0d 0a20  LTIP, 6, 13):.. 
-00007da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007db0: 2020 2020 2020 2020 2020 2073 2e61 6374             s.act
-00007dc0: 6976 655f 6665 6174 7572 6520 3d20 660d  ive_feature = f.
-00007dd0: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
-00007de0: 2020 2020 2020 2069 6d67 7569 2e70 6f70         imgui.pop
-00007df0: 5f69 6428 290d 0a20 2020 2020 2020 2020  _id()..         
-00007e00: 2020 2020 2020 2069 6d67 7569 2e65 6e64         imgui.end
-00007e10: 5f63 6869 6c64 2829 0d0a 2020 2020 2020  _child()..      
-00007e20: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
-00007e30: 7075 7368 5f73 7479 6c65 5f76 6172 2869  push_style_var(i
-00007e40: 6d67 7569 2e53 5459 4c45 5f46 5241 4d45  mgui.STYLE_FRAME
-00007e50: 5f52 4f55 4e44 494e 472c 2031 3029 0d0a  _ROUNDING, 10)..
-00007e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007e70: 696d 6775 692e 7075 7368 5f73 7479 6c65  imgui.push_style
-00007e80: 5f76 6172 2869 6d67 7569 2e53 5459 4c45  _var(imgui.STYLE
-00007e90: 5f46 5241 4d45 5f50 4144 4449 4e47 2c20  _FRAME_PADDING, 
-00007ea0: 2830 2c20 3029 290d 0a20 2020 2020 2020  (0, 0))..       
-00007eb0: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
-00007ec0: 7573 685f 7374 796c 655f 7661 7228 696d  ush_style_var(im
-00007ed0: 6775 692e 5354 594c 455f 4652 414d 455f  gui.STYLE_FRAME_
-00007ee0: 424f 5244 4552 5349 5a45 2c20 3129 0d0a  BORDERSIZE, 1)..
-00007ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007f00: 696d 6775 692e 7075 7368 5f73 7479 6c65  imgui.push_style
-00007f10: 5f63 6f6c 6f72 2869 6d67 7569 2e43 4f4c  _color(imgui.COL
-00007f20: 4f52 5f43 4845 434b 5f4d 4152 4b2c 2030  OR_CHECK_MARK, 0
-00007f30: 2e30 2c20 302e 302c 2030 2e30 2c20 312e  .0, 0.0, 0.0, 1.
-00007f40: 3029 0d0a 2020 2020 2020 2020 2020 2020  0)..            
-00007f50: 2020 2020 5f2c 2053 6567 6d65 6e74 6174      _, Segmentat
-00007f60: 696f 6e45 6469 746f 722e 4441 5441 5345  ionEditor.DATASE
-00007f70: 5453 5f57 494e 444f 575f 4558 5041 4e44  TS_WINDOW_EXPAND
-00007f80: 4544 203d 2069 6d67 7569 2e63 6865 636b  ED = imgui.check
-00007f90: 626f 7828 2265 7870 616e 6422 2c20 5365  box("expand", Se
-00007fa0: 676d 656e 7461 7469 6f6e 4564 6974 6f72  gmentationEditor
-00007fb0: 2e44 4154 4153 4554 535f 5749 4e44 4f57  .DATASETS_WINDOW
-00007fc0: 5f45 5850 414e 4445 4429 0d0a 2020 2020  _EXPANDED)..    
-00007fd0: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
-00007fe0: 692e 706f 705f 7374 796c 655f 7661 7228  i.pop_style_var(
-00007ff0: 3329 0d0a 2020 2020 2020 2020 2020 2020  3)..            
-00008000: 2020 2020 696d 6775 692e 706f 705f 7374      imgui.pop_st
-00008010: 796c 655f 636f 6c6f 7228 3129 0d0a 2020  yle_color(1)..  
-00008020: 2020 2020 2020 2020 2020 6966 2069 6d67            if img
-00008030: 7569 2e63 6f6c 6c61 7073 696e 675f 6865  ui.collapsing_he
-00008040: 6164 6572 2822 4669 6c74 6572 7322 2c20  ader("Filters", 
-00008050: 4e6f 6e65 2c20 696d 6775 692e 5452 4545  None, imgui.TREE
-00008060: 5f4e 4f44 455f 4445 4641 554c 545f 4f50  _NODE_DEFAULT_OP
-00008070: 454e 295b 305d 3a0d 0a20 2020 2020 2020  EN)[0]:..       
-00008080: 2020 2020 2020 2020 2073 6566 203d 2063           sef = c
-00008090: 6667 2e73 655f 6163 7469 7665 5f66 7261  fg.se_active_fra
-000080a0: 6d65 0d0a 2020 2020 2020 2020 2020 2020  me..            
-000080b0: 2020 2020 6966 2073 6566 2069 7320 6e6f      if sef is no
-000080c0: 7420 4e6f 6e65 3a0d 0a20 2020 2020 2020  t None:..       
-000080d0: 2020 2020 2020 2020 2020 2020 205f 6377               _cw
-000080e0: 203d 2069 6d67 7569 2e67 6574 5f63 6f6e   = imgui.get_con
-000080f0: 7465 6e74 5f72 6567 696f 6e5f 6176 6169  tent_region_avai
-00008100: 6c61 626c 655f 7769 6474 6828 290d 0a20  lable_width().. 
-00008110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008120: 2020 2069 6d67 7569 2e70 6c6f 745f 6869     imgui.plot_hi
-00008130: 7374 6f67 7261 6d28 2223 2368 6973 7422  stogram("##hist"
-00008140: 2c20 7365 662e 6869 7374 5f76 616c 732c  , sef.hist_vals,
-00008150: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000078d0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000078e0: 696d 706f 7274 5f64 6174 6173 6574 2862  import_dataset(b
+000078f0: 7061 7468 290d 0a20 2020 2020 2020 2020  path)..         
+00007900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007910: 2020 2069 6d67 7569 2e65 6e64 5f6d 656e     imgui.end_men
+00007920: 7528 290d 0a20 2020 2020 2020 2020 2020  u()..           
+00007930: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00007940: 696d 6775 692e 6265 6769 6e5f 6d65 6e75  imgui.begin_menu
+00007950: 2822 4f76 6572 7275 6c65 2070 6978 656c  ("Overrule pixel
+00007960: 2073 697a 6522 293a 0d0a 2020 2020 2020   size"):..      
+00007970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007980: 2020 2020 2020 696d 6775 692e 7365 745f        imgui.set_
+00007990: 6e65 7874 5f69 7465 6d5f 7769 6474 6828  next_item_width(
+000079a0: 3130 3029 0d0a 2020 2020 2020 2020 2020  100)..          
+000079b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000079c0: 2020 7078 735f 616e 6720 3d20 732e 7069    pxs_ang = s.pi
+000079d0: 7865 6c5f 7369 7a65 202a 2031 302e 300d  xel_size * 10.0.
+000079e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000079f0: 2020 2020 2020 2020 2020 2020 205f 2c20               _, 
+00007a00: 7078 735f 616e 6720 3d20 696d 6775 692e  pxs_ang = imgui.
+00007a10: 696e 7075 745f 666c 6f61 7428 2223 2341  input_float("##A
+00007a20: 7070 6978 222c 2073 2e70 6978 656c 5f73  ppix", s.pixel_s
+00007a30: 697a 652c 2030 2e30 2c20 3030 2e30 2c20  ize, 0.0, 00.0, 
+00007a40: 666f 726d 6174 203d 2066 227b 7078 735f  format = f"{pxs_
+00007a50: 616e 673a 2e32 667d 2041 2f70 6978 656c  ang:.2f} A/pixel
+00007a60: 2229 0d0a 2020 2020 2020 2020 2020 2020  ")..            
+00007a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007a80: 6966 205f 3a0d 0a20 2020 2020 2020 2020  if _:..         
+00007a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007aa0: 2020 2020 2020 2073 2e70 6978 656c 5f73         s.pixel_s
+00007ab0: 697a 6520 3d20 7078 735f 616e 6720 2f20  ize = pxs_ang / 
+00007ac0: 3130 2e30 0d0a 2020 2020 2020 2020 2020  10.0..          
+00007ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007ae0: 2020 696d 6775 692e 656e 645f 6d65 6e75    imgui.end_menu
+00007af0: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
+00007b00: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
+00007b10: 692e 656e 645f 706f 7075 7028 290d 0a20  i.end_popup().. 
+00007b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007b30: 2020 2073 656c 662e 746f 6f6c 7469 7028     self.tooltip(
+00007b40: 6622 7b73 2e74 6974 6c65 7d5c 6e50 6978  f"{s.title}\nPix
+00007b50: 656c 2073 697a 653a 207b 732e 7069 7865  el size: {s.pixe
+00007b60: 6c5f 7369 7a65 202a 2031 302e 303a 2e34  l_size * 10.0:.4
+00007b70: 667d 2041 6e67 7374 726f 6d5c 6e4c 6f63  f} Angstrom\nLoc
+00007b80: 6174 696f 6e3a 207b 732e 7061 7468 7d22  ation: {s.path}"
+00007b90: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00007ba0: 2020 2020 2020 2069 6620 5f63 6861 6e67         if _chang
+00007bb0: 6520 616e 6420 5f73 656c 6563 7465 643a  e and _selected:
+00007bc0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00007bd0: 2020 2020 2020 2020 2020 5365 676d 656e            Segmen
+00007be0: 7461 7469 6f6e 4564 6974 6f72 2e73 6574  tationEditor.set
+00007bf0: 5f61 6374 6976 655f 6461 7461 7365 7428  _active_dataset(
+00007c00: 7329 0d0a 2020 2020 2020 2020 2020 2020  s)..            
+00007c10: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00007c20: 6d6f 6465 6c20 696e 2063 6667 2e73 655f  model in cfg.se_
+00007c30: 6d6f 6465 6c73 3a0d 0a20 2020 2020 2020  models:..       
+00007c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007c50: 2020 2020 206d 6f64 656c 2e72 6573 6574       model.reset
+00007c60: 5f74 6578 7475 7265 7328 290d 0a20 2020  _textures()..   
+00007c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007c80: 2020 2020 2053 6567 6d65 6e74 6174 696f       Segmentatio
+00007c90: 6e45 6469 746f 722e 7472 6169 6e73 6574  nEditor.trainset
+00007ca0: 5f61 7069 7820 3d20 732e 7069 7865 6c5f  _apix = s.pixel_
+00007cb0: 7369 7a65 202a 2031 302e 300d 0a0d 0a20  size * 10.0.... 
+00007cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007cd0: 2020 2066 6f72 2066 2069 6e20 732e 6665     for f in s.fe
+00007ce0: 6174 7572 6573 3a0d 0a20 2020 2020 2020  atures:..       
+00007cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007d00: 2069 6d67 7569 2e73 616d 655f 6c69 6e65   imgui.same_line
+00007d10: 2873 7061 6369 6e67 3d31 290d 0a20 2020  (spacing=1)..   
+00007d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007d30: 2020 2020 2069 6620 696d 6775 692e 636f       if imgui.co
+00007d40: 6c6f 725f 6275 7474 6f6e 2866 2223 237b  lor_button(f"##{
+00007d50: 662e 7569 647d 222c 2066 2e63 6f6c 6f75  f.uid}", f.colou
+00007d60: 725b 305d 2c20 662e 636f 6c6f 7572 5b31  r[0], f.colour[1
+00007d70: 5d2c 2066 2e63 6f6c 6f75 725b 325d 2c20  ], f.colour[2], 
+00007d80: 312c 2069 6d67 7569 2e43 4f4c 4f52 5f45  1, imgui.COLOR_E
+00007d90: 4449 545f 4e4f 5f54 4f4f 4c54 4950 2c20  DIT_NO_TOOLTIP, 
+00007da0: 362c 2031 3329 3a0d 0a20 2020 2020 2020  6, 13):..       
+00007db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007dc0: 2020 2020 2073 2e61 6374 6976 655f 6665       s.active_fe
+00007dd0: 6174 7572 6520 3d20 660d 0a0d 0a20 2020  ature = f....   
+00007de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007df0: 2069 6d67 7569 2e70 6f70 5f69 6428 290d   imgui.pop_id().
+00007e00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00007e10: 2069 6d67 7569 2e65 6e64 5f63 6869 6c64   imgui.end_child
+00007e20: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
+00007e30: 2020 2020 696d 6775 692e 7075 7368 5f73      imgui.push_s
+00007e40: 7479 6c65 5f76 6172 2869 6d67 7569 2e53  tyle_var(imgui.S
+00007e50: 5459 4c45 5f46 5241 4d45 5f52 4f55 4e44  TYLE_FRAME_ROUND
+00007e60: 494e 472c 2031 3029 0d0a 2020 2020 2020  ING, 10)..      
+00007e70: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
+00007e80: 7075 7368 5f73 7479 6c65 5f76 6172 2869  push_style_var(i
+00007e90: 6d67 7569 2e53 5459 4c45 5f46 5241 4d45  mgui.STYLE_FRAME
+00007ea0: 5f50 4144 4449 4e47 2c20 2830 2c20 3029  _PADDING, (0, 0)
+00007eb0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00007ec0: 2020 2069 6d67 7569 2e70 7573 685f 7374     imgui.push_st
+00007ed0: 796c 655f 7661 7228 696d 6775 692e 5354  yle_var(imgui.ST
+00007ee0: 594c 455f 4652 414d 455f 424f 5244 4552  YLE_FRAME_BORDER
+00007ef0: 5349 5a45 2c20 3129 0d0a 2020 2020 2020  SIZE, 1)..      
+00007f00: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
+00007f10: 7075 7368 5f73 7479 6c65 5f63 6f6c 6f72  push_style_color
+00007f20: 2869 6d67 7569 2e43 4f4c 4f52 5f43 4845  (imgui.COLOR_CHE
+00007f30: 434b 5f4d 4152 4b2c 2030 2e30 2c20 302e  CK_MARK, 0.0, 0.
+00007f40: 302c 2030 2e30 2c20 312e 3029 0d0a 2020  0, 0.0, 1.0)..  
+00007f50: 2020 2020 2020 2020 2020 2020 2020 5f2c                _,
+00007f60: 2053 6567 6d65 6e74 6174 696f 6e45 6469   SegmentationEdi
+00007f70: 746f 722e 4441 5441 5345 5453 5f57 494e  tor.DATASETS_WIN
+00007f80: 444f 575f 4558 5041 4e44 4544 203d 2069  DOW_EXPANDED = i
+00007f90: 6d67 7569 2e63 6865 636b 626f 7828 2265  mgui.checkbox("e
+00007fa0: 7870 616e 6422 2c20 5365 676d 656e 7461  xpand", Segmenta
+00007fb0: 7469 6f6e 4564 6974 6f72 2e44 4154 4153  tionEditor.DATAS
+00007fc0: 4554 535f 5749 4e44 4f57 5f45 5850 414e  ETS_WINDOW_EXPAN
+00007fd0: 4445 4429 0d0a 2020 2020 2020 2020 2020  DED)..          
+00007fe0: 2020 2020 2020 696d 6775 692e 706f 705f        imgui.pop_
+00007ff0: 7374 796c 655f 7661 7228 3329 0d0a 2020  style_var(3)..  
+00008000: 2020 2020 2020 2020 2020 2020 2020 696d                im
+00008010: 6775 692e 706f 705f 7374 796c 655f 636f  gui.pop_style_co
+00008020: 6c6f 7228 3129 0d0a 2020 2020 2020 2020  lor(1)..        
+00008030: 2020 2020 6966 2069 6d67 7569 2e63 6f6c      if imgui.col
+00008040: 6c61 7073 696e 675f 6865 6164 6572 2822  lapsing_header("
+00008050: 4669 6c74 6572 7322 2c20 4e6f 6e65 2c20  Filters", None, 
+00008060: 696d 6775 692e 5452 4545 5f4e 4f44 455f  imgui.TREE_NODE_
+00008070: 4445 4641 554c 545f 4f50 454e 295b 305d  DEFAULT_OPEN)[0]
+00008080: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00008090: 2020 2073 6566 203d 2063 6667 2e73 655f     sef = cfg.se_
+000080a0: 6163 7469 7665 5f66 7261 6d65 0d0a 2020  active_frame..  
+000080b0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+000080c0: 2073 6566 2069 7320 6e6f 7420 4e6f 6e65   sef is not None
+000080d0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000080e0: 2020 2020 2020 205f 6377 203d 2069 6d67         _cw = img
+000080f0: 7569 2e67 6574 5f63 6f6e 7465 6e74 5f72  ui.get_content_r
+00008100: 6567 696f 6e5f 6176 6169 6c61 626c 655f  egion_available_
+00008110: 7769 6474 6828 290d 0a20 2020 2020 2020  width()..       
+00008120: 2020 2020 2020 2020 2020 2020 2069 6d67               img
+00008130: 7569 2e70 6c6f 745f 6869 7374 6f67 7261  ui.plot_histogra
+00008140: 6d28 2223 2368 6973 7422 2c20 7365 662e  m("##hist", sef.
+00008150: 6869 7374 5f76 616c 732c 0d0a 2020 2020  hist_vals,..    
 00008160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008170: 2020 2020 2020 2020 2020 2067 7261 7068             graph
-00008180: 5f73 697a 653d 285f 6377 2c20 5365 676d  _size=(_cw, Segm
-00008190: 656e 7461 7469 6f6e 4564 6974 6f72 2e49  entationEditor.I
-000081a0: 4e46 4f5f 4849 5354 4f47 5241 4d5f 4845  NFO_HISTOGRAM_HE
-000081b0: 4947 4854 2929 0d0a 2020 2020 2020 2020  IGHT))..        
-000081c0: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
-000081d0: 692e 7075 7368 5f69 7465 6d5f 7769 6474  i.push_item_widt
-000081e0: 6828 5f63 7729 0d0a 0d0a 2020 2020 2020  h(_cw)....      
-000081f0: 2020 2020 2020 2020 2020 2020 2020 696d                im
-00008200: 6775 692e 7075 7368 5f73 7479 6c65 5f76  gui.push_style_v
-00008210: 6172 2869 6d67 7569 2e53 5459 4c45 5f46  ar(imgui.STYLE_F
-00008220: 5241 4d45 5f52 4f55 4e44 494e 472c 2031  RAME_ROUNDING, 1
-00008230: 3029 0d0a 2020 2020 2020 2020 2020 2020  0)..            
-00008240: 2020 2020 2020 2020 696d 6775 692e 7075          imgui.pu
-00008250: 7368 5f73 7479 6c65 5f76 6172 2869 6d67  sh_style_var(img
-00008260: 7569 2e53 5459 4c45 5f47 5241 425f 524f  ui.STYLE_GRAB_RO
-00008270: 554e 4449 4e47 2c20 3230 290d 0a20 2020  UNDING, 20)..   
-00008280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008290: 2069 6d67 7569 2e70 7573 685f 7374 796c   imgui.push_styl
-000082a0: 655f 7661 7228 696d 6775 692e 5354 594c  e_var(imgui.STYL
-000082b0: 455f 4752 4142 5f4d 494e 5f53 495a 452c  E_GRAB_MIN_SIZE,
-000082c0: 2039 290d 0a20 2020 2020 2020 2020 2020   9)..           
-000082d0: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
-000082e0: 7573 685f 7374 796c 655f 7661 7228 696d  ush_style_var(im
-000082f0: 6775 692e 5354 594c 455f 4652 414d 455f  gui.STYLE_FRAME_
-00008300: 424f 5244 4552 5349 5a45 2c20 3129 0d0a  BORDERSIZE, 1)..
-00008310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008320: 2020 2020 696d 6775 692e 7075 7368 5f73      imgui.push_s
-00008330: 7479 6c65 5f76 6172 2869 6d67 7569 2e53  tyle_var(imgui.S
-00008340: 5459 4c45 5f46 5241 4d45 5f50 4144 4449  TYLE_FRAME_PADDI
-00008350: 4e47 2c20 2830 2c20 3029 290d 0a20 2020  NG, (0, 0))..   
-00008360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008370: 2069 6d67 7569 2e70 7573 685f 7374 796c   imgui.push_styl
-00008380: 655f 636f 6c6f 7228 696d 6775 692e 434f  e_color(imgui.CO
-00008390: 4c4f 525f 4348 4543 4b5f 4d41 524b 2c20  LOR_CHECK_MARK, 
-000083a0: 2a63 6667 2e43 4f4c 4f55 525f 5445 5854  *cfg.COLOUR_TEXT
-000083b0: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
-000083c0: 2020 2020 2020 2020 205f 6d69 6e63 2c20           _minc, 
-000083d0: 7365 662e 636f 6e74 7261 7374 5f6c 696d  sef.contrast_lim
-000083e0: 735b 305d 203d 2069 6d67 7569 2e73 6c69  s[0] = imgui.sli
-000083f0: 6465 725f 666c 6f61 7428 226d 696e 222c  der_float("min",
-00008400: 2073 6566 2e63 6f6e 7472 6173 745f 6c69   sef.contrast_li
-00008410: 6d73 5b30 5d2c 2073 6566 2e68 6973 745f  ms[0], sef.hist_
-00008420: 6269 6e73 5b30 5d2c 2073 6566 2e68 6973  bins[0], sef.his
-00008430: 745f 6269 6e73 5b2d 315d 2c20 666f 726d  t_bins[-1], form
-00008440: 6174 3d27 6d69 6e20 252e 3166 2729 0d0a  at='min %.1f')..
-00008450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008460: 2020 2020 5f6d 6178 632c 2073 6566 2e63      _maxc, sef.c
-00008470: 6f6e 7472 6173 745f 6c69 6d73 5b31 5d20  ontrast_lims[1] 
-00008480: 3d20 696d 6775 692e 736c 6964 6572 5f66  = imgui.slider_f
-00008490: 6c6f 6174 2822 6d61 7822 2c20 7365 662e  loat("max", sef.
-000084a0: 636f 6e74 7261 7374 5f6c 696d 735b 315d  contrast_lims[1]
-000084b0: 2c20 7365 662e 6869 7374 5f62 696e 735b  , sef.hist_bins[
-000084c0: 305d 2c20 7365 662e 6869 7374 5f62 696e  0], sef.hist_bin
-000084d0: 735b 2d31 5d2c 2066 6f72 6d61 743d 276d  s[-1], format='m
-000084e0: 6178 2025 2e31 6627 290d 0a20 2020 2020  ax %.1f')..     
-000084f0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00008500: 6620 7365 6c66 2e61 6374 6976 655f 7461  f self.active_ta
-00008510: 6220 3d3d 2022 5265 6e64 6572 223a 0d0a  b == "Render":..
-00008520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008530: 2020 2020 2020 2020 5f2c 2053 6567 6d65          _, Segme
-00008540: 6e74 6174 696f 6e45 6469 746f 722e 5049  ntationEditor.PI
-00008550: 434b 494e 475f 4652 414d 455f 414c 5048  CKING_FRAME_ALPH
-00008560: 4120 3d20 696d 6775 692e 736c 6964 6572  A = imgui.slider
-00008570: 5f66 6c6f 6174 2822 616c 7068 6122 2c20  _float("alpha", 
-00008580: 5365 676d 656e 7461 7469 6f6e 4564 6974  SegmentationEdit
-00008590: 6f72 2e50 4943 4b49 4e47 5f46 5241 4d45  or.PICKING_FRAME
-000085a0: 5f41 4c50 4841 2c20 302e 302c 2031 2e30  _ALPHA, 0.0, 1.0
-000085b0: 2c20 666f 726d 6174 3d22 616c 7068 6120  , format="alpha 
-000085c0: 252e 3166 2229 0d0a 2020 2020 2020 2020  %.1f")..        
-000085d0: 2020 2020 2020 2020 2020 2020 6966 205f              if _
-000085e0: 6d69 6e63 206f 7220 5f6d 6178 633a 0d0a  minc or _maxc:..
-000085f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008600: 2020 2020 2020 2020 7365 662e 6175 746f          sef.auto
-00008610: 636f 6e74 7261 7374 203d 2046 616c 7365  contrast = False
-00008620: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00008630: 2020 2020 2020 696d 6775 692e 706f 705f        imgui.pop_
-00008640: 6974 656d 5f77 6964 7468 2829 0d0a 2020  item_width()..  
-00008650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008660: 2020 5f63 2c20 7365 662e 696e 7665 7274    _c, sef.invert
-00008670: 203d 2069 6d67 7569 2e63 6865 636b 626f   = imgui.checkbo
-00008680: 7828 2269 6e76 6572 7465 6422 2c20 7365  x("inverted", se
-00008690: 662e 696e 7665 7274 290d 0a20 2020 2020  f.invert)..     
-000086a0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000086b0: 6d67 7569 2e73 616d 655f 6c69 6e65 2873  mgui.same_line(s
-000086c0: 7061 6369 6e67 3d31 3629 0d0a 2020 2020  pacing=16)..    
-000086d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000086e0: 5f63 2c20 7365 662e 6175 746f 636f 6e74  _c, sef.autocont
-000086f0: 7261 7374 203d 2069 6d67 7569 2e63 6865  rast = imgui.che
-00008700: 636b 626f 7828 2261 7574 6f22 2c20 7365  ckbox("auto", se
-00008710: 662e 6175 746f 636f 6e74 7261 7374 290d  f.autocontrast).
-00008720: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008730: 2020 2020 2069 6620 5f63 2061 6e64 2073       if _c and s
-00008740: 6566 2e61 7574 6f63 6f6e 7472 6173 743a  ef.autocontrast:
-00008750: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00008760: 2020 2020 2020 2020 2020 5365 676d 656e            Segmen
-00008770: 7461 7469 6f6e 4564 6974 6f72 2e46 5241  tationEditor.FRA
-00008780: 4d45 5f54 4558 5455 5245 5f52 4551 5549  ME_TEXTURE_REQUI
-00008790: 5245 535f 5550 4441 5445 207c 3d20 5472  RES_UPDATE |= Tr
-000087a0: 7565 0d0a 2020 2020 2020 2020 2020 2020  ue..            
-000087b0: 2020 2020 2020 2020 696d 6775 692e 7361          imgui.sa
-000087c0: 6d65 5f6c 696e 6528 7370 6163 696e 673d  me_line(spacing=
-000087d0: 3136 290d 0a20 2020 2020 2020 2020 2020  16)..           
-000087e0: 2020 2020 2020 2020 205f 632c 2073 6566           _c, sef
-000087f0: 2e69 6e74 6572 706f 6c61 7465 203d 2069  .interpolate = i
-00008800: 6d67 7569 2e63 6865 636b 626f 7828 2269  mgui.checkbox("i
-00008810: 6e74 6572 706f 6c61 7465 222c 2073 6566  nterpolate", sef
-00008820: 2e69 6e74 6572 706f 6c61 7465 290d 0a20  .interpolate).. 
-00008830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008840: 2020 2069 6d67 7569 2e73 616d 655f 6c69     imgui.same_li
-00008850: 6e65 2873 7061 6369 6e67 3d31 3629 0d0a  ne(spacing=16)..
-00008860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008870: 2020 2020 6966 205f 633a 0d0a 2020 2020      if _c:..    
-00008880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008890: 2020 2020 6966 2073 6566 2e69 6e74 6572      if sef.inter
-000088a0: 706f 6c61 7465 3a0d 0a20 2020 2020 2020  polate:..       
-000088b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000088c0: 2020 2020 2073 6566 2e74 6578 7475 7265       sef.texture
-000088d0: 2e73 6574 5f6c 696e 6561 725f 696e 7465  .set_linear_inte
-000088e0: 7270 6f6c 6174 696f 6e28 290d 0a20 2020  rpolation()..   
-000088f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008900: 2020 2020 2020 2020 2053 6567 6d65 6e74           Segment
-00008910: 6174 696f 6e45 6469 746f 722e 7265 6e64  ationEditor.rend
-00008920: 6572 6572 2e66 626f 312e 7465 7874 7572  erer.fbo1.textur
-00008930: 652e 7365 745f 6c69 6e65 6172 5f69 6e74  e.set_linear_int
-00008940: 6572 706f 6c61 7469 6f6e 2829 0d0a 2020  erpolation()..  
-00008950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008960: 2020 2020 2020 2020 2020 5365 676d 656e            Segmen
-00008970: 7461 7469 6f6e 4564 6974 6f72 2e72 656e  tationEditor.ren
-00008980: 6465 7265 722e 6662 6f32 2e74 6578 7475  derer.fbo2.textu
-00008990: 7265 2e73 6574 5f6c 696e 6561 725f 696e  re.set_linear_in
-000089a0: 7465 7270 6f6c 6174 696f 6e28 290d 0a20  terpolation().. 
-000089b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000089c0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-000089d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000089e0: 2020 2020 2020 2020 2020 7365 662e 7465            sef.te
-000089f0: 7874 7572 652e 7365 745f 6e6f 5f69 6e74  xture.set_no_int
-00008a00: 6572 706f 6c61 7469 6f6e 2829 0d0a 2020  erpolation()..  
-00008a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008a20: 2020 2020 2020 2020 2020 5365 676d 656e            Segmen
-00008a30: 7461 7469 6f6e 4564 6974 6f72 2e72 656e  tationEditor.ren
-00008a40: 6465 7265 722e 6662 6f31 2e74 6578 7475  derer.fbo1.textu
-00008a50: 7265 2e73 6574 5f6e 6f5f 696e 7465 7270  re.set_no_interp
-00008a60: 6f6c 6174 696f 6e28 290d 0a20 2020 2020  olation()..     
-00008a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008a80: 2020 2020 2020 2053 6567 6d65 6e74 6174         Segmentat
-00008a90: 696f 6e45 6469 746f 722e 7265 6e64 6572  ionEditor.render
-00008aa0: 6572 2e66 626f 322e 7465 7874 7572 652e  er.fbo2.texture.
-00008ab0: 7365 745f 6e6f 5f69 6e74 6572 706f 6c61  set_no_interpola
-00008ac0: 7469 6f6e 2829 0d0a 2020 2020 2020 2020  tion()..        
-00008ad0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-00008ae0: 656c 662e 6163 7469 7665 5f74 6162 2069  elf.active_tab i
-00008af0: 6e20 5b22 5365 676d 656e 7461 7469 6f6e  n ["Segmentation
-00008b00: 222c 2022 5265 6e64 6572 225d 3a0d 0a20  ", "Render"]:.. 
-00008b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008b20: 2020 2020 2020 2069 6d67 7569 2e70 7573         imgui.pus
-00008b30: 685f 7374 796c 655f 636f 6c6f 7228 696d  h_style_color(im
-00008b40: 6775 692e 434f 4c4f 525f 5445 5854 2c20  gui.COLOR_TEXT, 
-00008b50: 2a63 6667 2e43 4f4c 4f55 525f 5445 5854  *cfg.COLOUR_TEXT
-00008b60: 5f44 4953 4142 4c45 4429 0d0a 2020 2020  _DISABLED)..    
-00008b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008b80: 2020 2020 696d 6775 692e 7075 7368 5f73      imgui.push_s
-00008b90: 7479 6c65 5f63 6f6c 6f72 2869 6d67 7569  tyle_color(imgui
-00008ba0: 2e43 4f4c 4f52 5f43 4845 434b 5f4d 4152  .COLOR_CHECK_MAR
-00008bb0: 4b2c 202a 6366 672e 434f 4c4f 5552 5f54  K, *cfg.COLOUR_T
-00008bc0: 4558 545f 4449 5341 424c 4544 290d 0a20  EXT_DISABLED).. 
-00008bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008be0: 2020 205f 632c 2073 6566 2e63 726f 7020     _c, sef.crop 
-00008bf0: 3d20 696d 6775 692e 6368 6563 6b62 6f78  = imgui.checkbox
-00008c00: 2822 6372 6f70 222c 2073 6566 2e63 726f  ("crop", sef.cro
-00008c10: 7029 0d0a 2020 2020 2020 2020 2020 2020  p)..            
-00008c20: 2020 2020 2020 2020 6966 205f 6320 616e          if _c an
-00008c30: 6420 6e6f 7420 7365 662e 6372 6f70 3a0d  d not sef.crop:.
-00008c40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008c50: 2020 2020 2020 2020 2073 6566 2e63 726f           sef.cro
-00008c60: 705f 726f 6920 3d20 5b30 2c20 302c 2073  p_roi = [0, 0, s
-00008c70: 6566 2e77 6964 7468 2c20 7365 662e 6865  ef.width, sef.he
-00008c80: 6967 6874 5d0d 0a20 2020 2020 2020 2020  ight]..         
-00008c90: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-00008ca0: 6c66 2e61 6374 6976 655f 7461 6220 696e  lf.active_tab in
-00008cb0: 205b 2253 6567 6d65 6e74 6174 696f 6e22   ["Segmentation"
-00008cc0: 2c20 2252 656e 6465 7222 5d3a 0d0a 2020  , "Render"]:..  
-00008cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008ce0: 2020 2020 2020 696d 6775 692e 706f 705f        imgui.pop_
-00008cf0: 7374 796c 655f 636f 6c6f 7228 3229 0d0a  style_color(2)..
-00008d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008d10: 2020 2020 696d 6775 692e 7365 7061 7261      imgui.separa
-00008d20: 746f 7228 290d 0a20 2020 2020 2020 2020  tor()..         
-00008d30: 2020 2020 2020 2020 2020 2066 6964 7820             fidx 
-00008d40: 3d20 300d 0a20 2020 2020 2020 2020 2020  = 0..           
-00008d50: 2020 2020 2020 2020 2066 6f72 2066 7472           for ftr
-00008d60: 2069 6e20 7365 6c66 2e66 696c 7465 7273   in self.filters
-00008d70: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00008d80: 2020 2020 2020 2020 2020 2066 6964 7820             fidx 
-00008d90: 2b3d 2031 0d0a 2020 2020 2020 2020 2020  += 1..          
-00008da0: 2020 2020 2020 2020 2020 2020 2020 696d                im
-00008db0: 6775 692e 7075 7368 5f69 6428 6622 6669  gui.push_id(f"fi
-00008dc0: 6c74 6572 7b66 6964 787d 2229 0d0a 2020  lter{fidx}")..  
-00008dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008de0: 2020 2020 2020 6377 203d 2069 6d67 7569        cw = imgui
-00008df0: 2e67 6574 5f63 6f6e 7465 6e74 5f72 6567  .get_content_reg
-00008e00: 696f 6e5f 6176 6169 6c61 626c 655f 7769  ion_available_wi
-00008e10: 6474 6828 290d 0a0d 0a20 2020 2020 2020  dth()....       
-00008e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008e30: 2023 2046 696c 7465 7220 7479 7065 2073   # Filter type s
-00008e40: 656c 6563 7469 6f6e 2063 6f6d 626f 0d0a  election combo..
-00008e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008e60: 2020 2020 2020 2020 696d 6775 692e 7365          imgui.se
-00008e70: 745f 6e65 7874 5f69 7465 6d5f 7769 6474  t_next_item_widt
-00008e80: 6828 6377 202d 2036 3029 0d0a 2020 2020  h(cw - 60)..    
-00008e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008ea0: 2020 2020 696d 6775 692e 7075 7368 5f73      imgui.push_s
-00008eb0: 7479 6c65 5f76 6172 2869 6d67 7569 2e53  tyle_var(imgui.S
-00008ec0: 5459 4c45 5f46 5241 4d45 5f50 4144 4449  TYLE_FRAME_PADDI
-00008ed0: 4e47 2c20 2835 2c20 3229 290d 0a20 2020  NG, (5, 2))..   
-00008ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008ef0: 2020 2020 205f 632c 2066 7472 7479 7065       _c, ftrtype
-00008f00: 203d 2069 6d67 7569 2e63 6f6d 626f 2822   = imgui.combo("
-00008f10: 2323 6669 6c74 6572 7479 7065 222c 2066  ##filtertype", f
-00008f20: 7472 2e74 7970 652c 2046 696c 7465 722e  tr.type, Filter.
-00008f30: 5459 5045 5329 0d0a 2020 2020 2020 2020  TYPES)..        
-00008f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008f50: 6966 205f 633a 0d0a 2020 2020 2020 2020  if _c:..        
-00008f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008f70: 2020 2020 7365 6c66 2e66 696c 7465 7273      self.filters
-00008f80: 5b73 656c 662e 6669 6c74 6572 732e 696e  [self.filters.in
-00008f90: 6465 7828 6674 7229 5d20 3d20 4669 6c74  dex(ftr)] = Filt
-00008fa0: 6572 2866 7472 7479 7065 290d 0a20 2020  er(ftrtype)..   
-00008fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008fc0: 2020 2020 2020 2020 2053 6567 6d65 6e74           Segment
-00008fd0: 6174 696f 6e45 6469 746f 722e 4652 414d  ationEditor.FRAM
-00008fe0: 455f 5445 5854 5552 455f 5245 5155 4952  E_TEXTURE_REQUIR
-00008ff0: 4553 5f55 5044 4154 4520 7c3d 2054 7275  ES_UPDATE |= Tru
-00009000: 650d 0a20 2020 2020 2020 2020 2020 2020  e..             
-00009010: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
-00009020: 2e73 616d 655f 6c69 6e65 2829 0d0a 2020  .same_line()..  
-00009030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009040: 2020 2020 2020 5f2c 2066 7472 2e65 6e61        _, ftr.ena
-00009050: 626c 6564 203d 2069 6d67 7569 2e63 6865  bled = imgui.che
-00009060: 636b 626f 7828 2223 2365 6e61 626c 6564  ckbox("##enabled
-00009070: 222c 2066 7472 2e65 6e61 626c 6564 290d  ", ftr.enabled).
-00009080: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009090: 2020 2020 2020 2020 2069 6620 5f3a 0d0a           if _:..
-000090a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000090b0: 2020 2020 2020 2020 2020 2020 5365 676d              Segm
-000090c0: 656e 7461 7469 6f6e 4564 6974 6f72 2e46  entationEditor.F
-000090d0: 5241 4d45 5f54 4558 5455 5245 5f52 4551  RAME_TEXTURE_REQ
-000090e0: 5549 5245 535f 5550 4441 5445 207c 3d20  UIRES_UPDATE |= 
-000090f0: 5472 7565 0d0a 2020 2020 2020 2020 2020  True..          
-00009100: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00009110: 4465 6c65 7465 2062 7574 746f 6e0d 0a20  Delete button.. 
-00009120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009130: 2020 2020 2020 2069 6d67 7569 2e73 616d         imgui.sam
-00009140: 655f 6c69 6e65 2829 0d0a 2020 2020 2020  e_line()..      
-00009150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009160: 2020 6966 2069 6d67 7569 2e69 6d61 6765    if imgui.image
-00009170: 5f62 7574 746f 6e28 7365 6c66 2e69 636f  _button(self.ico
-00009180: 6e5f 636c 6f73 652e 7265 6e64 6572 6572  n_close.renderer
-00009190: 5f69 642c 2031 332c 2031 3329 3a0d 0a20  _id, 13, 13):.. 
-000091a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000091b0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000091c0: 6669 6c74 6572 732e 7265 6d6f 7665 2866  filters.remove(f
-000091d0: 7472 290d 0a20 2020 2020 2020 2020 2020  tr)..           
+00008170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008180: 2020 2020 2067 7261 7068 5f73 697a 653d       graph_size=
+00008190: 285f 6377 2c20 5365 676d 656e 7461 7469  (_cw, Segmentati
+000081a0: 6f6e 4564 6974 6f72 2e49 4e46 4f5f 4849  onEditor.INFO_HI
+000081b0: 5354 4f47 5241 4d5f 4845 4947 4854 2929  STOGRAM_HEIGHT))
+000081c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000081d0: 2020 2020 2020 696d 6775 692e 7075 7368        imgui.push
+000081e0: 5f69 7465 6d5f 7769 6474 6828 5f63 7729  _item_width(_cw)
+000081f0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+00008200: 2020 2020 2020 2020 696d 6775 692e 7075          imgui.pu
+00008210: 7368 5f73 7479 6c65 5f76 6172 2869 6d67  sh_style_var(img
+00008220: 7569 2e53 5459 4c45 5f46 5241 4d45 5f52  ui.STYLE_FRAME_R
+00008230: 4f55 4e44 494e 472c 2031 3029 0d0a 2020  OUNDING, 10)..  
+00008240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008250: 2020 696d 6775 692e 7075 7368 5f73 7479    imgui.push_sty
+00008260: 6c65 5f76 6172 2869 6d67 7569 2e53 5459  le_var(imgui.STY
+00008270: 4c45 5f47 5241 425f 524f 554e 4449 4e47  LE_GRAB_ROUNDING
+00008280: 2c20 3230 290d 0a20 2020 2020 2020 2020  , 20)..         
+00008290: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
+000082a0: 2e70 7573 685f 7374 796c 655f 7661 7228  .push_style_var(
+000082b0: 696d 6775 692e 5354 594c 455f 4752 4142  imgui.STYLE_GRAB
+000082c0: 5f4d 494e 5f53 495a 452c 2039 290d 0a20  _MIN_SIZE, 9).. 
+000082d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000082e0: 2020 2069 6d67 7569 2e70 7573 685f 7374     imgui.push_st
+000082f0: 796c 655f 7661 7228 696d 6775 692e 5354  yle_var(imgui.ST
+00008300: 594c 455f 4652 414d 455f 424f 5244 4552  YLE_FRAME_BORDER
+00008310: 5349 5a45 2c20 3129 0d0a 2020 2020 2020  SIZE, 1)..      
+00008320: 2020 2020 2020 2020 2020 2020 2020 696d                im
+00008330: 6775 692e 7075 7368 5f73 7479 6c65 5f76  gui.push_style_v
+00008340: 6172 2869 6d67 7569 2e53 5459 4c45 5f46  ar(imgui.STYLE_F
+00008350: 5241 4d45 5f50 4144 4449 4e47 2c20 2830  RAME_PADDING, (0
+00008360: 2c20 3029 290d 0a20 2020 2020 2020 2020  , 0))..         
+00008370: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
+00008380: 2e70 7573 685f 7374 796c 655f 636f 6c6f  .push_style_colo
+00008390: 7228 696d 6775 692e 434f 4c4f 525f 4348  r(imgui.COLOR_CH
+000083a0: 4543 4b5f 4d41 524b 2c20 2a63 6667 2e43  ECK_MARK, *cfg.C
+000083b0: 4f4c 4f55 525f 5445 5854 290d 0a0d 0a20  OLOUR_TEXT).... 
+000083c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000083d0: 2020 205f 6d69 6e63 2c20 7365 662e 636f     _minc, sef.co
+000083e0: 6e74 7261 7374 5f6c 696d 735b 305d 203d  ntrast_lims[0] =
+000083f0: 2069 6d67 7569 2e73 6c69 6465 725f 666c   imgui.slider_fl
+00008400: 6f61 7428 226d 696e 222c 2073 6566 2e63  oat("min", sef.c
+00008410: 6f6e 7472 6173 745f 6c69 6d73 5b30 5d2c  ontrast_lims[0],
+00008420: 2073 6566 2e68 6973 745f 6269 6e73 5b30   sef.hist_bins[0
+00008430: 5d2c 2073 6566 2e68 6973 745f 6269 6e73  ], sef.hist_bins
+00008440: 5b2d 315d 2c20 666f 726d 6174 3d27 6d69  [-1], format='mi
+00008450: 6e20 252e 3166 2729 0d0a 2020 2020 2020  n %.1f')..      
+00008460: 2020 2020 2020 2020 2020 2020 2020 5f6d                _m
+00008470: 6178 632c 2073 6566 2e63 6f6e 7472 6173  axc, sef.contras
+00008480: 745f 6c69 6d73 5b31 5d20 3d20 696d 6775  t_lims[1] = imgu
+00008490: 692e 736c 6964 6572 5f66 6c6f 6174 2822  i.slider_float("
+000084a0: 6d61 7822 2c20 7365 662e 636f 6e74 7261  max", sef.contra
+000084b0: 7374 5f6c 696d 735b 315d 2c20 7365 662e  st_lims[1], sef.
+000084c0: 6869 7374 5f62 696e 735b 305d 2c20 7365  hist_bins[0], se
+000084d0: 662e 6869 7374 5f62 696e 735b 2d31 5d2c  f.hist_bins[-1],
+000084e0: 2066 6f72 6d61 743d 276d 6178 2025 2e31   format='max %.1
+000084f0: 6627 290d 0a20 2020 2020 2020 2020 2020  f')..           
+00008500: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+00008510: 2e61 6374 6976 655f 7461 6220 3d3d 2022  .active_tab == "
+00008520: 5265 6e64 6572 223a 0d0a 2020 2020 2020  Render":..      
+00008530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008540: 2020 5f2c 2053 6567 6d65 6e74 6174 696f    _, Segmentatio
+00008550: 6e45 6469 746f 722e 5049 434b 494e 475f  nEditor.PICKING_
+00008560: 4652 414d 455f 414c 5048 4120 3d20 696d  FRAME_ALPHA = im
+00008570: 6775 692e 736c 6964 6572 5f66 6c6f 6174  gui.slider_float
+00008580: 2822 616c 7068 6122 2c20 5365 676d 656e  ("alpha", Segmen
+00008590: 7461 7469 6f6e 4564 6974 6f72 2e50 4943  tationEditor.PIC
+000085a0: 4b49 4e47 5f46 5241 4d45 5f41 4c50 4841  KING_FRAME_ALPHA
+000085b0: 2c20 302e 302c 2031 2e30 2c20 666f 726d  , 0.0, 1.0, form
+000085c0: 6174 3d22 616c 7068 6120 252e 3166 2229  at="alpha %.1f")
+000085d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000085e0: 2020 2020 2020 6966 205f 6d69 6e63 206f        if _minc o
+000085f0: 7220 5f6d 6178 633a 0d0a 2020 2020 2020  r _maxc:..      
+00008600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008610: 2020 7365 662e 6175 746f 636f 6e74 7261    sef.autocontra
+00008620: 7374 203d 2046 616c 7365 0d0a 2020 2020  st = False..    
+00008630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008640: 696d 6775 692e 706f 705f 6974 656d 5f77  imgui.pop_item_w
+00008650: 6964 7468 2829 0d0a 2020 2020 2020 2020  idth()..        
+00008660: 2020 2020 2020 2020 2020 2020 5f63 2c20              _c, 
+00008670: 7365 662e 696e 7665 7274 203d 2069 6d67  sef.invert = img
+00008680: 7569 2e63 6865 636b 626f 7828 2269 6e76  ui.checkbox("inv
+00008690: 6572 7465 6422 2c20 7365 662e 696e 7665  erted", sef.inve
+000086a0: 7274 290d 0a20 2020 2020 2020 2020 2020  rt)..           
+000086b0: 2020 2020 2020 2020 2069 6d67 7569 2e73           imgui.s
+000086c0: 616d 655f 6c69 6e65 2873 7061 6369 6e67  ame_line(spacing
+000086d0: 3d31 3629 0d0a 2020 2020 2020 2020 2020  =16)..          
+000086e0: 2020 2020 2020 2020 2020 5f63 2c20 7365            _c, se
+000086f0: 662e 6175 746f 636f 6e74 7261 7374 203d  f.autocontrast =
+00008700: 2069 6d67 7569 2e63 6865 636b 626f 7828   imgui.checkbox(
+00008710: 2261 7574 6f22 2c20 7365 662e 6175 746f  "auto", sef.auto
+00008720: 636f 6e74 7261 7374 290d 0a20 2020 2020  contrast)..     
+00008730: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00008740: 6620 5f63 2061 6e64 2073 6566 2e61 7574  f _c and sef.aut
+00008750: 6f63 6f6e 7472 6173 743a 0d0a 2020 2020  ocontrast:..    
+00008760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008770: 2020 2020 5365 676d 656e 7461 7469 6f6e      Segmentation
+00008780: 4564 6974 6f72 2e46 5241 4d45 5f54 4558  Editor.FRAME_TEX
+00008790: 5455 5245 5f52 4551 5549 5245 535f 5550  TURE_REQUIRES_UP
+000087a0: 4441 5445 207c 3d20 5472 7565 0d0a 2020  DATE |= True..  
+000087b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000087c0: 2020 696d 6775 692e 7361 6d65 5f6c 696e    imgui.same_lin
+000087d0: 6528 7370 6163 696e 673d 3136 290d 0a20  e(spacing=16).. 
+000087e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000087f0: 2020 205f 632c 2073 6566 2e69 6e74 6572     _c, sef.inter
+00008800: 706f 6c61 7465 203d 2069 6d67 7569 2e63  polate = imgui.c
+00008810: 6865 636b 626f 7828 2269 6e74 6572 706f  heckbox("interpo
+00008820: 6c61 7465 222c 2073 6566 2e69 6e74 6572  late", sef.inter
+00008830: 706f 6c61 7465 290d 0a20 2020 2020 2020  polate)..       
+00008840: 2020 2020 2020 2020 2020 2020 2069 6d67               img
+00008850: 7569 2e73 616d 655f 6c69 6e65 2873 7061  ui.same_line(spa
+00008860: 6369 6e67 3d31 3629 0d0a 2020 2020 2020  cing=16)..      
+00008870: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00008880: 205f 633a 0d0a 2020 2020 2020 2020 2020   _c:..          
+00008890: 2020 2020 2020 2020 2020 2020 2020 6966                if
+000088a0: 2073 6566 2e69 6e74 6572 706f 6c61 7465   sef.interpolate
+000088b0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000088c0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+000088d0: 6566 2e74 6578 7475 7265 2e73 6574 5f6c  ef.texture.set_l
+000088e0: 696e 6561 725f 696e 7465 7270 6f6c 6174  inear_interpolat
+000088f0: 696f 6e28 290d 0a20 2020 2020 2020 2020  ion()..         
+00008900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008910: 2020 2053 6567 6d65 6e74 6174 696f 6e45     SegmentationE
+00008920: 6469 746f 722e 7265 6e64 6572 6572 2e66  ditor.renderer.f
+00008930: 626f 312e 7465 7874 7572 652e 7365 745f  bo1.texture.set_
+00008940: 6c69 6e65 6172 5f69 6e74 6572 706f 6c61  linear_interpola
+00008950: 7469 6f6e 2829 0d0a 2020 2020 2020 2020  tion()..        
+00008960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008970: 2020 2020 5365 676d 656e 7461 7469 6f6e      Segmentation
+00008980: 4564 6974 6f72 2e72 656e 6465 7265 722e  Editor.renderer.
+00008990: 6662 6f32 2e74 6578 7475 7265 2e73 6574  fbo2.texture.set
+000089a0: 5f6c 696e 6561 725f 696e 7465 7270 6f6c  _linear_interpol
+000089b0: 6174 696f 6e28 290d 0a20 2020 2020 2020  ation()..       
+000089c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000089d0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+000089e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000089f0: 2020 2020 7365 662e 7465 7874 7572 652e      sef.texture.
+00008a00: 7365 745f 6e6f 5f69 6e74 6572 706f 6c61  set_no_interpola
+00008a10: 7469 6f6e 2829 0d0a 2020 2020 2020 2020  tion()..        
+00008a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008a30: 2020 2020 5365 676d 656e 7461 7469 6f6e      Segmentation
+00008a40: 4564 6974 6f72 2e72 656e 6465 7265 722e  Editor.renderer.
+00008a50: 6662 6f31 2e74 6578 7475 7265 2e73 6574  fbo1.texture.set
+00008a60: 5f6e 6f5f 696e 7465 7270 6f6c 6174 696f  _no_interpolatio
+00008a70: 6e28 290d 0a20 2020 2020 2020 2020 2020  n()..           
+00008a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008a90: 2053 6567 6d65 6e74 6174 696f 6e45 6469   SegmentationEdi
+00008aa0: 746f 722e 7265 6e64 6572 6572 2e66 626f  tor.renderer.fbo
+00008ab0: 322e 7465 7874 7572 652e 7365 745f 6e6f  2.texture.set_no
+00008ac0: 5f69 6e74 6572 706f 6c61 7469 6f6e 2829  _interpolation()
+00008ad0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00008ae0: 2020 2020 2020 6966 2073 656c 662e 6163        if self.ac
+00008af0: 7469 7665 5f74 6162 2069 6e20 5b22 5365  tive_tab in ["Se
+00008b00: 676d 656e 7461 7469 6f6e 222c 2022 5265  gmentation", "Re
+00008b10: 6e64 6572 225d 3a0d 0a20 2020 2020 2020  nder"]:..       
+00008b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008b30: 2069 6d67 7569 2e70 7573 685f 7374 796c   imgui.push_styl
+00008b40: 655f 636f 6c6f 7228 696d 6775 692e 434f  e_color(imgui.CO
+00008b50: 4c4f 525f 5445 5854 2c20 2a63 6667 2e43  LOR_TEXT, *cfg.C
+00008b60: 4f4c 4f55 525f 5445 5854 5f44 4953 4142  OLOUR_TEXT_DISAB
+00008b70: 4c45 4429 0d0a 2020 2020 2020 2020 2020  LED)..          
+00008b80: 2020 2020 2020 2020 2020 2020 2020 696d                im
+00008b90: 6775 692e 7075 7368 5f73 7479 6c65 5f63  gui.push_style_c
+00008ba0: 6f6c 6f72 2869 6d67 7569 2e43 4f4c 4f52  olor(imgui.COLOR
+00008bb0: 5f43 4845 434b 5f4d 4152 4b2c 202a 6366  _CHECK_MARK, *cf
+00008bc0: 672e 434f 4c4f 5552 5f54 4558 545f 4449  g.COLOUR_TEXT_DI
+00008bd0: 5341 424c 4544 290d 0a20 2020 2020 2020  SABLED)..       
+00008be0: 2020 2020 2020 2020 2020 2020 205f 632c               _c,
+00008bf0: 2073 6566 2e63 726f 7020 3d20 696d 6775   sef.crop = imgu
+00008c00: 692e 6368 6563 6b62 6f78 2822 6372 6f70  i.checkbox("crop
+00008c10: 222c 2073 6566 2e63 726f 7029 0d0a 2020  ", sef.crop)..  
+00008c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008c30: 2020 6966 205f 6320 616e 6420 6e6f 7420    if _c and not 
+00008c40: 7365 662e 6372 6f70 3a0d 0a20 2020 2020  sef.crop:..     
+00008c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008c60: 2020 2073 6566 2e63 726f 705f 726f 6920     sef.crop_roi 
+00008c70: 3d20 5b30 2c20 302c 2073 6566 2e77 6964  = [0, 0, sef.wid
+00008c80: 7468 2c20 7365 662e 6865 6967 6874 5d0d  th, sef.height].
+00008c90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00008ca0: 2020 2020 2069 6620 7365 6c66 2e61 6374       if self.act
+00008cb0: 6976 655f 7461 6220 696e 205b 2253 6567  ive_tab in ["Seg
+00008cc0: 6d65 6e74 6174 696f 6e22 2c20 2252 656e  mentation", "Ren
+00008cd0: 6465 7222 5d3a 0d0a 2020 2020 2020 2020  der"]:..        
+00008ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008cf0: 696d 6775 692e 706f 705f 7374 796c 655f  imgui.pop_style_
+00008d00: 636f 6c6f 7228 3229 0d0a 2020 2020 2020  color(2)..      
+00008d10: 2020 2020 2020 2020 2020 2020 2020 696d                im
+00008d20: 6775 692e 7365 7061 7261 746f 7228 290d  gui.separator().
+00008d30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00008d40: 2020 2020 2066 6964 7820 3d20 300d 0a20       fidx = 0.. 
+00008d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008d60: 2020 2066 6f72 2066 7472 2069 6e20 7365     for ftr in se
+00008d70: 6c66 2e66 696c 7465 7273 3a0d 0a20 2020  lf.filters:..   
+00008d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008d90: 2020 2020 2066 6964 7820 2b3d 2031 0d0a       fidx += 1..
+00008da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008db0: 2020 2020 2020 2020 696d 6775 692e 7075          imgui.pu
+00008dc0: 7368 5f69 6428 6622 6669 6c74 6572 7b66  sh_id(f"filter{f
+00008dd0: 6964 787d 2229 0d0a 2020 2020 2020 2020  idx}")..        
+00008de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008df0: 6377 203d 2069 6d67 7569 2e67 6574 5f63  cw = imgui.get_c
+00008e00: 6f6e 7465 6e74 5f72 6567 696f 6e5f 6176  ontent_region_av
+00008e10: 6169 6c61 626c 655f 7769 6474 6828 290d  ailable_width().
+00008e20: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+00008e30: 2020 2020 2020 2020 2020 2023 2046 696c             # Fil
+00008e40: 7465 7220 7479 7065 2073 656c 6563 7469  ter type selecti
+00008e50: 6f6e 2063 6f6d 626f 0d0a 2020 2020 2020  on combo..      
+00008e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008e70: 2020 696d 6775 692e 7365 745f 6e65 7874    imgui.set_next
+00008e80: 5f69 7465 6d5f 7769 6474 6828 6377 202d  _item_width(cw -
+00008e90: 2036 3029 0d0a 2020 2020 2020 2020 2020   60)..          
+00008ea0: 2020 2020 2020 2020 2020 2020 2020 696d                im
+00008eb0: 6775 692e 7075 7368 5f73 7479 6c65 5f76  gui.push_style_v
+00008ec0: 6172 2869 6d67 7569 2e53 5459 4c45 5f46  ar(imgui.STYLE_F
+00008ed0: 5241 4d45 5f50 4144 4449 4e47 2c20 2835  RAME_PADDING, (5
+00008ee0: 2c20 3229 290d 0a20 2020 2020 2020 2020  , 2))..         
+00008ef0: 2020 2020 2020 2020 2020 2020 2020 205f                 _
+00008f00: 632c 2066 7472 7479 7065 203d 2069 6d67  c, ftrtype = img
+00008f10: 7569 2e63 6f6d 626f 2822 2323 6669 6c74  ui.combo("##filt
+00008f20: 6572 7479 7065 222c 2066 7472 2e74 7970  ertype", ftr.typ
+00008f30: 652c 2046 696c 7465 722e 5459 5045 5329  e, Filter.TYPES)
+00008f40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00008f50: 2020 2020 2020 2020 2020 6966 205f 633a            if _c:
+00008f60: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00008f70: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00008f80: 6c66 2e66 696c 7465 7273 5b73 656c 662e  lf.filters[self.
+00008f90: 6669 6c74 6572 732e 696e 6465 7828 6674  filters.index(ft
+00008fa0: 7229 5d20 3d20 4669 6c74 6572 2866 7472  r)] = Filter(ftr
+00008fb0: 7479 7065 290d 0a20 2020 2020 2020 2020  type)..         
+00008fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008fd0: 2020 2053 6567 6d65 6e74 6174 696f 6e45     SegmentationE
+00008fe0: 6469 746f 722e 4652 414d 455f 5445 5854  ditor.FRAME_TEXT
+00008ff0: 5552 455f 5245 5155 4952 4553 5f55 5044  URE_REQUIRES_UPD
+00009000: 4154 4520 7c3d 2054 7275 650d 0a20 2020  ATE |= True..   
+00009010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009020: 2020 2020 2069 6d67 7569 2e73 616d 655f       imgui.same_
+00009030: 6c69 6e65 2829 0d0a 2020 2020 2020 2020  line()..        
+00009040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009050: 5f2c 2066 7472 2e65 6e61 626c 6564 203d  _, ftr.enabled =
+00009060: 2069 6d67 7569 2e63 6865 636b 626f 7828   imgui.checkbox(
+00009070: 2223 2365 6e61 626c 6564 222c 2066 7472  "##enabled", ftr
+00009080: 2e65 6e61 626c 6564 290d 0a20 2020 2020  .enabled)..     
+00009090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000090a0: 2020 2069 6620 5f3a 0d0a 2020 2020 2020     if _:..      
+000090b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000090c0: 2020 2020 2020 5365 676d 656e 7461 7469        Segmentati
+000090d0: 6f6e 4564 6974 6f72 2e46 5241 4d45 5f54  onEditor.FRAME_T
+000090e0: 4558 5455 5245 5f52 4551 5549 5245 535f  EXTURE_REQUIRES_
+000090f0: 5550 4441 5445 207c 3d20 5472 7565 0d0a  UPDATE |= True..
+00009100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009110: 2020 2020 2020 2020 2320 4465 6c65 7465          # Delete
+00009120: 2062 7574 746f 6e0d 0a20 2020 2020 2020   button..       
+00009130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009140: 2069 6d67 7569 2e73 616d 655f 6c69 6e65   imgui.same_line
+00009150: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
+00009160: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00009170: 6d67 7569 2e69 6d61 6765 5f62 7574 746f  mgui.image_butto
+00009180: 6e28 7365 6c66 2e69 636f 6e5f 636c 6f73  n(self.icon_clos
+00009190: 652e 7265 6e64 6572 6572 5f69 642c 2031  e.renderer_id, 1
+000091a0: 332c 2031 3329 3a0d 0a20 2020 2020 2020  3, 13):..       
+000091b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000091c0: 2020 2020 2073 656c 662e 6669 6c74 6572       self.filter
+000091d0: 732e 7265 6d6f 7665 2866 7472 290d 0a20  s.remove(ftr).. 
 000091e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000091f0: 2053 6567 6d65 6e74 6174 696f 6e45 6469   SegmentationEdi
-00009200: 746f 722e 4652 414d 455f 5445 5854 5552  tor.FRAME_TEXTUR
-00009210: 455f 5245 5155 4952 4553 5f55 5044 4154  E_REQUIRES_UPDAT
-00009220: 4520 7c3d 2054 7275 650d 0a20 2020 2020  E |= True..     
-00009230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009240: 2020 2069 6d67 7569 2e70 6f70 5f73 7479     imgui.pop_sty
-00009250: 6c65 5f76 6172 2831 290d 0a20 2020 2020  le_var(1)..     
-00009260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009270: 2020 2023 2050 6172 616d 6574 6572 2061     # Parameter a
-00009280: 6e64 2073 7472 656e 6774 6820 736c 6964  nd strength slid
-00009290: 6572 730d 0a20 2020 2020 2020 2020 2020  ers..           
-000092a0: 2020 2020 2020 2020 2020 2020 2069 6d67               img
-000092b0: 7569 2e70 7573 685f 6974 656d 5f77 6964  ui.push_item_wid
-000092c0: 7468 2863 7729 0d0a 2020 2020 2020 2020  th(cw)..        
-000092d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000092e0: 6966 2046 696c 7465 722e 5041 5241 4d45  if Filter.PARAME
-000092f0: 5445 525f 4e41 4d45 5b66 7472 2e74 7970  TER_NAME[ftr.typ
-00009300: 655d 2069 7320 6e6f 7420 4e6f 6e65 3a0d  e] is not None:.
-00009310: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009320: 2020 2020 2020 2020 2020 2020 205f 632c               _c,
-00009330: 2066 7472 2e70 6172 616d 203d 2069 6d67   ftr.param = img
-00009340: 7569 2e73 6c69 6465 725f 666c 6f61 7428  ui.slider_float(
-00009350: 2223 2370 6172 616d 222c 2066 7472 2e70  "##param", ftr.p
-00009360: 6172 616d 2c20 302e 312c 2031 302e 302c  aram, 0.1, 10.0,
-00009370: 2066 6f72 6d61 743d 6622 7b46 696c 7465   format=f"{Filte
-00009380: 722e 5041 5241 4d45 5445 525f 4e41 4d45  r.PARAMETER_NAME
-00009390: 5b66 7472 2e74 7970 655d 7d3a 207b 6674  [ftr.type]}: {ft
-000093a0: 722e 7061 7261 6d3a 2e31 667d 2229 0d0a  r.param:.1f}")..
-000093b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000093c0: 2020 2020 2020 2020 2020 2020 6966 205f              if _
-000093d0: 633a 0d0a 2020 2020 2020 2020 2020 2020  c:..            
+000091f0: 2020 2020 2020 2020 2020 2053 6567 6d65             Segme
+00009200: 6e74 6174 696f 6e45 6469 746f 722e 4652  ntationEditor.FR
+00009210: 414d 455f 5445 5854 5552 455f 5245 5155  AME_TEXTURE_REQU
+00009220: 4952 4553 5f55 5044 4154 4520 7c3d 2054  IRES_UPDATE |= T
+00009230: 7275 650d 0a20 2020 2020 2020 2020 2020  rue..           
+00009240: 2020 2020 2020 2020 2020 2020 2069 6d67               img
+00009250: 7569 2e70 6f70 5f73 7479 6c65 5f76 6172  ui.pop_style_var
+00009260: 2831 290d 0a20 2020 2020 2020 2020 2020  (1)..           
+00009270: 2020 2020 2020 2020 2020 2020 2023 2050               # P
+00009280: 6172 616d 6574 6572 2061 6e64 2073 7472  arameter and str
+00009290: 656e 6774 6820 736c 6964 6572 730d 0a20  ength sliders.. 
+000092a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000092b0: 2020 2020 2020 2069 6d67 7569 2e70 7573         imgui.pus
+000092c0: 685f 6974 656d 5f77 6964 7468 2863 7729  h_item_width(cw)
+000092d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000092e0: 2020 2020 2020 2020 2020 6966 2046 696c            if Fil
+000092f0: 7465 722e 5041 5241 4d45 5445 525f 4e41  ter.PARAMETER_NA
+00009300: 4d45 5b66 7472 2e74 7970 655d 2069 7320  ME[ftr.type] is 
+00009310: 6e6f 7420 4e6f 6e65 3a0d 0a20 2020 2020  not None:..     
+00009320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009330: 2020 2020 2020 205f 632c 2066 7472 2e70         _c, ftr.p
+00009340: 6172 616d 203d 2069 6d67 7569 2e73 6c69  aram = imgui.sli
+00009350: 6465 725f 666c 6f61 7428 2223 2370 6172  der_float("##par
+00009360: 616d 222c 2066 7472 2e70 6172 616d 2c20  am", ftr.param, 
+00009370: 302e 312c 2031 302e 302c 2066 6f72 6d61  0.1, 10.0, forma
+00009380: 743d 6622 7b46 696c 7465 722e 5041 5241  t=f"{Filter.PARA
+00009390: 4d45 5445 525f 4e41 4d45 5b66 7472 2e74  METER_NAME[ftr.t
+000093a0: 7970 655d 7d3a 207b 6674 722e 7061 7261  ype]}: {ftr.para
+000093b0: 6d3a 2e31 667d 2229 0d0a 2020 2020 2020  m:.1f}")..      
+000093c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000093d0: 2020 2020 2020 6966 205f 633a 0d0a 2020        if _c:..  
 000093e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000093f0: 2020 2020 6674 722e 6669 6c6c 5f6b 6572      ftr.fill_ker
-00009400: 6e65 6c28 290d 0a20 2020 2020 2020 2020  nel()..         
-00009410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009420: 2020 2020 2020 2053 6567 6d65 6e74 6174         Segmentat
-00009430: 696f 6e45 6469 746f 722e 4652 414d 455f  ionEditor.FRAME_
-00009440: 5445 5854 5552 455f 5245 5155 4952 4553  TEXTURE_REQUIRES
-00009450: 5f55 5044 4154 4520 7c3d 2054 7275 650d  _UPDATE |= True.
-00009460: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009470: 2020 2020 2020 2020 205f 2c20 6674 722e           _, ftr.
-00009480: 7374 7265 6e67 7468 203d 2069 6d67 7569  strength = imgui
-00009490: 2e73 6c69 6465 725f 666c 6f61 7428 2223  .slider_float("#
-000094a0: 2373 7472 656e 6774 6822 2c20 6674 722e  #strength", ftr.
-000094b0: 7374 7265 6e67 7468 2c20 2d31 2e30 2c20  strength, -1.0, 
-000094c0: 312e 302c 2066 6f72 6d61 743d 6622 7765  1.0, format=f"we
-000094d0: 6967 6874 3a20 7b66 7472 2e73 7472 656e  ight: {ftr.stren
-000094e0: 6774 683a 2e32 667d 2229 0d0a 2020 2020  gth:.2f}")..    
-000094f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009500: 2020 2020 6966 205f 3a0d 0a20 2020 2020      if _:..     
-00009510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009520: 2020 2020 2020 2053 6567 6d65 6e74 6174         Segmentat
-00009530: 696f 6e45 6469 746f 722e 4652 414d 455f  ionEditor.FRAME_
-00009540: 5445 5854 5552 455f 5245 5155 4952 4553  TEXTURE_REQUIRES
-00009550: 5f55 5044 4154 4520 7c3d 2054 7275 650d  _UPDATE |= True.
-00009560: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009570: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
-00009580: 6f70 5f69 7465 6d5f 7769 6474 6828 290d  op_item_width().
-00009590: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
-000095a0: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
-000095b0: 2e70 6f70 5f69 6428 290d 0a20 2020 2020  .pop_id()..     
-000095c0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000095d0: 6d67 7569 2e73 6574 5f6e 6578 745f 6974  mgui.set_next_it
-000095e0: 656d 5f77 6964 7468 2869 6d67 7569 2e67  em_width(imgui.g
-000095f0: 6574 5f63 6f6e 7465 6e74 5f72 6567 696f  et_content_regio
-00009600: 6e5f 6176 6169 6c61 626c 655f 7769 6474  n_available_widt
-00009610: 6828 2929 0d0a 2020 2020 2020 2020 2020  h())..          
-00009620: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
-00009630: 7075 7368 5f73 7479 6c65 5f76 6172 2869  push_style_var(i
-00009640: 6d67 7569 2e53 5459 4c45 5f46 5241 4d45  mgui.STYLE_FRAME
-00009650: 5f50 4144 4449 4e47 2c20 2835 2c20 3229  _PADDING, (5, 2)
-00009660: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00009670: 2020 2020 2020 205f 632c 206e 6577 5f66         _c, new_f
-00009680: 696c 7465 725f 7479 7065 203d 2069 6d67  ilter_type = img
-00009690: 7569 2e63 6f6d 626f 2822 2323 6669 6c74  ui.combo("##filt
-000096a0: 6572 7479 7065 222c 2030 2c20 5b22 4164  ertype", 0, ["Ad
-000096b0: 6420 6669 6c74 6572 225d 202b 2046 696c  d filter"] + Fil
-000096c0: 7465 722e 5459 5045 5329 0d0a 2020 2020  ter.TYPES)..    
-000096d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000096e0: 6966 205f 6320 616e 6420 6e6f 7420 6e65  if _c and not ne
-000096f0: 775f 6669 6c74 6572 5f74 7970 6520 3d3d  w_filter_type ==
-00009700: 2030 3a0d 0a20 2020 2020 2020 2020 2020   0:..           
-00009710: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00009720: 662e 6669 6c74 6572 732e 6170 7065 6e64  f.filters.append
-00009730: 2846 696c 7465 7228 6e65 775f 6669 6c74  (Filter(new_filt
-00009740: 6572 5f74 7970 6520 2d20 3129 290d 0a20  er_type - 1)).. 
-00009750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009760: 2020 2020 2020 2053 6567 6d65 6e74 6174         Segmentat
-00009770: 696f 6e45 6469 746f 722e 4652 414d 455f  ionEditor.FRAME_
-00009780: 5445 5854 5552 455f 5245 5155 4952 4553  TEXTURE_REQUIRES
-00009790: 5f55 5044 4154 4520 7c3d 2054 7275 650d  _UPDATE |= True.
-000097a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000097b0: 2020 2020 2069 6620 6366 672e 7365 5f61       if cfg.se_a
-000097c0: 6374 6976 655f 6672 616d 652e 6f76 6572  ctive_frame.over
-000097d0: 6c61 7920 6973 206e 6f74 204e 6f6e 653a  lay is not None:
-000097e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000097f0: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
-00009800: 7365 7061 7261 746f 7228 290d 0a20 2020  separator()..   
-00009810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009820: 2020 2020 2063 7720 3d20 696d 6775 692e       cw = imgui.
-00009830: 6765 745f 636f 6e74 656e 745f 7265 6769  get_content_regi
-00009840: 6f6e 5f61 7661 696c 6162 6c65 5f77 6964  on_available_wid
-00009850: 7468 2829 0d0a 2020 2020 2020 2020 2020  th()..          
-00009860: 2020 2020 2020 2020 2020 2020 2020 696d                im
-00009870: 6775 692e 7365 745f 6e65 7874 5f69 7465  gui.set_next_ite
-00009880: 6d5f 7769 6474 6828 6377 202d 2031 3230  m_width(cw - 120
-00009890: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-000098a0: 2020 2020 2020 2020 2020 205f 2c20 5365             _, Se
-000098b0: 676d 656e 7461 7469 6f6e 4564 6974 6f72  gmentationEditor
-000098c0: 2e4f 5645 524c 4159 5f41 4c50 4841 203d  .OVERLAY_ALPHA =
-000098d0: 2069 6d67 7569 2e73 6c69 6465 725f 666c   imgui.slider_fl
-000098e0: 6f61 7428 2223 2361 6c70 6861 736c 6964  oat("##alphaslid
-000098f0: 6572 5f73 6522 2c20 5365 676d 656e 7461  er_se", Segmenta
-00009900: 7469 6f6e 4564 6974 6f72 2e4f 5645 524c  tionEditor.OVERL
-00009910: 4159 5f41 4c50 4841 2c20 302e 302c 2031  AY_ALPHA, 0.0, 1
-00009920: 2e30 2c20 666f 726d 6174 3d66 226f 7665  .0, format=f"ove
-00009930: 726c 6179 2061 6c70 6861 203d 207b 5365  rlay alpha = {Se
-00009940: 676d 656e 7461 7469 6f6e 4564 6974 6f72  gmentationEditor
-00009950: 2e4f 5645 524c 4159 5f41 4c50 4841 3a2e  .OVERLAY_ALPHA:.
-00009960: 3266 7d22 290d 0a20 2020 2020 2020 2020  2f}")..         
-00009970: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00009980: 6d67 7569 2e73 616d 655f 6c69 6e65 2829  mgui.same_line()
-00009990: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000099a0: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
-000099b0: 7365 745f 6e65 7874 5f69 7465 6d5f 7769  set_next_item_wi
-000099c0: 6474 6828 3131 3029 0d0a 2020 2020 2020  dth(110)..      
-000099d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000099e0: 2020 6966 2073 656c 662e 6163 7469 7665    if self.active
-000099f0: 5f74 6162 2021 3d20 2252 656e 6465 7222  _tab != "Render"
-00009a00: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00009a10: 2020 2020 2020 2020 2020 2020 2020 205f                 _
-00009a20: 2c20 5365 676d 656e 7461 7469 6f6e 4564  , SegmentationEd
-00009a30: 6974 6f72 2e4f 5645 524c 4159 5f42 4c45  itor.OVERLAY_BLE
-00009a40: 4e44 5f4d 4f44 4520 3d20 696d 6775 692e  ND_MODE = imgui.
-00009a50: 636f 6d62 6f28 2223 236f 7665 726c 6179  combo("##overlay
-00009a60: 626c 656e 6469 6e67 222c 2053 6567 6d65  blending", Segme
-00009a70: 6e74 6174 696f 6e45 6469 746f 722e 4f56  ntationEditor.OV
-00009a80: 4552 4c41 595f 424c 454e 445f 4d4f 4445  ERLAY_BLEND_MODE
-00009a90: 2c20 5365 676d 656e 7461 7469 6f6e 4564  , SegmentationEd
-00009aa0: 6974 6f72 2e42 4c45 4e44 5f4d 4f44 4553  itor.BLEND_MODES
-00009ab0: 5f4c 4953 5429 0d0a 2020 2020 2020 2020  _LIST)..        
-00009ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009ad0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-00009ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009af0: 2020 2069 6620 7365 6c66 2e70 6963 6b5f     if self.pick_
-00009b00: 6f76 6572 6c61 795f 3364 3a0d 0a20 2020  overlay_3d:..   
-00009b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009b20: 2020 2020 2020 2020 2020 2020 205f 2c20               _, 
-00009b30: 5365 676d 656e 7461 7469 6f6e 4564 6974  SegmentationEdit
-00009b40: 6f72 2e4f 5645 524c 4159 5f42 4c45 4e44  or.OVERLAY_BLEND
-00009b50: 5f4d 4f44 455f 3344 203d 2069 6d67 7569  _MODE_3D = imgui
-00009b60: 2e63 6f6d 626f 2822 2323 6f76 6572 6c61  .combo("##overla
-00009b70: 7962 6c65 6e64 696e 6722 2c20 5365 676d  yblending", Segm
-00009b80: 656e 7461 7469 6f6e 4564 6974 6f72 2e4f  entationEditor.O
-00009b90: 5645 524c 4159 5f42 4c45 4e44 5f4d 4f44  VERLAY_BLEND_MOD
-00009ba0: 455f 3344 2c20 5365 676d 656e 7461 7469  E_3D, Segmentati
-00009bb0: 6f6e 4564 6974 6f72 2e42 4c45 4e44 5f4d  onEditor.BLEND_M
-00009bc0: 4f44 4553 5f4c 4953 545f 3344 290d 0a20  ODES_LIST_3D).. 
-00009bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009be0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00009bf0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000093f0: 2020 2020 2020 2020 2020 2020 2020 6674                ft
+00009400: 722e 6669 6c6c 5f6b 6572 6e65 6c28 290d  r.fill_kernel().
+00009410: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009430: 2053 6567 6d65 6e74 6174 696f 6e45 6469   SegmentationEdi
+00009440: 746f 722e 4652 414d 455f 5445 5854 5552  tor.FRAME_TEXTUR
+00009450: 455f 5245 5155 4952 4553 5f55 5044 4154  E_REQUIRES_UPDAT
+00009460: 4520 7c3d 2054 7275 650d 0a20 2020 2020  E |= True..     
+00009470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009480: 2020 205f 2c20 6674 722e 7374 7265 6e67     _, ftr.streng
+00009490: 7468 203d 2069 6d67 7569 2e73 6c69 6465  th = imgui.slide
+000094a0: 725f 666c 6f61 7428 2223 2373 7472 656e  r_float("##stren
+000094b0: 6774 6822 2c20 6674 722e 7374 7265 6e67  gth", ftr.streng
+000094c0: 7468 2c20 2d31 2e30 2c20 312e 302c 2066  th, -1.0, 1.0, f
+000094d0: 6f72 6d61 743d 6622 7765 6967 6874 3a20  ormat=f"weight: 
+000094e0: 7b66 7472 2e73 7472 656e 6774 683a 2e32  {ftr.strength:.2
+000094f0: 667d 2229 0d0a 2020 2020 2020 2020 2020  f}")..          
+00009500: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00009510: 205f 3a0d 0a20 2020 2020 2020 2020 2020   _:..           
+00009520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009530: 2053 6567 6d65 6e74 6174 696f 6e45 6469   SegmentationEdi
+00009540: 746f 722e 4652 414d 455f 5445 5854 5552  tor.FRAME_TEXTUR
+00009550: 455f 5245 5155 4952 4553 5f55 5044 4154  E_REQUIRES_UPDAT
+00009560: 4520 7c3d 2054 7275 650d 0a20 2020 2020  E |= True..     
+00009570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009580: 2020 2069 6d67 7569 2e70 6f70 5f69 7465     imgui.pop_ite
+00009590: 6d5f 7769 6474 6828 290d 0a0d 0a20 2020  m_width()....   
+000095a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000095b0: 2020 2020 2069 6d67 7569 2e70 6f70 5f69       imgui.pop_i
+000095c0: 6428 290d 0a20 2020 2020 2020 2020 2020  d()..           
+000095d0: 2020 2020 2020 2020 2069 6d67 7569 2e73           imgui.s
+000095e0: 6574 5f6e 6578 745f 6974 656d 5f77 6964  et_next_item_wid
+000095f0: 7468 2869 6d67 7569 2e67 6574 5f63 6f6e  th(imgui.get_con
+00009600: 7465 6e74 5f72 6567 696f 6e5f 6176 6169  tent_region_avai
+00009610: 6c61 626c 655f 7769 6474 6828 2929 0d0a  lable_width())..
+00009620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009630: 2020 2020 696d 6775 692e 7075 7368 5f73      imgui.push_s
+00009640: 7479 6c65 5f76 6172 2869 6d67 7569 2e53  tyle_var(imgui.S
+00009650: 5459 4c45 5f46 5241 4d45 5f50 4144 4449  TYLE_FRAME_PADDI
+00009660: 4e47 2c20 2835 2c20 3229 290d 0a20 2020  NG, (5, 2))..   
+00009670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009680: 205f 632c 206e 6577 5f66 696c 7465 725f   _c, new_filter_
+00009690: 7479 7065 203d 2069 6d67 7569 2e63 6f6d  type = imgui.com
+000096a0: 626f 2822 2323 6669 6c74 6572 7479 7065  bo("##filtertype
+000096b0: 222c 2030 2c20 5b22 4164 6420 6669 6c74  ", 0, ["Add filt
+000096c0: 6572 225d 202b 2046 696c 7465 722e 5459  er"] + Filter.TY
+000096d0: 5045 5329 0d0a 2020 2020 2020 2020 2020  PES)..          
+000096e0: 2020 2020 2020 2020 2020 6966 205f 6320            if _c 
+000096f0: 616e 6420 6e6f 7420 6e65 775f 6669 6c74  and not new_filt
+00009700: 6572 5f74 7970 6520 3d3d 2030 3a0d 0a20  er_type == 0:.. 
+00009710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009720: 2020 2020 2020 2073 656c 662e 6669 6c74         self.filt
+00009730: 6572 732e 6170 7065 6e64 2846 696c 7465  ers.append(Filte
+00009740: 7228 6e65 775f 6669 6c74 6572 5f74 7970  r(new_filter_typ
+00009750: 6520 2d20 3129 290d 0a20 2020 2020 2020  e - 1))..       
+00009760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009770: 2053 6567 6d65 6e74 6174 696f 6e45 6469   SegmentationEdi
+00009780: 746f 722e 4652 414d 455f 5445 5854 5552  tor.FRAME_TEXTUR
+00009790: 455f 5245 5155 4952 4553 5f55 5044 4154  E_REQUIRES_UPDAT
+000097a0: 4520 7c3d 2054 7275 650d 0a20 2020 2020  E |= True..     
+000097b0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000097c0: 6620 6366 672e 7365 5f61 6374 6976 655f  f cfg.se_active_
+000097d0: 6672 616d 652e 6f76 6572 6c61 7920 6973  frame.overlay is
+000097e0: 206e 6f74 204e 6f6e 653a 0d0a 2020 2020   not None:..    
+000097f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009800: 2020 2020 696d 6775 692e 7365 7061 7261      imgui.separa
+00009810: 746f 7228 290d 0a20 2020 2020 2020 2020  tor()..         
+00009820: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00009830: 7720 3d20 696d 6775 692e 6765 745f 636f  w = imgui.get_co
+00009840: 6e74 656e 745f 7265 6769 6f6e 5f61 7661  ntent_region_ava
+00009850: 696c 6162 6c65 5f77 6964 7468 2829 0d0a  ilable_width()..
+00009860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009870: 2020 2020 2020 2020 696d 6775 692e 7365          imgui.se
+00009880: 745f 6e65 7874 5f69 7465 6d5f 7769 6474  t_next_item_widt
+00009890: 6828 6377 202d 2031 3230 290d 0a20 2020  h(cw - 120)..   
+000098a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000098b0: 2020 2020 205f 2c20 5365 676d 656e 7461       _, Segmenta
+000098c0: 7469 6f6e 4564 6974 6f72 2e4f 5645 524c  tionEditor.OVERL
+000098d0: 4159 5f41 4c50 4841 203d 2069 6d67 7569  AY_ALPHA = imgui
+000098e0: 2e73 6c69 6465 725f 666c 6f61 7428 2223  .slider_float("#
+000098f0: 2361 6c70 6861 736c 6964 6572 5f73 6522  #alphaslider_se"
+00009900: 2c20 5365 676d 656e 7461 7469 6f6e 4564  , SegmentationEd
+00009910: 6974 6f72 2e4f 5645 524c 4159 5f41 4c50  itor.OVERLAY_ALP
+00009920: 4841 2c20 302e 302c 2031 2e30 2c20 666f  HA, 0.0, 1.0, fo
+00009930: 726d 6174 3d66 226f 7665 726c 6179 2061  rmat=f"overlay a
+00009940: 6c70 6861 203d 207b 5365 676d 656e 7461  lpha = {Segmenta
+00009950: 7469 6f6e 4564 6974 6f72 2e4f 5645 524c  tionEditor.OVERL
+00009960: 4159 5f41 4c50 4841 3a2e 3266 7d22 290d  AY_ALPHA:.2f}").
+00009970: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009980: 2020 2020 2020 2020 2069 6d67 7569 2e73           imgui.s
+00009990: 616d 655f 6c69 6e65 2829 0d0a 2020 2020  ame_line()..    
+000099a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000099b0: 2020 2020 696d 6775 692e 7365 745f 6e65      imgui.set_ne
+000099c0: 7874 5f69 7465 6d5f 7769 6474 6828 3131  xt_item_width(11
+000099d0: 3029 0d0a 2020 2020 2020 2020 2020 2020  0)..            
+000099e0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+000099f0: 656c 662e 6163 7469 7665 5f74 6162 2021  elf.active_tab !
+00009a00: 3d20 2252 656e 6465 7222 3a0d 0a20 2020  = "Render":..   
+00009a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009a20: 2020 2020 2020 2020 205f 2c20 5365 676d           _, Segm
+00009a30: 656e 7461 7469 6f6e 4564 6974 6f72 2e4f  entationEditor.O
+00009a40: 5645 524c 4159 5f42 4c45 4e44 5f4d 4f44  VERLAY_BLEND_MOD
+00009a50: 4520 3d20 696d 6775 692e 636f 6d62 6f28  E = imgui.combo(
+00009a60: 2223 236f 7665 726c 6179 626c 656e 6469  "##overlayblendi
+00009a70: 6e67 222c 2053 6567 6d65 6e74 6174 696f  ng", Segmentatio
+00009a80: 6e45 6469 746f 722e 4f56 4552 4c41 595f  nEditor.OVERLAY_
+00009a90: 424c 454e 445f 4d4f 4445 2c20 5365 676d  BLEND_MODE, Segm
+00009aa0: 656e 7461 7469 6f6e 4564 6974 6f72 2e42  entationEditor.B
+00009ab0: 4c45 4e44 5f4d 4f44 4553 5f4c 4953 5429  LEND_MODES_LIST)
+00009ac0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00009ad0: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
+00009ae0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009af0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00009b00: 7365 6c66 2e70 6963 6b5f 6f76 6572 6c61  self.pick_overla
+00009b10: 795f 3364 3a0d 0a20 2020 2020 2020 2020  y_3d:..         
+00009b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009b30: 2020 2020 2020 205f 2c20 5365 676d 656e         _, Segmen
+00009b40: 7461 7469 6f6e 4564 6974 6f72 2e4f 5645  tationEditor.OVE
+00009b50: 524c 4159 5f42 4c45 4e44 5f4d 4f44 455f  RLAY_BLEND_MODE_
+00009b60: 3344 203d 2069 6d67 7569 2e63 6f6d 626f  3D = imgui.combo
+00009b70: 2822 2323 6f76 6572 6c61 7962 6c65 6e64  ("##overlayblend
+00009b80: 696e 6722 2c20 5365 676d 656e 7461 7469  ing", Segmentati
+00009b90: 6f6e 4564 6974 6f72 2e4f 5645 524c 4159  onEditor.OVERLAY
+00009ba0: 5f42 4c45 4e44 5f4d 4f44 455f 3344 2c20  _BLEND_MODE_3D, 
+00009bb0: 5365 676d 656e 7461 7469 6f6e 4564 6974  SegmentationEdit
+00009bc0: 6f72 2e42 4c45 4e44 5f4d 4f44 4553 5f4c  or.BLEND_MODES_L
+00009bd0: 4953 545f 3344 290d 0a20 2020 2020 2020  IST_3D)..       
+00009be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009bf0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
 00009c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009c10: 2020 5f2c 2053 6567 6d65 6e74 6174 696f    _, Segmentatio
-00009c20: 6e45 6469 746f 722e 4f56 4552 4c41 595f  nEditor.OVERLAY_
-00009c30: 424c 454e 445f 4d4f 4445 203d 2069 6d67  BLEND_MODE = img
-00009c40: 7569 2e63 6f6d 626f 2822 2323 6f76 6572  ui.combo("##over
-00009c50: 6c61 7962 6c65 6e64 696e 6722 2c20 5365  layblending", Se
-00009c60: 676d 656e 7461 7469 6f6e 4564 6974 6f72  gmentationEditor
-00009c70: 2e4f 5645 524c 4159 5f42 4c45 4e44 5f4d  .OVERLAY_BLEND_M
-00009c80: 4f44 452c 2053 6567 6d65 6e74 6174 696f  ODE, Segmentatio
-00009c90: 6e45 6469 746f 722e 424c 454e 445f 4d4f  nEditor.BLEND_MO
-00009ca0: 4445 535f 4c49 5354 290d 0a20 2020 2020  DES_LIST)..     
-00009cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009cc0: 2020 2020 2020 2053 6567 6d65 6e74 6174         Segmentat
-00009cd0: 696f 6e45 6469 746f 722e 5649 4557 5f52  ionEditor.VIEW_R
-00009ce0: 4551 5549 5245 535f 5550 4441 5445 207c  EQUIRES_UPDATE |
-00009cf0: 3d20 5f0d 0a20 2020 2020 2020 2020 2020  = _..           
+00009c10: 2020 2020 2020 2020 2020 2020 5f2c 2053              _, S
+00009c20: 6567 6d65 6e74 6174 696f 6e45 6469 746f  egmentationEdito
+00009c30: 722e 4f56 4552 4c41 595f 424c 454e 445f  r.OVERLAY_BLEND_
+00009c40: 4d4f 4445 203d 2069 6d67 7569 2e63 6f6d  MODE = imgui.com
+00009c50: 626f 2822 2323 6f76 6572 6c61 7962 6c65  bo("##overlayble
+00009c60: 6e64 696e 6722 2c20 5365 676d 656e 7461  nding", Segmenta
+00009c70: 7469 6f6e 4564 6974 6f72 2e4f 5645 524c  tionEditor.OVERL
+00009c80: 4159 5f42 4c45 4e44 5f4d 4f44 452c 2053  AY_BLEND_MODE, S
+00009c90: 6567 6d65 6e74 6174 696f 6e45 6469 746f  egmentationEdito
+00009ca0: 722e 424c 454e 445f 4d4f 4445 535f 4c49  r.BLEND_MODES_LI
+00009cb0: 5354 290d 0a20 2020 2020 2020 2020 2020  ST)..           
+00009cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009cd0: 2053 6567 6d65 6e74 6174 696f 6e45 6469   SegmentationEdi
+00009ce0: 746f 722e 5649 4557 5f52 4551 5549 5245  tor.VIEW_REQUIRE
+00009cf0: 535f 5550 4441 5445 207c 3d20 5f0d 0a20  S_UPDATE |= _.. 
 00009d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009d10: 2069 6d67 7569 2e70 7573 685f 7374 796c   imgui.push_styl
-00009d20: 655f 7661 7228 696d 6775 692e 5354 594c  e_var(imgui.STYL
-00009d30: 455f 4652 414d 455f 5041 4444 494e 472c  E_FRAME_PADDING,
-00009d40: 2028 302c 2030 2929 0d0a 2020 2020 2020   (0, 0))..      
-00009d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009d60: 2020 2020 2020 5f2c 2073 656c 662e 7069        _, self.pi
-00009d70: 636b 5f6f 7665 726c 6179 5f33 6420 3d20  ck_overlay_3d = 
-00009d80: 696d 6775 692e 6368 6563 6b62 6f78 2822  imgui.checkbox("
-00009d90: 3344 222c 2073 656c 662e 7069 636b 5f6f  3D", self.pick_o
-00009da0: 7665 726c 6179 5f33 6429 0d0a 2020 2020  verlay_3d)..    
-00009db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009dc0: 2020 2020 2020 2020 696d 6775 692e 706f          imgui.po
-00009dd0: 705f 7374 796c 655f 7661 7228 290d 0a20  p_style_var().. 
-00009de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009df0: 2020 2020 2020 2020 2020 2053 6567 6d65             Segme
-00009e00: 6e74 6174 696f 6e45 6469 746f 722e 5649  ntationEditor.VI
-00009e10: 4557 5f52 4551 5549 5245 535f 5550 4441  EW_REQUIRES_UPDA
-00009e20: 5445 207c 3d20 5f0d 0a20 2020 2020 2020  TE |= _..       
-00009e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009e40: 2020 2020 2069 6d67 7569 2e73 616d 655f       imgui.same_
-00009e50: 6c69 6e65 2829 0d0a 2020 2020 2020 2020  line()..        
-00009e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009e70: 2020 2020 696d 6775 692e 7365 745f 6e65      imgui.set_ne
-00009e80: 7874 5f69 7465 6d5f 7769 6474 6828 696d  xt_item_width(im
-00009e90: 6775 692e 6765 745f 636f 6e74 656e 745f  gui.get_content_
-00009ea0: 7265 6769 6f6e 5f61 7661 696c 6162 6c65  region_available
-00009eb0: 5f77 6964 7468 2829 290d 0a20 2020 2020  _width())..     
-00009ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009ed0: 2020 2020 2020 205f 2c20 5365 676d 656e         _, Segmen
-00009ee0: 7461 7469 6f6e 4564 6974 6f72 2e4f 5645  tationEditor.OVE
-00009ef0: 524c 4159 5f49 4e54 454e 5349 5459 203d  RLAY_INTENSITY =
-00009f00: 2069 6d67 7569 2e73 6c69 6465 725f 666c   imgui.slider_fl
-00009f10: 6f61 7428 2223 2369 6e65 6e73 6974 7973  oat("##inensitys
-00009f20: 6c69 6465 725f 7365 222c 2053 6567 6d65  lider_se", Segme
-00009f30: 6e74 6174 696f 6e45 6469 746f 722e 4f56  ntationEditor.OV
-00009f40: 4552 4c41 595f 494e 5445 4e53 4954 592c  ERLAY_INTENSITY,
-00009f50: 2030 2e30 2c20 3130 2e30 2c20 666f 726d   0.0, 10.0, form
-00009f60: 6174 3d66 226f 7665 726c 6179 2069 6e74  at=f"overlay int
-00009f70: 656e 7369 7479 203d 207b 5365 676d 656e  ensity = {Segmen
-00009f80: 7461 7469 6f6e 4564 6974 6f72 2e4f 5645  tationEditor.OVE
-00009f90: 524c 4159 5f49 4e54 454e 5349 5459 3a2e  RLAY_INTENSITY:.
-00009fa0: 3166 7d22 290d 0a20 2020 2020 2020 2020  1f}")..         
-00009fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009fc0: 2020 2053 6567 6d65 6e74 6174 696f 6e45     SegmentationE
-00009fd0: 6469 746f 722e 5649 4557 5f52 4551 5549  ditor.VIEW_REQUI
-00009fe0: 5245 535f 5550 4441 5445 207c 3d20 5f0d  RES_UPDATE |= _.
-00009ff0: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
-0000a000: 2020 2020 2020 2069 6d67 7569 2e70 6f70         imgui.pop
-0000a010: 5f73 7479 6c65 5f76 6172 2836 290d 0a20  _style_var(6).. 
-0000a020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a030: 2020 2069 6d67 7569 2e70 6f70 5f73 7479     imgui.pop_sty
-0000a040: 6c65 5f63 6f6c 6f72 2831 290d 0a0d 0a20  le_color(1).... 
-0000a050: 2020 2020 2020 2064 6566 2073 6567 6d65         def segme
-0000a060: 6e74 6174 696f 6e5f 7461 6228 293a 0d0a  ntation_tab():..
-0000a070: 0d0a 2020 2020 2020 2020 2020 2020 6465  ..            de
-0000a080: 6620 6665 6174 7572 6573 5f70 616e 656c  f features_panel
-0000a090: 2829 3a0d 0a20 2020 2020 2020 2020 2020  ():..           
-0000a0a0: 2020 2020 2069 6620 696d 6775 692e 636f       if imgui.co
-0000a0b0: 6c6c 6170 7369 6e67 5f68 6561 6465 7228  llapsing_header(
-0000a0c0: 2246 6561 7475 7265 7322 2c20 4e6f 6e65  "Features", None
-0000a0d0: 2c20 696d 6775 692e 5452 4545 5f4e 4f44  , imgui.TREE_NOD
-0000a0e0: 455f 4445 4641 554c 545f 4f50 454e 295b  E_DEFAULT_OPEN)[
-0000a0f0: 305d 3a0d 0a20 2020 2020 2020 2020 2020  0]:..           
-0000a100: 2020 2020 2020 2020 2069 6620 6366 672e           if cfg.
-0000a110: 7365 5f61 6374 6976 655f 6672 616d 6520  se_active_frame 
-0000a120: 6973 204e 6f6e 653a 0d0a 2020 2020 2020  is None:..      
-0000a130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a140: 2020 7265 7475 726e 0d0a 2020 2020 2020    return..      
-0000a150: 2020 2020 2020 2020 2020 2020 2020 6665                fe
-0000a160: 6174 7572 6573 203d 2063 6667 2e73 655f  atures = cfg.se_
-0000a170: 6163 7469 7665 5f66 7261 6d65 2e66 6561  active_frame.fea
-0000a180: 7475 7265 730d 0a20 2020 2020 2020 2020  tures..         
-0000a190: 2020 2020 2020 2020 2020 2066 6f72 2066             for f
-0000a1a0: 2069 6e20 6665 6174 7572 6573 3a0d 0a20   in features:.. 
-0000a1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a1c0: 2020 2020 2020 2070 6f70 5f61 6374 6976         pop_activ
-0000a1d0: 655f 636f 6c6f 7572 203d 2046 616c 7365  e_colour = False
-0000a1e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000a1f0: 2020 2020 2020 2020 2020 6966 2063 6667            if cfg
-0000a200: 2e73 655f 6163 7469 7665 5f66 7261 6d65  .se_active_frame
-0000a210: 2e61 6374 6976 655f 6665 6174 7572 6520  .active_feature 
-0000a220: 3d3d 2066 3a0d 0a20 2020 2020 2020 2020  == f:..         
-0000a230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a240: 2020 2069 6d67 7569 2e70 7573 685f 7374     imgui.push_st
-0000a250: 796c 655f 636f 6c6f 7228 696d 6775 692e  yle_color(imgui.
-0000a260: 434f 4c4f 525f 4348 494c 445f 4241 434b  COLOR_CHILD_BACK
-0000a270: 4752 4f55 4e44 2c20 2a63 6667 2e43 4f4c  GROUND, *cfg.COL
-0000a280: 4f55 525f 4652 414d 455f 4143 5449 5645  OUR_FRAME_ACTIVE
-0000a290: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0000a2a0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0000a2b0: 6f70 5f61 6374 6976 655f 636f 6c6f 7572  op_active_colour
-0000a2c0: 203d 2054 7275 650d 0a20 2020 2020 2020   = True..       
-0000a2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a2e0: 2069 6d67 7569 2e62 6567 696e 5f63 6869   imgui.begin_chi
-0000a2f0: 6c64 2866 2223 2366 6561 745f 7b66 2e75  ld(f"##feat_{f.u
-0000a300: 6964 7d22 2c20 302e 302c 2053 6567 6d65  id}", 0.0, Segme
-0000a310: 6e74 6174 696f 6e45 6469 746f 722e 4645  ntationEditor.FE
-0000a320: 4154 5552 455f 5041 4e45 4c5f 4845 4947  ATURE_PANEL_HEIG
-0000a330: 4854 202b 2031 3620 2a20 662e 6d61 6769  HT + 16 * f.magi
-0000a340: 632c 2054 7275 6529 0d0a 2020 2020 2020  c, True)..      
-0000a350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a360: 2020 6377 203d 2069 6d67 7569 2e67 6574    cw = imgui.get
-0000a370: 5f63 6f6e 7465 6e74 5f72 6567 696f 6e5f  _content_region_
-0000a380: 6176 6169 6c61 626c 655f 7769 6474 6828  available_width(
-0000a390: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
-0000a3a0: 2020 2020 2020 2020 2020 2020 2023 2043               # C
-0000a3b0: 6f6c 6f75 7220 7069 636b 6572 0d0a 2020  olour picker..  
-0000a3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a3d0: 2020 2020 2020 5f2c 2066 2e63 6f6c 6f75        _, f.colou
-0000a3e0: 7220 3d20 696d 6775 692e 636f 6c6f 725f  r = imgui.color_
-0000a3f0: 6564 6974 3328 662e 7469 746c 652c 202a  edit3(f.title, *
-0000a400: 662e 636f 6c6f 7572 5b3a 335d 2c20 696d  f.colour[:3], im
-0000a410: 6775 692e 434f 4c4f 525f 4544 4954 5f4e  gui.COLOR_EDIT_N
-0000a420: 4f5f 494e 5055 5453 207c 2069 6d67 7569  O_INPUTS | imgui
-0000a430: 2e43 4f4c 4f52 5f45 4449 545f 4e4f 5f4c  .COLOR_EDIT_NO_L
-0000a440: 4142 454c 207c 2069 6d67 7569 2e43 4f4c  ABEL | imgui.COL
-0000a450: 4f52 5f45 4449 545f 4e4f 5f54 4f4f 4c54  OR_EDIT_NO_TOOLT
-0000a460: 4950 207c 2069 6d67 7569 2e43 4f4c 4f52  IP | imgui.COLOR
-0000a470: 5f45 4449 545f 4e4f 5f44 5241 475f 4452  _EDIT_NO_DRAG_DR
-0000a480: 4f50 290d 0a20 2020 2020 2020 2020 2020  OP)..           
-0000a490: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0000a4a0: 5f3a 0d0a 2020 2020 2020 2020 2020 2020  _:..            
+00009d10: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
+00009d20: 2e70 7573 685f 7374 796c 655f 7661 7228  .push_style_var(
+00009d30: 696d 6775 692e 5354 594c 455f 4652 414d  imgui.STYLE_FRAM
+00009d40: 455f 5041 4444 494e 472c 2028 302c 2030  E_PADDING, (0, 0
+00009d50: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
+00009d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009d70: 5f2c 2073 656c 662e 7069 636b 5f6f 7665  _, self.pick_ove
+00009d80: 726c 6179 5f33 6420 3d20 696d 6775 692e  rlay_3d = imgui.
+00009d90: 6368 6563 6b62 6f78 2822 3344 222c 2073  checkbox("3D", s
+00009da0: 656c 662e 7069 636b 5f6f 7665 726c 6179  elf.pick_overlay
+00009db0: 5f33 6429 0d0a 2020 2020 2020 2020 2020  _3d)..          
+00009dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009dd0: 2020 696d 6775 692e 706f 705f 7374 796c    imgui.pop_styl
+00009de0: 655f 7661 7228 290d 0a20 2020 2020 2020  e_var()..       
+00009df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009e00: 2020 2020 2053 6567 6d65 6e74 6174 696f       Segmentatio
+00009e10: 6e45 6469 746f 722e 5649 4557 5f52 4551  nEditor.VIEW_REQ
+00009e20: 5549 5245 535f 5550 4441 5445 207c 3d20  UIRES_UPDATE |= 
+00009e30: 5f0d 0a20 2020 2020 2020 2020 2020 2020  _..             
+00009e40: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00009e50: 6d67 7569 2e73 616d 655f 6c69 6e65 2829  mgui.same_line()
+00009e60: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00009e70: 2020 2020 2020 2020 2020 2020 2020 696d                im
+00009e80: 6775 692e 7365 745f 6e65 7874 5f69 7465  gui.set_next_ite
+00009e90: 6d5f 7769 6474 6828 696d 6775 692e 6765  m_width(imgui.ge
+00009ea0: 745f 636f 6e74 656e 745f 7265 6769 6f6e  t_content_region
+00009eb0: 5f61 7661 696c 6162 6c65 5f77 6964 7468  _available_width
+00009ec0: 2829 290d 0a20 2020 2020 2020 2020 2020  ())..           
+00009ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009ee0: 205f 2c20 5365 676d 656e 7461 7469 6f6e   _, Segmentation
+00009ef0: 4564 6974 6f72 2e4f 5645 524c 4159 5f49  Editor.OVERLAY_I
+00009f00: 4e54 454e 5349 5459 203d 2069 6d67 7569  NTENSITY = imgui
+00009f10: 2e73 6c69 6465 725f 666c 6f61 7428 2223  .slider_float("#
+00009f20: 2369 6e65 6e73 6974 7973 6c69 6465 725f  #inensityslider_
+00009f30: 7365 222c 2053 6567 6d65 6e74 6174 696f  se", Segmentatio
+00009f40: 6e45 6469 746f 722e 4f56 4552 4c41 595f  nEditor.OVERLAY_
+00009f50: 494e 5445 4e53 4954 592c 2030 2e30 2c20  INTENSITY, 0.0, 
+00009f60: 3130 2e30 2c20 666f 726d 6174 3d66 226f  10.0, format=f"o
+00009f70: 7665 726c 6179 2069 6e74 656e 7369 7479  verlay intensity
+00009f80: 203d 207b 5365 676d 656e 7461 7469 6f6e   = {Segmentation
+00009f90: 4564 6974 6f72 2e4f 5645 524c 4159 5f49  Editor.OVERLAY_I
+00009fa0: 4e54 454e 5349 5459 3a2e 3166 7d22 290d  NTENSITY:.1f}").
+00009fb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009fc0: 2020 2020 2020 2020 2020 2020 2053 6567               Seg
+00009fd0: 6d65 6e74 6174 696f 6e45 6469 746f 722e  mentationEditor.
+00009fe0: 5649 4557 5f52 4551 5549 5245 535f 5550  VIEW_REQUIRES_UP
+00009ff0: 4441 5445 207c 3d20 5f0d 0a0d 0a20 2020  DATE |= _....   
+0000a000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a010: 2069 6d67 7569 2e70 6f70 5f73 7479 6c65   imgui.pop_style
+0000a020: 5f76 6172 2836 290d 0a20 2020 2020 2020  _var(6)..       
+0000a030: 2020 2020 2020 2020 2020 2020 2069 6d67               img
+0000a040: 7569 2e70 6f70 5f73 7479 6c65 5f63 6f6c  ui.pop_style_col
+0000a050: 6f72 2831 290d 0a0d 0a20 2020 2020 2020  or(1)....       
+0000a060: 2064 6566 2073 6567 6d65 6e74 6174 696f   def segmentatio
+0000a070: 6e5f 7461 6228 293a 0d0a 0d0a 2020 2020  n_tab():....    
+0000a080: 2020 2020 2020 2020 6465 6620 6665 6174          def feat
+0000a090: 7572 6573 5f70 616e 656c 2829 3a0d 0a20  ures_panel():.. 
+0000a0a0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0000a0b0: 6620 696d 6775 692e 636f 6c6c 6170 7369  f imgui.collapsi
+0000a0c0: 6e67 5f68 6561 6465 7228 2246 6561 7475  ng_header("Featu
+0000a0d0: 7265 7322 2c20 4e6f 6e65 2c20 696d 6775  res", None, imgu
+0000a0e0: 692e 5452 4545 5f4e 4f44 455f 4445 4641  i.TREE_NODE_DEFA
+0000a0f0: 554c 545f 4f50 454e 295b 305d 3a0d 0a20  ULT_OPEN)[0]:.. 
+0000a100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a110: 2020 2069 6620 6366 672e 7365 5f61 6374     if cfg.se_act
+0000a120: 6976 655f 6672 616d 6520 6973 204e 6f6e  ive_frame is Non
+0000a130: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+0000a140: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0000a150: 726e 0d0a 2020 2020 2020 2020 2020 2020  rn..            
+0000a160: 2020 2020 2020 2020 6665 6174 7572 6573          features
+0000a170: 203d 2063 6667 2e73 655f 6163 7469 7665   = cfg.se_active
+0000a180: 5f66 7261 6d65 2e66 6561 7475 7265 730d  _frame.features.
+0000a190: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000a1a0: 2020 2020 2066 6f72 2066 2069 6e20 6665       for f in fe
+0000a1b0: 6174 7572 6573 3a0d 0a20 2020 2020 2020  atures:..       
+0000a1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a1d0: 2070 6f70 5f61 6374 6976 655f 636f 6c6f   pop_active_colo
+0000a1e0: 7572 203d 2046 616c 7365 0d0a 2020 2020  ur = False..    
+0000a1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a200: 2020 2020 6966 2063 6667 2e73 655f 6163      if cfg.se_ac
+0000a210: 7469 7665 5f66 7261 6d65 2e61 6374 6976  tive_frame.activ
+0000a220: 655f 6665 6174 7572 6520 3d3d 2066 3a0d  e_feature == f:.
+0000a230: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000a240: 2020 2020 2020 2020 2020 2020 2069 6d67               img
+0000a250: 7569 2e70 7573 685f 7374 796c 655f 636f  ui.push_style_co
+0000a260: 6c6f 7228 696d 6775 692e 434f 4c4f 525f  lor(imgui.COLOR_
+0000a270: 4348 494c 445f 4241 434b 4752 4f55 4e44  CHILD_BACKGROUND
+0000a280: 2c20 2a63 6667 2e43 4f4c 4f55 525f 4652  , *cfg.COLOUR_FR
+0000a290: 414d 455f 4143 5449 5645 290d 0a20 2020  AME_ACTIVE)..   
+0000a2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a2b0: 2020 2020 2020 2020 2070 6f70 5f61 6374           pop_act
+0000a2c0: 6976 655f 636f 6c6f 7572 203d 2054 7275  ive_colour = Tru
+0000a2d0: 650d 0a20 2020 2020 2020 2020 2020 2020  e..             
+0000a2e0: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
+0000a2f0: 2e62 6567 696e 5f63 6869 6c64 2866 2223  .begin_child(f"#
+0000a300: 2366 6561 745f 7b66 2e75 6964 7d22 2c20  #feat_{f.uid}", 
+0000a310: 302e 302c 2053 6567 6d65 6e74 6174 696f  0.0, Segmentatio
+0000a320: 6e45 6469 746f 722e 4645 4154 5552 455f  nEditor.FEATURE_
+0000a330: 5041 4e45 4c5f 4845 4947 4854 202b 2031  PANEL_HEIGHT + 1
+0000a340: 3620 2a20 662e 6d61 6769 632c 2054 7275  6 * f.magic, Tru
+0000a350: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
+0000a360: 2020 2020 2020 2020 2020 2020 6377 203d              cw =
+0000a370: 2069 6d67 7569 2e67 6574 5f63 6f6e 7465   imgui.get_conte
+0000a380: 6e74 5f72 6567 696f 6e5f 6176 6169 6c61  nt_region_availa
+0000a390: 626c 655f 7769 6474 6828 290d 0a0d 0a20  ble_width().... 
+0000a3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a3b0: 2020 2020 2020 2023 2043 6f6c 6f75 7220         # Colour 
+0000a3c0: 7069 636b 6572 0d0a 2020 2020 2020 2020  picker..        
+0000a3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a3e0: 5f2c 2066 2e63 6f6c 6f75 7220 3d20 696d  _, f.colour = im
+0000a3f0: 6775 692e 636f 6c6f 725f 6564 6974 3328  gui.color_edit3(
+0000a400: 662e 7469 746c 652c 202a 662e 636f 6c6f  f.title, *f.colo
+0000a410: 7572 5b3a 335d 2c20 696d 6775 692e 434f  ur[:3], imgui.CO
+0000a420: 4c4f 525f 4544 4954 5f4e 4f5f 494e 5055  LOR_EDIT_NO_INPU
+0000a430: 5453 207c 2069 6d67 7569 2e43 4f4c 4f52  TS | imgui.COLOR
+0000a440: 5f45 4449 545f 4e4f 5f4c 4142 454c 207c  _EDIT_NO_LABEL |
+0000a450: 2069 6d67 7569 2e43 4f4c 4f52 5f45 4449   imgui.COLOR_EDI
+0000a460: 545f 4e4f 5f54 4f4f 4c54 4950 207c 2069  T_NO_TOOLTIP | i
+0000a470: 6d67 7569 2e43 4f4c 4f52 5f45 4449 545f  mgui.COLOR_EDIT_
+0000a480: 4e4f 5f44 5241 475f 4452 4f50 290d 0a20  NO_DRAG_DROP).. 
+0000a490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a4a0: 2020 2020 2020 2069 6620 5f3a 0d0a 2020         if _:..  
 0000a4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a4c0: 7365 6c66 2e70 6172 7365 5f61 7661 696c  self.parse_avail
-0000a4d0: 6162 6c65 5f66 6561 7475 7265 7328 290d  able_features().
-0000a4e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000a4f0: 2020 2020 2020 2020 2023 2054 6974 6c65           # Title
-0000a500: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000a510: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
-0000a520: 7361 6d65 5f6c 696e 6528 290d 0a20 2020  same_line()..   
-0000a530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a540: 2020 2020 2069 6d67 7569 2e73 6574 5f6e       imgui.set_n
-0000a550: 6578 745f 6974 656d 5f77 6964 7468 2863  ext_item_width(c
-0000a560: 7720 2d20 3236 290d 0a20 2020 2020 2020  w - 26)..       
-0000a570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a580: 205f 2c20 662e 7469 746c 6520 3d20 696d   _, f.title = im
-0000a590: 6775 692e 696e 7075 745f 7465 7874 2822  gui.input_text("
-0000a5a0: 2323 7469 746c 6522 2c20 662e 7469 746c  ##title", f.titl
-0000a5b0: 652c 2032 3536 2c20 696d 6775 692e 494e  e, 256, imgui.IN
-0000a5c0: 5055 545f 5445 5854 5f4e 4f5f 484f 5249  PUT_TEXT_NO_HORI
-0000a5d0: 5a4f 4e54 414c 5f53 4352 4f4c 4c20 7c20  ZONTAL_SCROLL | 
-0000a5e0: 696d 6775 692e 494e 5055 545f 5445 5854  imgui.INPUT_TEXT
-0000a5f0: 5f41 5554 4f5f 5345 4c45 4354 5f41 4c4c  _AUTO_SELECT_ALL
-0000a600: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0000a610: 2020 2020 2020 2020 2020 2069 6620 5f3a             if _:
-0000a620: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000a630: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0000a640: 6c66 2e70 6172 7365 5f61 7661 696c 6162  lf.parse_availab
-0000a650: 6c65 5f66 6561 7475 7265 7328 290d 0a20  le_features().. 
-0000a660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a670: 2020 2020 2020 2073 656c 662e 5f67 7569         self._gui
-0000a680: 5f66 6561 7475 7265 5f74 6974 6c65 5f63  _feature_title_c
-0000a690: 6f6e 7465 7874 5f6d 656e 7528 6629 0d0a  ontext_menu(f)..
-0000a6a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000a6b0: 2020 2020 2020 2020 2020 2320 416c 7068            # Alph
-0000a6c0: 6120 736c 6964 6572 2061 6e64 2062 7275  a slider and bru
-0000a6d0: 7368 2073 697a 650d 0a20 2020 2020 2020  sh size..       
-0000a6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a6f0: 2069 6d67 7569 2e70 7573 685f 7374 796c   imgui.push_styl
-0000a700: 655f 7661 7228 696d 6775 692e 5354 594c  e_var(imgui.STYL
-0000a710: 455f 4652 414d 455f 5041 4444 494e 472c  E_FRAME_PADDING,
-0000a720: 2028 302c 2030 2929 0d0a 2020 2020 2020   (0, 0))..      
-0000a730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a740: 2020 696d 6775 692e 7075 7368 5f73 7479    imgui.push_sty
-0000a750: 6c65 5f76 6172 2869 6d67 7569 2e53 5459  le_var(imgui.STY
-0000a760: 4c45 5f46 5241 4d45 5f52 4f55 4e44 494e  LE_FRAME_ROUNDIN
-0000a770: 472c 2031 3029 0d0a 2020 2020 2020 2020  G, 10)..        
-0000a780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a790: 696d 6775 692e 7075 7368 5f73 7479 6c65  imgui.push_style
-0000a7a0: 5f76 6172 2869 6d67 7569 2e53 5459 4c45  _var(imgui.STYLE
-0000a7b0: 5f47 5241 425f 524f 554e 4449 4e47 2c20  _GRAB_ROUNDING, 
-0000a7c0: 3230 290d 0a20 2020 2020 2020 2020 2020  20)..           
-0000a7d0: 2020 2020 2020 2020 2020 2020 2069 6d67               img
-0000a7e0: 7569 2e70 7573 685f 7374 796c 655f 7661  ui.push_style_va
-0000a7f0: 7228 696d 6775 692e 5354 594c 455f 4752  r(imgui.STYLE_GR
-0000a800: 4142 5f4d 494e 5f53 495a 452c 2039 290d  AB_MIN_SIZE, 9).
-0000a810: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000a820: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
-0000a830: 7573 685f 7374 796c 655f 7661 7228 696d  ush_style_var(im
-0000a840: 6775 692e 5354 594c 455f 4652 414d 455f  gui.STYLE_FRAME_
-0000a850: 424f 5244 4552 5349 5a45 2c20 3129 0d0a  BORDERSIZE, 1)..
-0000a860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a870: 2020 2020 2020 2020 696d 6775 692e 7075          imgui.pu
-0000a880: 7368 5f73 7479 6c65 5f63 6f6c 6f72 2869  sh_style_color(i
-0000a890: 6d67 7569 2e43 4f4c 4f52 5f43 4845 434b  mgui.COLOR_CHECK
-0000a8a0: 5f4d 4152 4b2c 2030 2e30 2c20 302e 302c  _MARK, 0.0, 0.0,
-0000a8b0: 2030 2e30 2c20 312e 3029 0d0a 2020 2020   0.0, 1.0)..    
-0000a8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a8d0: 2020 2020 696d 6775 692e 7075 7368 5f69      imgui.push_i
-0000a8e0: 7465 6d5f 7769 6474 6828 6377 202d 2034  tem_width(cw - 4
-0000a8f0: 3029 0d0a 2020 2020 2020 2020 2020 2020  0)..            
-0000a900: 2020 2020 2020 2020 2020 2020 7078 7320              pxs 
-0000a910: 3d20 6366 672e 7365 5f61 6374 6976 655f  = cfg.se_active_
-0000a920: 6672 616d 652e 7069 7865 6c5f 7369 7a65  frame.pixel_size
-0000a930: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000a940: 2020 2020 2020 2020 2020 5f2c 2066 2e62            _, f.b
-0000a950: 7275 7368 5f73 697a 6520 3d20 696d 6775  rush_size = imgu
-0000a960: 692e 736c 6964 6572 5f66 6c6f 6174 2822  i.slider_float("
-0000a970: 6272 7573 6822 2c20 662e 6272 7573 685f  brush", f.brush_
-0000a980: 7369 7a65 2c20 312e 302c 2032 352e 3020  size, 1.0, 25.0 
-0000a990: 2f20 7078 732c 2066 6f72 6d61 743d 6622  / pxs, format=f"
-0000a9a0: 7b66 2e62 7275 7368 5f73 697a 653a 2e31  {f.brush_size:.1
-0000a9b0: 667d 2070 7820 2f20 7b32 202a 2066 2e62  f} px / {2 * f.b
-0000a9c0: 7275 7368 5f73 697a 6520 2a20 7078 733a  rush_size * pxs:
-0000a9d0: 2e31 667d 206e 6d20 2229 0d0a 2020 2020  .1f} nm ")..    
-0000a9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a9f0: 2020 2020 6966 2066 2e6d 6167 6963 3a0d      if f.magic:.
-0000aa00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000aa10: 2020 2020 2020 2020 2020 2020 205f 2c20               _, 
-0000aa20: 662e 6d61 6769 635f 7374 7265 6e67 7468  f.magic_strength
-0000aa30: 203d 2069 6d67 7569 2e73 6c69 6465 725f   = imgui.slider_
-0000aa40: 666c 6f61 7428 2266 6c6f 6f64 222c 2066  float("flood", f
-0000aa50: 2e6d 6167 6963 5f73 7472 656e 6774 682c  .magic_strength,
-0000aa60: 2031 2e30 2c20 3130 302e 302c 2066 6f72   1.0, 100.0, for
-0000aa70: 6d61 743d 6622 7b66 2e6d 6167 6963 5f73  mat=f"{f.magic_s
-0000aa80: 7472 656e 6774 683a 2e31 667d 2525 2073  trength:.1f}%% s
-0000aa90: 656e 7369 7469 7669 7479 2229 0d0a 2020  ensitivity")..  
-0000aaa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000aab0: 2020 2020 2020 5f2c 2066 2e61 6c70 6861        _, f.alpha
-0000aac0: 203d 2069 6d67 7569 2e73 6c69 6465 725f   = imgui.slider_
-0000aad0: 666c 6f61 7428 2261 6c70 6861 222c 2066  float("alpha", f
-0000aae0: 2e61 6c70 6861 2c20 302e 302c 2031 2e30  .alpha, 0.0, 1.0
-0000aaf0: 2c20 666f 726d 6174 3d22 252e 3266 2229  , format="%.2f")
-0000ab00: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000ab10: 2020 2020 2020 2020 2020 5f2c 2066 2e62            _, f.b
-0000ab20: 6f78 5f73 697a 6520 3d20 696d 6775 692e  ox_size = imgui.
-0000ab30: 736c 6964 6572 5f69 6e74 2822 626f 7865  slider_int("boxe
-0000ab40: 7322 2c20 662e 626f 785f 7369 7a65 2c20  s", f.box_size, 
-0000ab50: 382c 2031 3238 2c20 666f 726d 6174 3d66  8, 128, format=f
-0000ab60: 227b 662e 626f 785f 7369 7a65 7d20 7069  "{f.box_size} pi
-0000ab70: 7865 6c22 290d 0a20 2020 2020 2020 2020  xel")..         
-0000ab80: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0000ab90: 6d67 7569 2e70 6f70 5f69 7465 6d5f 7769  mgui.pop_item_wi
-0000aba0: 6474 6828 290d 0a20 2020 2020 2020 2020  dth()..         
-0000abb0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0000abc0: 2e62 7275 7368 5f73 697a 6520 3d20 696e  .brush_size = in
-0000abd0: 7428 662e 6272 7573 685f 7369 7a65 290d  t(f.brush_size).
-0000abe0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000abf0: 2020 2020 2020 2020 2069 6620 5f3a 0d0a           if _:..
-0000ac00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ac10: 2020 2020 2020 2020 2020 2020 662e 7365              f.se
-0000ac20: 745f 626f 785f 7369 7a65 2866 2e62 6f78  t_box_size(f.box
-0000ac30: 5f73 697a 6529 0d0a 2020 2020 2020 2020  _size)..        
-0000ac40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ac50: 2320 5368 6f77 202f 2066 696c 6c20 6368  # Show / fill ch
-0000ac60: 6563 6b62 6f78 6573 0d0a 2020 2020 2020  eckboxes..      
-0000ac70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ac80: 2020 5f2c 2073 686f 7720 3d20 696d 6775    _, show = imgu
-0000ac90: 692e 6368 6563 6b62 6f78 2822 7368 6f77  i.checkbox("show
-0000aca0: 222c 206e 6f74 2066 2e68 6964 6529 0d0a  ", not f.hide)..
-0000acb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000acc0: 2020 2020 2020 2020 662e 6869 6465 203d          f.hide =
-0000acd0: 206e 6f74 2073 686f 770d 0a20 2020 2020   not show..     
-0000ace0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000acf0: 2020 2069 6d67 7569 2e73 616d 655f 6c69     imgui.same_li
-0000ad00: 6e65 2829 0d0a 2020 2020 2020 2020 2020  ne()..          
-0000ad10: 2020 2020 2020 2020 2020 2020 2020 5f2c                _,
-0000ad20: 2066 696c 6c20 3d20 696d 6775 692e 6368   fill = imgui.ch
-0000ad30: 6563 6b62 6f78 2822 6669 6c6c 222c 206e  eckbox("fill", n
-0000ad40: 6f74 2066 2e63 6f6e 746f 7572 290d 0a20  ot f.contour).. 
-0000ad50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ad60: 2020 2020 2020 2066 2e63 6f6e 746f 7572         f.contour
-0000ad70: 203d 206e 6f74 2066 696c 6c0d 0a20 2020   = not fill..   
-0000ad80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ad90: 2020 2020 2069 6d67 7569 2e73 616d 655f       imgui.same_
-0000ada0: 6c69 6e65 2829 0d0a 2020 2020 2020 2020  line()..        
-0000adb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000adc0: 5f2c 2068 6964 655f 626f 7865 7320 3d20  _, hide_boxes = 
-0000add0: 696d 6775 692e 6368 6563 6b62 6f78 2822  imgui.checkbox("
-0000ade0: 6869 6465 2062 6f78 6573 222c 206e 6f74  hide boxes", not
-0000adf0: 2066 2e73 686f 775f 626f 7865 7329 0d0a   f.show_boxes)..
-0000ae00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ae10: 2020 2020 2020 2020 696d 6775 692e 7361          imgui.sa
-0000ae20: 6d65 5f6c 696e 6528 290d 0a20 2020 2020  me_line()..     
-0000ae30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ae40: 2020 205f 2c20 662e 6d61 6769 6320 3d20     _, f.magic = 
-0000ae50: 696d 6775 692e 6368 6563 6b62 6f78 2822  imgui.checkbox("
-0000ae60: 666c 6f6f 6423 2363 6865 636b 626f 7822  flood##checkbox"
-0000ae70: 2c20 662e 6d61 6769 6329 0d0a 2020 2020  , f.magic)..    
-0000ae80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ae90: 2020 2020 662e 7368 6f77 5f62 6f78 6573      f.show_boxes
-0000aea0: 203d 206e 6f74 2068 6964 655f 626f 7865   = not hide_boxe
-0000aeb0: 730d 0a20 2020 2020 2020 2020 2020 2020  s..             
-0000aec0: 2020 2020 2020 2020 2020 2066 2e63 6f6e             f.con
-0000aed0: 746f 7572 203d 206e 6f74 2066 696c 6c0d  tour = not fill.
-0000aee0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000aef0: 2020 2020 2020 2020 2069 6d67 7569 2e73           imgui.s
-0000af00: 616d 655f 6c69 6e65 2829 0d0a 2020 2020  ame_line()..    
-0000af10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000af20: 2020 2020 696d 6775 692e 706f 705f 7374      imgui.pop_st
-0000af30: 796c 655f 636f 6c6f 7228 3129 0d0a 2020  yle_color(1)..  
-0000af40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000af50: 2020 2020 2020 2320 6465 6c65 7465 2066        # delete f
-0000af60: 6561 7475 7265 2062 7574 746f 6e0d 0a20  eature button.. 
-0000af70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000af80: 2020 2020 2020 2069 6d67 7569 2e73 616d         imgui.sam
-0000af90: 655f 6c69 6e65 2870 6f73 6974 696f 6e3d  e_line(position=
-0000afa0: 6377 202d 2032 3029 0d0a 2020 2020 2020  cw - 20)..      
-0000afb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000afc0: 2020 6465 6c65 7465 5f66 6561 7475 7265    delete_feature
-0000afd0: 203d 2046 616c 7365 0d0a 2020 2020 2020   = False..      
-0000afe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000aff0: 2020 6966 2069 6d67 7569 2e69 6d61 6765    if imgui.image
-0000b000: 5f62 7574 746f 6e28 7365 6c66 2e69 636f  _button(self.ico
-0000b010: 6e5f 636c 6f73 652e 7265 6e64 6572 6572  n_close.renderer
-0000b020: 5f69 642c 2031 332c 2031 3329 3a0d 0a20  _id, 13, 13):.. 
-0000b030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b040: 2020 2020 2020 2020 2020 2064 656c 6574             delet
-0000b050: 655f 6665 6174 7572 6520 3d20 5472 7565  e_feature = True
-0000b060: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000b070: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
-0000b080: 7361 6d65 5f6c 696e 6528 706f 7369 7469  same_line(positi
-0000b090: 6f6e 3d63 7720 2d20 3230 290d 0a0d 0a20  on=cw - 20).... 
-0000b0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b0b0: 2020 2020 2020 2069 6d67 7569 2e70 7573         imgui.pus
-0000b0c0: 685f 7374 796c 655f 636f 6c6f 7228 696d  h_style_color(im
-0000b0d0: 6775 692e 434f 4c4f 525f 4845 4144 4552  gui.COLOR_HEADER
-0000b0e0: 5f48 4f56 4552 4544 2c20 2a63 6667 2e43  _HOVERED, *cfg.C
-0000b0f0: 4f4c 4f55 525f 5452 414e 5350 4152 454e  OLOUR_TRANSPAREN
-0000b100: 5429 0d0a 2020 2020 2020 2020 2020 2020  T)..            
-0000b110: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
-0000b120: 692e 7075 7368 5f73 7479 6c65 5f63 6f6c  i.push_style_col
-0000b130: 6f72 2869 6d67 7569 2e43 4f4c 4f52 5f48  or(imgui.COLOR_H
-0000b140: 4541 4445 525f 4143 5449 5645 2c20 2a63  EADER_ACTIVE, *c
-0000b150: 6667 2e43 4f4c 4f55 525f 5452 414e 5350  fg.COLOUR_TRANSP
-0000b160: 4152 454e 5429 0d0a 2020 2020 2020 2020  ARENT)..        
-0000b170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b180: 696d 6775 692e 7075 7368 5f73 7479 6c65  imgui.push_style
-0000b190: 5f63 6f6c 6f72 2869 6d67 7569 2e43 4f4c  _color(imgui.COL
-0000b1a0: 4f52 5f48 4541 4445 522c 202a 6366 672e  OR_HEADER, *cfg.
-0000b1b0: 434f 4c4f 5552 5f54 5241 4e53 5041 5245  COLOUR_TRANSPARE
-0000b1c0: 4e54 290d 0a0d 0a20 2020 2020 2020 2020  NT)....         
-0000b1d0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0000b1e0: 6620 696d 6775 692e 6265 6769 6e5f 6d65  f imgui.begin_me
-0000b1f0: 6e75 2822 2323 6173 6463 2229 3a0d 0a20  nu("##asdc"):.. 
-0000b200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b210: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
-0000b220: 2e70 7573 685f 7374 796c 655f 636f 6c6f  .push_style_colo
-0000b230: 7228 696d 6775 692e 434f 4c4f 525f 4845  r(imgui.COLOR_HE
-0000b240: 4144 4552 5f48 4f56 4552 4544 2c20 2a63  ADER_HOVERED, *c
-0000b250: 6667 2e43 4f4c 4f55 525f 4845 4144 4552  fg.COLOUR_HEADER
-0000b260: 5f48 4f56 4552 4544 290d 0a20 2020 2020  _HOVERED)..     
-0000b270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b280: 2020 2020 2020 2069 6d67 7569 2e70 7573         imgui.pus
-0000b290: 685f 7374 796c 655f 636f 6c6f 7228 696d  h_style_color(im
-0000b2a0: 6775 692e 434f 4c4f 525f 4845 4144 4552  gui.COLOR_HEADER
-0000b2b0: 5f41 4354 4956 452c 202a 6366 672e 434f  _ACTIVE, *cfg.CO
-0000b2c0: 4c4f 5552 5f48 4541 4445 525f 4143 5449  LOUR_HEADER_ACTI
-0000b2d0: 5645 290d 0a20 2020 2020 2020 2020 2020  VE)..           
+0000a4c0: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
+0000a4d0: 6172 7365 5f61 7661 696c 6162 6c65 5f66  arse_available_f
+0000a4e0: 6561 7475 7265 7328 290d 0a20 2020 2020  eatures()..     
+0000a4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a500: 2020 2023 2054 6974 6c65 0d0a 2020 2020     # Title..    
+0000a510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a520: 2020 2020 696d 6775 692e 7361 6d65 5f6c      imgui.same_l
+0000a530: 696e 6528 290d 0a20 2020 2020 2020 2020  ine()..         
+0000a540: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0000a550: 6d67 7569 2e73 6574 5f6e 6578 745f 6974  mgui.set_next_it
+0000a560: 656d 5f77 6964 7468 2863 7720 2d20 3236  em_width(cw - 26
+0000a570: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0000a580: 2020 2020 2020 2020 2020 205f 2c20 662e             _, f.
+0000a590: 7469 746c 6520 3d20 696d 6775 692e 696e  title = imgui.in
+0000a5a0: 7075 745f 7465 7874 2822 2323 7469 746c  put_text("##titl
+0000a5b0: 6522 2c20 662e 7469 746c 652c 2032 3536  e", f.title, 256
+0000a5c0: 2c20 696d 6775 692e 494e 5055 545f 5445  , imgui.INPUT_TE
+0000a5d0: 5854 5f4e 4f5f 484f 5249 5a4f 4e54 414c  XT_NO_HORIZONTAL
+0000a5e0: 5f53 4352 4f4c 4c20 7c20 696d 6775 692e  _SCROLL | imgui.
+0000a5f0: 494e 5055 545f 5445 5854 5f41 5554 4f5f  INPUT_TEXT_AUTO_
+0000a600: 5345 4c45 4354 5f41 4c4c 290d 0a20 2020  SELECT_ALL)..   
+0000a610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a620: 2020 2020 2069 6620 5f3a 0d0a 2020 2020       if _:..    
+0000a630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a640: 2020 2020 2020 2020 7365 6c66 2e70 6172          self.par
+0000a650: 7365 5f61 7661 696c 6162 6c65 5f66 6561  se_available_fea
+0000a660: 7475 7265 7328 290d 0a20 2020 2020 2020  tures()..       
+0000a670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a680: 2073 656c 662e 5f67 7569 5f66 6561 7475   self._gui_featu
+0000a690: 7265 5f74 6974 6c65 5f63 6f6e 7465 7874  re_title_context
+0000a6a0: 5f6d 656e 7528 6629 0d0a 0d0a 2020 2020  _menu(f)....    
+0000a6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a6c0: 2020 2020 2320 416c 7068 6120 736c 6964      # Alpha slid
+0000a6d0: 6572 2061 6e64 2062 7275 7368 2073 697a  er and brush siz
+0000a6e0: 650d 0a20 2020 2020 2020 2020 2020 2020  e..             
+0000a6f0: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
+0000a700: 2e70 7573 685f 7374 796c 655f 7661 7228  .push_style_var(
+0000a710: 696d 6775 692e 5354 594c 455f 4652 414d  imgui.STYLE_FRAM
+0000a720: 455f 5041 4444 494e 472c 2028 302c 2030  E_PADDING, (0, 0
+0000a730: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
+0000a740: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
+0000a750: 692e 7075 7368 5f73 7479 6c65 5f76 6172  i.push_style_var
+0000a760: 2869 6d67 7569 2e53 5459 4c45 5f46 5241  (imgui.STYLE_FRA
+0000a770: 4d45 5f52 4f55 4e44 494e 472c 2031 3029  ME_ROUNDING, 10)
+0000a780: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000a790: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
+0000a7a0: 7075 7368 5f73 7479 6c65 5f76 6172 2869  push_style_var(i
+0000a7b0: 6d67 7569 2e53 5459 4c45 5f47 5241 425f  mgui.STYLE_GRAB_
+0000a7c0: 524f 554e 4449 4e47 2c20 3230 290d 0a20  ROUNDING, 20).. 
+0000a7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a7e0: 2020 2020 2020 2069 6d67 7569 2e70 7573         imgui.pus
+0000a7f0: 685f 7374 796c 655f 7661 7228 696d 6775  h_style_var(imgu
+0000a800: 692e 5354 594c 455f 4752 4142 5f4d 494e  i.STYLE_GRAB_MIN
+0000a810: 5f53 495a 452c 2039 290d 0a20 2020 2020  _SIZE, 9)..     
+0000a820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a830: 2020 2069 6d67 7569 2e70 7573 685f 7374     imgui.push_st
+0000a840: 796c 655f 7661 7228 696d 6775 692e 5354  yle_var(imgui.ST
+0000a850: 594c 455f 4652 414d 455f 424f 5244 4552  YLE_FRAME_BORDER
+0000a860: 5349 5a45 2c20 3129 0d0a 2020 2020 2020  SIZE, 1)..      
+0000a870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a880: 2020 696d 6775 692e 7075 7368 5f73 7479    imgui.push_sty
+0000a890: 6c65 5f63 6f6c 6f72 2869 6d67 7569 2e43  le_color(imgui.C
+0000a8a0: 4f4c 4f52 5f43 4845 434b 5f4d 4152 4b2c  OLOR_CHECK_MARK,
+0000a8b0: 2030 2e30 2c20 302e 302c 2030 2e30 2c20   0.0, 0.0, 0.0, 
+0000a8c0: 312e 3029 0d0a 2020 2020 2020 2020 2020  1.0)..          
+0000a8d0: 2020 2020 2020 2020 2020 2020 2020 696d                im
+0000a8e0: 6775 692e 7075 7368 5f69 7465 6d5f 7769  gui.push_item_wi
+0000a8f0: 6474 6828 6377 202d 2034 3029 0d0a 2020  dth(cw - 40)..  
+0000a900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a910: 2020 2020 2020 7078 7320 3d20 6366 672e        pxs = cfg.
+0000a920: 7365 5f61 6374 6976 655f 6672 616d 652e  se_active_frame.
+0000a930: 7069 7865 6c5f 7369 7a65 0d0a 2020 2020  pixel_size..    
+0000a940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a950: 2020 2020 5f2c 2066 2e62 7275 7368 5f73      _, f.brush_s
+0000a960: 697a 6520 3d20 696d 6775 692e 736c 6964  ize = imgui.slid
+0000a970: 6572 5f66 6c6f 6174 2822 6272 7573 6822  er_float("brush"
+0000a980: 2c20 662e 6272 7573 685f 7369 7a65 2c20  , f.brush_size, 
+0000a990: 312e 302c 2032 352e 3020 2f20 7078 732c  1.0, 25.0 / pxs,
+0000a9a0: 2066 6f72 6d61 743d 6622 7b66 2e62 7275   format=f"{f.bru
+0000a9b0: 7368 5f73 697a 653a 2e31 667d 2070 7820  sh_size:.1f} px 
+0000a9c0: 2f20 7b32 202a 2066 2e62 7275 7368 5f73  / {2 * f.brush_s
+0000a9d0: 697a 6520 2a20 7078 733a 2e31 667d 206e  ize * pxs:.1f} n
+0000a9e0: 6d20 2229 0d0a 2020 2020 2020 2020 2020  m ")..          
+0000a9f0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0000aa00: 2066 2e6d 6167 6963 3a0d 0a20 2020 2020   f.magic:..     
+0000aa10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000aa20: 2020 2020 2020 205f 2c20 662e 6d61 6769         _, f.magi
+0000aa30: 635f 7374 7265 6e67 7468 203d 2069 6d67  c_strength = img
+0000aa40: 7569 2e73 6c69 6465 725f 666c 6f61 7428  ui.slider_float(
+0000aa50: 2266 6c6f 6f64 222c 2066 2e6d 6167 6963  "flood", f.magic
+0000aa60: 5f73 7472 656e 6774 682c 2031 2e30 2c20  _strength, 1.0, 
+0000aa70: 3130 302e 302c 2066 6f72 6d61 743d 6622  100.0, format=f"
+0000aa80: 7b66 2e6d 6167 6963 5f73 7472 656e 6774  {f.magic_strengt
+0000aa90: 683a 2e31 667d 2525 2073 656e 7369 7469  h:.1f}%% sensiti
+0000aaa0: 7669 7479 2229 0d0a 2020 2020 2020 2020  vity")..        
+0000aab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000aac0: 5f2c 2066 2e61 6c70 6861 203d 2069 6d67  _, f.alpha = img
+0000aad0: 7569 2e73 6c69 6465 725f 666c 6f61 7428  ui.slider_float(
+0000aae0: 2261 6c70 6861 222c 2066 2e61 6c70 6861  "alpha", f.alpha
+0000aaf0: 2c20 302e 302c 2031 2e30 2c20 666f 726d  , 0.0, 1.0, form
+0000ab00: 6174 3d22 252e 3266 2229 0d0a 2020 2020  at="%.2f")..    
+0000ab10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ab20: 2020 2020 5f2c 2066 2e62 6f78 5f73 697a      _, f.box_siz
+0000ab30: 6520 3d20 696d 6775 692e 736c 6964 6572  e = imgui.slider
+0000ab40: 5f69 6e74 2822 626f 7865 7322 2c20 662e  _int("boxes", f.
+0000ab50: 626f 785f 7369 7a65 2c20 382c 2031 3238  box_size, 8, 128
+0000ab60: 2c20 666f 726d 6174 3d66 227b 662e 626f  , format=f"{f.bo
+0000ab70: 785f 7369 7a65 7d20 7069 7865 6c22 290d  x_size} pixel").
+0000ab80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ab90: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
+0000aba0: 6f70 5f69 7465 6d5f 7769 6474 6828 290d  op_item_width().
+0000abb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000abc0: 2020 2020 2020 2020 2066 2e62 7275 7368           f.brush
+0000abd0: 5f73 697a 6520 3d20 696e 7428 662e 6272  _size = int(f.br
+0000abe0: 7573 685f 7369 7a65 290d 0a20 2020 2020  ush_size)..     
+0000abf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ac00: 2020 2069 6620 5f3a 0d0a 2020 2020 2020     if _:..      
+0000ac10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ac20: 2020 2020 2020 662e 7365 745f 626f 785f        f.set_box_
+0000ac30: 7369 7a65 2866 2e62 6f78 5f73 697a 6529  size(f.box_size)
+0000ac40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000ac50: 2020 2020 2020 2020 2020 2320 5368 6f77            # Show
+0000ac60: 202f 2066 696c 6c20 6368 6563 6b62 6f78   / fill checkbox
+0000ac70: 6573 0d0a 2020 2020 2020 2020 2020 2020  es..            
+0000ac80: 2020 2020 2020 2020 2020 2020 5f2c 2073              _, s
+0000ac90: 686f 7720 3d20 696d 6775 692e 6368 6563  how = imgui.chec
+0000aca0: 6b62 6f78 2822 7368 6f77 222c 206e 6f74  kbox("show", not
+0000acb0: 2066 2e68 6964 6529 0d0a 2020 2020 2020   f.hide)..      
+0000acc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000acd0: 2020 662e 6869 6465 203d 206e 6f74 2073    f.hide = not s
+0000ace0: 686f 770d 0a20 2020 2020 2020 2020 2020  how..           
+0000acf0: 2020 2020 2020 2020 2020 2020 2069 6d67               img
+0000ad00: 7569 2e73 616d 655f 6c69 6e65 2829 0d0a  ui.same_line()..
+0000ad10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ad20: 2020 2020 2020 2020 5f2c 2066 696c 6c20          _, fill 
+0000ad30: 3d20 696d 6775 692e 6368 6563 6b62 6f78  = imgui.checkbox
+0000ad40: 2822 6669 6c6c 222c 206e 6f74 2066 2e63  ("fill", not f.c
+0000ad50: 6f6e 746f 7572 290d 0a20 2020 2020 2020  ontour)..       
+0000ad60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ad70: 2066 2e63 6f6e 746f 7572 203d 206e 6f74   f.contour = not
+0000ad80: 2066 696c 6c0d 0a20 2020 2020 2020 2020   fill..         
+0000ad90: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0000ada0: 6d67 7569 2e73 616d 655f 6c69 6e65 2829  mgui.same_line()
+0000adb0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000adc0: 2020 2020 2020 2020 2020 5f2c 2068 6964            _, hid
+0000add0: 655f 626f 7865 7320 3d20 696d 6775 692e  e_boxes = imgui.
+0000ade0: 6368 6563 6b62 6f78 2822 6869 6465 2062  checkbox("hide b
+0000adf0: 6f78 6573 222c 206e 6f74 2066 2e73 686f  oxes", not f.sho
+0000ae00: 775f 626f 7865 7329 0d0a 2020 2020 2020  w_boxes)..      
+0000ae10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ae20: 2020 696d 6775 692e 7361 6d65 5f6c 696e    imgui.same_lin
+0000ae30: 6528 290d 0a20 2020 2020 2020 2020 2020  e()..           
+0000ae40: 2020 2020 2020 2020 2020 2020 205f 2c20               _, 
+0000ae50: 662e 6d61 6769 6320 3d20 696d 6775 692e  f.magic = imgui.
+0000ae60: 6368 6563 6b62 6f78 2822 666c 6f6f 6423  checkbox("flood#
+0000ae70: 2363 6865 636b 626f 7822 2c20 662e 6d61  #checkbox", f.ma
+0000ae80: 6769 6329 0d0a 2020 2020 2020 2020 2020  gic)..          
+0000ae90: 2020 2020 2020 2020 2020 2020 2020 662e                f.
+0000aea0: 7368 6f77 5f62 6f78 6573 203d 206e 6f74  show_boxes = not
+0000aeb0: 2068 6964 655f 626f 7865 730d 0a20 2020   hide_boxes..   
+0000aec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000aed0: 2020 2020 2066 2e63 6f6e 746f 7572 203d       f.contour =
+0000aee0: 206e 6f74 2066 696c 6c0d 0a20 2020 2020   not fill..     
+0000aef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000af00: 2020 2069 6d67 7569 2e73 616d 655f 6c69     imgui.same_li
+0000af10: 6e65 2829 0d0a 2020 2020 2020 2020 2020  ne()..          
+0000af20: 2020 2020 2020 2020 2020 2020 2020 696d                im
+0000af30: 6775 692e 706f 705f 7374 796c 655f 636f  gui.pop_style_co
+0000af40: 6c6f 7228 3129 0d0a 2020 2020 2020 2020  lor(1)..        
+0000af50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000af60: 2320 6465 6c65 7465 2066 6561 7475 7265  # delete feature
+0000af70: 2062 7574 746f 6e0d 0a20 2020 2020 2020   button..       
+0000af80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000af90: 2069 6d67 7569 2e73 616d 655f 6c69 6e65   imgui.same_line
+0000afa0: 2870 6f73 6974 696f 6e3d 6377 202d 2032  (position=cw - 2
+0000afb0: 3029 0d0a 2020 2020 2020 2020 2020 2020  0)..            
+0000afc0: 2020 2020 2020 2020 2020 2020 6465 6c65              dele
+0000afd0: 7465 5f66 6561 7475 7265 203d 2046 616c  te_feature = Fal
+0000afe0: 7365 0d0a 2020 2020 2020 2020 2020 2020  se..            
+0000aff0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+0000b000: 6d67 7569 2e69 6d61 6765 5f62 7574 746f  mgui.image_butto
+0000b010: 6e28 7365 6c66 2e69 636f 6e5f 636c 6f73  n(self.icon_clos
+0000b020: 652e 7265 6e64 6572 6572 5f69 642c 2031  e.renderer_id, 1
+0000b030: 332c 2031 3329 3a0d 0a20 2020 2020 2020  3, 13):..       
+0000b040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b050: 2020 2020 2064 656c 6574 655f 6665 6174       delete_feat
+0000b060: 7572 6520 3d20 5472 7565 0d0a 2020 2020  ure = True..    
+0000b070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b080: 2020 2020 696d 6775 692e 7361 6d65 5f6c      imgui.same_l
+0000b090: 696e 6528 706f 7369 7469 6f6e 3d63 7720  ine(position=cw 
+0000b0a0: 2d20 3230 290d 0a0d 0a20 2020 2020 2020  - 20)....       
+0000b0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b0c0: 2069 6d67 7569 2e70 7573 685f 7374 796c   imgui.push_styl
+0000b0d0: 655f 636f 6c6f 7228 696d 6775 692e 434f  e_color(imgui.CO
+0000b0e0: 4c4f 525f 4845 4144 4552 5f48 4f56 4552  LOR_HEADER_HOVER
+0000b0f0: 4544 2c20 2a63 6667 2e43 4f4c 4f55 525f  ED, *cfg.COLOUR_
+0000b100: 5452 414e 5350 4152 454e 5429 0d0a 2020  TRANSPARENT)..  
+0000b110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b120: 2020 2020 2020 696d 6775 692e 7075 7368        imgui.push
+0000b130: 5f73 7479 6c65 5f63 6f6c 6f72 2869 6d67  _style_color(img
+0000b140: 7569 2e43 4f4c 4f52 5f48 4541 4445 525f  ui.COLOR_HEADER_
+0000b150: 4143 5449 5645 2c20 2a63 6667 2e43 4f4c  ACTIVE, *cfg.COL
+0000b160: 4f55 525f 5452 414e 5350 4152 454e 5429  OUR_TRANSPARENT)
+0000b170: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000b180: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
+0000b190: 7075 7368 5f73 7479 6c65 5f63 6f6c 6f72  push_style_color
+0000b1a0: 2869 6d67 7569 2e43 4f4c 4f52 5f48 4541  (imgui.COLOR_HEA
+0000b1b0: 4445 522c 202a 6366 672e 434f 4c4f 5552  DER, *cfg.COLOUR
+0000b1c0: 5f54 5241 4e53 5041 5245 4e54 290d 0a0d  _TRANSPARENT)...
+0000b1d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b1e0: 2020 2020 2020 2020 2069 6620 696d 6775           if imgu
+0000b1f0: 692e 6265 6769 6e5f 6d65 6e75 2822 2323  i.begin_menu("##
+0000b200: 6173 6463 2229 3a0d 0a20 2020 2020 2020  asdc"):..       
+0000b210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b220: 2020 2020 2069 6d67 7569 2e70 7573 685f       imgui.push_
+0000b230: 7374 796c 655f 636f 6c6f 7228 696d 6775  style_color(imgu
+0000b240: 692e 434f 4c4f 525f 4845 4144 4552 5f48  i.COLOR_HEADER_H
+0000b250: 4f56 4552 4544 2c20 2a63 6667 2e43 4f4c  OVERED, *cfg.COL
+0000b260: 4f55 525f 4845 4144 4552 5f48 4f56 4552  OUR_HEADER_HOVER
+0000b270: 4544 290d 0a20 2020 2020 2020 2020 2020  ED)..           
+0000b280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b290: 2069 6d67 7569 2e70 7573 685f 7374 796c   imgui.push_styl
+0000b2a0: 655f 636f 6c6f 7228 696d 6775 692e 434f  e_color(imgui.CO
+0000b2b0: 4c4f 525f 4845 4144 4552 5f41 4354 4956  LOR_HEADER_ACTIV
+0000b2c0: 452c 202a 6366 672e 434f 4c4f 5552 5f48  E, *cfg.COLOUR_H
+0000b2d0: 4541 4445 525f 4143 5449 5645 290d 0a20  EADER_ACTIVE).. 
 0000b2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b2f0: 2069 6d67 7569 2e70 7573 685f 7374 796c   imgui.push_styl
-0000b300: 655f 636f 6c6f 7228 696d 6775 692e 434f  e_color(imgui.CO
-0000b310: 4c4f 525f 4845 4144 4552 2c20 2a63 6667  LOR_HEADER, *cfg
-0000b320: 2e43 4f4c 4f55 525f 4845 4144 4552 290d  .COLOUR_HEADER).
-0000b330: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000b340: 2020 2020 2020 2020 2020 2020 206e 5f62               n_b
-0000b350: 6f78 6573 203d 2073 756d 285b 6c65 6e28  oxes = sum([len(
-0000b360: 626f 786c 6973 7429 2066 6f72 2062 6f78  boxlist) for box
-0000b370: 6c69 7374 2069 6e20 662e 626f 7865 732e  list in f.boxes.
-0000b380: 7661 6c75 6573 2829 5d29 0d0a 2020 2020  values()])..    
-0000b390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b3a0: 2020 2020 2020 2020 696d 6775 692e 7465          imgui.te
-0000b3b0: 7874 2866 2241 6374 6976 6520 736c 6963  xt(f"Active slic
-0000b3c0: 6573 2028 7b6c 656e 2866 2e65 6469 7465  es ({len(f.edite
-0000b3d0: 645f 736c 6963 6573 297d 2c20 7b6e 5f62  d_slices)}, {n_b
-0000b3e0: 6f78 6573 7d20 626f 7865 7329 2229 0d0a  oxes} boxes)")..
-0000b3f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000b400: 2020 2020 2020 2020 2020 2020 2020 696d                im
-0000b410: 6775 692e 6265 6769 6e5f 6368 696c 6428  gui.begin_child(
-0000b420: 2261 6374 6976 655f 736c 6963 6573 222c  "active_slices",
-0000b430: 2032 3030 2c20 5365 676d 656e 7461 7469   200, Segmentati
-0000b440: 6f6e 4564 6974 6f72 2e41 4354 4956 455f  onEditor.ACTIVE_
-0000b450: 534c 4943 4553 5f43 4849 4c44 5f48 4549  SLICES_CHILD_HEI
-0000b460: 4748 542c 2054 7275 6529 0d0a 2020 2020  GHT, True)..    
-0000b470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b480: 2020 2020 2020 2020 6377 203d 2069 6d67          cw = img
-0000b490: 7569 2e67 6574 5f63 6f6e 7465 6e74 5f72  ui.get_content_r
-0000b4a0: 6567 696f 6e5f 6176 6169 6c61 626c 655f  egion_available_
-0000b4b0: 7769 6474 6828 290d 0a20 2020 2020 2020  width()..       
-0000b4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b4d0: 2020 2020 2066 6f72 2069 2069 6e20 662e       for i in f.
-0000b4e0: 6564 6974 6564 5f73 6c69 6365 733a 0d0a  edited_slices:..
-0000b4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b2f0: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
+0000b300: 2e70 7573 685f 7374 796c 655f 636f 6c6f  .push_style_colo
+0000b310: 7228 696d 6775 692e 434f 4c4f 525f 4845  r(imgui.COLOR_HE
+0000b320: 4144 4552 2c20 2a63 6667 2e43 4f4c 4f55  ADER, *cfg.COLOU
+0000b330: 525f 4845 4144 4552 290d 0a20 2020 2020  R_HEADER)..     
+0000b340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b350: 2020 2020 2020 206e 5f62 6f78 6573 203d         n_boxes =
+0000b360: 2073 756d 285b 6c65 6e28 626f 786c 6973   sum([len(boxlis
+0000b370: 7429 2066 6f72 2062 6f78 6c69 7374 2069  t) for boxlist i
+0000b380: 6e20 662e 626f 7865 732e 7661 6c75 6573  n f.boxes.values
+0000b390: 2829 5d29 0d0a 2020 2020 2020 2020 2020  ()])..          
+0000b3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b3b0: 2020 696d 6775 692e 7465 7874 2866 2241    imgui.text(f"A
+0000b3c0: 6374 6976 6520 736c 6963 6573 2028 7b6c  ctive slices ({l
+0000b3d0: 656e 2866 2e65 6469 7465 645f 736c 6963  en(f.edited_slic
+0000b3e0: 6573 297d 2c20 7b6e 5f62 6f78 6573 7d20  es)}, {n_boxes} 
+0000b3f0: 626f 7865 7329 2229 0d0a 0d0a 2020 2020  boxes)")....    
+0000b400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b410: 2020 2020 2020 2020 696d 6775 692e 6265          imgui.be
+0000b420: 6769 6e5f 6368 696c 6428 2261 6374 6976  gin_child("activ
+0000b430: 655f 736c 6963 6573 222c 2032 3030 2c20  e_slices", 200, 
+0000b440: 5365 676d 656e 7461 7469 6f6e 4564 6974  SegmentationEdit
+0000b450: 6f72 2e41 4354 4956 455f 534c 4943 4553  or.ACTIVE_SLICES
+0000b460: 5f43 4849 4c44 5f48 4549 4748 542c 2054  _CHILD_HEIGHT, T
+0000b470: 7275 6529 0d0a 2020 2020 2020 2020 2020  rue)..          
+0000b480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b490: 2020 6377 203d 2069 6d67 7569 2e67 6574    cw = imgui.get
+0000b4a0: 5f63 6f6e 7465 6e74 5f72 6567 696f 6e5f  _content_region_
+0000b4b0: 6176 6169 6c61 626c 655f 7769 6474 6828  available_width(
+0000b4c0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0000b4d0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0000b4e0: 6f72 2069 2069 6e20 662e 6564 6974 6564  or i in f.edited
+0000b4f0: 5f73 6c69 6365 733a 0d0a 2020 2020 2020  _slices:..      
 0000b500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b510: 696d 6775 692e 7075 7368 5f69 6428 6622  imgui.push_id(f"
-0000b520: 7b66 2e75 6964 7d7b 697d 2229 0d0a 0d0a  {f.uid}{i}")....
-0000b530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b510: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
+0000b520: 7075 7368 5f69 6428 6622 7b66 2e75 6964  push_id(f"{f.uid
+0000b530: 7d7b 697d 2229 0d0a 0d0a 2020 2020 2020  }{i}")....      
 0000b540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b550: 5f2c 206a 756d 7074 6f20 3d20 696d 6775  _, jumpto = imgu
-0000b560: 692e 7365 6c65 6374 6162 6c65 2866 2253  i.selectable(f"S
-0000b570: 6c69 6365 207b 697d 2028 7b6c 656e 2866  lice {i} ({len(f
-0000b580: 2e62 6f78 6573 5b69 5d29 7d20 626f 7865  .boxes[i])} boxe
-0000b590: 7329 222c 2066 2e63 7572 7265 6e74 5f73  s)", f.current_s
-0000b5a0: 6c69 6365 203d 3d20 692c 2077 6964 7468  lice == i, width
-0000b5b0: 3d63 7720 2d20 3233 290d 0a20 2020 2020  =cw - 23)..     
-0000b5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b5d0: 2020 2020 2020 2020 2020 2069 6620 6a75             if ju
-0000b5e0: 6d70 746f 3a0d 0a20 2020 2020 2020 2020  mpto:..         
-0000b5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b600: 2020 2020 2020 2020 2020 2066 2e70 6172             f.par
-0000b610: 656e 742e 7365 745f 736c 6963 6528 6929  ent.set_slice(i)
-0000b620: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000b550: 2020 2020 2020 2020 2020 5f2c 206a 756d            _, jum
+0000b560: 7074 6f20 3d20 696d 6775 692e 7365 6c65  pto = imgui.sele
+0000b570: 6374 6162 6c65 2866 2253 6c69 6365 207b  ctable(f"Slice {
+0000b580: 697d 2028 7b6c 656e 2866 2e62 6f78 6573  i} ({len(f.boxes
+0000b590: 5b69 5d29 7d20 626f 7865 7329 222c 2066  [i])} boxes)", f
+0000b5a0: 2e63 7572 7265 6e74 5f73 6c69 6365 203d  .current_slice =
+0000b5b0: 3d20 692c 2077 6964 7468 3d63 7720 2d20  = i, width=cw - 
+0000b5c0: 3233 290d 0a20 2020 2020 2020 2020 2020  23)..           
+0000b5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b5e0: 2020 2020 2069 6620 6a75 6d70 746f 3a0d       if jumpto:.
+0000b5f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b610: 2020 2020 2066 2e70 6172 656e 742e 7365       f.parent.se
+0000b620: 745f 736c 6963 6528 6929 0d0a 2020 2020  t_slice(i)..    
 0000b630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b640: 2020 2020 2020 5365 676d 656e 7461 7469        Segmentati
-0000b650: 6f6e 4564 6974 6f72 2e46 5241 4d45 5f54  onEditor.FRAME_T
-0000b660: 4558 5455 5245 5f52 4551 5549 5245 535f  EXTURE_REQUIRES_
-0000b670: 5550 4441 5445 207c 3d20 5472 7565 0d0a  UPDATE |= True..
-0000b680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b650: 5365 676d 656e 7461 7469 6f6e 4564 6974  SegmentationEdit
+0000b660: 6f72 2e46 5241 4d45 5f54 4558 5455 5245  or.FRAME_TEXTURE
+0000b670: 5f52 4551 5549 5245 535f 5550 4441 5445  _REQUIRES_UPDATE
+0000b680: 207c 3d20 5472 7565 0d0a 2020 2020 2020   |= True..      
 0000b690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b6a0: 696d 6775 692e 7361 6d65 5f6c 696e 6528  imgui.same_line(
-0000b6b0: 706f 7369 7469 6f6e 3d63 7720 2d20 3529  position=cw - 5)
-0000b6c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000b6a0: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
+0000b6b0: 7361 6d65 5f6c 696e 6528 706f 7369 7469  same_line(positi
+0000b6c0: 6f6e 3d63 7720 2d20 3529 0d0a 2020 2020  on=cw - 5)..    
 0000b6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b6e0: 2020 6966 2069 6d67 7569 2e69 6d61 6765    if imgui.image
-0000b6f0: 5f62 7574 746f 6e28 7365 6c66 2e69 636f  _button(self.ico
-0000b700: 6e5f 636c 6f73 652e 7265 6e64 6572 6572  n_close.renderer
-0000b710: 5f69 642c 2031 332c 2031 3329 3a0d 0a20  _id, 13, 13):.. 
-0000b720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b6e0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+0000b6f0: 6d67 7569 2e69 6d61 6765 5f62 7574 746f  mgui.image_butto
+0000b700: 6e28 7365 6c66 2e69 636f 6e5f 636c 6f73  n(self.icon_clos
+0000b710: 652e 7265 6e64 6572 6572 5f69 642c 2031  e.renderer_id, 1
+0000b720: 332c 2031 3329 3a0d 0a20 2020 2020 2020  3, 13):..       
 0000b730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b740: 2020 2066 2e72 656d 6f76 655f 736c 6963     f.remove_slic
-0000b750: 6528 6929 0d0a 2020 2020 2020 2020 2020  e(i)..          
+0000b740: 2020 2020 2020 2020 2020 2020 2066 2e72               f.r
+0000b750: 656d 6f76 655f 736c 6963 6528 6929 0d0a  emove_slice(i)..
 0000b760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b770: 2020 2020 2020 696d 6775 692e 706f 705f        imgui.pop_
-0000b780: 6964 2829 0d0a 2020 2020 2020 2020 2020  id()..          
+0000b770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b780: 696d 6775 692e 706f 705f 6964 2829 0d0a  imgui.pop_id()..
 0000b790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b7a0: 2020 696d 6775 692e 656e 645f 6368 696c    imgui.end_chil
-0000b7b0: 6428 290d 0a20 2020 2020 2020 2020 2020  d()..           
+0000b7a0: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
+0000b7b0: 692e 656e 645f 6368 696c 6428 290d 0a20  i.end_child().. 
 0000b7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b7d0: 2069 6d67 7569 2e74 6578 7428 2245 7870   imgui.text("Exp
-0000b7e0: 6f72 743a 2229 0d0a 2020 2020 2020 2020  ort:")..        
-0000b7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b800: 2020 2020 6377 203d 2069 6d67 7569 2e67      cw = imgui.g
-0000b810: 6574 5f63 6f6e 7465 6e74 5f72 6567 696f  et_content_regio
-0000b820: 6e5f 6176 6169 6c61 626c 655f 7769 6474  n_available_widt
-0000b830: 6828 290d 0a20 2020 2020 2020 2020 2020  h()..           
+0000b7d0: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
+0000b7e0: 2e74 6578 7428 2245 7870 6f72 743a 2229  .text("Export:")
+0000b7f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000b800: 2020 2020 2020 2020 2020 2020 2020 6377                cw
+0000b810: 203d 2069 6d67 7569 2e67 6574 5f63 6f6e   = imgui.get_con
+0000b820: 7465 6e74 5f72 6567 696f 6e5f 6176 6169  tent_region_avai
+0000b830: 6c61 626c 655f 7769 6474 6828 290d 0a20  lable_width().. 
 0000b840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b850: 2069 6620 696d 6775 692e 6275 7474 6f6e   if imgui.button
-0000b860: 2822 636f 6f72 6473 222c 2028 6377 202d  ("coords", (cw -
-0000b870: 2031 3529 202f 2033 2c20 3135 293a 0d0a   15) / 3, 15):..
-0000b880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b850: 2020 2020 2020 2020 2020 2069 6620 696d             if im
+0000b860: 6775 692e 6275 7474 6f6e 2822 636f 6f72  gui.button("coor
+0000b870: 6473 222c 2028 6377 202d 2031 3529 202f  ds", (cw - 15) /
+0000b880: 2033 2c20 3135 293a 0d0a 2020 2020 2020   3, 15):..      
 0000b890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b8a0: 662e 7361 7665 5f70 6172 7469 636c 655f  f.save_particle_
-0000b8b0: 706f 7369 7469 6f6e 7328 290d 0a20 2020  positions()..   
-0000b8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b8d0: 2020 2020 2020 2020 2069 6d67 7569 2e73           imgui.s
-0000b8e0: 616d 655f 6c69 6e65 2873 7061 6369 6e67  ame_line(spacing
-0000b8f0: 3d35 290d 0a20 2020 2020 2020 2020 2020  =5)..           
+0000b8a0: 2020 2020 2020 2020 2020 662e 7361 7665            f.save
+0000b8b0: 5f70 6172 7469 636c 655f 706f 7369 7469  _particle_positi
+0000b8c0: 6f6e 7328 290d 0a20 2020 2020 2020 2020  ons()..         
+0000b8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b8e0: 2020 2069 6d67 7569 2e73 616d 655f 6c69     imgui.same_li
+0000b8f0: 6e65 2873 7061 6369 6e67 3d35 290d 0a20  ne(spacing=5).. 
 0000b900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b910: 2069 6620 696d 6775 692e 6275 7474 6f6e   if imgui.button
-0000b920: 2822 736c 6963 6522 2c20 2863 7720 2d20  ("slice", (cw - 
-0000b930: 3135 2920 2f20 332c 2031 3529 3a0d 0a20  15) / 3, 15):.. 
-0000b940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b950: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0000b960: 2e73 6176 655f 6375 7272 656e 745f 736c  .save_current_sl
-0000b970: 6963 6528 290d 0a20 2020 2020 2020 2020  ice()..         
-0000b980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b990: 2020 2069 6d67 7569 2e73 616d 655f 6c69     imgui.same_li
-0000b9a0: 6e65 2873 7061 6369 6e67 3d35 290d 0a20  ne(spacing=5).. 
-0000b9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b9c0: 2020 2020 2020 2020 2020 2069 6620 696d             if im
-0000b9d0: 6775 692e 6275 7474 6f6e 2822 766f 6c75  gui.button("volu
-0000b9e0: 6d65 222c 2028 6377 202d 2031 3529 202f  me", (cw - 15) /
-0000b9f0: 2033 2c20 3135 293a 0d0a 2020 2020 2020   3, 15):..      
-0000ba00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ba10: 2020 2020 2020 2020 2020 662e 7361 7665            f.save
-0000ba20: 5f76 6f6c 756d 6528 290d 0a20 2020 2020  _volume()..     
-0000ba30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ba40: 2020 2020 2020 2069 6d67 7569 2e70 6f70         imgui.pop
-0000ba50: 5f73 7479 6c65 5f63 6f6c 6f72 2833 290d  _style_color(3).
-0000ba60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000ba70: 2020 2020 2020 2020 2020 2020 2069 6d67               img
-0000ba80: 7569 2e65 6e64 5f6d 656e 7528 290d 0a0d  ui.end_menu()...
-0000ba90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000baa0: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
-0000bab0: 6f70 5f73 7479 6c65 5f63 6f6c 6f72 2833  op_style_color(3
-0000bac0: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
-0000bad0: 2020 2020 2020 2020 2020 2020 2069 6d67               img
-0000bae0: 7569 2e70 6f70 5f73 7479 6c65 5f76 6172  ui.pop_style_var
-0000baf0: 2835 290d 0a20 2020 2020 2020 2020 2020  (5)..           
-0000bb00: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0000bb10: 706f 705f 6163 7469 7665 5f63 6f6c 6f75  pop_active_colou
-0000bb20: 723a 0d0a 2020 2020 2020 2020 2020 2020  r:..            
-0000bb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bb40: 696d 6775 692e 706f 705f 7374 796c 655f  imgui.pop_style_
-0000bb50: 636f 6c6f 7228 3129 0d0a 0d0a 2020 2020  color(1)....    
-0000bb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bb70: 2020 2020 6966 2064 656c 6574 655f 6665      if delete_fe
-0000bb80: 6174 7572 653a 0d0a 2020 2020 2020 2020  ature:..        
-0000bb90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bba0: 2020 2020 6366 672e 7365 5f61 6374 6976      cfg.se_activ
-0000bbb0: 655f 6672 616d 652e 6665 6174 7572 6573  e_frame.features
-0000bbc0: 2e72 656d 6f76 6528 6629 0d0a 2020 2020  .remove(f)..    
-0000bbd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bbe0: 2020 2020 2020 2020 6966 2063 6667 2e73          if cfg.s
-0000bbf0: 655f 6163 7469 7665 5f66 7261 6d65 2e61  e_active_frame.a
-0000bc00: 6374 6976 655f 6665 6174 7572 6520 3d3d  ctive_feature ==
-0000bc10: 2066 3a0d 0a20 2020 2020 2020 2020 2020   f:..           
-0000bc20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bc30: 2020 2020 2063 6667 2e73 655f 6163 7469       cfg.se_acti
-0000bc40: 7665 5f66 7261 6d65 2e61 6374 6976 655f  ve_frame.active_
-0000bc50: 6665 6174 7572 6520 3d20 4e6f 6e65 0d0a  feature = None..
-0000bc60: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000bc70: 2020 2020 2020 2020 2020 6966 2069 6d67            if img
-0000bc80: 7569 2e69 735f 7769 6e64 6f77 5f68 6f76  ui.is_window_hov
-0000bc90: 6572 6564 2829 2061 6e64 2069 6d67 7569  ered() and imgui
-0000bca0: 2e69 735f 6d6f 7573 655f 636c 6963 6b65  .is_mouse_clicke
-0000bcb0: 6428 3029 3a0d 0a20 2020 2020 2020 2020  d(0):..         
-0000bcc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bcd0: 2020 2063 6667 2e73 655f 6163 7469 7665     cfg.se_active
-0000bce0: 5f66 7261 6d65 2e61 6374 6976 655f 6665  _frame.active_fe
-0000bcf0: 6174 7572 6520 3d20 660d 0a0d 0a0d 0a20  ature = f...... 
+0000b910: 2020 2020 2020 2020 2020 2069 6620 696d             if im
+0000b920: 6775 692e 6275 7474 6f6e 2822 736c 6963  gui.button("slic
+0000b930: 6522 2c20 2863 7720 2d20 3135 2920 2f20  e", (cw - 15) / 
+0000b940: 332c 2031 3529 3a0d 0a20 2020 2020 2020  3, 15):..       
+0000b950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b960: 2020 2020 2020 2020 2066 2e73 6176 655f           f.save_
+0000b970: 6375 7272 656e 745f 736c 6963 6528 290d  current_slice().
+0000b980: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b990: 2020 2020 2020 2020 2020 2020 2069 6d67               img
+0000b9a0: 7569 2e73 616d 655f 6c69 6e65 2873 7061  ui.same_line(spa
+0000b9b0: 6369 6e67 3d35 290d 0a20 2020 2020 2020  cing=5)..       
+0000b9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b9d0: 2020 2020 2069 6620 696d 6775 692e 6275       if imgui.bu
+0000b9e0: 7474 6f6e 2822 766f 6c75 6d65 222c 2028  tton("volume", (
+0000b9f0: 6377 202d 2031 3529 202f 2033 2c20 3135  cw - 15) / 3, 15
+0000ba00: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+0000ba10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ba20: 2020 2020 662e 7361 7665 5f76 6f6c 756d      f.save_volum
+0000ba30: 6528 290d 0a0d 0a20 2020 2020 2020 2020  e()....         
+0000ba40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ba50: 2020 2023 2049 6d70 6f72 740d 0a20 2020     # Import..   
+0000ba60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ba70: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
+0000ba80: 7573 685f 6964 2866 227b 662e 7569 647d  ush_id(f"{f.uid}
+0000ba90: 5f69 6d70 6f72 7422 290d 0a20 2020 2020  _import")..     
+0000baa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bab0: 2020 2020 2020 2069 6d67 7569 2e74 6578         imgui.tex
+0000bac0: 7428 2249 6d70 6f72 743a 2229 0d0a 2020  t("Import:")..  
+0000bad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bae0: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
+0000baf0: 7075 7368 5f69 7465 6d5f 7769 6474 6828  push_item_width(
+0000bb00: 2863 7720 2d20 3135 2920 2f20 3329 0d0a  (cw - 15) / 3)..
+0000bb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bb20: 2020 2020 2020 2020 2020 2020 5f2c 2053              _, S
+0000bb30: 6567 6d65 6e74 6174 696f 6e45 6469 746f  egmentationEdito
+0000bb40: 722e 4645 4154 5552 455f 494d 504f 5254  r.FEATURE_IMPORT
+0000bb50: 5f4d 5243 5f54 4852 4553 484f 4c44 203d  _MRC_THRESHOLD =
+0000bb60: 2069 6d67 7569 2e73 6c69 6465 725f 696e   imgui.slider_in
+0000bb70: 7428 2223 2366 7468 736c 696e 7422 2c20  t("##fthslint", 
+0000bb80: 5365 676d 656e 7461 7469 6f6e 4564 6974  SegmentationEdit
+0000bb90: 6f72 2e46 4541 5455 5245 5f49 4d50 4f52  or.FEATURE_IMPOR
+0000bba0: 545f 4d52 435f 5448 5245 5348 4f4c 442c  T_MRC_THRESHOLD,
+0000bbb0: 2030 2c20 3235 3529 0d0a 2020 2020 2020   0, 255)..      
+0000bbc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bbd0: 2020 2020 2020 696d 6775 692e 7361 6d65        imgui.same
+0000bbe0: 5f6c 696e 6528 7370 6163 696e 673d 3529  _line(spacing=5)
+0000bbf0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000bc00: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0000bc10: 2069 6d67 7569 2e62 7574 746f 6e28 2273   imgui.button("s
+0000bc20: 6c69 6365 222c 2028 6377 202d 2031 3529  lice", (cw - 15)
+0000bc30: 202f 2033 2c20 3135 293a 0d0a 2020 2020   / 3, 15):..    
+0000bc40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bc50: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+0000bc60: 7428 3129 0d0a 2020 2020 2020 2020 2020  t(1)..          
+0000bc70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bc80: 2020 2020 2020 7061 7468 203d 2066 696c        path = fil
+0000bc90: 6564 6961 6c6f 672e 6173 6b6f 7065 6e66  edialog.askopenf
+0000bca0: 696c 656e 616d 6528 6669 6c65 7479 7065  ilename(filetype
+0000bcb0: 733d 5b28 226d 7263 6669 6c65 222c 2066  s=[("mrcfile", f
+0000bcc0: 222e 6d72 6322 295d 290d 0a20 2020 2020  ".mrc")])..     
+0000bcd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bce0: 2020 2020 2020 2020 2020 2069 6620 7061             if pa
+0000bcf0: 7468 2021 3d20 2222 3a0d 0a20 2020 2020  th != "":..     
 0000bd00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bd10: 2020 2020 2020 2069 6d67 7569 2e65 6e64         imgui.end
-0000bd20: 5f63 6869 6c64 2829 0d0a 0d0a 2020 2020  _child()....    
+0000bd10: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+0000bd20: 7279 3a0d 0a20 2020 2020 2020 2020 2020  ry:..           
 0000bd30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bd40: 2320 2741 6464 2066 6561 7475 7265 2720  # 'Add feature' 
-0000bd50: 6275 7474 6f6e 0d0a 2020 2020 2020 2020  button..        
-0000bd60: 2020 2020 2020 2020 2020 2020 6377 203d              cw =
-0000bd70: 2069 6d67 7569 2e67 6574 5f63 6f6e 7465   imgui.get_conte
-0000bd80: 6e74 5f72 6567 696f 6e5f 6176 6169 6c61  nt_region_availa
-0000bd90: 626c 655f 7769 6474 6828 290d 0a20 2020  ble_width()..   
+0000bd40: 2020 2020 2020 2020 2020 2020 2066 2e69               f.i
+0000bd50: 6d70 6f72 745f 736c 6963 6528 7061 7468  mport_slice(path
+0000bd60: 2c20 7468 7265 7368 6f6c 643d 5365 676d  , threshold=Segm
+0000bd70: 656e 7461 7469 6f6e 4564 6974 6f72 2e46  entationEditor.F
+0000bd80: 4541 5455 5245 5f49 4d50 4f52 545f 4d52  EATURE_IMPORT_MR
+0000bd90: 435f 5448 5245 5348 4f4c 4429 0d0a 2020  C_THRESHOLD)..  
 0000bda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bdb0: 2069 6d67 7569 2e70 7573 685f 7374 796c   imgui.push_styl
-0000bdc0: 655f 7661 7228 696d 6775 692e 5354 594c  e_var(imgui.STYL
-0000bdd0: 455f 4652 414d 455f 524f 554e 4449 4e47  E_FRAME_ROUNDING
-0000bde0: 2c20 3130 290d 0a0d 0a20 2020 2020 2020  , 10)....       
-0000bdf0: 2020 2020 2020 2020 2020 2020 2069 6d67               img
-0000be00: 7569 2e6e 6577 5f6c 696e 6528 290d 0a20  ui.new_line().. 
-0000be10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000be20: 2020 2069 6d67 7569 2e73 616d 655f 6c69     imgui.same_li
-0000be30: 6e65 2873 7061 6369 6e67 3d28 6377 202d  ne(spacing=(cw -
-0000be40: 2031 3230 2920 2f20 3229 0d0a 2020 2020   120) / 2)..    
+0000bdb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bdc0: 2020 6578 6365 7074 2045 7863 6570 7469    except Excepti
+0000bdd0: 6f6e 2061 7320 653a 0d0a 2020 2020 2020  on as e:..      
+0000bde0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bdf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000be00: 2020 6366 672e 7365 745f 6572 726f 7228    cfg.set_error(
+0000be10: 652c 2066 2243 6f75 6c64 206e 6f74 2069  e, f"Could not i
+0000be20: 6e69 7469 616c 697a 6520 4665 6174 7572  nitialize Featur
+0000be30: 6520 7573 696e 6720 6d72 6320 6669 6c65  e using mrc file
+0000be40: 207b 7061 7468 7d22 290d 0a20 2020 2020   {path}")..     
 0000be50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000be60: 6966 2069 6d67 7569 2e62 7574 746f 6e28  if imgui.button(
-0000be70: 2241 6464 2066 6561 7475 7265 222c 2031  "Add feature", 1
-0000be80: 3230 2c20 3233 293a 0d0a 2020 2020 2020  20, 23):..      
-0000be90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bea0: 2020 6366 672e 7365 5f61 6374 6976 655f    cfg.se_active_
-0000beb0: 6672 616d 652e 6665 6174 7572 6573 2e61  frame.features.a
-0000bec0: 7070 656e 6428 5365 676d 656e 7461 7469  ppend(Segmentati
-0000bed0: 6f6e 2863 6667 2e73 655f 6163 7469 7665  on(cfg.se_active
-0000bee0: 5f66 7261 6d65 2c20 6622 556e 6e61 6d65  _frame, f"Unname
-0000bef0: 6420 6665 6174 7572 6520 7b6c 656e 2863  d feature {len(c
-0000bf00: 6667 2e73 655f 6163 7469 7665 5f66 7261  fg.se_active_fra
-0000bf10: 6d65 2e66 6561 7475 7265 7329 2b31 7d22  me.features)+1}"
-0000bf20: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
-0000bf30: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000bf40: 2e70 6172 7365 5f61 7661 696c 6162 6c65  .parse_available
-0000bf50: 5f66 6561 7475 7265 7328 290d 0a20 2020  _features()..   
+0000be60: 2020 2020 2020 2069 6d67 7569 2e73 616d         imgui.sam
+0000be70: 655f 6c69 6e65 2873 7061 6369 6e67 3d35  e_line(spacing=5
+0000be80: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0000be90: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0000bea0: 6620 696d 6775 692e 6275 7474 6f6e 2822  f imgui.button("
+0000beb0: 766f 6c75 6d65 222c 2028 6377 202d 2031  volume", (cw - 1
+0000bec0: 3529 202f 2033 2c20 3135 293a 0d0a 2020  5) / 3, 15):..  
+0000bed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bee0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+0000bef0: 696e 7428 3029 0d0a 2020 2020 2020 2020  int(0)..        
+0000bf00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bf10: 2020 2020 2020 2020 7061 7468 203d 2066          path = f
+0000bf20: 696c 6564 6961 6c6f 672e 6173 6b6f 7065  iledialog.askope
+0000bf30: 6e66 696c 656e 616d 6528 6669 6c65 7479  nfilename(filety
+0000bf40: 7065 733d 5b28 226d 7263 6669 6c65 222c  pes=[("mrcfile",
+0000bf50: 2066 222e 6d72 6322 295d 290d 0a20 2020   f".mrc")])..   
 0000bf60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bf70: 2069 6d67 7569 2e70 6f70 5f73 7479 6c65   imgui.pop_style
-0000bf80: 5f76 6172 2831 290d 0a0d 0a0d 0a20 2020  _var(1)......   
-0000bf90: 2020 2020 2020 2020 2066 6561 7475 7265           feature
-0000bfa0: 735f 7061 6e65 6c28 290d 0a0d 0a20 2020  s_panel()....   
-0000bfb0: 2020 2020 2064 6566 206d 6f64 656c 735f       def models_
-0000bfc0: 7461 6228 293a 0d0a 2020 2020 2020 2020  tab():..        
-0000bfd0: 2020 2020 6465 6620 6361 6c63 756c 6174      def calculat
-0000bfe0: 655f 6e75 6d62 6572 5f6f 665f 626f 7865  e_number_of_boxe
-0000bff0: 7328 293a 0d0a 2020 2020 2020 2020 2020  s():..          
-0000c000: 2020 2020 2020 7365 6c66 2e74 7261 696e        self.train
-0000c010: 7365 745f 6e75 6d5f 626f 7865 735f 706f  set_num_boxes_po
-0000c020: 7369 7469 7665 203d 2030 0d0a 2020 2020  sitive = 0..    
-0000c030: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000c040: 2e74 7261 696e 7365 745f 6e75 6d5f 626f  .trainset_num_bo
-0000c050: 7865 735f 6e65 6761 7469 7665 203d 2030  xes_negative = 0
-0000c060: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000c070: 2020 666f 7220 7320 696e 2063 6667 2e73    for s in cfg.s
-0000c080: 655f 6672 616d 6573 3a0d 0a20 2020 2020  e_frames:..     
-0000c090: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0000c0a0: 6620 732e 7361 6d70 6c65 3a0d 0a20 2020  f s.sample:..   
-0000c0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c0c0: 2020 2020 2066 6f72 2066 2069 6e20 732e       for f in s.
-0000c0d0: 6665 6174 7572 6573 3a0d 0a20 2020 2020  features:..     
+0000bf70: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0000bf80: 7061 7468 2021 3d20 2222 3a0d 0a20 2020  path != "":..   
+0000bf90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bfa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bfb0: 2074 7279 3a0d 0a20 2020 2020 2020 2020   try:..         
+0000bfc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bfd0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0000bfe0: 2e69 6d70 6f72 745f 6d72 6328 7061 7468  .import_mrc(path
+0000bff0: 2c20 7468 7265 7368 6f6c 643d 5365 676d  , threshold=Segm
+0000c000: 656e 7461 7469 6f6e 4564 6974 6f72 2e46  entationEditor.F
+0000c010: 4541 5455 5245 5f49 4d50 4f52 545f 4d52  EATURE_IMPORT_MR
+0000c020: 435f 5448 5245 5348 4f4c 4429 0d0a 2020  C_THRESHOLD)..  
+0000c030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c050: 2020 6578 6365 7074 2045 7863 6570 7469    except Excepti
+0000c060: 6f6e 2061 7320 653a 0d0a 2020 2020 2020  on as e:..      
+0000c070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c090: 2020 6366 672e 7365 745f 6572 726f 7228    cfg.set_error(
+0000c0a0: 652c 2066 2243 6f75 6c64 206e 6f74 2069  e, f"Could not i
+0000c0b0: 6e69 7469 616c 697a 6520 4665 6174 7572  nitialize Featur
+0000c0c0: 6520 7573 696e 6720 6d72 6320 6669 6c65  e using mrc file
+0000c0d0: 207b 7061 7468 7d22 290d 0a20 2020 2020   {path}")..     
 0000c0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c0f0: 2020 2020 2020 2069 6620 7365 6c66 2e74         if self.t
-0000c100: 7261 696e 7365 745f 6665 6174 7572 655f  rainset_feature_
-0000c110: 7365 6c65 6374 696f 6e5b 662e 7469 746c  selection[f.titl
-0000c120: 655d 203d 3d20 313a 0d0a 2020 2020 2020  e] == 1:..      
-0000c130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c140: 2020 2020 2020 2020 2020 7365 6c66 2e74            self.t
-0000c150: 7261 696e 7365 745f 6e75 6d5f 626f 7865  rainset_num_boxe
-0000c160: 735f 706f 7369 7469 7665 202b 3d20 662e  s_positive += f.
-0000c170: 6e5f 626f 7865 730d 0a20 2020 2020 2020  n_boxes..       
-0000c180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c190: 2020 2020 2065 6c69 6620 7365 6c66 2e74       elif self.t
-0000c1a0: 7261 696e 7365 745f 6665 6174 7572 655f  rainset_feature_
-0000c1b0: 7365 6c65 6374 696f 6e5b 662e 7469 746c  selection[f.titl
-0000c1c0: 655d 203d 3d20 2d31 3a0d 0a20 2020 2020  e] == -1:..     
-0000c1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c1e0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000c1f0: 7472 6169 6e73 6574 5f6e 756d 5f62 6f78  trainset_num_box
-0000c200: 6573 5f6e 6567 6174 6976 6520 2b3d 2066  es_negative += f
-0000c210: 2e6e 5f62 6f78 6573 0d0a 0d0a 0d0a 2020  .n_boxes......  
-0000c220: 2020 2020 2020 2020 2020 6966 2069 6d67            if img
-0000c230: 7569 2e63 6f6c 6c61 7073 696e 675f 6865  ui.collapsing_he
-0000c240: 6164 6572 2822 4372 6561 7465 2061 2074  ader("Create a t
-0000c250: 7261 696e 696e 6720 7365 7422 2c20 4e6f  raining set", No
-0000c260: 6e65 295b 305d 3a0d 0a20 2020 2020 2020  ne)[0]:..       
-0000c270: 2020 2020 2020 2020 2073 656c 662e 7368           self.sh
-0000c280: 6f77 5f74 7261 696e 7365 745f 626f 7865  ow_trainset_boxe
-0000c290: 7320 3d20 5472 7565 0d0a 2020 2020 2020  s = True..      
-0000c2a0: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
-0000c2b0: 7075 7368 5f73 7479 6c65 5f76 6172 2869  push_style_var(i
-0000c2c0: 6d67 7569 2e53 5459 4c45 5f46 5241 4d45  mgui.STYLE_FRAME
-0000c2d0: 5f52 4f55 4e44 494e 472c 2031 3029 0d0a  _ROUNDING, 10)..
-0000c2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c2f0: 696d 6775 692e 7075 7368 5f73 7479 6c65  imgui.push_style
-0000c300: 5f76 6172 2869 6d67 7569 2e53 5459 4c45  _var(imgui.STYLE
-0000c310: 5f47 5241 425f 524f 554e 4449 4e47 2c20  _GRAB_ROUNDING, 
-0000c320: 3230 290d 0a20 2020 2020 2020 2020 2020  20)..           
-0000c330: 2020 2020 2069 6d67 7569 2e70 7573 685f       imgui.push_
-0000c340: 7374 796c 655f 7661 7228 696d 6775 692e  style_var(imgui.
-0000c350: 5354 594c 455f 4652 414d 455f 424f 5244  STYLE_FRAME_BORD
-0000c360: 4552 5349 5a45 2c20 3129 0d0a 2020 2020  ERSIZE, 1)..    
-0000c370: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
-0000c380: 692e 7075 7368 5f73 7479 6c65 5f76 6172  i.push_style_var
-0000c390: 2869 6d67 7569 2e53 5459 4c45 5f47 5241  (imgui.STYLE_GRA
-0000c3a0: 425f 4d49 4e5f 5349 5a45 2c20 3929 0d0a  B_MIN_SIZE, 9)..
-0000c3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c3c0: 696d 6775 692e 7075 7368 5f73 7479 6c65  imgui.push_style
-0000c3d0: 5f76 6172 2869 6d67 7569 2e53 5459 4c45  _var(imgui.STYLE
-0000c3e0: 5f46 5241 4d45 5f50 4144 4449 4e47 2c20  _FRAME_PADDING, 
-0000c3f0: 2830 2c20 3229 290d 0a0d 0a20 2020 2020  (0, 2))....     
-0000c400: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
-0000c410: 2e74 6578 7428 2246 6561 7475 7265 7320  .text("Features 
-0000c420: 6f66 2069 6e74 6572 6573 7422 290d 0a20  of interest").. 
-0000c430: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0000c440: 6d67 7569 2e62 6567 696e 5f63 6869 6c64  mgui.begin_child
-0000c450: 2822 7365 6c65 6374 5f66 6561 7475 7265  ("select_feature
-0000c460: 7322 2c20 302e 302c 2031 202b 206c 656e  s", 0.0, 1 + len
-0000c470: 2873 656c 662e 616c 6c5f 6665 6174 7572  (self.all_featur
-0000c480: 655f 6e61 6d65 7329 202a 2032 312c 2046  e_names) * 21, F
-0000c490: 616c 7365 2c20 696d 6775 692e 5749 4e44  alse, imgui.WIND
-0000c4a0: 4f57 5f4e 4f5f 5343 524f 4c4c 4241 5229  OW_NO_SCROLLBAR)
-0000c4b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000c4c0: 2020 696d 6775 692e 7075 7368 5f73 7479    imgui.push_sty
-0000c4d0: 6c65 5f63 6f6c 6f72 2869 6d67 7569 2e43  le_color(imgui.C
-0000c4e0: 4f4c 4f52 5f46 5241 4d45 5f42 4143 4b47  OLOR_FRAME_BACKG
-0000c4f0: 524f 554e 442c 202a 6366 672e 434f 4c4f  ROUND, *cfg.COLO
-0000c500: 5552 5f4e 4555 5452 414c 5f4c 4947 4854  UR_NEUTRAL_LIGHT
-0000c510: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0000c520: 2020 2063 7720 3d20 696d 6775 692e 6765     cw = imgui.ge
-0000c530: 745f 636f 6e74 656e 745f 7265 6769 6f6e  t_content_region
-0000c540: 5f61 7661 696c 6162 6c65 5f77 6964 7468  _available_width
-0000c550: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
-0000c560: 2020 2020 696d 6775 692e 7075 7368 5f69      imgui.push_i
-0000c570: 7465 6d5f 7769 6474 6828 6377 290d 0a20  tem_width(cw).. 
-0000c580: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0000c590: 6f72 2066 6e61 6d65 2069 6e20 7365 6c66  or fname in self
-0000c5a0: 2e61 6c6c 5f66 6561 7475 7265 5f6e 616d  .all_feature_nam
-0000c5b0: 6573 3a0d 0a20 2020 2020 2020 2020 2020  es:..           
-0000c5c0: 2020 2020 2020 2020 2076 616c 203d 2073           val = s
-0000c5d0: 656c 662e 7472 6169 6e73 6574 5f66 6561  elf.trainset_fea
-0000c5e0: 7475 7265 5f73 656c 6563 7469 6f6e 5b66  ture_selection[f
-0000c5f0: 6e61 6d65 5d0d 0a20 2020 2020 2020 2020  name]..         
-0000c600: 2020 2020 2020 2020 2020 2069 6620 7661             if va
-0000c610: 6c20 3d3d 2031 3a0d 0a20 2020 2020 2020  l == 1:..       
-0000c620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c630: 2069 6d67 7569 2e70 7573 685f 7374 796c   imgui.push_styl
-0000c640: 655f 636f 6c6f 7228 696d 6775 692e 434f  e_color(imgui.CO
-0000c650: 4c4f 525f 534c 4944 4552 5f47 5241 422c  LOR_SLIDER_GRAB,
-0000c660: 202a 6366 672e 434f 4c4f 5552 5f50 4f53   *cfg.COLOUR_POS
-0000c670: 4954 4956 4529 0d0a 2020 2020 2020 2020  ITIVE)..        
-0000c680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c690: 696d 6775 692e 7075 7368 5f73 7479 6c65  imgui.push_style
-0000c6a0: 5f63 6f6c 6f72 2869 6d67 7569 2e43 4f4c  _color(imgui.COL
-0000c6b0: 4f52 5f53 4c49 4445 525f 4752 4142 5f41  OR_SLIDER_GRAB_A
-0000c6c0: 4354 4956 452c 202a 6366 672e 434f 4c4f  CTIVE, *cfg.COLO
-0000c6d0: 5552 5f50 4f53 4954 4956 4529 0d0a 2020  UR_POSITIVE)..  
-0000c6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c6f0: 2020 656c 6966 2076 616c 203d 3d20 303a    elif val == 0:
-0000c700: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000c710: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
-0000c720: 7075 7368 5f73 7479 6c65 5f63 6f6c 6f72  push_style_color
-0000c730: 2869 6d67 7569 2e43 4f4c 4f52 5f53 4c49  (imgui.COLOR_SLI
-0000c740: 4445 525f 4752 4142 2c20 2a63 6667 2e43  DER_GRAB, *cfg.C
-0000c750: 4f4c 4f55 525f 4e45 5554 5241 4c29 0d0a  OLOUR_NEUTRAL)..
-0000c760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c770: 2020 2020 2020 2020 696d 6775 692e 7075          imgui.pu
-0000c780: 7368 5f73 7479 6c65 5f63 6f6c 6f72 2869  sh_style_color(i
-0000c790: 6d67 7569 2e43 4f4c 4f52 5f53 4c49 4445  mgui.COLOR_SLIDE
-0000c7a0: 525f 4752 4142 5f41 4354 4956 452c 202a  R_GRAB_ACTIVE, *
-0000c7b0: 6366 672e 434f 4c4f 5552 5f4e 4555 5452  cfg.COLOUR_NEUTR
-0000c7c0: 414c 290d 0a20 2020 2020 2020 2020 2020  AL)..           
-0000c7d0: 2020 2020 2020 2020 2065 6c69 6620 7661           elif va
-0000c7e0: 6c20 3d3d 202d 313a 0d0a 2020 2020 2020  l == -1:..      
-0000c7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c800: 2020 696d 6775 692e 7075 7368 5f73 7479    imgui.push_sty
-0000c810: 6c65 5f63 6f6c 6f72 2869 6d67 7569 2e43  le_color(imgui.C
-0000c820: 4f4c 4f52 5f53 4c49 4445 525f 4752 4142  OLOR_SLIDER_GRAB
-0000c830: 2c20 2a63 6667 2e43 4f4c 4f55 525f 4e45  , *cfg.COLOUR_NE
-0000c840: 4741 5449 5645 290d 0a20 2020 2020 2020  GATIVE)..       
-0000c850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c860: 2069 6d67 7569 2e70 7573 685f 7374 796c   imgui.push_styl
-0000c870: 655f 636f 6c6f 7228 696d 6775 692e 434f  e_color(imgui.CO
-0000c880: 4c4f 525f 534c 4944 4552 5f47 5241 425f  LOR_SLIDER_GRAB_
-0000c890: 4143 5449 5645 2c20 2a63 6667 2e43 4f4c  ACTIVE, *cfg.COL
-0000c8a0: 4f55 525f 4e45 4741 5449 5645 290d 0a20  OUR_NEGATIVE).. 
+0000c0f0: 2020 2020 2020 2069 6d67 7569 2e70 6f70         imgui.pop
+0000c100: 5f73 7479 6c65 5f63 6f6c 6f72 2833 290d  _style_color(3).
+0000c110: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000c120: 2020 2020 2020 2020 2020 2020 2069 6d67               img
+0000c130: 7569 2e70 6f70 5f69 6428 290d 0a20 2020  ui.pop_id()..   
+0000c140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c150: 2020 2020 2020 2020 2069 6d67 7569 2e65           imgui.e
+0000c160: 6e64 5f6d 656e 7528 290d 0a0d 0a20 2020  nd_menu()....   
+0000c170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c180: 2020 2020 2069 6d67 7569 2e70 6f70 5f73       imgui.pop_s
+0000c190: 7479 6c65 5f63 6f6c 6f72 2833 290d 0a0d  tyle_color(3)...
+0000c1a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000c1b0: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
+0000c1c0: 6f70 5f73 7479 6c65 5f76 6172 2835 290d  op_style_var(5).
+0000c1d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000c1e0: 2020 2020 2020 2020 2069 6620 706f 705f           if pop_
+0000c1f0: 6163 7469 7665 5f63 6f6c 6f75 723a 0d0a  active_colour:..
+0000c200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c210: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
+0000c220: 692e 706f 705f 7374 796c 655f 636f 6c6f  i.pop_style_colo
+0000c230: 7228 3129 0d0a 0d0a 2020 2020 2020 2020  r(1)....        
+0000c240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c250: 6966 2064 656c 6574 655f 6665 6174 7572  if delete_featur
+0000c260: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+0000c270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c280: 6366 672e 7365 5f61 6374 6976 655f 6672  cfg.se_active_fr
+0000c290: 616d 652e 6665 6174 7572 6573 2e72 656d  ame.features.rem
+0000c2a0: 6f76 6528 6629 0d0a 2020 2020 2020 2020  ove(f)..        
+0000c2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c2c0: 2020 2020 6966 2063 6667 2e73 655f 6163      if cfg.se_ac
+0000c2d0: 7469 7665 5f66 7261 6d65 2e61 6374 6976  tive_frame.activ
+0000c2e0: 655f 6665 6174 7572 6520 3d3d 2066 3a0d  e_feature == f:.
+0000c2f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000c300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c310: 2063 6667 2e73 655f 6163 7469 7665 5f66   cfg.se_active_f
+0000c320: 7261 6d65 2e61 6374 6976 655f 6665 6174  rame.active_feat
+0000c330: 7572 6520 3d20 4e6f 6e65 0d0a 0d0a 2020  ure = None....  
+0000c340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c350: 2020 2020 2020 6966 2069 6d67 7569 2e69        if imgui.i
+0000c360: 735f 7769 6e64 6f77 5f68 6f76 6572 6564  s_window_hovered
+0000c370: 2829 2061 6e64 2069 6d67 7569 2e69 735f  () and imgui.is_
+0000c380: 6d6f 7573 655f 636c 6963 6b65 6428 3029  mouse_clicked(0)
+0000c390: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0000c3a0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0000c3b0: 6667 2e73 655f 6163 7469 7665 5f66 7261  fg.se_active_fra
+0000c3c0: 6d65 2e61 6374 6976 655f 6665 6174 7572  me.active_featur
+0000c3d0: 6520 3d20 660d 0a0d 0a0d 0a20 2020 2020  e = f......     
+0000c3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c3f0: 2020 2069 6d67 7569 2e65 6e64 5f63 6869     imgui.end_chi
+0000c400: 6c64 2829 0d0a 0d0a 2020 2020 2020 2020  ld()....        
+0000c410: 2020 2020 2020 2020 2020 2020 2320 2741              # 'A
+0000c420: 6464 2066 6561 7475 7265 2720 6275 7474  dd feature' butt
+0000c430: 6f6e 0d0a 2020 2020 2020 2020 2020 2020  on..            
+0000c440: 2020 2020 2020 2020 6377 203d 2069 6d67          cw = img
+0000c450: 7569 2e67 6574 5f63 6f6e 7465 6e74 5f72  ui.get_content_r
+0000c460: 6567 696f 6e5f 6176 6169 6c61 626c 655f  egion_available_
+0000c470: 7769 6474 6828 290d 0a20 2020 2020 2020  width()..       
+0000c480: 2020 2020 2020 2020 2020 2020 2069 6d67               img
+0000c490: 7569 2e70 7573 685f 7374 796c 655f 7661  ui.push_style_va
+0000c4a0: 7228 696d 6775 692e 5354 594c 455f 4652  r(imgui.STYLE_FR
+0000c4b0: 414d 455f 524f 554e 4449 4e47 2c20 3130  AME_ROUNDING, 10
+0000c4c0: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
+0000c4d0: 2020 2020 2020 2020 2069 6d67 7569 2e6e           imgui.n
+0000c4e0: 6577 5f6c 696e 6528 290d 0a20 2020 2020  ew_line()..     
+0000c4f0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0000c500: 6d67 7569 2e73 616d 655f 6c69 6e65 2873  mgui.same_line(s
+0000c510: 7061 6369 6e67 3d28 6377 202d 2031 3230  pacing=(cw - 120
+0000c520: 2920 2f20 3229 0d0a 2020 2020 2020 2020  ) / 2)..        
+0000c530: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+0000c540: 6d67 7569 2e62 7574 746f 6e28 2241 6464  mgui.button("Add
+0000c550: 2066 6561 7475 7265 222c 2031 3230 2c20   feature", 120, 
+0000c560: 3233 293a 0d0a 2020 2020 2020 2020 2020  23):..          
+0000c570: 2020 2020 2020 2020 2020 2020 2020 6366                cf
+0000c580: 672e 7365 5f61 6374 6976 655f 6672 616d  g.se_active_fram
+0000c590: 652e 6665 6174 7572 6573 2e61 7070 656e  e.features.appen
+0000c5a0: 6428 5365 676d 656e 7461 7469 6f6e 2863  d(Segmentation(c
+0000c5b0: 6667 2e73 655f 6163 7469 7665 5f66 7261  fg.se_active_fra
+0000c5c0: 6d65 2c20 6622 556e 6e61 6d65 6420 6665  me, f"Unnamed fe
+0000c5d0: 6174 7572 6520 7b6c 656e 2863 6667 2e73  ature {len(cfg.s
+0000c5e0: 655f 6163 7469 7665 5f66 7261 6d65 2e66  e_active_frame.f
+0000c5f0: 6561 7475 7265 7329 2b31 7d22 2929 0d0a  eatures)+1}"))..
+0000c600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c610: 2020 2020 2020 2020 7365 6c66 2e70 6172          self.par
+0000c620: 7365 5f61 7661 696c 6162 6c65 5f66 6561  se_available_fea
+0000c630: 7475 7265 7328 290d 0a20 2020 2020 2020  tures()..       
+0000c640: 2020 2020 2020 2020 2020 2020 2069 6d67               img
+0000c650: 7569 2e70 6f70 5f73 7479 6c65 5f76 6172  ui.pop_style_var
+0000c660: 2831 290d 0a0d 0a0d 0a20 2020 2020 2020  (1)......       
+0000c670: 2020 2020 2066 6561 7475 7265 735f 7061       features_pa
+0000c680: 6e65 6c28 290d 0a0d 0a20 2020 2020 2020  nel()....       
+0000c690: 2064 6566 206d 6f64 656c 735f 7461 6228   def models_tab(
+0000c6a0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+0000c6b0: 6465 6620 6361 6c63 756c 6174 655f 6e75  def calculate_nu
+0000c6c0: 6d62 6572 5f6f 665f 626f 7865 7328 293a  mber_of_boxes():
+0000c6d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000c6e0: 2020 7365 6c66 2e74 7261 696e 7365 745f    self.trainset_
+0000c6f0: 6e75 6d5f 626f 7865 735f 706f 7369 7469  num_boxes_positi
+0000c700: 7665 203d 2030 0d0a 2020 2020 2020 2020  ve = 0..        
+0000c710: 2020 2020 2020 2020 7365 6c66 2e74 7261          self.tra
+0000c720: 696e 7365 745f 6e75 6d5f 626f 7865 735f  inset_num_boxes_
+0000c730: 6e65 6761 7469 7665 203d 2030 0d0a 2020  negative = 0..  
+0000c740: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+0000c750: 7220 7320 696e 2063 6667 2e73 655f 6672  r s in cfg.se_fr
+0000c760: 616d 6573 3a0d 0a20 2020 2020 2020 2020  ames:..         
+0000c770: 2020 2020 2020 2020 2020 2069 6620 732e             if s.
+0000c780: 7361 6d70 6c65 3a0d 0a20 2020 2020 2020  sample:..       
+0000c790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c7a0: 2066 6f72 2066 2069 6e20 732e 6665 6174   for f in s.feat
+0000c7b0: 7572 6573 3a0d 0a20 2020 2020 2020 2020  ures:..         
+0000c7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c7d0: 2020 2069 6620 7365 6c66 2e74 7261 696e     if self.train
+0000c7e0: 7365 745f 6665 6174 7572 655f 7365 6c65  set_feature_sele
+0000c7f0: 6374 696f 6e5b 662e 7469 746c 655d 203d  ction[f.title] =
+0000c800: 3d20 313a 0d0a 2020 2020 2020 2020 2020  = 1:..          
+0000c810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c820: 2020 2020 2020 7365 6c66 2e74 7261 696e        self.train
+0000c830: 7365 745f 6e75 6d5f 626f 7865 735f 706f  set_num_boxes_po
+0000c840: 7369 7469 7665 202b 3d20 662e 6e5f 626f  sitive += f.n_bo
+0000c850: 7865 730d 0a20 2020 2020 2020 2020 2020  xes..           
+0000c860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c870: 2065 6c69 6620 7365 6c66 2e74 7261 696e   elif self.train
+0000c880: 7365 745f 6665 6174 7572 655f 7365 6c65  set_feature_sele
+0000c890: 6374 696f 6e5b 662e 7469 746c 655d 203d  ction[f.title] =
+0000c8a0: 3d20 2d31 3a0d 0a20 2020 2020 2020 2020  = -1:..         
 0000c8b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c8c0: 2020 205f 2c20 7365 6c66 2e74 7261 696e     _, self.train
-0000c8d0: 7365 745f 6665 6174 7572 655f 7365 6c65  set_feature_sele
-0000c8e0: 6374 696f 6e5b 666e 616d 655d 203d 2069  ction[fname] = i
-0000c8f0: 6d67 7569 2e73 6c69 6465 725f 696e 7428  mgui.slider_int(
-0000c900: 6622 2323 7b66 6e61 6d65 7d22 2c20 7661  f"##{fname}", va
-0000c910: 6c2c 202d 312c 2031 2c20 666f 726d 6174  l, -1, 1, format
-0000c920: 3d66 227b 666e 616d 657d 2229 0d0a 2020  =f"{fname}")..  
-0000c930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c940: 2020 696d 6775 692e 706f 705f 7374 796c    imgui.pop_styl
-0000c950: 655f 636f 6c6f 7228 3229 0d0a 2020 2020  e_color(2)..    
-0000c960: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
-0000c970: 692e 706f 705f 7374 796c 655f 636f 6c6f  i.pop_style_colo
-0000c980: 7228 3129 0d0a 2020 2020 2020 2020 2020  r(1)..          
-0000c990: 2020 2020 2020 696d 6775 692e 706f 705f        imgui.pop_
-0000c9a0: 7374 796c 655f 7661 7228 3129 0d0a 2020  style_var(1)..  
-0000c9b0: 2020 2020 2020 2020 2020 2020 2020 696d                im
-0000c9c0: 6775 692e 7075 7368 5f73 7479 6c65 5f76  gui.push_style_v
-0000c9d0: 6172 2869 6d67 7569 2e53 5459 4c45 5f46  ar(imgui.STYLE_F
-0000c9e0: 5241 4d45 5f50 4144 4449 4e47 2c20 2830  RAME_PADDING, (0
-0000c9f0: 2c20 3029 290d 0a20 2020 2020 2020 2020  , 0))..         
-0000ca00: 2020 2020 2020 2069 6d67 7569 2e65 6e64         imgui.end
-0000ca10: 5f63 6869 6c64 2829 0d0a 0d0a 2020 2020  _child()....    
-0000ca20: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
-0000ca30: 692e 7465 7874 2822 4461 7461 7365 7473  i.text("Datasets
-0000ca40: 2074 6f20 7361 6d70 6c65 2229 0d0a 2020   to sample")..  
-0000ca50: 2020 2020 2020 2020 2020 2020 2020 696d                im
-0000ca60: 6775 692e 7075 7368 5f73 7479 6c65 5f63  gui.push_style_c
-0000ca70: 6f6c 6f72 2869 6d67 7569 2e43 4f4c 4f52  olor(imgui.COLOR
-0000ca80: 5f43 4845 434b 5f4d 4152 4b2c 2030 2e30  _CHECK_MARK, 0.0
-0000ca90: 2c20 302e 302c 2030 2e30 2c20 312e 3029  , 0.0, 0.0, 1.0)
-0000caa0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000cab0: 2020 696d 6775 692e 6265 6769 6e5f 6368    imgui.begin_ch
-0000cac0: 696c 6428 2264 6174 6173 6574 735f 746f  ild("datasets_to
-0000cad0: 5f73 616d 706c 6522 2c20 302e 302c 206d  _sample", 0.0, m
-0000cae0: 696e 285b 3132 302c 2031 3020 2b20 6c65  in([120, 10 + le
-0000caf0: 6e28 6366 672e 7365 5f66 7261 6d65 7329  n(cfg.se_frames)
-0000cb00: 2a32 305d 292c 2054 7275 6529 0d0a 2020  *20]), True)..  
-0000cb10: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-0000cb20: 7220 7320 696e 2063 6667 2e73 655f 6672  r s in cfg.se_fr
-0000cb30: 616d 6573 3a0d 0a20 2020 2020 2020 2020  ames:..         
-0000cb40: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
-0000cb50: 2e70 7573 685f 6964 2866 227b 732e 7569  .push_id(f"{s.ui
-0000cb60: 647d 2229 0d0a 2020 2020 2020 2020 2020  d}")..          
-0000cb70: 2020 2020 2020 2020 2020 5f2c 2073 2e73            _, s.s
-0000cb80: 616d 706c 6520 3d20 696d 6775 692e 6368  ample = imgui.ch
-0000cb90: 6563 6b62 6f78 2873 2e74 6974 6c65 2c20  eckbox(s.title, 
-0000cba0: 732e 7361 6d70 6c65 290d 0a20 2020 2020  s.sample)..     
-0000cbb0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0000cbc0: 6620 5f3a 0d0a 2020 2020 2020 2020 2020  f _:..          
-0000cbd0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0000cbe0: 6c66 2e70 6172 7365 5f61 7661 696c 6162  lf.parse_availab
-0000cbf0: 6c65 5f66 6561 7475 7265 7328 290d 0a20  le_features().. 
-0000cc00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cc10: 2020 2069 6d67 7569 2e70 6f70 5f69 6428     imgui.pop_id(
-0000cc20: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0000cc30: 2020 2069 6d67 7569 2e65 6e64 5f63 6869     imgui.end_chi
-0000cc40: 6c64 2829 0d0a 2020 2020 2020 2020 2020  ld()..          
-0000cc50: 2020 2020 2020 696d 6775 692e 706f 705f        imgui.pop_
-0000cc60: 7374 796c 655f 636f 6c6f 7228 290d 0a0d  style_color()...
-0000cc70: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
-0000cc80: 2020 2069 6d67 7569 2e74 6578 7428 2253     imgui.text("S
-0000cc90: 6574 2070 6172 616d 6574 6572 7322 290d  et parameters").
-0000cca0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000ccb0: 2069 6d67 7569 2e62 6567 696e 5f63 6869   imgui.begin_chi
-0000ccc0: 6c64 2822 7061 7261 6d73 222c 2030 2e30  ld("params", 0.0
-0000ccd0: 2c20 3830 2c20 5472 7565 290d 0a20 2020  , 80, True)..   
-0000cce0: 2020 2020 2020 2020 2020 2020 2069 6d67               img
-0000ccf0: 7569 2e70 7573 685f 6974 656d 5f77 6964  ui.push_item_wid
-0000cd00: 7468 2863 7720 2d20 3533 290d 0a20 2020  th(cw - 53)..   
-0000cd10: 2020 2020 2020 2020 2020 2020 205f 2c20               _, 
-0000cd20: 7365 6c66 2e74 7261 696e 7365 745f 626f  self.trainset_bo
-0000cd30: 7873 697a 6520 3d20 696d 6775 692e 736c  xsize = imgui.sl
-0000cd40: 6964 6572 5f69 6e74 2822 626f 7865 7322  ider_int("boxes"
-0000cd50: 2c20 7365 6c66 2e74 7261 696e 7365 745f  , self.trainset_
-0000cd60: 626f 7873 697a 652c 2038 2c20 3132 382c  boxsize, 8, 128,
-0000cd70: 2066 6f72 6d61 743d 6622 7b73 656c 662e   format=f"{self.
-0000cd80: 7472 6169 6e73 6574 5f62 6f78 7369 7a65  trainset_boxsize
-0000cd90: 7d20 7069 7865 6c22 290d 0a20 2020 2020  } pixel")..     
-0000cda0: 2020 2020 2020 2020 2020 205f 2c20 5365             _, Se
-0000cdb0: 676d 656e 7461 7469 6f6e 4564 6974 6f72  gmentationEditor
-0000cdc0: 2e74 7261 696e 7365 745f 6170 6978 203d  .trainset_apix =
-0000cdd0: 2069 6d67 7569 2e73 6c69 6465 725f 666c   imgui.slider_fl
-0000cde0: 6f61 7428 2241 2f70 6978 222c 2053 6567  oat("A/pix", Seg
-0000cdf0: 6d65 6e74 6174 696f 6e45 6469 746f 722e  mentationEditor.
-0000ce00: 7472 6169 6e73 6574 5f61 7069 782c 2031  trainset_apix, 1
-0000ce10: 2e30 2c20 3230 2e30 2c20 666f 726d 6174  .0, 20.0, format
-0000ce20: 3d66 227b 5365 676d 656e 7461 7469 6f6e  =f"{Segmentation
-0000ce30: 4564 6974 6f72 2e74 7261 696e 7365 745f  Editor.trainset_
-0000ce40: 6170 6978 3a2e 3266 7d22 290d 0a20 2020  apix:.2f}")..   
-0000ce50: 2020 2020 2020 2020 2020 2020 2069 6d67               img
-0000ce60: 7569 2e70 6f70 5f69 7465 6d5f 7769 6474  ui.pop_item_widt
-0000ce70: 6828 290d 0a20 2020 2020 2020 2020 2020  h()..           
-0000ce80: 2020 2020 2063 616c 6375 6c61 7465 5f6e       calculate_n
-0000ce90: 756d 6265 725f 6f66 5f62 6f78 6573 2829  umber_of_boxes()
-0000cea0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000ceb0: 2020 696d 6775 692e 7465 7874 2866 2250    imgui.text(f"P
-0000cec0: 6f73 6974 6976 6520 7361 6d70 6c65 733a  ositive samples:
-0000ced0: 207b 7365 6c66 2e74 7261 696e 7365 745f   {self.trainset_
-0000cee0: 6e75 6d5f 626f 7865 735f 706f 7369 7469  num_boxes_positi
-0000cef0: 7665 7d22 290d 0a20 2020 2020 2020 2020  ve}")..         
-0000cf00: 2020 2020 2020 2069 6d67 7569 2e74 6578         imgui.tex
-0000cf10: 7428 6622 4e65 6761 7469 7665 2073 616d  t(f"Negative sam
-0000cf20: 706c 6573 3a20 7b73 656c 662e 7472 6169  ples: {self.trai
-0000cf30: 6e73 6574 5f6e 756d 5f62 6f78 6573 5f6e  nset_num_boxes_n
-0000cf40: 6567 6174 6976 657d 2229 0d0a 2020 2020  egative}")..    
-0000cf50: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
-0000cf60: 692e 656e 645f 6368 696c 6428 290d 0a0d  i.end_child()...
-0000cf70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000cf80: 2023 2070 726f 6772 6573 7320 6261 7273   # progress bars
-0000cf90: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000cfa0: 2020 666f 7220 7072 6f63 6573 7320 696e    for process in
-0000cfb0: 2073 656c 662e 6163 7469 7665 5f74 7261   self.active_tra
-0000cfc0: 696e 7365 745f 6578 706f 7274 733a 0d0a  inset_exports:..
-0000cfd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cfe0: 2020 2020 7365 6c66 2e5f 6775 695f 6261      self._gui_ba
-0000cff0: 636b 6772 6f75 6e64 5f70 726f 6365 7373  ckground_process
-0000d000: 5f70 726f 6772 6573 735f 6261 7228 7072  _progress_bar(pr
-0000d010: 6f63 6573 7329 0d0a 2020 2020 2020 2020  ocess)..        
-0000d020: 2020 2020 2020 2020 2020 2020 6966 2070              if p
-0000d030: 726f 6365 7373 2e70 726f 6772 6573 7320  rocess.progress 
-0000d040: 3d3d 2031 2e30 3a0d 0a20 2020 2020 2020  == 1.0:..       
-0000d050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d060: 2073 656c 662e 6163 7469 7665 5f74 7261   self.active_tra
-0000d070: 696e 7365 745f 6578 706f 7274 732e 7265  inset_exports.re
-0000d080: 6d6f 7665 2870 726f 6365 7373 290d 0a0d  move(process)...
-0000d090: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000d0a0: 2023 2027 4765 6e65 7261 7465 2073 6574   # 'Generate set
-0000d0b0: 2720 6275 7474 6f6e 0d0a 2020 2020 2020  ' button..      
-0000d0c0: 2020 2020 2020 2020 2020 6966 2077 6964            if wid
-0000d0d0: 6765 7473 2e63 656e 7472 6564 5f62 7574  gets.centred_but
-0000d0e0: 746f 6e28 2247 656e 6572 6174 6520 7365  ton("Generate se
-0000d0f0: 7422 2c20 3132 302c 2032 3329 3a0d 0a20  t", 120, 23):.. 
-0000d100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d110: 2020 2073 656c 662e 6c61 756e 6368 5f63     self.launch_c
-0000d120: 7265 6174 655f 7472 6169 6e69 6e67 5f73  reate_training_s
-0000d130: 6574 2829 0d0a 2020 2020 2020 2020 2020  et()..          
-0000d140: 2020 2020 2020 696d 6775 692e 706f 705f        imgui.pop_
-0000d150: 7374 796c 655f 7661 7228 3529 0d0a 2020  style_var(5)..  
-0000d160: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
-0000d170: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000d180: 2073 656c 662e 7368 6f77 5f74 7261 696e   self.show_train
-0000d190: 7365 745f 626f 7865 7320 3d20 4661 6c73  set_boxes = Fals
-0000d1a0: 650d 0a20 2020 2020 2020 2020 2020 2069  e..            i
-0000d1b0: 6620 696d 6775 692e 636f 6c6c 6170 7369  f imgui.collapsi
-0000d1c0: 6e67 5f68 6561 6465 7228 224d 6f64 656c  ng_header("Model
-0000d1d0: 7322 2c20 4e6f 6e65 2c20 696d 6775 692e  s", None, imgui.
-0000d1e0: 5452 4545 5f4e 4f44 455f 4445 4641 554c  TREE_NODE_DEFAUL
-0000d1f0: 545f 4f50 454e 295b 305d 3a0d 0a20 2020  T_OPEN)[0]:..   
-0000d200: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-0000d210: 206d 2069 6e20 6366 672e 7365 5f6d 6f64   m in cfg.se_mod
-0000d220: 656c 733a 0d0a 2020 2020 2020 2020 2020  els:..          
-0000d230: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
-0000d240: 7075 7368 5f69 6428 6622 5345 4d6f 6465  push_id(f"SEMode
-0000d250: 6c5f 7b6d 2e75 6964 7d5f 6d61 696e 2229  l_{m.uid}_main")
-0000d260: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000d270: 2020 2020 2020 7061 6e65 6c5f 6865 6967        panel_heig
-0000d280: 6874 203d 2030 0d0a 2020 2020 2020 2020  ht = 0..        
-0000d290: 2020 2020 2020 2020 2020 2020 6966 206d              if m
-0000d2a0: 2e61 6374 6976 655f 7461 6220 3d3d 2030  .active_tab == 0
-0000d2b0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0000d2c0: 2020 2020 2020 2020 2020 2070 616e 656c             panel
-0000d2d0: 5f68 6569 6768 7420 3d20 5365 676d 656e  _height = Segmen
-0000d2e0: 7461 7469 6f6e 4564 6974 6f72 2e4d 4f44  tationEditor.MOD
-0000d2f0: 454c 5f50 414e 454c 5f48 4549 4748 545f  EL_PANEL_HEIGHT_
-0000d300: 5452 4149 4e49 4e47 0d0a 2020 2020 2020  TRAINING..      
-0000d310: 2020 2020 2020 2020 2020 2020 2020 656c                el
-0000d320: 6966 206d 2e61 6374 6976 655f 7461 6220  if m.active_tab 
-0000d330: 3d3d 2031 3a0d 0a20 2020 2020 2020 2020  == 1:..         
-0000d340: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0000d350: 616e 656c 5f68 6569 6768 7420 3d20 5365  anel_height = Se
-0000d360: 676d 656e 7461 7469 6f6e 4564 6974 6f72  gmentationEditor
-0000d370: 2e4d 4f44 454c 5f50 414e 454c 5f48 4549  .MODEL_PANEL_HEI
-0000d380: 4748 545f 5052 4544 4943 5449 4f4e 0d0a  GHT_PREDICTION..
-0000d390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d3a0: 2020 2020 656c 6966 206d 2e61 6374 6976      elif m.activ
-0000d3b0: 655f 7461 6220 3d3d 2032 3a0d 0a20 2020  e_tab == 2:..   
-0000d3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d3d0: 2020 2020 2070 616e 656c 5f68 6569 6768       panel_heigh
-0000d3e0: 7420 3d20 5365 676d 656e 7461 7469 6f6e  t = Segmentation
-0000d3f0: 4564 6974 6f72 2e4d 4f44 454c 5f50 414e  Editor.MODEL_PAN
-0000d400: 454c 5f48 4549 4748 545f 4c4f 4749 4320  EL_HEIGHT_LOGIC 
-0000d410: 2b20 3537 202a 206c 656e 286d 2e69 6e74  + 57 * len(m.int
-0000d420: 6572 6163 7469 6f6e 7329 202d 2032 3020  eractions) - 20 
-0000d430: 2a20 286c 656e 2863 6667 2e73 655f 6d6f  * (len(cfg.se_mo
-0000d440: 6465 6c73 2920 3c20 3229 0d0a 2020 2020  dels) < 2)..    
-0000d450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d460: 7061 6e65 6c5f 6865 6967 6874 202b 3d20  panel_height += 
-0000d470: 3130 2069 6620 6d2e 6261 636b 6772 6f75  10 if m.backgrou
-0000d480: 6e64 5f70 726f 6365 7373 5f74 7261 696e  nd_process_train
-0000d490: 2069 7320 6e6f 7420 4e6f 6e65 2065 6c73   is not None els
-0000d4a0: 6520 300d 0a20 2020 2020 2020 2020 2020  e 0..           
-0000d4b0: 2020 2020 2020 2020 2069 6d67 7569 2e62           imgui.b
-0000d4c0: 6567 696e 5f63 6869 6c64 2866 2253 454d  egin_child(f"SEM
-0000d4d0: 6f64 656c 5f7b 6d2e 7569 647d 222c 2030  odel_{m.uid}", 0
-0000d4e0: 2e30 2c20 7061 6e65 6c5f 6865 6967 6874  .0, panel_height
-0000d4f0: 2c20 5472 7565 2c20 696d 6775 692e 5749  , True, imgui.WI
-0000d500: 4e44 4f57 5f4e 4f5f 5343 524f 4c4c 4241  NDOW_NO_SCROLLBA
-0000d510: 5229 0d0a 2020 2020 2020 2020 2020 2020  R)..            
-0000d520: 2020 2020 2020 2020 6377 203d 2069 6d67          cw = img
-0000d530: 7569 2e67 6574 5f63 6f6e 7465 6e74 5f72  ui.get_content_r
-0000d540: 6567 696f 6e5f 6176 6169 6c61 626c 655f  egion_available_
-0000d550: 7769 6474 6828 290d 0a0d 0a20 2020 2020  width()....     
-0000d560: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0000d570: 6d67 7569 2e70 7573 685f 7374 796c 655f  mgui.push_style_
-0000d580: 7661 7228 696d 6775 692e 5354 594c 455f  var(imgui.STYLE_
-0000d590: 4652 414d 455f 5041 4444 494e 472c 2028  FRAME_PADDING, (
-0000d5a0: 302c 2030 2929 0d0a 2020 2020 2020 2020  0, 0))..        
-0000d5b0: 2020 2020 2020 2020 2020 2020 6966 206d              if m
-0000d5c0: 2e62 6163 6b67 726f 756e 645f 7072 6f63  .background_proc
-0000d5d0: 6573 735f 7472 6169 6e20 6973 204e 6f6e  ess_train is Non
-0000d5e0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-0000d5f0: 2020 2020 2020 2020 2020 2020 2320 6465              # de
-0000d600: 6c65 7465 2062 7574 746f 6e0d 0a20 2020  lete button..   
-0000d610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d620: 2020 2020 2069 6620 696d 6775 692e 696d       if imgui.im
-0000d630: 6167 655f 6275 7474 6f6e 2873 656c 662e  age_button(self.
-0000d640: 6963 6f6e 5f63 6c6f 7365 2e72 656e 6465  icon_close.rende
-0000d650: 7265 725f 6964 2c20 3139 2c20 3139 293a  rer_id, 19, 19):
-0000d660: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000d670: 2020 2020 2020 2020 2020 2020 2020 6366                cf
-0000d680: 672e 7365 5f6d 6f64 656c 732e 7265 6d6f  g.se_models.remo
-0000d690: 7665 286d 290d 0a20 2020 2020 2020 2020  ve(m)..         
-0000d6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d6b0: 2020 2069 6620 6366 672e 7365 5f61 6374     if cfg.se_act
-0000d6c0: 6976 655f 6d6f 6465 6c20 3d3d 206d 3a0d  ive_model == m:.
-0000d6d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000d6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d6f0: 2063 6667 2e73 655f 6163 7469 7665 5f6d   cfg.se_active_m
-0000d700: 6f64 656c 203d 204e 6f6e 650d 0a20 2020  odel = None..   
-0000d710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d720: 2020 2020 2020 2020 206d 2e64 656c 6574           m.delet
-0000d730: 6528 290d 0a20 2020 2020 2020 2020 2020  e()..           
-0000d740: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
-0000d750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d760: 2020 2020 2020 2020 6966 2069 6d67 7569          if imgui
-0000d770: 2e69 6d61 6765 5f62 7574 746f 6e28 7365  .image_button(se
-0000d780: 6c66 2e69 636f 6e5f 7374 6f70 2e72 656e  lf.icon_stop.ren
-0000d790: 6465 7265 725f 6964 2c20 3139 2c20 3139  derer_id, 19, 19
-0000d7a0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-0000d7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d7c0: 6d2e 6261 636b 6772 6f75 6e64 5f70 726f  m.background_pro
-0000d7d0: 6365 7373 5f74 7261 696e 2e73 746f 7028  cess_train.stop(
-0000d7e0: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
-0000d7f0: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
-0000d800: 6f70 5f73 7479 6c65 5f76 6172 2831 290d  op_style_var(1).
-0000d810: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
-0000d820: 2020 2020 2020 2069 6d67 7569 2e73 616d         imgui.sam
-0000d830: 655f 6c69 6e65 2829 0d0a 2020 2020 2020  e_line()..      
-0000d840: 2020 2020 2020 2020 2020 2020 2020 5f2c                _,
-0000d850: 206d 2e63 6f6c 6f75 7220 3d20 696d 6775   m.colour = imgu
-0000d860: 692e 636f 6c6f 725f 6564 6974 3328 6d2e  i.color_edit3(m.
-0000d870: 7469 746c 652c 202a 6d2e 636f 6c6f 7572  title, *m.colour
-0000d880: 5b3a 335d 2c20 696d 6775 692e 434f 4c4f  [:3], imgui.COLO
-0000d890: 525f 4544 4954 5f4e 4f5f 494e 5055 5453  R_EDIT_NO_INPUTS
-0000d8a0: 207c 2069 6d67 7569 2e43 4f4c 4f52 5f45   | imgui.COLOR_E
-0000d8b0: 4449 545f 4e4f 5f4c 4142 454c 207c 2069  DIT_NO_LABEL | i
-0000d8c0: 6d67 7569 2e43 4f4c 4f52 5f45 4449 545f  mgui.COLOR_EDIT_
-0000d8d0: 4e4f 5f54 4f4f 4c54 4950 207c 2069 6d67  NO_TOOLTIP | img
-0000d8e0: 7569 2e43 4f4c 4f52 5f45 4449 545f 4e4f  ui.COLOR_EDIT_NO
-0000d8f0: 5f44 5241 475f 4452 4f50 290d 0a20 2020  _DRAG_DROP)..   
-0000d900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d910: 2023 2054 6974 6c65 0d0a 2020 2020 2020   # Title..      
-0000d920: 2020 2020 2020 2020 2020 2020 2020 696d                im
-0000d930: 6775 692e 7361 6d65 5f6c 696e 6528 290d  gui.same_line().
-0000d940: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000d950: 2020 2020 2069 6d67 7569 2e73 6574 5f6e       imgui.set_n
-0000d960: 6578 745f 6974 656d 5f77 6964 7468 2863  ext_item_width(c
-0000d970: 7720 2d20 3535 290d 0a20 2020 2020 2020  w - 55)..       
-0000d980: 2020 2020 2020 2020 2020 2020 205f 2c20               _, 
-0000d990: 6d2e 7469 746c 6520 3d20 696d 6775 692e  m.title = imgui.
-0000d9a0: 696e 7075 745f 7465 7874 2822 2323 7469  input_text("##ti
-0000d9b0: 746c 6522 2c20 6d2e 7469 746c 652c 2032  tle", m.title, 2
-0000d9c0: 3536 2c20 696d 6775 692e 494e 5055 545f  56, imgui.INPUT_
-0000d9d0: 5445 5854 5f4e 4f5f 484f 5249 5a4f 4e54  TEXT_NO_HORIZONT
-0000d9e0: 414c 5f53 4352 4f4c 4c20 7c20 696d 6775  AL_SCROLL | imgu
-0000d9f0: 692e 494e 5055 545f 5445 5854 5f41 5554  i.INPUT_TEXT_AUT
-0000da00: 4f5f 5345 4c45 4354 5f41 4c4c 290d 0a20  O_SELECT_ALL).. 
-0000da10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000da20: 2020 2073 656c 662e 5f67 7569 5f66 6561     self._gui_fea
-0000da30: 7475 7265 5f74 6974 6c65 5f63 6f6e 7465  ture_title_conte
-0000da40: 7874 5f6d 656e 7528 6d29 0d0a 2020 2020  xt_menu(m)..    
-0000da50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000da60: 2320 4d6f 6465 6c20 7365 6c65 6374 696f  # Model selectio
-0000da70: 6e0d 0a20 2020 2020 2020 2020 2020 2020  n..             
-0000da80: 2020 2020 2020 2069 6d67 7569 2e70 7573         imgui.pus
-0000da90: 685f 7374 796c 655f 7661 7228 696d 6775  h_style_var(imgu
-0000daa0: 692e 5354 594c 455f 4652 414d 455f 5041  i.STYLE_FRAME_PA
-0000dab0: 4444 494e 472c 2028 352c 2032 2929 0d0a  DDING, (5, 2))..
-0000dac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dad0: 2020 2020 696d 6775 692e 616c 6967 6e5f      imgui.align_
-0000dae0: 7465 7874 5f74 6f5f 6672 616d 655f 7061  text_to_frame_pa
-0000daf0: 6464 696e 6728 290d 0a0d 0a20 2020 2020  dding()....     
-0000db00: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0000db10: 6620 6d2e 636f 6d70 696c 6564 3a0d 0a20  f m.compiled:.. 
-0000db20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000db30: 2020 2020 2020 2069 6d67 7569 2e74 6578         imgui.tex
-0000db40: 7428 6d2e 696e 666f 290d 0a20 2020 2020  t(m.info)..     
-0000db50: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0000db60: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-0000db70: 2020 2020 2020 2020 2020 2020 2020 696d                im
-0000db80: 6775 692e 7465 7874 2822 4d6f 6465 6c3a  gui.text("Model:
-0000db90: 2229 0d0a 2020 2020 2020 2020 2020 2020  ")..            
-0000dba0: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
-0000dbb0: 692e 7361 6d65 5f6c 696e 6528 290d 0a20  i.same_line().. 
-0000dbc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dbd0: 2020 2020 2020 2069 6d67 7569 2e73 6574         imgui.set
-0000dbe0: 5f6e 6578 745f 6974 656d 5f77 6964 7468  _next_item_width
-0000dbf0: 2863 7720 2d20 3531 290d 0a20 2020 2020  (cw - 51)..     
-0000dc00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dc10: 2020 205f 2c20 6d2e 6d6f 6465 6c5f 656e     _, m.model_en
-0000dc20: 756d 203d 2069 6d67 7569 2e63 6f6d 626f  um = imgui.combo
-0000dc30: 2822 2323 6d6f 6465 6c5f 7479 7065 222c  ("##model_type",
-0000dc40: 206d 2e6d 6f64 656c 5f65 6e75 6d2c 2053   m.model_enum, S
-0000dc50: 454d 6f64 656c 2e41 5641 494c 4142 4c45  EModel.AVAILABLE
-0000dc60: 5f4d 4f44 454c 5329 0d0a 2020 2020 2020  _MODELS)..      
-0000dc70: 2020 2020 2020 2020 2020 2020 2020 696d                im
-0000dc80: 6775 692e 706f 705f 7374 796c 655f 7661  gui.pop_style_va
-0000dc90: 7228 290d 0a0d 0a20 2020 2020 2020 2020  r()....         
-0000dca0: 2020 2020 2020 2020 2020 2069 6620 696d             if im
-0000dcb0: 6775 692e 6265 6769 6e5f 7461 625f 6261  gui.begin_tab_ba
-0000dcc0: 7228 2223 2374 6162 7322 293a 0d0a 2020  r("##tabs"):..  
-0000dcd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dce0: 2020 2020 2020 6966 2069 6d67 7569 2e62        if imgui.b
-0000dcf0: 6567 696e 5f74 6162 5f69 7465 6d28 2220  egin_tab_item(" 
-0000dd00: 5472 6169 6e69 6e67 2022 295b 305d 3a0d  Training ")[0]:.
-0000dd10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000dd20: 2020 2020 2020 2020 2020 2020 206d 2e61               m.a
-0000dd30: 6374 6976 655f 7461 6220 3d20 300d 0a20  ctive_tab = 0.. 
+0000c8c0: 2020 2020 2020 2073 656c 662e 7472 6169         self.trai
+0000c8d0: 6e73 6574 5f6e 756d 5f62 6f78 6573 5f6e  nset_num_boxes_n
+0000c8e0: 6567 6174 6976 6520 2b3d 2066 2e6e 5f62  egative += f.n_b
+0000c8f0: 6f78 6573 0d0a 0d0a 0d0a 2020 2020 2020  oxes......      
+0000c900: 2020 2020 2020 6966 2069 6d67 7569 2e63        if imgui.c
+0000c910: 6f6c 6c61 7073 696e 675f 6865 6164 6572  ollapsing_header
+0000c920: 2822 4372 6561 7465 2061 2074 7261 696e  ("Create a train
+0000c930: 696e 6720 7365 7422 2c20 4e6f 6e65 295b  ing set", None)[
+0000c940: 305d 3a0d 0a20 2020 2020 2020 2020 2020  0]:..           
+0000c950: 2020 2020 2073 656c 662e 7368 6f77 5f74       self.show_t
+0000c960: 7261 696e 7365 745f 626f 7865 7320 3d20  rainset_boxes = 
+0000c970: 5472 7565 0d0a 2020 2020 2020 2020 2020  True..          
+0000c980: 2020 2020 2020 696d 6775 692e 7075 7368        imgui.push
+0000c990: 5f73 7479 6c65 5f76 6172 2869 6d67 7569  _style_var(imgui
+0000c9a0: 2e53 5459 4c45 5f46 5241 4d45 5f52 4f55  .STYLE_FRAME_ROU
+0000c9b0: 4e44 494e 472c 2031 3029 0d0a 2020 2020  NDING, 10)..    
+0000c9c0: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
+0000c9d0: 692e 7075 7368 5f73 7479 6c65 5f76 6172  i.push_style_var
+0000c9e0: 2869 6d67 7569 2e53 5459 4c45 5f47 5241  (imgui.STYLE_GRA
+0000c9f0: 425f 524f 554e 4449 4e47 2c20 3230 290d  B_ROUNDING, 20).
+0000ca00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ca10: 2069 6d67 7569 2e70 7573 685f 7374 796c   imgui.push_styl
+0000ca20: 655f 7661 7228 696d 6775 692e 5354 594c  e_var(imgui.STYL
+0000ca30: 455f 4652 414d 455f 424f 5244 4552 5349  E_FRAME_BORDERSI
+0000ca40: 5a45 2c20 3129 0d0a 2020 2020 2020 2020  ZE, 1)..        
+0000ca50: 2020 2020 2020 2020 696d 6775 692e 7075          imgui.pu
+0000ca60: 7368 5f73 7479 6c65 5f76 6172 2869 6d67  sh_style_var(img
+0000ca70: 7569 2e53 5459 4c45 5f47 5241 425f 4d49  ui.STYLE_GRAB_MI
+0000ca80: 4e5f 5349 5a45 2c20 3929 0d0a 2020 2020  N_SIZE, 9)..    
+0000ca90: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
+0000caa0: 692e 7075 7368 5f73 7479 6c65 5f76 6172  i.push_style_var
+0000cab0: 2869 6d67 7569 2e53 5459 4c45 5f46 5241  (imgui.STYLE_FRA
+0000cac0: 4d45 5f50 4144 4449 4e47 2c20 2830 2c20  ME_PADDING, (0, 
+0000cad0: 3229 290d 0a0d 0a20 2020 2020 2020 2020  2))....         
+0000cae0: 2020 2020 2020 2069 6d67 7569 2e74 6578         imgui.tex
+0000caf0: 7428 2246 6561 7475 7265 7320 6f66 2069  t("Features of i
+0000cb00: 6e74 6572 6573 7422 290d 0a20 2020 2020  nterest")..     
+0000cb10: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
+0000cb20: 2e62 6567 696e 5f63 6869 6c64 2822 7365  .begin_child("se
+0000cb30: 6c65 6374 5f66 6561 7475 7265 7322 2c20  lect_features", 
+0000cb40: 302e 302c 2031 202b 206c 656e 2873 656c  0.0, 1 + len(sel
+0000cb50: 662e 616c 6c5f 6665 6174 7572 655f 6e61  f.all_feature_na
+0000cb60: 6d65 7329 202a 2032 312c 2046 616c 7365  mes) * 21, False
+0000cb70: 2c20 696d 6775 692e 5749 4e44 4f57 5f4e  , imgui.WINDOW_N
+0000cb80: 4f5f 5343 524f 4c4c 4241 5229 0d0a 2020  O_SCROLLBAR)..  
+0000cb90: 2020 2020 2020 2020 2020 2020 2020 696d                im
+0000cba0: 6775 692e 7075 7368 5f73 7479 6c65 5f63  gui.push_style_c
+0000cbb0: 6f6c 6f72 2869 6d67 7569 2e43 4f4c 4f52  olor(imgui.COLOR
+0000cbc0: 5f46 5241 4d45 5f42 4143 4b47 524f 554e  _FRAME_BACKGROUN
+0000cbd0: 442c 202a 6366 672e 434f 4c4f 5552 5f4e  D, *cfg.COLOUR_N
+0000cbe0: 4555 5452 414c 5f4c 4947 4854 290d 0a20  EUTRAL_LIGHT).. 
+0000cbf0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0000cc00: 7720 3d20 696d 6775 692e 6765 745f 636f  w = imgui.get_co
+0000cc10: 6e74 656e 745f 7265 6769 6f6e 5f61 7661  ntent_region_ava
+0000cc20: 696c 6162 6c65 5f77 6964 7468 2829 0d0a  ilable_width()..
+0000cc30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cc40: 696d 6775 692e 7075 7368 5f69 7465 6d5f  imgui.push_item_
+0000cc50: 7769 6474 6828 6377 290d 0a20 2020 2020  width(cw)..     
+0000cc60: 2020 2020 2020 2020 2020 2066 6f72 2066             for f
+0000cc70: 6e61 6d65 2069 6e20 7365 6c66 2e61 6c6c  name in self.all
+0000cc80: 5f66 6561 7475 7265 5f6e 616d 6573 3a0d  _feature_names:.
+0000cc90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000cca0: 2020 2020 2076 616c 203d 2073 656c 662e       val = self.
+0000ccb0: 7472 6169 6e73 6574 5f66 6561 7475 7265  trainset_feature
+0000ccc0: 5f73 656c 6563 7469 6f6e 5b66 6e61 6d65  _selection[fname
+0000ccd0: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
+0000cce0: 2020 2020 2020 2069 6620 7661 6c20 3d3d         if val ==
+0000ccf0: 2031 3a0d 0a20 2020 2020 2020 2020 2020   1:..           
+0000cd00: 2020 2020 2020 2020 2020 2020 2069 6d67               img
+0000cd10: 7569 2e70 7573 685f 7374 796c 655f 636f  ui.push_style_co
+0000cd20: 6c6f 7228 696d 6775 692e 434f 4c4f 525f  lor(imgui.COLOR_
+0000cd30: 534c 4944 4552 5f47 5241 422c 202a 6366  SLIDER_GRAB, *cf
+0000cd40: 672e 434f 4c4f 5552 5f50 4f53 4954 4956  g.COLOUR_POSITIV
+0000cd50: 4529 0d0a 2020 2020 2020 2020 2020 2020  E)..            
+0000cd60: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
+0000cd70: 692e 7075 7368 5f73 7479 6c65 5f63 6f6c  i.push_style_col
+0000cd80: 6f72 2869 6d67 7569 2e43 4f4c 4f52 5f53  or(imgui.COLOR_S
+0000cd90: 4c49 4445 525f 4752 4142 5f41 4354 4956  LIDER_GRAB_ACTIV
+0000cda0: 452c 202a 6366 672e 434f 4c4f 5552 5f50  E, *cfg.COLOUR_P
+0000cdb0: 4f53 4954 4956 4529 0d0a 2020 2020 2020  OSITIVE)..      
+0000cdc0: 2020 2020 2020 2020 2020 2020 2020 656c                el
+0000cdd0: 6966 2076 616c 203d 3d20 303a 0d0a 2020  if val == 0:..  
+0000cde0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cdf0: 2020 2020 2020 696d 6775 692e 7075 7368        imgui.push
+0000ce00: 5f73 7479 6c65 5f63 6f6c 6f72 2869 6d67  _style_color(img
+0000ce10: 7569 2e43 4f4c 4f52 5f53 4c49 4445 525f  ui.COLOR_SLIDER_
+0000ce20: 4752 4142 2c20 2a63 6667 2e43 4f4c 4f55  GRAB, *cfg.COLOU
+0000ce30: 525f 4e45 5554 5241 4c29 0d0a 2020 2020  R_NEUTRAL)..    
+0000ce40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ce50: 2020 2020 696d 6775 692e 7075 7368 5f73      imgui.push_s
+0000ce60: 7479 6c65 5f63 6f6c 6f72 2869 6d67 7569  tyle_color(imgui
+0000ce70: 2e43 4f4c 4f52 5f53 4c49 4445 525f 4752  .COLOR_SLIDER_GR
+0000ce80: 4142 5f41 4354 4956 452c 202a 6366 672e  AB_ACTIVE, *cfg.
+0000ce90: 434f 4c4f 5552 5f4e 4555 5452 414c 290d  COLOUR_NEUTRAL).
+0000cea0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ceb0: 2020 2020 2065 6c69 6620 7661 6c20 3d3d       elif val ==
+0000cec0: 202d 313a 0d0a 2020 2020 2020 2020 2020   -1:..          
+0000ced0: 2020 2020 2020 2020 2020 2020 2020 696d                im
+0000cee0: 6775 692e 7075 7368 5f73 7479 6c65 5f63  gui.push_style_c
+0000cef0: 6f6c 6f72 2869 6d67 7569 2e43 4f4c 4f52  olor(imgui.COLOR
+0000cf00: 5f53 4c49 4445 525f 4752 4142 2c20 2a63  _SLIDER_GRAB, *c
+0000cf10: 6667 2e43 4f4c 4f55 525f 4e45 4741 5449  fg.COLOUR_NEGATI
+0000cf20: 5645 290d 0a20 2020 2020 2020 2020 2020  VE)..           
+0000cf30: 2020 2020 2020 2020 2020 2020 2069 6d67               img
+0000cf40: 7569 2e70 7573 685f 7374 796c 655f 636f  ui.push_style_co
+0000cf50: 6c6f 7228 696d 6775 692e 434f 4c4f 525f  lor(imgui.COLOR_
+0000cf60: 534c 4944 4552 5f47 5241 425f 4143 5449  SLIDER_GRAB_ACTI
+0000cf70: 5645 2c20 2a63 6667 2e43 4f4c 4f55 525f  VE, *cfg.COLOUR_
+0000cf80: 4e45 4741 5449 5645 290d 0a20 2020 2020  NEGATIVE)..     
+0000cf90: 2020 2020 2020 2020 2020 2020 2020 205f                 _
+0000cfa0: 2c20 7365 6c66 2e74 7261 696e 7365 745f  , self.trainset_
+0000cfb0: 6665 6174 7572 655f 7365 6c65 6374 696f  feature_selectio
+0000cfc0: 6e5b 666e 616d 655d 203d 2069 6d67 7569  n[fname] = imgui
+0000cfd0: 2e73 6c69 6465 725f 696e 7428 6622 2323  .slider_int(f"##
+0000cfe0: 7b66 6e61 6d65 7d22 2c20 7661 6c2c 202d  {fname}", val, -
+0000cff0: 312c 2031 2c20 666f 726d 6174 3d66 227b  1, 1, format=f"{
+0000d000: 666e 616d 657d 2229 0d0a 2020 2020 2020  fname}")..      
+0000d010: 2020 2020 2020 2020 2020 2020 2020 696d                im
+0000d020: 6775 692e 706f 705f 7374 796c 655f 636f  gui.pop_style_co
+0000d030: 6c6f 7228 3229 0d0a 2020 2020 2020 2020  lor(2)..        
+0000d040: 2020 2020 2020 2020 696d 6775 692e 706f          imgui.po
+0000d050: 705f 7374 796c 655f 636f 6c6f 7228 3129  p_style_color(1)
+0000d060: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000d070: 2020 696d 6775 692e 706f 705f 7374 796c    imgui.pop_styl
+0000d080: 655f 7661 7228 3129 0d0a 2020 2020 2020  e_var(1)..      
+0000d090: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
+0000d0a0: 7075 7368 5f73 7479 6c65 5f76 6172 2869  push_style_var(i
+0000d0b0: 6d67 7569 2e53 5459 4c45 5f46 5241 4d45  mgui.STYLE_FRAME
+0000d0c0: 5f50 4144 4449 4e47 2c20 2830 2c20 3029  _PADDING, (0, 0)
+0000d0d0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0000d0e0: 2020 2069 6d67 7569 2e65 6e64 5f63 6869     imgui.end_chi
+0000d0f0: 6c64 2829 0d0a 0d0a 2020 2020 2020 2020  ld()....        
+0000d100: 2020 2020 2020 2020 696d 6775 692e 7465          imgui.te
+0000d110: 7874 2822 4461 7461 7365 7473 2074 6f20  xt("Datasets to 
+0000d120: 7361 6d70 6c65 2229 0d0a 2020 2020 2020  sample")..      
+0000d130: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
+0000d140: 7075 7368 5f73 7479 6c65 5f63 6f6c 6f72  push_style_color
+0000d150: 2869 6d67 7569 2e43 4f4c 4f52 5f43 4845  (imgui.COLOR_CHE
+0000d160: 434b 5f4d 4152 4b2c 2030 2e30 2c20 302e  CK_MARK, 0.0, 0.
+0000d170: 302c 2030 2e30 2c20 312e 3029 0d0a 2020  0, 0.0, 1.0)..  
+0000d180: 2020 2020 2020 2020 2020 2020 2020 696d                im
+0000d190: 6775 692e 6265 6769 6e5f 6368 696c 6428  gui.begin_child(
+0000d1a0: 2264 6174 6173 6574 735f 746f 5f73 616d  "datasets_to_sam
+0000d1b0: 706c 6522 2c20 302e 302c 206d 696e 285b  ple", 0.0, min([
+0000d1c0: 3132 302c 2031 3020 2b20 6c65 6e28 6366  120, 10 + len(cf
+0000d1d0: 672e 7365 5f66 7261 6d65 7329 2a32 305d  g.se_frames)*20]
+0000d1e0: 292c 2054 7275 6529 0d0a 2020 2020 2020  ), True)..      
+0000d1f0: 2020 2020 2020 2020 2020 666f 7220 7320            for s 
+0000d200: 696e 2063 6667 2e73 655f 6672 616d 6573  in cfg.se_frames
+0000d210: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0000d220: 2020 2020 2020 2069 6d67 7569 2e70 7573         imgui.pus
+0000d230: 685f 6964 2866 227b 732e 7569 647d 2229  h_id(f"{s.uid}")
+0000d240: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000d250: 2020 2020 2020 5f2c 2073 2e73 616d 706c        _, s.sampl
+0000d260: 6520 3d20 696d 6775 692e 6368 6563 6b62  e = imgui.checkb
+0000d270: 6f78 2873 2e74 6974 6c65 2c20 732e 7361  ox(s.title, s.sa
+0000d280: 6d70 6c65 290d 0a20 2020 2020 2020 2020  mple)..         
+0000d290: 2020 2020 2020 2020 2020 2069 6620 5f3a             if _:
+0000d2a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000d2b0: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
+0000d2c0: 6172 7365 5f61 7661 696c 6162 6c65 5f66  arse_available_f
+0000d2d0: 6561 7475 7265 7328 290d 0a20 2020 2020  eatures()..     
+0000d2e0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0000d2f0: 6d67 7569 2e70 6f70 5f69 6428 290d 0a20  mgui.pop_id().. 
+0000d300: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0000d310: 6d67 7569 2e65 6e64 5f63 6869 6c64 2829  mgui.end_child()
+0000d320: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000d330: 2020 696d 6775 692e 706f 705f 7374 796c    imgui.pop_styl
+0000d340: 655f 636f 6c6f 7228 290d 0a0d 0a0d 0a20  e_color()...... 
+0000d350: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0000d360: 6d67 7569 2e74 6578 7428 2253 6574 2070  mgui.text("Set p
+0000d370: 6172 616d 6574 6572 7322 290d 0a20 2020  arameters")..   
+0000d380: 2020 2020 2020 2020 2020 2020 2069 6d67               img
+0000d390: 7569 2e62 6567 696e 5f63 6869 6c64 2822  ui.begin_child("
+0000d3a0: 7061 7261 6d73 222c 2030 2e30 2c20 3830  params", 0.0, 80
+0000d3b0: 2c20 5472 7565 290d 0a20 2020 2020 2020  , True)..       
+0000d3c0: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
+0000d3d0: 7573 685f 6974 656d 5f77 6964 7468 2863  ush_item_width(c
+0000d3e0: 7720 2d20 3533 290d 0a20 2020 2020 2020  w - 53)..       
+0000d3f0: 2020 2020 2020 2020 205f 2c20 7365 6c66           _, self
+0000d400: 2e74 7261 696e 7365 745f 626f 7873 697a  .trainset_boxsiz
+0000d410: 6520 3d20 696d 6775 692e 736c 6964 6572  e = imgui.slider
+0000d420: 5f69 6e74 2822 626f 7865 7322 2c20 7365  _int("boxes", se
+0000d430: 6c66 2e74 7261 696e 7365 745f 626f 7873  lf.trainset_boxs
+0000d440: 697a 652c 2038 2c20 3132 382c 2066 6f72  ize, 8, 128, for
+0000d450: 6d61 743d 6622 7b73 656c 662e 7472 6169  mat=f"{self.trai
+0000d460: 6e73 6574 5f62 6f78 7369 7a65 7d20 7069  nset_boxsize} pi
+0000d470: 7865 6c22 290d 0a20 2020 2020 2020 2020  xel")..         
+0000d480: 2020 2020 2020 205f 2c20 5365 676d 656e         _, Segmen
+0000d490: 7461 7469 6f6e 4564 6974 6f72 2e74 7261  tationEditor.tra
+0000d4a0: 696e 7365 745f 6170 6978 203d 2069 6d67  inset_apix = img
+0000d4b0: 7569 2e73 6c69 6465 725f 666c 6f61 7428  ui.slider_float(
+0000d4c0: 2241 2f70 6978 222c 2053 6567 6d65 6e74  "A/pix", Segment
+0000d4d0: 6174 696f 6e45 6469 746f 722e 7472 6169  ationEditor.trai
+0000d4e0: 6e73 6574 5f61 7069 782c 2031 2e30 2c20  nset_apix, 1.0, 
+0000d4f0: 3230 2e30 2c20 666f 726d 6174 3d66 227b  20.0, format=f"{
+0000d500: 5365 676d 656e 7461 7469 6f6e 4564 6974  SegmentationEdit
+0000d510: 6f72 2e74 7261 696e 7365 745f 6170 6978  or.trainset_apix
+0000d520: 3a2e 3266 7d22 290d 0a20 2020 2020 2020  :.2f}")..       
+0000d530: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
+0000d540: 6f70 5f69 7465 6d5f 7769 6474 6828 290d  op_item_width().
+0000d550: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d560: 2063 616c 6375 6c61 7465 5f6e 756d 6265   calculate_numbe
+0000d570: 725f 6f66 5f62 6f78 6573 2829 0d0a 2020  r_of_boxes()..  
+0000d580: 2020 2020 2020 2020 2020 2020 2020 696d                im
+0000d590: 6775 692e 7465 7874 2866 2250 6f73 6974  gui.text(f"Posit
+0000d5a0: 6976 6520 7361 6d70 6c65 733a 207b 7365  ive samples: {se
+0000d5b0: 6c66 2e74 7261 696e 7365 745f 6e75 6d5f  lf.trainset_num_
+0000d5c0: 626f 7865 735f 706f 7369 7469 7665 7d22  boxes_positive}"
+0000d5d0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0000d5e0: 2020 2069 6d67 7569 2e74 6578 7428 6622     imgui.text(f"
+0000d5f0: 4e65 6761 7469 7665 2073 616d 706c 6573  Negative samples
+0000d600: 3a20 7b73 656c 662e 7472 6169 6e73 6574  : {self.trainset
+0000d610: 5f6e 756d 5f62 6f78 6573 5f6e 6567 6174  _num_boxes_negat
+0000d620: 6976 657d 2229 0d0a 2020 2020 2020 2020  ive}")..        
+0000d630: 2020 2020 2020 2020 696d 6775 692e 656e          imgui.en
+0000d640: 645f 6368 696c 6428 290d 0a0d 0a20 2020  d_child()....   
+0000d650: 2020 2020 2020 2020 2020 2020 2023 2070               # p
+0000d660: 726f 6772 6573 7320 6261 7273 0d0a 2020  rogress bars..  
+0000d670: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+0000d680: 7220 7072 6f63 6573 7320 696e 2073 656c  r process in sel
+0000d690: 662e 6163 7469 7665 5f74 7261 696e 7365  f.active_trainse
+0000d6a0: 745f 6578 706f 7274 733a 0d0a 2020 2020  t_exports:..    
+0000d6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d6c0: 7365 6c66 2e5f 6775 695f 6261 636b 6772  self._gui_backgr
+0000d6d0: 6f75 6e64 5f70 726f 6365 7373 5f70 726f  ound_process_pro
+0000d6e0: 6772 6573 735f 6261 7228 7072 6f63 6573  gress_bar(proces
+0000d6f0: 7329 0d0a 2020 2020 2020 2020 2020 2020  s)..            
+0000d700: 2020 2020 2020 2020 6966 2070 726f 6365          if proce
+0000d710: 7373 2e70 726f 6772 6573 7320 3d3d 2031  ss.progress == 1
+0000d720: 2e30 3a0d 0a20 2020 2020 2020 2020 2020  .0:..           
+0000d730: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0000d740: 662e 6163 7469 7665 5f74 7261 696e 7365  f.active_trainse
+0000d750: 745f 6578 706f 7274 732e 7265 6d6f 7665  t_exports.remove
+0000d760: 2870 726f 6365 7373 290d 0a0d 0a20 2020  (process)....   
+0000d770: 2020 2020 2020 2020 2020 2020 2023 2027               # '
+0000d780: 4765 6e65 7261 7465 2073 6574 2720 6275  Generate set' bu
+0000d790: 7474 6f6e 0d0a 2020 2020 2020 2020 2020  tton..          
+0000d7a0: 2020 2020 2020 6966 2077 6964 6765 7473        if widgets
+0000d7b0: 2e63 656e 7472 6564 5f62 7574 746f 6e28  .centred_button(
+0000d7c0: 2247 656e 6572 6174 6520 7365 7422 2c20  "Generate set", 
+0000d7d0: 3132 302c 2032 3329 3a0d 0a20 2020 2020  120, 23):..     
+0000d7e0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0000d7f0: 656c 662e 6c61 756e 6368 5f63 7265 6174  elf.launch_creat
+0000d800: 655f 7472 6169 6e69 6e67 5f73 6574 2829  e_training_set()
+0000d810: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000d820: 2020 696d 6775 692e 706f 705f 7374 796c    imgui.pop_styl
+0000d830: 655f 7661 7228 3529 0d0a 2020 2020 2020  e_var(5)..      
+0000d840: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+0000d850: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0000d860: 662e 7368 6f77 5f74 7261 696e 7365 745f  f.show_trainset_
+0000d870: 626f 7865 7320 3d20 4661 6c73 650d 0a20  boxes = False.. 
+0000d880: 2020 2020 2020 2020 2020 2069 6620 696d             if im
+0000d890: 6775 692e 636f 6c6c 6170 7369 6e67 5f68  gui.collapsing_h
+0000d8a0: 6561 6465 7228 224d 6f64 656c 7322 2c20  eader("Models", 
+0000d8b0: 4e6f 6e65 2c20 696d 6775 692e 5452 4545  None, imgui.TREE
+0000d8c0: 5f4e 4f44 455f 4445 4641 554c 545f 4f50  _NODE_DEFAULT_OP
+0000d8d0: 454e 295b 305d 3a0d 0a20 2020 2020 2020  EN)[0]:..       
+0000d8e0: 2020 2020 2020 2020 2066 6f72 206d 2069           for m i
+0000d8f0: 6e20 6366 672e 7365 5f6d 6f64 656c 733a  n cfg.se_models:
+0000d900: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000d910: 2020 2020 2020 696d 6775 692e 7075 7368        imgui.push
+0000d920: 5f69 6428 6622 5345 4d6f 6465 6c5f 7b6d  _id(f"SEModel_{m
+0000d930: 2e75 6964 7d5f 6d61 696e 2229 0d0a 2020  .uid}_main")..  
+0000d940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d950: 2020 7061 6e65 6c5f 6865 6967 6874 203d    panel_height =
+0000d960: 2030 0d0a 2020 2020 2020 2020 2020 2020   0..            
+0000d970: 2020 2020 2020 2020 6966 206d 2e61 6374          if m.act
+0000d980: 6976 655f 7461 6220 3d3d 2030 3a0d 0a20  ive_tab == 0:.. 
+0000d990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d9a0: 2020 2020 2020 2070 616e 656c 5f68 6569         panel_hei
+0000d9b0: 6768 7420 3d20 5365 676d 656e 7461 7469  ght = Segmentati
+0000d9c0: 6f6e 4564 6974 6f72 2e4d 4f44 454c 5f50  onEditor.MODEL_P
+0000d9d0: 414e 454c 5f48 4549 4748 545f 5452 4149  ANEL_HEIGHT_TRAI
+0000d9e0: 4e49 4e47 0d0a 2020 2020 2020 2020 2020  NING..          
+0000d9f0: 2020 2020 2020 2020 2020 656c 6966 206d            elif m
+0000da00: 2e61 6374 6976 655f 7461 6220 3d3d 2031  .active_tab == 1
+0000da10: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0000da20: 2020 2020 2020 2020 2020 2070 616e 656c             panel
+0000da30: 5f68 6569 6768 7420 3d20 5365 676d 656e  _height = Segmen
+0000da40: 7461 7469 6f6e 4564 6974 6f72 2e4d 4f44  tationEditor.MOD
+0000da50: 454c 5f50 414e 454c 5f48 4549 4748 545f  EL_PANEL_HEIGHT_
+0000da60: 5052 4544 4943 5449 4f4e 0d0a 2020 2020  PREDICTION..    
+0000da70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000da80: 656c 6966 206d 2e61 6374 6976 655f 7461  elif m.active_ta
+0000da90: 6220 3d3d 2032 3a0d 0a20 2020 2020 2020  b == 2:..       
+0000daa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000dab0: 2070 616e 656c 5f68 6569 6768 7420 3d20   panel_height = 
+0000dac0: 5365 676d 656e 7461 7469 6f6e 4564 6974  SegmentationEdit
+0000dad0: 6f72 2e4d 4f44 454c 5f50 414e 454c 5f48  or.MODEL_PANEL_H
+0000dae0: 4549 4748 545f 4c4f 4749 4320 2b20 3537  EIGHT_LOGIC + 57
+0000daf0: 202a 206c 656e 286d 2e69 6e74 6572 6163   * len(m.interac
+0000db00: 7469 6f6e 7329 202d 2032 3020 2a20 286c  tions) - 20 * (l
+0000db10: 656e 2863 6667 2e73 655f 6d6f 6465 6c73  en(cfg.se_models
+0000db20: 2920 3c20 3229 0d0a 2020 2020 2020 2020  ) < 2)..        
+0000db30: 2020 2020 2020 2020 2020 2020 7061 6e65              pane
+0000db40: 6c5f 6865 6967 6874 202b 3d20 3130 2069  l_height += 10 i
+0000db50: 6620 6d2e 6261 636b 6772 6f75 6e64 5f70  f m.background_p
+0000db60: 726f 6365 7373 5f74 7261 696e 2069 7320  rocess_train is 
+0000db70: 6e6f 7420 4e6f 6e65 2065 6c73 6520 300d  not None else 0.
+0000db80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000db90: 2020 2020 2069 6d67 7569 2e62 6567 696e       imgui.begin
+0000dba0: 5f63 6869 6c64 2866 2253 454d 6f64 656c  _child(f"SEModel
+0000dbb0: 5f7b 6d2e 7569 647d 222c 2030 2e30 2c20  _{m.uid}", 0.0, 
+0000dbc0: 7061 6e65 6c5f 6865 6967 6874 2c20 5472  panel_height, Tr
+0000dbd0: 7565 2c20 696d 6775 692e 5749 4e44 4f57  ue, imgui.WINDOW
+0000dbe0: 5f4e 4f5f 5343 524f 4c4c 4241 5229 0d0a  _NO_SCROLLBAR)..
+0000dbf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000dc00: 2020 2020 6377 203d 2069 6d67 7569 2e67      cw = imgui.g
+0000dc10: 6574 5f63 6f6e 7465 6e74 5f72 6567 696f  et_content_regio
+0000dc20: 6e5f 6176 6169 6c61 626c 655f 7769 6474  n_available_widt
+0000dc30: 6828 290d 0a0d 0a20 2020 2020 2020 2020  h()....         
+0000dc40: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
+0000dc50: 2e70 7573 685f 7374 796c 655f 7661 7228  .push_style_var(
+0000dc60: 696d 6775 692e 5354 594c 455f 4652 414d  imgui.STYLE_FRAM
+0000dc70: 455f 5041 4444 494e 472c 2028 302c 2030  E_PADDING, (0, 0
+0000dc80: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
+0000dc90: 2020 2020 2020 2020 6966 206d 2e62 6163          if m.bac
+0000dca0: 6b67 726f 756e 645f 7072 6f63 6573 735f  kground_process_
+0000dcb0: 7472 6169 6e20 6973 204e 6f6e 653a 0d0a  train is None:..
+0000dcc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000dcd0: 2020 2020 2020 2020 2320 6465 6c65 7465          # delete
+0000dce0: 2062 7574 746f 6e0d 0a20 2020 2020 2020   button..       
+0000dcf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000dd00: 2069 6620 696d 6775 692e 696d 6167 655f   if imgui.image_
+0000dd10: 6275 7474 6f6e 2873 656c 662e 6963 6f6e  button(self.icon
+0000dd20: 5f63 6c6f 7365 2e72 656e 6465 7265 725f  _close.renderer_
+0000dd30: 6964 2c20 3139 2c20 3139 293a 0d0a 2020  id, 19, 19):..  
 0000dd40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dd50: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
-0000dd60: 2e70 7573 685f 7374 796c 655f 7661 7228  .push_style_var(
-0000dd70: 696d 6775 692e 5354 594c 455f 4652 414d  imgui.STYLE_FRAM
-0000dd80: 455f 424f 5244 4552 5349 5a45 2c20 3129  E_BORDERSIZE, 1)
-0000dd90: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000dda0: 2020 2020 2020 2020 2020 2020 2020 696d                im
-0000ddb0: 6775 692e 7075 7368 5f73 7479 6c65 5f76  gui.push_style_v
-0000ddc0: 6172 2869 6d67 7569 2e53 5459 4c45 5f46  ar(imgui.STYLE_F
-0000ddd0: 5241 4d45 5f50 4144 4449 4e47 2c20 2833  RAME_PADDING, (3
-0000dde0: 2c20 3329 290d 0a20 2020 2020 2020 2020  , 3))..         
+0000dd50: 2020 2020 2020 2020 2020 6366 672e 7365            cfg.se
+0000dd60: 5f6d 6f64 656c 732e 7265 6d6f 7665 286d  _models.remove(m
+0000dd70: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0000dd80: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0000dd90: 6620 6366 672e 7365 5f61 6374 6976 655f  f cfg.se_active_
+0000dda0: 6d6f 6465 6c20 3d3d 206d 3a0d 0a20 2020  model == m:..   
+0000ddb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ddc0: 2020 2020 2020 2020 2020 2020 2063 6667               cfg
+0000ddd0: 2e73 655f 6163 7469 7665 5f6d 6f64 656c  .se_active_model
+0000dde0: 203d 204e 6f6e 650d 0a20 2020 2020 2020   = None..       
 0000ddf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000de00: 2020 2023 2054 7261 696e 2064 6174 6120     # Train data 
-0000de10: 7365 6c65 6374 696f 6e0d 0a20 2020 2020  selection..     
-0000de20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000de30: 2020 2020 2020 2063 7720 3d20 696d 6775         cw = imgu
-0000de40: 692e 6765 745f 636f 6e74 656e 745f 7265  i.get_content_re
-0000de50: 6769 6f6e 5f61 7661 696c 6162 6c65 5f77  gion_available_w
-0000de60: 6964 7468 2829 0d0a 2020 2020 2020 2020  idth()..        
-0000de70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000de80: 2020 2020 696d 6775 692e 7365 745f 6e65      imgui.set_ne
-0000de90: 7874 5f69 7465 6d5f 7769 6474 6828 6377  xt_item_width(cw
-0000dea0: 202d 2036 3529 0d0a 2020 2020 2020 2020   - 65)..        
-0000deb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dec0: 2020 2020 5f2c 206d 2e74 7261 696e 5f64      _, m.train_d
-0000ded0: 6174 615f 7061 7468 203d 2069 6d67 7569  ata_path = imgui
-0000dee0: 2e69 6e70 7574 5f74 6578 7428 2223 2374  .input_text("##t
-0000def0: 7261 696e 696e 675f 6461 7461 222c 206d  raining_data", m
-0000df00: 2e74 7261 696e 5f64 6174 615f 7061 7468  .train_data_path
-0000df10: 2c20 3235 3629 0d0a 2020 2020 2020 2020  , 256)..        
-0000df20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000df30: 2020 2020 696d 6775 692e 706f 705f 7374      imgui.pop_st
-0000df40: 796c 655f 7661 7228 290d 0a20 2020 2020  yle_var()..     
-0000df50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000df60: 2020 2020 2020 2069 6d67 7569 2e73 616d         imgui.sam
-0000df70: 655f 6c69 6e65 2829 0d0a 2020 2020 2020  e_line()..      
-0000df80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000df90: 2020 2020 2020 6966 2069 6d67 7569 2e62        if imgui.b
-0000dfa0: 7574 746f 6e28 2262 726f 7773 6522 2c20  utton("browse", 
-0000dfb0: 3536 2c20 3139 293a 0d0a 2020 2020 2020  56, 19):..      
-0000dfc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dfd0: 2020 2020 2020 2020 2020 7365 6c65 6374            select
-0000dfe0: 6564 5f66 696c 6520 3d20 6669 6c65 6469  ed_file = filedi
-0000dff0: 616c 6f67 2e61 736b 6f70 656e 6669 6c65  alog.askopenfile
-0000e000: 6e61 6d65 2866 696c 6574 7970 6573 3d5b  name(filetypes=[
-0000e010: 2822 7363 4e6f 6465 7320 7472 6169 6e64  ("scNodes traind
-0000e020: 6174 6122 2c20 6622 7b63 6667 2e66 696c  ata", f"{cfg.fil
-0000e030: 6574 7970 655f 7472 6169 6e64 6174 617d  etype_traindata}
-0000e040: 2229 5d29 0d0a 2020 2020 2020 2020 2020  ")])..          
-0000e050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e060: 2020 2020 2020 6966 2073 656c 6563 7465        if selecte
-0000e070: 645f 6669 6c65 2069 7320 6e6f 7420 4e6f  d_file is not No
-0000e080: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
-0000e090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e0a0: 2020 2020 2020 2020 206d 2e74 7261 696e           m.train
-0000e0b0: 5f64 6174 615f 7061 7468 203d 2073 656c  _data_path = sel
-0000e0c0: 6563 7465 645f 6669 6c65 0d0a 0d0a 2020  ected_file....  
-0000e0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e0e0: 2020 2020 2020 2020 2020 2320 5472 6169            # Trai
-0000e0f0: 6e69 6e67 2070 6172 616d 6574 6572 730d  ning parameters.
-0000e100: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000e110: 2020 2020 2020 2020 2020 2020 2069 6d67               img
-0000e120: 7569 2e70 7573 685f 7374 796c 655f 7661  ui.push_style_va
-0000e130: 7228 696d 6775 692e 5354 594c 455f 4652  r(imgui.STYLE_FR
-0000e140: 414d 455f 524f 554e 4449 4e47 2c20 3130  AME_ROUNDING, 10
-0000e150: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0000e160: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0000e170: 6d67 7569 2e70 7573 685f 7374 796c 655f  mgui.push_style_
-0000e180: 7661 7228 696d 6775 692e 5354 594c 455f  var(imgui.STYLE_
-0000e190: 4752 4142 5f52 4f55 4e44 494e 472c 2032  GRAB_ROUNDING, 2
-0000e1a0: 3029 0d0a 2020 2020 2020 2020 2020 2020  0)..            
-0000e1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e1c0: 696d 6775 692e 7075 7368 5f73 7479 6c65  imgui.push_style
-0000e1d0: 5f76 6172 2869 6d67 7569 2e53 5459 4c45  _var(imgui.STYLE
-0000e1e0: 5f47 5241 425f 4d49 4e5f 5349 5a45 2c20  _GRAB_MIN_SIZE, 
-0000e1f0: 3929 0d0a 2020 2020 2020 2020 2020 2020  9)..            
+0000de00: 2020 2020 206d 2e64 656c 6574 6528 290d       m.delete().
+0000de10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000de20: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+0000de30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000de40: 2020 2020 6966 2069 6d67 7569 2e69 6d61      if imgui.ima
+0000de50: 6765 5f62 7574 746f 6e28 7365 6c66 2e69  ge_button(self.i
+0000de60: 636f 6e5f 7374 6f70 2e72 656e 6465 7265  con_stop.rendere
+0000de70: 725f 6964 2c20 3139 2c20 3139 293a 0d0a  r_id, 19, 19):..
+0000de80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000de90: 2020 2020 2020 2020 2020 2020 6d2e 6261              m.ba
+0000dea0: 636b 6772 6f75 6e64 5f70 726f 6365 7373  ckground_process
+0000deb0: 5f74 7261 696e 2e73 746f 7028 290d 0a0d  _train.stop()...
+0000dec0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ded0: 2020 2020 2069 6d67 7569 2e70 6f70 5f73       imgui.pop_s
+0000dee0: 7479 6c65 5f76 6172 2831 290d 0a0d 0a20  tyle_var(1).... 
+0000def0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000df00: 2020 2069 6d67 7569 2e73 616d 655f 6c69     imgui.same_li
+0000df10: 6e65 2829 0d0a 2020 2020 2020 2020 2020  ne()..          
+0000df20: 2020 2020 2020 2020 2020 5f2c 206d 2e63            _, m.c
+0000df30: 6f6c 6f75 7220 3d20 696d 6775 692e 636f  olour = imgui.co
+0000df40: 6c6f 725f 6564 6974 3328 6d2e 7469 746c  lor_edit3(m.titl
+0000df50: 652c 202a 6d2e 636f 6c6f 7572 5b3a 335d  e, *m.colour[:3]
+0000df60: 2c20 696d 6775 692e 434f 4c4f 525f 4544  , imgui.COLOR_ED
+0000df70: 4954 5f4e 4f5f 494e 5055 5453 207c 2069  IT_NO_INPUTS | i
+0000df80: 6d67 7569 2e43 4f4c 4f52 5f45 4449 545f  mgui.COLOR_EDIT_
+0000df90: 4e4f 5f4c 4142 454c 207c 2069 6d67 7569  NO_LABEL | imgui
+0000dfa0: 2e43 4f4c 4f52 5f45 4449 545f 4e4f 5f54  .COLOR_EDIT_NO_T
+0000dfb0: 4f4f 4c54 4950 207c 2069 6d67 7569 2e43  OOLTIP | imgui.C
+0000dfc0: 4f4c 4f52 5f45 4449 545f 4e4f 5f44 5241  OLOR_EDIT_NO_DRA
+0000dfd0: 475f 4452 4f50 290d 0a20 2020 2020 2020  G_DROP)..       
+0000dfe0: 2020 2020 2020 2020 2020 2020 2023 2054               # T
+0000dff0: 6974 6c65 0d0a 2020 2020 2020 2020 2020  itle..          
+0000e000: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
+0000e010: 7361 6d65 5f6c 696e 6528 290d 0a20 2020  same_line()..   
+0000e020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e030: 2069 6d67 7569 2e73 6574 5f6e 6578 745f   imgui.set_next_
+0000e040: 6974 656d 5f77 6964 7468 2863 7720 2d20  item_width(cw - 
+0000e050: 3535 290d 0a20 2020 2020 2020 2020 2020  55)..           
+0000e060: 2020 2020 2020 2020 205f 2c20 6d2e 7469           _, m.ti
+0000e070: 746c 6520 3d20 696d 6775 692e 696e 7075  tle = imgui.inpu
+0000e080: 745f 7465 7874 2822 2323 7469 746c 6522  t_text("##title"
+0000e090: 2c20 6d2e 7469 746c 652c 2032 3536 2c20  , m.title, 256, 
+0000e0a0: 696d 6775 692e 494e 5055 545f 5445 5854  imgui.INPUT_TEXT
+0000e0b0: 5f4e 4f5f 484f 5249 5a4f 4e54 414c 5f53  _NO_HORIZONTAL_S
+0000e0c0: 4352 4f4c 4c20 7c20 696d 6775 692e 494e  CROLL | imgui.IN
+0000e0d0: 5055 545f 5445 5854 5f41 5554 4f5f 5345  PUT_TEXT_AUTO_SE
+0000e0e0: 4c45 4354 5f41 4c4c 290d 0a20 2020 2020  LECT_ALL)..     
+0000e0f0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0000e100: 656c 662e 5f67 7569 5f66 6561 7475 7265  elf._gui_feature
+0000e110: 5f74 6974 6c65 5f63 6f6e 7465 7874 5f6d  _title_context_m
+0000e120: 656e 7528 6d29 0d0a 2020 2020 2020 2020  enu(m)..        
+0000e130: 2020 2020 2020 2020 2020 2020 2320 4d6f              # Mo
+0000e140: 6465 6c20 7365 6c65 6374 696f 6e0d 0a20  del selection.. 
+0000e150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e160: 2020 2069 6d67 7569 2e70 7573 685f 7374     imgui.push_st
+0000e170: 796c 655f 7661 7228 696d 6775 692e 5354  yle_var(imgui.ST
+0000e180: 594c 455f 4652 414d 455f 5041 4444 494e  YLE_FRAME_PADDIN
+0000e190: 472c 2028 352c 2032 2929 0d0a 2020 2020  G, (5, 2))..    
+0000e1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e1b0: 696d 6775 692e 616c 6967 6e5f 7465 7874  imgui.align_text
+0000e1c0: 5f74 6f5f 6672 616d 655f 7061 6464 696e  _to_frame_paddin
+0000e1d0: 6728 290d 0a0d 0a20 2020 2020 2020 2020  g()....         
+0000e1e0: 2020 2020 2020 2020 2020 2069 6620 6d2e             if m.
+0000e1f0: 636f 6d70 696c 6564 3a0d 0a20 2020 2020  compiled:..     
 0000e200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e210: 696d 6775 692e 7075 7368 5f73 7479 6c65  imgui.push_style
-0000e220: 5f76 6172 2869 6d67 7569 2e53 5459 4c45  _var(imgui.STYLE
-0000e230: 5f46 5241 4d45 5f50 4144 4449 4e47 2c20  _FRAME_PADDING, 
-0000e240: 2830 2c20 3029 290d 0a0d 0a20 2020 2020  (0, 0))....     
-0000e250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e260: 2020 2020 2020 2069 6d67 7569 2e70 7573         imgui.pus
-0000e270: 685f 6974 656d 5f77 6964 7468 2828 6377  h_item_width((cw
-0000e280: 202d 2037 2920 2f20 3229 0d0a 2020 2020   - 7) / 2)..    
-0000e290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e2a0: 2020 2020 2020 2020 5f2c 206d 2e65 706f          _, m.epo
-0000e2b0: 6368 7320 3d20 696d 6775 692e 736c 6964  chs = imgui.slid
-0000e2c0: 6572 5f69 6e74 2822 2323 6570 6f63 6873  er_int("##epochs
-0000e2d0: 222c 206d 2e65 706f 6368 732c 2031 2c20  ", m.epochs, 1, 
-0000e2e0: 3530 2c20 6622 7b6d 2e65 706f 6368 737d  50, f"{m.epochs}
-0000e2f0: 2065 706f 6368 222b 2822 7322 2069 6620   epoch"+("s" if 
-0000e300: 6d2e 6570 6f63 6873 3e31 2065 6c73 6520  m.epochs>1 else 
-0000e310: 2222 2929 0d0a 2020 2020 2020 2020 2020  ""))..          
-0000e320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e330: 2020 696d 6775 692e 7361 6d65 5f6c 696e    imgui.same_lin
-0000e340: 6528 290d 0a20 2020 2020 2020 2020 2020  e()..           
-0000e350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e360: 2065 7863 6573 735f 6e65 6761 7469 7665   excess_negative
-0000e370: 5f6c 6162 656c 203d 2066 227b 2727 2069  _label = f"{'' i
-0000e380: 6620 6d2e 6578 6365 7373 5f6e 6567 6174  f m.excess_negat
-0000e390: 6976 653c 3020 656c 7365 2027 2b27 7d7b  ive<0 else '+'}{
-0000e3a0: 6d2e 6578 6365 7373 5f6e 6567 6174 6976  m.excess_negativ
-0000e3b0: 657d 2525 206e 6567 6174 6976 6573 220d  e}%% negatives".
-0000e3c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000e3d0: 2020 2020 2020 2020 2020 2020 205f 2c20               _, 
-0000e3e0: 6d2e 6578 6365 7373 5f6e 6567 6174 6976  m.excess_negativ
-0000e3f0: 6520 3d20 696d 6775 692e 736c 6964 6572  e = imgui.slider
-0000e400: 5f69 6e74 2822 2323 6578 6365 7373 6e65  _int("##excessne
-0000e410: 6761 7469 7665 222c 206d 2e65 7863 6573  gative", m.exces
-0000e420: 735f 6e65 6761 7469 7665 2c20 302c 2031  s_negative, 0, 1
-0000e430: 3030 2c20 6622 2b7b 6d2e 6578 6365 7373  00, f"+{m.excess
-0000e440: 5f6e 6567 6174 6976 657d 2525 206e 6567  _negative}%% neg
-0000e450: 6174 6976 6573 2229 0d0a 2020 2020 2020  atives")..      
-0000e460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e470: 2020 2020 2020 5f2c 206d 2e62 6174 6368        _, m.batch
-0000e480: 5f73 697a 6520 3d20 696d 6775 692e 736c  _size = imgui.sl
-0000e490: 6964 6572 5f69 6e74 2822 2323 6261 7463  ider_int("##batc
-0000e4a0: 6873 222c 206d 2e62 6174 6368 5f73 697a  hs", m.batch_siz
-0000e4b0: 652c 2031 2c20 3132 382c 2066 227b 6d2e  e, 1, 128, f"{m.
-0000e4c0: 6261 7463 685f 7369 7a65 7d20 6261 7463  batch_size} batc
-0000e4d0: 6820 7369 7a65 2229 0d0a 2020 2020 2020  h size")..      
-0000e4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e4f0: 2020 2020 2020 696d 6775 692e 7361 6d65        imgui.same
-0000e500: 5f6c 696e 6528 290d 0a20 2020 2020 2020  _line()..       
-0000e510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e520: 2020 2020 205f 2c20 6d2e 6e5f 636f 7069       _, m.n_copi
-0000e530: 6573 203d 2069 6d67 7569 2e73 6c69 6465  es = imgui.slide
-0000e540: 725f 696e 7428 2223 2363 6f70 6965 7322  r_int("##copies"
-0000e550: 2c20 6d2e 6e5f 636f 7069 6573 2c20 312c  , m.n_copies, 1,
-0000e560: 2031 302c 2066 227b 6d2e 6e5f 636f 7069   10, f"{m.n_copi
-0000e570: 6573 7d20 636f 7069 6573 2229 0d0a 2020  es} copies")..  
-0000e580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e590: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
-0000e5a0: 706f 705f 6974 656d 5f77 6964 7468 2829  pop_item_width()
-0000e5b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000e5c0: 2020 2020 2020 2020 2020 2020 2020 696d                im
-0000e5d0: 6775 692e 706f 705f 7374 796c 655f 7661  gui.pop_style_va
-0000e5e0: 7228 3129 0d0a 2020 2020 2020 2020 2020  r(1)..          
-0000e5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e600: 2020 696d 6775 692e 7075 7368 5f73 7479    imgui.push_sty
-0000e610: 6c65 5f76 6172 2869 6d67 7569 2e53 5459  le_var(imgui.STY
-0000e620: 4c45 5f46 5241 4d45 5f50 4144 4449 4e47  LE_FRAME_PADDING
-0000e630: 2c20 2830 2c20 3229 290d 0a0d 0a20 2020  , (0, 2))....   
-0000e640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e650: 2020 2020 2020 2020 2023 204c 6f61 642c           # Load,
-0000e660: 2073 6176 652c 2074 7261 696e 2062 7574   save, train but
-0000e670: 746f 6e73 2e0d 0a20 2020 2020 2020 2020  tons...         
-0000e680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e690: 2020 2062 6c6f 636b 5f62 7574 746f 6e73     block_buttons
-0000e6a0: 203d 2046 616c 7365 0d0a 2020 2020 2020   = False..      
-0000e6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e6c0: 2020 2020 2020 6966 206e 6f74 206d 2e62        if not m.b
-0000e6d0: 6163 6b67 726f 756e 645f 7072 6f63 6573  ackground_proces
-0000e6e0: 735f 7472 6169 6e20 6973 204e 6f6e 653a  s_train is None:
-0000e6f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000e700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e710: 2020 696d 6775 692e 7075 7368 5f73 7479    imgui.push_sty
-0000e720: 6c65 5f63 6f6c 6f72 2869 6d67 7569 2e43  le_color(imgui.C
-0000e730: 4f4c 4f52 5f46 5241 4d45 5f42 4143 4b47  OLOR_FRAME_BACKG
-0000e740: 524f 554e 442c 202a 6366 672e 434f 4c4f  ROUND, *cfg.COLO
-0000e750: 5552 5f4e 4555 5452 414c 5f4c 4947 4854  UR_NEUTRAL_LIGHT
-0000e760: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0000e210: 2020 2069 6d67 7569 2e74 6578 7428 6d2e     imgui.text(m.
+0000e220: 696e 666f 290d 0a20 2020 2020 2020 2020  info)..         
+0000e230: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+0000e240: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000e250: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
+0000e260: 7465 7874 2822 4d6f 6465 6c3a 2229 0d0a  text("Model:")..
+0000e270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e280: 2020 2020 2020 2020 696d 6775 692e 7361          imgui.sa
+0000e290: 6d65 5f6c 696e 6528 290d 0a20 2020 2020  me_line()..     
+0000e2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e2b0: 2020 2069 6d67 7569 2e73 6574 5f6e 6578     imgui.set_nex
+0000e2c0: 745f 6974 656d 5f77 6964 7468 2863 7720  t_item_width(cw 
+0000e2d0: 2d20 3531 290d 0a20 2020 2020 2020 2020  - 51)..         
+0000e2e0: 2020 2020 2020 2020 2020 2020 2020 205f                 _
+0000e2f0: 2c20 6d2e 6d6f 6465 6c5f 656e 756d 203d  , m.model_enum =
+0000e300: 2069 6d67 7569 2e63 6f6d 626f 2822 2323   imgui.combo("##
+0000e310: 6d6f 6465 6c5f 7479 7065 222c 206d 2e6d  model_type", m.m
+0000e320: 6f64 656c 5f65 6e75 6d2c 2053 454d 6f64  odel_enum, SEMod
+0000e330: 656c 2e41 5641 494c 4142 4c45 5f4d 4f44  el.AVAILABLE_MOD
+0000e340: 454c 5329 0d0a 2020 2020 2020 2020 2020  ELS)..          
+0000e350: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
+0000e360: 706f 705f 7374 796c 655f 7661 7228 290d  pop_style_var().
+0000e370: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+0000e380: 2020 2020 2020 2069 6620 696d 6775 692e         if imgui.
+0000e390: 6265 6769 6e5f 7461 625f 6261 7228 2223  begin_tab_bar("#
+0000e3a0: 2374 6162 7322 293a 0d0a 2020 2020 2020  #tabs"):..      
+0000e3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e3c0: 2020 6966 2069 6d67 7569 2e62 6567 696e    if imgui.begin
+0000e3d0: 5f74 6162 5f69 7465 6d28 2220 5472 6169  _tab_item(" Trai
+0000e3e0: 6e69 6e67 2022 295b 305d 3a0d 0a20 2020  ning ")[0]:..   
+0000e3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e400: 2020 2020 2020 2020 206d 2e61 6374 6976           m.activ
+0000e410: 655f 7461 6220 3d20 300d 0a20 2020 2020  e_tab = 0..     
+0000e420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e430: 2020 2020 2020 2069 6d67 7569 2e70 7573         imgui.pus
+0000e440: 685f 7374 796c 655f 7661 7228 696d 6775  h_style_var(imgu
+0000e450: 692e 5354 594c 455f 4652 414d 455f 424f  i.STYLE_FRAME_BO
+0000e460: 5244 4552 5349 5a45 2c20 3129 0d0a 2020  RDERSIZE, 1)..  
+0000e470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e480: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
+0000e490: 7075 7368 5f73 7479 6c65 5f76 6172 2869  push_style_var(i
+0000e4a0: 6d67 7569 2e53 5459 4c45 5f46 5241 4d45  mgui.STYLE_FRAME
+0000e4b0: 5f50 4144 4449 4e47 2c20 2833 2c20 3329  _PADDING, (3, 3)
+0000e4c0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0000e4d0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0000e4e0: 2054 7261 696e 2064 6174 6120 7365 6c65   Train data sele
+0000e4f0: 6374 696f 6e0d 0a20 2020 2020 2020 2020  ction..         
+0000e500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e510: 2020 2063 7720 3d20 696d 6775 692e 6765     cw = imgui.ge
+0000e520: 745f 636f 6e74 656e 745f 7265 6769 6f6e  t_content_region
+0000e530: 5f61 7661 696c 6162 6c65 5f77 6964 7468  _available_width
+0000e540: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
+0000e550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e560: 696d 6775 692e 7365 745f 6e65 7874 5f69  imgui.set_next_i
+0000e570: 7465 6d5f 7769 6474 6828 6377 202d 2036  tem_width(cw - 6
+0000e580: 3529 0d0a 2020 2020 2020 2020 2020 2020  5)..            
+0000e590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e5a0: 5f2c 206d 2e74 7261 696e 5f64 6174 615f  _, m.train_data_
+0000e5b0: 7061 7468 203d 2069 6d67 7569 2e69 6e70  path = imgui.inp
+0000e5c0: 7574 5f74 6578 7428 2223 2374 7261 696e  ut_text("##train
+0000e5d0: 696e 675f 6461 7461 222c 206d 2e74 7261  ing_data", m.tra
+0000e5e0: 696e 5f64 6174 615f 7061 7468 2c20 3235  in_data_path, 25
+0000e5f0: 3629 0d0a 2020 2020 2020 2020 2020 2020  6)..            
+0000e600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e610: 696d 6775 692e 706f 705f 7374 796c 655f  imgui.pop_style_
+0000e620: 7661 7228 290d 0a20 2020 2020 2020 2020  var()..         
+0000e630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e640: 2020 2069 6d67 7569 2e73 616d 655f 6c69     imgui.same_li
+0000e650: 6e65 2829 0d0a 2020 2020 2020 2020 2020  ne()..          
+0000e660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e670: 2020 6966 2069 6d67 7569 2e62 7574 746f    if imgui.butto
+0000e680: 6e28 2262 726f 7773 6522 2c20 3536 2c20  n("browse", 56, 
+0000e690: 3139 293a 0d0a 2020 2020 2020 2020 2020  19):..          
+0000e6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e6b0: 2020 2020 2020 7365 6c65 6374 6564 5f66        selected_f
+0000e6c0: 696c 6520 3d20 6669 6c65 6469 616c 6f67  ile = filedialog
+0000e6d0: 2e61 736b 6f70 656e 6669 6c65 6e61 6d65  .askopenfilename
+0000e6e0: 2866 696c 6574 7970 6573 3d5b 2822 7363  (filetypes=[("sc
+0000e6f0: 4e6f 6465 7320 7472 6169 6e64 6174 6122  Nodes traindata"
+0000e700: 2c20 6622 7b63 6667 2e66 696c 6574 7970  , f"{cfg.filetyp
+0000e710: 655f 7472 6169 6e64 6174 617d 2229 5d29  e_traindata}")])
+0000e720: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000e730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e740: 2020 6966 2073 656c 6563 7465 645f 6669    if selected_fi
+0000e750: 6c65 2069 7320 6e6f 7420 4e6f 6e65 3a0d  le is not None:.
+0000e760: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 0000e770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e780: 2020 2069 6d67 7569 2e70 7573 685f 7374     imgui.push_st
-0000e790: 796c 655f 636f 6c6f 7228 696d 6775 692e  yle_color(imgui.
-0000e7a0: 434f 4c4f 525f 4652 414d 455f 4241 434b  COLOR_FRAME_BACK
-0000e7b0: 4752 4f55 4e44 5f48 4f56 4552 4544 2c20  GROUND_HOVERED, 
-0000e7c0: 2a63 6667 2e43 4f4c 4f55 525f 4e45 5554  *cfg.COLOUR_NEUT
-0000e7d0: 5241 4c5f 4c49 4748 5429 0d0a 2020 2020  RAL_LIGHT)..    
+0000e780: 2020 2020 206d 2e74 7261 696e 5f64 6174       m.train_dat
+0000e790: 615f 7061 7468 203d 2073 656c 6563 7465  a_path = selecte
+0000e7a0: 645f 6669 6c65 0d0a 0d0a 2020 2020 2020  d_file....      
+0000e7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e7c0: 2020 2020 2020 2320 5472 6169 6e69 6e67        # Training
+0000e7d0: 2070 6172 616d 6574 6572 730d 0a20 2020   parameters..   
 0000e7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e7f0: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
-0000e800: 692e 7075 7368 5f73 7479 6c65 5f63 6f6c  i.push_style_col
-0000e810: 6f72 2869 6d67 7569 2e43 4f4c 4f52 5f46  or(imgui.COLOR_F
-0000e820: 5241 4d45 5f42 4143 4b47 524f 554e 445f  RAME_BACKGROUND_
-0000e830: 4143 5449 5645 2c20 2a63 6667 2e43 4f4c  ACTIVE, *cfg.COL
-0000e840: 4f55 525f 4e45 5554 5241 4c5f 4c49 4748  OUR_NEUTRAL_LIGH
-0000e850: 5429 0d0a 2020 2020 2020 2020 2020 2020  T)..            
-0000e860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e870: 2020 2020 696d 6775 692e 7075 7368 5f73      imgui.push_s
-0000e880: 7479 6c65 5f63 6f6c 6f72 2869 6d67 7569  tyle_color(imgui
-0000e890: 2e43 4f4c 4f52 5f54 4558 542c 202a 6366  .COLOR_TEXT, *cf
-0000e8a0: 672e 434f 4c4f 5552 5f4e 4555 5452 414c  g.COLOUR_NEUTRAL
-0000e8b0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0000e8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e8d0: 2020 2062 6c6f 636b 5f62 7574 746f 6e73     block_buttons
-0000e8e0: 203d 2054 7275 650d 0a20 2020 2020 2020   = True..       
-0000e8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e900: 2020 2020 2069 6620 696d 6775 692e 6275       if imgui.bu
-0000e910: 7474 6f6e 2822 6c6f 6164 222c 2028 6377  tton("load", (cw
-0000e920: 202d 2031 3629 202f 2033 2c20 3230 293a   - 16) / 3, 20):
-0000e930: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000e940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e950: 2020 6966 206e 6f74 2062 6c6f 636b 5f62    if not block_b
-0000e960: 7574 746f 6e73 3a0d 0a20 2020 2020 2020  uttons:..       
+0000e7f0: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
+0000e800: 7573 685f 7374 796c 655f 7661 7228 696d  ush_style_var(im
+0000e810: 6775 692e 5354 594c 455f 4652 414d 455f  gui.STYLE_FRAME_
+0000e820: 524f 554e 4449 4e47 2c20 3130 290d 0a20  ROUNDING, 10).. 
+0000e830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e840: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
+0000e850: 2e70 7573 685f 7374 796c 655f 7661 7228  .push_style_var(
+0000e860: 696d 6775 692e 5354 594c 455f 4752 4142  imgui.STYLE_GRAB
+0000e870: 5f52 4f55 4e44 494e 472c 2032 3029 0d0a  _ROUNDING, 20)..
+0000e880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e890: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
+0000e8a0: 692e 7075 7368 5f73 7479 6c65 5f76 6172  i.push_style_var
+0000e8b0: 2869 6d67 7569 2e53 5459 4c45 5f47 5241  (imgui.STYLE_GRA
+0000e8c0: 425f 4d49 4e5f 5349 5a45 2c20 3929 0d0a  B_MIN_SIZE, 9)..
+0000e8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e8e0: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
+0000e8f0: 692e 7075 7368 5f73 7479 6c65 5f76 6172  i.push_style_var
+0000e900: 2869 6d67 7569 2e53 5459 4c45 5f46 5241  (imgui.STYLE_FRA
+0000e910: 4d45 5f50 4144 4449 4e47 2c20 2830 2c20  ME_PADDING, (0, 
+0000e920: 3029 290d 0a0d 0a20 2020 2020 2020 2020  0))....         
+0000e930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e940: 2020 2069 6d67 7569 2e70 7573 685f 6974     imgui.push_it
+0000e950: 656d 5f77 6964 7468 2828 6377 202d 2037  em_width((cw - 7
+0000e960: 2920 2f20 3229 0d0a 2020 2020 2020 2020  ) / 2)..        
 0000e970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e980: 2020 2020 2020 2020 2020 2020 206d 6f64               mod
-0000e990: 656c 5f70 6174 6820 3d20 6669 6c65 6469  el_path = filedi
-0000e9a0: 616c 6f67 2e61 736b 6f70 656e 6669 6c65  alog.askopenfile
-0000e9b0: 6e61 6d65 2866 696c 6574 7970 6573 3d5b  name(filetypes=[
-0000e9c0: 2822 7363 4e6f 6465 7320 434e 4e22 2c20  ("scNodes CNN", 
-0000e9d0: 6622 7b63 6667 2e66 696c 6574 7970 655f  f"{cfg.filetype_
-0000e9e0: 7365 6d6f 6465 6c7d 2229 5d29 0d0a 2020  semodel}")])..  
-0000e9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ea00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ea10: 2020 6966 206d 6f64 656c 5f70 6174 6820    if model_path 
-0000ea20: 213d 2022 223a 0d0a 2020 2020 2020 2020  != "":..        
-0000ea30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ea40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ea50: 6d2e 6c6f 6164 286d 6f64 656c 5f70 6174  m.load(model_pat
-0000ea60: 6829 0d0a 2020 2020 2020 2020 2020 2020  h)..            
-0000ea70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ea80: 696d 6775 692e 7361 6d65 5f6c 696e 6528  imgui.same_line(
-0000ea90: 7370 6163 696e 673d 3829 0d0a 2020 2020  spacing=8)..    
+0000e980: 2020 2020 5f2c 206d 2e65 706f 6368 7320      _, m.epochs 
+0000e990: 3d20 696d 6775 692e 736c 6964 6572 5f69  = imgui.slider_i
+0000e9a0: 6e74 2822 2323 6570 6f63 6873 222c 206d  nt("##epochs", m
+0000e9b0: 2e65 706f 6368 732c 2031 2c20 3530 2c20  .epochs, 1, 50, 
+0000e9c0: 6622 7b6d 2e65 706f 6368 737d 2065 706f  f"{m.epochs} epo
+0000e9d0: 6368 222b 2822 7322 2069 6620 6d2e 6570  ch"+("s" if m.ep
+0000e9e0: 6f63 6873 3e31 2065 6c73 6520 2222 2929  ochs>1 else ""))
+0000e9f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000ea00: 2020 2020 2020 2020 2020 2020 2020 696d                im
+0000ea10: 6775 692e 7361 6d65 5f6c 696e 6528 290d  gui.same_line().
+0000ea20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ea30: 2020 2020 2020 2020 2020 2020 2065 7863               exc
+0000ea40: 6573 735f 6e65 6761 7469 7665 5f6c 6162  ess_negative_lab
+0000ea50: 656c 203d 2066 227b 2727 2069 6620 6d2e  el = f"{'' if m.
+0000ea60: 6578 6365 7373 5f6e 6567 6174 6976 653c  excess_negative<
+0000ea70: 3020 656c 7365 2027 2b27 7d7b 6d2e 6578  0 else '+'}{m.ex
+0000ea80: 6365 7373 5f6e 6567 6174 6976 657d 2525  cess_negative}%%
+0000ea90: 206e 6567 6174 6976 6573 220d 0a20 2020   negatives"..   
 0000eaa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000eab0: 2020 2020 2020 2020 626c 6f63 6b5f 7361          block_sa
-0000eac0: 7665 5f62 7574 746f 6e20 3d20 4661 6c73  ve_button = Fals
-0000ead0: 650d 0a20 2020 2020 2020 2020 2020 2020  e..             
-0000eae0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0000eaf0: 6620 6d2e 6d6f 6465 6c20 6973 204e 6f6e  f m.model is Non
-0000eb00: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-0000eb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000eb20: 2020 2020 696d 6775 692e 7075 7368 5f73      imgui.push_s
-0000eb30: 7479 6c65 5f63 6f6c 6f72 2869 6d67 7569  tyle_color(imgui
-0000eb40: 2e43 4f4c 4f52 5f46 5241 4d45 5f42 4143  .COLOR_FRAME_BAC
-0000eb50: 4b47 524f 554e 442c 202a 6366 672e 434f  KGROUND, *cfg.CO
-0000eb60: 4c4f 5552 5f4e 4555 5452 414c 5f4c 4947  LOUR_NEUTRAL_LIG
-0000eb70: 4854 290d 0a20 2020 2020 2020 2020 2020  HT)..           
-0000eb80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000eb90: 2020 2020 2069 6d67 7569 2e70 7573 685f       imgui.push_
-0000eba0: 7374 796c 655f 636f 6c6f 7228 696d 6775  style_color(imgu
-0000ebb0: 692e 434f 4c4f 525f 4652 414d 455f 4241  i.COLOR_FRAME_BA
-0000ebc0: 434b 4752 4f55 4e44 5f48 4f56 4552 4544  CKGROUND_HOVERED
-0000ebd0: 2c20 2a63 6667 2e43 4f4c 4f55 525f 4e45  , *cfg.COLOUR_NE
-0000ebe0: 5554 5241 4c5f 4c49 4748 5429 0d0a 2020  UTRAL_LIGHT)..  
+0000eab0: 2020 2020 2020 2020 205f 2c20 6d2e 6578           _, m.ex
+0000eac0: 6365 7373 5f6e 6567 6174 6976 6520 3d20  cess_negative = 
+0000ead0: 696d 6775 692e 736c 6964 6572 5f69 6e74  imgui.slider_int
+0000eae0: 2822 2323 6578 6365 7373 6e65 6761 7469  ("##excessnegati
+0000eaf0: 7665 222c 206d 2e65 7863 6573 735f 6e65  ve", m.excess_ne
+0000eb00: 6761 7469 7665 2c20 302c 2031 3030 2c20  gative, 0, 100, 
+0000eb10: 6622 2b7b 6d2e 6578 6365 7373 5f6e 6567  f"+{m.excess_neg
+0000eb20: 6174 6976 657d 2525 206e 6567 6174 6976  ative}%% negativ
+0000eb30: 6573 2229 0d0a 2020 2020 2020 2020 2020  es")..          
+0000eb40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000eb50: 2020 5f2c 206d 2e62 6174 6368 5f73 697a    _, m.batch_siz
+0000eb60: 6520 3d20 696d 6775 692e 736c 6964 6572  e = imgui.slider
+0000eb70: 5f69 6e74 2822 2323 6261 7463 6873 222c  _int("##batchs",
+0000eb80: 206d 2e62 6174 6368 5f73 697a 652c 2031   m.batch_size, 1
+0000eb90: 2c20 3132 382c 2066 227b 6d2e 6261 7463  , 128, f"{m.batc
+0000eba0: 685f 7369 7a65 7d20 6261 7463 6820 7369  h_size} batch si
+0000ebb0: 7a65 2229 0d0a 2020 2020 2020 2020 2020  ze")..          
+0000ebc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ebd0: 2020 696d 6775 692e 7361 6d65 5f6c 696e    imgui.same_lin
+0000ebe0: 6528 290d 0a20 2020 2020 2020 2020 2020  e()..           
 0000ebf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ec00: 2020 2020 2020 2020 2020 2020 2020 696d                im
-0000ec10: 6775 692e 7075 7368 5f73 7479 6c65 5f63  gui.push_style_c
-0000ec20: 6f6c 6f72 2869 6d67 7569 2e43 4f4c 4f52  olor(imgui.COLOR
-0000ec30: 5f46 5241 4d45 5f42 4143 4b47 524f 554e  _FRAME_BACKGROUN
-0000ec40: 445f 4143 5449 5645 2c20 2a63 6667 2e43  D_ACTIVE, *cfg.C
-0000ec50: 4f4c 4f55 525f 4e45 5554 5241 4c5f 4c49  OLOUR_NEUTRAL_LI
-0000ec60: 4748 5429 0d0a 2020 2020 2020 2020 2020  GHT)..          
-0000ec70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ec80: 2020 2020 2020 696d 6775 692e 7075 7368        imgui.push
-0000ec90: 5f73 7479 6c65 5f63 6f6c 6f72 2869 6d67  _style_color(img
-0000eca0: 7569 2e43 4f4c 4f52 5f54 4558 542c 202a  ui.COLOR_TEXT, *
-0000ecb0: 6366 672e 434f 4c4f 5552 5f4e 4555 5452  cfg.COLOUR_NEUTR
-0000ecc0: 414c 290d 0a20 2020 2020 2020 2020 2020  AL)..           
-0000ecd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ece0: 2020 2020 2062 6c6f 636b 5f73 6176 655f       block_save_
-0000ecf0: 6275 7474 6f6e 203d 2054 7275 650d 0a20  button = True.. 
-0000ed00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ed10: 2020 2020 2020 2020 2020 2069 6620 696d             if im
-0000ed20: 6775 692e 6275 7474 6f6e 2822 7361 7665  gui.button("save
-0000ed30: 222c 2028 6377 202d 2031 3629 202f 2033  ", (cw - 16) / 3
-0000ed40: 2c20 3230 293a 0d0a 2020 2020 2020 2020  , 20):..        
-0000ed50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ed60: 2020 2020 2020 2020 6966 206e 6f74 2062          if not b
-0000ed70: 6c6f 636b 5f62 7574 746f 6e73 2061 6e64  lock_buttons and
-0000ed80: 206e 6f74 2062 6c6f 636b 5f73 6176 655f   not block_save_
-0000ed90: 6275 7474 6f6e 3a0d 0a20 2020 2020 2020  button:..       
-0000eda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000edb0: 2020 2020 2020 2020 2020 2020 2070 726f               pro
-0000edc0: 706f 7365 645f 6669 6c65 6e61 6d65 203d  posed_filename =
-0000edd0: 2066 227b 6d2e 6170 6978 3a2e 3266 7d5f   f"{m.apix:.2f}_
-0000ede0: 7b6d 2e62 6f78 5f73 697a 657d 5f7b 6d2e  {m.box_size}_{m.
-0000edf0: 6c6f 7373 3a2e 3466 7d5f 7b6d 2e74 6974  loss:.4f}_{m.tit
-0000ee00: 6c65 7d22 0d0a 2020 2020 2020 2020 2020  le}"..          
-0000ee10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ee20: 2020 2020 2020 2020 2020 6d6f 6465 6c5f            model_
-0000ee30: 7061 7468 203d 2066 696c 6564 6961 6c6f  path = filedialo
-0000ee40: 672e 6173 6b73 6176 6561 7366 696c 656e  g.asksaveasfilen
-0000ee50: 616d 6528 6669 6c65 7479 7065 733d 5b28  ame(filetypes=[(
-0000ee60: 2273 634e 6f64 6573 206d 6f64 656c 222c  "scNodes model",
-0000ee70: 2066 227b 6366 672e 6669 6c65 7479 7065   f"{cfg.filetype
-0000ee80: 5f73 656d 6f64 656c 7d22 295d 2c20 696e  _semodel}")], in
-0000ee90: 6974 6961 6c66 696c 653d 7072 6f70 6f73  itialfile=propos
-0000eea0: 6564 5f66 696c 656e 616d 6529 0d0a 2020  ed_filename)..  
-0000eeb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ec00: 205f 2c20 6d2e 6e5f 636f 7069 6573 203d   _, m.n_copies =
+0000ec10: 2069 6d67 7569 2e73 6c69 6465 725f 696e   imgui.slider_in
+0000ec20: 7428 2223 2363 6f70 6965 7322 2c20 6d2e  t("##copies", m.
+0000ec30: 6e5f 636f 7069 6573 2c20 312c 2031 302c  n_copies, 1, 10,
+0000ec40: 2066 227b 6d2e 6e5f 636f 7069 6573 7d20   f"{m.n_copies} 
+0000ec50: 636f 7069 6573 2229 0d0a 2020 2020 2020  copies")..      
+0000ec60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ec70: 2020 2020 2020 696d 6775 692e 706f 705f        imgui.pop_
+0000ec80: 6974 656d 5f77 6964 7468 2829 0d0a 2020  item_width()..  
+0000ec90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000eca0: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
+0000ecb0: 706f 705f 7374 796c 655f 7661 7228 3129  pop_style_var(1)
+0000ecc0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000ecd0: 2020 2020 2020 2020 2020 2020 2020 696d                im
+0000ece0: 6775 692e 7075 7368 5f73 7479 6c65 5f76  gui.push_style_v
+0000ecf0: 6172 2869 6d67 7569 2e53 5459 4c45 5f46  ar(imgui.STYLE_F
+0000ed00: 5241 4d45 5f50 4144 4449 4e47 2c20 2830  RAME_PADDING, (0
+0000ed10: 2c20 3229 290d 0a0d 0a20 2020 2020 2020  , 2))....       
+0000ed20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ed30: 2020 2020 2023 204c 6f61 642c 2073 6176       # Load, sav
+0000ed40: 652c 2074 7261 696e 2062 7574 746f 6e73  e, train buttons
+0000ed50: 2e0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+0000ed60: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+0000ed70: 6c6f 636b 5f62 7574 746f 6e73 203d 2046  lock_buttons = F
+0000ed80: 616c 7365 0d0a 2020 2020 2020 2020 2020  alse..          
+0000ed90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000eda0: 2020 6966 206e 6f74 206d 2e62 6163 6b67    if not m.backg
+0000edb0: 726f 756e 645f 7072 6f63 6573 735f 7472  round_process_tr
+0000edc0: 6169 6e20 6973 204e 6f6e 653a 0d0a 2020  ain is None:..  
+0000edd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ede0: 2020 2020 2020 2020 2020 2020 2020 696d                im
+0000edf0: 6775 692e 7075 7368 5f73 7479 6c65 5f63  gui.push_style_c
+0000ee00: 6f6c 6f72 2869 6d67 7569 2e43 4f4c 4f52  olor(imgui.COLOR
+0000ee10: 5f46 5241 4d45 5f42 4143 4b47 524f 554e  _FRAME_BACKGROUN
+0000ee20: 442c 202a 6366 672e 434f 4c4f 5552 5f4e  D, *cfg.COLOUR_N
+0000ee30: 4555 5452 414c 5f4c 4947 4854 290d 0a20  EUTRAL_LIGHT).. 
+0000ee40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ee50: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0000ee60: 6d67 7569 2e70 7573 685f 7374 796c 655f  mgui.push_style_
+0000ee70: 636f 6c6f 7228 696d 6775 692e 434f 4c4f  color(imgui.COLO
+0000ee80: 525f 4652 414d 455f 4241 434b 4752 4f55  R_FRAME_BACKGROU
+0000ee90: 4e44 5f48 4f56 4552 4544 2c20 2a63 6667  ND_HOVERED, *cfg
+0000eea0: 2e43 4f4c 4f55 525f 4e45 5554 5241 4c5f  .COLOUR_NEUTRAL_
+0000eeb0: 4c49 4748 5429 0d0a 2020 2020 2020 2020  LIGHT)..        
 0000eec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000eed0: 2020 6966 206d 6f64 656c 5f70 6174 6820    if model_path 
-0000eee0: 213d 2022 223a 0d0a 2020 2020 2020 2020  != "":..        
-0000eef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ef00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ef10: 6966 206d 6f64 656c 5f70 6174 685b 2d6c  if model_path[-l
-0000ef20: 656e 2863 6667 2e66 696c 6574 7970 655f  en(cfg.filetype_
-0000ef30: 7365 6d6f 6465 6c29 3a5d 2021 3d20 6366  semodel):] != cf
-0000ef40: 672e 6669 6c65 7479 7065 5f73 656d 6f64  g.filetype_semod
-0000ef50: 656c 3a0d 0a20 2020 2020 2020 2020 2020  el:..           
-0000ef60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ef70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ef80: 206d 6f64 656c 5f70 6174 6820 2b3d 2063   model_path += c
-0000ef90: 6667 2e66 696c 6574 7970 655f 7365 6d6f  fg.filetype_semo
-0000efa0: 6465 6c0d 0a20 2020 2020 2020 2020 2020  del..           
-0000efb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000efc0: 2020 2020 2020 2020 2020 2020 206d 2e73               m.s
-0000efd0: 6176 6528 6d6f 6465 6c5f 7061 7468 2c20  ave(model_path, 
-0000efe0: 6366 672e 7365 5f61 6374 6976 655f 6672  cfg.se_active_fr
-0000eff0: 616d 652e 6461 7461 290d 0a20 2020 2020  ame.data)..     
-0000f000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f010: 2020 2020 2020 2069 6620 626c 6f63 6b5f         if block_
-0000f020: 7361 7665 5f62 7574 746f 6e3a 0d0a 2020  save_button:..  
-0000f030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f040: 2020 2020 2020 2020 2020 2020 2020 696d                im
-0000f050: 6775 692e 706f 705f 7374 796c 655f 636f  gui.pop_style_co
-0000f060: 6c6f 7228 3429 0d0a 2020 2020 2020 2020  lor(4)..        
-0000f070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f080: 2020 2020 696d 6775 692e 7361 6d65 5f6c      imgui.same_l
-0000f090: 696e 6528 7370 6163 696e 673d 3829 0d0a  ine(spacing=8)..
-0000f0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f0b0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-0000f0c0: 6d67 7569 2e62 7574 746f 6e28 2274 7261  mgui.button("tra
-0000f0d0: 696e 222c 2028 6377 202d 2031 3629 202f  in", (cw - 16) /
-0000f0e0: 2033 2c20 3230 293a 0d0a 2020 2020 2020   3, 20):..      
-0000f0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f100: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
-0000f110: 2062 6c6f 636b 5f62 7574 746f 6e73 3a0d   block_buttons:.
-0000f120: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000f130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f140: 2020 2020 206d 2e74 7261 696e 2829 0d0a       m.train()..
-0000f150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f160: 2020 2020 2020 2020 2020 2020 6966 2062              if b
-0000f170: 6c6f 636b 5f62 7574 746f 6e73 3a0d 0a20  lock_buttons:.. 
+0000eed0: 2020 2020 2020 2020 696d 6775 692e 7075          imgui.pu
+0000eee0: 7368 5f73 7479 6c65 5f63 6f6c 6f72 2869  sh_style_color(i
+0000eef0: 6d67 7569 2e43 4f4c 4f52 5f46 5241 4d45  mgui.COLOR_FRAME
+0000ef00: 5f42 4143 4b47 524f 554e 445f 4143 5449  _BACKGROUND_ACTI
+0000ef10: 5645 2c20 2a63 6667 2e43 4f4c 4f55 525f  VE, *cfg.COLOUR_
+0000ef20: 4e45 5554 5241 4c5f 4c49 4748 5429 0d0a  NEUTRAL_LIGHT)..
+0000ef30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ef40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ef50: 696d 6775 692e 7075 7368 5f73 7479 6c65  imgui.push_style
+0000ef60: 5f63 6f6c 6f72 2869 6d67 7569 2e43 4f4c  _color(imgui.COL
+0000ef70: 4f52 5f54 4558 542c 202a 6366 672e 434f  OR_TEXT, *cfg.CO
+0000ef80: 4c4f 5552 5f4e 4555 5452 414c 290d 0a20  LOUR_NEUTRAL).. 
+0000ef90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000efa0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+0000efb0: 6c6f 636b 5f62 7574 746f 6e73 203d 2054  lock_buttons = T
+0000efc0: 7275 650d 0a20 2020 2020 2020 2020 2020  rue..           
+0000efd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000efe0: 2069 6620 696d 6775 692e 6275 7474 6f6e   if imgui.button
+0000eff0: 2822 6c6f 6164 222c 2028 6377 202d 2031  ("load", (cw - 1
+0000f000: 3629 202f 2033 2c20 3230 293a 0d0a 2020  6) / 3, 20):..  
+0000f010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f020: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0000f030: 206e 6f74 2062 6c6f 636b 5f62 7574 746f   not block_butto
+0000f040: 6e73 3a0d 0a20 2020 2020 2020 2020 2020  ns:..           
+0000f050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f060: 2020 2020 2020 2020 206d 6f64 656c 5f70           model_p
+0000f070: 6174 6820 3d20 6669 6c65 6469 616c 6f67  ath = filedialog
+0000f080: 2e61 736b 6f70 656e 6669 6c65 6e61 6d65  .askopenfilename
+0000f090: 2866 696c 6574 7970 6573 3d5b 2822 7363  (filetypes=[("sc
+0000f0a0: 4e6f 6465 7320 434e 4e22 2c20 6622 7b63  Nodes CNN", f"{c
+0000f0b0: 6667 2e66 696c 6574 7970 655f 7365 6d6f  fg.filetype_semo
+0000f0c0: 6465 6c7d 2229 5d29 0d0a 2020 2020 2020  del}")])..      
+0000f0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f0e0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0000f0f0: 206d 6f64 656c 5f70 6174 6820 213d 2022   model_path != "
+0000f100: 223a 0d0a 2020 2020 2020 2020 2020 2020  ":..            
+0000f110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f120: 2020 2020 2020 2020 2020 2020 6d2e 6c6f              m.lo
+0000f130: 6164 286d 6f64 656c 5f70 6174 6829 0d0a  ad(model_path)..
+0000f140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f150: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
+0000f160: 692e 7361 6d65 5f6c 696e 6528 7370 6163  i.same_line(spac
+0000f170: 696e 673d 3829 0d0a 2020 2020 2020 2020  ing=8)..        
 0000f180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f190: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0000f1a0: 6d67 7569 2e70 6f70 5f73 7479 6c65 5f63  mgui.pop_style_c
-0000f1b0: 6f6c 6f72 2834 290d 0a0d 0a20 2020 2020  olor(4)....     
-0000f1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f1d0: 2020 2020 2020 2069 6d67 7569 2e70 6f70         imgui.pop
-0000f1e0: 5f73 7479 6c65 5f76 6172 2835 290d 0a20  _style_var(5).. 
+0000f190: 2020 2020 626c 6f63 6b5f 7361 7665 5f62      block_save_b
+0000f1a0: 7574 746f 6e20 3d20 4661 6c73 650d 0a20  utton = False.. 
+0000f1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f1c0: 2020 2020 2020 2020 2020 2069 6620 6d2e             if m.
+0000f1d0: 6d6f 6465 6c20 6973 204e 6f6e 653a 0d0a  model is None:..
+0000f1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0000f1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f200: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
-0000f210: 2e65 6e64 5f74 6162 5f69 7465 6d28 290d  .end_tab_item().
-0000f220: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
-0000f230: 2020 2020 2020 2020 2020 2069 6620 696d             if im
-0000f240: 6775 692e 6265 6769 6e5f 7461 625f 6974  gui.begin_tab_it
-0000f250: 656d 2822 2050 7265 6469 6374 696f 6e20  em(" Prediction 
-0000f260: 2229 5b30 5d3a 0d0a 2020 2020 2020 2020  ")[0]:..        
-0000f270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f280: 2020 2020 6d2e 6163 7469 7665 5f74 6162      m.active_tab
-0000f290: 203d 2031 0d0a 2020 2020 2020 2020 2020   = 1..          
-0000f2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f2b0: 2020 2320 4368 6563 6b62 6f78 6573 2061    # Checkboxes a
-0000f2c0: 6e64 2073 6c69 6465 7273 0d0a 2020 2020  nd sliders..    
+0000f200: 696d 6775 692e 7075 7368 5f73 7479 6c65  imgui.push_style
+0000f210: 5f63 6f6c 6f72 2869 6d67 7569 2e43 4f4c  _color(imgui.COL
+0000f220: 4f52 5f46 5241 4d45 5f42 4143 4b47 524f  OR_FRAME_BACKGRO
+0000f230: 554e 442c 202a 6366 672e 434f 4c4f 5552  UND, *cfg.COLOUR
+0000f240: 5f4e 4555 5452 414c 5f4c 4947 4854 290d  _NEUTRAL_LIGHT).
+0000f250: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000f260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f270: 2069 6d67 7569 2e70 7573 685f 7374 796c   imgui.push_styl
+0000f280: 655f 636f 6c6f 7228 696d 6775 692e 434f  e_color(imgui.CO
+0000f290: 4c4f 525f 4652 414d 455f 4241 434b 4752  LOR_FRAME_BACKGR
+0000f2a0: 4f55 4e44 5f48 4f56 4552 4544 2c20 2a63  OUND_HOVERED, *c
+0000f2b0: 6667 2e43 4f4c 4f55 525f 4e45 5554 5241  fg.COLOUR_NEUTRA
+0000f2c0: 4c5f 4c49 4748 5429 0d0a 2020 2020 2020  L_LIGHT)..      
 0000f2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f2e0: 2020 2020 2020 2020 696d 6775 692e 7075          imgui.pu
-0000f2f0: 7368 5f73 7479 6c65 5f76 6172 2869 6d67  sh_style_var(img
-0000f300: 7569 2e53 5459 4c45 5f46 5241 4d45 5f52  ui.STYLE_FRAME_R
-0000f310: 4f55 4e44 494e 472c 2031 3029 0d0a 2020  OUNDING, 10)..  
-0000f320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f330: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
-0000f340: 7075 7368 5f73 7479 6c65 5f76 6172 2869  push_style_var(i
-0000f350: 6d67 7569 2e53 5459 4c45 5f47 5241 425f  mgui.STYLE_GRAB_
-0000f360: 524f 554e 4449 4e47 2c20 3230 290d 0a20  ROUNDING, 20).. 
-0000f370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f380: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
-0000f390: 2e70 7573 685f 7374 796c 655f 7661 7228  .push_style_var(
-0000f3a0: 696d 6775 692e 5354 594c 455f 4752 4142  imgui.STYLE_GRAB
-0000f3b0: 5f4d 494e 5f53 495a 452c 2039 290d 0a20  _MIN_SIZE, 9).. 
-0000f3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f3d0: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
-0000f3e0: 2e70 7573 685f 7374 796c 655f 7661 7228  .push_style_var(
-0000f3f0: 696d 6775 692e 5354 594c 455f 4652 414d  imgui.STYLE_FRAM
-0000f400: 455f 424f 5244 4552 5349 5a45 2c20 3129  E_BORDERSIZE, 1)
-0000f410: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000f420: 2020 2020 2020 2020 2020 2020 2020 696d                im
-0000f430: 6775 692e 7075 7368 5f73 7479 6c65 5f76  gui.push_style_v
-0000f440: 6172 2869 6d67 7569 2e53 5459 4c45 5f46  ar(imgui.STYLE_F
-0000f450: 5241 4d45 5f50 4144 4449 4e47 2c20 2830  RAME_PADDING, (0
-0000f460: 2c20 3029 290d 0a20 2020 2020 2020 2020  , 0))..         
-0000f470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f480: 2020 2069 6d67 7569 2e70 7573 685f 7374     imgui.push_st
-0000f490: 796c 655f 636f 6c6f 7228 696d 6775 692e  yle_color(imgui.
-0000f4a0: 434f 4c4f 525f 4348 4543 4b5f 4d41 524b  COLOR_CHECK_MARK
-0000f4b0: 2c20 2a63 6667 2e43 4f4c 4f55 525f 5445  , *cfg.COLOUR_TE
-0000f4c0: 5854 290d 0a0d 0a20 2020 2020 2020 2020  XT)....         
-0000f4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f4e0: 2020 2069 6d67 7569 2e70 7573 685f 6974     imgui.push_it
-0000f4f0: 656d 5f77 6964 7468 2869 6d67 7569 2e67  em_width(imgui.g
-0000f500: 6574 5f63 6f6e 7465 6e74 5f72 6567 696f  et_content_regio
-0000f510: 6e5f 6176 6169 6c61 626c 655f 7769 6474  n_available_widt
-0000f520: 6828 2929 0d0a 2020 2020 2020 2020 2020  h())..          
-0000f530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f540: 2020 5f2c 206d 2e61 6c70 6861 203d 2069    _, m.alpha = i
-0000f550: 6d67 7569 2e73 6c69 6465 725f 666c 6f61  mgui.slider_floa
-0000f560: 7428 2223 2361 6c70 6861 222c 206d 2e61  t("##alpha", m.a
-0000f570: 6c70 6861 2c20 302e 302c 2031 2e30 2c20  lpha, 0.0, 1.0, 
-0000f580: 666f 726d 6174 3d66 227b 6d2e 616c 7068  format=f"{m.alph
-0000f590: 613a 2e32 667d 2061 6c70 6861 2229 0d0a  a:.2f} alpha")..
-0000f5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f5b0: 2020 2020 2020 2020 2020 2020 5f2c 206d              _, m
-0000f5c0: 2e6f 7665 726c 6170 203d 2069 6d67 7569  .overlap = imgui
-0000f5d0: 2e73 6c69 6465 725f 666c 6f61 7428 2223  .slider_float("#
-0000f5e0: 236f 7665 726c 6170 222c 206d 2e6f 7665  #overlap", m.ove
-0000f5f0: 726c 6170 2c20 302e 302c 2030 2e36 372c  rlap, 0.0, 0.67,
-0000f600: 2066 6f72 6d61 743d 6622 7b6d 2e6f 7665   format=f"{m.ove
-0000f610: 726c 6170 3a2e 3266 7d20 6f76 6572 6c61  rlap:.2f} overla
-0000f620: 7022 290d 0a20 2020 2020 2020 2020 2020  p")..           
-0000f630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f640: 206d 2e6f 7665 726c 6170 203d 206d 6178   m.overlap = max
-0000f650: 2830 2e30 2c20 6d2e 6f76 6572 6c61 7029  (0.0, m.overlap)
-0000f660: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000f670: 2020 2020 2020 2020 2020 2020 2020 5f2c                _,
-0000f680: 206d 2e74 6872 6573 686f 6c64 203d 2069   m.threshold = i
-0000f690: 6d67 7569 2e73 6c69 6465 725f 666c 6f61  mgui.slider_floa
-0000f6a0: 7428 2223 2374 6865 7273 686f 6c64 222c  t("##thershold",
-0000f6b0: 206d 2e74 6872 6573 686f 6c64 2c20 302e   m.threshold, 0.
-0000f6c0: 302c 2031 2e30 2c20 666f 726d 6174 3d66  0, 1.0, format=f
-0000f6d0: 227b 6d2e 7468 7265 7368 6f6c 643a 2e32  "{m.threshold:.2
-0000f6e0: 667d 2074 6872 6573 686f 6c64 2229 0d0a  f} threshold")..
-0000f6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f700: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
-0000f710: 692e 706f 705f 6974 656d 5f77 6964 7468  i.pop_item_width
-0000f720: 2829 0d0a 0d0a 2020 2020 2020 2020 2020  ()....          
-0000f730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f740: 2020 5f2c 206d 2e61 6374 6976 6520 3d20    _, m.active = 
-0000f750: 696d 6775 692e 6368 6563 6b62 6f78 2822  imgui.checkbox("
-0000f760: 6163 7469 7665 2020 2022 2c20 6d2e 6163  active   ", m.ac
-0000f770: 7469 7665 290d 0a20 2020 2020 2020 2020  tive)..         
+0000f2e0: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
+0000f2f0: 7075 7368 5f73 7479 6c65 5f63 6f6c 6f72  push_style_color
+0000f300: 2869 6d67 7569 2e43 4f4c 4f52 5f46 5241  (imgui.COLOR_FRA
+0000f310: 4d45 5f42 4143 4b47 524f 554e 445f 4143  ME_BACKGROUND_AC
+0000f320: 5449 5645 2c20 2a63 6667 2e43 4f4c 4f55  TIVE, *cfg.COLOU
+0000f330: 525f 4e45 5554 5241 4c5f 4c49 4748 5429  R_NEUTRAL_LIGHT)
+0000f340: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000f350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f360: 2020 696d 6775 692e 7075 7368 5f73 7479    imgui.push_sty
+0000f370: 6c65 5f63 6f6c 6f72 2869 6d67 7569 2e43  le_color(imgui.C
+0000f380: 4f4c 4f52 5f54 4558 542c 202a 6366 672e  OLOR_TEXT, *cfg.
+0000f390: 434f 4c4f 5552 5f4e 4555 5452 414c 290d  COLOUR_NEUTRAL).
+0000f3a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000f3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f3c0: 2062 6c6f 636b 5f73 6176 655f 6275 7474   block_save_butt
+0000f3d0: 6f6e 203d 2054 7275 650d 0a20 2020 2020  on = True..     
+0000f3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f3f0: 2020 2020 2020 2069 6620 696d 6775 692e         if imgui.
+0000f400: 6275 7474 6f6e 2822 7361 7665 222c 2028  button("save", (
+0000f410: 6377 202d 2031 3629 202f 2033 2c20 3230  cw - 16) / 3, 20
+0000f420: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+0000f430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f440: 2020 2020 6966 206e 6f74 2062 6c6f 636b      if not block
+0000f450: 5f62 7574 746f 6e73 2061 6e64 206e 6f74  _buttons and not
+0000f460: 2062 6c6f 636b 5f73 6176 655f 6275 7474   block_save_butt
+0000f470: 6f6e 3a0d 0a20 2020 2020 2020 2020 2020  on:..           
+0000f480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f490: 2020 2020 2020 2020 2070 726f 706f 7365           propose
+0000f4a0: 645f 6669 6c65 6e61 6d65 203d 2066 227b  d_filename = f"{
+0000f4b0: 6d2e 6170 6978 3a2e 3266 7d5f 7b6d 2e62  m.apix:.2f}_{m.b
+0000f4c0: 6f78 5f73 697a 657d 5f7b 6d2e 6c6f 7373  ox_size}_{m.loss
+0000f4d0: 3a2e 3466 7d5f 7b6d 2e74 6974 6c65 7d22  :.4f}_{m.title}"
+0000f4e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000f4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f500: 2020 2020 2020 6d6f 6465 6c5f 7061 7468        model_path
+0000f510: 203d 2066 696c 6564 6961 6c6f 672e 6173   = filedialog.as
+0000f520: 6b73 6176 6561 7366 696c 656e 616d 6528  ksaveasfilename(
+0000f530: 6669 6c65 7479 7065 733d 5b28 2273 634e  filetypes=[("scN
+0000f540: 6f64 6573 206d 6f64 656c 222c 2066 227b  odes model", f"{
+0000f550: 6366 672e 6669 6c65 7479 7065 5f73 656d  cfg.filetype_sem
+0000f560: 6f64 656c 7d22 295d 2c20 696e 6974 6961  odel}")], initia
+0000f570: 6c66 696c 653d 7072 6f70 6f73 6564 5f66  lfile=proposed_f
+0000f580: 696c 656e 616d 6529 0d0a 2020 2020 2020  ilename)..      
+0000f590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f5a0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0000f5b0: 206d 6f64 656c 5f70 6174 6820 213d 2022   model_path != "
+0000f5c0: 223a 0d0a 2020 2020 2020 2020 2020 2020  ":..            
+0000f5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f5e0: 2020 2020 2020 2020 2020 2020 6966 206d              if m
+0000f5f0: 6f64 656c 5f70 6174 685b 2d6c 656e 2863  odel_path[-len(c
+0000f600: 6667 2e66 696c 6574 7970 655f 7365 6d6f  fg.filetype_semo
+0000f610: 6465 6c29 3a5d 2021 3d20 6366 672e 6669  del):] != cfg.fi
+0000f620: 6c65 7479 7065 5f73 656d 6f64 656c 3a0d  letype_semodel:.
+0000f630: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000f640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f650: 2020 2020 2020 2020 2020 2020 206d 6f64               mod
+0000f660: 656c 5f70 6174 6820 2b3d 2063 6667 2e66  el_path += cfg.f
+0000f670: 696c 6574 7970 655f 7365 6d6f 6465 6c0d  iletype_semodel.
+0000f680: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000f690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f6a0: 2020 2020 2020 2020 206d 2e73 6176 6528           m.save(
+0000f6b0: 6d6f 6465 6c5f 7061 7468 2c20 6366 672e  model_path, cfg.
+0000f6c0: 7365 5f61 6374 6976 655f 6672 616d 652e  se_active_frame.
+0000f6d0: 6461 7461 290d 0a20 2020 2020 2020 2020  data)..         
+0000f6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f6f0: 2020 2069 6620 626c 6f63 6b5f 7361 7665     if block_save
+0000f700: 5f62 7574 746f 6e3a 0d0a 2020 2020 2020  _button:..      
+0000f710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f720: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
+0000f730: 706f 705f 7374 796c 655f 636f 6c6f 7228  pop_style_color(
+0000f740: 3429 0d0a 2020 2020 2020 2020 2020 2020  4)..            
+0000f750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f760: 696d 6775 692e 7361 6d65 5f6c 696e 6528  imgui.same_line(
+0000f770: 7370 6163 696e 673d 3829 0d0a 2020 2020  spacing=8)..    
 0000f780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f790: 2020 2069 6620 5f20 616e 6420 6d2e 6163     if _ and m.ac
-0000f7a0: 7469 7665 3a0d 0a20 2020 2020 2020 2020  tive:..         
-0000f7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f7c0: 2020 2020 2020 2069 6620 6366 672e 7365         if cfg.se
-0000f7d0: 5f61 6374 6976 655f 6672 616d 6520 6973  _active_frame is
-0000f7e0: 206e 6f74 204e 6f6e 653a 0d0a 2020 2020   not None:..    
-0000f7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f790: 2020 2020 2020 2020 6966 2069 6d67 7569          if imgui
+0000f7a0: 2e62 7574 746f 6e28 2274 7261 696e 222c  .button("train",
+0000f7b0: 2028 6377 202d 2031 3629 202f 2033 2c20   (cw - 16) / 3, 
+0000f7c0: 3230 293a 0d0a 2020 2020 2020 2020 2020  20):..          
+0000f7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f7e0: 2020 2020 2020 6966 206e 6f74 2062 6c6f        if not blo
+0000f7f0: 636b 5f62 7574 746f 6e73 3a0d 0a20 2020  ck_buttons:..   
 0000f800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f810: 6366 672e 7365 5f61 6374 6976 655f 6672  cfg.se_active_fr
-0000f820: 616d 652e 736c 6963 655f 6368 616e 6765  ame.slice_change
-0000f830: 6420 3d20 5472 7565 0d0a 2020 2020 2020  d = True..      
-0000f840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f850: 2020 2020 2020 696d 6775 692e 7361 6d65        imgui.same
-0000f860: 5f6c 696e 6528 290d 0a20 2020 2020 2020  _line()..       
-0000f870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f880: 2020 2020 205f 2c20 6d2e 626c 656e 6420       _, m.blend 
-0000f890: 3d20 696d 6775 692e 6368 6563 6b62 6f78  = imgui.checkbox
-0000f8a0: 2822 626c 656e 6420 2020 222c 206d 2e62  ("blend   ", m.b
-0000f8b0: 6c65 6e64 290d 0a20 2020 2020 2020 2020  lend)..         
-0000f8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f8d0: 2020 2069 6d67 7569 2e73 616d 655f 6c69     imgui.same_li
-0000f8e0: 6e65 2829 0d0a 2020 2020 2020 2020 2020  ne()..          
-0000f8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f900: 2020 5f2c 206d 2e73 686f 7720 3d20 696d    _, m.show = im
-0000f910: 6775 692e 6368 6563 6b62 6f78 2822 7368  gui.checkbox("sh
-0000f920: 6f77 2020 2020 2022 2c20 6d2e 7368 6f77  ow     ", m.show
-0000f930: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0000f940: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0000f950: 6d67 7569 2e73 616d 655f 6c69 6e65 2829  mgui.same_line()
-0000f960: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000f970: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0000f980: 2069 6d67 7569 2e62 7574 746f 6e28 2273   imgui.button("s
-0000f990: 6176 6522 2c20 3431 2c20 3134 2920 616e  ave", 41, 14) an
-0000f9a0: 6420 6d2e 6461 7461 2069 7320 6e6f 7420  d m.data is not 
-0000f9b0: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
-0000f9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f9d0: 2020 2020 2020 2070 6174 6820 3d20 6669         path = fi
-0000f9e0: 6c65 6469 616c 6f67 2e61 736b 7361 7665  ledialog.asksave
-0000f9f0: 6173 6669 6c65 6e61 6d65 2866 696c 6574  asfilename(filet
-0000fa00: 7970 6573 3d5b 2822 6d72 6366 696c 6522  ypes=[("mrcfile"
-0000fa10: 2c20 222e 6d72 6322 295d 2c20 696e 6974  , ".mrc")], init
-0000fa20: 6961 6c66 696c 653d 6f73 2e70 6174 682e  ialfile=os.path.
-0000fa30: 6261 7365 6e61 6d65 2863 6667 2e73 655f  basename(cfg.se_
-0000fa40: 6163 7469 7665 5f66 7261 6d65 2e70 6174  active_frame.pat
-0000fa50: 6829 202b 2022 5f22 202b 206d 2e67 6574  h) + "_" + m.get
-0000fa60: 5f6d 6f64 656c 5f74 6974 6c65 2829 202b  _model_title() +
-0000fa70: 2066 225f 736c 6963 655f 7b63 6667 2e73   f"_slice_{cfg.s
-0000fa80: 655f 6163 7469 7665 5f66 7261 6d65 2e63  e_active_frame.c
-0000fa90: 7572 7265 6e74 5f73 6c69 6365 7d22 290d  urrent_slice}").
-0000faa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000fab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fac0: 2069 6620 7061 7468 2021 3d20 2222 3a0d   if path != "":.
-0000fad0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000fae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000faf0: 2020 2020 2069 6620 7061 7468 5b2d 343a       if path[-4:
-0000fb00: 5d20 213d 2022 2e6d 7263 223a 0d0a 2020  ] != ".mrc":..  
-0000fb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fb20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fb30: 2020 2020 2020 7061 7468 202b 3d20 222e        path += ".
-0000fb40: 6d72 6322 0d0a 2020 2020 2020 2020 2020  mrc"..          
-0000fb50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fb60: 2020 2020 2020 2020 2020 7769 7468 206d            with m
-0000fb70: 7263 6669 6c65 2e6e 6577 2870 6174 682c  rcfile.new(path,
-0000fb80: 206f 7665 7277 7269 7465 3d54 7275 6529   overwrite=True)
-0000fb90: 2061 7320 6d72 633a 0d0a 2020 2020 2020   as mrc:..      
-0000fba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fbb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fbc0: 2020 7078 6420 3d20 6e70 2e63 6c69 7028    pxd = np.clip(
-0000fbd0: 6d2e 6461 7461 202a 2032 3535 2c20 302c  m.data * 255, 0,
-0000fbe0: 2032 3535 292e 6173 7479 7065 286e 702e   255).astype(np.
-0000fbf0: 7569 6e74 3829 2e73 7175 6565 7a65 2829  uint8).squeeze()
+0000f810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f820: 206d 2e74 7261 696e 2829 0d0a 2020 2020   m.train()..    
+0000f830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f840: 2020 2020 2020 2020 6966 2062 6c6f 636b          if block
+0000f850: 5f62 7574 746f 6e73 3a0d 0a20 2020 2020  _buttons:..     
+0000f860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f870: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
+0000f880: 2e70 6f70 5f73 7479 6c65 5f63 6f6c 6f72  .pop_style_color
+0000f890: 2834 290d 0a0d 0a20 2020 2020 2020 2020  (4)....         
+0000f8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f8b0: 2020 2069 6d67 7569 2e70 6f70 5f73 7479     imgui.pop_sty
+0000f8c0: 6c65 5f76 6172 2835 290d 0a20 2020 2020  le_var(5)..     
+0000f8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f8e0: 2020 2020 2020 2069 6d67 7569 2e65 6e64         imgui.end
+0000f8f0: 5f74 6162 5f69 7465 6d28 290d 0a0d 0a20  _tab_item().... 
+0000f900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f910: 2020 2020 2020 2069 6620 696d 6775 692e         if imgui.
+0000f920: 6265 6769 6e5f 7461 625f 6974 656d 2822  begin_tab_item("
+0000f930: 2050 7265 6469 6374 696f 6e20 2229 5b30   Prediction ")[0
+0000f940: 5d3a 0d0a 2020 2020 2020 2020 2020 2020  ]:..            
+0000f950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f960: 6d2e 6163 7469 7665 5f74 6162 203d 2031  m.active_tab = 1
+0000f970: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000f980: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+0000f990: 4368 6563 6b62 6f78 6573 2061 6e64 2073  Checkboxes and s
+0000f9a0: 6c69 6465 7273 0d0a 2020 2020 2020 2020  liders..        
+0000f9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f9c0: 2020 2020 696d 6775 692e 7075 7368 5f73      imgui.push_s
+0000f9d0: 7479 6c65 5f76 6172 2869 6d67 7569 2e53  tyle_var(imgui.S
+0000f9e0: 5459 4c45 5f46 5241 4d45 5f52 4f55 4e44  TYLE_FRAME_ROUND
+0000f9f0: 494e 472c 2031 3029 0d0a 2020 2020 2020  ING, 10)..      
+0000fa00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fa10: 2020 2020 2020 696d 6775 692e 7075 7368        imgui.push
+0000fa20: 5f73 7479 6c65 5f76 6172 2869 6d67 7569  _style_var(imgui
+0000fa30: 2e53 5459 4c45 5f47 5241 425f 524f 554e  .STYLE_GRAB_ROUN
+0000fa40: 4449 4e47 2c20 3230 290d 0a20 2020 2020  DING, 20)..     
+0000fa50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fa60: 2020 2020 2020 2069 6d67 7569 2e70 7573         imgui.pus
+0000fa70: 685f 7374 796c 655f 7661 7228 696d 6775  h_style_var(imgu
+0000fa80: 692e 5354 594c 455f 4752 4142 5f4d 494e  i.STYLE_GRAB_MIN
+0000fa90: 5f53 495a 452c 2039 290d 0a20 2020 2020  _SIZE, 9)..     
+0000faa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fab0: 2020 2020 2020 2069 6d67 7569 2e70 7573         imgui.pus
+0000fac0: 685f 7374 796c 655f 7661 7228 696d 6775  h_style_var(imgu
+0000fad0: 692e 5354 594c 455f 4652 414d 455f 424f  i.STYLE_FRAME_BO
+0000fae0: 5244 4552 5349 5a45 2c20 3129 0d0a 2020  RDERSIZE, 1)..  
+0000faf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fb00: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
+0000fb10: 7075 7368 5f73 7479 6c65 5f76 6172 2869  push_style_var(i
+0000fb20: 6d67 7569 2e53 5459 4c45 5f46 5241 4d45  mgui.STYLE_FRAME
+0000fb30: 5f50 4144 4449 4e47 2c20 2830 2c20 3029  _PADDING, (0, 0)
+0000fb40: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0000fb50: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0000fb60: 6d67 7569 2e70 7573 685f 7374 796c 655f  mgui.push_style_
+0000fb70: 636f 6c6f 7228 696d 6775 692e 434f 4c4f  color(imgui.COLO
+0000fb80: 525f 4348 4543 4b5f 4d41 524b 2c20 2a63  R_CHECK_MARK, *c
+0000fb90: 6667 2e43 4f4c 4f55 525f 5445 5854 290d  fg.COLOUR_TEXT).
+0000fba0: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+0000fbb0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0000fbc0: 6d67 7569 2e70 7573 685f 6974 656d 5f77  mgui.push_item_w
+0000fbd0: 6964 7468 2869 6d67 7569 2e67 6574 5f63  idth(imgui.get_c
+0000fbe0: 6f6e 7465 6e74 5f72 6567 696f 6e5f 6176  ontent_region_av
+0000fbf0: 6169 6c61 626c 655f 7769 6474 6828 2929  ailable_width())
 0000fc00: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000fc10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fc20: 2020 2020 2020 2020 2020 6d72 632e 7365            mrc.se
-0000fc30: 745f 6461 7461 2870 7864 290d 0a20 2020  t_data(pxd)..   
-0000fc40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fc50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fc60: 2020 2020 206d 7263 2e76 6f78 656c 5f73       mrc.voxel_s
-0000fc70: 697a 6520 3d20 6366 672e 7365 5f61 6374  ize = cfg.se_act
-0000fc80: 6976 655f 6672 616d 652e 7069 7865 6c5f  ive_frame.pixel_
-0000fc90: 7369 7a65 202a 2031 302e 300d 0a20 2020  size * 10.0..   
-0000fca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fcb0: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
-0000fcc0: 6f70 5f73 7479 6c65 5f76 6172 2835 290d  op_style_var(5).
-0000fcd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000fce0: 2020 2020 2020 2020 2020 2020 2069 6d67               img
-0000fcf0: 7569 2e70 6f70 5f73 7479 6c65 5f63 6f6c  ui.pop_style_col
-0000fd00: 6f72 2831 290d 0a20 2020 2020 2020 2020  or(1)..         
-0000fd10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fd20: 2020 2069 6d67 7569 2e65 6e64 5f74 6162     imgui.end_tab
-0000fd30: 5f69 7465 6d28 290d 0a0d 0a20 2020 2020  _item()....     
+0000fc10: 2020 2020 2020 2020 2020 2020 2020 5f2c                _,
+0000fc20: 206d 2e61 6c70 6861 203d 2069 6d67 7569   m.alpha = imgui
+0000fc30: 2e73 6c69 6465 725f 666c 6f61 7428 2223  .slider_float("#
+0000fc40: 2361 6c70 6861 222c 206d 2e61 6c70 6861  #alpha", m.alpha
+0000fc50: 2c20 302e 302c 2031 2e30 2c20 666f 726d  , 0.0, 1.0, form
+0000fc60: 6174 3d66 227b 6d2e 616c 7068 613a 2e32  at=f"{m.alpha:.2
+0000fc70: 667d 2061 6c70 6861 2229 0d0a 2020 2020  f} alpha")..    
+0000fc80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fc90: 2020 2020 2020 2020 5f2c 206d 2e6f 7665          _, m.ove
+0000fca0: 726c 6170 203d 2069 6d67 7569 2e73 6c69  rlap = imgui.sli
+0000fcb0: 6465 725f 666c 6f61 7428 2223 236f 7665  der_float("##ove
+0000fcc0: 726c 6170 222c 206d 2e6f 7665 726c 6170  rlap", m.overlap
+0000fcd0: 2c20 302e 302c 2030 2e36 372c 2066 6f72  , 0.0, 0.67, for
+0000fce0: 6d61 743d 6622 7b6d 2e6f 7665 726c 6170  mat=f"{m.overlap
+0000fcf0: 3a2e 3266 7d20 6f76 6572 6c61 7022 290d  :.2f} overlap").
+0000fd00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000fd10: 2020 2020 2020 2020 2020 2020 206d 2e6f               m.o
+0000fd20: 7665 726c 6170 203d 206d 6178 2830 2e30  verlap = max(0.0
+0000fd30: 2c20 6d2e 6f76 6572 6c61 7029 0d0a 2020  , m.overlap)..  
 0000fd40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fd50: 2020 2069 6620 696d 6775 692e 6265 6769     if imgui.begi
-0000fd60: 6e5f 7461 625f 6974 656d 2822 2049 6e74  n_tab_item(" Int
-0000fd70: 6572 6163 7469 6f6e 7320 2229 5b30 5d3a  eractions ")[0]:
-0000fd80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000fd90: 2020 2020 2020 2020 2020 2020 2020 6d2e                m.
-0000fda0: 6163 7469 7665 5f74 6162 203d 2032 0d0a  active_tab = 2..
-0000fdb0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000fdc0: 2020 2020 2020 2020 2020 2020 2020 696d                im
-0000fdd0: 6775 692e 7075 7368 5f73 7479 6c65 5f76  gui.push_style_v
-0000fde0: 6172 2869 6d67 7569 2e53 5459 4c45 5f46  ar(imgui.STYLE_F
-0000fdf0: 5241 4d45 5f52 4f55 4e44 494e 472c 2031  RAME_ROUNDING, 1
-0000fe00: 3029 0d0a 2020 2020 2020 2020 2020 2020  0)..            
-0000fe10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fe20: 696d 6775 692e 7075 7368 5f73 7479 6c65  imgui.push_style
-0000fe30: 5f76 6172 2869 6d67 7569 2e53 5459 4c45  _var(imgui.STYLE
-0000fe40: 5f47 5241 425f 524f 554e 4449 4e47 2c20  _GRAB_ROUNDING, 
-0000fe50: 3230 290d 0a20 2020 2020 2020 2020 2020  20)..           
-0000fe60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fe70: 2069 6d67 7569 2e70 7573 685f 7374 796c   imgui.push_styl
-0000fe80: 655f 7661 7228 696d 6775 692e 5354 594c  e_var(imgui.STYL
-0000fe90: 455f 4752 4142 5f4d 494e 5f53 495a 452c  E_GRAB_MIN_SIZE,
-0000fea0: 2039 290d 0a20 2020 2020 2020 2020 2020   9)..           
-0000feb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fec0: 2069 6d67 7569 2e70 7573 685f 7374 796c   imgui.push_styl
-0000fed0: 655f 7661 7228 696d 6775 692e 5354 594c  e_var(imgui.STYL
-0000fee0: 455f 4652 414d 455f 424f 5244 4552 5349  E_FRAME_BORDERSI
-0000fef0: 5a45 2c20 3129 0d0a 2020 2020 2020 2020  ZE, 1)..        
-0000ff00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ff10: 2020 2020 696d 6775 692e 7075 7368 5f73      imgui.push_s
-0000ff20: 7479 6c65 5f76 6172 2869 6d67 7569 2e53  tyle_var(imgui.S
-0000ff30: 5459 4c45 5f46 5241 4d45 5f50 4144 4449  TYLE_FRAME_PADDI
-0000ff40: 4e47 2c20 2830 2c20 3029 290d 0a20 2020  NG, (0, 0))..   
+0000fd50: 2020 2020 2020 2020 2020 5f2c 206d 2e74            _, m.t
+0000fd60: 6872 6573 686f 6c64 203d 2069 6d67 7569  hreshold = imgui
+0000fd70: 2e73 6c69 6465 725f 666c 6f61 7428 2223  .slider_float("#
+0000fd80: 2374 6865 7273 686f 6c64 222c 206d 2e74  #thershold", m.t
+0000fd90: 6872 6573 686f 6c64 2c20 302e 302c 2031  hreshold, 0.0, 1
+0000fda0: 2e30 2c20 666f 726d 6174 3d66 227b 6d2e  .0, format=f"{m.
+0000fdb0: 7468 7265 7368 6f6c 643a 2e32 667d 2074  threshold:.2f} t
+0000fdc0: 6872 6573 686f 6c64 2229 0d0a 2020 2020  hreshold")..    
+0000fdd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fde0: 2020 2020 2020 2020 696d 6775 692e 706f          imgui.po
+0000fdf0: 705f 6974 656d 5f77 6964 7468 2829 0d0a  p_item_width()..
+0000fe00: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000fe10: 2020 2020 2020 2020 2020 2020 2020 5f2c                _,
+0000fe20: 206d 2e61 6374 6976 6520 3d20 696d 6775   m.active = imgu
+0000fe30: 692e 6368 6563 6b62 6f78 2822 6163 7469  i.checkbox("acti
+0000fe40: 7665 2020 2022 2c20 6d2e 6163 7469 7665  ve   ", m.active
+0000fe50: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0000fe60: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0000fe70: 6620 5f20 616e 6420 6d2e 6163 7469 7665  f _ and m.active
+0000fe80: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0000fe90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fea0: 2020 2069 6620 6366 672e 7365 5f61 6374     if cfg.se_act
+0000feb0: 6976 655f 6672 616d 6520 6973 206e 6f74  ive_frame is not
+0000fec0: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
+0000fed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fee0: 2020 2020 2020 2020 2020 2020 6366 672e              cfg.
+0000fef0: 7365 5f61 6374 6976 655f 6672 616d 652e  se_active_frame.
+0000ff00: 736c 6963 655f 6368 616e 6765 6420 3d20  slice_changed = 
+0000ff10: 5472 7565 0d0a 2020 2020 2020 2020 2020  True..          
+0000ff20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ff30: 2020 696d 6775 692e 7361 6d65 5f6c 696e    imgui.same_lin
+0000ff40: 6528 290d 0a20 2020 2020 2020 2020 2020  e()..           
 0000ff50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ff60: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
-0000ff70: 7573 685f 7374 796c 655f 636f 6c6f 7228  ush_style_color(
-0000ff80: 696d 6775 692e 434f 4c4f 525f 4348 4543  imgui.COLOR_CHEC
-0000ff90: 4b5f 4d41 524b 2c20 2a63 6667 2e43 4f4c  K_MARK, *cfg.COL
-0000ffa0: 4f55 525f 5445 5854 290d 0a0d 0a20 2020  OUR_TEXT)....   
-0000ffb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ffc0: 2020 2020 2020 2020 2069 6d67 7569 2e74           imgui.t
-0000ffd0: 6578 7428 224d 6f64 656c 2063 6f6d 7065  ext("Model compe
-0000ffe0: 7469 7469 6f6e 3a20 2022 290d 0a20 2020  tition:  ")..   
-0000fff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010000: 2020 2020 2020 2020 2069 6d67 7569 2e73           imgui.s
-00010010: 616d 655f 6c69 6e65 2829 0d0a 2020 2020  ame_line()..    
-00010020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010030: 2020 2020 2020 2020 5f2c 206d 2e65 6d69          _, m.emi
-00010040: 7420 3d20 696d 6775 692e 6368 6563 6b62  t = imgui.checkb
-00010050: 6f78 2822 2065 6d69 7420 222c 206d 2e65  ox(" emit ", m.e
-00010060: 6d69 7429 0d0a 2020 2020 2020 2020 2020  mit)..          
-00010070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010080: 2020 7365 6c66 2e74 6f6f 6c74 6970 2822    self.tooltip("
-00010090: 5768 656e 2063 6865 636b 6564 2c20 7468  When checked, th
-000100a0: 6973 206d 6f64 656c 2065 6d69 7473 2070  is model emits p
-000100b0: 7265 6469 6374 696f 6e20 7661 6c75 6573  rediction values
-000100c0: 2c20 6d65 616e 696e 6720 6974 2077 696c  , meaning it wil
-000100d0: 6c20 6166 6665 6374 5c6e 220d 0a20 2020  l affect\n"..   
-000100e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000100f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010100: 2020 2020 2020 2261 6273 6f72 6269 6e67        "absorbing
-00010110: 206d 6f64 656c 7320 6279 206e 756c 6c69   models by nulli
-00010120: 6679 696e 6720 7468 6569 7220 7072 6564  fying their pred
-00010130: 6963 7469 6f6e 2077 6865 7265 7665 7220  iction wherever 
-00010140: 7468 6520 656d 6974 7469 6e67 2020 205c  the emitting   \
-00010150: 6e22 0d0a 2020 2020 2020 2020 2020 2020  n"..            
-00010160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010170: 2020 2020 2020 2020 2020 2020 2022 6d6f               "mo
-00010180: 6465 6c27 7320 7072 6564 6963 7469 6f6e  del's prediction
-00010190: 2076 616c 7565 2069 7320 6869 6768 6572   value is higher
-000101a0: 2074 6861 6e20 7468 6174 206f 6620 616e   than that of an
-000101b0: 2061 6273 6f72 6265 722e 2229 0d0a 2020   absorber.")..  
+0000ff60: 205f 2c20 6d2e 626c 656e 6420 3d20 696d   _, m.blend = im
+0000ff70: 6775 692e 6368 6563 6b62 6f78 2822 626c  gui.checkbox("bl
+0000ff80: 656e 6420 2020 222c 206d 2e62 6c65 6e64  end   ", m.blend
+0000ff90: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0000ffa0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0000ffb0: 6d67 7569 2e73 616d 655f 6c69 6e65 2829  mgui.same_line()
+0000ffc0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000ffd0: 2020 2020 2020 2020 2020 2020 2020 5f2c                _,
+0000ffe0: 206d 2e73 686f 7720 3d20 696d 6775 692e   m.show = imgui.
+0000fff0: 6368 6563 6b62 6f78 2822 7368 6f77 2020  checkbox("show  
+00010000: 2020 2022 2c20 6d2e 7368 6f77 290d 0a20     ", m.show).. 
+00010010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010020: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
+00010030: 2e73 616d 655f 6c69 6e65 2829 0d0a 2020  .same_line()..  
+00010040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010050: 2020 2020 2020 2020 2020 6966 2069 6d67            if img
+00010060: 7569 2e62 7574 746f 6e28 2273 6176 6522  ui.button("save"
+00010070: 2c20 3431 2c20 3134 2920 616e 6420 6d2e  , 41, 14) and m.
+00010080: 6461 7461 2069 7320 6e6f 7420 4e6f 6e65  data is not None
+00010090: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000100a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000100b0: 2020 2070 6174 6820 3d20 6669 6c65 6469     path = filedi
+000100c0: 616c 6f67 2e61 736b 7361 7665 6173 6669  alog.asksaveasfi
+000100d0: 6c65 6e61 6d65 2866 696c 6574 7970 6573  lename(filetypes
+000100e0: 3d5b 2822 6d72 6366 696c 6522 2c20 222e  =[("mrcfile", ".
+000100f0: 6d72 6322 295d 2c20 696e 6974 6961 6c66  mrc")], initialf
+00010100: 696c 653d 6f73 2e70 6174 682e 6261 7365  ile=os.path.base
+00010110: 6e61 6d65 2863 6667 2e73 655f 6163 7469  name(cfg.se_acti
+00010120: 7665 5f66 7261 6d65 2e70 6174 6829 202b  ve_frame.path) +
+00010130: 2022 5f22 202b 206d 2e67 6574 5f6d 6f64   "_" + m.get_mod
+00010140: 656c 5f74 6974 6c65 2829 202b 2066 225f  el_title() + f"_
+00010150: 736c 6963 655f 7b63 6667 2e73 655f 6163  slice_{cfg.se_ac
+00010160: 7469 7665 5f66 7261 6d65 2e63 7572 7265  tive_frame.curre
+00010170: 6e74 5f73 6c69 6365 7d22 290d 0a20 2020  nt_slice}")..   
+00010180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010190: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+000101a0: 7061 7468 2021 3d20 2222 3a0d 0a20 2020  path != "":..   
+000101b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000101c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000101d0: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
-000101e0: 7361 6d65 5f6c 696e 6528 290d 0a20 2020  same_line()..   
+000101d0: 2069 6620 7061 7468 5b2d 343a 5d20 213d   if path[-4:] !=
+000101e0: 2022 2e6d 7263 223a 0d0a 2020 2020 2020   ".mrc":..      
 000101f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010200: 2020 2020 2020 2020 205f 2c20 6d2e 6162           _, m.ab
-00010210: 736f 7262 203d 2069 6d67 7569 2e63 6865  sorb = imgui.che
-00010220: 636b 626f 7828 2220 6162 736f 7262 2022  ckbox(" absorb "
-00010230: 2c20 6d2e 6162 736f 7262 290d 0a20 2020  , m.absorb)..   
-00010240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010250: 2020 2020 2020 2020 2073 656c 662e 746f           self.to
-00010260: 6f6c 7469 7028 2257 6865 6e20 6368 6563  oltip("When chec
-00010270: 6b65 642c 2074 6869 7320 6d6f 6465 6c20  ked, this model 
-00010280: 6162 736f 7262 7320 7072 6564 6963 7469  absorbs predicti
-00010290: 6f6e 7320 6279 206f 7468 6572 206d 6f64  ons by other mod
-000102a0: 656c 732c 206d 6561 6e69 6e67 5c6e 220d  els, meaning\n".
-000102b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000102c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000102d0: 2020 2020 2020 2020 2020 2269 7473 206f            "its o
-000102e0: 7574 7075 7420 6973 206e 756c 6c69 6669  utput is nullifi
-000102f0: 6564 2077 6865 7265 7665 7220 7468 6572  ed wherever ther
-00010300: 6520 6973 2061 6e79 2065 6d69 7474 696e  e is any emittin
-00010310: 6720 6d6f 6465 6c20 7468 6174 205c 6e22  g model that \n"
-00010320: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00010200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010210: 2020 7061 7468 202b 3d20 222e 6d72 6322    path += ".mrc"
+00010220: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00010230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010240: 2020 2020 2020 7769 7468 206d 7263 6669        with mrcfi
+00010250: 6c65 2e6e 6577 2870 6174 682c 206f 7665  le.new(path, ove
+00010260: 7277 7269 7465 3d54 7275 6529 2061 7320  rwrite=True) as 
+00010270: 6d72 633a 0d0a 2020 2020 2020 2020 2020  mrc:..          
+00010280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010290: 2020 2020 2020 2020 2020 2020 2020 7078                px
+000102a0: 6420 3d20 6e70 2e63 6c69 7028 6d2e 6461  d = np.clip(m.da
+000102b0: 7461 202a 2032 3535 2c20 302c 2032 3535  ta * 255, 0, 255
+000102c0: 292e 6173 7479 7065 286e 702e 7569 6e74  ).astype(np.uint
+000102d0: 3829 2e73 7175 6565 7a65 2829 0d0a 2020  8).squeeze()..  
+000102e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000102f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010300: 2020 2020 2020 6d72 632e 7365 745f 6461        mrc.set_da
+00010310: 7461 2870 7864 290d 0a20 2020 2020 2020  ta(pxd)..       
+00010320: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00010330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010340: 2020 2020 2020 2020 2020 2022 7072 6564             "pred
-00010350: 6963 7473 2061 2068 6967 6865 7220 7661  icts a higher va
-00010360: 6c75 652e 2229 0d0a 0d0a 2020 2020 2020  lue.")....      
-00010370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010380: 2020 2020 2020 2320 7061 7273 6520 6176        # parse av
-00010390: 6169 6c61 626c 6520 6d6f 6465 6c73 0d0a  ailable models..
-000103a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000103b0: 2020 2020 2020 2020 2020 2020 6176 6169              avai
-000103c0: 6c61 626c 655f 7061 7274 6e65 725f 6d6f  lable_partner_mo
-000103d0: 6465 6c73 203d 206c 6973 7428 290d 0a20  dels = list().. 
-000103e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000103f0: 2020 2020 2020 2020 2020 2061 7661 696c             avail
-00010400: 6162 6c65 5f70 6172 746e 6572 5f6d 6f64  able_partner_mod
-00010410: 656c 5f6e 616d 6573 203d 206c 6973 7428  el_names = list(
-00010420: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00010430: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00010440: 6f72 2070 6172 746e 6572 2069 6e20 6366  or partner in cf
-00010450: 672e 7365 5f6d 6f64 656c 733a 0d0a 2020  g.se_models:..  
+00010340: 206d 7263 2e76 6f78 656c 5f73 697a 6520   mrc.voxel_size 
+00010350: 3d20 6366 672e 7365 5f61 6374 6976 655f  = cfg.se_active_
+00010360: 6672 616d 652e 7069 7865 6c5f 7369 7a65  frame.pixel_size
+00010370: 202a 2031 302e 300d 0a20 2020 2020 2020   * 10.0..       
+00010380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010390: 2020 2020 2069 6d67 7569 2e70 6f70 5f73       imgui.pop_s
+000103a0: 7479 6c65 5f76 6172 2835 290d 0a20 2020  tyle_var(5)..   
+000103b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000103c0: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
+000103d0: 6f70 5f73 7479 6c65 5f63 6f6c 6f72 2831  op_style_color(1
+000103e0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+000103f0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00010400: 6d67 7569 2e65 6e64 5f74 6162 5f69 7465  mgui.end_tab_ite
+00010410: 6d28 290d 0a0d 0a20 2020 2020 2020 2020  m()....         
+00010420: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00010430: 6620 696d 6775 692e 6265 6769 6e5f 7461  f imgui.begin_ta
+00010440: 625f 6974 656d 2822 2049 6e74 6572 6163  b_item(" Interac
+00010450: 7469 6f6e 7320 2229 5b30 5d3a 0d0a 2020  tions ")[0]:..  
 00010460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010470: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00010480: 2070 6172 746e 6572 2021 3d20 6d3a 0d0a   partner != m:..
+00010470: 2020 2020 2020 2020 2020 6d2e 6163 7469            m.acti
+00010480: 7665 5f74 6162 203d 2032 0d0a 0d0a 2020  ve_tab = 2....  
 00010490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000104a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000104b0: 2020 2020 6176 6169 6c61 626c 655f 7061      available_pa
-000104c0: 7274 6e65 725f 6d6f 6465 6c73 2e61 7070  rtner_models.app
-000104d0: 656e 6428 7061 7274 6e65 7229 0d0a 2020  end(partner)..  
+000104a0: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
+000104b0: 7075 7368 5f73 7479 6c65 5f76 6172 2869  push_style_var(i
+000104c0: 6d67 7569 2e53 5459 4c45 5f46 5241 4d45  mgui.STYLE_FRAME
+000104d0: 5f52 4f55 4e44 494e 472c 2031 3029 0d0a  _ROUNDING, 10)..
 000104e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000104f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010500: 2020 6176 6169 6c61 626c 655f 7061 7274    available_part
-00010510: 6e65 725f 6d6f 6465 6c5f 6e61 6d65 732e  ner_model_names.
-00010520: 6170 7065 6e64 2870 6172 746e 6572 2e74  append(partner.t
-00010530: 6974 6c65 290d 0a0d 0a20 2020 2020 2020  itle)....       
-00010540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010550: 2020 2020 2023 2069 6e74 6572 6163 7469       # interacti
-00010560: 6f6e 2047 5549 0d0a 2020 2020 2020 2020  on GUI..        
-00010570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010580: 2020 2020 6377 203d 2069 6d67 7569 2e67      cw = imgui.g
-00010590: 6574 5f63 6f6e 7465 6e74 5f72 6567 696f  et_content_regio
-000105a0: 6e5f 6176 6169 6c61 626c 655f 7769 6474  n_available_widt
-000105b0: 6828 290d 0a20 2020 2020 2020 2020 2020  h()..           
-000105c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000105d0: 2066 6f72 2069 6e74 6572 6163 7469 6f6e   for interaction
-000105e0: 2069 6e20 6d2e 696e 7465 7261 6374 696f   in m.interactio
-000105f0: 6e73 3a0d 0a20 2020 2020 2020 2020 2020  ns:..           
-00010600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010610: 2020 2020 2064 656c 6574 655f 7468 6973       delete_this
-00010620: 5f69 6e74 6572 203d 2046 616c 7365 0d0a  _inter = False..
+000104f0: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
+00010500: 692e 7075 7368 5f73 7479 6c65 5f76 6172  i.push_style_var
+00010510: 2869 6d67 7569 2e53 5459 4c45 5f47 5241  (imgui.STYLE_GRA
+00010520: 425f 524f 554e 4449 4e47 2c20 3230 290d  B_ROUNDING, 20).
+00010530: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010540: 2020 2020 2020 2020 2020 2020 2069 6d67               img
+00010550: 7569 2e70 7573 685f 7374 796c 655f 7661  ui.push_style_va
+00010560: 7228 696d 6775 692e 5354 594c 455f 4752  r(imgui.STYLE_GR
+00010570: 4142 5f4d 494e 5f53 495a 452c 2039 290d  AB_MIN_SIZE, 9).
+00010580: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010590: 2020 2020 2020 2020 2020 2020 2069 6d67               img
+000105a0: 7569 2e70 7573 685f 7374 796c 655f 7661  ui.push_style_va
+000105b0: 7228 696d 6775 692e 5354 594c 455f 4652  r(imgui.STYLE_FR
+000105c0: 414d 455f 424f 5244 4552 5349 5a45 2c20  AME_BORDERSIZE, 
+000105d0: 3129 0d0a 2020 2020 2020 2020 2020 2020  1)..            
+000105e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000105f0: 696d 6775 692e 7075 7368 5f73 7479 6c65  imgui.push_style
+00010600: 5f76 6172 2869 6d67 7569 2e53 5459 4c45  _var(imgui.STYLE
+00010610: 5f46 5241 4d45 5f50 4144 4449 4e47 2c20  _FRAME_PADDING, 
+00010620: 2830 2c20 3029 290d 0a20 2020 2020 2020  (0, 0))..       
 00010630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010650: 6966 2069 6e74 6572 6163 7469 6f6e 2e70  if interaction.p
-00010660: 6172 746e 6572 206e 6f74 2069 6e20 6366  artner not in cf
-00010670: 672e 7365 5f6d 6f64 656c 733a 0d0a 2020  g.se_models:..  
-00010680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010640: 2020 2020 2069 6d67 7569 2e70 7573 685f       imgui.push_
+00010650: 7374 796c 655f 636f 6c6f 7228 696d 6775  style_color(imgu
+00010660: 692e 434f 4c4f 525f 4348 4543 4b5f 4d41  i.COLOR_CHECK_MA
+00010670: 524b 2c20 2a63 6667 2e43 4f4c 4f55 525f  RK, *cfg.COLOUR_
+00010680: 5445 5854 290d 0a0d 0a20 2020 2020 2020  TEXT)....       
 00010690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000106a0: 2020 6d2e 696e 7465 7261 6374 696f 6e73    m.interactions
-000106b0: 2e72 656d 6f76 6528 696e 7465 7261 6374  .remove(interact
-000106c0: 696f 6e29 0d0a 2020 2020 2020 2020 2020  ion)..          
+000106a0: 2020 2020 2069 6d67 7569 2e74 6578 7428       imgui.text(
+000106b0: 224d 6f64 656c 2063 6f6d 7065 7469 7469  "Model competiti
+000106c0: 6f6e 3a20 2022 290d 0a20 2020 2020 2020  on:  ")..       
 000106d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000106e0: 2020 2020 2020 2020 2020 636f 6e74 696e            contin
-000106f0: 7565 0d0a 2020 2020 2020 2020 2020 2020  ue..            
+000106e0: 2020 2020 2069 6d67 7569 2e73 616d 655f       imgui.same_
+000106f0: 6c69 6e65 2829 0d0a 2020 2020 2020 2020  line()..        
 00010700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010710: 2020 2020 6966 2069 6e74 6572 6163 7469      if interacti
-00010720: 6f6e 206e 6f74 2069 6e20 4d6f 6465 6c49  on not in ModelI
-00010730: 6e74 6572 6163 7469 6f6e 2e61 6c6c 3a0d  nteraction.all:.
-00010740: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010760: 2020 2020 206d 2e69 6e74 6572 6163 7469       m.interacti
-00010770: 6f6e 732e 7265 6d6f 7665 2869 6e74 6572  ons.remove(inter
-00010780: 6163 7469 6f6e 290d 0a20 2020 2020 2020  action)..       
-00010790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000107a0: 2020 2020 2020 2020 2020 2020 2063 6f6e               con
-000107b0: 7469 6e75 650d 0a20 2020 2020 2020 2020  tinue..         
+00010710: 2020 2020 5f2c 206d 2e65 6d69 7420 3d20      _, m.emit = 
+00010720: 696d 6775 692e 6368 6563 6b62 6f78 2822  imgui.checkbox("
+00010730: 2065 6d69 7420 222c 206d 2e65 6d69 7429   emit ", m.emit)
+00010740: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00010750: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00010760: 6c66 2e74 6f6f 6c74 6970 2822 5768 656e  lf.tooltip("When
+00010770: 2063 6865 636b 6564 2c20 7468 6973 206d   checked, this m
+00010780: 6f64 656c 2065 6d69 7473 2070 7265 6469  odel emits predi
+00010790: 6374 696f 6e20 7661 6c75 6573 2c20 6d65  ction values, me
+000107a0: 616e 696e 6720 6974 2077 696c 6c20 6166  aning it will af
+000107b0: 6665 6374 5c6e 220d 0a20 2020 2020 2020  fect\n"..       
 000107c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000107d0: 2020 2020 2020 2069 6d67 7569 2e70 7573         imgui.pus
-000107e0: 685f 6964 2866 226d 6f64 656c 696e 7465  h_id(f"modelinte
-000107f0: 7261 6374 696f 6e7b 696e 7465 7261 6374  raction{interact
-00010800: 696f 6e2e 7569 647d 2229 0d0a 0d0a 2020  ion.uid}")....  
-00010810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010820: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00010830: 6d6f 6465 6c20 696e 6465 780d 0a20 2020  model index..   
+000107d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000107e0: 2020 2261 6273 6f72 6269 6e67 206d 6f64    "absorbing mod
+000107f0: 656c 7320 6279 206e 756c 6c69 6679 696e  els by nullifyin
+00010800: 6720 7468 6569 7220 7072 6564 6963 7469  g their predicti
+00010810: 6f6e 2077 6865 7265 7665 7220 7468 6520  on wherever the 
+00010820: 656d 6974 7469 6e67 2020 205c 6e22 0d0a  emitting   \n"..
+00010830: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00010840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010850: 2020 2020 2020 2020 2020 2020 2069 6d67               img
-00010860: 7569 2e70 7573 685f 7374 796c 655f 636f  ui.push_style_co
-00010870: 6c6f 7228 696d 6775 692e 434f 4c4f 525f  lor(imgui.COLOR_
-00010880: 4652 414d 455f 4241 434b 4752 4f55 4e44  FRAME_BACKGROUND
-00010890: 2c20 312e 302c 2031 2e30 2c20 312e 302c  , 1.0, 1.0, 1.0,
-000108a0: 2031 2e30 290d 0a20 2020 2020 2020 2020   1.0)..         
-000108b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000108c0: 2020 2020 2020 2069 6d67 7569 2e70 7573         imgui.pus
-000108d0: 685f 7374 796c 655f 636f 6c6f 7228 696d  h_style_color(im
-000108e0: 6775 692e 434f 4c4f 525f 4652 414d 455f  gui.COLOR_FRAME_
-000108f0: 4241 434b 4752 4f55 4e44 5f41 4354 4956  BACKGROUND_ACTIV
-00010900: 452c 2031 2e30 2c20 312e 302c 2031 2e30  E, 1.0, 1.0, 1.0
-00010910: 2c20 312e 3029 0d0a 2020 2020 2020 2020  , 1.0)..        
+00010850: 2020 2020 2020 2020 2022 6d6f 6465 6c27           "model'
+00010860: 7320 7072 6564 6963 7469 6f6e 2076 616c  s prediction val
+00010870: 7565 2069 7320 6869 6768 6572 2074 6861  ue is higher tha
+00010880: 6e20 7468 6174 206f 6620 616e 2061 6273  n that of an abs
+00010890: 6f72 6265 722e 2229 0d0a 2020 2020 2020  orber.")..      
+000108a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000108b0: 2020 2020 2020 696d 6775 692e 7361 6d65        imgui.same
+000108c0: 5f6c 696e 6528 290d 0a20 2020 2020 2020  _line()..       
+000108d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000108e0: 2020 2020 205f 2c20 6d2e 6162 736f 7262       _, m.absorb
+000108f0: 203d 2069 6d67 7569 2e63 6865 636b 626f   = imgui.checkbo
+00010900: 7828 2220 6162 736f 7262 2022 2c20 6d2e  x(" absorb ", m.
+00010910: 6162 736f 7262 290d 0a20 2020 2020 2020  absorb)..       
 00010920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010930: 2020 2020 2020 2020 696d 6775 692e 7075          imgui.pu
-00010940: 7368 5f73 7479 6c65 5f63 6f6c 6f72 2869  sh_style_color(i
-00010950: 6d67 7569 2e43 4f4c 4f52 5f46 5241 4d45  mgui.COLOR_FRAME
-00010960: 5f42 4143 4b47 524f 554e 445f 484f 5645  _BACKGROUND_HOVE
-00010970: 5245 442c 2031 2e30 2c20 312e 302c 2031  RED, 1.0, 1.0, 1
-00010980: 2e30 2c20 312e 3029 0d0a 2020 2020 2020  .0, 1.0)..      
+00010930: 2020 2020 2073 656c 662e 746f 6f6c 7469       self.toolti
+00010940: 7028 2257 6865 6e20 6368 6563 6b65 642c  p("When checked,
+00010950: 2074 6869 7320 6d6f 6465 6c20 6162 736f   this model abso
+00010960: 7262 7320 7072 6564 6963 7469 6f6e 7320  rbs predictions 
+00010970: 6279 206f 7468 6572 206d 6f64 656c 732c  by other models,
+00010980: 206d 6561 6e69 6e67 5c6e 220d 0a20 2020   meaning\n"..   
 00010990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000109a0: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
-000109b0: 7075 7368 5f73 7479 6c65 5f76 6172 2869  push_style_var(i
-000109c0: 6d67 7569 2e53 5459 4c45 5f46 5241 4d45  mgui.STYLE_FRAME
-000109d0: 5f50 4144 4449 4e47 2c20 2835 2c20 3129  _PADDING, (5, 1)
-000109e0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-000109f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010a00: 2020 2069 6d67 7569 2e70 7573 685f 6974     imgui.push_it
-00010a10: 656d 5f77 6964 7468 2831 3829 0d0a 2020  em_width(18)..  
-00010a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010a30: 2020 2020 2020 2020 2020 2020 2020 6d5f                m_
-00010a40: 6964 7820 3d20 4d6f 6465 6c49 6e74 6572  idx = ModelInter
-00010a50: 6163 7469 6f6e 2e61 6c6c 2e69 6e64 6578  action.all.index
-00010a60: 2869 6e74 6572 6163 7469 6f6e 290d 0a20  (interaction).. 
-00010a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010a80: 2020 2020 2020 2020 2020 2020 2020 205f                 _
-00010a90: 2c20 6e65 775f 6964 7820 3d20 696d 6775  , new_idx = imgu
-00010aa0: 692e 696e 7075 745f 696e 7428 2223 2369  i.input_int("##i
-00010ab0: 6e74 6572 6163 7469 6f6e 696e 6465 7822  nteractionindex"
-00010ac0: 2c20 6d5f 6964 782b 312c 2030 2c20 3029  , m_idx+1, 0, 0)
-00010ad0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00010ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010af0: 2020 6966 205f 3a0d 0a20 2020 2020 2020    if _:..       
+000109a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000109b0: 2020 2020 2020 2269 7473 206f 7574 7075        "its outpu
+000109c0: 7420 6973 206e 756c 6c69 6669 6564 2077  t is nullified w
+000109d0: 6865 7265 7665 7220 7468 6572 6520 6973  herever there is
+000109e0: 2061 6e79 2065 6d69 7474 696e 6720 6d6f   any emitting mo
+000109f0: 6465 6c20 7468 6174 205c 6e22 0d0a 2020  del that \n"..  
+00010a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010a20: 2020 2020 2020 2022 7072 6564 6963 7473         "predicts
+00010a30: 2061 2068 6967 6865 7220 7661 6c75 652e   a higher value.
+00010a40: 2229 0d0a 0d0a 2020 2020 2020 2020 2020  ")....          
+00010a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010a60: 2020 2320 7061 7273 6520 6176 6169 6c61    # parse availa
+00010a70: 626c 6520 6d6f 6465 6c73 0d0a 2020 2020  ble models..    
+00010a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010a90: 2020 2020 2020 2020 6176 6169 6c61 626c          availabl
+00010aa0: 655f 7061 7274 6e65 725f 6d6f 6465 6c73  e_partner_models
+00010ab0: 203d 206c 6973 7428 290d 0a20 2020 2020   = list()..     
+00010ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010ad0: 2020 2020 2020 2061 7661 696c 6162 6c65         available
+00010ae0: 5f70 6172 746e 6572 5f6d 6f64 656c 5f6e  _partner_model_n
+00010af0: 616d 6573 203d 206c 6973 7428 290d 0a20  ames = list().. 
 00010b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010b10: 2020 2020 2020 2020 2020 2020 206e 6577               new
-00010b20: 5f69 6478 202d 3d20 310d 0a20 2020 2020  _idx -= 1..     
-00010b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010b40: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-00010b50: 6577 5f69 6478 203d 206d 696e 286d 6178  ew_idx = min(max
-00010b60: 2830 2c20 6e65 775f 6964 7829 2c20 6c65  (0, new_idx), le
-00010b70: 6e28 4d6f 6465 6c49 6e74 6572 6163 7469  n(ModelInteracti
-00010b80: 6f6e 2e61 6c6c 2920 2d20 3129 0d0a 2020  on.all) - 1)..  
-00010b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010bb0: 2020 4d6f 6465 6c49 6e74 6572 6163 7469    ModelInteracti
-00010bc0: 6f6e 2e61 6c6c 5b6e 6577 5f69 6478 5d2c  on.all[new_idx],
-00010bd0: 204d 6f64 656c 496e 7465 7261 6374 696f   ModelInteractio
-00010be0: 6e2e 616c 6c5b 6d5f 6964 785d 203d 204d  n.all[m_idx] = M
-00010bf0: 6f64 656c 496e 7465 7261 6374 696f 6e2e  odelInteraction.
-00010c00: 616c 6c5b 6d5f 6964 785d 2c20 4d6f 6465  all[m_idx], Mode
-00010c10: 6c49 6e74 6572 6163 7469 6f6e 2e61 6c6c  lInteraction.all
-00010c20: 5b6e 6577 5f69 6478 5d0d 0a20 2020 2020  [new_idx]..     
-00010c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010c40: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
-00010c50: 2e70 6f70 5f73 7479 6c65 5f63 6f6c 6f72  .pop_style_color
-00010c60: 2833 290d 0a20 2020 2020 2020 2020 2020  (3)..           
-00010c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010c80: 2020 2020 2069 6d67 7569 2e70 6f70 5f73       imgui.pop_s
-00010c90: 7479 6c65 5f76 6172 2831 290d 0a0d 0a20  tyle_var(1).... 
-00010ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010cb0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00010cc0: 2073 656c 6563 7420 6d6f 6465 6c20 746f   select model to
-00010cd0: 2069 6e74 6572 6163 7420 7769 7468 0d0a   interact with..
+00010b10: 2020 2020 2020 2020 2020 2066 6f72 2070             for p
+00010b20: 6172 746e 6572 2069 6e20 6366 672e 7365  artner in cfg.se
+00010b30: 5f6d 6f64 656c 733a 0d0a 2020 2020 2020  _models:..      
+00010b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010b50: 2020 2020 2020 2020 2020 6966 2070 6172            if par
+00010b60: 746e 6572 2021 3d20 6d3a 0d0a 2020 2020  tner != m:..    
+00010b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010b90: 6176 6169 6c61 626c 655f 7061 7274 6e65  available_partne
+00010ba0: 725f 6d6f 6465 6c73 2e61 7070 656e 6428  r_models.append(
+00010bb0: 7061 7274 6e65 7229 0d0a 2020 2020 2020  partner)..      
+00010bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010bd0: 2020 2020 2020 2020 2020 2020 2020 6176                av
+00010be0: 6169 6c61 626c 655f 7061 7274 6e65 725f  ailable_partner_
+00010bf0: 6d6f 6465 6c5f 6e61 6d65 732e 6170 7065  model_names.appe
+00010c00: 6e64 2870 6172 746e 6572 2e74 6974 6c65  nd(partner.title
+00010c10: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
+00010c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010c30: 2023 2069 6e74 6572 6163 7469 6f6e 2047   # interaction G
+00010c40: 5549 0d0a 2020 2020 2020 2020 2020 2020  UI..            
+00010c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010c60: 6377 203d 2069 6d67 7569 2e67 6574 5f63  cw = imgui.get_c
+00010c70: 6f6e 7465 6e74 5f72 6567 696f 6e5f 6176  ontent_region_av
+00010c80: 6169 6c61 626c 655f 7769 6474 6828 290d  ailable_width().
+00010c90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010ca0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00010cb0: 2069 6e74 6572 6163 7469 6f6e 2069 6e20   interaction in 
+00010cc0: 6d2e 696e 7465 7261 6374 696f 6e73 3a0d  m.interactions:.
+00010cd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00010ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010d00: 696d 6775 692e 7075 7368 5f73 7479 6c65  imgui.push_style
-00010d10: 5f76 6172 2869 6d67 7569 2e53 5459 4c45  _var(imgui.STYLE
-00010d20: 5f46 5241 4d45 5f50 4144 4449 4e47 2c20  _FRAME_PADDING, 
-00010d30: 2838 2c20 3129 290d 0a20 2020 2020 2020  (8, 1))..       
-00010d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010d50: 2020 2020 2020 2020 2069 6d67 7569 2e73           imgui.s
-00010d60: 6574 5f6e 6578 745f 6974 656d 5f77 6964  et_next_item_wid
-00010d70: 7468 2828 6377 202d 2031 382d 392d 3135  th((cw - 18-9-15
-00010d80: 2920 2f2f 2032 290d 0a20 2020 2020 2020  ) // 2)..       
-00010d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010da0: 2020 2020 2020 2020 2069 6d67 7569 2e73           imgui.s
-00010db0: 616d 655f 6c69 6e65 2873 7061 6369 6e67  ame_line(spacing
-00010dc0: 3d33 290d 0a20 2020 2020 2020 2020 2020  =3)..           
+00010cf0: 2064 656c 6574 655f 7468 6973 5f69 6e74   delete_this_int
+00010d00: 6572 203d 2046 616c 7365 0d0a 2020 2020  er = False..    
+00010d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010d20: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00010d30: 6e74 6572 6163 7469 6f6e 2e70 6172 746e  nteraction.partn
+00010d40: 6572 206e 6f74 2069 6e20 6366 672e 7365  er not in cfg.se
+00010d50: 5f6d 6f64 656c 733a 0d0a 2020 2020 2020  _models:..      
+00010d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010d70: 2020 2020 2020 2020 2020 2020 2020 6d2e                m.
+00010d80: 696e 7465 7261 6374 696f 6e73 2e72 656d  interactions.rem
+00010d90: 6f76 6528 696e 7465 7261 6374 696f 6e29  ove(interaction)
+00010da0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00010db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010dc0: 2020 2020 2020 636f 6e74 696e 7565 0d0a        continue..
 00010dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010de0: 2020 2020 205f 2c20 696e 7465 7261 6374       _, interact
-00010df0: 696f 6e2e 7479 7065 203d 2069 6d67 7569  ion.type = imgui
-00010e00: 2e63 6f6d 626f 2822 2323 7479 7065 222c  .combo("##type",
-00010e10: 2069 6e74 6572 6163 7469 6f6e 2e74 7970   interaction.typ
-00010e20: 652c 204d 6f64 656c 496e 7465 7261 6374  e, ModelInteract
-00010e30: 696f 6e2e 5459 5045 5329 0d0a 2020 2020  ion.TYPES)..    
-00010e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010e50: 2020 2020 2020 2020 2020 2020 6966 205f              if _
-00010e60: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00010de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010df0: 6966 2069 6e74 6572 6163 7469 6f6e 206e  if interaction n
+00010e00: 6f74 2069 6e20 4d6f 6465 6c49 6e74 6572  ot in ModelInter
+00010e10: 6163 7469 6f6e 2e61 6c6c 3a0d 0a20 2020  action.all:..   
+00010e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010e40: 206d 2e69 6e74 6572 6163 7469 6f6e 732e   m.interactions.
+00010e50: 7265 6d6f 7665 2869 6e74 6572 6163 7469  remove(interacti
+00010e60: 6f6e 290d 0a20 2020 2020 2020 2020 2020  on)..           
 00010e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010e80: 2020 2020 2020 2069 6620 6366 672e 7365         if cfg.se
-00010e90: 5f61 6374 6976 655f 6672 616d 6520 6973  _active_frame is
-00010ea0: 206e 6f74 204e 6f6e 653a 0d0a 2020 2020   not None:..    
-00010eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010ed0: 2020 2020 6366 672e 7365 5f61 6374 6976      cfg.se_activ
-00010ee0: 655f 6672 616d 652e 736c 6963 655f 6368  e_frame.slice_ch
-00010ef0: 616e 6765 6420 3d20 5472 7565 0d0a 2020  anged = True..  
-00010f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010f10: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00010f20: 7365 6c65 6374 2069 6e74 6572 6163 7469  select interacti
-00010f30: 6f6e 2074 7970 650d 0a20 2020 2020 2020  on type..       
-00010f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010f50: 2020 2020 2020 2020 2070 5f69 6478 203d           p_idx =
-00010f60: 2061 7661 696c 6162 6c65 5f70 6172 746e   available_partn
-00010f70: 6572 5f6d 6f64 656c 5f6e 616d 6573 2e69  er_model_names.i
-00010f80: 6e64 6578 2869 6e74 6572 6163 7469 6f6e  ndex(interaction
-00010f90: 2e70 6172 746e 6572 2e74 6974 6c65 290d  .partner.title).
-00010fa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010fc0: 2069 6d67 7569 2e73 616d 655f 6c69 6e65   imgui.same_line
-00010fd0: 2873 7061 6369 6e67 3d33 290d 0a20 2020  (spacing=3)..   
-00010fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010ff0: 2020 2020 2020 2020 2020 2020 2069 6d67               img
-00011000: 7569 2e73 6574 5f6e 6578 745f 6974 656d  ui.set_next_item
-00011010: 5f77 6964 7468 2828 6377 202d 2031 382d  _width((cw - 18-
-00011020: 392d 3135 2920 2f2f 2032 290d 0a20 2020  9-15) // 2)..   
-00011030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011040: 2020 2020 2020 2020 2020 2020 2069 6d67               img
-00011050: 7569 2e70 7573 685f 7374 796c 655f 636f  ui.push_style_co
-00011060: 6c6f 7228 696d 6775 692e 434f 4c4f 525f  lor(imgui.COLOR_
-00011070: 4255 5454 4f4e 2c20 2a69 6e74 6572 6163  BUTTON, *interac
-00011080: 7469 6f6e 2e70 6172 746e 6572 2e63 6f6c  tion.partner.col
-00011090: 6f75 7229 0d0a 2020 2020 2020 2020 2020  our)..          
-000110a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000110b0: 2020 2020 2020 696d 6775 692e 7075 7368        imgui.push
-000110c0: 5f73 7479 6c65 5f63 6f6c 6f72 2869 6d67  _style_color(img
-000110d0: 7569 2e43 4f4c 4f52 5f42 5554 544f 4e5f  ui.COLOR_BUTTON_
-000110e0: 484f 5645 5245 442c 202a 696e 7465 7261  HOVERED, *intera
-000110f0: 6374 696f 6e2e 7061 7274 6e65 722e 636f  ction.partner.co
-00011100: 6c6f 7572 290d 0a20 2020 2020 2020 2020  lour)..         
-00011110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011120: 2020 2020 2020 2069 6d67 7569 2e70 7573         imgui.pus
-00011130: 685f 7374 796c 655f 636f 6c6f 7228 696d  h_style_color(im
-00011140: 6775 692e 434f 4c4f 525f 4255 5454 4f4e  gui.COLOR_BUTTON
-00011150: 5f41 4354 4956 452c 202a 696e 7465 7261  _ACTIVE, *intera
-00011160: 6374 696f 6e2e 7061 7274 6e65 722e 636f  ction.partner.co
-00011170: 6c6f 7572 290d 0a20 2020 2020 2020 2020  lour)..         
-00011180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011190: 2020 2020 2020 205f 2c20 705f 6964 7820         _, p_idx 
-000111a0: 3d20 696d 6775 692e 636f 6d62 6f28 2223  = imgui.combo("#
-000111b0: 2370 6172 746e 6572 5f6d 6f64 656c 222c  #partner_model",
-000111c0: 2070 5f69 6478 2c20 6176 6169 6c61 626c   p_idx, availabl
-000111d0: 655f 7061 7274 6e65 725f 6d6f 6465 6c5f  e_partner_model_
-000111e0: 6e61 6d65 7329 0d0a 2020 2020 2020 2020  names)..        
-000111f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011200: 2020 2020 2020 2020 6966 205f 3a0d 0a20          if _:.. 
+00010e80: 2020 2020 2020 2020 2063 6f6e 7469 6e75           continu
+00010e90: 650d 0a20 2020 2020 2020 2020 2020 2020  e..             
+00010ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010eb0: 2020 2069 6d67 7569 2e70 7573 685f 6964     imgui.push_id
+00010ec0: 2866 226d 6f64 656c 696e 7465 7261 6374  (f"modelinteract
+00010ed0: 696f 6e7b 696e 7465 7261 6374 696f 6e2e  ion{interaction.
+00010ee0: 7569 647d 2229 0d0a 0d0a 2020 2020 2020  uid}")....      
+00010ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010f00: 2020 2020 2020 2020 2020 2320 6d6f 6465            # mode
+00010f10: 6c20 696e 6465 780d 0a20 2020 2020 2020  l index..       
+00010f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010f30: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
+00010f40: 7573 685f 7374 796c 655f 636f 6c6f 7228  ush_style_color(
+00010f50: 696d 6775 692e 434f 4c4f 525f 4652 414d  imgui.COLOR_FRAM
+00010f60: 455f 4241 434b 4752 4f55 4e44 2c20 312e  E_BACKGROUND, 1.
+00010f70: 302c 2031 2e30 2c20 312e 302c 2031 2e30  0, 1.0, 1.0, 1.0
+00010f80: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00010f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010fa0: 2020 2069 6d67 7569 2e70 7573 685f 7374     imgui.push_st
+00010fb0: 796c 655f 636f 6c6f 7228 696d 6775 692e  yle_color(imgui.
+00010fc0: 434f 4c4f 525f 4652 414d 455f 4241 434b  COLOR_FRAME_BACK
+00010fd0: 4752 4f55 4e44 5f41 4354 4956 452c 2031  GROUND_ACTIVE, 1
+00010fe0: 2e30 2c20 312e 302c 2031 2e30 2c20 312e  .0, 1.0, 1.0, 1.
+00010ff0: 3029 0d0a 2020 2020 2020 2020 2020 2020  0)..            
+00011000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011010: 2020 2020 696d 6775 692e 7075 7368 5f73      imgui.push_s
+00011020: 7479 6c65 5f63 6f6c 6f72 2869 6d67 7569  tyle_color(imgui
+00011030: 2e43 4f4c 4f52 5f46 5241 4d45 5f42 4143  .COLOR_FRAME_BAC
+00011040: 4b47 524f 554e 445f 484f 5645 5245 442c  KGROUND_HOVERED,
+00011050: 2031 2e30 2c20 312e 302c 2031 2e30 2c20   1.0, 1.0, 1.0, 
+00011060: 312e 3029 0d0a 2020 2020 2020 2020 2020  1.0)..          
+00011070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011080: 2020 2020 2020 696d 6775 692e 7075 7368        imgui.push
+00011090: 5f73 7479 6c65 5f76 6172 2869 6d67 7569  _style_var(imgui
+000110a0: 2e53 5459 4c45 5f46 5241 4d45 5f50 4144  .STYLE_FRAME_PAD
+000110b0: 4449 4e47 2c20 2835 2c20 3129 290d 0a20  DING, (5, 1)).. 
+000110c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000110d0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000110e0: 6d67 7569 2e70 7573 685f 6974 656d 5f77  mgui.push_item_w
+000110f0: 6964 7468 2831 3829 0d0a 2020 2020 2020  idth(18)..      
+00011100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011110: 2020 2020 2020 2020 2020 6d5f 6964 7820            m_idx 
+00011120: 3d20 4d6f 6465 6c49 6e74 6572 6163 7469  = ModelInteracti
+00011130: 6f6e 2e61 6c6c 2e69 6e64 6578 2869 6e74  on.all.index(int
+00011140: 6572 6163 7469 6f6e 290d 0a20 2020 2020  eraction)..     
+00011150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011160: 2020 2020 2020 2020 2020 205f 2c20 6e65             _, ne
+00011170: 775f 6964 7820 3d20 696d 6775 692e 696e  w_idx = imgui.in
+00011180: 7075 745f 696e 7428 2223 2369 6e74 6572  put_int("##inter
+00011190: 6163 7469 6f6e 696e 6465 7822 2c20 6d5f  actionindex", m_
+000111a0: 6964 782b 312c 2030 2c20 3029 0d0a 2020  idx+1, 0, 0)..  
+000111b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000111c0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+000111d0: 205f 3a0d 0a20 2020 2020 2020 2020 2020   _:..           
+000111e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000111f0: 2020 2020 2020 2020 206e 6577 5f69 6478           new_idx
+00011200: 202d 3d20 310d 0a20 2020 2020 2020 2020   -= 1..         
 00011210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011230: 2020 2069 6620 6366 672e 7365 5f61 6374     if cfg.se_act
-00011240: 6976 655f 6672 616d 6520 6973 206e 6f74  ive_frame is not
-00011250: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
-00011260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011220: 2020 2020 2020 2020 2020 206e 6577 5f69             new_i
+00011230: 6478 203d 206d 696e 286d 6178 2830 2c20  dx = min(max(0, 
+00011240: 6e65 775f 6964 7829 2c20 6c65 6e28 4d6f  new_idx), len(Mo
+00011250: 6465 6c49 6e74 6572 6163 7469 6f6e 2e61  delInteraction.a
+00011260: 6c6c 2920 2d20 3129 0d0a 2020 2020 2020  ll) - 1)..      
 00011270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011280: 6366 672e 7365 5f61 6374 6976 655f 6672  cfg.se_active_fr
-00011290: 616d 652e 736c 6963 655f 6368 616e 6765  ame.slice_change
-000112a0: 6420 3d20 5472 7565 0d0a 2020 2020 2020  d = True..      
-000112b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000112c0: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
-000112d0: 706f 705f 7374 796c 655f 636f 6c6f 7228  pop_style_color(
-000112e0: 3329 0d0a 2020 2020 2020 2020 2020 2020  3)..            
-000112f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011300: 2020 2020 696d 6775 692e 706f 705f 7374      imgui.pop_st
-00011310: 796c 655f 7661 7228 3129 0d0a 2020 2020  yle_var(1)..    
-00011320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011330: 2020 2020 2020 2020 2020 2020 696e 7465              inte
-00011340: 7261 6374 696f 6e2e 7061 7274 6e65 7220  raction.partner 
-00011350: 3d20 6176 6169 6c61 626c 655f 7061 7274  = available_part
-00011360: 6e65 725f 6d6f 6465 6c73 5b70 5f69 6478  ner_models[p_idx
-00011370: 5d0d 0a0d 0a20 2020 2020 2020 2020 2020  ]....           
+00011280: 2020 2020 2020 2020 2020 2020 2020 4d6f                Mo
+00011290: 6465 6c49 6e74 6572 6163 7469 6f6e 2e61  delInteraction.a
+000112a0: 6c6c 5b6e 6577 5f69 6478 5d2c 204d 6f64  ll[new_idx], Mod
+000112b0: 656c 496e 7465 7261 6374 696f 6e2e 616c  elInteraction.al
+000112c0: 6c5b 6d5f 6964 785d 203d 204d 6f64 656c  l[m_idx] = Model
+000112d0: 496e 7465 7261 6374 696f 6e2e 616c 6c5b  Interaction.all[
+000112e0: 6d5f 6964 785d 2c20 4d6f 6465 6c49 6e74  m_idx], ModelInt
+000112f0: 6572 6163 7469 6f6e 2e61 6c6c 5b6e 6577  eraction.all[new
+00011300: 5f69 6478 5d0d 0a20 2020 2020 2020 2020  _idx]..         
+00011310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011320: 2020 2020 2020 2069 6d67 7569 2e70 6f70         imgui.pop
+00011330: 5f73 7479 6c65 5f63 6f6c 6f72 2833 290d  _style_color(3).
+00011340: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011360: 2069 6d67 7569 2e70 6f70 5f73 7479 6c65   imgui.pop_style
+00011370: 5f76 6172 2831 290d 0a0d 0a20 2020 2020  _var(1)....     
 00011380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011390: 2020 2020 2069 6d67 7569 2e73 616d 655f       imgui.same_
-000113a0: 6c69 6e65 2870 6f73 6974 696f 6e20 3d20  line(position = 
-000113b0: 6377 2d37 290d 0a20 2020 2020 2020 2020  cw-7)..         
+00011390: 2020 2020 2020 2020 2020 2023 2073 656c             # sel
+000113a0: 6563 7420 6d6f 6465 6c20 746f 2069 6e74  ect model to int
+000113b0: 6572 6163 7420 7769 7468 0d0a 2020 2020  eract with..    
 000113c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000113d0: 2020 2020 2020 2069 6d67 7569 2e70 7573         imgui.pus
-000113e0: 685f 7374 796c 655f 7661 7228 696d 6775  h_style_var(imgu
-000113f0: 692e 5354 594c 455f 4652 414d 455f 5041  i.STYLE_FRAME_PA
-00011400: 4444 494e 472c 2028 302c 2030 2929 0d0a  DDING, (0, 0))..
-00011410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000113d0: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
+000113e0: 692e 7075 7368 5f73 7479 6c65 5f76 6172  i.push_style_var
+000113f0: 2869 6d67 7569 2e53 5459 4c45 5f46 5241  (imgui.STYLE_FRA
+00011400: 4d45 5f50 4144 4449 4e47 2c20 2838 2c20  ME_PADDING, (8, 
+00011410: 3129 290d 0a20 2020 2020 2020 2020 2020  1))..           
 00011420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011430: 6966 2069 6d67 7569 2e69 6d61 6765 5f62  if imgui.image_b
-00011440: 7574 746f 6e28 7365 6c66 2e69 636f 6e5f  utton(self.icon_
-00011450: 636c 6f73 652e 7265 6e64 6572 6572 5f69  close.renderer_i
-00011460: 642c 2031 352c 2031 3529 3a0d 0a20 2020  d, 15, 15):..   
+00011430: 2020 2020 2069 6d67 7569 2e73 6574 5f6e       imgui.set_n
+00011440: 6578 745f 6974 656d 5f77 6964 7468 2828  ext_item_width((
+00011450: 6377 202d 2031 382d 392d 3135 2920 2f2f  cw - 18-9-15) //
+00011460: 2032 290d 0a20 2020 2020 2020 2020 2020   2)..           
 00011470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011490: 2064 656c 6574 655f 7468 6973 5f69 6e74   delete_this_int
-000114a0: 6572 203d 2054 7275 650d 0a20 2020 2020  er = True..     
+00011480: 2020 2020 2069 6d67 7569 2e73 616d 655f       imgui.same_
+00011490: 6c69 6e65 2873 7061 6369 6e67 3d33 290d  line(spacing=3).
+000114a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 000114b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000114c0: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
-000114d0: 2e70 6f70 5f73 7479 6c65 5f76 6172 2831  .pop_style_var(1
-000114e0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-000114f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011500: 2020 2069 6d67 7569 2e70 7573 685f 7374     imgui.push_st
-00011510: 796c 655f 7661 7228 696d 6775 692e 5354  yle_var(imgui.ST
-00011520: 594c 455f 4652 414d 455f 5041 4444 494e  YLE_FRAME_PADDIN
-00011530: 472c 2028 332c 2030 2929 0d0a 2020 2020  G, (3, 0))..    
+000114c0: 205f 2c20 696e 7465 7261 6374 696f 6e2e   _, interaction.
+000114d0: 7479 7065 203d 2069 6d67 7569 2e63 6f6d  type = imgui.com
+000114e0: 626f 2822 2323 7479 7065 222c 2069 6e74  bo("##type", int
+000114f0: 6572 6163 7469 6f6e 2e74 7970 652c 204d  eraction.type, M
+00011500: 6f64 656c 496e 7465 7261 6374 696f 6e2e  odelInteraction.
+00011510: 5459 5045 5329 0d0a 2020 2020 2020 2020  TYPES)..        
+00011520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011530: 2020 2020 2020 2020 6966 205f 3a0d 0a20          if _:.. 
 00011540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011550: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
-00011560: 692e 7365 745f 6e65 7874 5f69 7465 6d5f  i.set_next_item_
-00011570: 7769 6474 6828 6377 290d 0a20 2020 2020  width(cw)..     
-00011580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011590: 2020 2020 2020 2020 2020 205f 2c20 696e             _, in
-000115a0: 7465 7261 6374 696f 6e2e 7261 6469 7573  teraction.radius
-000115b0: 203d 2069 6d67 7569 2e73 6c69 6465 725f   = imgui.slider_
-000115c0: 666c 6f61 7428 2223 2372 6164 6975 7322  float("##radius"
-000115d0: 2c20 696e 7465 7261 6374 696f 6e2e 7261  , interaction.ra
-000115e0: 6469 7573 2c20 302e 302c 2033 302e 302c  dius, 0.0, 30.0,
-000115f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00011600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011560: 2020 2069 6620 6366 672e 7365 5f61 6374     if cfg.se_act
+00011570: 6976 655f 6672 616d 6520 6973 206e 6f74  ive_frame is not
+00011580: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
+00011590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000115a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000115b0: 6366 672e 7365 5f61 6374 6976 655f 6672  cfg.se_active_fr
+000115c0: 616d 652e 736c 6963 655f 6368 616e 6765  ame.slice_change
+000115d0: 6420 3d20 5472 7565 0d0a 2020 2020 2020  d = True..      
+000115e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000115f0: 2020 2020 2020 2020 2020 2320 7365 6c65            # sele
+00011600: 6374 2069 6e74 6572 6163 7469 6f6e 2074  ct interaction t
+00011610: 7970 650d 0a20 2020 2020 2020 2020 2020  ype..           
 00011620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011630: 2020 2020 2020 2020 2020 2020 2066 2272               f"r
-00011640: 6164 6975 7320 3d20 7b69 6e74 6572 6163  adius = {interac
-00011650: 7469 6f6e 2e72 6164 6975 733a 2e31 667d  tion.radius:.1f}
-00011660: 206e 6d22 290d 0a20 2020 2020 2020 2020   nm")..         
-00011670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011680: 2020 2020 2020 2069 6620 5f3a 0d0a 2020         if _:..  
-00011690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000116a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000116b0: 2020 6966 2063 6667 2e73 655f 6163 7469    if cfg.se_acti
-000116c0: 7665 5f66 7261 6d65 2069 7320 6e6f 7420  ve_frame is not 
-000116d0: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
-000116e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000116f0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00011700: 6667 2e73 655f 6163 7469 7665 5f66 7261  fg.se_active_fra
-00011710: 6d65 2e73 6c69 6365 5f63 6861 6e67 6564  me.slice_changed
-00011720: 203d 2054 7275 650d 0a20 2020 2020 2020   = True..       
-00011730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011740: 2020 2020 2020 2020 2069 6d67 7569 2e73           imgui.s
-00011750: 6574 5f6e 6578 745f 6974 656d 5f77 6964  et_next_item_wid
-00011760: 7468 2863 7729 0d0a 2020 2020 2020 2020  th(cw)..        
-00011770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011780: 2020 2020 2020 2020 5f2c 2069 6e74 6572          _, inter
-00011790: 6163 7469 6f6e 2e74 6872 6573 686f 6c64  action.threshold
-000117a0: 203d 2069 6d67 7569 2e73 6c69 6465 725f   = imgui.slider_
-000117b0: 666c 6f61 7428 2223 2374 6872 6573 686f  float("##thresho
-000117c0: 6c64 222c 2069 6e74 6572 6163 7469 6f6e  ld", interaction
-000117d0: 2e74 6872 6573 686f 6c64 2c20 302e 302c  .threshold, 0.0,
-000117e0: 2031 2e30 2c0d 0a20 2020 2020 2020 2020   1.0,..         
+00011630: 2020 2020 2070 5f69 6478 203d 2061 7661       p_idx = ava
+00011640: 696c 6162 6c65 5f70 6172 746e 6572 5f6d  ilable_partner_m
+00011650: 6f64 656c 5f6e 616d 6573 2e69 6e64 6578  odel_names.index
+00011660: 2869 6e74 6572 6163 7469 6f6e 2e70 6172  (interaction.par
+00011670: 746e 6572 2e74 6974 6c65 290d 0a20 2020  tner.title)..   
+00011680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011690: 2020 2020 2020 2020 2020 2020 2069 6d67               img
+000116a0: 7569 2e73 616d 655f 6c69 6e65 2873 7061  ui.same_line(spa
+000116b0: 6369 6e67 3d33 290d 0a20 2020 2020 2020  cing=3)..       
+000116c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000116d0: 2020 2020 2020 2020 2069 6d67 7569 2e73           imgui.s
+000116e0: 6574 5f6e 6578 745f 6974 656d 5f77 6964  et_next_item_wid
+000116f0: 7468 2828 6377 202d 2031 382d 392d 3135  th((cw - 18-9-15
+00011700: 2920 2f2f 2032 290d 0a20 2020 2020 2020  ) // 2)..       
+00011710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011720: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
+00011730: 7573 685f 7374 796c 655f 636f 6c6f 7228  ush_style_color(
+00011740: 696d 6775 692e 434f 4c4f 525f 4255 5454  imgui.COLOR_BUTT
+00011750: 4f4e 2c20 2a69 6e74 6572 6163 7469 6f6e  ON, *interaction
+00011760: 2e70 6172 746e 6572 2e63 6f6c 6f75 7229  .partner.colour)
+00011770: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00011780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011790: 2020 696d 6775 692e 7075 7368 5f73 7479    imgui.push_sty
+000117a0: 6c65 5f63 6f6c 6f72 2869 6d67 7569 2e43  le_color(imgui.C
+000117b0: 4f4c 4f52 5f42 5554 544f 4e5f 484f 5645  OLOR_BUTTON_HOVE
+000117c0: 5245 442c 202a 696e 7465 7261 6374 696f  RED, *interactio
+000117d0: 6e2e 7061 7274 6e65 722e 636f 6c6f 7572  n.partner.colour
+000117e0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
 000117f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011830: 2020 6622 7b69 6e74 6572 6163 7469 6f6e    f"{interaction
-00011840: 2e70 6172 746e 6572 2e74 6974 6c65 7d20  .partner.title} 
-00011850: 7468 7265 7368 6f6c 6420 3d20 7b69 6e74  threshold = {int
-00011860: 6572 6163 7469 6f6e 2e74 6872 6573 686f  eraction.thresho
-00011870: 6c64 3a2e 3266 7d22 290d 0a20 2020 2020  ld:.2f}")..     
-00011880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011890: 2020 2020 2020 2020 2020 2069 6620 5f3a             if _:
-000118a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000118b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000118c0: 2020 2020 2020 696e 7465 7261 6374 696f        interactio
-000118d0: 6e2e 7061 7274 6e65 722e 7468 7265 7368  n.partner.thresh
-000118e0: 6f6c 6420 3d20 696e 7465 7261 6374 696f  old = interactio
-000118f0: 6e2e 7468 7265 7368 6f6c 640d 0a20 2020  n.threshold..   
-00011900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011920: 2069 6620 6366 672e 7365 5f61 6374 6976   if cfg.se_activ
-00011930: 655f 6672 616d 6520 6973 206e 6f74 204e  e_frame is not N
-00011940: 6f6e 653a 0d0a 2020 2020 2020 2020 2020  one:..          
-00011950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011960: 2020 2020 2020 2020 2020 2020 2020 6366                cf
-00011970: 672e 7365 5f61 6374 6976 655f 6672 616d  g.se_active_fram
-00011980: 652e 736c 6963 655f 6368 616e 6765 6420  e.slice_changed 
-00011990: 3d20 5472 7565 0d0a 2020 2020 2020 2020  = True..        
-000119a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000119b0: 2020 2020 2020 2020 7365 6c66 2e74 6f6f          self.too
-000119c0: 6c74 6970 2822 4265 666f 7265 2061 7070  ltip("Before app
-000119d0: 6c79 696e 6720 696e 7465 7261 6374 696f  lying interactio
-000119e0: 6e73 2c20 7468 6520 7061 7274 6e65 7220  ns, the partner 
-000119f0: 6d6f 6465 6c27 7320 7365 676d 656e 7461  model's segmenta
-00011a00: 7469 6f6e 2069 7320 7468 7265 7368 6f6c  tion is threshol
-00011a10: 6465 6420 6174 2074 6869 7320 7661 6c75  ded at this valu
-00011a20: 652e 2229 0d0a 2020 2020 2020 2020 2020  e.")..          
-00011a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011a40: 2020 2020 2020 696d 6775 692e 706f 705f        imgui.pop_
-00011a50: 7374 796c 655f 7661 7228 3129 0d0a 2020  style_var(1)..  
+00011800: 2020 2069 6d67 7569 2e70 7573 685f 7374     imgui.push_st
+00011810: 796c 655f 636f 6c6f 7228 696d 6775 692e  yle_color(imgui.
+00011820: 434f 4c4f 525f 4255 5454 4f4e 5f41 4354  COLOR_BUTTON_ACT
+00011830: 4956 452c 202a 696e 7465 7261 6374 696f  IVE, *interactio
+00011840: 6e2e 7061 7274 6e65 722e 636f 6c6f 7572  n.partner.colour
+00011850: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00011860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011870: 2020 205f 2c20 705f 6964 7820 3d20 696d     _, p_idx = im
+00011880: 6775 692e 636f 6d62 6f28 2223 2370 6172  gui.combo("##par
+00011890: 746e 6572 5f6d 6f64 656c 222c 2070 5f69  tner_model", p_i
+000118a0: 6478 2c20 6176 6169 6c61 626c 655f 7061  dx, available_pa
+000118b0: 7274 6e65 725f 6d6f 6465 6c5f 6e61 6d65  rtner_model_name
+000118c0: 7329 0d0a 2020 2020 2020 2020 2020 2020  s)..            
+000118d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000118e0: 2020 2020 6966 205f 3a0d 0a20 2020 2020      if _:..     
+000118f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011900: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00011910: 6620 6366 672e 7365 5f61 6374 6976 655f  f cfg.se_active_
+00011920: 6672 616d 6520 6973 206e 6f74 204e 6f6e  frame is not Non
+00011930: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00011940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011950: 2020 2020 2020 2020 2020 2020 6366 672e              cfg.
+00011960: 7365 5f61 6374 6976 655f 6672 616d 652e  se_active_frame.
+00011970: 736c 6963 655f 6368 616e 6765 6420 3d20  slice_changed = 
+00011980: 5472 7565 0d0a 2020 2020 2020 2020 2020  True..          
+00011990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000119a0: 2020 2020 2020 696d 6775 692e 706f 705f        imgui.pop_
+000119b0: 7374 796c 655f 636f 6c6f 7228 3329 0d0a  style_color(3)..
+000119c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000119d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000119e0: 696d 6775 692e 706f 705f 7374 796c 655f  imgui.pop_style_
+000119f0: 7661 7228 3129 0d0a 2020 2020 2020 2020  var(1)..        
+00011a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011a10: 2020 2020 2020 2020 696e 7465 7261 6374          interact
+00011a20: 696f 6e2e 7061 7274 6e65 7220 3d20 6176  ion.partner = av
+00011a30: 6169 6c61 626c 655f 7061 7274 6e65 725f  ailable_partner_
+00011a40: 6d6f 6465 6c73 5b70 5f69 6478 5d0d 0a0d  models[p_idx]...
+00011a50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00011a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011a70: 2020 2020 2020 2020 2020 2020 2020 696d                im
-00011a80: 6775 692e 7365 7061 7261 746f 7228 290d  gui.separator().
-00011a90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011a70: 2069 6d67 7569 2e73 616d 655f 6c69 6e65   imgui.same_line
+00011a80: 2870 6f73 6974 696f 6e20 3d20 6377 2d37  (position = cw-7
+00011a90: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
 00011aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011ab0: 2069 6d67 7569 2e70 6f70 5f69 6428 290d   imgui.pop_id().
-00011ac0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00011ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011ae0: 2069 6620 6465 6c65 7465 5f74 6869 735f   if delete_this_
-00011af0: 696e 7465 723a 0d0a 2020 2020 2020 2020  inter:..        
-00011b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011b10: 2020 2020 2020 2020 2020 2020 6d2e 696e              m.in
-00011b20: 7465 7261 6374 696f 6e73 2e72 656d 6f76  teractions.remov
-00011b30: 6528 696e 7465 7261 6374 696f 6e29 0d0a  e(interaction)..
-00011b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011ab0: 2020 2069 6d67 7569 2e70 7573 685f 7374     imgui.push_st
+00011ac0: 796c 655f 7661 7228 696d 6775 692e 5354  yle_var(imgui.ST
+00011ad0: 594c 455f 4652 414d 455f 5041 4444 494e  YLE_FRAME_PADDIN
+00011ae0: 472c 2028 302c 2030 2929 0d0a 2020 2020  G, (0, 0))..    
+00011af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011b00: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00011b10: 6d67 7569 2e69 6d61 6765 5f62 7574 746f  mgui.image_butto
+00011b20: 6e28 7365 6c66 2e69 636f 6e5f 636c 6f73  n(self.icon_clos
+00011b30: 652e 7265 6e64 6572 6572 5f69 642c 2031  e.renderer_id, 1
+00011b40: 352c 2031 3529 3a0d 0a20 2020 2020 2020  5, 15):..       
 00011b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011b60: 2020 2020 4d6f 6465 6c49 6e74 6572 6163      ModelInterac
-00011b70: 7469 6f6e 2e61 6c6c 2e72 656d 6f76 6528  tion.all.remove(
-00011b80: 696e 7465 7261 6374 696f 6e29 0d0a 0d0a  interaction)....
+00011b60: 2020 2020 2020 2020 2020 2020 2064 656c               del
+00011b70: 6574 655f 7468 6973 5f69 6e74 6572 203d  ete_this_inter =
+00011b80: 2054 7275 650d 0a20 2020 2020 2020 2020   True..         
 00011b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011ba0: 2020 2020 2020 2020 2020 2020 2320 4164              # Ad
-00011bb0: 6420 696e 7465 7261 6374 696f 6e0d 0a20  d interaction.. 
+00011ba0: 2020 2020 2020 2069 6d67 7569 2e70 6f70         imgui.pop
+00011bb0: 5f73 7479 6c65 5f76 6172 2831 290d 0a20  _style_var(1).. 
 00011bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011bd0: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
-00011be0: 6e28 6176 6169 6c61 626c 655f 7061 7274  n(available_part
-00011bf0: 6e65 725f 6d6f 6465 6c73 2920 3e3d 2031  ner_models) >= 1
-00011c00: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00011c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011c20: 2020 2069 6d67 7569 2e6e 6577 5f6c 696e     imgui.new_lin
-00011c30: 6528 290d 0a20 2020 2020 2020 2020 2020  e()..           
-00011c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011c50: 2020 2020 2069 6d67 7569 2e73 616d 655f       imgui.same_
-00011c60: 6c69 6e65 2873 7061 6369 6e67 203d 2028  line(spacing = (
-00011c70: 6377 202d 2033 3029 202f 2f20 3229 0d0a  cw - 30) // 2)..
-00011c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011ca0: 6966 2069 6d67 7569 2e62 7574 746f 6e28  if imgui.button(
-00011cb0: 222b 222c 2033 302c 2031 3829 3a0d 0a20  "+", 30, 18):.. 
-00011cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011bd0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00011be0: 6d67 7569 2e70 7573 685f 7374 796c 655f  mgui.push_style_
+00011bf0: 7661 7228 696d 6775 692e 5354 594c 455f  var(imgui.STYLE_
+00011c00: 4652 414d 455f 5041 4444 494e 472c 2028  FRAME_PADDING, (
+00011c10: 332c 2030 2929 0d0a 2020 2020 2020 2020  3, 0))..        
+00011c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011c30: 2020 2020 2020 2020 696d 6775 692e 7365          imgui.se
+00011c40: 745f 6e65 7874 5f69 7465 6d5f 7769 6474  t_next_item_widt
+00011c50: 6828 6377 290d 0a20 2020 2020 2020 2020  h(cw)..         
+00011c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011c70: 2020 2020 2020 205f 2c20 696e 7465 7261         _, intera
+00011c80: 6374 696f 6e2e 7261 6469 7573 203d 2069  ction.radius = i
+00011c90: 6d67 7569 2e73 6c69 6465 725f 666c 6f61  mgui.slider_floa
+00011ca0: 7428 2223 2372 6164 6975 7322 2c20 696e  t("##radius", in
+00011cb0: 7465 7261 6374 696f 6e2e 7261 6469 7573  teraction.radius
+00011cc0: 2c20 302e 302c 2033 302e 302c 0d0a 2020  , 0.0, 30.0,..  
 00011cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011ce0: 2020 206d 2e69 6e74 6572 6163 7469 6f6e     m.interaction
-00011cf0: 732e 6170 7065 6e64 284d 6f64 656c 496e  s.append(ModelIn
-00011d00: 7465 7261 6374 696f 6e28 6d2c 2061 7661  teraction(m, ava
-00011d10: 696c 6162 6c65 5f70 6172 746e 6572 5f6d  ilable_partner_m
-00011d20: 6f64 656c 735b 305d 2929 0d0a 0d0a 0d0a  odels[0]))......
-00011d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011d40: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
-00011d50: 692e 706f 705f 7374 796c 655f 7661 7228  i.pop_style_var(
-00011d60: 3529 0d0a 2020 2020 2020 2020 2020 2020  5)..            
+00011ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011d10: 2020 2020 2020 2020 2066 2272 6164 6975           f"radiu
+00011d20: 7320 3d20 7b69 6e74 6572 6163 7469 6f6e  s = {interaction
+00011d30: 2e72 6164 6975 733a 2e31 667d 206e 6d22  .radius:.1f} nm"
+00011d40: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00011d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011d60: 2020 2069 6620 5f3a 0d0a 2020 2020 2020     if _:..      
 00011d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011d80: 696d 6775 692e 706f 705f 7374 796c 655f  imgui.pop_style_
-00011d90: 636f 6c6f 7228 3129 0d0a 2020 2020 2020  color(1)..      
-00011da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011db0: 2020 2020 2020 696d 6775 692e 656e 645f        imgui.end_
-00011dc0: 7461 625f 6974 656d 2829 0d0a 2020 2020  tab_item()..    
-00011dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011de0: 2020 2020 696d 6775 692e 656e 645f 7461      imgui.end_ta
-00011df0: 625f 6261 7228 290d 0a0d 0a20 2020 2020  b_bar()....     
-00011e00: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00011e10: 6620 6d2e 6261 636b 6772 6f75 6e64 5f70  f m.background_p
-00011e20: 726f 6365 7373 5f74 7261 696e 2069 7320  rocess_train is 
-00011e30: 6e6f 7420 4e6f 6e65 3a0d 0a20 2020 2020  not None:..     
-00011e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011e50: 2020 2073 656c 662e 5f67 7569 5f62 6163     self._gui_bac
-00011e60: 6b67 726f 756e 645f 7072 6f63 6573 735f  kground_process_
-00011e70: 7072 6f67 7265 7373 5f62 6172 286d 2e62  progress_bar(m.b
-00011e80: 6163 6b67 726f 756e 645f 7072 6f63 6573  ackground_proces
-00011e90: 735f 7472 6169 6e29 0d0a 2020 2020 2020  s_train)..      
-00011ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011eb0: 2020 6966 206d 2e62 6163 6b67 726f 756e    if m.backgroun
-00011ec0: 645f 7072 6f63 6573 735f 7472 6169 6e2e  d_process_train.
-00011ed0: 7072 6f67 7265 7373 203e 3d20 312e 303a  progress >= 1.0:
-00011ee0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00011ef0: 2020 2020 2020 2020 2020 2020 2020 6d2e                m.
-00011f00: 6261 636b 6772 6f75 6e64 5f70 726f 6365  background_proce
-00011f10: 7373 5f74 7261 696e 203d 204e 6f6e 650d  ss_train = None.
-00011f20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00011f30: 2020 2020 2069 6620 6d2e 6261 636b 6772       if m.backgr
-00011f40: 6f75 6e64 5f70 726f 6365 7373 5f61 7070  ound_process_app
-00011f50: 6c79 2069 7320 6e6f 7420 4e6f 6e65 3a0d  ly is not None:.
-00011f60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00011f70: 2020 2020 2020 2020 2073 656c 662e 5f67           self._g
-00011f80: 7569 5f62 6163 6b67 726f 756e 645f 7072  ui_background_pr
-00011f90: 6f63 6573 735f 7072 6f67 7265 7373 5f62  ocess_progress_b
-00011fa0: 6172 286d 2e62 6163 6b67 726f 756e 645f  ar(m.background_
-00011fb0: 7072 6f63 6573 735f 6170 706c 7929 0d0a  process_apply)..
-00011fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011fd0: 2020 2020 2020 2020 6966 206d 2e62 6163          if m.bac
-00011fe0: 6b67 726f 756e 645f 7072 6f63 6573 735f  kground_process_
-00011ff0: 6170 706c 792e 7072 6f67 7265 7373 203e  apply.progress >
-00012000: 3d20 312e 303a 0d0a 2020 2020 2020 2020  = 1.0:..        
-00012010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012020: 2020 2020 6d2e 6261 636b 6772 6f75 6e64      m.background
-00012030: 5f70 726f 6365 7373 5f61 7070 6c79 203d  _process_apply =
-00012040: 204e 6f6e 650d 0a0d 0a20 2020 2020 2020   None....       
-00012050: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00012060: 696d 6775 692e 6973 5f77 696e 646f 775f  imgui.is_window_
-00012070: 686f 7665 7265 6428 2920 616e 6420 696d  hovered() and im
-00012080: 6775 692e 6973 5f6d 6f75 7365 5f63 6c69  gui.is_mouse_cli
-00012090: 636b 6564 2830 293a 0d0a 2020 2020 2020  cked(0):..      
-000120a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000120b0: 2020 6366 672e 7365 5f61 6374 6976 655f    cfg.se_active_
-000120c0: 6d6f 6465 6c20 3d20 6d0d 0a0d 0a0d 0a20  model = m...... 
-000120d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000120e0: 2020 2069 6d67 7569 2e65 6e64 5f63 6869     imgui.end_chi
-000120f0: 6c64 2829 0d0a 2020 2020 2020 2020 2020  ld()..          
-00012100: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
-00012110: 706f 705f 6964 2829 0d0a 2020 2020 2020  pop_id()..      
-00012120: 2020 2020 2020 2020 2020 6377 203d 2069            cw = i
-00012130: 6d67 7569 2e67 6574 5f63 6f6e 7465 6e74  mgui.get_content
-00012140: 5f72 6567 696f 6e5f 6176 6169 6c61 626c  _region_availabl
-00012150: 655f 7769 6474 6828 290d 0a20 2020 2020  e_width()..     
-00012160: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
-00012170: 2e6e 6577 5f6c 696e 6528 290d 0a20 2020  .new_line()..   
+00011d80: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00011d90: 2063 6667 2e73 655f 6163 7469 7665 5f66   cfg.se_active_f
+00011da0: 7261 6d65 2069 7320 6e6f 7420 4e6f 6e65  rame is not None
+00011db0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00011dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011dd0: 2020 2020 2020 2020 2020 2063 6667 2e73             cfg.s
+00011de0: 655f 6163 7469 7665 5f66 7261 6d65 2e73  e_active_frame.s
+00011df0: 6c69 6365 5f63 6861 6e67 6564 203d 2054  lice_changed = T
+00011e00: 7275 650d 0a20 2020 2020 2020 2020 2020  rue..           
+00011e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011e20: 2020 2020 2069 6d67 7569 2e73 6574 5f6e       imgui.set_n
+00011e30: 6578 745f 6974 656d 5f77 6964 7468 2863  ext_item_width(c
+00011e40: 7729 0d0a 2020 2020 2020 2020 2020 2020  w)..            
+00011e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011e60: 2020 2020 5f2c 2069 6e74 6572 6163 7469      _, interacti
+00011e70: 6f6e 2e74 6872 6573 686f 6c64 203d 2069  on.threshold = i
+00011e80: 6d67 7569 2e73 6c69 6465 725f 666c 6f61  mgui.slider_floa
+00011e90: 7428 2223 2374 6872 6573 686f 6c64 222c  t("##threshold",
+00011ea0: 2069 6e74 6572 6163 7469 6f6e 2e74 6872   interaction.thr
+00011eb0: 6573 686f 6c64 2c20 302e 302c 2031 2e30  eshold, 0.0, 1.0
+00011ec0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00011ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011f00: 2020 2020 2020 2020 2020 2020 2020 6622                f"
+00011f10: 7b69 6e74 6572 6163 7469 6f6e 2e70 6172  {interaction.par
+00011f20: 746e 6572 2e74 6974 6c65 7d20 7468 7265  tner.title} thre
+00011f30: 7368 6f6c 6420 3d20 7b69 6e74 6572 6163  shold = {interac
+00011f40: 7469 6f6e 2e74 6872 6573 686f 6c64 3a2e  tion.threshold:.
+00011f50: 3266 7d22 290d 0a20 2020 2020 2020 2020  2f}")..         
+00011f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011f70: 2020 2020 2020 2069 6620 5f3a 0d0a 2020         if _:..  
+00011f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011fa0: 2020 696e 7465 7261 6374 696f 6e2e 7061    interaction.pa
+00011fb0: 7274 6e65 722e 7468 7265 7368 6f6c 6420  rtner.threshold 
+00011fc0: 3d20 696e 7465 7261 6374 696f 6e2e 7468  = interaction.th
+00011fd0: 7265 7368 6f6c 640d 0a20 2020 2020 2020  reshold..       
+00011fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011ff0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00012000: 6366 672e 7365 5f61 6374 6976 655f 6672  cfg.se_active_fr
+00012010: 616d 6520 6973 206e 6f74 204e 6f6e 653a  ame is not None:
+00012020: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00012030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012040: 2020 2020 2020 2020 2020 6366 672e 7365            cfg.se
+00012050: 5f61 6374 6976 655f 6672 616d 652e 736c  _active_frame.sl
+00012060: 6963 655f 6368 616e 6765 6420 3d20 5472  ice_changed = Tr
+00012070: 7565 0d0a 2020 2020 2020 2020 2020 2020  ue..            
+00012080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012090: 2020 2020 7365 6c66 2e74 6f6f 6c74 6970      self.tooltip
+000120a0: 2822 4265 666f 7265 2061 7070 6c79 696e  ("Before applyin
+000120b0: 6720 696e 7465 7261 6374 696f 6e73 2c20  g interactions, 
+000120c0: 7468 6520 7061 7274 6e65 7220 6d6f 6465  the partner mode
+000120d0: 6c27 7320 7365 676d 656e 7461 7469 6f6e  l's segmentation
+000120e0: 2069 7320 7468 7265 7368 6f6c 6465 6420   is thresholded 
+000120f0: 6174 2074 6869 7320 7661 6c75 652e 2229  at this value.")
+00012100: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00012110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012120: 2020 696d 6775 692e 706f 705f 7374 796c    imgui.pop_styl
+00012130: 655f 7661 7228 3129 0d0a 2020 2020 2020  e_var(1)..      
+00012140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012150: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
+00012160: 7365 7061 7261 746f 7228 290d 0a20 2020  separator()..   
+00012170: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00012180: 2020 2020 2020 2020 2020 2020 2069 6d67               img
-00012190: 7569 2e73 616d 655f 6c69 6e65 2873 7061  ui.same_line(spa
-000121a0: 6369 6e67 3d28 6377 202d 2031 3230 2920  cing=(cw - 120) 
-000121b0: 2f20 3229 0d0a 2020 2020 2020 2020 2020  / 2)..          
-000121c0: 2020 2020 2020 696d 6775 692e 7075 7368        imgui.push
-000121d0: 5f73 7479 6c65 5f76 6172 2869 6d67 7569  _style_var(imgui
-000121e0: 2e53 5459 4c45 5f46 5241 4d45 5f52 4f55  .STYLE_FRAME_ROU
-000121f0: 4e44 494e 472c 2031 3029 0d0a 2020 2020  NDING, 10)..    
-00012200: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
-00012210: 692e 7075 7368 5f73 7479 6c65 5f76 6172  i.push_style_var
-00012220: 2869 6d67 7569 2e53 5459 4c45 5f47 5241  (imgui.STYLE_GRA
-00012230: 425f 524f 554e 4449 4e47 2c20 3230 290d  B_ROUNDING, 20).
-00012240: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012250: 2069 6d67 7569 2e70 7573 685f 7374 796c   imgui.push_styl
-00012260: 655f 7661 7228 696d 6775 692e 5354 594c  e_var(imgui.STYL
-00012270: 455f 4652 414d 455f 424f 5244 4552 5349  E_FRAME_BORDERSI
-00012280: 5a45 2c20 3129 0d0a 2020 2020 2020 2020  ZE, 1)..        
-00012290: 2020 2020 2020 2020 6966 2069 6d67 7569          if imgui
-000122a0: 2e62 7574 746f 6e28 2241 6464 206d 6f64  .button("Add mod
-000122b0: 656c 222c 2031 3230 2c20 3233 293a 0d0a  el", 120, 23):..
-000122c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000122d0: 2020 2020 6366 672e 7365 5f6d 6f64 656c      cfg.se_model
-000122e0: 732e 6170 7065 6e64 2853 454d 6f64 656c  s.append(SEModel
-000122f0: 2829 290d 0a20 2020 2020 2020 2020 2020  ())..           
-00012300: 2020 2020 2069 6d67 7569 2e70 6f70 5f73       imgui.pop_s
-00012310: 7479 6c65 5f76 6172 2833 290d 0a0d 0a20  tyle_var(3).... 
-00012320: 2020 2020 2020 2064 6566 2065 7870 6f72         def expor
-00012330: 745f 7461 6228 293a 0d0a 2020 2020 2020  t_tab():..      
-00012340: 2020 2020 2020 6966 2069 6d67 7569 2e63        if imgui.c
-00012350: 6f6c 6c61 7073 696e 675f 6865 6164 6572  ollapsing_header
-00012360: 2822 4578 706f 7274 2076 6f6c 756d 6573  ("Export volumes
-00012370: 222c 204e 6f6e 652c 2069 6d67 7569 2e54  ", None, imgui.T
-00012380: 5245 455f 4e4f 4445 5f44 4546 4155 4c54  REE_NODE_DEFAULT
-00012390: 5f4f 5045 4e29 5b30 5d3a 0d0a 2020 2020  _OPEN)[0]:..    
-000123a0: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
-000123b0: 692e 7075 7368 5f73 7479 6c65 5f76 6172  i.push_style_var
-000123c0: 2869 6d67 7569 2e53 5459 4c45 5f46 5241  (imgui.STYLE_FRA
-000123d0: 4d45 5f52 4f55 4e44 494e 472c 2031 3029  ME_ROUNDING, 10)
-000123e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000123f0: 2020 696d 6775 692e 7075 7368 5f73 7479    imgui.push_sty
-00012400: 6c65 5f76 6172 2869 6d67 7569 2e53 5459  le_var(imgui.STY
-00012410: 4c45 5f46 5241 4d45 5f42 4f52 4445 5253  LE_FRAME_BORDERS
-00012420: 495a 452c 2031 290d 0a20 2020 2020 2020  IZE, 1)..       
-00012430: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
-00012440: 7573 685f 7374 796c 655f 7661 7228 696d  ush_style_var(im
-00012450: 6775 692e 5354 594c 455f 4652 414d 455f  gui.STYLE_FRAME_
-00012460: 5041 4444 494e 472c 2028 302c 2030 2929  PADDING, (0, 0))
-00012470: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00012480: 2020 696d 6775 692e 7465 7874 2822 4d6f    imgui.text("Mo
-00012490: 6465 6c73 2074 6f20 696e 636c 7564 6522  dels to include"
-000124a0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-000124b0: 2020 206e 5f61 7661 696c 6162 6c65 5f6d     n_available_m
-000124c0: 6f64 656c 7320 3d20 7375 6d28 5b6d 2e63  odels = sum([m.c
-000124d0: 6f6d 7069 6c65 6420 666f 7220 6d20 696e  ompiled for m in
-000124e0: 2063 6667 2e73 655f 6d6f 6465 6c73 5d29   cfg.se_models])
-000124f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00012500: 2020 635f 6865 6967 6874 203d 2028 3120    c_height = (1 
-00012510: 6966 206e 5f61 7661 696c 6162 6c65 5f6d  if n_available_m
-00012520: 6f64 656c 7320 3d3d 2030 2065 6c73 6520  odels == 0 else 
-00012530: 3929 202b 206e 5f61 7661 696c 6162 6c65  9) + n_available
-00012540: 5f6d 6f64 656c 7320 2a20 3231 0d0a 2020  _models * 21..  
-00012550: 2020 2020 2020 2020 2020 2020 2020 696d                im
-00012560: 6775 692e 6265 6769 6e5f 6368 696c 6428  gui.begin_child(
-00012570: 226d 6f64 656c 735f 696e 636c 7564 6564  "models_included
-00012580: 222c 2030 2e30 2c20 635f 6865 6967 6874  ", 0.0, c_height
-00012590: 2c20 5472 7565 290d 0a20 2020 2020 2020  , True)..       
-000125a0: 2020 2020 2020 2020 2066 6f72 206d 2069           for m i
-000125b0: 6e20 6366 672e 7365 5f6d 6f64 656c 733a  n cfg.se_models:
-000125c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000125d0: 2020 2020 2020 6966 206e 6f74 206d 2e63        if not m.c
-000125e0: 6f6d 7069 6c65 643a 0d0a 2020 2020 2020  ompiled:..      
-000125f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012600: 2020 636f 6e74 696e 7565 0d0a 2020 2020    continue..    
-00012610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012620: 696d 6775 692e 7075 7368 5f73 7479 6c65  imgui.push_style
-00012630: 5f63 6f6c 6f72 2869 6d67 7569 2e43 4f4c  _color(imgui.COL
-00012640: 4f52 5f46 5241 4d45 5f42 4143 4b47 524f  OR_FRAME_BACKGRO
-00012650: 554e 442c 202a 6d2e 636f 6c6f 7572 290d  UND, *m.colour).
-00012660: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012670: 2020 2020 2069 6d67 7569 2e70 7573 685f       imgui.push_
-00012680: 7374 796c 655f 636f 6c6f 7228 696d 6775  style_color(imgu
-00012690: 692e 434f 4c4f 525f 4652 414d 455f 4241  i.COLOR_FRAME_BA
-000126a0: 434b 4752 4f55 4e44 5f48 4f56 4552 4544  CKGROUND_HOVERED
-000126b0: 2c20 2a6d 2e63 6f6c 6f75 7229 0d0a 2020  , *m.colour)..  
-000126c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000126d0: 2020 696d 6775 692e 7075 7368 5f73 7479    imgui.push_sty
-000126e0: 6c65 5f63 6f6c 6f72 2869 6d67 7569 2e43  le_color(imgui.C
-000126f0: 4f4c 4f52 5f46 5241 4d45 5f42 4143 4b47  OLOR_FRAME_BACKG
-00012700: 524f 554e 445f 4143 5449 5645 2c20 2a6d  ROUND_ACTIVE, *m
-00012710: 2e63 6f6c 6f75 7229 0d0a 2020 2020 2020  .colour)..      
-00012720: 2020 2020 2020 2020 2020 2020 2020 696d                im
-00012730: 6775 692e 7075 7368 5f73 7479 6c65 5f63  gui.push_style_c
-00012740: 6f6c 6f72 2869 6d67 7569 2e43 4f4c 4f52  olor(imgui.COLOR
-00012750: 5f43 4845 434b 5f4d 4152 4b2c 2030 2e30  _CHECK_MARK, 0.0
-00012760: 2c20 302e 302c 2030 2e30 2c20 312e 3029  , 0.0, 0.0, 1.0)
-00012770: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00012780: 2020 2020 2020 5f2c 206d 2e65 7870 6f72        _, m.expor
-00012790: 7420 3d20 696d 6775 692e 6368 6563 6b62  t = imgui.checkb
-000127a0: 6f78 286d 2e74 6974 6c65 202b 2022 2022  ox(m.title + " "
-000127b0: 202b 206d 2e69 6e66 6f5f 7368 6f72 742c   + m.info_short,
-000127c0: 206d 2e65 7870 6f72 7429 0d0a 2020 2020   m.export)..    
-000127d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000127e0: 6966 205f 3a0d 0a20 2020 2020 2020 2020  if _:..         
-000127f0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00012800: 2e61 6374 6976 6520 3d20 6d2e 6578 706f  .active = m.expo
-00012810: 7274 0d0a 2020 2020 2020 2020 2020 2020  rt..            
-00012820: 2020 2020 2020 2020 2020 2020 6d2e 7368              m.sh
-00012830: 6f77 203d 206d 2e65 7870 6f72 740d 0a20  ow = m.export.. 
-00012840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012850: 2020 2069 6d67 7569 2e70 6f70 5f73 7479     imgui.pop_sty
-00012860: 6c65 5f63 6f6c 6f72 2834 290d 0a20 2020  le_color(4)..   
-00012870: 2020 2020 2020 2020 2020 2020 2069 6d67               img
-00012880: 7569 2e65 6e64 5f63 6869 6c64 2829 0d0a  ui.end_child()..
+00012190: 7569 2e70 6f70 5f69 6428 290d 0a20 2020  ui.pop_id()..   
+000121a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000121b0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+000121c0: 6465 6c65 7465 5f74 6869 735f 696e 7465  delete_this_inte
+000121d0: 723a 0d0a 2020 2020 2020 2020 2020 2020  r:..            
+000121e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000121f0: 2020 2020 2020 2020 6d2e 696e 7465 7261          m.intera
+00012200: 6374 696f 6e73 2e72 656d 6f76 6528 696e  ctions.remove(in
+00012210: 7465 7261 6374 696f 6e29 0d0a 2020 2020  teraction)..    
+00012220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012240: 4d6f 6465 6c49 6e74 6572 6163 7469 6f6e  ModelInteraction
+00012250: 2e61 6c6c 2e72 656d 6f76 6528 696e 7465  .all.remove(inte
+00012260: 7261 6374 696f 6e29 0d0a 0d0a 2020 2020  raction)....    
+00012270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012280: 2020 2020 2020 2020 2320 4164 6420 696e          # Add in
+00012290: 7465 7261 6374 696f 6e0d 0a20 2020 2020  teraction..     
+000122a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000122b0: 2020 2020 2020 2069 6620 6c65 6e28 6176         if len(av
+000122c0: 6169 6c61 626c 655f 7061 7274 6e65 725f  ailable_partner_
+000122d0: 6d6f 6465 6c73 2920 3e3d 2031 3a0d 0a20  models) >= 1:.. 
+000122e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000122f0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00012300: 6d67 7569 2e6e 6577 5f6c 696e 6528 290d  mgui.new_line().
+00012310: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012330: 2069 6d67 7569 2e73 616d 655f 6c69 6e65   imgui.same_line
+00012340: 2873 7061 6369 6e67 203d 2028 6377 202d  (spacing = (cw -
+00012350: 2033 3029 202f 2f20 3229 0d0a 2020 2020   30) // 2)..    
+00012360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012370: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00012380: 6d67 7569 2e62 7574 746f 6e28 222b 222c  mgui.button("+",
+00012390: 2033 302c 2031 3829 3a0d 0a20 2020 2020   30, 18):..     
+000123a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000123b0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+000123c0: 2e69 6e74 6572 6163 7469 6f6e 732e 6170  .interactions.ap
+000123d0: 7065 6e64 284d 6f64 656c 496e 7465 7261  pend(ModelIntera
+000123e0: 6374 696f 6e28 6d2c 2061 7661 696c 6162  ction(m, availab
+000123f0: 6c65 5f70 6172 746e 6572 5f6d 6f64 656c  le_partner_model
+00012400: 735b 305d 2929 0d0a 0d0a 0d0a 2020 2020  s[0]))......    
+00012410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012420: 2020 2020 2020 2020 696d 6775 692e 706f          imgui.po
+00012430: 705f 7374 796c 655f 7661 7228 3529 0d0a  p_style_var(5)..
+00012440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012450: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
+00012460: 692e 706f 705f 7374 796c 655f 636f 6c6f  i.pop_style_colo
+00012470: 7228 3129 0d0a 2020 2020 2020 2020 2020  r(1)..          
+00012480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012490: 2020 696d 6775 692e 656e 645f 7461 625f    imgui.end_tab_
+000124a0: 6974 656d 2829 0d0a 2020 2020 2020 2020  item()..        
+000124b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000124c0: 696d 6775 692e 656e 645f 7461 625f 6261  imgui.end_tab_ba
+000124d0: 7228 290d 0a0d 0a20 2020 2020 2020 2020  r()....         
+000124e0: 2020 2020 2020 2020 2020 2069 6620 6d2e             if m.
+000124f0: 6261 636b 6772 6f75 6e64 5f70 726f 6365  background_proce
+00012500: 7373 5f74 7261 696e 2069 7320 6e6f 7420  ss_train is not 
+00012510: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
+00012520: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00012530: 656c 662e 5f67 7569 5f62 6163 6b67 726f  elf._gui_backgro
+00012540: 756e 645f 7072 6f63 6573 735f 7072 6f67  und_process_prog
+00012550: 7265 7373 5f62 6172 286d 2e62 6163 6b67  ress_bar(m.backg
+00012560: 726f 756e 645f 7072 6f63 6573 735f 7472  round_process_tr
+00012570: 6169 6e29 0d0a 2020 2020 2020 2020 2020  ain)..          
+00012580: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00012590: 206d 2e62 6163 6b67 726f 756e 645f 7072   m.background_pr
+000125a0: 6f63 6573 735f 7472 6169 6e2e 7072 6f67  ocess_train.prog
+000125b0: 7265 7373 203e 3d20 312e 303a 0d0a 2020  ress >= 1.0:..  
+000125c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000125d0: 2020 2020 2020 2020 2020 6d2e 6261 636b            m.back
+000125e0: 6772 6f75 6e64 5f70 726f 6365 7373 5f74  ground_process_t
+000125f0: 7261 696e 203d 204e 6f6e 650d 0a20 2020  rain = None..   
+00012600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012610: 2069 6620 6d2e 6261 636b 6772 6f75 6e64   if m.background
+00012620: 5f70 726f 6365 7373 5f61 7070 6c79 2069  _process_apply i
+00012630: 7320 6e6f 7420 4e6f 6e65 3a0d 0a20 2020  s not None:..   
+00012640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012650: 2020 2020 2073 656c 662e 5f67 7569 5f62       self._gui_b
+00012660: 6163 6b67 726f 756e 645f 7072 6f63 6573  ackground_proces
+00012670: 735f 7072 6f67 7265 7373 5f62 6172 286d  s_progress_bar(m
+00012680: 2e62 6163 6b67 726f 756e 645f 7072 6f63  .background_proc
+00012690: 6573 735f 6170 706c 7929 0d0a 2020 2020  ess_apply)..    
+000126a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000126b0: 2020 2020 6966 206d 2e62 6163 6b67 726f      if m.backgro
+000126c0: 756e 645f 7072 6f63 6573 735f 6170 706c  und_process_appl
+000126d0: 792e 7072 6f67 7265 7373 203e 3d20 312e  y.progress >= 1.
+000126e0: 303a 0d0a 2020 2020 2020 2020 2020 2020  0:..            
+000126f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012700: 6d2e 6261 636b 6772 6f75 6e64 5f70 726f  m.background_pro
+00012710: 6365 7373 5f61 7070 6c79 203d 204e 6f6e  cess_apply = Non
+00012720: 650d 0a0d 0a20 2020 2020 2020 2020 2020  e....           
+00012730: 2020 2020 2020 2020 2069 6620 696d 6775           if imgu
+00012740: 692e 6973 5f77 696e 646f 775f 686f 7665  i.is_window_hove
+00012750: 7265 6428 2920 616e 6420 696d 6775 692e  red() and imgui.
+00012760: 6973 5f6d 6f75 7365 5f63 6c69 636b 6564  is_mouse_clicked
+00012770: 2830 293a 0d0a 2020 2020 2020 2020 2020  (0):..          
+00012780: 2020 2020 2020 2020 2020 2020 2020 6366                cf
+00012790: 672e 7365 5f61 6374 6976 655f 6d6f 6465  g.se_active_mode
+000127a0: 6c20 3d20 6d0d 0a0d 0a0d 0a20 2020 2020  l = m......     
+000127b0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000127c0: 6d67 7569 2e65 6e64 5f63 6869 6c64 2829  mgui.end_child()
+000127d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000127e0: 2020 2020 2020 696d 6775 692e 706f 705f        imgui.pop_
+000127f0: 6964 2829 0d0a 2020 2020 2020 2020 2020  id()..          
+00012800: 2020 2020 2020 6377 203d 2069 6d67 7569        cw = imgui
+00012810: 2e67 6574 5f63 6f6e 7465 6e74 5f72 6567  .get_content_reg
+00012820: 696f 6e5f 6176 6169 6c61 626c 655f 7769  ion_available_wi
+00012830: 6474 6828 290d 0a20 2020 2020 2020 2020  dth()..         
+00012840: 2020 2020 2020 2069 6d67 7569 2e6e 6577         imgui.new
+00012850: 5f6c 696e 6528 290d 0a20 2020 2020 2020  _line()..       
+00012860: 2020 2020 2020 2020 2069 6d67 7569 2e73           imgui.s
+00012870: 616d 655f 6c69 6e65 2873 7061 6369 6e67  ame_line(spacing
+00012880: 3d28 6377 202d 2031 3230 2920 2f20 3229  =(cw - 120) / 2)
 00012890: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000128a0: 2020 696d 6775 692e 7465 7874 2822 4461    imgui.text("Da
-000128b0: 7461 7365 7473 2074 6f20 7072 6f63 6573  tasets to proces
-000128c0: 7322 290d 0a0d 0a20 2020 2020 2020 2020  s")....         
-000128d0: 2020 2020 2020 2069 6d67 7569 2e73 616d         imgui.sam
-000128e0: 655f 6c69 6e65 2873 7061 6369 6e67 3d38  e_line(spacing=8
-000128f0: 3029 0d0a 2020 2020 2020 2020 2020 2020  0)..            
-00012900: 2020 2020 5f2c 2053 6567 6d65 6e74 6174      _, Segmentat
-00012910: 696f 6e45 6469 746f 722e 4441 5441 5345  ionEditor.DATASE
-00012920: 5453 5f45 5850 4f52 545f 5041 4e45 4c5f  TS_EXPORT_PANEL_
-00012930: 4558 5041 4e44 4544 203d 2069 6d67 7569  EXPANDED = imgui
-00012940: 2e63 6865 636b 626f 7828 2265 7870 616e  .checkbox("expan
-00012950: 6422 2c0d 0a20 2020 2020 2020 2020 2020  d",..           
-00012960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000129a0: 2020 2020 2020 2020 2020 2053 6567 6d65             Segme
-000129b0: 6e74 6174 696f 6e45 6469 746f 722e 4441  ntationEditor.DA
-000129c0: 5441 5345 5453 5f45 5850 4f52 545f 5041  TASETS_EXPORT_PA
-000129d0: 4e45 4c5f 4558 5041 4e44 4544 290d 0a20  NEL_EXPANDED).. 
-000129e0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000129f0: 6d67 7569 2e73 616d 655f 6c69 6e65 2873  mgui.same_line(s
-00012a00: 7061 6369 6e67 3d35 290d 0a20 2020 2020  pacing=5)..     
-00012a10: 2020 2020 2020 2020 2020 205f 2c20 5365             _, Se
-00012a20: 676d 656e 7461 7469 6f6e 4564 6974 6f72  gmentationEditor
-00012a30: 2e44 4154 4153 4554 535f 4558 504f 5254  .DATASETS_EXPORT
-00012a40: 5f53 454c 4543 545f 414c 4c20 3d20 696d  _SELECT_ALL = im
-00012a50: 6775 692e 6368 6563 6b62 6f78 2822 616c  gui.checkbox("al
-00012a60: 6c22 2c0d 0a20 2020 2020 2020 2020 2020  l",..           
-00012a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012ab0: 2020 2020 2020 2053 6567 6d65 6e74 6174         Segmentat
-00012ac0: 696f 6e45 6469 746f 722e 4441 5441 5345  ionEditor.DATASE
-00012ad0: 5453 5f45 5850 4f52 545f 5345 4c45 4354  TS_EXPORT_SELECT
-00012ae0: 5f41 4c4c 290d 0a20 2020 2020 2020 2020  _ALL)..         
-00012af0: 2020 2020 2020 2069 6620 5f3a 0d0a 2020         if _:..  
-00012b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012b10: 2020 666f 7220 7320 696e 2063 6667 2e73    for s in cfg.s
-00012b20: 655f 6672 616d 6573 3a0d 0a20 2020 2020  e_frames:..     
-00012b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012b40: 2020 2073 2e65 7870 6f72 7420 3d20 5365     s.export = Se
-00012b50: 676d 656e 7461 7469 6f6e 4564 6974 6f72  gmentationEditor
-00012b60: 2e44 4154 4153 4554 535f 4558 504f 5254  .DATASETS_EXPORT
-00012b70: 5f53 454c 4543 545f 414c 4c0d 0a20 2020  _SELECT_ALL..   
-00012b80: 2020 2020 2020 2020 2020 2020 2069 6d67               img
-00012b90: 7569 2e70 7573 685f 7374 796c 655f 636f  ui.push_style_co
-00012ba0: 6c6f 7228 696d 6775 692e 434f 4c4f 525f  lor(imgui.COLOR_
-00012bb0: 4348 4543 4b5f 4d41 524b 2c20 302e 302c  CHECK_MARK, 0.0,
-00012bc0: 2030 2e30 2c20 302e 302c 2031 2e30 290d   0.0, 0.0, 1.0).
-00012bd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012be0: 2063 5f68 6569 6768 7420 3d20 6d69 6e28   c_height = min(
-00012bf0: 5b31 3230 2c20 2831 2069 6620 6c65 6e28  [120, (1 if len(
-00012c00: 6366 672e 7365 5f66 7261 6d65 7329 203d  cfg.se_frames) =
-00012c10: 3d20 3020 656c 7365 2039 2920 2b20 6c65  = 0 else 9) + le
-00012c20: 6e28 6366 672e 7365 5f66 7261 6d65 7329  n(cfg.se_frames)
-00012c30: 202a 2032 315d 290d 0a20 2020 2020 2020   * 21])..       
-00012c40: 2020 2020 2020 2020 2069 6620 5365 676d           if Segm
-00012c50: 656e 7461 7469 6f6e 4564 6974 6f72 2e44  entationEditor.D
-00012c60: 4154 4153 4554 535f 4558 504f 5254 5f50  ATASETS_EXPORT_P
-00012c70: 414e 454c 5f45 5850 414e 4445 443a 0d0a  ANEL_EXPANDED:..
-00012c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012c90: 2020 2020 635f 6865 6967 6874 203d 2053      c_height = S
-00012ca0: 6567 6d65 6e74 6174 696f 6e45 6469 746f  egmentationEdito
-00012cb0: 722e 4441 5441 5345 5453 5f45 5850 4f52  r.DATASETS_EXPOR
-00012cc0: 545f 5041 4e45 4c5f 4558 5041 4e44 4544  T_PANEL_EXPANDED
-00012cd0: 5f48 4549 4748 540d 0a20 2020 2020 2020  _HEIGHT..       
-00012ce0: 2020 2020 2020 2020 2069 6d67 7569 2e62           imgui.b
-00012cf0: 6567 696e 5f63 6869 6c64 2822 6461 7461  egin_child("data
-00012d00: 7365 7473 5f74 6f5f 7361 6d70 6c65 222c  sets_to_sample",
-00012d10: 2030 2e30 2c20 635f 6865 6967 6874 2c20   0.0, c_height, 
-00012d20: 5472 7565 290d 0a20 2020 2020 2020 2020  True)..         
-00012d30: 2020 2020 2020 2066 6f72 2073 2069 6e20         for s in 
-00012d40: 6366 672e 7365 5f66 7261 6d65 733a 0d0a  cfg.se_frames:..
-00012d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012d60: 2020 2020 696d 6775 692e 7075 7368 5f69      imgui.push_i
-00012d70: 6428 6622 7b73 2e75 6964 7d22 290d 0a20  d(f"{s.uid}").. 
-00012d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012d90: 2020 2069 6620 7320 3d3d 2063 6667 2e73     if s == cfg.s
-00012da0: 655f 6163 7469 7665 5f66 7261 6d65 3a0d  e_active_frame:.
-00012db0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012dc0: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
-00012dd0: 7573 685f 7374 796c 655f 636f 6c6f 7228  ush_style_color(
-00012de0: 696d 6775 692e 434f 4c4f 525f 5445 5854  imgui.COLOR_TEXT
-00012df0: 2c20 2a63 6667 2e43 4f4c 4f55 525f 5445  , *cfg.COLOUR_TE
-00012e00: 5854 5f41 4354 4956 4529 0d0a 2020 2020  XT_ACTIVE)..    
-00012e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012e20: 2020 2020 5f2c 2073 2e65 7870 6f72 7420      _, s.export 
-00012e30: 3d20 696d 6775 692e 6368 6563 6b62 6f78  = imgui.checkbox
-00012e40: 2873 2e74 6974 6c65 2c20 732e 6578 706f  (s.title, s.expo
-00012e50: 7274 290d 0a20 2020 2020 2020 2020 2020  rt)..           
-00012e60: 2020 2020 2020 2020 2020 2020 2069 6d67               img
-00012e70: 7569 2e70 6f70 5f73 7479 6c65 5f63 6f6c  ui.pop_style_col
-00012e80: 6f72 2829 0d0a 2020 2020 2020 2020 2020  or()..          
-00012e90: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
-00012ea0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012eb0: 2020 2020 2020 2020 205f 2c20 732e 6578           _, s.ex
-00012ec0: 706f 7274 203d 2069 6d67 7569 2e63 6865  port = imgui.che
-00012ed0: 636b 626f 7828 732e 7469 746c 652c 2073  ckbox(s.title, s
-00012ee0: 2e65 7870 6f72 7429 0d0a 2020 2020 2020  .export)..      
-00012ef0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00012f00: 205f 3a0d 0a20 2020 2020 2020 2020 2020   _:..           
-00012f10: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00012f20: 662e 7061 7273 655f 6176 6169 6c61 626c  f.parse_availabl
-00012f30: 655f 6665 6174 7572 6573 2829 0d0a 2020  e_features()..  
-00012f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012f50: 2020 696d 6775 692e 706f 705f 6964 2829    imgui.pop_id()
-00012f60: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00012f70: 2020 696d 6775 692e 656e 645f 6368 696c    imgui.end_chil
-00012f80: 6428 290d 0a0d 0a0d 0a20 2020 2020 2020  d()......       
-00012f90: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
-00012fa0: 6f70 5f73 7479 6c65 5f63 6f6c 6f72 2829  op_style_color()
-00012fb0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-00012fc0: 2020 2020 696d 6775 692e 7465 7874 2822      imgui.text("
-00012fd0: 4578 706f 7274 2073 6574 7469 6e67 7322  Export settings"
-00012fe0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00012ff0: 2020 2069 6d67 7569 2e70 7573 685f 7374     imgui.push_st
-00013000: 796c 655f 7661 7228 696d 6775 692e 5354  yle_var(imgui.ST
-00013010: 594c 455f 4752 4142 5f52 4f55 4e44 494e  YLE_GRAB_ROUNDIN
-00013020: 472c 2032 3029 0d0a 2020 2020 2020 2020  G, 20)..        
-00013030: 2020 2020 2020 2020 696d 6775 692e 6265          imgui.be
-00013040: 6769 6e5f 6368 696c 6428 2265 7870 6f72  gin_child("expor
-00013050: 745f 7365 7474 696e 6773 222c 2030 2e30  t_settings", 0.0
-00013060: 2c20 3533 2e30 2c20 5472 7565 290d 0a20  , 53.0, True).. 
-00013070: 2020 2020 2020 2020 2020 2020 2020 205f                 _
-00013080: 2c20 5365 676d 656e 7461 7469 6f6e 4564  , SegmentationEd
-00013090: 6974 6f72 2e65 7870 6f72 745f 6469 7220  itor.export_dir 
-000130a0: 3d20 7769 6467 6574 732e 7365 6c65 6374  = widgets.select
-000130b0: 5f64 6972 6563 746f 7279 2822 6272 6f77  _directory("brow
-000130c0: 7365 222c 2053 6567 6d65 6e74 6174 696f  se", Segmentatio
-000130d0: 6e45 6469 746f 722e 6578 706f 7274 5f64  nEditor.export_d
-000130e0: 6972 290d 0a20 2020 2020 2020 2020 2020  ir)..           
-000130f0: 2020 2020 2069 6d67 7569 2e73 6574 5f6e       imgui.set_n
-00013100: 6578 745f 6974 656d 5f77 6964 7468 2869  ext_item_width(i
-00013110: 6d67 7569 2e67 6574 5f63 6f6e 7465 6e74  mgui.get_content
-00013120: 5f72 6567 696f 6e5f 6176 6169 6c61 626c  _region_availabl
-00013130: 655f 7769 6474 6828 2929 0d0a 2020 2020  e_width())..    
-00013140: 2020 2020 2020 2020 2020 2020 5f2c 2073              _, s
-00013150: 656c 662e 6578 706f 7274 5f6c 696d 6974  elf.export_limit
-00013160: 5f72 616e 6765 203d 2069 6d67 7569 2e63  _range = imgui.c
-00013170: 6865 636b 626f 7828 2220 6c69 6d69 7420  heckbox(" limit 
-00013180: 7261 6e67 6520 222c 2073 656c 662e 6578  range ", self.ex
-00013190: 706f 7274 5f6c 696d 6974 5f72 616e 6765  port_limit_range
-000131a0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-000131b0: 2020 2023 696d 6775 692e 7361 6d65 5f6c     #imgui.same_l
-000131c0: 696e 6528 7370 6163 696e 673d 3632 290d  ine(spacing=62).
-000131d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000131e0: 2023 5f2c 2073 656c 662e 6578 706f 7274   #_, self.export
-000131f0: 5f6f 7665 726c 6179 7320 3d20 696d 6775  _overlays = imgu
-00013200: 692e 6368 6563 6b62 6f78 2822 2065 7870  i.checkbox(" exp
-00013210: 6f72 7420 6f76 6572 6c61 7973 222c 2073  ort overlays", s
-00013220: 656c 662e 6578 706f 7274 5f6f 7665 726c  elf.export_overl
-00013230: 6179 7329 0d0a 2020 2020 2020 2020 2020  ays)..          
-00013240: 2020 2020 2020 696d 6775 692e 656e 645f        imgui.end_
-00013250: 6368 696c 6428 290d 0a0d 0a0d 0a20 2020  child()......   
-00013260: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00013270: 7769 6467 6574 732e 6365 6e74 7265 645f  widgets.centred_
-00013280: 6275 7474 6f6e 2822 5374 6172 7420 6578  button("Start ex
-00013290: 706f 7274 222c 2031 3230 2c20 3233 293a  port", 120, 23):
-000132a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000132b0: 2020 2020 2020 7365 6c66 2e6c 6175 6e63        self.launc
-000132c0: 685f 6578 706f 7274 5f76 6f6c 756d 6573  h_export_volumes
-000132d0: 2829 0d0a 0d0a 2020 2020 2020 2020 2020  ()....          
-000132e0: 2020 2020 2020 2320 6578 706f 7274 2070        # export p
-000132f0: 726f 6772 6573 733a 0d0a 2020 2020 2020  rogress:..      
-00013300: 2020 2020 2020 2020 2020 6966 2053 6567            if Seg
-00013310: 6d65 6e74 6174 696f 6e45 6469 746f 722e  mentationEditor.
-00013320: 7175 6575 6564 5f65 7870 6f72 7473 3a0d  queued_exports:.
-00013330: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013340: 2020 2020 2071 6520 3d20 5365 676d 656e       qe = Segmen
-00013350: 7461 7469 6f6e 4564 6974 6f72 2e71 7565  tationEditor.que
-00013360: 7565 645f 6578 706f 7274 735b 305d 0d0a  ued_exports[0]..
-00013370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013380: 2020 2020 696d 6775 692e 7370 6163 696e      imgui.spacin
-00013390: 6728 290d 0a20 2020 2020 2020 2020 2020  g()..           
-000133a0: 2020 2020 2020 2020 2069 6620 6973 696e           if isin
-000133b0: 7374 616e 6365 2871 652c 2051 7565 7565  stance(qe, Queue
-000133c0: 6445 7870 6f72 7429 3a0d 0a20 2020 2020  dExport):..     
-000133d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000133e0: 2020 2069 6d67 7569 2e74 6578 7428 6622     imgui.text(f"
-000133f0: 5072 6f63 6573 7369 6e67 2027 7b71 652e  Processing '{qe.
-00013400: 6461 7461 7365 742e 7469 746c 657d 273a  dataset.title}':
-00013410: 2229 0d0a 2020 2020 2020 2020 2020 2020  ")..            
-00013420: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+000128a0: 2020 696d 6775 692e 7075 7368 5f73 7479    imgui.push_sty
+000128b0: 6c65 5f76 6172 2869 6d67 7569 2e53 5459  le_var(imgui.STY
+000128c0: 4c45 5f46 5241 4d45 5f52 4f55 4e44 494e  LE_FRAME_ROUNDIN
+000128d0: 472c 2031 3029 0d0a 2020 2020 2020 2020  G, 10)..        
+000128e0: 2020 2020 2020 2020 696d 6775 692e 7075          imgui.pu
+000128f0: 7368 5f73 7479 6c65 5f76 6172 2869 6d67  sh_style_var(img
+00012900: 7569 2e53 5459 4c45 5f47 5241 425f 524f  ui.STYLE_GRAB_RO
+00012910: 554e 4449 4e47 2c20 3230 290d 0a20 2020  UNDING, 20)..   
+00012920: 2020 2020 2020 2020 2020 2020 2069 6d67               img
+00012930: 7569 2e70 7573 685f 7374 796c 655f 7661  ui.push_style_va
+00012940: 7228 696d 6775 692e 5354 594c 455f 4652  r(imgui.STYLE_FR
+00012950: 414d 455f 424f 5244 4552 5349 5a45 2c20  AME_BORDERSIZE, 
+00012960: 3129 0d0a 2020 2020 2020 2020 2020 2020  1)..            
+00012970: 2020 2020 6966 2069 6d67 7569 2e62 7574      if imgui.but
+00012980: 746f 6e28 2241 6464 206d 6f64 656c 222c  ton("Add model",
+00012990: 2031 3230 2c20 3233 293a 0d0a 2020 2020   120, 23):..    
+000129a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000129b0: 6366 672e 7365 5f6d 6f64 656c 732e 6170  cfg.se_models.ap
+000129c0: 7065 6e64 2853 454d 6f64 656c 2829 290d  pend(SEModel()).
+000129d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000129e0: 2069 6d67 7569 2e70 6f70 5f73 7479 6c65   imgui.pop_style
+000129f0: 5f76 6172 2833 290d 0a0d 0a20 2020 2020  _var(3)....     
+00012a00: 2020 2064 6566 2065 7870 6f72 745f 7461     def export_ta
+00012a10: 6228 293a 0d0a 2020 2020 2020 2020 2020  b():..          
+00012a20: 2020 6966 2069 6d67 7569 2e63 6f6c 6c61    if imgui.colla
+00012a30: 7073 696e 675f 6865 6164 6572 2822 4578  psing_header("Ex
+00012a40: 706f 7274 2076 6f6c 756d 6573 222c 204e  port volumes", N
+00012a50: 6f6e 652c 2069 6d67 7569 2e54 5245 455f  one, imgui.TREE_
+00012a60: 4e4f 4445 5f44 4546 4155 4c54 5f4f 5045  NODE_DEFAULT_OPE
+00012a70: 4e29 5b30 5d3a 0d0a 2020 2020 2020 2020  N)[0]:..        
+00012a80: 2020 2020 2020 2020 696d 6775 692e 7075          imgui.pu
+00012a90: 7368 5f73 7479 6c65 5f76 6172 2869 6d67  sh_style_var(img
+00012aa0: 7569 2e53 5459 4c45 5f46 5241 4d45 5f52  ui.STYLE_FRAME_R
+00012ab0: 4f55 4e44 494e 472c 2031 3029 0d0a 2020  OUNDING, 10)..  
+00012ac0: 2020 2020 2020 2020 2020 2020 2020 696d                im
+00012ad0: 6775 692e 7075 7368 5f73 7479 6c65 5f76  gui.push_style_v
+00012ae0: 6172 2869 6d67 7569 2e53 5459 4c45 5f46  ar(imgui.STYLE_F
+00012af0: 5241 4d45 5f42 4f52 4445 5253 495a 452c  RAME_BORDERSIZE,
+00012b00: 2031 290d 0a20 2020 2020 2020 2020 2020   1)..           
+00012b10: 2020 2020 2069 6d67 7569 2e70 7573 685f       imgui.push_
+00012b20: 7374 796c 655f 7661 7228 696d 6775 692e  style_var(imgui.
+00012b30: 5354 594c 455f 4652 414d 455f 5041 4444  STYLE_FRAME_PADD
+00012b40: 494e 472c 2028 302c 2030 2929 0d0a 2020  ING, (0, 0))..  
+00012b50: 2020 2020 2020 2020 2020 2020 2020 696d                im
+00012b60: 6775 692e 7465 7874 2822 4d6f 6465 6c73  gui.text("Models
+00012b70: 2074 6f20 696e 636c 7564 6522 290d 0a20   to include").. 
+00012b80: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00012b90: 5f61 7661 696c 6162 6c65 5f6d 6f64 656c  _available_model
+00012ba0: 7320 3d20 7375 6d28 5b6d 2e63 6f6d 7069  s = sum([m.compi
+00012bb0: 6c65 6420 666f 7220 6d20 696e 2063 6667  led for m in cfg
+00012bc0: 2e73 655f 6d6f 6465 6c73 5d29 0d0a 2020  .se_models])..  
+00012bd0: 2020 2020 2020 2020 2020 2020 2020 635f                c_
+00012be0: 6865 6967 6874 203d 2028 3120 6966 206e  height = (1 if n
+00012bf0: 5f61 7661 696c 6162 6c65 5f6d 6f64 656c  _available_model
+00012c00: 7320 3d3d 2030 2065 6c73 6520 3929 202b  s == 0 else 9) +
+00012c10: 206e 5f61 7661 696c 6162 6c65 5f6d 6f64   n_available_mod
+00012c20: 656c 7320 2a20 3231 0d0a 2020 2020 2020  els * 21..      
+00012c30: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
+00012c40: 6265 6769 6e5f 6368 696c 6428 226d 6f64  begin_child("mod
+00012c50: 656c 735f 696e 636c 7564 6564 222c 2030  els_included", 0
+00012c60: 2e30 2c20 635f 6865 6967 6874 2c20 5472  .0, c_height, Tr
+00012c70: 7565 290d 0a20 2020 2020 2020 2020 2020  ue)..           
+00012c80: 2020 2020 2066 6f72 206d 2069 6e20 6366       for m in cf
+00012c90: 672e 7365 5f6d 6f64 656c 733a 0d0a 2020  g.se_models:..  
+00012ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012cb0: 2020 6966 206e 6f74 206d 2e63 6f6d 7069    if not m.compi
+00012cc0: 6c65 643a 0d0a 2020 2020 2020 2020 2020  led:..          
+00012cd0: 2020 2020 2020 2020 2020 2020 2020 636f                co
+00012ce0: 6e74 696e 7565 0d0a 2020 2020 2020 2020  ntinue..        
+00012cf0: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
+00012d00: 692e 7075 7368 5f73 7479 6c65 5f63 6f6c  i.push_style_col
+00012d10: 6f72 2869 6d67 7569 2e43 4f4c 4f52 5f46  or(imgui.COLOR_F
+00012d20: 5241 4d45 5f42 4143 4b47 524f 554e 442c  RAME_BACKGROUND,
+00012d30: 202a 6d2e 636f 6c6f 7572 290d 0a20 2020   *m.colour)..   
+00012d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012d50: 2069 6d67 7569 2e70 7573 685f 7374 796c   imgui.push_styl
+00012d60: 655f 636f 6c6f 7228 696d 6775 692e 434f  e_color(imgui.CO
+00012d70: 4c4f 525f 4652 414d 455f 4241 434b 4752  LOR_FRAME_BACKGR
+00012d80: 4f55 4e44 5f48 4f56 4552 4544 2c20 2a6d  OUND_HOVERED, *m
+00012d90: 2e63 6f6c 6f75 7229 0d0a 2020 2020 2020  .colour)..      
+00012da0: 2020 2020 2020 2020 2020 2020 2020 696d                im
+00012db0: 6775 692e 7075 7368 5f73 7479 6c65 5f63  gui.push_style_c
+00012dc0: 6f6c 6f72 2869 6d67 7569 2e43 4f4c 4f52  olor(imgui.COLOR
+00012dd0: 5f46 5241 4d45 5f42 4143 4b47 524f 554e  _FRAME_BACKGROUN
+00012de0: 445f 4143 5449 5645 2c20 2a6d 2e63 6f6c  D_ACTIVE, *m.col
+00012df0: 6f75 7229 0d0a 2020 2020 2020 2020 2020  our)..          
+00012e00: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
+00012e10: 7075 7368 5f73 7479 6c65 5f63 6f6c 6f72  push_style_color
+00012e20: 2869 6d67 7569 2e43 4f4c 4f52 5f43 4845  (imgui.COLOR_CHE
+00012e30: 434b 5f4d 4152 4b2c 2030 2e30 2c20 302e  CK_MARK, 0.0, 0.
+00012e40: 302c 2030 2e30 2c20 312e 3029 0d0a 2020  0, 0.0, 1.0)..  
+00012e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012e60: 2020 5f2c 206d 2e65 7870 6f72 7420 3d20    _, m.export = 
+00012e70: 696d 6775 692e 6368 6563 6b62 6f78 286d  imgui.checkbox(m
+00012e80: 2e74 6974 6c65 202b 2022 2022 202b 206d  .title + " " + m
+00012e90: 2e69 6e66 6f5f 7368 6f72 742c 206d 2e65  .info_short, m.e
+00012ea0: 7870 6f72 7429 0d0a 2020 2020 2020 2020  xport)..        
+00012eb0: 2020 2020 2020 2020 2020 2020 6966 205f              if _
+00012ec0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00012ed0: 2020 2020 2020 2020 2020 206d 2e61 6374             m.act
+00012ee0: 6976 6520 3d20 6d2e 6578 706f 7274 0d0a  ive = m.export..
+00012ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012f00: 2020 2020 2020 2020 6d2e 7368 6f77 203d          m.show =
+00012f10: 206d 2e65 7870 6f72 740d 0a20 2020 2020   m.export..     
+00012f20: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00012f30: 6d67 7569 2e70 6f70 5f73 7479 6c65 5f63  mgui.pop_style_c
+00012f40: 6f6c 6f72 2834 290d 0a20 2020 2020 2020  olor(4)..       
+00012f50: 2020 2020 2020 2020 2069 6d67 7569 2e65           imgui.e
+00012f60: 6e64 5f63 6869 6c64 2829 0d0a 0d0a 2020  nd_child()....  
+00012f70: 2020 2020 2020 2020 2020 2020 2020 696d                im
+00012f80: 6775 692e 7465 7874 2822 4461 7461 7365  gui.text("Datase
+00012f90: 7473 2074 6f20 7072 6f63 6573 7322 290d  ts to process").
+00012fa0: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+00012fb0: 2020 2069 6d67 7569 2e73 616d 655f 6c69     imgui.same_li
+00012fc0: 6e65 2873 7061 6369 6e67 3d38 3029 0d0a  ne(spacing=80)..
+00012fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012fe0: 5f2c 2053 6567 6d65 6e74 6174 696f 6e45  _, SegmentationE
+00012ff0: 6469 746f 722e 4441 5441 5345 5453 5f45  ditor.DATASETS_E
+00013000: 5850 4f52 545f 5041 4e45 4c5f 4558 5041  XPORT_PANEL_EXPA
+00013010: 4e44 4544 203d 2069 6d67 7569 2e63 6865  NDED = imgui.che
+00013020: 636b 626f 7828 2265 7870 616e 6422 2c0d  ckbox("expand",.
+00013030: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013080: 2020 2020 2020 2053 6567 6d65 6e74 6174         Segmentat
+00013090: 696f 6e45 6469 746f 722e 4441 5441 5345  ionEditor.DATASE
+000130a0: 5453 5f45 5850 4f52 545f 5041 4e45 4c5f  TS_EXPORT_PANEL_
+000130b0: 4558 5041 4e44 4544 290d 0a20 2020 2020  EXPANDED)..     
+000130c0: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
+000130d0: 2e73 616d 655f 6c69 6e65 2873 7061 6369  .same_line(spaci
+000130e0: 6e67 3d35 290d 0a20 2020 2020 2020 2020  ng=5)..         
+000130f0: 2020 2020 2020 205f 2c20 5365 676d 656e         _, Segmen
+00013100: 7461 7469 6f6e 4564 6974 6f72 2e44 4154  tationEditor.DAT
+00013110: 4153 4554 535f 4558 504f 5254 5f53 454c  ASETS_EXPORT_SEL
+00013120: 4543 545f 414c 4c20 3d20 696d 6775 692e  ECT_ALL = imgui.
+00013130: 6368 6563 6b62 6f78 2822 616c 6c22 2c0d  checkbox("all",.
+00013140: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013190: 2020 2053 6567 6d65 6e74 6174 696f 6e45     SegmentationE
+000131a0: 6469 746f 722e 4441 5441 5345 5453 5f45  ditor.DATASETS_E
+000131b0: 5850 4f52 545f 5345 4c45 4354 5f41 4c4c  XPORT_SELECT_ALL
+000131c0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+000131d0: 2020 2069 6620 5f3a 0d0a 2020 2020 2020     if _:..      
+000131e0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+000131f0: 7220 7320 696e 2063 6667 2e73 655f 6672  r s in cfg.se_fr
+00013200: 616d 6573 3a0d 0a20 2020 2020 2020 2020  ames:..         
+00013210: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00013220: 2e65 7870 6f72 7420 3d20 5365 676d 656e  .export = Segmen
+00013230: 7461 7469 6f6e 4564 6974 6f72 2e44 4154  tationEditor.DAT
+00013240: 4153 4554 535f 4558 504f 5254 5f53 454c  ASETS_EXPORT_SEL
+00013250: 4543 545f 414c 4c0d 0a20 2020 2020 2020  ECT_ALL..       
+00013260: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
+00013270: 7573 685f 7374 796c 655f 636f 6c6f 7228  ush_style_color(
+00013280: 696d 6775 692e 434f 4c4f 525f 4348 4543  imgui.COLOR_CHEC
+00013290: 4b5f 4d41 524b 2c20 302e 302c 2030 2e30  K_MARK, 0.0, 0.0
+000132a0: 2c20 302e 302c 2031 2e30 290d 0a20 2020  , 0.0, 1.0)..   
+000132b0: 2020 2020 2020 2020 2020 2020 2063 5f68               c_h
+000132c0: 6569 6768 7420 3d20 6d69 6e28 5b31 3230  eight = min([120
+000132d0: 2c20 2831 2069 6620 6c65 6e28 6366 672e  , (1 if len(cfg.
+000132e0: 7365 5f66 7261 6d65 7329 203d 3d20 3020  se_frames) == 0 
+000132f0: 656c 7365 2039 2920 2b20 6c65 6e28 6366  else 9) + len(cf
+00013300: 672e 7365 5f66 7261 6d65 7329 202a 2032  g.se_frames) * 2
+00013310: 315d 290d 0a20 2020 2020 2020 2020 2020  1])..           
+00013320: 2020 2020 2069 6620 5365 676d 656e 7461       if Segmenta
+00013330: 7469 6f6e 4564 6974 6f72 2e44 4154 4153  tionEditor.DATAS
+00013340: 4554 535f 4558 504f 5254 5f50 414e 454c  ETS_EXPORT_PANEL
+00013350: 5f45 5850 414e 4445 443a 0d0a 2020 2020  _EXPANDED:..    
+00013360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013370: 635f 6865 6967 6874 203d 2053 6567 6d65  c_height = Segme
+00013380: 6e74 6174 696f 6e45 6469 746f 722e 4441  ntationEditor.DA
+00013390: 5441 5345 5453 5f45 5850 4f52 545f 5041  TASETS_EXPORT_PA
+000133a0: 4e45 4c5f 4558 5041 4e44 4544 5f48 4549  NEL_EXPANDED_HEI
+000133b0: 4748 540d 0a20 2020 2020 2020 2020 2020  GHT..           
+000133c0: 2020 2020 2069 6d67 7569 2e62 6567 696e       imgui.begin
+000133d0: 5f63 6869 6c64 2822 6461 7461 7365 7473  _child("datasets
+000133e0: 5f74 6f5f 7361 6d70 6c65 222c 2030 2e30  _to_sample", 0.0
+000133f0: 2c20 635f 6865 6967 6874 2c20 5472 7565  , c_height, True
+00013400: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00013410: 2020 2066 6f72 2073 2069 6e20 6366 672e     for s in cfg.
+00013420: 7365 5f66 7261 6d65 733a 0d0a 2020 2020  se_frames:..    
 00013430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013440: 2020 2020 2020 2069 6d67 7569 2e74 6578         imgui.tex
-00013450: 7428 6622 4578 7472 6163 7469 6e67 207b  t(f"Extracting {
-00013460: 6f73 2e70 6174 682e 7370 6c69 7465 7874  os.path.splitext
-00013470: 286f 732e 7061 7468 2e62 6173 656e 616d  (os.path.basenam
-00013480: 6528 7165 2e70 6174 6829 295b 305d 7d22  e(qe.path))[0]}"
-00013490: 290d 0a0d 0a0d 0a20 2020 2020 2020 2020  )......         
-000134a0: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
-000134b0: 2c20 7165 2069 6e20 656e 756d 6572 6174  , qe in enumerat
-000134c0: 6528 5365 676d 656e 7461 7469 6f6e 4564  e(SegmentationEd
-000134d0: 6974 6f72 2e71 7565 7565 645f 6578 706f  itor.queued_expo
-000134e0: 7274 7329 3a0d 0a20 2020 2020 2020 2020  rts):..         
-000134f0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00013500: 6620 6920 213d 2030 3a0d 0a20 2020 2020  f i != 0:..     
-00013510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013520: 2020 2020 2020 2069 6d67 7569 2e74 6578         imgui.tex
-00013530: 7428 7165 2e64 6174 6173 6574 2e74 6974  t(qe.dataset.tit
-00013540: 6c65 290d 0a20 2020 2020 2020 2020 2020  le)..           
-00013550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013560: 2069 6d67 7569 2e73 616d 655f 6c69 6e65   imgui.same_line
-00013570: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
-00013580: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
-00013590: 692e 7075 7368 5f69 6428 6622 7b71 652e  i.push_id(f"{qe.
-000135a0: 7461 677d 5f63 616e 6365 6c22 290d 0a20  tag}_cancel").. 
-000135b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000135c0: 2020 2020 2020 2063 6f6c 6f75 7220 3d20         colour = 
-000135d0: 282a 7165 2e63 6f6c 6f75 722c 2031 2e30  (*qe.colour, 1.0
-000135e0: 2920 6966 2069 203d 3d20 3020 656c 7365  ) if i == 0 else
-000135f0: 2028 302e 302c 2030 2e30 2c20 302e 302c   (0.0, 0.0, 0.0,
-00013600: 2030 2e30 290d 0a20 2020 2020 2020 2020   0.0)..         
-00013610: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00013620: 616e 6365 6c20 3d20 7365 6c66 2e5f 6775  ancel = self._gu
-00013630: 695f 6261 636b 6772 6f75 6e64 5f70 726f  i_background_pro
-00013640: 6365 7373 5f70 726f 6772 6573 735f 6261  cess_progress_ba
-00013650: 7228 7165 2e70 726f 6365 7373 2c20 636f  r(qe.process, co
-00013660: 6c6f 7572 2c20 6361 6e63 656c 6c61 626c  lour, cancellabl
-00013670: 653d 5472 7565 2c20 7472 616e 7370 6172  e=True, transpar
-00013680: 656e 745f 6261 636b 6772 6f75 6e64 3d28  ent_background=(
-00013690: 6921 3d30 2929 0d0a 2020 2020 2020 2020  i!=0))..        
-000136a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000136b0: 696d 6775 692e 706f 705f 6964 2829 0d0a  imgui.pop_id()..
-000136c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000136d0: 2020 2020 2020 2020 6966 2063 616e 6365          if cance
-000136e0: 6c3a 0d0a 2020 2020 2020 2020 2020 2020  l:..            
-000136f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013700: 5365 676d 656e 7461 7469 6f6e 4564 6974  SegmentationEdit
-00013710: 6f72 2e71 7565 7565 645f 6578 706f 7274  or.queued_export
-00013720: 735b 695d 2e73 746f 7028 290d 0a20 2020  s[i].stop()..   
-00013730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013740: 2020 2020 2020 2020 2053 6567 6d65 6e74           Segment
-00013750: 6174 696f 6e45 6469 746f 722e 7175 6575  ationEditor.queu
-00013760: 6564 5f65 7870 6f72 7473 2e70 6f70 2869  ed_exports.pop(i
-00013770: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00013780: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-00013790: 7265 616b 0d0a 2020 2020 2020 2020 2020  reak..          
-000137a0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000137b0: 2069 203d 3d20 3020 616e 6420 6c65 6e28   i == 0 and len(
-000137c0: 5365 676d 656e 7461 7469 6f6e 4564 6974  SegmentationEdit
-000137d0: 6f72 2e71 7565 7565 645f 6578 706f 7274  or.queued_export
-000137e0: 7329 203e 2031 3a0d 0a20 2020 2020 2020  s) > 1:..       
-000137f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013800: 2020 2020 2069 6d67 7569 2e73 7061 6369       imgui.spaci
-00013810: 6e67 2829 0d0a 2020 2020 2020 2020 2020  ng()..          
-00013820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013830: 2020 696d 6775 692e 7465 7874 2866 2251    imgui.text(f"Q
-00013840: 7565 7565 3a22 290d 0a0d 0a0d 0a20 2020  ueue:")......   
-00013850: 2020 2020 2020 2020 2020 2020 2069 6d67               img
-00013860: 7569 2e70 6f70 5f73 7479 6c65 5f76 6172  ui.pop_style_var
-00013870: 2834 290d 0a0d 0a20 2020 2020 2020 2064  (4)....        d
-00013880: 6566 2070 6963 6b69 6e67 5f74 6162 2829  ef picking_tab()
-00013890: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
-000138a0: 6620 696d 6775 692e 636f 6c6c 6170 7369  f imgui.collapsi
-000138b0: 6e67 5f68 6561 6465 7228 2256 6f6c 756d  ng_header("Volum
-000138c0: 6573 222c 204e 6f6e 652c 2069 6d67 7569  es", None, imgui
-000138d0: 2e54 5245 455f 4e4f 4445 5f44 4546 4155  .TREE_NODE_DEFAU
-000138e0: 4c54 5f4f 5045 4e29 5b30 5d3a 0d0a 2020  LT_OPEN)[0]:..  
-000138f0: 2020 2020 2020 2020 2020 2020 2020 7372                sr
-00013900: 635f 666f 6c64 6572 5f63 6861 6e67 6564  c_folder_changed
-00013910: 2c20 5365 676d 656e 7461 7469 6f6e 4564  , SegmentationEd
-00013920: 6974 6f72 2e73 6567 5f66 6f6c 6465 7220  itor.seg_folder 
-00013930: 3d20 7769 6467 6574 732e 7365 6c65 6374  = widgets.select
-00013940: 5f64 6972 6563 746f 7279 2822 2e2e 2e22  _directory("..."
-00013950: 2c20 5365 676d 656e 7461 7469 6f6e 4564  , SegmentationEd
-00013960: 6974 6f72 2e73 6567 5f66 6f6c 6465 7229  itor.seg_folder)
-00013970: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00013980: 2020 7365 6c66 2e74 6f6f 6c74 6970 2822    self.tooltip("
-00013990: 5365 6c65 6374 2074 6865 206c 6f63 6174  Select the locat
-000139a0: 696f 6e20 696e 2077 6869 6368 2074 6f20  ion in which to 
-000139b0: 6c6f 6f6b 2066 6f72 2073 6567 6d65 6e74  look for segment
-000139c0: 6174 696f 6e73 2074 6861 7420 6265 6c6f  ations that belo
-000139d0: 6e67 2074 6f20 7468 655c 6e22 0d0a 2020  ng to the\n"..  
-000139e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000139f0: 2020 2020 2020 2020 2020 2022 696d 706f             "impo
-00013a00: 7274 6564 2064 6174 6173 6574 732e 2052  rted datasets. R
-00013a10: 6967 6874 2d63 6c69 636b 2074 6f20 7365  ight-click to se
-00013a20: 7420 7468 6520 7061 7468 2074 6f20 7468  t the path to th
-00013a30: 6520 6c6f 6361 7469 6f6e 206f 6620 7468  e location of th
-00013a40: 6520 6163 2d5c 6e22 0d0a 2020 2020 2020  e ac-\n"..      
+00013440: 696d 6775 692e 7075 7368 5f69 6428 6622  imgui.push_id(f"
+00013450: 7b73 2e75 6964 7d22 290d 0a20 2020 2020  {s.uid}")..     
+00013460: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00013470: 6620 7320 3d3d 2063 6667 2e73 655f 6163  f s == cfg.se_ac
+00013480: 7469 7665 5f66 7261 6d65 3a0d 0a20 2020  tive_frame:..   
+00013490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000134a0: 2020 2020 2069 6d67 7569 2e70 7573 685f       imgui.push_
+000134b0: 7374 796c 655f 636f 6c6f 7228 696d 6775  style_color(imgu
+000134c0: 692e 434f 4c4f 525f 5445 5854 2c20 2a63  i.COLOR_TEXT, *c
+000134d0: 6667 2e43 4f4c 4f55 525f 5445 5854 5f41  fg.COLOUR_TEXT_A
+000134e0: 4354 4956 4529 0d0a 2020 2020 2020 2020  CTIVE)..        
+000134f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013500: 5f2c 2073 2e65 7870 6f72 7420 3d20 696d  _, s.export = im
+00013510: 6775 692e 6368 6563 6b62 6f78 2873 2e74  gui.checkbox(s.t
+00013520: 6974 6c65 2c20 732e 6578 706f 7274 290d  itle, s.export).
+00013530: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013540: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
+00013550: 6f70 5f73 7479 6c65 5f63 6f6c 6f72 2829  op_style_color()
+00013560: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00013570: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+00013580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013590: 2020 2020 205f 2c20 732e 6578 706f 7274       _, s.export
+000135a0: 203d 2069 6d67 7569 2e63 6865 636b 626f   = imgui.checkbo
+000135b0: 7828 732e 7469 746c 652c 2073 2e65 7870  x(s.title, s.exp
+000135c0: 6f72 7429 0d0a 2020 2020 2020 2020 2020  ort)..          
+000135d0: 2020 2020 2020 2020 2020 6966 205f 3a0d            if _:.
+000135e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000135f0: 2020 2020 2020 2020 2073 656c 662e 7061           self.pa
+00013600: 7273 655f 6176 6169 6c61 626c 655f 6665  rse_available_fe
+00013610: 6174 7572 6573 2829 0d0a 2020 2020 2020  atures()..      
+00013620: 2020 2020 2020 2020 2020 2020 2020 696d                im
+00013630: 6775 692e 706f 705f 6964 2829 0d0a 2020  gui.pop_id()..  
+00013640: 2020 2020 2020 2020 2020 2020 2020 696d                im
+00013650: 6775 692e 656e 645f 6368 696c 6428 290d  gui.end_child().
+00013660: 0a0d 0a0d 0a20 2020 2020 2020 2020 2020  .....           
+00013670: 2020 2020 2069 6d67 7569 2e70 6f70 5f73       imgui.pop_s
+00013680: 7479 6c65 5f63 6f6c 6f72 2829 0d0a 0d0a  tyle_color()....
+00013690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000136a0: 696d 6775 692e 7465 7874 2822 4578 706f  imgui.text("Expo
+000136b0: 7274 2073 6574 7469 6e67 7322 290d 0a20  rt settings").. 
+000136c0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000136d0: 6d67 7569 2e70 7573 685f 7374 796c 655f  mgui.push_style_
+000136e0: 7661 7228 696d 6775 692e 5354 594c 455f  var(imgui.STYLE_
+000136f0: 4752 4142 5f52 4f55 4e44 494e 472c 2032  GRAB_ROUNDING, 2
+00013700: 3029 0d0a 2020 2020 2020 2020 2020 2020  0)..            
+00013710: 2020 2020 696d 6775 692e 6265 6769 6e5f      imgui.begin_
+00013720: 6368 696c 6428 2265 7870 6f72 745f 7365  child("export_se
+00013730: 7474 696e 6773 222c 2030 2e30 2c20 3533  ttings", 0.0, 53
+00013740: 2e30 2c20 5472 7565 290d 0a20 2020 2020  .0, True)..     
+00013750: 2020 2020 2020 2020 2020 205f 2c20 5365             _, Se
+00013760: 676d 656e 7461 7469 6f6e 4564 6974 6f72  gmentationEditor
+00013770: 2e65 7870 6f72 745f 6469 7220 3d20 7769  .export_dir = wi
+00013780: 6467 6574 732e 7365 6c65 6374 5f64 6972  dgets.select_dir
+00013790: 6563 746f 7279 2822 6272 6f77 7365 222c  ectory("browse",
+000137a0: 2053 6567 6d65 6e74 6174 696f 6e45 6469   SegmentationEdi
+000137b0: 746f 722e 6578 706f 7274 5f64 6972 290d  tor.export_dir).
+000137c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000137d0: 2069 6d67 7569 2e73 6574 5f6e 6578 745f   imgui.set_next_
+000137e0: 6974 656d 5f77 6964 7468 2869 6d67 7569  item_width(imgui
+000137f0: 2e67 6574 5f63 6f6e 7465 6e74 5f72 6567  .get_content_reg
+00013800: 696f 6e5f 6176 6169 6c61 626c 655f 7769  ion_available_wi
+00013810: 6474 6828 2929 0d0a 2020 2020 2020 2020  dth())..        
+00013820: 2020 2020 2020 2020 5f2c 2073 656c 662e          _, self.
+00013830: 6578 706f 7274 5f6c 696d 6974 5f72 616e  export_limit_ran
+00013840: 6765 203d 2069 6d67 7569 2e63 6865 636b  ge = imgui.check
+00013850: 626f 7828 2220 6c69 6d69 7420 7261 6e67  box(" limit rang
+00013860: 6520 222c 2073 656c 662e 6578 706f 7274  e ", self.export
+00013870: 5f6c 696d 6974 5f72 616e 6765 290d 0a20  _limit_range).. 
+00013880: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00013890: 696d 6775 692e 7361 6d65 5f6c 696e 6528  imgui.same_line(
+000138a0: 7370 6163 696e 673d 3632 290d 0a20 2020  spacing=62)..   
+000138b0: 2020 2020 2020 2020 2020 2020 2023 5f2c               #_,
+000138c0: 2073 656c 662e 6578 706f 7274 5f6f 7665   self.export_ove
+000138d0: 726c 6179 7320 3d20 696d 6775 692e 6368  rlays = imgui.ch
+000138e0: 6563 6b62 6f78 2822 2065 7870 6f72 7420  eckbox(" export 
+000138f0: 6f76 6572 6c61 7973 222c 2073 656c 662e  overlays", self.
+00013900: 6578 706f 7274 5f6f 7665 726c 6179 7329  export_overlays)
+00013910: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00013920: 2020 696d 6775 692e 656e 645f 6368 696c    imgui.end_chil
+00013930: 6428 290d 0a0d 0a0d 0a20 2020 2020 2020  d()......       
+00013940: 2020 2020 2020 2020 2069 6620 7769 6467           if widg
+00013950: 6574 732e 6365 6e74 7265 645f 6275 7474  ets.centred_butt
+00013960: 6f6e 2822 5374 6172 7420 6578 706f 7274  on("Start export
+00013970: 222c 2031 3230 2c20 3233 293a 0d0a 2020  ", 120, 23):..  
+00013980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013990: 2020 7365 6c66 2e6c 6175 6e63 685f 6578    self.launch_ex
+000139a0: 706f 7274 5f76 6f6c 756d 6573 2829 0d0a  port_volumes()..
+000139b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000139c0: 2020 2320 6578 706f 7274 2070 726f 6772    # export progr
+000139d0: 6573 733a 0d0a 2020 2020 2020 2020 2020  ess:..          
+000139e0: 2020 2020 2020 6966 2053 6567 6d65 6e74        if Segment
+000139f0: 6174 696f 6e45 6469 746f 722e 7175 6575  ationEditor.queu
+00013a00: 6564 5f65 7870 6f72 7473 3a0d 0a20 2020  ed_exports:..   
+00013a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013a20: 2071 6520 3d20 5365 676d 656e 7461 7469   qe = Segmentati
+00013a30: 6f6e 4564 6974 6f72 2e71 7565 7565 645f  onEditor.queued_
+00013a40: 6578 706f 7274 735b 305d 0d0a 2020 2020  exports[0]..    
 00013a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013a60: 2020 2020 2020 2022 7469 7665 2064 6174         "tive dat
-00013a70: 6173 6574 2e22 290d 0a20 2020 2020 2020  aset.")..       
-00013a80: 2020 2020 2020 2020 2069 6620 696d 6775           if imgu
-00013a90: 692e 6973 5f69 7465 6d5f 636c 6963 6b65  i.is_item_clicke
-00013aa0: 6428 3129 3a0d 0a20 2020 2020 2020 2020  d(1):..         
-00013ab0: 2020 2020 2020 2020 2020 2073 7263 5f66             src_f
-00013ac0: 6f6c 6465 725f 6368 616e 6765 6420 3d20  older_changed = 
-00013ad0: 5472 7565 0d0a 2020 2020 2020 2020 2020  True..          
-00013ae0: 2020 2020 2020 2020 2020 5365 676d 656e            Segmen
-00013af0: 7461 7469 6f6e 4564 6974 6f72 2e73 6567  tationEditor.seg
-00013b00: 5f66 6f6c 6465 7220 3d20 6f73 2e70 6174  _folder = os.pat
-00013b10: 682e 6469 726e 616d 6528 6366 672e 7365  h.dirname(cfg.se
-00013b20: 5f61 6374 6976 655f 6672 616d 652e 7061  _active_frame.pa
-00013b30: 7468 290d 0a20 2020 2020 2020 2020 2020  th)..           
-00013b40: 2020 2020 2073 656c 662e 746f 6f6c 7469       self.toolti
-00013b50: 7028 2253 7065 6369 6679 2074 6865 2064  p("Specify the d
-00013b60: 6972 6563 746f 7279 2069 6e20 7768 6963  irectory in whic
-00013b70: 6820 746f 206c 6f6f 6b20 666f 7220 7365  h to look for se
-00013b80: 676d 656e 7461 7469 6f6e 7320 666f 7220  gmentations for 
-00013b90: 7468 6520 6163 7469 7665 2064 6174 6173  the active datas
-00013ba0: 6574 2e22 290d 0a20 2020 2020 2020 2020  et.")..         
-00013bb0: 2020 2020 2020 2069 6d67 7569 2e70 7573         imgui.pus
-00013bc0: 685f 7374 796c 655f 7661 7228 696d 6775  h_style_var(imgu
-00013bd0: 692e 5354 594c 455f 4652 414d 455f 524f  i.STYLE_FRAME_RO
-00013be0: 554e 4449 4e47 2c20 3130 290d 0a20 2020  UNDING, 10)..   
-00013bf0: 2020 2020 2020 2020 2020 2020 2069 6d67               img
-00013c00: 7569 2e70 7573 685f 7374 796c 655f 7661  ui.push_style_va
-00013c10: 7228 696d 6775 692e 5354 594c 455f 4652  r(imgui.STYLE_FR
-00013c20: 414d 455f 424f 5244 4552 5349 5a45 2c20  AME_BORDERSIZE, 
-00013c30: 3129 0d0a 2020 2020 2020 2020 2020 2020  1)..            
-00013c40: 2020 2020 696d 6775 692e 7075 7368 5f73      imgui.push_s
-00013c50: 7479 6c65 5f76 6172 2869 6d67 7569 2e53  tyle_var(imgui.S
-00013c60: 5459 4c45 5f46 5241 4d45 5f50 4144 4449  TYLE_FRAME_PADDI
-00013c70: 4e47 2c20 2830 2c20 3029 290d 0a20 2020  NG, (0, 0))..   
-00013c80: 2020 2020 2020 2020 2020 2020 2069 6d67               img
-00013c90: 7569 2e70 7573 685f 7374 796c 655f 636f  ui.push_style_co
-00013ca0: 6c6f 7228 696d 6775 692e 434f 4c4f 525f  lor(imgui.COLOR_
-00013cb0: 4348 4543 4b5f 4d41 524b 2c20 302e 302c  CHECK_MARK, 0.0,
-00013cc0: 2030 2e30 2c20 302e 3029 0d0a 0d0a 2020   0.0, 0.0)....  
-00013cd0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00013ce0: 6c69 7374 2074 6865 2073 6567 6d65 6e74  list the segment
-00013cf0: 6174 696f 6e73 2066 6f75 6e64 2066 6f72  ations found for
-00013d00: 2074 6865 2063 7572 7265 6e74 6c79 2073   the currently s
-00013d10: 656c 6563 7465 6420 6461 7461 7365 742e  elected dataset.
-00013d20: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00013d30: 2020 6465 6620 7570 6461 7465 5f70 6963    def update_pic
-00013d40: 6b69 6e67 5f74 6162 5f66 6f72 5f6e 6577  king_tab_for_new
-00013d50: 5f61 6374 6976 655f 6672 616d 6528 293a  _active_frame():
-00013d60: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00013d70: 2020 2020 2020 5365 676d 656e 7461 7469        Segmentati
-00013d80: 6f6e 4564 6974 6f72 2e56 4945 575f 5245  onEditor.VIEW_RE
-00013d90: 5155 4952 4553 5f55 5044 4154 4520 3d20  QUIRES_UPDATE = 
-00013da0: 5472 7565 0d0a 2020 2020 2020 2020 2020  True..          
-00013db0: 2020 2020 2020 2020 2020 2320 6465 6c65            # dele
-00013dc0: 7465 206f 6c64 2073 7572 6661 6365 206d  te old surface m
-00013dd0: 6f64 656c 730d 0a20 2020 2020 2020 2020  odels..         
-00013de0: 2020 2020 2020 2020 2020 2066 6f72 2073             for s
-00013df0: 2069 6e20 6366 672e 7365 5f73 7572 6661   in cfg.se_surfa
-00013e00: 6365 5f6d 6f64 656c 733a 0d0a 2020 2020  ce_models:..    
+00013a60: 696d 6775 692e 7370 6163 696e 6728 290d  imgui.spacing().
+00013a70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013a80: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+00013a90: 6365 2871 652c 2051 7565 7565 6445 7870  ce(qe, QueuedExp
+00013aa0: 6f72 7429 3a0d 0a20 2020 2020 2020 2020  ort):..         
+00013ab0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00013ac0: 6d67 7569 2e74 6578 7428 6622 5072 6f63  mgui.text(f"Proc
+00013ad0: 6573 7369 6e67 2027 7b71 652e 6461 7461  essing '{qe.data
+00013ae0: 7365 742e 7469 746c 657d 273a 2229 0d0a  set.title}':")..
+00013af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013b00: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00013b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013b20: 2020 2069 6d67 7569 2e74 6578 7428 6622     imgui.text(f"
+00013b30: 4578 7472 6163 7469 6e67 207b 6f73 2e70  Extracting {os.p
+00013b40: 6174 682e 7370 6c69 7465 7874 286f 732e  ath.splitext(os.
+00013b50: 7061 7468 2e62 6173 656e 616d 6528 7165  path.basename(qe
+00013b60: 2e70 6174 6829 295b 305d 7d22 290d 0a0d  .path))[0]}")...
+00013b70: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+00013b80: 2020 2020 2020 2066 6f72 2069 2c20 7165         for i, qe
+00013b90: 2069 6e20 656e 756d 6572 6174 6528 5365   in enumerate(Se
+00013ba0: 676d 656e 7461 7469 6f6e 4564 6974 6f72  gmentationEditor
+00013bb0: 2e71 7565 7565 645f 6578 706f 7274 7329  .queued_exports)
+00013bc0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00013bd0: 2020 2020 2020 2020 2020 2069 6620 6920             if i 
+00013be0: 213d 2030 3a0d 0a20 2020 2020 2020 2020  != 0:..         
+00013bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013c00: 2020 2069 6d67 7569 2e74 6578 7428 7165     imgui.text(qe
+00013c10: 2e64 6174 6173 6574 2e74 6974 6c65 290d  .dataset.title).
+00013c20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013c30: 2020 2020 2020 2020 2020 2020 2069 6d67               img
+00013c40: 7569 2e73 616d 655f 6c69 6e65 2829 0d0a  ui.same_line()..
+00013c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013c60: 2020 2020 2020 2020 696d 6775 692e 7075          imgui.pu
+00013c70: 7368 5f69 6428 6622 7b71 652e 7461 677d  sh_id(f"{qe.tag}
+00013c80: 5f63 616e 6365 6c22 290d 0a20 2020 2020  _cancel")..     
+00013c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013ca0: 2020 2063 6f6c 6f75 7220 3d20 282a 7165     colour = (*qe
+00013cb0: 2e63 6f6c 6f75 722c 2031 2e30 2920 6966  .colour, 1.0) if
+00013cc0: 2069 203d 3d20 3020 656c 7365 2028 302e   i == 0 else (0.
+00013cd0: 302c 2030 2e30 2c20 302e 302c 2030 2e30  0, 0.0, 0.0, 0.0
+00013ce0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00013cf0: 2020 2020 2020 2020 2020 2063 616e 6365             cance
+00013d00: 6c20 3d20 7365 6c66 2e5f 6775 695f 6261  l = self._gui_ba
+00013d10: 636b 6772 6f75 6e64 5f70 726f 6365 7373  ckground_process
+00013d20: 5f70 726f 6772 6573 735f 6261 7228 7165  _progress_bar(qe
+00013d30: 2e70 726f 6365 7373 2c20 636f 6c6f 7572  .process, colour
+00013d40: 2c20 6361 6e63 656c 6c61 626c 653d 5472  , cancellable=Tr
+00013d50: 7565 2c20 7472 616e 7370 6172 656e 745f  ue, transparent_
+00013d60: 6261 636b 6772 6f75 6e64 3d28 6921 3d30  background=(i!=0
+00013d70: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
+00013d80: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
+00013d90: 692e 706f 705f 6964 2829 0d0a 2020 2020  i.pop_id()..    
+00013da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013db0: 2020 2020 6966 2063 616e 6365 6c3a 0d0a      if cancel:..
+00013dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013dd0: 2020 2020 2020 2020 2020 2020 5365 676d              Segm
+00013de0: 656e 7461 7469 6f6e 4564 6974 6f72 2e71  entationEditor.q
+00013df0: 7565 7565 645f 6578 706f 7274 735b 695d  ueued_exports[i]
+00013e00: 2e73 746f 7028 290d 0a20 2020 2020 2020  .stop()..       
 00013e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013e20: 2020 2020 732e 6465 6c65 7465 2829 0d0a      s.delete()..
-00013e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013e40: 2020 2020 6366 672e 7365 5f73 7572 6661      cfg.se_surfa
-00013e50: 6365 5f6d 6f64 656c 7320 3d20 6c69 7374  ce_models = list
-00013e60: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
-00013e70: 2020 2020 2020 2020 2320 696e 6465 7820          # index 
-00013e80: 6e65 7720 7375 7266 6163 6520 6d6f 6465  new surface mode
-00013e90: 6c73 202d 2066 696e 6420 636f 7272 6573  ls - find corres
-00013ea0: 706f 6e64 696e 6720 7365 676d 656e 7461  ponding segmenta
-00013eb0: 7469 6f6e 202e 6d72 6327 730d 0a20 2020  tion .mrc's..   
-00013ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013ed0: 2069 6620 6366 672e 7365 5f61 6374 6976   if cfg.se_activ
-00013ee0: 655f 6672 616d 6520 6973 204e 6f6e 653a  e_frame is None:
+00013e20: 2020 2020 2053 6567 6d65 6e74 6174 696f       Segmentatio
+00013e30: 6e45 6469 746f 722e 7175 6575 6564 5f65  nEditor.queued_e
+00013e40: 7870 6f72 7473 2e70 6f70 2869 290d 0a20  xports.pop(i).. 
+00013e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013e60: 2020 2020 2020 2020 2020 2062 7265 616b             break
+00013e70: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00013e80: 2020 2020 2020 2020 2020 6966 2069 203d            if i =
+00013e90: 3d20 3020 616e 6420 6c65 6e28 5365 676d  = 0 and len(Segm
+00013ea0: 656e 7461 7469 6f6e 4564 6974 6f72 2e71  entationEditor.q
+00013eb0: 7565 7565 645f 6578 706f 7274 7329 203e  ueued_exports) >
+00013ec0: 2031 3a0d 0a20 2020 2020 2020 2020 2020   1:..           
+00013ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013ee0: 2069 6d67 7569 2e73 7061 6369 6e67 2829   imgui.spacing()
 00013ef0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00013f00: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
-00013f10: 6963 6b5f 626f 785f 7661 2e75 7064 6174  ick_box_va.updat
-00013f20: 6528 5665 7274 6578 4275 6666 6572 285b  e(VertexBuffer([
-00013f30: 302e 302c 2030 2e30 5d29 2c20 496e 6465  0.0, 0.0]), Inde
-00013f40: 7842 7566 6665 7228 5b5d 2929 0d0a 2020  xBuffer([]))..  
-00013f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013f60: 2020 2020 2020 7365 6c66 2e70 6963 6b5f        self.pick_
-00013f70: 626f 785f 7175 6164 5f76 612e 7570 6461  box_quad_va.upda
-00013f80: 7465 2856 6572 7465 7842 7566 6665 7228  te(VertexBuffer(
-00013f90: 5b30 2e30 2c20 302e 305d 292c 2049 6e64  [0.0, 0.0]), Ind
-00013fa0: 6578 4275 6666 6572 285b 5d29 290d 0a20  exBuffer([])).. 
-00013fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013fc0: 2020 2020 2020 2072 6574 7572 6e0d 0a20         return.. 
-00013fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013fe0: 2020 2073 655f 6672 616d 6520 3d20 6366     se_frame = cf
-00013ff0: 672e 7365 5f61 6374 6976 655f 6672 616d  g.se_active_fram
-00014000: 650d 0a20 2020 2020 2020 2020 2020 2020  e..             
-00014010: 2020 2020 2020 2053 6567 6d65 6e74 6174         Segmentat
-00014020: 696f 6e45 6469 746f 722e 7069 636b 5f74  ionEditor.pick_t
-00014030: 6162 5f69 6e64 6578 5f64 6174 6173 6574  ab_index_dataset
-00014040: 735f 7365 6773 203d 2046 616c 7365 0d0a  s_segs = False..
-00014050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014060: 2020 2020 2320 6669 6e64 2073 6567 6d65      # find segme
-00014070: 6e74 6174 696f 6e73 2069 6e20 7468 6520  ntations in the 
-00014080: 7365 6c65 6374 6564 2064 6174 6173 6574  selected dataset
-00014090: 2773 2066 6f6c 6465 722e 0d0a 0d0a 0d0a  's folder.......
-000140a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000140b0: 2020 2020 6669 6c65 7320 3d20 676c 6f62      files = glob
-000140c0: 2e67 6c6f 6228 6f73 2e70 6174 682e 6a6f  .glob(os.path.jo
-000140d0: 696e 2853 6567 6d65 6e74 6174 696f 6e45  in(SegmentationE
-000140e0: 6469 746f 722e 7365 675f 666f 6c64 6572  ditor.seg_folder
-000140f0: 2c20 6f73 2e70 6174 682e 7370 6c69 7465  , os.path.splite
-00014100: 7874 2873 655f 6672 616d 652e 7469 746c  xt(se_frame.titl
-00014110: 6529 5b30 5d20 2b20 225f 5f2a 2e6d 7263  e)[0] + "__*.mrc
-00014120: 2229 290d 0a20 2020 2020 2020 2020 2020  "))..           
-00014130: 2020 2020 2020 2020 2070 7269 6e74 2866           print(f
-00014140: 224c 6f6f 6b69 6e67 2066 6f72 2073 6567  "Looking for seg
-00014150: 6d65 6e74 6174 696f 6e2e 6d72 6327 7320  mentation.mrc's 
-00014160: 7573 696e 6720 6669 6c65 6e61 6d65 2074  using filename t
-00014170: 656d 706c 6174 6520 222c 206f 732e 7061  emplate ", os.pa
-00014180: 7468 2e6a 6f69 6e28 5365 676d 656e 7461  th.join(Segmenta
-00014190: 7469 6f6e 4564 6974 6f72 2e73 6567 5f66  tionEditor.seg_f
-000141a0: 6f6c 6465 722c 206f 732e 7061 7468 2e73  older, os.path.s
-000141b0: 706c 6974 6578 7428 7365 5f66 7261 6d65  plitext(se_frame
-000141c0: 2e74 6974 6c65 295b 305d 202b 2022 5f5f  .title)[0] + "__
-000141d0: 2a2e 6d72 6322 2929 0d0a 2020 2020 2020  *.mrc"))..      
-000141e0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-000141f0: 7220 6620 696e 2073 6f72 7465 6428 6669  r f in sorted(fi
-00014200: 6c65 7329 3a0d 0a20 2020 2020 2020 2020  les):..         
-00014210: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00014220: 7269 6e74 2866 290d 0a20 2020 2020 2020  rint(f)..       
-00014230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014240: 2063 6667 2e73 655f 7375 7266 6163 655f   cfg.se_surface_
-00014250: 6d6f 6465 6c73 2e61 7070 656e 6428 5375  models.append(Su
-00014260: 7266 6163 654d 6f64 656c 2866 2c20 7365  rfaceModel(f, se
-00014270: 5f66 7261 6d65 2e70 6978 656c 5f73 697a  _frame.pixel_siz
-00014280: 6529 290d 0a0d 0a20 2020 2020 2020 2020  e))....         
-00014290: 2020 2020 2020 2020 2020 2023 2073 6574             # set
-000142a0: 2074 6865 2073 697a 6520 6f66 2074 6865   the size of the
-000142b0: 2076 6f6c 756d 6520 7370 616e 6e69 6e67   volume spanning
-000142c0: 2062 6f78 0d0a 2020 2020 2020 2020 2020   box..          
-000142d0: 2020 2020 2020 2020 2020 772c 2068 2c20            w, h, 
-000142e0: 6420 3d20 7365 5f66 7261 6d65 2e77 6964  d = se_frame.wid
-000142f0: 7468 202f 2032 2c20 7365 5f66 7261 6d65  th / 2, se_frame
-00014300: 2e68 6569 6768 7420 2f20 322c 2073 655f  .height / 2, se_
-00014310: 6672 616d 652e 6e5f 736c 6963 6573 202f  frame.n_slices /
-00014320: 2032 0d0a 2020 2020 2020 2020 2020 2020   2..            
-00014330: 2020 2020 2020 2020 7720 2a3d 2073 655f          w *= se_
-00014340: 6672 616d 652e 7069 7865 6c5f 7369 7a65  frame.pixel_size
-00014350: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00014360: 2020 2020 2020 6820 2a3d 2073 655f 6672        h *= se_fr
-00014370: 616d 652e 7069 7865 6c5f 7369 7a65 0d0a  ame.pixel_size..
-00014380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014390: 2020 2020 6420 2a3d 2073 655f 6672 616d      d *= se_fram
-000143a0: 652e 7069 7865 6c5f 7369 7a65 0d0a 2020  e.pixel_size..  
-000143b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000143c0: 2020 7665 7274 6963 6573 203d 205b 2d77    vertices = [-w
-000143d0: 2c20 682c 2064 2c0d 0a20 2020 2020 2020  , h, d,..       
-000143e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000143f0: 2020 2020 2020 2020 2077 2c20 682c 2064           w, h, d
-00014400: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00014410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014420: 2020 2077 2c20 2d68 2c20 642c 0d0a 2020     w, -h, d,..  
-00014430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014440: 2020 2020 2020 2020 2020 2020 2020 2d77                -w
-00014450: 2c20 2d68 2c20 642c 0d0a 2020 2020 2020  , -h, d,..      
-00014460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014470: 2020 2020 2020 2020 2020 2d77 2c20 682c            -w, h,
-00014480: 202d 642c 0d0a 2020 2020 2020 2020 2020   -d,..          
-00014490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000144a0: 2020 2020 2020 772c 2068 2c20 2d64 2c0d        w, h, -d,.
-000144b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000144c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000144d0: 2077 2c20 2d68 2c20 2d64 2c0d 0a20 2020   w, -h, -d,..   
-000144e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000144f0: 2020 2020 2020 2020 2020 2020 202d 772c               -w,
-00014500: 202d 682c 202d 645d 0d0a 2020 2020 2020   -h, -d]..      
-00014510: 2020 2020 2020 2020 2020 2020 2020 6c69                li
-00014520: 6e65 5f69 6e64 6963 6573 203d 205b 302c  ne_indices = [0,
-00014530: 2031 2c20 312c 2032 2c20 322c 2033 2c20   1, 1, 2, 2, 3, 
-00014540: 332c 2030 2c20 302c 2034 2c20 312c 2035  3, 0, 0, 4, 1, 5
-00014550: 2c20 322c 2036 2c20 332c 2037 2c20 342c  , 2, 6, 3, 7, 4,
-00014560: 2035 2c20 352c 2036 2c20 362c 2037 2c20   5, 5, 6, 6, 7, 
-00014570: 372c 2034 5d0d 0a20 2020 2020 2020 2020  7, 4]..         
-00014580: 2020 2020 2020 2020 2020 2071 7561 645f             quad_
-00014590: 696e 6469 6365 7320 3d20 5b30 2c20 312c  indices = [0, 1,
-000145a0: 2032 2c20 322c 2033 2c20 302c 2034 2c20   2, 2, 3, 0, 4, 
-000145b0: 352c 2036 2c20 362c 2037 2c20 342c 2030  5, 6, 6, 7, 4, 0
-000145c0: 2c20 342c 2037 2c20 372c 2033 2c20 302c  , 4, 7, 7, 3, 0,
-000145d0: 2035 2c20 312c 2032 2c20 322c 2036 2c20   5, 1, 2, 2, 6, 
-000145e0: 352c 2034 2c20 302c 2031 2c20 312c 2035  5, 4, 0, 1, 1, 5
-000145f0: 2c20 342c 2033 2c20 372c 2036 2c20 362c  , 4, 3, 7, 6, 6,
-00014600: 2032 2c20 335d 0d0a 2020 2020 2020 2020   2, 3]..        
-00014610: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00014620: 2e70 6963 6b5f 626f 785f 7661 2e75 7064  .pick_box_va.upd
-00014630: 6174 6528 5665 7274 6578 4275 6666 6572  ate(VertexBuffer
-00014640: 2876 6572 7469 6365 7329 2c20 496e 6465  (vertices), Inde
-00014650: 7842 7566 6665 7228 6c69 6e65 5f69 6e64  xBuffer(line_ind
-00014660: 6963 6573 2929 0d0a 2020 2020 2020 2020  ices))..        
-00014670: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00014680: 2e70 6963 6b5f 626f 785f 7175 6164 5f76  .pick_box_quad_v
-00014690: 612e 7570 6461 7465 2856 6572 7465 7842  a.update(VertexB
-000146a0: 7566 6665 7228 7665 7274 6963 6573 292c  uffer(vertices),
-000146b0: 2049 6e64 6578 4275 6666 6572 2871 7561   IndexBuffer(qua
-000146c0: 645f 696e 6469 6365 7329 290d 0a0d 0a0d  d_indices)).....
-000146d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000146e0: 2069 6620 5365 676d 656e 7461 7469 6f6e   if Segmentation
-000146f0: 4564 6974 6f72 2e70 6963 6b5f 7461 625f  Editor.pick_tab_
-00014700: 696e 6465 785f 6461 7461 7365 7473 5f73  index_datasets_s
-00014710: 6567 7320 6f72 2073 7263 5f66 6f6c 6465  egs or src_folde
-00014720: 725f 6368 616e 6765 643a 0d0a 2020 2020  r_changed:..    
+00013f00: 2020 2020 2020 2020 2020 2020 2020 696d                im
+00013f10: 6775 692e 7465 7874 2866 2251 7565 7565  gui.text(f"Queue
+00013f20: 3a22 290d 0a0d 0a0d 0a20 2020 2020 2020  :")......       
+00013f30: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
+00013f40: 6f70 5f73 7479 6c65 5f76 6172 2834 290d  op_style_var(4).
+00013f50: 0a0d 0a20 2020 2020 2020 2064 6566 2070  ...        def p
+00013f60: 6963 6b69 6e67 5f74 6162 2829 3a0d 0a20  icking_tab():.. 
+00013f70: 2020 2020 2020 2020 2020 2069 6620 696d             if im
+00013f80: 6775 692e 636f 6c6c 6170 7369 6e67 5f68  gui.collapsing_h
+00013f90: 6561 6465 7228 2256 6f6c 756d 6573 222c  eader("Volumes",
+00013fa0: 204e 6f6e 652c 2069 6d67 7569 2e54 5245   None, imgui.TRE
+00013fb0: 455f 4e4f 4445 5f44 4546 4155 4c54 5f4f  E_NODE_DEFAULT_O
+00013fc0: 5045 4e29 5b30 5d3a 0d0a 2020 2020 2020  PEN)[0]:..      
+00013fd0: 2020 2020 2020 2020 2020 7372 635f 666f            src_fo
+00013fe0: 6c64 6572 5f63 6861 6e67 6564 2c20 5365  lder_changed, Se
+00013ff0: 676d 656e 7461 7469 6f6e 4564 6974 6f72  gmentationEditor
+00014000: 2e73 6567 5f66 6f6c 6465 7220 3d20 7769  .seg_folder = wi
+00014010: 6467 6574 732e 7365 6c65 6374 5f64 6972  dgets.select_dir
+00014020: 6563 746f 7279 2822 2e2e 2e22 2c20 5365  ectory("...", Se
+00014030: 676d 656e 7461 7469 6f6e 4564 6974 6f72  gmentationEditor
+00014040: 2e73 6567 5f66 6f6c 6465 7229 0d0a 2020  .seg_folder)..  
+00014050: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00014060: 6c66 2e74 6f6f 6c74 6970 2822 5365 6c65  lf.tooltip("Sele
+00014070: 6374 2074 6865 206c 6f63 6174 696f 6e20  ct the location 
+00014080: 696e 2077 6869 6368 2074 6f20 6c6f 6f6b  in which to look
+00014090: 2066 6f72 2073 6567 6d65 6e74 6174 696f   for segmentatio
+000140a0: 6e73 2074 6861 7420 6265 6c6f 6e67 2074  ns that belong t
+000140b0: 6f20 7468 655c 6e22 0d0a 2020 2020 2020  o the\n"..      
+000140c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000140d0: 2020 2020 2020 2022 696d 706f 7274 6564         "imported
+000140e0: 2064 6174 6173 6574 732e 2052 6967 6874   datasets. Right
+000140f0: 2d63 6c69 636b 2074 6f20 7365 7420 7468  -click to set th
+00014100: 6520 7061 7468 2074 6f20 7468 6520 6c6f  e path to the lo
+00014110: 6361 7469 6f6e 206f 6620 7468 6520 6163  cation of the ac
+00014120: 2d5c 6e22 0d0a 2020 2020 2020 2020 2020  -\n"..          
+00014130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014140: 2020 2022 7469 7665 2064 6174 6173 6574     "tive dataset
+00014150: 2e22 290d 0a20 2020 2020 2020 2020 2020  .")..           
+00014160: 2020 2020 2069 6620 696d 6775 692e 6973       if imgui.is
+00014170: 5f69 7465 6d5f 636c 6963 6b65 6428 3129  _item_clicked(1)
+00014180: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00014190: 2020 2020 2020 2073 7263 5f66 6f6c 6465         src_folde
+000141a0: 725f 6368 616e 6765 6420 3d20 5472 7565  r_changed = True
+000141b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000141c0: 2020 2020 2020 5365 676d 656e 7461 7469        Segmentati
+000141d0: 6f6e 4564 6974 6f72 2e73 6567 5f66 6f6c  onEditor.seg_fol
+000141e0: 6465 7220 3d20 6f73 2e70 6174 682e 6469  der = os.path.di
+000141f0: 726e 616d 6528 6366 672e 7365 5f61 6374  rname(cfg.se_act
+00014200: 6976 655f 6672 616d 652e 7061 7468 290d  ive_frame.path).
+00014210: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014220: 2073 656c 662e 746f 6f6c 7469 7028 2253   self.tooltip("S
+00014230: 7065 6369 6679 2074 6865 2064 6972 6563  pecify the direc
+00014240: 746f 7279 2069 6e20 7768 6963 6820 746f  tory in which to
+00014250: 206c 6f6f 6b20 666f 7220 7365 676d 656e   look for segmen
+00014260: 7461 7469 6f6e 7320 666f 7220 7468 6520  tations for the 
+00014270: 6163 7469 7665 2064 6174 6173 6574 2e22  active dataset."
+00014280: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00014290: 2020 2069 6d67 7569 2e70 7573 685f 7374     imgui.push_st
+000142a0: 796c 655f 7661 7228 696d 6775 692e 5354  yle_var(imgui.ST
+000142b0: 594c 455f 4652 414d 455f 524f 554e 4449  YLE_FRAME_ROUNDI
+000142c0: 4e47 2c20 3130 290d 0a20 2020 2020 2020  NG, 10)..       
+000142d0: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
+000142e0: 7573 685f 7374 796c 655f 7661 7228 696d  ush_style_var(im
+000142f0: 6775 692e 5354 594c 455f 4652 414d 455f  gui.STYLE_FRAME_
+00014300: 424f 5244 4552 5349 5a45 2c20 3129 0d0a  BORDERSIZE, 1)..
+00014310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014320: 696d 6775 692e 7075 7368 5f73 7479 6c65  imgui.push_style
+00014330: 5f76 6172 2869 6d67 7569 2e53 5459 4c45  _var(imgui.STYLE
+00014340: 5f46 5241 4d45 5f50 4144 4449 4e47 2c20  _FRAME_PADDING, 
+00014350: 2830 2c20 3029 290d 0a20 2020 2020 2020  (0, 0))..       
+00014360: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
+00014370: 7573 685f 7374 796c 655f 636f 6c6f 7228  ush_style_color(
+00014380: 696d 6775 692e 434f 4c4f 525f 4348 4543  imgui.COLOR_CHEC
+00014390: 4b5f 4d41 524b 2c20 302e 302c 2030 2e30  K_MARK, 0.0, 0.0
+000143a0: 2c20 302e 3029 0d0a 0d0a 2020 2020 2020  , 0.0)....      
+000143b0: 2020 2020 2020 2020 2020 2320 6c69 7374            # list
+000143c0: 2074 6865 2073 6567 6d65 6e74 6174 696f   the segmentatio
+000143d0: 6e73 2066 6f75 6e64 2066 6f72 2074 6865  ns found for the
+000143e0: 2063 7572 7265 6e74 6c79 2073 656c 6563   currently selec
+000143f0: 7465 6420 6461 7461 7365 742e 0d0a 2020  ted dataset...  
+00014400: 2020 2020 2020 2020 2020 2020 2020 6465                de
+00014410: 6620 7570 6461 7465 5f70 6963 6b69 6e67  f update_picking
+00014420: 5f74 6162 5f66 6f72 5f6e 6577 5f61 6374  _tab_for_new_act
+00014430: 6976 655f 6672 616d 6528 293a 0d0a 2020  ive_frame():..  
+00014440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014450: 2020 5365 676d 656e 7461 7469 6f6e 4564    SegmentationEd
+00014460: 6974 6f72 2e56 4945 575f 5245 5155 4952  itor.VIEW_REQUIR
+00014470: 4553 5f55 5044 4154 4520 3d20 5472 7565  ES_UPDATE = True
+00014480: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00014490: 2020 2020 2020 2320 6465 6c65 7465 206f        # delete o
+000144a0: 6c64 2073 7572 6661 6365 206d 6f64 656c  ld surface model
+000144b0: 730d 0a20 2020 2020 2020 2020 2020 2020  s..             
+000144c0: 2020 2020 2020 2066 6f72 2073 2069 6e20         for s in 
+000144d0: 6366 672e 7365 5f73 7572 6661 6365 5f6d  cfg.se_surface_m
+000144e0: 6f64 656c 733a 0d0a 2020 2020 2020 2020  odels:..        
+000144f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014500: 732e 6465 6c65 7465 2829 0d0a 2020 2020  s.delete()..    
+00014510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014520: 6366 672e 7365 5f73 7572 6661 6365 5f6d  cfg.se_surface_m
+00014530: 6f64 656c 7320 3d20 6c69 7374 2829 0d0a  odels = list()..
+00014540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014550: 2020 2020 2320 696e 6465 7820 6e65 7720      # index new 
+00014560: 7375 7266 6163 6520 6d6f 6465 6c73 202d  surface models -
+00014570: 2066 696e 6420 636f 7272 6573 706f 6e64   find correspond
+00014580: 696e 6720 7365 676d 656e 7461 7469 6f6e  ing segmentation
+00014590: 202e 6d72 6327 730d 0a20 2020 2020 2020   .mrc's..       
+000145a0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+000145b0: 6366 672e 7365 5f61 6374 6976 655f 6672  cfg.se_active_fr
+000145c0: 616d 6520 6973 204e 6f6e 653a 0d0a 2020  ame is None:..  
+000145d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000145e0: 2020 2020 2020 7365 6c66 2e70 6963 6b5f        self.pick_
+000145f0: 626f 785f 7661 2e75 7064 6174 6528 5665  box_va.update(Ve
+00014600: 7274 6578 4275 6666 6572 285b 302e 302c  rtexBuffer([0.0,
+00014610: 2030 2e30 5d29 2c20 496e 6465 7842 7566   0.0]), IndexBuf
+00014620: 6665 7228 5b5d 2929 0d0a 2020 2020 2020  fer([]))..      
+00014630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014640: 2020 7365 6c66 2e70 6963 6b5f 626f 785f    self.pick_box_
+00014650: 7175 6164 5f76 612e 7570 6461 7465 2856  quad_va.update(V
+00014660: 6572 7465 7842 7566 6665 7228 5b30 2e30  ertexBuffer([0.0
+00014670: 2c20 302e 305d 292c 2049 6e64 6578 4275  , 0.0]), IndexBu
+00014680: 6666 6572 285b 5d29 290d 0a20 2020 2020  ffer([]))..     
+00014690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000146a0: 2020 2072 6574 7572 6e0d 0a20 2020 2020     return..     
+000146b0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+000146c0: 655f 6672 616d 6520 3d20 6366 672e 7365  e_frame = cfg.se
+000146d0: 5f61 6374 6976 655f 6672 616d 650d 0a20  _active_frame.. 
+000146e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000146f0: 2020 2053 6567 6d65 6e74 6174 696f 6e45     SegmentationE
+00014700: 6469 746f 722e 7069 636b 5f74 6162 5f69  ditor.pick_tab_i
+00014710: 6e64 6578 5f64 6174 6173 6574 735f 7365  ndex_datasets_se
+00014720: 6773 203d 2046 616c 7365 0d0a 2020 2020  gs = False..    
 00014730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014740: 7570 6461 7465 5f70 6963 6b69 6e67 5f74  update_picking_t
-00014750: 6162 5f66 6f72 5f6e 6577 5f61 6374 6976  ab_for_new_activ
-00014760: 655f 6672 616d 6528 290d 0a0d 0a20 2020  e_frame()....   
-00014770: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-00014780: 2073 2069 6e20 6366 672e 7365 5f73 7572   s in cfg.se_sur
-00014790: 6661 6365 5f6d 6f64 656c 733a 0d0a 2020  face_models:..  
-000147a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000147b0: 2020 7265 715f 6765 6e5f 6d6f 6465 6c73    req_gen_models
-000147c0: 203d 2046 616c 7365 0d0a 2020 2020 2020   = False..      
-000147d0: 2020 2020 2020 2020 2020 2020 2020 732e                s.
-000147e0: 6f6e 5f75 7064 6174 6528 290d 0a20 2020  on_update()..   
-000147f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014800: 2069 6620 732e 7072 6f63 6573 7320 6973   if s.process is
-00014810: 206e 6f74 204e 6f6e 653a 0d0a 2020 2020   not None:..    
-00014820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014830: 2020 2020 696d 6775 692e 7075 7368 5f73      imgui.push_s
-00014840: 7479 6c65 5f63 6f6c 6f72 2869 6d67 7569  tyle_color(imgui
-00014850: 2e43 4f4c 4f52 5f43 4849 4c44 5f42 4143  .COLOR_CHILD_BAC
-00014860: 4b47 524f 554e 442c 202a 732e 636f 6c6f  KGROUND, *s.colo
-00014870: 7572 2c20 2831 2e30 202d 2073 2e70 726f  ur, (1.0 - s.pro
-00014880: 6365 7373 2e70 726f 6772 6573 7329 202a  cess.progress) *
-00014890: 2030 2e33 290d 0a20 2020 2020 2020 2020   0.3)..         
-000148a0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000148b0: 6d67 7569 2e70 7573 685f 7374 796c 655f  mgui.push_style_
-000148c0: 636f 6c6f 7228 696d 6775 692e 434f 4c4f  color(imgui.COLO
-000148d0: 525f 5445 5854 2c20 2a63 6667 2e43 4f4c  R_TEXT, *cfg.COL
-000148e0: 4f55 525f 5445 5854 5f44 4953 4142 4c45  OUR_TEXT_DISABLE
-000148f0: 4429 0d0a 2020 2020 2020 2020 2020 2020  D)..            
-00014900: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-00014910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014920: 2020 2020 2020 2069 6d67 7569 2e70 7573         imgui.pus
-00014930: 685f 7374 796c 655f 636f 6c6f 7228 696d  h_style_color(im
-00014940: 6775 692e 434f 4c4f 525f 4348 494c 445f  gui.COLOR_CHILD_
-00014950: 4241 434b 4752 4f55 4e44 2c20 2a73 2e63  BACKGROUND, *s.c
-00014960: 6f6c 6f75 722c 2030 2e30 290d 0a20 2020  olour, 0.0)..   
-00014970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014980: 2020 2020 2069 6d67 7569 2e70 7573 685f       imgui.push_
-00014990: 7374 796c 655f 636f 6c6f 7228 696d 6775  style_color(imgu
-000149a0: 692e 434f 4c4f 525f 5445 5854 2c20 2a63  i.COLOR_TEXT, *c
-000149b0: 6667 2e43 4f4c 4f55 525f 5445 5854 290d  fg.COLOUR_TEXT).
-000149c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000149d0: 2020 2020 2069 6d67 7569 2e62 6567 696e       imgui.begin
-000149e0: 5f63 6869 6c64 2866 227b 732e 7469 746c  _child(f"{s.titl
-000149f0: 657d 5f73 7572 666d 222c 2030 2e30 2c20  e}_surfm", 0.0, 
-00014a00: 3832 202b 2028 3135 2069 6620 732e 7061  82 + (15 if s.pa
-00014a10: 7274 6963 6c65 7320 656c 7365 2030 292c  rticles else 0),
-00014a20: 2054 7275 6529 0d0a 2020 2020 2020 2020   True)..        
-00014a30: 2020 2020 2020 2020 2020 2020 6377 203d              cw =
-00014a40: 2069 6d67 7569 2e67 6574 5f63 6f6e 7465   imgui.get_conte
-00014a50: 6e74 5f72 6567 696f 6e5f 6176 6169 6c61  nt_region_availa
-00014a60: 626c 655f 7769 6474 6828 290d 0a20 2020  ble_width()..   
-00014a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014a80: 205f 2c20 732e 636f 6c6f 7572 203d 2069   _, s.colour = i
-00014a90: 6d67 7569 2e63 6f6c 6f72 5f65 6469 7433  mgui.color_edit3
-00014aa0: 2873 2e74 6974 6c65 2c20 2a73 2e63 6f6c  (s.title, *s.col
-00014ab0: 6f75 725b 3a33 5d2c 2069 6d67 7569 2e43  our[:3], imgui.C
-00014ac0: 4f4c 4f52 5f45 4449 545f 4e4f 5f49 4e50  OLOR_EDIT_NO_INP
-00014ad0: 5554 5320 7c20 696d 6775 692e 434f 4c4f  UTS | imgui.COLO
-00014ae0: 525f 4544 4954 5f4e 4f5f 4c41 4245 4c20  R_EDIT_NO_LABEL 
-00014af0: 7c20 696d 6775 692e 434f 4c4f 525f 4544  | imgui.COLOR_ED
-00014b00: 4954 5f4e 4f5f 544f 4f4c 5449 5020 7c20  IT_NO_TOOLTIP | 
-00014b10: 696d 6775 692e 434f 4c4f 525f 4544 4954  imgui.COLOR_EDIT
-00014b20: 5f4e 4f5f 4452 4147 5f44 524f 5029 0d0a  _NO_DRAG_DROP)..
-00014b30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00014b40: 2020 2020 2020 696d 6775 692e 7361 6d65        imgui.same
-00014b50: 5f6c 696e 6528 290d 0a20 2020 2020 2020  _line()..       
-00014b60: 2020 2020 2020 2020 2020 2020 2069 6d67               img
-00014b70: 7569 2e74 6578 7428 6622 7b73 2e74 6974  ui.text(f"{s.tit
-00014b80: 6c65 7d20 287b 732e 7369 7a65 5f6d 623a  le} ({s.size_mb:
-00014b90: 2e31 667d 206d 6229 2229 0d0a 2020 2020  .1f} mb)")..    
-00014ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014bb0: 696d 6775 692e 7075 7368 5f73 7479 6c65  imgui.push_style
-00014bc0: 5f76 6172 2869 6d67 7569 2e53 5459 4c45  _var(imgui.STYLE
-00014bd0: 5f47 5241 425f 524f 554e 4449 4e47 2c20  _GRAB_ROUNDING, 
-00014be0: 3230 290d 0a20 2020 2020 2020 2020 2020  20)..           
-00014bf0: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
-00014c00: 7573 685f 7374 796c 655f 7661 7228 696d  ush_style_var(im
-00014c10: 6775 692e 5354 594c 455f 4752 4142 5f4d  gui.STYLE_GRAB_M
-00014c20: 494e 5f53 495a 452c 2039 290d 0a20 2020  IN_SIZE, 9)..   
-00014c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014c40: 2069 6d67 7569 2e70 7573 685f 7374 796c   imgui.push_styl
-00014c50: 655f 7661 7228 696d 6775 692e 5354 594c  e_var(imgui.STYL
-00014c60: 455f 4652 414d 455f 424f 5244 4552 5349  E_FRAME_BORDERSI
-00014c70: 5a45 2c20 3129 0d0a 0d0a 2020 2020 2020  ZE, 1)....      
-00014c80: 2020 2020 2020 2020 2020 2020 2020 696d                im
-00014c90: 6775 692e 7361 6d65 5f6c 696e 6528 706f  gui.same_line(po
-00014ca0: 7369 7469 6f6e 203d 2063 7720 2d20 3430  sition = cw - 40
-00014cb0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00014cc0: 2020 2020 2020 205f 2c20 732e 6869 6465         _, s.hide
-00014cd0: 203d 2069 6d67 7569 2e63 6865 636b 626f   = imgui.checkbo
-00014ce0: 7828 2268 6964 6520 2022 2c20 732e 6869  x("hide  ", s.hi
-00014cf0: 6465 290d 0a20 2020 2020 2020 2020 2020  de)..           
-00014d00: 2020 2020 2020 2020 2023 2070 726f 6772           # progr
-00014d10: 6573 7320 6261 720d 0a20 2020 2020 2020  ess bar..       
-00014d20: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00014d30: 732e 7072 6f63 6573 7320 6973 206e 6f74  s.process is not
-00014d40: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
-00014d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014d60: 6966 2073 2e70 726f 6365 7373 2e70 726f  if s.process.pro
-00014d70: 6772 6573 7320 3d3d 2031 2e30 3a0d 0a20  gress == 1.0:.. 
-00014d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014d90: 2020 2020 2020 2020 2020 2073 2e70 726f             s.pro
-00014da0: 6365 7373 203d 204e 6f6e 650d 0a0d 0a20  cess = None.... 
-00014db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014dc0: 2020 2069 6d67 7569 2e70 7573 685f 6974     imgui.push_it
-00014dd0: 656d 5f77 6964 7468 2863 7729 0d0a 2020  em_width(cw)..  
-00014de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014df0: 2020 6f72 6967 696e 616c 5f6c 6576 656c    original_level
-00014e00: 203d 2073 2e6c 6576 656c 0d0a 2020 2020   = s.level..    
-00014e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014e20: 5f2c 2073 2e6c 6576 656c 203d 2069 6d67  _, s.level = img
-00014e30: 7569 2e73 6c69 6465 725f 696e 7428 2223  ui.slider_int("#
-00014e40: 236c 6576 656c 222c 2073 2e6c 6576 656c  #level", s.level
-00014e50: 2c20 302c 2032 3536 2c20 6622 6c65 7665  , 0, 256, f"leve
-00014e60: 6c20 3d20 7b73 2e6c 6576 656c 7d22 290d  l = {s.level}").
-00014e70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014e80: 2020 2020 2069 6620 732e 7072 6f63 6573       if s.proces
-00014e90: 7320 6973 206e 6f74 204e 6f6e 653a 0d0a  s is not None:..
-00014ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014eb0: 2020 2020 2020 2020 732e 6c65 7665 6c20          s.level 
-00014ec0: 3d20 6f72 6967 696e 616c 5f6c 6576 656c  = original_level
-00014ed0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00014ee0: 2020 2020 2020 2020 2020 5f20 3d20 4661            _ = Fa
-00014ef0: 6c73 650d 0a20 2020 2020 2020 2020 2020  lse..           
-00014f00: 2020 2020 2020 2020 2069 6620 5f20 616e           if _ an
-00014f10: 6420 6f72 6967 696e 616c 5f6c 6576 656c  d original_level
-00014f20: 2021 3d20 732e 6c65 7665 6c3a 0d0a 2020   != s.level:..  
-00014f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014f40: 2020 2020 2020 7265 715f 6765 6e5f 6d6f        req_gen_mo
-00014f50: 6465 6c73 203d 2054 7275 650d 0a0d 0a20  dels = True.... 
-00014f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014f70: 2020 205f 2c20 732e 6475 7374 203d 2069     _, s.dust = i
-00014f80: 6d67 7569 2e73 6c69 6465 725f 666c 6f61  mgui.slider_floa
-00014f90: 7428 2223 2364 7573 7422 2c20 732e 6475  t("##dust", s.du
-00014fa0: 7374 2c20 312e 302c 2031 3030 3030 3030  st, 1.0, 1000000
-00014fb0: 2e30 2c20 6622 6475 7374 203c 207b 732e  .0, f"dust < {s.
-00014fc0: 6475 7374 3a2e 3166 7d20 6e6d c2b3 222c  dust:.1f} nm..",
-00014fd0: 2069 6d67 7569 2e53 4c49 4445 525f 464c   imgui.SLIDER_FL
-00014fe0: 4147 535f 4c4f 4741 5249 5448 4d49 4329  AGS_LOGARITHMIC)
-00014ff0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00015000: 2020 2020 2020 732e 6869 6465 5f64 7573        s.hide_dus
-00015010: 7428 290d 0a20 2020 2020 2020 2020 2020  t()..           
-00015020: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
-00015030: 6f70 5f69 7465 6d5f 7769 6474 6828 290d  op_item_width().
-00015040: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015050: 2020 2020 2069 6620 732e 7061 7274 6963       if s.partic
-00015060: 6c65 733a 0d0a 2020 2020 2020 2020 2020  les:..          
-00015070: 2020 2020 2020 2020 2020 2020 2020 696d                im
-00015080: 6775 692e 7075 7368 5f69 7465 6d5f 7769  gui.push_item_wi
-00015090: 6474 6828 6377 202d 2032 3229 0d0a 2020  dth(cw - 22)..  
+00014740: 2320 6669 6e64 2073 6567 6d65 6e74 6174  # find segmentat
+00014750: 696f 6e73 2069 6e20 7468 6520 7365 6c65  ions in the sele
+00014760: 6374 6564 2064 6174 6173 6574 2773 2066  cted dataset's f
+00014770: 6f6c 6465 722e 0d0a 0d0a 0d0a 2020 2020  older.......    
+00014780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014790: 6669 6c65 7320 3d20 676c 6f62 2e67 6c6f  files = glob.glo
+000147a0: 6228 6f73 2e70 6174 682e 6a6f 696e 2853  b(os.path.join(S
+000147b0: 6567 6d65 6e74 6174 696f 6e45 6469 746f  egmentationEdito
+000147c0: 722e 7365 675f 666f 6c64 6572 2c20 6f73  r.seg_folder, os
+000147d0: 2e70 6174 682e 7370 6c69 7465 7874 2873  .path.splitext(s
+000147e0: 655f 6672 616d 652e 7469 746c 6529 5b30  e_frame.title)[0
+000147f0: 5d20 2b20 225f 5f2a 2e6d 7263 2229 290d  ] + "__*.mrc")).
+00014800: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014810: 2020 2020 2070 7269 6e74 2866 224c 6f6f       print(f"Loo
+00014820: 6b69 6e67 2066 6f72 2073 6567 6d65 6e74  king for segment
+00014830: 6174 696f 6e2e 6d72 6327 7320 7573 696e  ation.mrc's usin
+00014840: 6720 6669 6c65 6e61 6d65 2074 656d 706c  g filename templ
+00014850: 6174 6520 222c 206f 732e 7061 7468 2e6a  ate ", os.path.j
+00014860: 6f69 6e28 5365 676d 656e 7461 7469 6f6e  oin(Segmentation
+00014870: 4564 6974 6f72 2e73 6567 5f66 6f6c 6465  Editor.seg_folde
+00014880: 722c 206f 732e 7061 7468 2e73 706c 6974  r, os.path.split
+00014890: 6578 7428 7365 5f66 7261 6d65 2e74 6974  ext(se_frame.tit
+000148a0: 6c65 295b 305d 202b 2022 5f5f 2a2e 6d72  le)[0] + "__*.mr
+000148b0: 6322 2929 0d0a 2020 2020 2020 2020 2020  c"))..          
+000148c0: 2020 2020 2020 2020 2020 666f 7220 6620            for f 
+000148d0: 696e 2073 6f72 7465 6428 6669 6c65 7329  in sorted(files)
+000148e0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000148f0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+00014900: 2866 290d 0a20 2020 2020 2020 2020 2020  (f)..           
+00014910: 2020 2020 2020 2020 2020 2020 2063 6667               cfg
+00014920: 2e73 655f 7375 7266 6163 655f 6d6f 6465  .se_surface_mode
+00014930: 6c73 2e61 7070 656e 6428 5375 7266 6163  ls.append(Surfac
+00014940: 654d 6f64 656c 2866 2c20 7365 5f66 7261  eModel(f, se_fra
+00014950: 6d65 2e70 6978 656c 5f73 697a 6529 290d  me.pixel_size)).
+00014960: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+00014970: 2020 2020 2020 2023 2073 6574 2074 6865         # set the
+00014980: 2073 697a 6520 6f66 2074 6865 2076 6f6c   size of the vol
+00014990: 756d 6520 7370 616e 6e69 6e67 2062 6f78  ume spanning box
+000149a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000149b0: 2020 2020 2020 772c 2068 2c20 6420 3d20        w, h, d = 
+000149c0: 7365 5f66 7261 6d65 2e77 6964 7468 202f  se_frame.width /
+000149d0: 2032 2c20 7365 5f66 7261 6d65 2e68 6569   2, se_frame.hei
+000149e0: 6768 7420 2f20 322c 2073 655f 6672 616d  ght / 2, se_fram
+000149f0: 652e 6e5f 736c 6963 6573 202f 2032 0d0a  e.n_slices / 2..
+00014a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014a10: 2020 2020 7720 2a3d 2073 655f 6672 616d      w *= se_fram
+00014a20: 652e 7069 7865 6c5f 7369 7a65 0d0a 2020  e.pixel_size..  
+00014a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014a40: 2020 6820 2a3d 2073 655f 6672 616d 652e    h *= se_frame.
+00014a50: 7069 7865 6c5f 7369 7a65 0d0a 2020 2020  pixel_size..    
+00014a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014a70: 6420 2a3d 2073 655f 6672 616d 652e 7069  d *= se_frame.pi
+00014a80: 7865 6c5f 7369 7a65 0d0a 2020 2020 2020  xel_size..      
+00014a90: 2020 2020 2020 2020 2020 2020 2020 7665                ve
+00014aa0: 7274 6963 6573 203d 205b 2d77 2c20 682c  rtices = [-w, h,
+00014ab0: 2064 2c0d 0a20 2020 2020 2020 2020 2020   d,..           
+00014ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014ad0: 2020 2020 2077 2c20 682c 2064 2c0d 0a20       w, h, d,.. 
+00014ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014af0: 2020 2020 2020 2020 2020 2020 2020 2077                 w
+00014b00: 2c20 2d68 2c20 642c 0d0a 2020 2020 2020  , -h, d,..      
+00014b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014b20: 2020 2020 2020 2020 2020 2d77 2c20 2d68            -w, -h
+00014b30: 2c20 642c 0d0a 2020 2020 2020 2020 2020  , d,..          
+00014b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014b50: 2020 2020 2020 2d77 2c20 682c 202d 642c        -w, h, -d,
+00014b60: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00014b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014b80: 2020 772c 2068 2c20 2d64 2c0d 0a20 2020    w, h, -d,..   
+00014b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014ba0: 2020 2020 2020 2020 2020 2020 2077 2c20               w, 
+00014bb0: 2d68 2c20 2d64 2c0d 0a20 2020 2020 2020  -h, -d,..       
+00014bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014bd0: 2020 2020 2020 2020 202d 772c 202d 682c           -w, -h,
+00014be0: 202d 645d 0d0a 2020 2020 2020 2020 2020   -d]..          
+00014bf0: 2020 2020 2020 2020 2020 6c69 6e65 5f69            line_i
+00014c00: 6e64 6963 6573 203d 205b 302c 2031 2c20  ndices = [0, 1, 
+00014c10: 312c 2032 2c20 322c 2033 2c20 332c 2030  1, 2, 2, 3, 3, 0
+00014c20: 2c20 302c 2034 2c20 312c 2035 2c20 322c  , 0, 4, 1, 5, 2,
+00014c30: 2036 2c20 332c 2037 2c20 342c 2035 2c20   6, 3, 7, 4, 5, 
+00014c40: 352c 2036 2c20 362c 2037 2c20 372c 2034  5, 6, 6, 7, 7, 4
+00014c50: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
+00014c60: 2020 2020 2020 2071 7561 645f 696e 6469         quad_indi
+00014c70: 6365 7320 3d20 5b30 2c20 312c 2032 2c20  ces = [0, 1, 2, 
+00014c80: 322c 2033 2c20 302c 2034 2c20 352c 2036  2, 3, 0, 4, 5, 6
+00014c90: 2c20 362c 2037 2c20 342c 2030 2c20 342c  , 6, 7, 4, 0, 4,
+00014ca0: 2037 2c20 372c 2033 2c20 302c 2035 2c20   7, 7, 3, 0, 5, 
+00014cb0: 312c 2032 2c20 322c 2036 2c20 352c 2034  1, 2, 2, 6, 5, 4
+00014cc0: 2c20 302c 2031 2c20 312c 2035 2c20 342c  , 0, 1, 1, 5, 4,
+00014cd0: 2033 2c20 372c 2036 2c20 362c 2032 2c20   3, 7, 6, 6, 2, 
+00014ce0: 335d 0d0a 2020 2020 2020 2020 2020 2020  3]..            
+00014cf0: 2020 2020 2020 2020 7365 6c66 2e70 6963          self.pic
+00014d00: 6b5f 626f 785f 7661 2e75 7064 6174 6528  k_box_va.update(
+00014d10: 5665 7274 6578 4275 6666 6572 2876 6572  VertexBuffer(ver
+00014d20: 7469 6365 7329 2c20 496e 6465 7842 7566  tices), IndexBuf
+00014d30: 6665 7228 6c69 6e65 5f69 6e64 6963 6573  fer(line_indices
+00014d40: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
+00014d50: 2020 2020 2020 2020 7365 6c66 2e70 6963          self.pic
+00014d60: 6b5f 626f 785f 7175 6164 5f76 612e 7570  k_box_quad_va.up
+00014d70: 6461 7465 2856 6572 7465 7842 7566 6665  date(VertexBuffe
+00014d80: 7228 7665 7274 6963 6573 292c 2049 6e64  r(vertices), Ind
+00014d90: 6578 4275 6666 6572 2871 7561 645f 696e  exBuffer(quad_in
+00014da0: 6469 6365 7329 290d 0a0d 0a0d 0a20 2020  dices))......   
+00014db0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00014dc0: 5365 676d 656e 7461 7469 6f6e 4564 6974  SegmentationEdit
+00014dd0: 6f72 2e70 6963 6b5f 7461 625f 696e 6465  or.pick_tab_inde
+00014de0: 785f 6461 7461 7365 7473 5f73 6567 7320  x_datasets_segs 
+00014df0: 6f72 2073 7263 5f66 6f6c 6465 725f 6368  or src_folder_ch
+00014e00: 616e 6765 643a 0d0a 2020 2020 2020 2020  anged:..        
+00014e10: 2020 2020 2020 2020 2020 2020 7570 6461              upda
+00014e20: 7465 5f70 6963 6b69 6e67 5f74 6162 5f66  te_picking_tab_f
+00014e30: 6f72 5f6e 6577 5f61 6374 6976 655f 6672  or_new_active_fr
+00014e40: 616d 6528 290d 0a0d 0a20 2020 2020 2020  ame()....       
+00014e50: 2020 2020 2020 2020 2066 6f72 2073 2069           for s i
+00014e60: 6e20 6366 672e 7365 5f73 7572 6661 6365  n cfg.se_surface
+00014e70: 5f6d 6f64 656c 733a 0d0a 2020 2020 2020  _models:..      
+00014e80: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00014e90: 715f 6765 6e5f 6d6f 6465 6c73 203d 2046  q_gen_models = F
+00014ea0: 616c 7365 0d0a 2020 2020 2020 2020 2020  alse..          
+00014eb0: 2020 2020 2020 2020 2020 732e 6f6e 5f75            s.on_u
+00014ec0: 7064 6174 6528 290d 0a20 2020 2020 2020  pdate()..       
+00014ed0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00014ee0: 732e 7072 6f63 6573 7320 6973 206e 6f74  s.process is not
+00014ef0: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
+00014f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014f10: 696d 6775 692e 7075 7368 5f73 7479 6c65  imgui.push_style
+00014f20: 5f63 6f6c 6f72 2869 6d67 7569 2e43 4f4c  _color(imgui.COL
+00014f30: 4f52 5f43 4849 4c44 5f42 4143 4b47 524f  OR_CHILD_BACKGRO
+00014f40: 554e 442c 202a 732e 636f 6c6f 7572 2c20  UND, *s.colour, 
+00014f50: 2831 2e30 202d 2073 2e70 726f 6365 7373  (1.0 - s.process
+00014f60: 2e70 726f 6772 6573 7329 202a 2030 2e33  .progress) * 0.3
+00014f70: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00014f80: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
+00014f90: 2e70 7573 685f 7374 796c 655f 636f 6c6f  .push_style_colo
+00014fa0: 7228 696d 6775 692e 434f 4c4f 525f 5445  r(imgui.COLOR_TE
+00014fb0: 5854 2c20 2a63 6667 2e43 4f4c 4f55 525f  XT, *cfg.COLOUR_
+00014fc0: 5445 5854 5f44 4953 4142 4c45 4429 0d0a  TEXT_DISABLED)..
+00014fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014fe0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00014ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015000: 2020 2069 6d67 7569 2e70 7573 685f 7374     imgui.push_st
+00015010: 796c 655f 636f 6c6f 7228 696d 6775 692e  yle_color(imgui.
+00015020: 434f 4c4f 525f 4348 494c 445f 4241 434b  COLOR_CHILD_BACK
+00015030: 4752 4f55 4e44 2c20 2a73 2e63 6f6c 6f75  GROUND, *s.colou
+00015040: 722c 2030 2e30 290d 0a20 2020 2020 2020  r, 0.0)..       
+00015050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015060: 2069 6d67 7569 2e70 7573 685f 7374 796c   imgui.push_styl
+00015070: 655f 636f 6c6f 7228 696d 6775 692e 434f  e_color(imgui.CO
+00015080: 4c4f 525f 5445 5854 2c20 2a63 6667 2e43  LOR_TEXT, *cfg.C
+00015090: 4f4c 4f55 525f 5445 5854 290d 0a20 2020  OLOUR_TEXT)..   
 000150a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000150b0: 2020 2020 2020 5f2c 2073 2e70 6172 7469        _, s.parti
-000150c0: 636c 655f 7369 7a65 203d 2069 6d67 7569  cle_size = imgui
-000150d0: 2e73 6c69 6465 725f 666c 6f61 7428 2223  .slider_float("#
-000150e0: 2370 6172 7469 636c 6522 2c20 732e 7061  #particle", s.pa
-000150f0: 7274 6963 6c65 5f73 697a 652c 2030 2e30  rticle_size, 0.0
-00015100: 2c20 3235 2e30 2c20 2268 6964 6520 7061  , 25.0, "hide pa
-00015110: 7274 6963 6c65 7322 2069 6620 732e 7061  rticles" if s.pa
-00015120: 7274 6963 6c65 5f73 697a 6520 3d3d 2030  rticle_size == 0
-00015130: 2065 6c73 6520 6622 7061 7274 6963 6c65   else f"particle
-00015140: 2073 697a 6520 3d20 7b73 2e70 6172 7469   size = {s.parti
-00015150: 636c 655f 7369 7a65 3a2e 3166 7d20 6e6d  cle_size:.1f} nm
-00015160: 2229 0d0a 2020 2020 2020 2020 2020 2020  ")..            
-00015170: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
-00015180: 692e 7361 6d65 5f6c 696e 6528 290d 0a20  i.same_line().. 
-00015190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000151a0: 2020 2020 2020 205f 2c20 732e 7061 7274         _, s.part
-000151b0: 6963 6c65 5f63 6f6c 6f75 7220 3d20 696d  icle_colour = im
-000151c0: 6775 692e 636f 6c6f 725f 6564 6974 3328  gui.color_edit3(
-000151d0: 732e 7469 746c 652b 2270 636c 7222 2c20  s.title+"pclr", 
-000151e0: 2a73 2e70 6172 7469 636c 655f 636f 6c6f  *s.particle_colo
-000151f0: 7572 5b3a 335d 2c20 696d 6775 692e 434f  ur[:3], imgui.CO
-00015200: 4c4f 525f 4544 4954 5f4e 4f5f 494e 5055  LOR_EDIT_NO_INPU
-00015210: 5453 207c 2069 6d67 7569 2e43 4f4c 4f52  TS | imgui.COLOR
-00015220: 5f45 4449 545f 4e4f 5f4c 4142 454c 207c  _EDIT_NO_LABEL |
-00015230: 2069 6d67 7569 2e43 4f4c 4f52 5f45 4449   imgui.COLOR_EDI
-00015240: 545f 4e4f 5f54 4f4f 4c54 4950 207c 2069  T_NO_TOOLTIP | i
-00015250: 6d67 7569 2e43 4f4c 4f52 5f45 4449 545f  mgui.COLOR_EDIT_
-00015260: 4e4f 5f44 5241 475f 4452 4f50 290d 0a20  NO_DRAG_DROP).. 
-00015270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015280: 2020 2020 2020 2069 6d67 7569 2e70 6f70         imgui.pop
-00015290: 5f69 7465 6d5f 7769 6474 6828 290d 0a20  _item_width().. 
-000152a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000152b0: 2020 2069 6d67 7569 2e70 7573 685f 6974     imgui.push_it
-000152c0: 656d 5f77 6964 7468 2828 6377 202d 2037  em_width((cw - 7
-000152d0: 2920 2f20 3229 0d0a 2020 2020 2020 2020  ) / 2)..        
-000152e0: 2020 2020 2020 2020 2020 2020 5f2c 2073              _, s
-000152f0: 2e61 6c70 6861 203d 2069 6d67 7569 2e73  .alpha = imgui.s
-00015300: 6c69 6465 725f 666c 6f61 7428 2223 2361  lider_float("##a
-00015310: 6c70 6861 222c 2073 2e61 6c70 6861 2c20  lpha", s.alpha, 
-00015320: 302c 2031 2e30 2c20 6622 616c 7068 6120  0, 1.0, f"alpha 
-00015330: 3d20 7b73 2e61 6c70 6861 3a2e 3166 7d22  = {s.alpha:.1f}"
-00015340: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00015350: 2020 2020 2020 2069 6d67 7569 2e73 616d         imgui.sam
-00015360: 655f 6c69 6e65 2829 0d0a 2020 2020 2020  e_line()..      
-00015370: 2020 2020 2020 2020 2020 2020 2020 6f72                or
-00015380: 6967 696e 616c 5f62 696e 203d 2073 2e62  iginal_bin = s.b
-00015390: 696e 0d0a 2020 2020 2020 2020 2020 2020  in..            
-000153a0: 2020 2020 2020 2020 5f2c 2073 2e62 696e          _, s.bin
-000153b0: 203d 2069 6d67 7569 2e73 6c69 6465 725f   = imgui.slider_
-000153c0: 696e 7428 2223 2362 696e 222c 2073 2e62  int("##bin", s.b
-000153d0: 696e 2c20 312c 2038 2c20 6622 6269 6e20  in, 1, 8, f"bin 
-000153e0: 7b73 2e62 696e 7d22 290d 0a20 2020 2020  {s.bin}")..     
-000153f0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00015400: 6620 5f20 616e 6420 6f72 6967 696e 616c  f _ and original
-00015410: 5f62 696e 2021 3d20 732e 6269 6e3a 0d0a  _bin != s.bin:..
-00015420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015430: 2020 2020 2020 2020 7265 715f 6765 6e5f          req_gen_
-00015440: 6d6f 6465 6c73 203d 2054 7275 650d 0a0d  models = True...
-00015450: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
-00015460: 2020 2020 2020 2069 6620 7265 715f 6765         if req_ge
-00015470: 6e5f 6d6f 6465 6c73 3a0d 0a20 2020 2020  n_models:..     
-00015480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015490: 2020 2073 2e67 656e 6572 6174 655f 6d6f     s.generate_mo
-000154a0: 6465 6c28 290d 0a0d 0a20 2020 2020 2020  del()....       
-000154b0: 2020 2020 2020 2020 2020 2020 2069 6d67               img
-000154c0: 7569 2e70 6f70 5f69 7465 6d5f 7769 6474  ui.pop_item_widt
-000154d0: 6828 290d 0a20 2020 2020 2020 2020 2020  h()..           
-000154e0: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
-000154f0: 6f70 5f73 7479 6c65 5f76 6172 2833 290d  op_style_var(3).
-00015500: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015510: 2020 2020 2069 6d67 7569 2e70 6f70 5f73       imgui.pop_s
-00015520: 7479 6c65 5f63 6f6c 6f72 2832 290d 0a20  tyle_color(2).. 
-00015530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015540: 2020 2069 6620 696d 6775 692e 6265 6769     if imgui.begi
-00015550: 6e5f 706f 7075 705f 636f 6e74 6578 745f  n_popup_context_
-00015560: 7769 6e64 6f77 2829 3a0d 0a20 2020 2020  window():..     
-00015570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015580: 2020 2073 656c 662e 6578 7472 6163 745f     self.extract_
-00015590: 636f 6f72 6469 6e61 7465 735f 6d65 6e75  coordinates_menu
-000155a0: 2873 290d 0a20 2020 2020 2020 2020 2020  (s)..           
-000155b0: 2020 2020 2020 2020 2020 2020 2069 6d67               img
-000155c0: 7569 2e65 6e64 5f70 6f70 7570 2829 0d0a  ui.end_popup()..
-000155d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000155e0: 2020 2020 696d 6775 692e 656e 645f 6368      imgui.end_ch
-000155f0: 696c 6428 290d 0a0d 0a20 2020 2020 2020  ild()....       
-00015600: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
-00015610: 6f70 5f73 7479 6c65 5f76 6172 2833 290d  op_style_var(3).
-00015620: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015630: 2069 6d67 7569 2e70 6f70 5f73 7479 6c65   imgui.pop_style
-00015640: 5f63 6f6c 6f72 2831 290d 0a0d 0a20 2020  _color(1)....   
-00015650: 2020 2020 2020 2020 2053 6567 6d65 6e74           Segment
-00015660: 6174 696f 6e45 6469 746f 722e 4c49 4748  ationEditor.LIGH
-00015670: 545f 5350 4f54 2e63 6f6d 7075 7465 5f76  T_SPOT.compute_v
-00015680: 6563 2864 7961 773d 2d73 656c 662e 6361  ec(dyaw=-self.ca
-00015690: 6d65 7261 3364 2e79 6177 290d 0a20 2020  mera3d.yaw)..   
-000156a0: 2020 2020 2020 2020 2069 6620 696d 6775           if imgu
-000156b0: 692e 636f 6c6c 6170 7369 6e67 5f68 6561  i.collapsing_hea
-000156c0: 6465 7228 2247 7261 7068 6963 7320 7365  der("Graphics se
-000156d0: 7474 696e 6773 222c 204e 6f6e 6529 5b30  ttings", None)[0
-000156e0: 5d3a 0d0a 2020 2020 2020 2020 2020 2020  ]:..            
-000156f0: 2020 2020 696d 6775 692e 7075 7368 5f73      imgui.push_s
-00015700: 7479 6c65 5f76 6172 2869 6d67 7569 2e53  tyle_var(imgui.S
-00015710: 5459 4c45 5f46 5241 4d45 5f42 4f52 4445  TYLE_FRAME_BORDE
-00015720: 5253 495a 452c 2031 290d 0a20 2020 2020  RSIZE, 1)..     
-00015730: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
-00015740: 2e70 7573 685f 7374 796c 655f 7661 7228  .push_style_var(
-00015750: 696d 6775 692e 5354 594c 455f 4652 414d  imgui.STYLE_FRAM
-00015760: 455f 5041 4444 494e 472c 2028 322c 2032  E_PADDING, (2, 2
-00015770: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
-00015780: 2020 2020 6377 203d 2069 6d67 7569 2e67      cw = imgui.g
-00015790: 6574 5f63 6f6e 7465 6e74 5f72 6567 696f  et_content_regio
-000157a0: 6e5f 6176 6169 6c61 626c 655f 7769 6474  n_available_widt
-000157b0: 6828 290d 0a20 2020 2020 2020 2020 2020  h()..           
-000157c0: 2020 2020 2069 6d67 7569 2e61 6c69 676e       imgui.align
-000157d0: 5f74 6578 745f 746f 5f66 7261 6d65 5f70  _text_to_frame_p
-000157e0: 6164 6469 6e67 2829 0d0a 2020 2020 2020  adding()..      
-000157f0: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
-00015800: 7465 7874 2822 566f 6c75 6d65 2072 656e  text("Volume ren
-00015810: 6465 7220 7374 796c 653a 2229 0d0a 2020  der style:")..  
-00015820: 2020 2020 2020 2020 2020 2020 2020 696d                im
-00015830: 6775 692e 7361 6d65 5f6c 696e 6528 290d  gui.same_line().
-00015840: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015850: 2069 6d67 7569 2e70 7573 685f 6974 656d   imgui.push_item
-00015860: 5f77 6964 7468 2863 7720 2d20 3134 3529  _width(cw - 145)
-00015870: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00015880: 2020 5f2c 2053 6567 6d65 6e74 6174 696f    _, Segmentatio
-00015890: 6e45 6469 746f 722e 5345 4c45 4354 4544  nEditor.SELECTED
-000158a0: 5f52 454e 4445 525f 5354 594c 4520 3d20  _RENDER_STYLE = 
-000158b0: 696d 6775 692e 636f 6d62 6f28 2223 2347  imgui.combo("##G
-000158c0: 7261 7068 6963 7320 7374 796c 6522 2c20  raphics style", 
-000158d0: 5365 676d 656e 7461 7469 6f6e 4564 6974  SegmentationEdit
-000158e0: 6f72 2e53 454c 4543 5445 445f 5245 4e44  or.SELECTED_REND
-000158f0: 4552 5f53 5459 4c45 2c20 5365 676d 656e  ER_STYLE, Segmen
-00015900: 7461 7469 6f6e 4564 6974 6f72 2e52 454e  tationEditor.REN
-00015910: 4445 525f 5354 594c 4553 290d 0a20 2020  DER_STYLES)..   
-00015920: 2020 2020 2020 2020 2020 2020 2069 6d67               img
-00015930: 7569 2e70 6f70 5f69 7465 6d5f 7769 6474  ui.pop_item_widt
-00015940: 6828 290d 0a20 2020 2020 2020 2020 2020  h()..           
-00015950: 2020 2020 205f 2c20 5365 676d 656e 7461       _, Segmenta
-00015960: 7469 6f6e 4564 6974 6f72 2e52 454e 4445  tionEditor.RENDE
-00015970: 525f 434c 4541 525f 434f 4c4f 5552 203d  R_CLEAR_COLOUR =
-00015980: 2069 6d67 7569 2e63 6f6c 6f72 5f65 6469   imgui.color_edi
-00015990: 7433 2822 2323 636c 7263 6c72 222c 202a  t3("##clrclr", *
-000159a0: 5365 676d 656e 7461 7469 6f6e 4564 6974  SegmentationEdit
-000159b0: 6f72 2e52 454e 4445 525f 434c 4541 525f  or.RENDER_CLEAR_
-000159c0: 434f 4c4f 5552 5b3a 335d 2c20 696d 6775  COLOUR[:3], imgu
-000159d0: 692e 434f 4c4f 525f 4544 4954 5f4e 4f5f  i.COLOR_EDIT_NO_
-000159e0: 494e 5055 5453 207c 2069 6d67 7569 2e43  INPUTS | imgui.C
-000159f0: 4f4c 4f52 5f45 4449 545f 4e4f 5f4c 4142  OLOR_EDIT_NO_LAB
-00015a00: 454c 207c 2069 6d67 7569 2e43 4f4c 4f52  EL | imgui.COLOR
-00015a10: 5f45 4449 545f 4e4f 5f54 4f4f 4c54 4950  _EDIT_NO_TOOLTIP
-00015a20: 207c 2069 6d67 7569 2e43 4f4c 4f52 5f45   | imgui.COLOR_E
-00015a30: 4449 545f 4e4f 5f44 5241 475f 4452 4f50  DIT_NO_DRAG_DROP
-00015a40: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00015a50: 2020 2069 6d67 7569 2e73 616d 655f 6c69     imgui.same_li
-00015a60: 6e65 2829 0d0a 2020 2020 2020 2020 2020  ne()..          
-00015a70: 2020 2020 2020 696d 6775 692e 616c 6967        imgui.alig
-00015a80: 6e5f 7465 7874 5f74 6f5f 6672 616d 655f  n_text_to_frame_
-00015a90: 7061 6464 696e 6728 290d 0a20 2020 2020  padding()..     
-00015aa0: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
-00015ab0: 2e74 6578 7428 2220 4261 636b 6772 6f75  .text(" Backgrou
-00015ac0: 6e64 2063 6f6c 6f75 7220 2020 2020 2229  nd colour     ")
-00015ad0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00015ae0: 2020 696d 6775 692e 7361 6d65 5f6c 696e    imgui.same_lin
-00015af0: 6528 290d 0a20 2020 2020 2020 2020 2020  e()..           
-00015b00: 2020 2020 205f 2c20 5365 676d 656e 7461       _, Segmenta
-00015b10: 7469 6f6e 4564 6974 6f72 2e4c 4947 4854  tionEditor.LIGHT
-00015b20: 5f53 504f 542e 636f 6c6f 7572 203d 2069  _SPOT.colour = i
-00015b30: 6d67 7569 2e63 6f6c 6f72 5f65 6469 7433  mgui.color_edit3
-00015b40: 2822 2323 6c69 6768 7463 6c72 222c 202a  ("##lightclr", *
-00015b50: 5365 676d 656e 7461 7469 6f6e 4564 6974  SegmentationEdit
-00015b60: 6f72 2e4c 4947 4854 5f53 504f 542e 636f  or.LIGHT_SPOT.co
-00015b70: 6c6f 7572 5b3a 335d 2c20 696d 6775 692e  lour[:3], imgui.
-00015b80: 434f 4c4f 525f 4544 4954 5f4e 4f5f 494e  COLOR_EDIT_NO_IN
-00015b90: 5055 5453 207c 2069 6d67 7569 2e43 4f4c  PUTS | imgui.COL
-00015ba0: 4f52 5f45 4449 545f 4e4f 5f4c 4142 454c  OR_EDIT_NO_LABEL
-00015bb0: 207c 2069 6d67 7569 2e43 4f4c 4f52 5f45   | imgui.COLOR_E
-00015bc0: 4449 545f 4e4f 5f54 4f4f 4c54 4950 207c  DIT_NO_TOOLTIP |
-00015bd0: 2069 6d67 7569 2e43 4f4c 4f52 5f45 4449   imgui.COLOR_EDI
-00015be0: 545f 4e4f 5f44 5241 475f 4452 4f50 290d  T_NO_DRAG_DROP).
-00015bf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015c00: 2069 6d67 7569 2e73 616d 655f 6c69 6e65   imgui.same_line
-00015c10: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
-00015c20: 2020 2020 696d 6775 692e 616c 6967 6e5f      imgui.align_
-00015c30: 7465 7874 5f74 6f5f 6672 616d 655f 7061  text_to_frame_pa
-00015c40: 6464 696e 6728 290d 0a20 2020 2020 2020  dding()..       
-00015c50: 2020 2020 2020 2020 2069 6d67 7569 2e74           imgui.t
-00015c60: 6578 7428 2220 4c69 6768 7420 636f 6c6f  ext(" Light colo
-00015c70: 7572 2229 0d0a 0d0a 2020 2020 2020 2020  ur")....        
-00015c80: 2020 2020 2020 2020 696d 6775 692e 7075          imgui.pu
-00015c90: 7368 5f73 7479 6c65 5f76 6172 2869 6d67  sh_style_var(img
-00015ca0: 7569 2e53 5459 4c45 5f46 5241 4d45 5f52  ui.STYLE_FRAME_R
-00015cb0: 4f55 4e44 494e 472c 2031 3029 0d0a 2020  OUNDING, 10)..  
-00015cc0: 2020 2020 2020 2020 2020 2020 2020 696d                im
-00015cd0: 6775 692e 7075 7368 5f73 7479 6c65 5f76  gui.push_style_v
-00015ce0: 6172 2869 6d67 7569 2e53 5459 4c45 5f46  ar(imgui.STYLE_F
-00015cf0: 5241 4d45 5f50 4144 4449 4e47 2c20 2830  RAME_PADDING, (0
-00015d00: 2c20 3029 290d 0a20 2020 2020 2020 2020  , 0))..         
-00015d10: 2020 2020 2020 2069 6d67 7569 2e70 7573         imgui.pus
-00015d20: 685f 7374 796c 655f 7661 7228 696d 6775  h_style_var(imgu
-00015d30: 692e 5354 594c 455f 4752 4142 5f52 4f55  i.STYLE_GRAB_ROU
-00015d40: 4e44 494e 472c 2031 3029 0d0a 2020 2020  NDING, 10)..    
-00015d50: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
-00015d60: 692e 7075 7368 5f69 7465 6d5f 7769 6474  i.push_item_widt
-00015d70: 6828 6377 290d 0a20 2020 2020 2020 2020  h(cw)..         
-00015d80: 2020 2020 2020 205f 2c20 5365 676d 656e         _, Segmen
-00015d90: 7461 7469 6f6e 4564 6974 6f72 2e4c 4947  tationEditor.LIG
-00015da0: 4854 5f41 4d42 4945 4e54 5f53 5452 454e  HT_AMBIENT_STREN
-00015db0: 4754 4820 3d20 696d 6775 692e 736c 6964  GTH = imgui.slid
-00015dc0: 6572 5f66 6c6f 6174 2822 2323 616d 6269  er_float("##ambi
-00015dd0: 656e 7420 6c69 6768 7469 6e67 222c 2053  ent lighting", S
-00015de0: 6567 6d65 6e74 6174 696f 6e45 6469 746f  egmentationEdito
-00015df0: 722e 4c49 4748 545f 414d 4249 454e 545f  r.LIGHT_AMBIENT_
-00015e00: 5354 5245 4e47 5448 2c20 302e 302c 2031  STRENGTH, 0.0, 1
-00015e10: 2e30 2c20 6622 616d 6269 656e 7420 7374  .0, f"ambient st
-00015e20: 7265 6e67 7468 203d 2025 2e32 6622 290d  rength = %.2f").
-00015e30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015e40: 205f 2c20 5365 676d 656e 7461 7469 6f6e   _, Segmentation
-00015e50: 4564 6974 6f72 2e4c 4947 4854 5f53 504f  Editor.LIGHT_SPO
-00015e60: 542e 7374 7265 6e67 7468 203d 2069 6d67  T.strength = img
-00015e70: 7569 2e73 6c69 6465 725f 666c 6f61 7428  ui.slider_float(
-00015e80: 2223 2373 706f 7420 6c69 6768 7469 6e67  "##spot lighting
-00015e90: 222c 2053 6567 6d65 6e74 6174 696f 6e45  ", SegmentationE
-00015ea0: 6469 746f 722e 4c49 4748 545f 5350 4f54  ditor.LIGHT_SPOT
-00015eb0: 2e73 7472 656e 6774 682c 2030 2e30 2c20  .strength, 0.0, 
-00015ec0: 312e 302c 2066 2273 706f 7420 7374 7265  1.0, f"spot stre
-00015ed0: 6e67 7468 203d 2025 2e32 6622 290d 0a20  ngth = %.2f").. 
-00015ee0: 2020 2020 2020 2020 2020 2020 2020 205f                 _
-00015ef0: 7961 772c 2053 6567 6d65 6e74 6174 696f  yaw, Segmentatio
-00015f00: 6e45 6469 746f 722e 4c49 4748 545f 5350  nEditor.LIGHT_SP
-00015f10: 4f54 2e79 6177 203d 2069 6d67 7569 2e64  OT.yaw = imgui.d
-00015f20: 7261 675f 666c 6f61 7428 2223 2379 6177  rag_float("##yaw
-00015f30: 222c 2053 6567 6d65 6e74 6174 696f 6e45  ", SegmentationE
-00015f40: 6469 746f 722e 4c49 4748 545f 5350 4f54  ditor.LIGHT_SPOT
-00015f50: 2e79 6177 2c20 302e 352c 2066 6f72 6d61  .yaw, 0.5, forma
-00015f60: 743d 6622 7370 6f74 2079 6177 203d 2025  t=f"spot yaw = %
-00015f70: 2e31 6622 290d 0a20 2020 2020 2020 2020  .1f")..         
-00015f80: 2020 2020 2020 205f 7069 7463 682c 2053         _pitch, S
-00015f90: 6567 6d65 6e74 6174 696f 6e45 6469 746f  egmentationEdito
-00015fa0: 722e 4c49 4748 545f 5350 4f54 2e70 6974  r.LIGHT_SPOT.pit
-00015fb0: 6368 203d 2069 6d67 7569 2e73 6c69 6465  ch = imgui.slide
-00015fc0: 725f 666c 6f61 7428 2223 2370 6974 6368  r_float("##pitch
-00015fd0: 222c 2053 6567 6d65 6e74 6174 696f 6e45  ", SegmentationE
-00015fe0: 6469 746f 722e 4c49 4748 545f 5350 4f54  ditor.LIGHT_SPOT
-00015ff0: 2e70 6974 6368 2c20 2d39 302e 302c 2039  .pitch, -90.0, 9
-00016000: 302e 302c 2066 6f72 6d61 743d 6622 7370  0.0, format=f"sp
-00016010: 6f74 2070 6974 6368 203d 2025 2e31 6622  ot pitch = %.1f"
-00016020: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00016030: 2020 2069 6d67 7569 2e70 6f70 5f69 7465     imgui.pop_ite
-00016040: 6d5f 7769 6474 6828 290d 0a0d 0a20 2020  m_width()....   
-00016050: 2020 2020 2020 2020 2020 2020 2069 6d67               img
-00016060: 7569 2e70 7573 685f 7374 796c 655f 636f  ui.push_style_co
-00016070: 6c6f 7228 696d 6775 692e 434f 4c4f 525f  lor(imgui.COLOR_
-00016080: 4348 4543 4b5f 4d41 524b 2c20 302e 302c  CHECK_MARK, 0.0,
-00016090: 2030 2e30 2c20 302e 3029 0d0a 2020 2020   0.0, 0.0)..    
-000160a0: 2020 2020 2020 2020 2020 2020 5f2c 2053              _, S
-000160b0: 6567 6d65 6e74 6174 696f 6e45 6469 746f  egmentationEdito
-000160c0: 722e 5245 4e44 4552 5f42 4f58 203d 2069  r.RENDER_BOX = i
-000160d0: 6d67 7569 2e63 6865 636b 626f 7828 2220  mgui.checkbox(" 
-000160e0: 7265 6e64 6572 2062 6f75 6e64 696e 6720  render bounding 
-000160f0: 626f 7820 2020 222c 2053 6567 6d65 6e74  box   ", Segment
-00016100: 6174 696f 6e45 6469 746f 722e 5245 4e44  ationEditor.REND
-00016110: 4552 5f42 4f58 290d 0a0d 0a20 2020 2020  ER_BOX)....     
-00016120: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
-00016130: 2e73 616d 655f 6c69 6e65 2829 0d0a 2020  .same_line()..  
-00016140: 2020 2020 2020 2020 2020 2020 2020 5f72                _r
-00016150: 656e 6465 725f 6672 616d 6520 3d20 5365  ender_frame = Se
-00016160: 676d 656e 7461 7469 6f6e 4564 6974 6f72  gmentationEditor
-00016170: 2e50 4943 4b49 4e47 5f46 5241 4d45 5f41  .PICKING_FRAME_A
-00016180: 4c50 4841 2021 3d20 302e 300d 0a20 2020  LPHA != 0.0..   
-00016190: 2020 2020 2020 2020 2020 2020 205f 722c               _r,
-000161a0: 205f 7265 6e64 6572 5f66 7261 6d65 203d   _render_frame =
-000161b0: 2069 6d67 7569 2e63 6865 636b 626f 7828   imgui.checkbox(
-000161c0: 2272 656e 6465 7220 6672 616d 6522 2c20  "render frame", 
-000161d0: 5f72 656e 6465 725f 6672 616d 6529 0d0a  _render_frame)..
-000161e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000161f0: 6966 205f 723a 0d0a 2020 2020 2020 2020  if _r:..        
-00016200: 2020 2020 2020 2020 2020 2020 5365 676d              Segm
-00016210: 656e 7461 7469 6f6e 4564 6974 6f72 2e50  entationEditor.P
-00016220: 4943 4b49 4e47 5f46 5241 4d45 5f41 4c50  ICKING_FRAME_ALP
-00016230: 4841 203d 2066 6c6f 6174 285f 7265 6e64  HA = float(_rend
-00016240: 6572 5f66 7261 6d65 290d 0a20 2020 2020  er_frame)..     
-00016250: 2020 2020 2020 2020 2020 205f 2c20 5365             _, Se
-00016260: 676d 656e 7461 7469 6f6e 4564 6974 6f72  gmentationEditor
-00016270: 2e52 454e 4445 525f 5041 5254 4943 4c45  .RENDER_PARTICLE
-00016280: 535f 5852 4159 203d 2069 6d67 7569 2e63  S_XRAY = imgui.c
-00016290: 6865 636b 626f 7828 2220 7061 7274 6963  heckbox(" partic
-000162a0: 6c65 2078 2d72 6179 222c 2053 6567 6d65  le x-ray", Segme
-000162b0: 6e74 6174 696f 6e45 6469 746f 722e 5245  ntationEditor.RE
-000162c0: 4e44 4552 5f50 4152 5449 434c 4553 5f58  NDER_PARTICLES_X
-000162d0: 5241 5929 0d0a 2020 2020 2020 2020 2020  RAY)..          
-000162e0: 2020 2020 2020 696d 6775 692e 706f 705f        imgui.pop_
-000162f0: 7374 796c 655f 7661 7228 3429 0d0a 2020  style_var(4)..  
-00016300: 2020 2020 2020 2020 2020 2020 2020 696d                im
-00016310: 6775 692e 706f 705f 7374 796c 655f 636f  gui.pop_style_co
-00016320: 6c6f 7228 3129 0d0a 0d0a 2020 2020 2020  lor(1)....      
-00016330: 2020 2020 2020 2020 2020 6966 2077 6964            if wid
-00016340: 6765 7473 2e63 656e 7472 6564 5f62 7574  gets.centred_but
-00016350: 746f 6e28 2752 6563 6f6d 7069 6c65 2053  ton('Recompile S
-00016360: 6861 6465 7273 272c 2031 3530 2c20 3230  haders', 150, 20
-00016370: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-00016380: 2020 2020 2020 2020 7365 6c66 2e72 656e          self.ren
-00016390: 6465 7265 722e 7265 636f 6d70 696c 655f  derer.recompile_
-000163a0: 7368 6164 6572 7328 290d 0a0d 0a20 2020  shaders()....   
-000163b0: 2020 2020 2020 2020 2020 2020 2069 6d67               img
-000163c0: 7569 2e70 6f70 5f73 7479 6c65 5f76 6172  ui.pop_style_var
-000163d0: 2831 290d 0a0d 0a20 2020 2020 2020 2020  (1)....         
-000163e0: 2020 2069 6620 696d 6775 692e 636f 6c6c     if imgui.coll
-000163f0: 6170 7369 6e67 5f68 6561 6465 7228 2245  apsing_header("E
-00016400: 7870 6f72 7420 3344 2073 6365 6e65 222c  xport 3D scene",
-00016410: 204e 6f6e 6529 5b30 5d3a 0d0a 2020 2020   None)[0]:..    
-00016420: 2020 2020 2020 2020 2020 2020 6377 203d              cw =
-00016430: 2069 6d67 7569 2e67 6574 5f63 6f6e 7465   imgui.get_conte
-00016440: 6e74 5f72 6567 696f 6e5f 6176 6169 6c61  nt_region_availa
-00016450: 626c 655f 7769 6474 6828 290d 0a20 2020  ble_width()..   
-00016460: 2020 2020 2020 2020 2020 2020 2073 7061               spa
-00016470: 6369 6e67 203d 2031 300d 0a20 2020 2020  cing = 10..     
-00016480: 2020 2020 2020 2020 2020 2073 203d 2028             s = (
-00016490: 6377 202d 2032 202a 2073 7061 6369 6e67  cw - 2 * spacing
-000164a0: 202a 2032 202d 2033 2920 2f20 330d 0a20   * 2 - 3) / 3.. 
-000164b0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000164c0: 6d67 7569 2e70 7573 685f 7374 796c 655f  mgui.push_style_
-000164d0: 7661 7228 696d 6775 692e 5354 594c 455f  var(imgui.STYLE_
-000164e0: 4652 414d 455f 524f 554e 4449 4e47 2c20  FRAME_ROUNDING, 
-000164f0: 3130 3029 0d0a 2020 2020 2020 2020 2020  100)..          
-00016500: 2020 2020 2020 696d 6775 692e 7075 7368        imgui.push
-00016510: 5f73 7479 6c65 5f63 6f6c 6f72 2869 6d67  _style_color(img
-00016520: 7569 2e43 4f4c 4f52 5f42 5554 544f 4e5f  ui.COLOR_BUTTON_
-00016530: 484f 5645 5245 442c 202a 6366 672e 434f  HOVERED, *cfg.CO
-00016540: 4c4f 5552 5f46 5241 4d45 5f44 4152 4b29  LOUR_FRAME_DARK)
-00016550: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00016560: 2020 696d 6775 692e 7075 7368 5f73 7479    imgui.push_sty
-00016570: 6c65 5f63 6f6c 6f72 2869 6d67 7569 2e43  le_color(imgui.C
-00016580: 4f4c 4f52 5f42 4f52 4445 522c 202a 6366  OLOR_BORDER, *cf
-00016590: 672e 434f 4c4f 5552 5f46 5241 4d45 5f44  g.COLOUR_FRAME_D
-000165a0: 4152 4b29 0d0a 2020 2020 2020 2020 2020  ARK)..          
-000165b0: 2020 2020 2020 696d 6775 692e 7075 7368        imgui.push
-000165c0: 5f73 7479 6c65 5f76 6172 2869 6d67 7569  _style_var(imgui
-000165d0: 2e53 5459 4c45 5f46 5241 4d45 5f42 4f52  .STYLE_FRAME_BOR
-000165e0: 4445 5253 495a 452c 2031 290d 0a20 2020  DERSIZE, 1)..   
-000165f0: 2020 2020 2020 2020 2020 2020 2069 6d67               img
-00016600: 7569 2e70 7573 685f 7374 796c 655f 636f  ui.push_style_co
-00016610: 6c6f 7228 696d 6775 692e 434f 4c4f 525f  lor(imgui.COLOR_
-00016620: 4652 414d 455f 4241 434b 4752 4f55 4e44  FRAME_BACKGROUND
-00016630: 5f41 4354 4956 452c 202a 6366 672e 434f  _ACTIVE, *cfg.CO
-00016640: 4c4f 5552 5f46 5241 4d45 5f45 5854 5241  LOUR_FRAME_EXTRA
-00016650: 5f44 4152 4b29 0d0a 2020 2020 2020 2020  _DARK)..        
-00016660: 2020 2020 2020 2020 6966 2069 6d67 7569          if imgui
-00016670: 2e69 6d61 6765 5f62 7574 746f 6e28 7365  .image_button(se
-00016680: 6c66 2e69 636f 6e5f 6f62 6a2e 7265 6e64  lf.icon_obj.rend
-00016690: 6572 6572 5f69 642c 2073 2c20 7329 3a0d  erer_id, s, s):.
-000166a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000166b0: 2020 2020 2053 6567 6d65 6e74 6174 696f       Segmentatio
-000166c0: 6e45 6469 746f 722e 7361 7665 5f73 7572  nEditor.save_sur
-000166d0: 6661 6365 5f6d 6f64 656c 735f 6173 5f6f  face_models_as_o
-000166e0: 626a 7328 290d 0a20 2020 2020 2020 2020  bjs()..         
-000166f0: 2020 2020 2020 2069 6d67 7569 2e73 616d         imgui.sam
-00016700: 655f 6c69 6e65 2873 7061 6369 6e67 3d73  e_line(spacing=s
-00016710: 7061 6369 6e67 290d 0a20 2020 2020 2020  pacing)..       
-00016720: 2020 2020 2020 2020 2069 6620 696d 6775           if imgu
-00016730: 692e 696d 6167 655f 6275 7474 6f6e 2873  i.image_button(s
-00016740: 656c 662e 6963 6f6e 5f62 6c65 6e64 6572  elf.icon_blender
-00016750: 2e72 656e 6465 7265 725f 6964 2c20 732c  .renderer_id, s,
-00016760: 2073 293a 0d0a 2020 2020 2020 2020 2020   s):..          
-00016770: 2020 2020 2020 2020 2020 6f62 6a5f 7061            obj_pa
-00016780: 7468 7320 3d20 5365 676d 656e 7461 7469  ths = Segmentati
-00016790: 6f6e 4564 6974 6f72 2e73 6176 655f 7375  onEditor.save_su
-000167a0: 7266 6163 655f 6d6f 6465 6c73 5f61 735f  rface_models_as_
-000167b0: 6f62 6a73 2829 0d0a 2020 2020 2020 2020  objs()..        
-000167c0: 2020 2020 2020 2020 2020 2020 2320 7468              # th
-000167d0: 656e 206f 7065 6e20 426c 656e 6465 722e  en open Blender.
-000167e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000167f0: 2020 2020 2020 5365 676d 656e 7461 7469        Segmentati
-00016800: 6f6e 4564 6974 6f72 2e6f 7065 6e5f 6f62  onEditor.open_ob
-00016810: 6a73 5f69 6e5f 626c 656e 6465 7228 6f62  js_in_blender(ob
-00016820: 6a5f 7061 7468 7329 0d0a 2020 2020 2020  j_paths)..      
-00016830: 2020 2020 2020 2020 2020 6966 2069 6d67            if img
-00016840: 7569 2e62 6567 696e 5f70 6f70 7570 5f63  ui.begin_popup_c
-00016850: 6f6e 7465 7874 5f77 696e 646f 7728 293a  ontext_window():
-00016860: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00016870: 2020 2020 2020 6966 2069 6d67 7569 2e6d        if imgui.m
-00016880: 656e 755f 6974 656d 2822 5365 7420 7061  enu_item("Set pa
-00016890: 7468 2074 6f20 626c 656e 6465 722e 6578  th to blender.ex
-000168a0: 6522 295b 305d 3a0d 0a20 2020 2020 2020  e")[0]:..       
-000168b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000168c0: 2070 6174 6820 3d20 6669 6c65 6469 616c   path = filedial
-000168d0: 6f67 2e61 736b 6f70 656e 6669 6c65 6e61  og.askopenfilena
-000168e0: 6d65 2866 696c 6574 7970 6573 3d5b 2822  me(filetypes=[("
-000168f0: 426c 656e 6465 7220 6578 6563 7574 6162  Blender executab
-00016900: 6c65 222c 2022 2e65 7865 2229 5d29 0d0a  le", ".exe")])..
-00016910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016920: 2020 2020 2020 2020 6966 2070 6174 6820          if path 
-00016930: 213d 2022 223a 0d0a 2020 2020 2020 2020  != "":..        
-00016940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016950: 2020 2020 6366 672e 6564 6974 5f73 6574      cfg.edit_set
-00016960: 7469 6e67 2822 424c 454e 4445 525f 4558  ting("BLENDER_EX
-00016970: 4522 2c20 7061 7468 290d 0a20 2020 2020  E", path)..     
-00016980: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00016990: 6d67 7569 2e65 6e64 5f70 6f70 7570 2829  mgui.end_popup()
-000169a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000169b0: 2020 696d 6775 692e 7361 6d65 5f6c 696e    imgui.same_lin
-000169c0: 6528 7370 6163 696e 673d 7370 6163 696e  e(spacing=spacin
-000169d0: 6729 0d0a 2020 2020 2020 2020 2020 2020  g)..            
-000169e0: 2020 2020 6966 2069 6d67 7569 2e69 6d61      if imgui.ima
-000169f0: 6765 5f62 7574 746f 6e28 7365 6c66 2e69  ge_button(self.i
-00016a00: 636f 6e5f 6368 696d 6572 6178 2e72 656e  con_chimerax.ren
-00016a10: 6465 7265 725f 6964 2c20 732c 2073 293a  derer_id, s, s):
-00016a20: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00016a30: 2020 2020 2020 6d6f 6465 6c73 203d 206c        models = l
-00016a40: 6973 7428 290d 0a20 2020 2020 2020 2020  ist()..         
-00016a50: 2020 2020 2020 2020 2020 2066 6f72 206d             for m
-00016a60: 2069 6e20 6366 672e 7365 5f73 7572 6661   in cfg.se_surfa
-00016a70: 6365 5f6d 6f64 656c 733a 0d0a 2020 2020  ce_models:..    
-00016a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016a90: 2020 2020 6966 206d 2e69 6e69 7469 616c      if m.initial
-00016aa0: 697a 6564 2061 6e64 206e 6f74 206d 2e68  ized and not m.h
-00016ab0: 6964 653a 0d0a 2020 2020 2020 2020 2020  ide:..          
-00016ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016ad0: 2020 6d6f 6465 6c73 2e61 7070 656e 6428    models.append(
-00016ae0: 6d29 0d0a 2020 2020 2020 2020 2020 2020  m)..            
-00016af0: 2020 2020 2020 2020 5365 676d 656e 7461          Segmenta
-00016b00: 7469 6f6e 4564 6974 6f72 2e6f 7065 6e5f  tionEditor.open_
-00016b10: 696e 5f63 6869 6d65 7261 7828 6d6f 6465  in_chimerax(mode
-00016b20: 6c73 290d 0a20 2020 2020 2020 2020 2020  ls)..           
-00016b30: 2020 2020 2069 6620 696d 6775 692e 6265       if imgui.be
-00016b40: 6769 6e5f 706f 7075 705f 636f 6e74 6578  gin_popup_contex
-00016b50: 745f 7769 6e64 6f77 2829 3a0d 0a20 2020  t_window():..   
-00016b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016b70: 2069 6620 696d 6775 692e 6d65 6e75 5f69   if imgui.menu_i
-00016b80: 7465 6d28 2253 6574 2070 6174 6820 746f  tem("Set path to
-00016b90: 2043 6869 6d65 7261 582e 6578 6522 295b   ChimeraX.exe")[
-00016ba0: 305d 3a0d 0a20 2020 2020 2020 2020 2020  0]:..           
-00016bb0: 2020 2020 2020 2020 2020 2020 2070 6174               pat
-00016bc0: 6820 3d20 6669 6c65 6469 616c 6f67 2e61  h = filedialog.a
-00016bd0: 736b 6f70 656e 6669 6c65 6e61 6d65 2866  skopenfilename(f
-00016be0: 696c 6574 7970 6573 3d5b 2822 4368 696d  iletypes=[("Chim
-00016bf0: 6572 6158 2065 7865 6375 7461 626c 6522  eraX executable"
-00016c00: 2c20 222e 6578 6522 295d 290d 0a20 2020  , ".exe")])..   
-00016c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016c20: 2020 2020 2069 6620 7061 7468 2021 3d20       if path != 
-00016c30: 2222 3a0d 0a20 2020 2020 2020 2020 2020  "":..           
-00016c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016c50: 2063 6667 2e65 6469 745f 7365 7474 696e   cfg.edit_settin
-00016c60: 6728 2243 4849 4d45 5241 585f 4558 4522  g("CHIMERAX_EXE"
-00016c70: 2c20 7061 7468 290d 0a20 2020 2020 2020  , path)..       
-00016c80: 2020 2020 2020 2020 2020 2020 2069 6d67               img
-00016c90: 7569 2e65 6e64 5f70 6f70 7570 2829 0d0a  ui.end_popup()..
-00016ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016cb0: 696d 6775 692e 706f 705f 7374 796c 655f  imgui.pop_style_
-00016cc0: 7661 7228 3229 0d0a 2020 2020 2020 2020  var(2)..        
-00016cd0: 2020 2020 2020 2020 696d 6775 692e 706f          imgui.po
-00016ce0: 705f 7374 796c 655f 636f 6c6f 7228 3329  p_style_color(3)
-00016cf0: 0d0a 0d0a 2020 2020 2020 2020 6465 6620  ....        def 
-00016d00: 6d65 6e75 5f62 6172 2829 3a0d 0a20 2020  menu_bar():..   
-00016d10: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
-00016d20: 7573 685f 7374 796c 655f 636f 6c6f 7228  ush_style_color(
-00016d30: 696d 6775 692e 434f 4c4f 525f 4d45 4e55  imgui.COLOR_MENU
-00016d40: 4241 525f 4241 434b 4752 4f55 4e44 2c20  BAR_BACKGROUND, 
-00016d50: 2a63 6667 2e43 4f4c 4f55 525f 4d41 494e  *cfg.COLOUR_MAIN
-00016d60: 5f4d 454e 555f 4241 5229 0d0a 2020 2020  _MENU_BAR)..    
-00016d70: 2020 2020 2020 2020 696d 6775 692e 7075          imgui.pu
-00016d80: 7368 5f73 7479 6c65 5f63 6f6c 6f72 2869  sh_style_color(i
-00016d90: 6d67 7569 2e43 4f4c 4f52 5f54 4558 542c  mgui.COLOR_TEXT,
-00016da0: 202a 6366 672e 434f 4c4f 5552 5f4d 4149   *cfg.COLOUR_MAI
-00016db0: 4e5f 4d45 4e55 5f42 4152 5f54 4558 5429  N_MENU_BAR_TEXT)
-00016dc0: 0d0a 2020 2020 2020 2020 2020 2020 696d  ..            im
-00016dd0: 6775 692e 7075 7368 5f73 7479 6c65 5f63  gui.push_style_c
-00016de0: 6f6c 6f72 2869 6d67 7569 2e43 4f4c 4f52  olor(imgui.COLOR
-00016df0: 5f48 4541 4445 525f 484f 5645 5245 442c  _HEADER_HOVERED,
-00016e00: 202a 6366 672e 434f 4c4f 5552 5f4d 4149   *cfg.COLOUR_MAI
-00016e10: 4e5f 4d45 4e55 5f42 4152 5f48 494c 4947  N_MENU_BAR_HILIG
-00016e20: 4854 290d 0a20 2020 2020 2020 2020 2020  HT)..           
-00016e30: 2069 6d67 7569 2e70 7573 685f 7374 796c   imgui.push_styl
-00016e40: 655f 636f 6c6f 7228 696d 6775 692e 434f  e_color(imgui.CO
-00016e50: 4c4f 525f 4845 4144 4552 5f41 4354 4956  LOR_HEADER_ACTIV
-00016e60: 452c 202a 6366 672e 434f 4c4f 5552 5f4d  E, *cfg.COLOUR_M
-00016e70: 4149 4e5f 4d45 4e55 5f42 4152 5f48 494c  AIN_MENU_BAR_HIL
-00016e80: 4947 4854 290d 0a20 2020 2020 2020 2020  IGHT)..         
-00016e90: 2020 2069 6d67 7569 2e70 7573 685f 7374     imgui.push_st
-00016ea0: 796c 655f 636f 6c6f 7228 696d 6775 692e  yle_color(imgui.
-00016eb0: 434f 4c4f 525f 4845 4144 4552 2c20 2a63  COLOR_HEADER, *c
-00016ec0: 6667 2e43 4f4c 4f55 525f 4d41 494e 5f4d  fg.COLOUR_MAIN_M
-00016ed0: 454e 555f 4241 525f 4849 4c49 4748 5429  ENU_BAR_HILIGHT)
-00016ee0: 0d0a 2020 2020 2020 2020 2020 2020 696d  ..            im
-00016ef0: 6775 692e 7075 7368 5f73 7479 6c65 5f63  gui.push_style_c
-00016f00: 6f6c 6f72 2869 6d67 7569 2e43 4f4c 4f52  olor(imgui.COLOR
-00016f10: 5f50 4f50 5550 5f42 4143 4b47 524f 554e  _POPUP_BACKGROUN
-00016f20: 442c 202a 6366 672e 434f 4c4f 5552 5f4d  D, *cfg.COLOUR_M
-00016f30: 454e 555f 5749 4e44 4f57 5f42 4143 4b47  ENU_WINDOW_BACKG
-00016f40: 524f 554e 4429 0d0a 2020 2020 2020 2020  ROUND)..        
-00016f50: 2020 2020 696d 6775 692e 7075 7368 5f73      imgui.push_s
-00016f60: 7479 6c65 5f76 6172 2869 6d67 7569 2e53  tyle_var(imgui.S
-00016f70: 5459 4c45 5f46 5241 4d45 5f50 4144 4449  TYLE_FRAME_PADDI
-00016f80: 4e47 2c20 2832 2e30 2c20 322e 3029 290d  NG, (2.0, 2.0)).
-00016f90: 0a0d 0a20 2020 2020 2020 2020 2020 2069  ...            i
-00016fa0: 6620 696d 6775 692e 636f 7265 2e62 6567  f imgui.core.beg
-00016fb0: 696e 5f6d 6169 6e5f 6d65 6e75 5f62 6172  in_main_menu_bar
-00016fc0: 2829 3a0d 0a20 2020 2020 2020 2020 2020  ():..           
-00016fd0: 2020 2020 2069 6620 696d 6775 692e 6265       if imgui.be
-00016fe0: 6769 6e5f 6d65 6e75 2822 4669 6c65 2229  gin_menu("File")
-00016ff0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00017000: 2020 2020 2020 2069 6620 696d 6775 692e         if imgui.
-00017010: 6d65 6e75 5f69 7465 6d28 2249 6d70 6f72  menu_item("Impor
-00017020: 7420 6461 7461 7365 7422 295b 305d 3a0d  t dataset")[0]:.
-00017030: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00017040: 2020 2020 2020 2020 2074 7279 3a0d 0a20           try:.. 
-00017050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017060: 2020 2020 2020 2020 2020 2066 696c 656e             filen
-00017070: 616d 6520 3d20 6669 6c65 6469 616c 6f67  ame = filedialog
-00017080: 2e61 736b 6f70 656e 6669 6c65 6e61 6d65  .askopenfilename
-00017090: 2866 696c 6574 7970 6573 3d5b 2822 7363  (filetypes=[("sc
-000170a0: 4e6f 6465 7320 7365 676d 656e 7461 626c  Nodes segmentabl
-000170b0: 6522 2c20 6622 2e6d 7263 207b 6366 672e  e", f".mrc {cfg.
-000170c0: 6669 6c65 7479 7065 5f73 6567 6d65 6e74  filetype_segment
-000170d0: 6174 696f 6e7d 2229 5d29 0d0a 2020 2020  ation}")])..    
-000170e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000170f0: 2020 2020 2020 2020 6966 2066 696c 656e          if filen
-00017100: 616d 6520 213d 2027 273a 0d0a 2020 2020  ame != '':..    
-00017110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017120: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00017130: 2e69 6d70 6f72 745f 6461 7461 7365 7428  .import_dataset(
-00017140: 6669 6c65 6e61 6d65 290d 0a20 2020 2020  filename)..     
-00017150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017160: 2020 2065 7863 6570 7420 4578 6365 7074     except Except
-00017170: 696f 6e20 6173 2065 3a0d 0a20 2020 2020  ion as e:..     
-00017180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017190: 2020 2020 2020 2063 6667 2e73 6574 5f65         cfg.set_e
-000171a0: 7272 6f72 2865 2c20 2243 6f75 6c64 206e  rror(e, "Could n
-000171b0: 6f74 2069 6d70 6f72 7420 6461 7461 7365  ot import datase
-000171c0: 742c 2073 6565 2064 6574 6169 6c73 2062  t, see details b
-000171d0: 656c 6f77 2e22 290d 0a20 2020 2020 2020  elow.")..       
-000171e0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-000171f0: 696d 6775 692e 6d65 6e75 5f69 7465 6d28  imgui.menu_item(
-00017200: 2249 6d70 6f72 7420 6d6f 6465 6c22 295b  "Import model")[
-00017210: 305d 3a0d 0a20 2020 2020 2020 2020 2020  0]:..           
-00017220: 2020 2020 2020 2020 2020 2020 2074 7279               try
-00017230: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00017240: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00017250: 696c 656e 616d 6520 3d20 6669 6c65 6469  ilename = filedi
-00017260: 616c 6f67 2e61 736b 6f70 656e 6669 6c65  alog.askopenfile
-00017270: 6e61 6d65 2866 696c 6574 7970 6573 3d5b  name(filetypes=[
-00017280: 2822 7363 4e6f 6465 7320 6d6f 6465 6c22  ("scNodes model"
-00017290: 2c20 6622 7b63 6667 2e66 696c 6574 7970  , f"{cfg.filetyp
-000172a0: 655f 7365 6d6f 6465 6c7d 2229 5d29 0d0a  e_semodel}")])..
-000172b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000172c0: 2020 2020 2020 2020 2020 2020 6966 2066              if f
-000172d0: 696c 656e 616d 6520 213d 2027 273a 0d0a  ilename != '':..
-000172e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000150b0: 2069 6d67 7569 2e62 6567 696e 5f63 6869   imgui.begin_chi
+000150c0: 6c64 2866 227b 732e 7469 746c 657d 5f73  ld(f"{s.title}_s
+000150d0: 7572 666d 222c 2030 2e30 2c20 3832 202b  urfm", 0.0, 82 +
+000150e0: 2028 3135 2069 6620 732e 7061 7274 6963   (15 if s.partic
+000150f0: 6c65 7320 656c 7365 2030 292c 2054 7275  les else 0), Tru
+00015100: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
+00015110: 2020 2020 2020 2020 6377 203d 2069 6d67          cw = img
+00015120: 7569 2e67 6574 5f63 6f6e 7465 6e74 5f72  ui.get_content_r
+00015130: 6567 696f 6e5f 6176 6169 6c61 626c 655f  egion_available_
+00015140: 7769 6474 6828 290d 0a20 2020 2020 2020  width()..       
+00015150: 2020 2020 2020 2020 2020 2020 205f 2c20               _, 
+00015160: 732e 636f 6c6f 7572 203d 2069 6d67 7569  s.colour = imgui
+00015170: 2e63 6f6c 6f72 5f65 6469 7433 2873 2e74  .color_edit3(s.t
+00015180: 6974 6c65 2c20 2a73 2e63 6f6c 6f75 725b  itle, *s.colour[
+00015190: 3a33 5d2c 2069 6d67 7569 2e43 4f4c 4f52  :3], imgui.COLOR
+000151a0: 5f45 4449 545f 4e4f 5f49 4e50 5554 5320  _EDIT_NO_INPUTS 
+000151b0: 7c20 696d 6775 692e 434f 4c4f 525f 4544  | imgui.COLOR_ED
+000151c0: 4954 5f4e 4f5f 4c41 4245 4c20 7c20 696d  IT_NO_LABEL | im
+000151d0: 6775 692e 434f 4c4f 525f 4544 4954 5f4e  gui.COLOR_EDIT_N
+000151e0: 4f5f 544f 4f4c 5449 5020 7c20 696d 6775  O_TOOLTIP | imgu
+000151f0: 692e 434f 4c4f 525f 4544 4954 5f4e 4f5f  i.COLOR_EDIT_NO_
+00015200: 4452 4147 5f44 524f 5029 0d0a 0d0a 2020  DRAG_DROP)....  
+00015210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015220: 2020 696d 6775 692e 7361 6d65 5f6c 696e    imgui.same_lin
+00015230: 6528 290d 0a20 2020 2020 2020 2020 2020  e()..           
+00015240: 2020 2020 2020 2020 2069 6d67 7569 2e74           imgui.t
+00015250: 6578 7428 6622 7b73 2e74 6974 6c65 7d20  ext(f"{s.title} 
+00015260: 287b 732e 7369 7a65 5f6d 623a 2e31 667d  ({s.size_mb:.1f}
+00015270: 206d 6229 2229 0d0a 2020 2020 2020 2020   mb)")..        
+00015280: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
+00015290: 692e 7075 7368 5f73 7479 6c65 5f76 6172  i.push_style_var
+000152a0: 2869 6d67 7569 2e53 5459 4c45 5f47 5241  (imgui.STYLE_GRA
+000152b0: 425f 524f 554e 4449 4e47 2c20 3230 290d  B_ROUNDING, 20).
+000152c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000152d0: 2020 2020 2069 6d67 7569 2e70 7573 685f       imgui.push_
+000152e0: 7374 796c 655f 7661 7228 696d 6775 692e  style_var(imgui.
+000152f0: 5354 594c 455f 4752 4142 5f4d 494e 5f53  STYLE_GRAB_MIN_S
+00015300: 495a 452c 2039 290d 0a20 2020 2020 2020  IZE, 9)..       
+00015310: 2020 2020 2020 2020 2020 2020 2069 6d67               img
+00015320: 7569 2e70 7573 685f 7374 796c 655f 7661  ui.push_style_va
+00015330: 7228 696d 6775 692e 5354 594c 455f 4652  r(imgui.STYLE_FR
+00015340: 414d 455f 424f 5244 4552 5349 5a45 2c20  AME_BORDERSIZE, 
+00015350: 3129 0d0a 0d0a 2020 2020 2020 2020 2020  1)....          
+00015360: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
+00015370: 7361 6d65 5f6c 696e 6528 706f 7369 7469  same_line(positi
+00015380: 6f6e 203d 2063 7720 2d20 3430 290d 0a20  on = cw - 40).. 
+00015390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000153a0: 2020 205f 2c20 732e 6869 6465 203d 2069     _, s.hide = i
+000153b0: 6d67 7569 2e63 6865 636b 626f 7828 2268  mgui.checkbox("h
+000153c0: 6964 6520 2022 2c20 732e 6869 6465 290d  ide  ", s.hide).
+000153d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000153e0: 2020 2020 2023 2070 726f 6772 6573 7320       # progress 
+000153f0: 6261 720d 0a20 2020 2020 2020 2020 2020  bar..           
+00015400: 2020 2020 2020 2020 2069 6620 732e 7072           if s.pr
+00015410: 6f63 6573 7320 6973 206e 6f74 204e 6f6e  ocess is not Non
+00015420: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00015430: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00015440: 2e70 726f 6365 7373 2e70 726f 6772 6573  .process.progres
+00015450: 7320 3d3d 2031 2e30 3a0d 0a20 2020 2020  s == 1.0:..     
+00015460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015470: 2020 2020 2020 2073 2e70 726f 6365 7373         s.process
+00015480: 203d 204e 6f6e 650d 0a0d 0a20 2020 2020   = None....     
+00015490: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000154a0: 6d67 7569 2e70 7573 685f 6974 656d 5f77  mgui.push_item_w
+000154b0: 6964 7468 2863 7729 0d0a 2020 2020 2020  idth(cw)..      
+000154c0: 2020 2020 2020 2020 2020 2020 2020 6f72                or
+000154d0: 6967 696e 616c 5f6c 6576 656c 203d 2073  iginal_level = s
+000154e0: 2e6c 6576 656c 0d0a 2020 2020 2020 2020  .level..        
+000154f0: 2020 2020 2020 2020 2020 2020 5f2c 2073              _, s
+00015500: 2e6c 6576 656c 203d 2069 6d67 7569 2e73  .level = imgui.s
+00015510: 6c69 6465 725f 696e 7428 2223 236c 6576  lider_int("##lev
+00015520: 656c 222c 2073 2e6c 6576 656c 2c20 302c  el", s.level, 0,
+00015530: 2032 3536 2c20 6622 6c65 7665 6c20 3d20   256, f"level = 
+00015540: 7b73 2e6c 6576 656c 7d22 290d 0a20 2020  {s.level}")..   
+00015550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015560: 2069 6620 732e 7072 6f63 6573 7320 6973   if s.process is
+00015570: 206e 6f74 204e 6f6e 653a 0d0a 2020 2020   not None:..    
+00015580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015590: 2020 2020 732e 6c65 7665 6c20 3d20 6f72      s.level = or
+000155a0: 6967 696e 616c 5f6c 6576 656c 0d0a 2020  iginal_level..  
+000155b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000155c0: 2020 2020 2020 5f20 3d20 4661 6c73 650d        _ = False.
+000155d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000155e0: 2020 2020 2069 6620 5f20 616e 6420 6f72       if _ and or
+000155f0: 6967 696e 616c 5f6c 6576 656c 2021 3d20  iginal_level != 
+00015600: 732e 6c65 7665 6c3a 0d0a 2020 2020 2020  s.level:..      
+00015610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015620: 2020 7265 715f 6765 6e5f 6d6f 6465 6c73    req_gen_models
+00015630: 203d 2054 7275 650d 0a0d 0a20 2020 2020   = True....     
+00015640: 2020 2020 2020 2020 2020 2020 2020 205f                 _
+00015650: 2c20 732e 6475 7374 203d 2069 6d67 7569  , s.dust = imgui
+00015660: 2e73 6c69 6465 725f 666c 6f61 7428 2223  .slider_float("#
+00015670: 2364 7573 7422 2c20 732e 6475 7374 2c20  #dust", s.dust, 
+00015680: 312e 302c 2031 3030 3030 3030 2e30 2c20  1.0, 1000000.0, 
+00015690: 6622 6475 7374 203c 207b 732e 6475 7374  f"dust < {s.dust
+000156a0: 3a2e 3166 7d20 6e6d c2b3 222c 2069 6d67  :.1f} nm..", img
+000156b0: 7569 2e53 4c49 4445 525f 464c 4147 535f  ui.SLIDER_FLAGS_
+000156c0: 4c4f 4741 5249 5448 4d49 4329 0d0a 2020  LOGARITHMIC)..  
+000156d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000156e0: 2020 732e 6869 6465 5f64 7573 7428 290d    s.hide_dust().
+000156f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015700: 2020 2020 2069 6d67 7569 2e70 6f70 5f69       imgui.pop_i
+00015710: 7465 6d5f 7769 6474 6828 290d 0a20 2020  tem_width()..   
+00015720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015730: 2069 6620 732e 7061 7274 6963 6c65 733a   if s.particles:
+00015740: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00015750: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
+00015760: 7075 7368 5f69 7465 6d5f 7769 6474 6828  push_item_width(
+00015770: 6377 202d 2032 3229 0d0a 2020 2020 2020  cw - 22)..      
+00015780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015790: 2020 5f2c 2073 2e70 6172 7469 636c 655f    _, s.particle_
+000157a0: 7369 7a65 203d 2069 6d67 7569 2e73 6c69  size = imgui.sli
+000157b0: 6465 725f 666c 6f61 7428 2223 2370 6172  der_float("##par
+000157c0: 7469 636c 6522 2c20 732e 7061 7274 6963  ticle", s.partic
+000157d0: 6c65 5f73 697a 652c 2030 2e30 2c20 3235  le_size, 0.0, 25
+000157e0: 2e30 2c20 2268 6964 6520 7061 7274 6963  .0, "hide partic
+000157f0: 6c65 7322 2069 6620 732e 7061 7274 6963  les" if s.partic
+00015800: 6c65 5f73 697a 6520 3d3d 2030 2065 6c73  le_size == 0 els
+00015810: 6520 6622 7061 7274 6963 6c65 2073 697a  e f"particle siz
+00015820: 6520 3d20 7b73 2e70 6172 7469 636c 655f  e = {s.particle_
+00015830: 7369 7a65 3a2e 3166 7d20 6e6d 2229 0d0a  size:.1f} nm")..
+00015840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015850: 2020 2020 2020 2020 696d 6775 692e 7361          imgui.sa
+00015860: 6d65 5f6c 696e 6528 290d 0a20 2020 2020  me_line()..     
+00015870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015880: 2020 205f 2c20 732e 7061 7274 6963 6c65     _, s.particle
+00015890: 5f63 6f6c 6f75 7220 3d20 696d 6775 692e  _colour = imgui.
+000158a0: 636f 6c6f 725f 6564 6974 3328 732e 7469  color_edit3(s.ti
+000158b0: 746c 652b 2270 636c 7222 2c20 2a73 2e70  tle+"pclr", *s.p
+000158c0: 6172 7469 636c 655f 636f 6c6f 7572 5b3a  article_colour[:
+000158d0: 335d 2c20 696d 6775 692e 434f 4c4f 525f  3], imgui.COLOR_
+000158e0: 4544 4954 5f4e 4f5f 494e 5055 5453 207c  EDIT_NO_INPUTS |
+000158f0: 2069 6d67 7569 2e43 4f4c 4f52 5f45 4449   imgui.COLOR_EDI
+00015900: 545f 4e4f 5f4c 4142 454c 207c 2069 6d67  T_NO_LABEL | img
+00015910: 7569 2e43 4f4c 4f52 5f45 4449 545f 4e4f  ui.COLOR_EDIT_NO
+00015920: 5f54 4f4f 4c54 4950 207c 2069 6d67 7569  _TOOLTIP | imgui
+00015930: 2e43 4f4c 4f52 5f45 4449 545f 4e4f 5f44  .COLOR_EDIT_NO_D
+00015940: 5241 475f 4452 4f50 290d 0a20 2020 2020  RAG_DROP)..     
+00015950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015960: 2020 2069 6d67 7569 2e70 6f70 5f69 7465     imgui.pop_ite
+00015970: 6d5f 7769 6474 6828 290d 0a20 2020 2020  m_width()..     
+00015980: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00015990: 6d67 7569 2e70 7573 685f 6974 656d 5f77  mgui.push_item_w
+000159a0: 6964 7468 2828 6377 202d 2037 2920 2f20  idth((cw - 7) / 
+000159b0: 3229 0d0a 2020 2020 2020 2020 2020 2020  2)..            
+000159c0: 2020 2020 2020 2020 5f2c 2073 2e61 6c70          _, s.alp
+000159d0: 6861 203d 2069 6d67 7569 2e73 6c69 6465  ha = imgui.slide
+000159e0: 725f 666c 6f61 7428 2223 2361 6c70 6861  r_float("##alpha
+000159f0: 222c 2073 2e61 6c70 6861 2c20 302c 2031  ", s.alpha, 0, 1
+00015a00: 2e30 2c20 6622 616c 7068 6120 3d20 7b73  .0, f"alpha = {s
+00015a10: 2e61 6c70 6861 3a2e 3166 7d22 290d 0a20  .alpha:.1f}").. 
+00015a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015a30: 2020 2069 6d67 7569 2e73 616d 655f 6c69     imgui.same_li
+00015a40: 6e65 2829 0d0a 2020 2020 2020 2020 2020  ne()..          
+00015a50: 2020 2020 2020 2020 2020 6f72 6967 696e            origin
+00015a60: 616c 5f62 696e 203d 2073 2e62 696e 0d0a  al_bin = s.bin..
+00015a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015a80: 2020 2020 5f2c 2073 2e62 696e 203d 2069      _, s.bin = i
+00015a90: 6d67 7569 2e73 6c69 6465 725f 696e 7428  mgui.slider_int(
+00015aa0: 2223 2362 696e 222c 2073 2e62 696e 2c20  "##bin", s.bin, 
+00015ab0: 312c 2038 2c20 6622 6269 6e20 7b73 2e62  1, 8, f"bin {s.b
+00015ac0: 696e 7d22 290d 0a20 2020 2020 2020 2020  in}")..         
+00015ad0: 2020 2020 2020 2020 2020 2069 6620 5f20             if _ 
+00015ae0: 616e 6420 6f72 6967 696e 616c 5f62 696e  and original_bin
+00015af0: 2021 3d20 732e 6269 6e3a 0d0a 2020 2020   != s.bin:..    
+00015b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015b10: 2020 2020 7265 715f 6765 6e5f 6d6f 6465      req_gen_mode
+00015b20: 6c73 203d 2054 7275 650d 0a0d 0a0d 0a20  ls = True...... 
+00015b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015b40: 2020 2069 6620 7265 715f 6765 6e5f 6d6f     if req_gen_mo
+00015b50: 6465 6c73 3a0d 0a20 2020 2020 2020 2020  dels:..         
+00015b60: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00015b70: 2e67 656e 6572 6174 655f 6d6f 6465 6c28  .generate_model(
+00015b80: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
+00015b90: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
+00015ba0: 6f70 5f69 7465 6d5f 7769 6474 6828 290d  op_item_width().
+00015bb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015bc0: 2020 2020 2069 6d67 7569 2e70 6f70 5f73       imgui.pop_s
+00015bd0: 7479 6c65 5f76 6172 2833 290d 0a20 2020  tyle_var(3)..   
+00015be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015bf0: 2069 6d67 7569 2e70 6f70 5f73 7479 6c65   imgui.pop_style
+00015c00: 5f63 6f6c 6f72 2832 290d 0a20 2020 2020  _color(2)..     
+00015c10: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00015c20: 6620 696d 6775 692e 6265 6769 6e5f 706f  f imgui.begin_po
+00015c30: 7075 705f 636f 6e74 6578 745f 7769 6e64  pup_context_wind
+00015c40: 6f77 2829 3a0d 0a20 2020 2020 2020 2020  ow():..         
+00015c50: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00015c60: 656c 662e 6578 7472 6163 745f 636f 6f72  elf.extract_coor
+00015c70: 6469 6e61 7465 735f 6d65 6e75 2873 290d  dinates_menu(s).
+00015c80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015c90: 2020 2020 2020 2020 2069 6d67 7569 2e65           imgui.e
+00015ca0: 6e64 5f70 6f70 7570 2829 0d0a 2020 2020  nd_popup()..    
+00015cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015cc0: 696d 6775 692e 656e 645f 6368 696c 6428  imgui.end_child(
+00015cd0: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
+00015ce0: 2020 2020 2069 6d67 7569 2e70 6f70 5f73       imgui.pop_s
+00015cf0: 7479 6c65 5f76 6172 2833 290d 0a20 2020  tyle_var(3)..   
+00015d00: 2020 2020 2020 2020 2020 2020 2069 6d67               img
+00015d10: 7569 2e70 6f70 5f73 7479 6c65 5f63 6f6c  ui.pop_style_col
+00015d20: 6f72 2831 290d 0a0d 0a20 2020 2020 2020  or(1)....       
+00015d30: 2020 2020 2053 6567 6d65 6e74 6174 696f       Segmentatio
+00015d40: 6e45 6469 746f 722e 4c49 4748 545f 5350  nEditor.LIGHT_SP
+00015d50: 4f54 2e63 6f6d 7075 7465 5f76 6563 2864  OT.compute_vec(d
+00015d60: 7961 773d 2d73 656c 662e 6361 6d65 7261  yaw=-self.camera
+00015d70: 3364 2e79 6177 290d 0a20 2020 2020 2020  3d.yaw)..       
+00015d80: 2020 2020 2069 6620 696d 6775 692e 636f       if imgui.co
+00015d90: 6c6c 6170 7369 6e67 5f68 6561 6465 7228  llapsing_header(
+00015da0: 2247 7261 7068 6963 7320 7365 7474 696e  "Graphics settin
+00015db0: 6773 222c 204e 6f6e 6529 5b30 5d3a 0d0a  gs", None)[0]:..
+00015dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015dd0: 696d 6775 692e 7075 7368 5f73 7479 6c65  imgui.push_style
+00015de0: 5f76 6172 2869 6d67 7569 2e53 5459 4c45  _var(imgui.STYLE
+00015df0: 5f46 5241 4d45 5f42 4f52 4445 5253 495a  _FRAME_BORDERSIZ
+00015e00: 452c 2031 290d 0a20 2020 2020 2020 2020  E, 1)..         
+00015e10: 2020 2020 2020 2069 6d67 7569 2e70 7573         imgui.pus
+00015e20: 685f 7374 796c 655f 7661 7228 696d 6775  h_style_var(imgu
+00015e30: 692e 5354 594c 455f 4652 414d 455f 5041  i.STYLE_FRAME_PA
+00015e40: 4444 494e 472c 2028 322c 2032 2929 0d0a  DDING, (2, 2))..
+00015e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015e60: 6377 203d 2069 6d67 7569 2e67 6574 5f63  cw = imgui.get_c
+00015e70: 6f6e 7465 6e74 5f72 6567 696f 6e5f 6176  ontent_region_av
+00015e80: 6169 6c61 626c 655f 7769 6474 6828 290d  ailable_width().
+00015e90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015ea0: 2069 6d67 7569 2e61 6c69 676e 5f74 6578   imgui.align_tex
+00015eb0: 745f 746f 5f66 7261 6d65 5f70 6164 6469  t_to_frame_paddi
+00015ec0: 6e67 2829 0d0a 2020 2020 2020 2020 2020  ng()..          
+00015ed0: 2020 2020 2020 696d 6775 692e 7465 7874        imgui.text
+00015ee0: 2822 566f 6c75 6d65 2072 656e 6465 7220  ("Volume render 
+00015ef0: 7374 796c 653a 2229 0d0a 2020 2020 2020  style:")..      
+00015f00: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
+00015f10: 7361 6d65 5f6c 696e 6528 290d 0a20 2020  same_line()..   
+00015f20: 2020 2020 2020 2020 2020 2020 2069 6d67               img
+00015f30: 7569 2e70 7573 685f 6974 656d 5f77 6964  ui.push_item_wid
+00015f40: 7468 2863 7720 2d20 3134 3529 0d0a 2020  th(cw - 145)..  
+00015f50: 2020 2020 2020 2020 2020 2020 2020 5f2c                _,
+00015f60: 2053 6567 6d65 6e74 6174 696f 6e45 6469   SegmentationEdi
+00015f70: 746f 722e 5345 4c45 4354 4544 5f52 454e  tor.SELECTED_REN
+00015f80: 4445 525f 5354 594c 4520 3d20 696d 6775  DER_STYLE = imgu
+00015f90: 692e 636f 6d62 6f28 2223 2347 7261 7068  i.combo("##Graph
+00015fa0: 6963 7320 7374 796c 6522 2c20 5365 676d  ics style", Segm
+00015fb0: 656e 7461 7469 6f6e 4564 6974 6f72 2e53  entationEditor.S
+00015fc0: 454c 4543 5445 445f 5245 4e44 4552 5f53  ELECTED_RENDER_S
+00015fd0: 5459 4c45 2c20 5365 676d 656e 7461 7469  TYLE, Segmentati
+00015fe0: 6f6e 4564 6974 6f72 2e52 454e 4445 525f  onEditor.RENDER_
+00015ff0: 5354 594c 4553 290d 0a20 2020 2020 2020  STYLES)..       
+00016000: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
+00016010: 6f70 5f69 7465 6d5f 7769 6474 6828 290d  op_item_width().
+00016020: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016030: 205f 2c20 5365 676d 656e 7461 7469 6f6e   _, Segmentation
+00016040: 4564 6974 6f72 2e52 454e 4445 525f 434c  Editor.RENDER_CL
+00016050: 4541 525f 434f 4c4f 5552 203d 2069 6d67  EAR_COLOUR = img
+00016060: 7569 2e63 6f6c 6f72 5f65 6469 7433 2822  ui.color_edit3("
+00016070: 2323 636c 7263 6c72 222c 202a 5365 676d  ##clrclr", *Segm
+00016080: 656e 7461 7469 6f6e 4564 6974 6f72 2e52  entationEditor.R
+00016090: 454e 4445 525f 434c 4541 525f 434f 4c4f  ENDER_CLEAR_COLO
+000160a0: 5552 5b3a 335d 2c20 696d 6775 692e 434f  UR[:3], imgui.CO
+000160b0: 4c4f 525f 4544 4954 5f4e 4f5f 494e 5055  LOR_EDIT_NO_INPU
+000160c0: 5453 207c 2069 6d67 7569 2e43 4f4c 4f52  TS | imgui.COLOR
+000160d0: 5f45 4449 545f 4e4f 5f4c 4142 454c 207c  _EDIT_NO_LABEL |
+000160e0: 2069 6d67 7569 2e43 4f4c 4f52 5f45 4449   imgui.COLOR_EDI
+000160f0: 545f 4e4f 5f54 4f4f 4c54 4950 207c 2069  T_NO_TOOLTIP | i
+00016100: 6d67 7569 2e43 4f4c 4f52 5f45 4449 545f  mgui.COLOR_EDIT_
+00016110: 4e4f 5f44 5241 475f 4452 4f50 290d 0a20  NO_DRAG_DROP).. 
+00016120: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00016130: 6d67 7569 2e73 616d 655f 6c69 6e65 2829  mgui.same_line()
+00016140: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00016150: 2020 696d 6775 692e 616c 6967 6e5f 7465    imgui.align_te
+00016160: 7874 5f74 6f5f 6672 616d 655f 7061 6464  xt_to_frame_padd
+00016170: 696e 6728 290d 0a20 2020 2020 2020 2020  ing()..         
+00016180: 2020 2020 2020 2069 6d67 7569 2e74 6578         imgui.tex
+00016190: 7428 2220 4261 636b 6772 6f75 6e64 2063  t(" Background c
+000161a0: 6f6c 6f75 7220 2020 2020 2229 0d0a 2020  olour     ")..  
+000161b0: 2020 2020 2020 2020 2020 2020 2020 696d                im
+000161c0: 6775 692e 7361 6d65 5f6c 696e 6528 290d  gui.same_line().
+000161d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000161e0: 205f 2c20 5365 676d 656e 7461 7469 6f6e   _, Segmentation
+000161f0: 4564 6974 6f72 2e4c 4947 4854 5f53 504f  Editor.LIGHT_SPO
+00016200: 542e 636f 6c6f 7572 203d 2069 6d67 7569  T.colour = imgui
+00016210: 2e63 6f6c 6f72 5f65 6469 7433 2822 2323  .color_edit3("##
+00016220: 6c69 6768 7463 6c72 222c 202a 5365 676d  lightclr", *Segm
+00016230: 656e 7461 7469 6f6e 4564 6974 6f72 2e4c  entationEditor.L
+00016240: 4947 4854 5f53 504f 542e 636f 6c6f 7572  IGHT_SPOT.colour
+00016250: 5b3a 335d 2c20 696d 6775 692e 434f 4c4f  [:3], imgui.COLO
+00016260: 525f 4544 4954 5f4e 4f5f 494e 5055 5453  R_EDIT_NO_INPUTS
+00016270: 207c 2069 6d67 7569 2e43 4f4c 4f52 5f45   | imgui.COLOR_E
+00016280: 4449 545f 4e4f 5f4c 4142 454c 207c 2069  DIT_NO_LABEL | i
+00016290: 6d67 7569 2e43 4f4c 4f52 5f45 4449 545f  mgui.COLOR_EDIT_
+000162a0: 4e4f 5f54 4f4f 4c54 4950 207c 2069 6d67  NO_TOOLTIP | img
+000162b0: 7569 2e43 4f4c 4f52 5f45 4449 545f 4e4f  ui.COLOR_EDIT_NO
+000162c0: 5f44 5241 475f 4452 4f50 290d 0a20 2020  _DRAG_DROP)..   
+000162d0: 2020 2020 2020 2020 2020 2020 2069 6d67               img
+000162e0: 7569 2e73 616d 655f 6c69 6e65 2829 0d0a  ui.same_line()..
+000162f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016300: 696d 6775 692e 616c 6967 6e5f 7465 7874  imgui.align_text
+00016310: 5f74 6f5f 6672 616d 655f 7061 6464 696e  _to_frame_paddin
+00016320: 6728 290d 0a20 2020 2020 2020 2020 2020  g()..           
+00016330: 2020 2020 2069 6d67 7569 2e74 6578 7428       imgui.text(
+00016340: 2220 4c69 6768 7420 636f 6c6f 7572 2229  " Light colour")
+00016350: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+00016360: 2020 2020 696d 6775 692e 7075 7368 5f73      imgui.push_s
+00016370: 7479 6c65 5f76 6172 2869 6d67 7569 2e53  tyle_var(imgui.S
+00016380: 5459 4c45 5f46 5241 4d45 5f52 4f55 4e44  TYLE_FRAME_ROUND
+00016390: 494e 472c 2031 3029 0d0a 2020 2020 2020  ING, 10)..      
+000163a0: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
+000163b0: 7075 7368 5f73 7479 6c65 5f76 6172 2869  push_style_var(i
+000163c0: 6d67 7569 2e53 5459 4c45 5f46 5241 4d45  mgui.STYLE_FRAME
+000163d0: 5f50 4144 4449 4e47 2c20 2830 2c20 3029  _PADDING, (0, 0)
+000163e0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+000163f0: 2020 2069 6d67 7569 2e70 7573 685f 7374     imgui.push_st
+00016400: 796c 655f 7661 7228 696d 6775 692e 5354  yle_var(imgui.ST
+00016410: 594c 455f 4752 4142 5f52 4f55 4e44 494e  YLE_GRAB_ROUNDIN
+00016420: 472c 2031 3029 0d0a 2020 2020 2020 2020  G, 10)..        
+00016430: 2020 2020 2020 2020 696d 6775 692e 7075          imgui.pu
+00016440: 7368 5f69 7465 6d5f 7769 6474 6828 6377  sh_item_width(cw
+00016450: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00016460: 2020 205f 2c20 5365 676d 656e 7461 7469     _, Segmentati
+00016470: 6f6e 4564 6974 6f72 2e4c 4947 4854 5f41  onEditor.LIGHT_A
+00016480: 4d42 4945 4e54 5f53 5452 454e 4754 4820  MBIENT_STRENGTH 
+00016490: 3d20 696d 6775 692e 736c 6964 6572 5f66  = imgui.slider_f
+000164a0: 6c6f 6174 2822 2323 616d 6269 656e 7420  loat("##ambient 
+000164b0: 6c69 6768 7469 6e67 222c 2053 6567 6d65  lighting", Segme
+000164c0: 6e74 6174 696f 6e45 6469 746f 722e 4c49  ntationEditor.LI
+000164d0: 4748 545f 414d 4249 454e 545f 5354 5245  GHT_AMBIENT_STRE
+000164e0: 4e47 5448 2c20 302e 302c 2031 2e30 2c20  NGTH, 0.0, 1.0, 
+000164f0: 6622 616d 6269 656e 7420 7374 7265 6e67  f"ambient streng
+00016500: 7468 203d 2025 2e32 6622 290d 0a20 2020  th = %.2f")..   
+00016510: 2020 2020 2020 2020 2020 2020 205f 2c20               _, 
+00016520: 5365 676d 656e 7461 7469 6f6e 4564 6974  SegmentationEdit
+00016530: 6f72 2e4c 4947 4854 5f53 504f 542e 7374  or.LIGHT_SPOT.st
+00016540: 7265 6e67 7468 203d 2069 6d67 7569 2e73  rength = imgui.s
+00016550: 6c69 6465 725f 666c 6f61 7428 2223 2373  lider_float("##s
+00016560: 706f 7420 6c69 6768 7469 6e67 222c 2053  pot lighting", S
+00016570: 6567 6d65 6e74 6174 696f 6e45 6469 746f  egmentationEdito
+00016580: 722e 4c49 4748 545f 5350 4f54 2e73 7472  r.LIGHT_SPOT.str
+00016590: 656e 6774 682c 2030 2e30 2c20 312e 302c  ength, 0.0, 1.0,
+000165a0: 2066 2273 706f 7420 7374 7265 6e67 7468   f"spot strength
+000165b0: 203d 2025 2e32 6622 290d 0a20 2020 2020   = %.2f")..     
+000165c0: 2020 2020 2020 2020 2020 205f 7961 772c             _yaw,
+000165d0: 2053 6567 6d65 6e74 6174 696f 6e45 6469   SegmentationEdi
+000165e0: 746f 722e 4c49 4748 545f 5350 4f54 2e79  tor.LIGHT_SPOT.y
+000165f0: 6177 203d 2069 6d67 7569 2e64 7261 675f  aw = imgui.drag_
+00016600: 666c 6f61 7428 2223 2379 6177 222c 2053  float("##yaw", S
+00016610: 6567 6d65 6e74 6174 696f 6e45 6469 746f  egmentationEdito
+00016620: 722e 4c49 4748 545f 5350 4f54 2e79 6177  r.LIGHT_SPOT.yaw
+00016630: 2c20 302e 352c 2066 6f72 6d61 743d 6622  , 0.5, format=f"
+00016640: 7370 6f74 2079 6177 203d 2025 2e31 6622  spot yaw = %.1f"
+00016650: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00016660: 2020 205f 7069 7463 682c 2053 6567 6d65     _pitch, Segme
+00016670: 6e74 6174 696f 6e45 6469 746f 722e 4c49  ntationEditor.LI
+00016680: 4748 545f 5350 4f54 2e70 6974 6368 203d  GHT_SPOT.pitch =
+00016690: 2069 6d67 7569 2e73 6c69 6465 725f 666c   imgui.slider_fl
+000166a0: 6f61 7428 2223 2370 6974 6368 222c 2053  oat("##pitch", S
+000166b0: 6567 6d65 6e74 6174 696f 6e45 6469 746f  egmentationEdito
+000166c0: 722e 4c49 4748 545f 5350 4f54 2e70 6974  r.LIGHT_SPOT.pit
+000166d0: 6368 2c20 2d39 302e 302c 2039 302e 302c  ch, -90.0, 90.0,
+000166e0: 2066 6f72 6d61 743d 6622 7370 6f74 2070   format=f"spot p
+000166f0: 6974 6368 203d 2025 2e31 6622 290d 0a20  itch = %.1f").. 
+00016700: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00016710: 6d67 7569 2e70 6f70 5f69 7465 6d5f 7769  mgui.pop_item_wi
+00016720: 6474 6828 290d 0a0d 0a20 2020 2020 2020  dth()....       
+00016730: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
+00016740: 7573 685f 7374 796c 655f 636f 6c6f 7228  ush_style_color(
+00016750: 696d 6775 692e 434f 4c4f 525f 4348 4543  imgui.COLOR_CHEC
+00016760: 4b5f 4d41 524b 2c20 302e 302c 2030 2e30  K_MARK, 0.0, 0.0
+00016770: 2c20 302e 3029 0d0a 2020 2020 2020 2020  , 0.0)..        
+00016780: 2020 2020 2020 2020 5f2c 2053 6567 6d65          _, Segme
+00016790: 6e74 6174 696f 6e45 6469 746f 722e 5245  ntationEditor.RE
+000167a0: 4e44 4552 5f42 4f58 203d 2069 6d67 7569  NDER_BOX = imgui
+000167b0: 2e63 6865 636b 626f 7828 2220 7265 6e64  .checkbox(" rend
+000167c0: 6572 2062 6f75 6e64 696e 6720 626f 7820  er bounding box 
+000167d0: 2020 222c 2053 6567 6d65 6e74 6174 696f    ", Segmentatio
+000167e0: 6e45 6469 746f 722e 5245 4e44 4552 5f42  nEditor.RENDER_B
+000167f0: 4f58 290d 0a0d 0a20 2020 2020 2020 2020  OX)....         
+00016800: 2020 2020 2020 2069 6d67 7569 2e73 616d         imgui.sam
+00016810: 655f 6c69 6e65 2829 0d0a 2020 2020 2020  e_line()..      
+00016820: 2020 2020 2020 2020 2020 5f72 656e 6465            _rende
+00016830: 725f 6672 616d 6520 3d20 5365 676d 656e  r_frame = Segmen
+00016840: 7461 7469 6f6e 4564 6974 6f72 2e50 4943  tationEditor.PIC
+00016850: 4b49 4e47 5f46 5241 4d45 5f41 4c50 4841  KING_FRAME_ALPHA
+00016860: 2021 3d20 302e 300d 0a20 2020 2020 2020   != 0.0..       
+00016870: 2020 2020 2020 2020 205f 722c 205f 7265           _r, _re
+00016880: 6e64 6572 5f66 7261 6d65 203d 2069 6d67  nder_frame = img
+00016890: 7569 2e63 6865 636b 626f 7828 2272 656e  ui.checkbox("ren
+000168a0: 6465 7220 6672 616d 6522 2c20 5f72 656e  der frame", _ren
+000168b0: 6465 725f 6672 616d 6529 0d0a 2020 2020  der_frame)..    
+000168c0: 2020 2020 2020 2020 2020 2020 6966 205f              if _
+000168d0: 723a 0d0a 2020 2020 2020 2020 2020 2020  r:..            
+000168e0: 2020 2020 2020 2020 5365 676d 656e 7461          Segmenta
+000168f0: 7469 6f6e 4564 6974 6f72 2e50 4943 4b49  tionEditor.PICKI
+00016900: 4e47 5f46 5241 4d45 5f41 4c50 4841 203d  NG_FRAME_ALPHA =
+00016910: 2066 6c6f 6174 285f 7265 6e64 6572 5f66   float(_render_f
+00016920: 7261 6d65 290d 0a20 2020 2020 2020 2020  rame)..         
+00016930: 2020 2020 2020 205f 2c20 5365 676d 656e         _, Segmen
+00016940: 7461 7469 6f6e 4564 6974 6f72 2e52 454e  tationEditor.REN
+00016950: 4445 525f 5041 5254 4943 4c45 535f 5852  DER_PARTICLES_XR
+00016960: 4159 203d 2069 6d67 7569 2e63 6865 636b  AY = imgui.check
+00016970: 626f 7828 2220 7061 7274 6963 6c65 2078  box(" particle x
+00016980: 2d72 6179 222c 2053 6567 6d65 6e74 6174  -ray", Segmentat
+00016990: 696f 6e45 6469 746f 722e 5245 4e44 4552  ionEditor.RENDER
+000169a0: 5f50 4152 5449 434c 4553 5f58 5241 5929  _PARTICLES_XRAY)
+000169b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000169c0: 2020 696d 6775 692e 706f 705f 7374 796c    imgui.pop_styl
+000169d0: 655f 7661 7228 3429 0d0a 2020 2020 2020  e_var(4)..      
+000169e0: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
+000169f0: 706f 705f 7374 796c 655f 636f 6c6f 7228  pop_style_color(
+00016a00: 3129 0d0a 0d0a 2020 2020 2020 2020 2020  1)....          
+00016a10: 2020 2020 2020 6966 2077 6964 6765 7473        if widgets
+00016a20: 2e63 656e 7472 6564 5f62 7574 746f 6e28  .centred_button(
+00016a30: 2752 6563 6f6d 7069 6c65 2053 6861 6465  'Recompile Shade
+00016a40: 7273 272c 2031 3530 2c20 3230 293a 0d0a  rs', 150, 20):..
+00016a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016a60: 2020 2020 7365 6c66 2e72 656e 6465 7265      self.rendere
+00016a70: 722e 7265 636f 6d70 696c 655f 7368 6164  r.recompile_shad
+00016a80: 6572 7328 290d 0a0d 0a20 2020 2020 2020  ers()....       
+00016a90: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
+00016aa0: 6f70 5f73 7479 6c65 5f76 6172 2831 290d  op_style_var(1).
+00016ab0: 0a0d 0a20 2020 2020 2020 2020 2020 2069  ...            i
+00016ac0: 6620 696d 6775 692e 636f 6c6c 6170 7369  f imgui.collapsi
+00016ad0: 6e67 5f68 6561 6465 7228 2245 7870 6f72  ng_header("Expor
+00016ae0: 7420 3344 2073 6365 6e65 222c 204e 6f6e  t 3D scene", Non
+00016af0: 6529 5b30 5d3a 0d0a 2020 2020 2020 2020  e)[0]:..        
+00016b00: 2020 2020 2020 2020 6377 203d 2069 6d67          cw = img
+00016b10: 7569 2e67 6574 5f63 6f6e 7465 6e74 5f72  ui.get_content_r
+00016b20: 6567 696f 6e5f 6176 6169 6c61 626c 655f  egion_available_
+00016b30: 7769 6474 6828 290d 0a20 2020 2020 2020  width()..       
+00016b40: 2020 2020 2020 2020 2073 7061 6369 6e67           spacing
+00016b50: 203d 2031 300d 0a20 2020 2020 2020 2020   = 10..         
+00016b60: 2020 2020 2020 2073 203d 2028 6377 202d         s = (cw -
+00016b70: 2032 202a 2073 7061 6369 6e67 202a 2032   2 * spacing * 2
+00016b80: 202d 2033 2920 2f20 330d 0a20 2020 2020   - 3) / 3..     
+00016b90: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
+00016ba0: 2e70 7573 685f 7374 796c 655f 7661 7228  .push_style_var(
+00016bb0: 696d 6775 692e 5354 594c 455f 4652 414d  imgui.STYLE_FRAM
+00016bc0: 455f 524f 554e 4449 4e47 2c20 3130 3029  E_ROUNDING, 100)
+00016bd0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00016be0: 2020 696d 6775 692e 7075 7368 5f73 7479    imgui.push_sty
+00016bf0: 6c65 5f63 6f6c 6f72 2869 6d67 7569 2e43  le_color(imgui.C
+00016c00: 4f4c 4f52 5f42 5554 544f 4e5f 484f 5645  OLOR_BUTTON_HOVE
+00016c10: 5245 442c 202a 6366 672e 434f 4c4f 5552  RED, *cfg.COLOUR
+00016c20: 5f46 5241 4d45 5f44 4152 4b29 0d0a 2020  _FRAME_DARK)..  
+00016c30: 2020 2020 2020 2020 2020 2020 2020 696d                im
+00016c40: 6775 692e 7075 7368 5f73 7479 6c65 5f63  gui.push_style_c
+00016c50: 6f6c 6f72 2869 6d67 7569 2e43 4f4c 4f52  olor(imgui.COLOR
+00016c60: 5f42 4f52 4445 522c 202a 6366 672e 434f  _BORDER, *cfg.CO
+00016c70: 4c4f 5552 5f46 5241 4d45 5f44 4152 4b29  LOUR_FRAME_DARK)
+00016c80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00016c90: 2020 696d 6775 692e 7075 7368 5f73 7479    imgui.push_sty
+00016ca0: 6c65 5f76 6172 2869 6d67 7569 2e53 5459  le_var(imgui.STY
+00016cb0: 4c45 5f46 5241 4d45 5f42 4f52 4445 5253  LE_FRAME_BORDERS
+00016cc0: 495a 452c 2031 290d 0a20 2020 2020 2020  IZE, 1)..       
+00016cd0: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
+00016ce0: 7573 685f 7374 796c 655f 636f 6c6f 7228  ush_style_color(
+00016cf0: 696d 6775 692e 434f 4c4f 525f 4652 414d  imgui.COLOR_FRAM
+00016d00: 455f 4241 434b 4752 4f55 4e44 5f41 4354  E_BACKGROUND_ACT
+00016d10: 4956 452c 202a 6366 672e 434f 4c4f 5552  IVE, *cfg.COLOUR
+00016d20: 5f46 5241 4d45 5f45 5854 5241 5f44 4152  _FRAME_EXTRA_DAR
+00016d30: 4b29 0d0a 2020 2020 2020 2020 2020 2020  K)..            
+00016d40: 2020 2020 6966 2069 6d67 7569 2e69 6d61      if imgui.ima
+00016d50: 6765 5f62 7574 746f 6e28 7365 6c66 2e69  ge_button(self.i
+00016d60: 636f 6e5f 6f62 6a2e 7265 6e64 6572 6572  con_obj.renderer
+00016d70: 5f69 642c 2073 2c20 7329 3a0d 0a20 2020  _id, s, s):..   
+00016d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016d90: 2053 6567 6d65 6e74 6174 696f 6e45 6469   SegmentationEdi
+00016da0: 746f 722e 7361 7665 5f73 7572 6661 6365  tor.save_surface
+00016db0: 5f6d 6f64 656c 735f 6173 5f6f 626a 7328  _models_as_objs(
+00016dc0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00016dd0: 2020 2069 6d67 7569 2e73 616d 655f 6c69     imgui.same_li
+00016de0: 6e65 2873 7061 6369 6e67 3d73 7061 6369  ne(spacing=spaci
+00016df0: 6e67 290d 0a20 2020 2020 2020 2020 2020  ng)..           
+00016e00: 2020 2020 2069 6620 696d 6775 692e 696d       if imgui.im
+00016e10: 6167 655f 6275 7474 6f6e 2873 656c 662e  age_button(self.
+00016e20: 6963 6f6e 5f62 6c65 6e64 6572 2e72 656e  icon_blender.ren
+00016e30: 6465 7265 725f 6964 2c20 732c 2073 293a  derer_id, s, s):
+00016e40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00016e50: 2020 2020 2020 6f62 6a5f 7061 7468 7320        obj_paths 
+00016e60: 3d20 5365 676d 656e 7461 7469 6f6e 4564  = SegmentationEd
+00016e70: 6974 6f72 2e73 6176 655f 7375 7266 6163  itor.save_surfac
+00016e80: 655f 6d6f 6465 6c73 5f61 735f 6f62 6a73  e_models_as_objs
+00016e90: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
+00016ea0: 2020 2020 2020 2020 2320 7468 656e 206f          # then o
+00016eb0: 7065 6e20 426c 656e 6465 722e 0d0a 2020  pen Blender...  
+00016ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016ed0: 2020 5365 676d 656e 7461 7469 6f6e 4564    SegmentationEd
+00016ee0: 6974 6f72 2e6f 7065 6e5f 6f62 6a73 5f69  itor.open_objs_i
+00016ef0: 6e5f 626c 656e 6465 7228 6f62 6a5f 7061  n_blender(obj_pa
+00016f00: 7468 7329 0d0a 2020 2020 2020 2020 2020  ths)..          
+00016f10: 2020 2020 2020 6966 2069 6d67 7569 2e62        if imgui.b
+00016f20: 6567 696e 5f70 6f70 7570 5f63 6f6e 7465  egin_popup_conte
+00016f30: 7874 5f77 696e 646f 7728 293a 0d0a 2020  xt_window():..  
+00016f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016f50: 2020 6966 2069 6d67 7569 2e6d 656e 755f    if imgui.menu_
+00016f60: 6974 656d 2822 5365 7420 7061 7468 2074  item("Set path t
+00016f70: 6f20 626c 656e 6465 722e 6578 6522 295b  o blender.exe")[
+00016f80: 305d 3a0d 0a20 2020 2020 2020 2020 2020  0]:..           
+00016f90: 2020 2020 2020 2020 2020 2020 2070 6174               pat
+00016fa0: 6820 3d20 6669 6c65 6469 616c 6f67 2e61  h = filedialog.a
+00016fb0: 736b 6f70 656e 6669 6c65 6e61 6d65 2866  skopenfilename(f
+00016fc0: 696c 6574 7970 6573 3d5b 2822 426c 656e  iletypes=[("Blen
+00016fd0: 6465 7220 6578 6563 7574 6162 6c65 222c  der executable",
+00016fe0: 2022 2e65 7865 2229 5d29 0d0a 2020 2020   ".exe")])..    
+00016ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017000: 2020 2020 6966 2070 6174 6820 213d 2022      if path != "
+00017010: 223a 0d0a 2020 2020 2020 2020 2020 2020  ":..            
+00017020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017030: 6366 672e 6564 6974 5f73 6574 7469 6e67  cfg.edit_setting
+00017040: 2822 424c 454e 4445 525f 4558 4522 2c20  ("BLENDER_EXE", 
+00017050: 7061 7468 290d 0a20 2020 2020 2020 2020  path)..         
+00017060: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
+00017070: 2e65 6e64 5f70 6f70 7570 2829 0d0a 2020  .end_popup()..  
+00017080: 2020 2020 2020 2020 2020 2020 2020 696d                im
+00017090: 6775 692e 7361 6d65 5f6c 696e 6528 7370  gui.same_line(sp
+000170a0: 6163 696e 673d 7370 6163 696e 6729 0d0a  acing=spacing)..
+000170b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000170c0: 6966 2069 6d67 7569 2e69 6d61 6765 5f62  if imgui.image_b
+000170d0: 7574 746f 6e28 7365 6c66 2e69 636f 6e5f  utton(self.icon_
+000170e0: 6368 696d 6572 6178 2e72 656e 6465 7265  chimerax.rendere
+000170f0: 725f 6964 2c20 732c 2073 293a 0d0a 2020  r_id, s, s):..  
+00017100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017110: 2020 6d6f 6465 6c73 203d 206c 6973 7428    models = list(
+00017120: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00017130: 2020 2020 2020 2066 6f72 206d 2069 6e20         for m in 
+00017140: 6366 672e 7365 5f73 7572 6661 6365 5f6d  cfg.se_surface_m
+00017150: 6f64 656c 733a 0d0a 2020 2020 2020 2020  odels:..        
+00017160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017170: 6966 206d 2e69 6e69 7469 616c 697a 6564  if m.initialized
+00017180: 2061 6e64 206e 6f74 206d 2e68 6964 653a   and not m.hide:
+00017190: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000171a0: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
+000171b0: 6465 6c73 2e61 7070 656e 6428 6d29 0d0a  dels.append(m)..
+000171c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000171d0: 2020 2020 5365 676d 656e 7461 7469 6f6e      Segmentation
+000171e0: 4564 6974 6f72 2e6f 7065 6e5f 696e 5f63  Editor.open_in_c
+000171f0: 6869 6d65 7261 7828 6d6f 6465 6c73 290d  himerax(models).
+00017200: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017210: 2069 6620 696d 6775 692e 6265 6769 6e5f   if imgui.begin_
+00017220: 706f 7075 705f 636f 6e74 6578 745f 7769  popup_context_wi
+00017230: 6e64 6f77 2829 3a0d 0a20 2020 2020 2020  ndow():..       
+00017240: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00017250: 696d 6775 692e 6d65 6e75 5f69 7465 6d28  imgui.menu_item(
+00017260: 2253 6574 2070 6174 6820 746f 2043 6869  "Set path to Chi
+00017270: 6d65 7261 582e 6578 6522 295b 305d 3a0d  meraX.exe")[0]:.
+00017280: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017290: 2020 2020 2020 2020 2070 6174 6820 3d20           path = 
+000172a0: 6669 6c65 6469 616c 6f67 2e61 736b 6f70  filedialog.askop
+000172b0: 656e 6669 6c65 6e61 6d65 2866 696c 6574  enfilename(filet
+000172c0: 7970 6573 3d5b 2822 4368 696d 6572 6158  ypes=[("ChimeraX
+000172d0: 2065 7865 6375 7461 626c 6522 2c20 222e   executable", ".
+000172e0: 6578 6522 295d 290d 0a20 2020 2020 2020  exe")])..       
 000172f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017300: 7365 6c66 2e6c 6f61 645f 6d6f 6465 6c28  self.load_model(
-00017310: 6669 6c65 6e61 6d65 290d 0a20 2020 2020  filename)..     
-00017320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017330: 2020 2065 7863 6570 7420 4578 6365 7074     except Except
-00017340: 696f 6e20 6173 2065 3a0d 0a20 2020 2020  ion as e:..     
-00017350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017360: 2020 2020 2020 2063 6667 2e73 6574 5f65         cfg.set_e
-00017370: 7272 6f72 2865 2c20 2243 6f75 6c64 206e  rror(e, "Could n
-00017380: 6f74 2069 6d70 6f72 7420 6d6f 6465 6c2c  ot import model,
-00017390: 2073 6565 2064 6574 6169 6c73 2062 656c   see details bel
-000173a0: 6f77 2e22 290d 0a20 2020 2020 2020 2020  ow.")..         
-000173b0: 2020 2020 2020 2020 2020 2069 6620 696d             if im
-000173c0: 6775 692e 6d65 6e75 5f69 7465 6d28 2249  gui.menu_item("I
-000173d0: 6d70 6f72 7420 6d6f 6465 6c20 6772 6f75  mport model grou
-000173e0: 7022 295b 305d 3a0d 0a20 2020 2020 2020  p")[0]:..       
-000173f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017400: 2074 7279 3a0d 0a20 2020 2020 2020 2020   try:..         
-00017410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017420: 2020 2066 696c 656e 616d 6520 3d20 6669     filename = fi
-00017430: 6c65 6469 616c 6f67 2e61 736b 6f70 656e  ledialog.askopen
-00017440: 6669 6c65 6e61 6d65 2866 696c 6574 7970  filename(filetyp
-00017450: 6573 3d5b 2822 7363 4e6f 6465 7320 6d6f  es=[("scNodes mo
-00017460: 6465 6c20 6772 6f75 7022 2c20 6366 672e  del group", cfg.
-00017470: 6669 6c65 7479 7065 5f73 656d 6f64 656c  filetype_semodel
-00017480: 5f67 726f 7570 295d 290d 0a20 2020 2020  _group)])..     
-00017490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000174a0: 2020 2020 2020 2069 6620 6669 6c65 6e61         if filena
-000174b0: 6d65 2021 3d20 2727 3a0d 0a20 2020 2020  me != '':..     
-000174c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000174d0: 2020 2020 2020 2020 2020 2053 6567 6d65             Segme
-000174e0: 6e74 6174 696f 6e45 6469 746f 722e 6c6f  ntationEditor.lo
-000174f0: 6164 5f6d 6f64 656c 5f67 726f 7570 2866  ad_model_group(f
-00017500: 696c 656e 616d 6529 0d0a 2020 2020 2020  ilename)..      
-00017510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017520: 2020 6578 6365 7074 2045 7863 6570 7469    except Excepti
-00017530: 6f6e 2061 7320 653a 0d0a 2020 2020 2020  on as e:..      
-00017540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017550: 2020 2020 2020 6366 672e 7365 745f 6572        cfg.set_er
-00017560: 726f 7228 652c 2022 436f 756c 6420 6e6f  ror(e, "Could no
-00017570: 7420 696d 706f 7274 206d 6f64 656c 2067  t import model g
-00017580: 726f 7570 2c20 7365 6520 6465 7461 696c  roup, see detail
-00017590: 7320 6265 6c6f 772e 2229 0d0a 2020 2020  s below.")..    
-000175a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000175b0: 696d 6775 692e 7365 7061 7261 746f 7228  imgui.separator(
-000175c0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-000175d0: 2020 2020 2020 2069 6620 696d 6775 692e         if imgui.
-000175e0: 6d65 6e75 5f69 7465 6d28 2253 6176 6520  menu_item("Save 
-000175f0: 6461 7461 7365 7422 295b 305d 3a0d 0a20  dataset")[0]:.. 
-00017600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017610: 2020 2020 2020 2053 6567 6d65 6e74 6174         Segmentat
-00017620: 696f 6e45 6469 746f 722e 7361 7665 5f64  ionEditor.save_d
-00017630: 6174 6173 6574 2864 6961 6c6f 673d 4661  ataset(dialog=Fa
-00017640: 6c73 6529 0d0a 2020 2020 2020 2020 2020  lse)..          
-00017650: 2020 2020 2020 2020 2020 6966 2069 6d67            if img
-00017660: 7569 2e6d 656e 755f 6974 656d 2822 5361  ui.menu_item("Sa
-00017670: 7665 2064 6174 6173 6574 2061 7320 2229  ve dataset as ")
-00017680: 5b30 5d3a 0d0a 2020 2020 2020 2020 2020  [0]:..          
-00017690: 2020 2020 2020 2020 2020 2020 2020 5365                Se
-000176a0: 676d 656e 7461 7469 6f6e 4564 6974 6f72  gmentationEditor
-000176b0: 2e73 6176 655f 6461 7461 7365 7428 6469  .save_dataset(di
-000176c0: 616c 6f67 3d54 7275 6529 0d0a 2020 2020  alog=True)..    
+00017300: 2069 6620 7061 7468 2021 3d20 2222 3a0d   if path != "":.
+00017310: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017320: 2020 2020 2020 2020 2020 2020 2063 6667               cfg
+00017330: 2e65 6469 745f 7365 7474 696e 6728 2243  .edit_setting("C
+00017340: 4849 4d45 5241 585f 4558 4522 2c20 7061  HIMERAX_EXE", pa
+00017350: 7468 290d 0a20 2020 2020 2020 2020 2020  th)..           
+00017360: 2020 2020 2020 2020 2069 6d67 7569 2e65           imgui.e
+00017370: 6e64 5f70 6f70 7570 2829 0d0a 2020 2020  nd_popup()..    
+00017380: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
+00017390: 692e 706f 705f 7374 796c 655f 7661 7228  i.pop_style_var(
+000173a0: 3229 0d0a 2020 2020 2020 2020 2020 2020  2)..            
+000173b0: 2020 2020 696d 6775 692e 706f 705f 7374      imgui.pop_st
+000173c0: 796c 655f 636f 6c6f 7228 3329 0d0a 0d0a  yle_color(3)....
+000173d0: 2020 2020 2020 2020 6465 6620 6d65 6e75          def menu
+000173e0: 5f62 6172 2829 3a0d 0a20 2020 2020 2020  _bar():..       
+000173f0: 2020 2020 2069 6d67 7569 2e70 7573 685f       imgui.push_
+00017400: 7374 796c 655f 636f 6c6f 7228 696d 6775  style_color(imgu
+00017410: 692e 434f 4c4f 525f 4d45 4e55 4241 525f  i.COLOR_MENUBAR_
+00017420: 4241 434b 4752 4f55 4e44 2c20 2a63 6667  BACKGROUND, *cfg
+00017430: 2e43 4f4c 4f55 525f 4d41 494e 5f4d 454e  .COLOUR_MAIN_MEN
+00017440: 555f 4241 5229 0d0a 2020 2020 2020 2020  U_BAR)..        
+00017450: 2020 2020 696d 6775 692e 7075 7368 5f73      imgui.push_s
+00017460: 7479 6c65 5f63 6f6c 6f72 2869 6d67 7569  tyle_color(imgui
+00017470: 2e43 4f4c 4f52 5f54 4558 542c 202a 6366  .COLOR_TEXT, *cf
+00017480: 672e 434f 4c4f 5552 5f4d 4149 4e5f 4d45  g.COLOUR_MAIN_ME
+00017490: 4e55 5f42 4152 5f54 4558 5429 0d0a 2020  NU_BAR_TEXT)..  
+000174a0: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
+000174b0: 7075 7368 5f73 7479 6c65 5f63 6f6c 6f72  push_style_color
+000174c0: 2869 6d67 7569 2e43 4f4c 4f52 5f48 4541  (imgui.COLOR_HEA
+000174d0: 4445 525f 484f 5645 5245 442c 202a 6366  DER_HOVERED, *cf
+000174e0: 672e 434f 4c4f 5552 5f4d 4149 4e5f 4d45  g.COLOUR_MAIN_ME
+000174f0: 4e55 5f42 4152 5f48 494c 4947 4854 290d  NU_BAR_HILIGHT).
+00017500: 0a20 2020 2020 2020 2020 2020 2069 6d67  .            img
+00017510: 7569 2e70 7573 685f 7374 796c 655f 636f  ui.push_style_co
+00017520: 6c6f 7228 696d 6775 692e 434f 4c4f 525f  lor(imgui.COLOR_
+00017530: 4845 4144 4552 5f41 4354 4956 452c 202a  HEADER_ACTIVE, *
+00017540: 6366 672e 434f 4c4f 5552 5f4d 4149 4e5f  cfg.COLOUR_MAIN_
+00017550: 4d45 4e55 5f42 4152 5f48 494c 4947 4854  MENU_BAR_HILIGHT
+00017560: 290d 0a20 2020 2020 2020 2020 2020 2069  )..            i
+00017570: 6d67 7569 2e70 7573 685f 7374 796c 655f  mgui.push_style_
+00017580: 636f 6c6f 7228 696d 6775 692e 434f 4c4f  color(imgui.COLO
+00017590: 525f 4845 4144 4552 2c20 2a63 6667 2e43  R_HEADER, *cfg.C
+000175a0: 4f4c 4f55 525f 4d41 494e 5f4d 454e 555f  OLOUR_MAIN_MENU_
+000175b0: 4241 525f 4849 4c49 4748 5429 0d0a 2020  BAR_HILIGHT)..  
+000175c0: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
+000175d0: 7075 7368 5f73 7479 6c65 5f63 6f6c 6f72  push_style_color
+000175e0: 2869 6d67 7569 2e43 4f4c 4f52 5f50 4f50  (imgui.COLOR_POP
+000175f0: 5550 5f42 4143 4b47 524f 554e 442c 202a  UP_BACKGROUND, *
+00017600: 6366 672e 434f 4c4f 5552 5f4d 454e 555f  cfg.COLOUR_MENU_
+00017610: 5749 4e44 4f57 5f42 4143 4b47 524f 554e  WINDOW_BACKGROUN
+00017620: 4429 0d0a 2020 2020 2020 2020 2020 2020  D)..            
+00017630: 696d 6775 692e 7075 7368 5f73 7479 6c65  imgui.push_style
+00017640: 5f76 6172 2869 6d67 7569 2e53 5459 4c45  _var(imgui.STYLE
+00017650: 5f46 5241 4d45 5f50 4144 4449 4e47 2c20  _FRAME_PADDING, 
+00017660: 2832 2e30 2c20 322e 3029 290d 0a0d 0a20  (2.0, 2.0)).... 
+00017670: 2020 2020 2020 2020 2020 2069 6620 696d             if im
+00017680: 6775 692e 636f 7265 2e62 6567 696e 5f6d  gui.core.begin_m
+00017690: 6169 6e5f 6d65 6e75 5f62 6172 2829 3a0d  ain_menu_bar():.
+000176a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000176b0: 2069 6620 696d 6775 692e 6265 6769 6e5f   if imgui.begin_
+000176c0: 6d65 6e75 2822 4669 6c65 2229 3a0d 0a20  menu("File"):.. 
 000176d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000176e0: 6966 2069 6d67 7569 2e6d 656e 755f 6974  if imgui.menu_it
-000176f0: 656d 2822 5361 7665 2064 6174 6173 6574  em("Save dataset
-00017700: 2077 2e20 6d61 7022 295b 305d 3a0d 0a20   w. map")[0]:.. 
+000176e0: 2020 2069 6620 696d 6775 692e 6d65 6e75     if imgui.menu
+000176f0: 5f69 7465 6d28 2249 6d70 6f72 7420 6461  _item("Import da
+00017700: 7461 7365 7422 295b 305d 3a0d 0a20 2020  taset")[0]:..   
 00017710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017720: 2020 2020 2020 2074 7279 3a0d 0a20 2020         try:..   
+00017720: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
 00017730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017740: 2020 2020 2020 2020 2066 696c 656e 616d           filenam
-00017750: 6520 3d20 6669 6c65 6469 616c 6f67 2e61  e = filedialog.a
-00017760: 736b 7361 7665 6173 6669 6c65 6e61 6d65  sksaveasfilename
-00017770: 2866 696c 6574 7970 6573 3d5b 2822 7363  (filetypes=[("sc
-00017780: 4e6f 6465 7320 7365 676d 656e 7461 7469  Nodes segmentati
-00017790: 6f6e 222c 2066 227b 6366 672e 6669 6c65  on", f"{cfg.file
+00017740: 2020 2020 2020 2066 696c 656e 616d 6520         filename 
+00017750: 3d20 6669 6c65 6469 616c 6f67 2e61 736b  = filedialog.ask
+00017760: 6f70 656e 6669 6c65 6e61 6d65 2866 696c  openfilename(fil
+00017770: 6574 7970 6573 3d5b 2822 7363 4e6f 6465  etypes=[("scNode
+00017780: 7320 7365 676d 656e 7461 626c 6522 2c20  s segmentable", 
+00017790: 6622 2e6d 7263 207b 6366 672e 6669 6c65  f".mrc {cfg.file
 000177a0: 7479 7065 5f73 6567 6d65 6e74 6174 696f  type_segmentatio
-000177b0: 6e7d 2229 5d2c 2069 6e69 7469 616c 6669  n}")], initialfi
-000177c0: 6c65 203d 206f 732e 7061 7468 2e62 6173  le = os.path.bas
-000177d0: 656e 616d 6528 6366 672e 7365 5f61 6374  ename(cfg.se_act
-000177e0: 6976 655f 6672 616d 652e 7061 7468 295b  ive_frame.path)[
-000177f0: 3a2d 345d 290d 0a20 2020 2020 2020 2020  :-4])..         
-00017800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017810: 2020 2069 6620 6669 6c65 6e61 6d65 2021     if filename !
-00017820: 3d20 2727 3a0d 0a20 2020 2020 2020 2020  = '':..         
-00017830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017840: 2020 2020 2020 2069 6620 6669 6c65 6e61         if filena
-00017850: 6d65 5b2d 6c65 6e28 6366 672e 6669 6c65  me[-len(cfg.file
-00017860: 7479 7065 5f73 6567 6d65 6e74 6174 696f  type_segmentatio
-00017870: 6e29 3a5d 2021 3d20 6366 672e 6669 6c65  n):] != cfg.file
-00017880: 7479 7065 5f73 6567 6d65 6e74 6174 696f  type_segmentatio
-00017890: 6e3a 0d0a 2020 2020 2020 2020 2020 2020  n:..            
-000178a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000178b0: 2020 2020 2020 2020 6669 6c65 6e61 6d65          filename
-000178c0: 202b 3d20 6366 672e 6669 6c65 7479 7065   += cfg.filetype
-000178d0: 5f73 6567 6d65 6e74 6174 696f 6e0d 0a20  _segmentation.. 
-000178e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000178f0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00017900: 6667 2e73 655f 6163 7469 7665 5f66 7261  fg.se_active_fra
-00017910: 6d65 2e69 6e63 6c75 6465 5f6d 6170 2829  me.include_map()
-00017920: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00017930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017940: 2020 7769 7468 206f 7065 6e28 6669 6c65    with open(file
-00017950: 6e61 6d65 2c20 2777 6227 2920 6173 2070  name, 'wb') as p
-00017960: 6963 6b6c 655f 6669 6c65 3a0d 0a20 2020  ickle_file:..   
-00017970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017990: 2070 6963 6b6c 652e 6475 6d70 2863 6667   pickle.dump(cfg
-000179a0: 2e73 655f 6163 7469 7665 5f66 7261 6d65  .se_active_frame
-000179b0: 2c20 7069 636b 6c65 5f66 696c 6529 0d0a  , pickle_file)..
+000177b0: 6e7d 2229 5d29 0d0a 2020 2020 2020 2020  n}")])..        
+000177c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000177d0: 2020 2020 6966 2066 696c 656e 616d 6520      if filename 
+000177e0: 213d 2027 273a 0d0a 2020 2020 2020 2020  != '':..        
+000177f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017800: 2020 2020 2020 2020 7365 6c66 2e69 6d70          self.imp
+00017810: 6f72 745f 6461 7461 7365 7428 6669 6c65  ort_dataset(file
+00017820: 6e61 6d65 290d 0a20 2020 2020 2020 2020  name)..         
+00017830: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00017840: 7863 6570 7420 4578 6365 7074 696f 6e20  xcept Exception 
+00017850: 6173 2065 3a0d 0a20 2020 2020 2020 2020  as e:..         
+00017860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017870: 2020 2063 6667 2e73 6574 5f65 7272 6f72     cfg.set_error
+00017880: 2865 2c20 2243 6f75 6c64 206e 6f74 2069  (e, "Could not i
+00017890: 6d70 6f72 7420 6461 7461 7365 742c 2073  mport dataset, s
+000178a0: 6565 2064 6574 6169 6c73 2062 656c 6f77  ee details below
+000178b0: 2e22 290d 0a20 2020 2020 2020 2020 2020  .")..           
+000178c0: 2020 2020 2020 2020 2069 6620 696d 6775           if imgu
+000178d0: 692e 6d65 6e75 5f69 7465 6d28 2249 6d70  i.menu_item("Imp
+000178e0: 6f72 7420 6d6f 6465 6c22 295b 305d 3a0d  ort model")[0]:.
+000178f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017900: 2020 2020 2020 2020 2074 7279 3a0d 0a20           try:.. 
+00017910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017920: 2020 2020 2020 2020 2020 2066 696c 656e             filen
+00017930: 616d 6520 3d20 6669 6c65 6469 616c 6f67  ame = filedialog
+00017940: 2e61 736b 6f70 656e 6669 6c65 6e61 6d65  .askopenfilename
+00017950: 2866 696c 6574 7970 6573 3d5b 2822 7363  (filetypes=[("sc
+00017960: 4e6f 6465 7320 6d6f 6465 6c22 2c20 6622  Nodes model", f"
+00017970: 7b63 6667 2e66 696c 6574 7970 655f 7365  {cfg.filetype_se
+00017980: 6d6f 6465 6c7d 2229 5d29 0d0a 2020 2020  model}")])..    
+00017990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000179a0: 2020 2020 2020 2020 6966 2066 696c 656e          if filen
+000179b0: 616d 6520 213d 2027 273a 0d0a 2020 2020  ame != '':..    
 000179c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000179d0: 2020 2020 2020 2020 6578 6365 7074 2045          except E
-000179e0: 7863 6570 7469 6f6e 2061 7320 653a 0d0a  xception as e:..
-000179f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017a00: 2020 2020 2020 2020 2020 2020 6366 672e              cfg.
-00017a10: 7365 745f 6572 726f 7228 652c 2022 436f  set_error(e, "Co
-00017a20: 756c 6420 6e6f 7420 7361 7665 2064 6174  uld not save dat
-00017a30: 6173 6574 2028 696e 636c 7564 696e 6720  aset (including 
-00017a40: 6d61 7029 2c20 7365 6520 6465 7461 696c  map), see detail
-00017a50: 7320 6265 6c6f 772e 2229 0d0a 2020 2020  s below.")..    
-00017a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017a70: 6966 2069 6d67 7569 2e6d 656e 755f 6974  if imgui.menu_it
-00017a80: 656d 2822 5361 7665 206d 6f64 656c 2067  em("Save model g
-00017a90: 726f 7570 2229 5b30 5d3a 0d0a 2020 2020  roup")[0]:..    
-00017aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017ab0: 2020 2020 7472 793a 0d0a 2020 2020 2020      try:..      
-00017ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017ad0: 2020 2020 2020 6669 6c65 6e61 6d65 203d        filename =
-00017ae0: 2066 696c 6564 6961 6c6f 672e 6173 6b73   filedialog.asks
-00017af0: 6176 6561 7366 696c 656e 616d 6528 6669  aveasfilename(fi
-00017b00: 6c65 7479 7065 733d 5b28 2273 634e 6f64  letypes=[("scNod
-00017b10: 6573 206d 6f64 656c 2067 726f 7570 222c  es model group",
-00017b20: 2066 227b 6366 672e 6669 6c65 7479 7065   f"{cfg.filetype
-00017b30: 5f73 656d 6f64 656c 5f67 726f 7570 7d22  _semodel_group}"
-00017b40: 295d 290d 0a20 2020 2020 2020 2020 2020  )])..           
-00017b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017b60: 2069 6620 6669 6c65 6e61 6d65 2021 3d20   if filename != 
-00017b70: 2727 3a0d 0a20 2020 2020 2020 2020 2020  '':..           
-00017b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017b90: 2020 2020 2069 6620 6669 6c65 6e61 6d65       if filename
-00017ba0: 5b2d 6c65 6e28 6366 672e 6669 6c65 7479  [-len(cfg.filety
-00017bb0: 7065 5f73 656d 6f64 656c 5f67 726f 7570  pe_semodel_group
-00017bc0: 293a 5d20 213d 2063 6667 2e66 696c 6574  ):] != cfg.filet
-00017bd0: 7970 655f 7365 6d6f 6465 6c5f 6772 6f75  ype_semodel_grou
-00017be0: 703a 0d0a 2020 2020 2020 2020 2020 2020  p:..            
-00017bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017c00: 2020 2020 2020 2020 6669 6c65 6e61 6d65          filename
-00017c10: 202b 3d20 6366 672e 6669 6c65 7479 7065   += cfg.filetype
-00017c20: 5f73 656d 6f64 656c 5f67 726f 7570 0d0a  _semodel_group..
-00017c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017c50: 5365 676d 656e 7461 7469 6f6e 4564 6974  SegmentationEdit
-00017c60: 6f72 2e73 6176 655f 6d6f 6465 6c5f 6772  or.save_model_gr
-00017c70: 6f75 7028 6669 6c65 6e61 6d65 290d 0a20  oup(filename).. 
-00017c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017c90: 2020 2020 2020 2065 7863 6570 7420 4578         except Ex
-00017ca0: 6365 7074 696f 6e20 6173 2065 3a0d 0a20  ception as e:.. 
-00017cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017cc0: 2020 2020 2020 2020 2020 2063 6667 2e73             cfg.s
-00017cd0: 6574 5f65 7272 6f72 2865 2c20 2243 6f75  et_error(e, "Cou
-00017ce0: 6c64 206e 6f74 2073 6176 6520 6d6f 6465  ld not save mode
-00017cf0: 6c20 6772 6f75 702c 2073 6565 2064 6574  l group, see det
-00017d00: 6169 6c73 2062 656c 6f77 2e22 290d 0a20  ails below.").. 
-00017d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017d20: 2020 2069 6d67 7569 2e73 6570 6172 6174     imgui.separat
-00017d30: 6f72 2829 0d0a 2020 2020 2020 2020 2020  or()..          
-00017d40: 2020 2020 2020 2020 2020 6966 2069 6d67            if img
-00017d50: 7569 2e6d 656e 755f 6974 656d 2822 4578  ui.menu_item("Ex
-00017d60: 706f 7274 2076 616c 6964 6174 696f 6e20  port validation 
-00017d70: 736c 6963 6522 295b 305d 3a0d 0a20 2020  slice")[0]:..   
-00017d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017d90: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
-00017da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017db0: 2020 2020 2020 2066 696c 656e 616d 6520         filename 
-00017dc0: 3d20 6669 6c65 6469 616c 6f67 2e61 736b  = filedialog.ask
-00017dd0: 7361 7665 6173 6669 6c65 6e61 6d65 2866  saveasfilename(f
-00017de0: 696c 6574 7970 6573 3d5b 2822 7469 6666  iletypes=[("tiff
-00017df0: 6669 6c65 222c 2022 2e74 6966 6622 295d  file", ".tiff")]
-00017e00: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00017e10: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00017e20: 6620 6669 6c65 6e61 6d65 2021 3d20 2727  f filename != ''
-00017e30: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00017e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017e50: 2020 2069 6620 6669 6c65 6e61 6d65 5b2d     if filename[-
-00017e60: 353a 5d20 213d 2027 2e74 6966 6627 3a0d  5:] != '.tiff':.
-00017e70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00017e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017e90: 2020 2020 2066 696c 656e 616d 6520 2b3d       filename +=
-00017ea0: 2027 2e74 6966 6627 0d0a 2020 2020 2020   '.tiff'..      
-00017eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017ec0: 2020 2020 2020 2020 2020 7469 6666 6669            tifffi
-00017ed0: 6c65 2e69 6d77 7269 7465 2866 696c 656e  le.imwrite(filen
-00017ee0: 616d 652c 2063 6667 2e73 655f 6163 7469  ame, cfg.se_acti
-00017ef0: 7665 5f66 7261 6d65 2e64 6174 612e 6173  ve_frame.data.as
-00017f00: 7479 7065 286e 702e 666c 6f61 7433 3229  type(np.float32)
-00017f10: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00017f20: 2020 2020 2020 2020 2020 2065 7863 6570             excep
-00017f30: 7420 4578 6365 7074 696f 6e20 6173 2065  t Exception as e
-00017f40: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00017f50: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00017f60: 6667 2e73 6574 5f65 7272 6f72 2865 2c20  fg.set_error(e, 
-00017f70: 2243 6f75 6c64 206e 6f74 2065 7870 6f72  "Could not expor
-00017f80: 7420 6375 7272 656e 7420 736c 6963 6520  t current slice 
-00017f90: 6173 202e 7469 6666 2c20 7365 6520 6465  as .tiff, see de
-00017fa0: 7461 696c 7320 6265 6c6f 772e 2229 0d0a  tails below.")..
-00017fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017fc0: 2020 2020 696d 6775 692e 7365 7061 7261      imgui.separa
-00017fd0: 746f 7228 290d 0a20 2020 2020 2020 2020  tor()..         
-00017fe0: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
-00017ff0: 2e74 6578 7428 6627 7665 7273 696f 6e20  .text(f'version 
-00018000: 7b63 6667 2e76 6572 7369 6f6e 7d27 290d  {cfg.version}').
-00018010: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018020: 2020 2020 2069 6d67 7569 2e65 6e64 5f6d       imgui.end_m
-00018030: 656e 7528 290d 0a0d 0a20 2020 2020 2020  enu()....       
-00018040: 2020 2020 2020 2020 2069 6620 454d 4245           if EMBE
-00018050: 4444 4544 2061 6e64 2069 6d67 7569 2e62  DDED and imgui.b
-00018060: 6567 696e 5f6d 656e 7528 2245 6469 746f  egin_menu("Edito
-00018070: 7222 293a 0d0a 2020 2020 2020 2020 2020  r"):..          
-00018080: 2020 2020 2020 2020 2020 666f 7220 6920            for i 
-00018090: 696e 2072 616e 6765 286c 656e 2873 636e  in range(len(scn
-000180a0: 5f63 6667 2e65 6469 746f 7273 2929 3a0d  _cfg.editors)):.
-000180b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000180c0: 2020 2020 2020 2020 2073 656c 6563 742c           select,
-000180d0: 205f 203d 2069 6d67 7569 2e6d 656e 755f   _ = imgui.menu_
-000180e0: 6974 656d 2873 636e 5f63 6667 2e65 6469  item(scn_cfg.edi
-000180f0: 746f 7273 5b69 5d2c 204e 6f6e 652c 2046  tors[i], None, F
-00018100: 616c 7365 290d 0a20 2020 2020 2020 2020  alse)..         
-00018110: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00018120: 6620 7365 6c65 6374 3a0d 0a20 2020 2020  f select:..     
-00018130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018140: 2020 2020 2020 2073 636e 5f63 6667 2e61         scn_cfg.a
-00018150: 6374 6976 655f 6564 6974 6f72 203d 2069  ctive_editor = i
-00018160: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00018170: 2020 2020 2020 696d 6775 692e 656e 645f        imgui.end_
-00018180: 6d65 6e75 2829 0d0a 2020 2020 2020 2020  menu()..        
-00018190: 2020 2020 2020 2020 6966 2069 6d67 7569          if imgui
-000181a0: 2e62 6567 696e 5f6d 656e 7528 2243 6f6e  .begin_menu("Con
-000181b0: 7472 6f6c 7322 293a 0d0a 2020 2020 2020  trols"):..      
-000181c0: 2020 2020 2020 2020 2020 2020 2020 696d                im
-000181d0: 6775 692e 7465 7874 2863 6667 2e63 6f6e  gui.text(cfg.con
-000181e0: 7472 6f6c 735f 696e 666f 5f74 6578 7429  trols_info_text)
-000181f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00018200: 2020 2020 2020 696d 6775 692e 656e 645f        imgui.end_
-00018210: 6d65 6e75 2829 0d0a 2020 2020 2020 2020  menu()..        
-00018220: 2020 2020 2020 2020 696d 6775 692e 656e          imgui.en
-00018230: 645f 6d61 696e 5f6d 656e 755f 6261 7228  d_main_menu_bar(
-00018240: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
-00018250: 2069 6d67 7569 2e70 6f70 5f73 7479 6c65   imgui.pop_style
-00018260: 5f63 6f6c 6f72 2836 290d 0a20 2020 2020  _color(6)..     
-00018270: 2020 2020 2020 2069 6d67 7569 2e70 6f70         imgui.pop
-00018280: 5f73 7479 6c65 5f76 6172 2831 290d 0a0d  _style_var(1)...
-00018290: 0a20 2020 2020 2020 2064 6566 2073 6c69  .        def sli
-000182a0: 6365 725f 7769 6e64 6f77 2829 3a0d 0a20  cer_window():.. 
-000182b0: 2020 2020 2020 2020 2020 2069 6620 6366             if cf
-000182c0: 672e 7365 5f61 6374 6976 655f 6672 616d  g.se_active_fram
-000182d0: 6520 6973 204e 6f6e 653a 0d0a 2020 2020  e is None:..    
-000182e0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-000182f0: 726e 0d0a 0d0a 2020 2020 2020 2020 2020  rn....          
-00018300: 2020 696d 6775 692e 7075 7368 5f73 7479    imgui.push_sty
-00018310: 6c65 5f76 6172 2869 6d67 7569 2e53 5459  le_var(imgui.STY
-00018320: 4c45 5f47 5241 425f 524f 554e 4449 4e47  LE_GRAB_ROUNDING
-00018330: 2c20 6366 672e 4345 5f57 4944 4745 545f  , cfg.CE_WIDGET_
-00018340: 524f 554e 4449 4e47 290d 0a20 2020 2020  ROUNDING)..     
-00018350: 2020 2020 2020 2069 6d67 7569 2e70 7573         imgui.pus
-00018360: 685f 7374 796c 655f 7661 7228 696d 6775  h_style_var(imgu
-00018370: 692e 5354 594c 455f 4652 414d 455f 524f  i.STYLE_FRAME_RO
-00018380: 554e 4449 4e47 2c20 6366 672e 4345 5f57  UNDING, cfg.CE_W
-00018390: 4944 4745 545f 524f 554e 4449 4e47 290d  IDGET_ROUNDING).
-000183a0: 0a20 2020 2020 2020 2020 2020 2069 6d67  .            img
-000183b0: 7569 2e70 7573 685f 7374 796c 655f 7661  ui.push_style_va
-000183c0: 7228 696d 6775 692e 5354 594c 455f 4652  r(imgui.STYLE_FR
-000183d0: 414d 455f 424f 5244 4552 5349 5a45 2c20  AME_BORDERSIZE, 
-000183e0: 312e 3029 0d0a 0d0a 2020 2020 2020 2020  1.0)....        
-000183f0: 2020 2020 696d 6775 692e 7075 7368 5f73      imgui.push_s
-00018400: 7479 6c65 5f63 6f6c 6f72 2869 6d67 7569  tyle_color(imgui
-00018410: 2e43 4f4c 4f52 5f46 5241 4d45 5f42 4143  .COLOR_FRAME_BAC
-00018420: 4b47 524f 554e 442c 202a 6366 672e 434f  KGROUND, *cfg.CO
-00018430: 4c4f 5552 5f50 414e 454c 5f42 4143 4b47  LOUR_PANEL_BACKG
-00018440: 524f 554e 4429 0d0a 2020 2020 2020 2020  ROUND)..        
-00018450: 2020 2020 696d 6775 692e 7075 7368 5f73      imgui.push_s
-00018460: 7479 6c65 5f63 6f6c 6f72 2869 6d67 7569  tyle_color(imgui
-00018470: 2e43 4f4c 4f52 5f46 5241 4d45 5f42 4143  .COLOR_FRAME_BAC
-00018480: 4b47 524f 554e 445f 484f 5645 5245 442c  KGROUND_HOVERED,
-00018490: 202a 6366 672e 434f 4c4f 5552 5f50 414e   *cfg.COLOUR_PAN
-000184a0: 454c 5f42 4143 4b47 524f 554e 4429 0d0a  EL_BACKGROUND)..
-000184b0: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
-000184c0: 692e 7075 7368 5f73 7479 6c65 5f63 6f6c  i.push_style_col
-000184d0: 6f72 2869 6d67 7569 2e43 4f4c 4f52 5f46  or(imgui.COLOR_F
-000184e0: 5241 4d45 5f42 4143 4b47 524f 554e 445f  RAME_BACKGROUND_
-000184f0: 4143 5449 5645 2c20 2a63 6667 2e43 4f4c  ACTIVE, *cfg.COL
-00018500: 4f55 525f 5041 4e45 4c5f 4241 434b 4752  OUR_PANEL_BACKGR
-00018510: 4f55 4e44 290d 0a20 2020 2020 2020 2020  OUND)..         
-00018520: 2020 2069 6d67 7569 2e70 7573 685f 7374     imgui.push_st
-00018530: 796c 655f 636f 6c6f 7228 696d 6775 692e  yle_color(imgui.
-00018540: 434f 4c4f 525f 534c 4944 4552 5f47 5241  COLOR_SLIDER_GRA
-00018550: 422c 202a 6366 672e 434f 4c4f 5552 5f46  B, *cfg.COLOUR_F
-00018560: 5241 4d45 5f45 5854 5241 5f44 4152 4b5b  RAME_EXTRA_DARK[
-00018570: 303a 335d 2c20 302e 3829 0d0a 2020 2020  0:3], 0.8)..    
-00018580: 2020 2020 2020 2020 696d 6775 692e 7075          imgui.pu
-00018590: 7368 5f73 7479 6c65 5f63 6f6c 6f72 2869  sh_style_color(i
-000185a0: 6d67 7569 2e43 4f4c 4f52 5f53 4c49 4445  mgui.COLOR_SLIDE
-000185b0: 525f 4752 4142 5f41 4354 4956 452c 202a  R_GRAB_ACTIVE, *
-000185c0: 6366 672e 434f 4c4f 5552 5f46 5241 4d45  cfg.COLOUR_FRAME
-000185d0: 5f45 5854 5241 5f44 4152 4b5b 303a 335d  _EXTRA_DARK[0:3]
-000185e0: 2c20 302e 3829 0d0a 2020 2020 2020 2020  , 0.8)..        
-000185f0: 2020 2020 696d 6775 692e 7365 745f 6e65      imgui.set_ne
-00018600: 7874 5f77 696e 646f 775f 7369 7a65 2853  xt_window_size(S
-00018610: 6567 6d65 6e74 6174 696f 6e45 6469 746f  egmentationEdito
-00018620: 722e 534c 4943 4552 5f57 494e 444f 575f  r.SLICER_WINDOW_
-00018630: 5749 4454 482c 2030 2e30 290d 0a20 2020  WIDTH, 0.0)..   
-00018640: 2020 2020 2020 2020 2077 696e 646f 775f           window_
-00018650: 785f 706f 7320 3d20 5365 676d 656e 7461  x_pos = Segmenta
-00018660: 7469 6f6e 4564 6974 6f72 2e4d 4149 4e5f  tionEditor.MAIN_
-00018670: 5749 4e44 4f57 5f57 4944 5448 202b 2028  WINDOW_WIDTH + (
-00018680: 7365 6c66 2e77 696e 646f 772e 7769 6474  self.window.widt
-00018690: 6820 2d20 5365 676d 656e 7461 7469 6f6e  h - Segmentation
-000186a0: 4564 6974 6f72 2e4d 4149 4e5f 5749 4e44  Editor.MAIN_WIND
-000186b0: 4f57 5f57 4944 5448 202d 2053 6567 6d65  OW_WIDTH - Segme
-000186c0: 6e74 6174 696f 6e45 6469 746f 722e 534c  ntationEditor.SL
-000186d0: 4943 4552 5f57 494e 444f 575f 5749 4454  ICER_WINDOW_WIDT
-000186e0: 4829 202f 2032 0d0a 0d0a 2020 2020 2020  H) / 2....      
-000186f0: 2020 2020 2020 6578 706f 7274 5f6d 6f64        export_mod
-00018700: 6520 3d20 7365 6c66 2e65 7870 6f72 745f  e = self.export_
-00018710: 6c69 6d69 745f 7261 6e67 6520 616e 6420  limit_range and 
-00018720: 7365 6c66 2e61 6374 6976 655f 7461 6220  self.active_tab 
-00018730: 3d3d 2022 4578 706f 7274 220d 0a20 2020  == "Export"..   
-00018740: 2020 2020 2020 2020 2076 6572 7469 6361           vertica
-00018750: 6c5f 6f66 6673 6574 203d 2073 656c 662e  l_offset = self.
-00018760: 7769 6e64 6f77 2e68 6569 6768 7420 2d20  window.height - 
-00018770: 5365 676d 656e 7461 7469 6f6e 4564 6974  SegmentationEdit
-00018780: 6f72 2e53 4c49 4345 525f 5749 4e44 4f57  or.SLICER_WINDOW
-00018790: 5f56 4552 5449 4341 4c5f 4f46 4653 4554  _VERTICAL_OFFSET
-000187a0: 202d 2028 3430 2069 6620 6578 706f 7274   - (40 if export
-000187b0: 5f6d 6f64 6520 656c 7365 2032 3329 0d0a  _mode else 23)..
-000187c0: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
-000187d0: 692e 7365 745f 6e65 7874 5f77 696e 646f  i.set_next_windo
-000187e0: 775f 706f 7369 7469 6f6e 2877 696e 646f  w_position(windo
-000187f0: 775f 785f 706f 732c 2076 6572 7469 6361  w_x_pos, vertica
-00018800: 6c5f 6f66 6673 6574 290d 0a20 2020 2020  l_offset)..     
-00018810: 2020 2020 2020 2069 6d67 7569 2e62 6567         imgui.beg
-00018820: 696e 2822 2323 736c 6963 6572 222c 2046  in("##slicer", F
-00018830: 616c 7365 2c20 696d 6775 692e 5749 4e44  alse, imgui.WIND
-00018840: 4f57 5f4e 4f5f 5449 544c 455f 4241 5220  OW_NO_TITLE_BAR 
-00018850: 7c20 696d 6775 692e 5749 4e44 4f57 5f4e  | imgui.WINDOW_N
-00018860: 4f5f 5245 5349 5a45 207c 2069 6d67 7569  O_RESIZE | imgui
-00018870: 2e57 494e 444f 575f 4e4f 5f42 4143 4b47  .WINDOW_NO_BACKG
-00018880: 524f 554e 4429 0d0a 0d0a 2020 2020 2020  ROUND)....      
-00018890: 2020 2020 2020 6377 203d 2069 6d67 7569        cw = imgui
-000188a0: 2e67 6574 5f63 6f6e 7465 6e74 5f72 6567  .get_content_reg
-000188b0: 696f 6e5f 6176 6169 6c61 626c 655f 7769  ion_available_wi
-000188c0: 6474 6828 290d 0a20 2020 2020 2020 2020  dth()..         
-000188d0: 2020 2069 6d67 7569 2e70 7573 685f 6974     imgui.push_it
-000188e0: 656d 5f77 6964 7468 2863 7729 0d0a 0d0a  em_width(cw)....
-000188f0: 2020 2020 2020 2020 2020 2020 6672 616d              fram
-00018900: 6520 3d20 6366 672e 7365 5f61 6374 6976  e = cfg.se_activ
-00018910: 655f 6672 616d 650d 0a20 2020 2020 2020  e_frame..       
-00018920: 2020 2020 2069 6d67 7569 2e70 7573 685f       imgui.push_
-00018930: 7374 796c 655f 636f 6c6f 7228 696d 6775  style_color(imgu
-00018940: 692e 434f 4c4f 525f 4652 414d 455f 4241  i.COLOR_FRAME_BA
-00018950: 434b 4752 4f55 4e44 2c20 2a63 6667 2e43  CKGROUND, *cfg.C
-00018960: 4f4c 4f55 525f 4652 414d 455f 4241 434b  OLOUR_FRAME_BACK
-00018970: 4752 4f55 4e44 5b30 3a33 5d2c 2030 2e37  GROUND[0:3], 0.7
-00018980: 290d 0a20 2020 2020 2020 2020 2020 2069  )..            i
-00018990: 6d67 7569 2e70 7573 685f 7374 796c 655f  mgui.push_style_
-000189a0: 636f 6c6f 7228 696d 6775 692e 434f 4c4f  color(imgui.COLO
-000189b0: 525f 4652 414d 455f 4241 434b 4752 4f55  R_FRAME_BACKGROU
-000189c0: 4e44 5f41 4354 4956 452c 202a 6366 672e  ND_ACTIVE, *cfg.
-000189d0: 434f 4c4f 5552 5f46 5241 4d45 5f42 4143  COLOUR_FRAME_BAC
-000189e0: 4b47 524f 554e 445b 303a 335d 2c20 302e  KGROUND[0:3], 0.
-000189f0: 3729 0d0a 2020 2020 2020 2020 2020 2020  7)..            
-00018a00: 696d 6775 692e 7075 7368 5f73 7479 6c65  imgui.push_style
-00018a10: 5f63 6f6c 6f72 2869 6d67 7569 2e43 4f4c  _color(imgui.COL
-00018a20: 4f52 5f46 5241 4d45 5f42 4143 4b47 524f  OR_FRAME_BACKGRO
-00018a30: 554e 445f 484f 5645 5245 442c 202a 6366  UND_HOVERED, *cf
-00018a40: 672e 434f 4c4f 5552 5f46 5241 4d45 5f42  g.COLOUR_FRAME_B
-00018a50: 4143 4b47 524f 554e 445b 303a 335d 2c20  ACKGROUND[0:3], 
-00018a60: 302e 3729 0d0a 2020 2020 2020 2020 2020  0.7)..          
-00018a70: 2020 696d 6775 692e 7075 7368 5f73 7479    imgui.push_sty
-00018a80: 6c65 5f63 6f6c 6f72 2869 6d67 7569 2e43  le_color(imgui.C
-00018a90: 4f4c 4f52 5f42 4f52 4445 522c 2030 2e33  OLOR_BORDER, 0.3
-00018aa0: 2c20 302e 332c 2030 2e33 2c20 312e 3029  , 0.3, 0.3, 1.0)
-00018ab0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-00018ac0: 6966 2065 7870 6f72 745f 6d6f 6465 3a0d  if export_mode:.
-00018ad0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018ae0: 2069 6d67 7569 2e70 7573 685f 7374 796c   imgui.push_styl
-00018af0: 655f 7661 7228 696d 6775 692e 5354 594c  e_var(imgui.STYL
-00018b00: 455f 4652 414d 455f 5041 4444 494e 472c  E_FRAME_PADDING,
-00018b10: 2028 302c 2030 2929 0d0a 2020 2020 2020   (0, 0))..      
-00018b20: 2020 2020 2020 2020 2020 5f2c 2066 7261            _, fra
-00018b30: 6d65 2e65 7870 6f72 745f 746f 7020 3d20  me.export_top = 
-00018b40: 696d 6775 692e 736c 6964 6572 5f69 6e74  imgui.slider_int
-00018b50: 2822 2323 6578 706f 7274 5f74 6f70 222c  ("##export_top",
-00018b60: 2066 7261 6d65 2e65 7870 6f72 745f 746f   frame.export_to
-00018b70: 702c 2031 2c20 6672 616d 652e 6e5f 736c  p, 1, frame.n_sl
-00018b80: 6963 6573 2c20 666f 726d 6174 3d66 2265  ices, format=f"e
-00018b90: 7870 6f72 7420 7374 6f70 207b 6672 616d  xport stop {fram
-00018ba0: 652e 6578 706f 7274 5f74 6f70 202b 2031  e.export_top + 1
-00018bb0: 7d22 290d 0a20 2020 2020 2020 2020 2020  }")..           
-00018bc0: 2020 2020 2069 6d67 7569 2e70 6f70 5f73       imgui.pop_s
-00018bd0: 7479 6c65 5f76 6172 2831 290d 0a20 2020  tyle_var(1)..   
-00018be0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00018bf0: 5f3a 0d0a 2020 2020 2020 2020 2020 2020  _:..            
-00018c00: 2020 2020 2020 2020 6672 616d 652e 7365          frame.se
-00018c10: 745f 736c 6963 6528 6672 616d 652e 6578  t_slice(frame.ex
-00018c20: 706f 7274 5f74 6f70 290d 0a20 2020 2020  port_top)..     
-00018c30: 2020 2020 2020 2020 2020 2020 2020 2053                 S
-00018c40: 6567 6d65 6e74 6174 696f 6e45 6469 746f  egmentationEdito
-00018c50: 722e 4652 414d 455f 5445 5854 5552 455f  r.FRAME_TEXTURE_
-00018c60: 5245 5155 4952 4553 5f55 5044 4154 4520  REQUIRES_UPDATE 
-00018c70: 7c3d 2054 7275 650d 0a20 2020 2020 2020  |= True..       
-00018c80: 2020 2020 2020 2020 2020 2020 2066 7261               fra
-00018c90: 6d65 2e65 7870 6f72 745f 626f 7474 6f6d  me.export_bottom
-00018ca0: 203d 206d 696e 285b 6672 616d 652e 6578   = min([frame.ex
-00018cb0: 706f 7274 5f62 6f74 746f 6d2c 2066 7261  port_bottom, fra
-00018cc0: 6d65 2e65 7870 6f72 745f 746f 7020 2d20  me.export_top - 
-00018cd0: 315d 290d 0a20 2020 2020 2020 2020 2020  1])..           
-00018ce0: 2020 2020 2020 2020 2066 7261 6d65 2e65           frame.e
-00018cf0: 7870 6f72 745f 626f 7474 6f6d 203d 206d  xport_bottom = m
-00018d00: 6178 285b 6672 616d 652e 6578 706f 7274  ax([frame.export
-00018d10: 5f62 6f74 746f 6d2c 2031 5d29 0d0a 2020  _bottom, 1])..  
-00018d20: 2020 2020 2020 2020 2020 2020 2020 6f72                or
-00018d30: 6967 696e 203d 2069 6d67 7569 2e67 6574  igin = imgui.get
-00018d40: 5f77 696e 646f 775f 706f 7369 7469 6f6e  _window_position
-00018d50: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
-00018d60: 2020 2020 7920 3d20 696d 6775 692e 6765      y = imgui.ge
-00018d70: 745f 6375 7273 6f72 5f73 6372 6565 6e5f  t_cursor_screen_
-00018d80: 706f 7328 295b 315d 0d0a 2020 2020 2020  pos()[1]..      
-00018d90: 2020 2020 2020 2020 2020 6472 6177 5f6c            draw_l
-00018da0: 6973 7420 3d20 696d 6775 692e 6765 745f  ist = imgui.get_
-00018db0: 6261 636b 6772 6f75 6e64 5f64 7261 775f  background_draw_
-00018dc0: 6c69 7374 2829 0d0a 2020 2020 2020 2020  list()..        
-00018dd0: 2020 2020 2020 2020 6c65 6674 203d 2038          left = 8
-00018de0: 202b 206f 7269 6769 6e5b 305d 202b 2063   + origin[0] + c
-00018df0: 7720 2a20 6672 616d 652e 6578 706f 7274  w * frame.export
-00018e00: 5f62 6f74 746f 6d20 2f20 6672 616d 652e  _bottom / frame.
-00018e10: 6e5f 736c 6963 6573 0d0a 2020 2020 2020  n_slices..      
-00018e20: 2020 2020 2020 2020 2020 7269 6768 7420            right 
-00018e30: 3d20 3820 2b20 6f72 6967 696e 5b30 5d20  = 8 + origin[0] 
-00018e40: 2b20 6377 202a 2066 7261 6d65 2e65 7870  + cw * frame.exp
-00018e50: 6f72 745f 746f 7020 2f20 6672 616d 652e  ort_top / frame.
-00018e60: 6e5f 736c 6963 6573 0d0a 2020 2020 2020  n_slices..      
-00018e70: 2020 2020 2020 2020 2020 6472 6177 5f6c            draw_l
-00018e80: 6973 742e 6164 645f 7265 6374 5f66 696c  ist.add_rect_fil
-00018e90: 6c65 6428 6c65 6674 2c20 792c 2072 6967  led(left, y, rig
-00018ea0: 6874 2c20 7920 2b20 3138 2c20 696d 6775  ht, y + 18, imgu
-00018eb0: 692e 6765 745f 636f 6c6f 725f 7533 325f  i.get_color_u32_
-00018ec0: 7267 6261 282a 6366 672e 434f 4c4f 5552  rgba(*cfg.COLOUR
-00018ed0: 5f50 4f53 4954 4956 4529 2c20 3130 290d  _POSITIVE), 10).
-00018ee0: 0a0d 0a20 2020 2020 2020 2020 2020 205f  ...            _
-00018ef0: 2c20 7265 7175 6573 7465 645f 736c 6963  , requested_slic
-00018f00: 6520 3d20 696d 6775 692e 736c 6964 6572  e = imgui.slider
-00018f10: 5f69 6e74 2822 2323 736c 6963 6572 5f73  _int("##slicer_s
-00018f20: 6c69 6465 7222 2c20 6672 616d 652e 6375  lider", frame.cu
-00018f30: 7272 656e 745f 736c 6963 652c 2030 2c20  rrent_slice, 0, 
-00018f40: 6672 616d 652e 6e5f 736c 6963 6573 2c20  frame.n_slices, 
-00018f50: 666f 726d 6174 3d66 2273 6c69 6365 207b  format=f"slice {
-00018f60: 312b 6672 616d 652e 6375 7272 656e 745f  1+frame.current_
-00018f70: 736c 6963 657d 2f7b 6672 616d 652e 6e5f  slice}/{frame.n_
-00018f80: 736c 6963 6573 7d22 290d 0a20 2020 2020  slices}")..     
-00018f90: 2020 2020 2020 2069 6620 5f3a 0d0a 2020         if _:..  
-00018fa0: 2020 2020 2020 2020 2020 2020 2020 6672                fr
-00018fb0: 616d 652e 7365 745f 736c 6963 6528 7265  ame.set_slice(re
-00018fc0: 7175 6573 7465 645f 736c 6963 6529 0d0a  quested_slice)..
-00018fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018fe0: 5365 676d 656e 7461 7469 6f6e 4564 6974  SegmentationEdit
-00018ff0: 6f72 2e46 5241 4d45 5f54 4558 5455 5245  or.FRAME_TEXTURE
-00019000: 5f52 4551 5549 5245 535f 5550 4441 5445  _REQUIRES_UPDATE
-00019010: 207c 3d20 5472 7565 0d0a 2020 2020 2020   |= True..      
-00019020: 2020 2020 2020 2020 2020 5365 676d 656e            Segmen
-00019030: 7461 7469 6f6e 4564 6974 6f72 2e56 4945  tationEditor.VIE
-00019040: 575f 5245 5155 4952 4553 5f55 5044 4154  W_REQUIRES_UPDAT
-00019050: 4520 3d20 5472 7565 0d0a 2020 2020 2020  E = True..      
-00019060: 2020 2020 2020 6966 2065 7870 6f72 745f        if export_
-00019070: 6d6f 6465 3a0d 0a20 2020 2020 2020 2020  mode:..         
-00019080: 2020 2020 2020 2069 6d67 7569 2e70 7573         imgui.pus
-00019090: 685f 7374 796c 655f 7661 7228 696d 6775  h_style_var(imgu
-000190a0: 692e 5354 594c 455f 4652 414d 455f 5041  i.STYLE_FRAME_PA
-000190b0: 4444 494e 472c 2028 302c 2030 2929 0d0a  DDING, (0, 0))..
-000190c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000190d0: 5f2c 2066 7261 6d65 2e65 7870 6f72 745f  _, frame.export_
-000190e0: 626f 7474 6f6d 203d 2069 6d67 7569 2e73  bottom = imgui.s
-000190f0: 6c69 6465 725f 696e 7428 2223 2365 7870  lider_int("##exp
-00019100: 6f72 745f 626f 7474 6f6d 222c 2066 7261  ort_bottom", fra
-00019110: 6d65 2e65 7870 6f72 745f 626f 7474 6f6d  me.export_bottom
-00019120: 2c20 302c 2066 7261 6d65 2e6e 5f73 6c69  , 0, frame.n_sli
-00019130: 6365 7320 2d20 312c 2066 6f72 6d61 743d  ces - 1, format=
-00019140: 6622 6578 706f 7274 2073 7461 7274 207b  f"export start {
-00019150: 6672 616d 652e 6578 706f 7274 5f62 6f74  frame.export_bot
-00019160: 746f 6d20 2b20 317d 2229 0d0a 2020 2020  tom + 1}")..    
-00019170: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
-00019180: 692e 706f 705f 7374 796c 655f 7661 7228  i.pop_style_var(
-00019190: 3129 0d0a 2020 2020 2020 2020 2020 2020  1)..            
-000191a0: 2020 2020 6966 205f 3a0d 0a20 2020 2020      if _:..     
-000191b0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-000191c0: 7261 6d65 2e73 6574 5f73 6c69 6365 2866  rame.set_slice(f
-000191d0: 7261 6d65 2e65 7870 6f72 745f 626f 7474  rame.export_bott
-000191e0: 6f6d 290d 0a20 2020 2020 2020 2020 2020  om)..           
-000191f0: 2020 2020 2020 2020 2053 6567 6d65 6e74           Segment
-00019200: 6174 696f 6e45 6469 746f 722e 4652 414d  ationEditor.FRAM
-00019210: 455f 5445 5854 5552 455f 5245 5155 4952  E_TEXTURE_REQUIR
-00019220: 4553 5f55 5044 4154 4520 7c3d 2054 7275  ES_UPDATE |= Tru
-00019230: 650d 0a20 2020 2020 2020 2020 2020 2020  e..             
-00019240: 2020 2020 2020 2066 7261 6d65 2e65 7870         frame.exp
-00019250: 6f72 745f 746f 7020 3d20 6d61 7828 5b66  ort_top = max([f
-00019260: 7261 6d65 2e65 7870 6f72 745f 746f 702c  rame.export_top,
-00019270: 2066 7261 6d65 2e65 7870 6f72 745f 626f   frame.export_bo
-00019280: 7474 6f6d 202b 2031 5d29 0d0a 2020 2020  ttom + 1])..    
-00019290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000192a0: 6672 616d 652e 6578 706f 7274 5f74 6f70  frame.export_top
-000192b0: 203d 206d 696e 285b 6672 616d 652e 6578   = min([frame.ex
-000192c0: 706f 7274 5f74 6f70 2c20 6672 616d 652e  port_top, frame.
-000192d0: 6e5f 736c 6963 6573 5d29 0d0a 2020 2020  n_slices])..    
-000192e0: 2020 2020 2020 2020 696d 6775 692e 706f          imgui.po
-000192f0: 705f 7374 796c 655f 636f 6c6f 7228 3429  p_style_color(4)
-00019300: 0d0a 2020 2020 2020 2020 2020 2020 696d  ..            im
-00019310: 6775 692e 706f 705f 6974 656d 5f77 6964  gui.pop_item_wid
-00019320: 7468 2829 0d0a 2020 2020 2020 2020 2020  th()..          
-00019330: 2020 696d 6775 692e 656e 6428 290d 0a0d    imgui.end()...
-00019340: 0a20 2020 2020 2020 2020 2020 2069 6d67  .            img
-00019350: 7569 2e70 6f70 5f73 7479 6c65 5f76 6172  ui.pop_style_var
-00019360: 2833 290d 0a20 2020 2020 2020 2020 2020  (3)..           
-00019370: 2069 6d67 7569 2e70 6f70 5f73 7479 6c65   imgui.pop_style
-00019380: 5f63 6f6c 6f72 2835 290d 0a0d 0a20 2020  _color(5)....   
-00019390: 2020 2020 2023 2053 5441 5254 2047 5549       # START GUI
-000193a0: 3a0d 0a20 2020 2020 2020 2023 204d 656e  :..        # Men
-000193b0: 7520 6261 720d 0a20 2020 2020 2020 206d  u bar..        m
-000193c0: 656e 755f 6261 7228 290d 0a0d 0a20 2020  enu_bar()....   
-000193d0: 2020 2020 2023 2052 656e 6465 7220 7468       # Render th
-000193e0: 6520 6375 7272 656e 746c 7920 6163 7469  e currently acti
-000193f0: 7665 2066 7261 6d65 0d0a 0d0a 2020 2020  ve frame....    
-00019400: 2020 2020 6966 2063 6667 2e73 655f 6163      if cfg.se_ac
-00019410: 7469 7665 5f66 7261 6d65 2069 7320 6e6f  tive_frame is no
-00019420: 7420 4e6f 6e65 3a0d 0a20 2020 2020 2020  t None:..       
-00019430: 2020 2020 2069 6620 7365 6c66 2e61 6374       if self.act
-00019440: 6976 655f 7461 6220 213d 2022 5265 6e64  ive_tab != "Rend
-00019450: 6572 223a 0d0a 2020 2020 2020 2020 2020  er":..          
-00019460: 2020 2020 2020 7078 6420 3d20 5365 676d        pxd = Segm
-00019470: 656e 7461 7469 6f6e 4564 6974 6f72 2e72  entationEditor.r
-00019480: 656e 6465 7265 722e 7265 6e64 6572 5f66  enderer.render_f
-00019490: 696c 7465 7265 645f 6672 616d 6528 6366  iltered_frame(cf
-000194a0: 672e 7365 5f61 6374 6976 655f 6672 616d  g.se_active_fram
-000194b0: 652c 2073 656c 662e 6361 6d65 7261 2c20  e, self.camera, 
-000194c0: 7365 6c66 2e77 696e 646f 772c 2073 656c  self.window, sel
-000194d0: 662e 6669 6c74 6572 732c 2065 6d70 6861  f.filters, empha
-000194e0: 7369 7a65 5f72 6f69 3d73 656c 662e 6163  size_roi=self.ac
-000194f0: 7469 7665 5f74 6162 206e 6f74 2069 6e20  tive_tab not in 
-00019500: 5b22 5365 676d 656e 7461 7469 6f6e 222c  ["Segmentation",
-00019510: 2022 5265 6e64 6572 225d 290d 0a20 2020   "Render"])..   
-00019520: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00019530: 7078 6420 6973 206e 6f74 204e 6f6e 653a  pxd is not None:
-00019540: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00019550: 2020 2020 2020 6366 672e 7365 5f61 6374        cfg.se_act
-00019560: 6976 655f 6672 616d 652e 7265 6e64 6572  ive_frame.render
-00019570: 6564 5f64 6174 6120 3d20 7078 640d 0a20  ed_data = pxd.. 
-00019580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019590: 2020 2063 6667 2e73 655f 6163 7469 7665     cfg.se_active
-000195a0: 5f66 7261 6d65 2e75 7064 6174 655f 696d  _frame.update_im
-000195b0: 6167 655f 7465 7874 7572 6528 290d 0a20  age_texture().. 
-000195c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000195d0: 2020 2063 6667 2e73 655f 6163 7469 7665     cfg.se_active
-000195e0: 5f66 7261 6d65 2e63 6f6d 7075 7465 5f68  _frame.compute_h
-000195f0: 6973 746f 6772 616d 2870 7864 290d 0a20  istogram(pxd).. 
-00019600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019610: 2020 2069 6620 6366 672e 7365 5f61 6374     if cfg.se_act
-00019620: 6976 655f 6672 616d 652e 6175 746f 636f  ive_frame.autoco
-00019630: 6e74 7261 7374 3a0d 0a20 2020 2020 2020  ntrast:..       
-00019640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019650: 2063 6667 2e73 655f 6163 7469 7665 5f66   cfg.se_active_f
-00019660: 7261 6d65 2e63 6f6d 7075 7465 5f61 7574  rame.compute_aut
-00019670: 6f63 6f6e 7472 6173 7428 4e6f 6e65 2c20  ocontrast(None, 
-00019680: 7078 6429 0d0a 2020 2020 2020 2020 2020  pxd)..          
-00019690: 2020 2020 2020 5365 676d 656e 7461 7469        Segmentati
-000196a0: 6f6e 4564 6974 6f72 2e46 5241 4d45 5f54  onEditor.FRAME_T
-000196b0: 4558 5455 5245 5f52 4551 5549 5245 535f  EXTURE_REQUIRES_
-000196c0: 5550 4441 5445 203d 2046 616c 7365 0d0a  UPDATE = False..
-000196d0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-000196e0: 656c 662e 6163 7469 7665 5f74 6162 203d  elf.active_tab =
-000196f0: 3d20 2253 6567 6d65 6e74 6174 696f 6e22  = "Segmentation"
-00019700: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00019710: 2020 2053 6567 6d65 6e74 6174 696f 6e45     SegmentationE
-00019720: 6469 746f 722e 7265 6e64 6572 6572 2e72  ditor.renderer.r
-00019730: 656e 6465 725f 7365 676d 656e 7461 7469  ender_segmentati
-00019740: 6f6e 7328 6366 672e 7365 5f61 6374 6976  ons(cfg.se_activ
-00019750: 655f 6672 616d 652c 2073 656c 662e 6361  e_frame, self.ca
-00019760: 6d65 7261 290d 0a0d 0a20 2020 2020 2020  mera)....       
-00019770: 2020 2020 2020 2020 2023 2072 656e 6465           # rende
-00019780: 7220 6472 6177 696e 6720 524f 4920 696e  r drawing ROI in
-00019790: 6469 6361 746f 720d 0a20 2020 2020 2020  dicator..       
-000197a0: 2020 2020 2020 2020 2061 6374 6976 655f           active_
-000197b0: 6665 6174 7572 6520 3d20 6366 672e 7365  feature = cfg.se
-000197c0: 5f61 6374 6976 655f 6672 616d 652e 6163  _active_frame.ac
-000197d0: 7469 7665 5f66 6561 7475 7265 0d0a 2020  tive_feature..  
-000197e0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000197f0: 2061 6374 6976 655f 6665 6174 7572 6520   active_feature 
-00019800: 6973 206e 6f74 204e 6f6e 653a 0d0a 2020  is not None:..  
-00019810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019820: 2020 7261 6469 7573 203d 2061 6374 6976    radius = activ
-00019830: 655f 6665 6174 7572 652e 6272 7573 685f  e_feature.brush_
-00019840: 7369 7a65 202a 2061 6374 6976 655f 6665  size * active_fe
-00019850: 6174 7572 652e 7061 7265 6e74 2e70 6978  ature.parent.pix
-00019860: 656c 5f73 697a 650d 0a20 2020 2020 2020  el_size..       
-00019870: 2020 2020 2020 2020 2020 2020 2077 6f72               wor
-00019880: 6c64 5f70 6f73 6974 696f 6e20 3d20 7365  ld_position = se
-00019890: 6c66 2e63 616d 6572 612e 6375 7273 6f72  lf.camera.cursor
-000198a0: 5f74 6f5f 776f 726c 645f 706f 7369 7469  _to_world_positi
-000198b0: 6f6e 2873 656c 662e 7769 6e64 6f77 2e63  on(self.window.c
-000198c0: 7572 736f 725f 706f 7329 0d0a 2020 2020  ursor_pos)..    
-000198d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000198e0: 6966 206e 6f74 2053 6567 6d65 6e74 6174  if not Segmentat
-000198f0: 696f 6e45 6469 746f 722e 6973 5f73 6869  ionEditor.is_shi
-00019900: 6674 5f64 6f77 6e28 293a 0d0a 2020 2020  ft_down():..    
+000179d0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000179e0: 2e6c 6f61 645f 6d6f 6465 6c28 6669 6c65  .load_model(file
+000179f0: 6e61 6d65 290d 0a20 2020 2020 2020 2020  name)..         
+00017a00: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00017a10: 7863 6570 7420 4578 6365 7074 696f 6e20  xcept Exception 
+00017a20: 6173 2065 3a0d 0a20 2020 2020 2020 2020  as e:..         
+00017a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017a40: 2020 2063 6667 2e73 6574 5f65 7272 6f72     cfg.set_error
+00017a50: 2865 2c20 2243 6f75 6c64 206e 6f74 2069  (e, "Could not i
+00017a60: 6d70 6f72 7420 6d6f 6465 6c2c 2073 6565  mport model, see
+00017a70: 2064 6574 6169 6c73 2062 656c 6f77 2e22   details below."
+00017a80: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00017a90: 2020 2020 2020 2069 6620 696d 6775 692e         if imgui.
+00017aa0: 6d65 6e75 5f69 7465 6d28 2249 6d70 6f72  menu_item("Impor
+00017ab0: 7420 6d6f 6465 6c20 6772 6f75 7022 295b  t model group")[
+00017ac0: 305d 3a0d 0a20 2020 2020 2020 2020 2020  0]:..           
+00017ad0: 2020 2020 2020 2020 2020 2020 2074 7279               try
+00017ae0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00017af0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00017b00: 696c 656e 616d 6520 3d20 6669 6c65 6469  ilename = filedi
+00017b10: 616c 6f67 2e61 736b 6f70 656e 6669 6c65  alog.askopenfile
+00017b20: 6e61 6d65 2866 696c 6574 7970 6573 3d5b  name(filetypes=[
+00017b30: 2822 7363 4e6f 6465 7320 6d6f 6465 6c20  ("scNodes model 
+00017b40: 6772 6f75 7022 2c20 6366 672e 6669 6c65  group", cfg.file
+00017b50: 7479 7065 5f73 656d 6f64 656c 5f67 726f  type_semodel_gro
+00017b60: 7570 295d 290d 0a20 2020 2020 2020 2020  up)])..         
+00017b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017b80: 2020 2069 6620 6669 6c65 6e61 6d65 2021     if filename !
+00017b90: 3d20 2727 3a0d 0a20 2020 2020 2020 2020  = '':..         
+00017ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017bb0: 2020 2020 2020 2053 6567 6d65 6e74 6174         Segmentat
+00017bc0: 696f 6e45 6469 746f 722e 6c6f 6164 5f6d  ionEditor.load_m
+00017bd0: 6f64 656c 5f67 726f 7570 2866 696c 656e  odel_group(filen
+00017be0: 616d 6529 0d0a 2020 2020 2020 2020 2020  ame)..          
+00017bf0: 2020 2020 2020 2020 2020 2020 2020 6578                ex
+00017c00: 6365 7074 2045 7863 6570 7469 6f6e 2061  cept Exception a
+00017c10: 7320 653a 0d0a 2020 2020 2020 2020 2020  s e:..          
+00017c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017c30: 2020 6366 672e 7365 745f 6572 726f 7228    cfg.set_error(
+00017c40: 652c 2022 436f 756c 6420 6e6f 7420 696d  e, "Could not im
+00017c50: 706f 7274 206d 6f64 656c 2067 726f 7570  port model group
+00017c60: 2c20 7365 6520 6465 7461 696c 7320 6265  , see details be
+00017c70: 6c6f 772e 2229 0d0a 2020 2020 2020 2020  low.")..        
+00017c80: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
+00017c90: 692e 7365 7061 7261 746f 7228 290d 0a20  i.separator().. 
+00017ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017cb0: 2020 2069 6620 696d 6775 692e 6d65 6e75     if imgui.menu
+00017cc0: 5f69 7465 6d28 2253 6176 6520 6461 7461  _item("Save data
+00017cd0: 7365 7422 295b 305d 3a0d 0a20 2020 2020  set")[0]:..     
+00017ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017cf0: 2020 2053 6567 6d65 6e74 6174 696f 6e45     SegmentationE
+00017d00: 6469 746f 722e 7361 7665 5f64 6174 6173  ditor.save_datas
+00017d10: 6574 2864 6961 6c6f 673d 4661 6c73 6529  et(dialog=False)
+00017d20: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00017d30: 2020 2020 2020 6966 2069 6d67 7569 2e6d        if imgui.m
+00017d40: 656e 755f 6974 656d 2822 5361 7665 2064  enu_item("Save d
+00017d50: 6174 6173 6574 2061 7320 2229 5b30 5d3a  ataset as ")[0]:
+00017d60: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00017d70: 2020 2020 2020 2020 2020 5365 676d 656e            Segmen
+00017d80: 7461 7469 6f6e 4564 6974 6f72 2e73 6176  tationEditor.sav
+00017d90: 655f 6461 7461 7365 7428 6469 616c 6f67  e_dataset(dialog
+00017da0: 3d54 7275 6529 0d0a 2020 2020 2020 2020  =True)..        
+00017db0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00017dc0: 6d67 7569 2e6d 656e 755f 6974 656d 2822  mgui.menu_item("
+00017dd0: 5361 7665 2064 6174 6173 6574 2077 2e20  Save dataset w. 
+00017de0: 6d61 7022 295b 305d 3a0d 0a20 2020 2020  map")[0]:..     
+00017df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017e00: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
+00017e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017e20: 2020 2020 2066 696c 656e 616d 6520 3d20       filename = 
+00017e30: 6669 6c65 6469 616c 6f67 2e61 736b 7361  filedialog.asksa
+00017e40: 7665 6173 6669 6c65 6e61 6d65 2866 696c  veasfilename(fil
+00017e50: 6574 7970 6573 3d5b 2822 7363 4e6f 6465  etypes=[("scNode
+00017e60: 7320 7365 676d 656e 7461 7469 6f6e 222c  s segmentation",
+00017e70: 2066 227b 6366 672e 6669 6c65 7479 7065   f"{cfg.filetype
+00017e80: 5f73 6567 6d65 6e74 6174 696f 6e7d 2229  _segmentation}")
+00017e90: 5d2c 2069 6e69 7469 616c 6669 6c65 203d  ], initialfile =
+00017ea0: 206f 732e 7061 7468 2e62 6173 656e 616d   os.path.basenam
+00017eb0: 6528 6366 672e 7365 5f61 6374 6976 655f  e(cfg.se_active_
+00017ec0: 6672 616d 652e 7061 7468 295b 3a2d 345d  frame.path)[:-4]
+00017ed0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00017ee0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00017ef0: 6620 6669 6c65 6e61 6d65 2021 3d20 2727  f filename != ''
+00017f00: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00017f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017f20: 2020 2069 6620 6669 6c65 6e61 6d65 5b2d     if filename[-
+00017f30: 6c65 6e28 6366 672e 6669 6c65 7479 7065  len(cfg.filetype
+00017f40: 5f73 6567 6d65 6e74 6174 696f 6e29 3a5d  _segmentation):]
+00017f50: 2021 3d20 6366 672e 6669 6c65 7479 7065   != cfg.filetype
+00017f60: 5f73 6567 6d65 6e74 6174 696f 6e3a 0d0a  _segmentation:..
+00017f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017f90: 2020 2020 6669 6c65 6e61 6d65 202b 3d20      filename += 
+00017fa0: 6366 672e 6669 6c65 7479 7065 5f73 6567  cfg.filetype_seg
+00017fb0: 6d65 6e74 6174 696f 6e0d 0a20 2020 2020  mentation..     
+00017fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017fd0: 2020 2020 2020 2020 2020 2063 6667 2e73             cfg.s
+00017fe0: 655f 6163 7469 7665 5f66 7261 6d65 2e69  e_active_frame.i
+00017ff0: 6e63 6c75 6465 5f6d 6170 2829 0d0a 2020  nclude_map()..  
+00018000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018010: 2020 2020 2020 2020 2020 2020 2020 7769                wi
+00018020: 7468 206f 7065 6e28 6669 6c65 6e61 6d65  th open(filename
+00018030: 2c20 2777 6227 2920 6173 2070 6963 6b6c  , 'wb') as pickl
+00018040: 655f 6669 6c65 3a0d 0a20 2020 2020 2020  e_file:..       
+00018050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018060: 2020 2020 2020 2020 2020 2020 2070 6963               pic
+00018070: 6b6c 652e 6475 6d70 2863 6667 2e73 655f  kle.dump(cfg.se_
+00018080: 6163 7469 7665 5f66 7261 6d65 2c20 7069  active_frame, pi
+00018090: 636b 6c65 5f66 696c 6529 0d0a 2020 2020  ckle_file)..    
+000180a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000180b0: 2020 2020 6578 6365 7074 2045 7863 6570      except Excep
+000180c0: 7469 6f6e 2061 7320 653a 0d0a 2020 2020  tion as e:..    
+000180d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000180e0: 2020 2020 2020 2020 6366 672e 7365 745f          cfg.set_
+000180f0: 6572 726f 7228 652c 2022 436f 756c 6420  error(e, "Could 
+00018100: 6e6f 7420 7361 7665 2064 6174 6173 6574  not save dataset
+00018110: 2028 696e 636c 7564 696e 6720 6d61 7029   (including map)
+00018120: 2c20 7365 6520 6465 7461 696c 7320 6265  , see details be
+00018130: 6c6f 772e 2229 0d0a 2020 2020 2020 2020  low.")..        
+00018140: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00018150: 6d67 7569 2e6d 656e 755f 6974 656d 2822  mgui.menu_item("
+00018160: 5361 7665 206d 6f64 656c 2067 726f 7570  Save model group
+00018170: 2229 5b30 5d3a 0d0a 2020 2020 2020 2020  ")[0]:..        
+00018180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018190: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
+000181a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000181b0: 2020 6669 6c65 6e61 6d65 203d 2066 696c    filename = fil
+000181c0: 6564 6961 6c6f 672e 6173 6b73 6176 6561  edialog.asksavea
+000181d0: 7366 696c 656e 616d 6528 6669 6c65 7479  sfilename(filety
+000181e0: 7065 733d 5b28 2273 634e 6f64 6573 206d  pes=[("scNodes m
+000181f0: 6f64 656c 2067 726f 7570 222c 2066 227b  odel group", f"{
+00018200: 6366 672e 6669 6c65 7479 7065 5f73 656d  cfg.filetype_sem
+00018210: 6f64 656c 5f67 726f 7570 7d22 295d 290d  odel_group}")]).
+00018220: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018230: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00018240: 6669 6c65 6e61 6d65 2021 3d20 2727 3a0d  filename != '':.
+00018250: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018270: 2069 6620 6669 6c65 6e61 6d65 5b2d 6c65   if filename[-le
+00018280: 6e28 6366 672e 6669 6c65 7479 7065 5f73  n(cfg.filetype_s
+00018290: 656d 6f64 656c 5f67 726f 7570 293a 5d20  emodel_group):] 
+000182a0: 213d 2063 6667 2e66 696c 6574 7970 655f  != cfg.filetype_
+000182b0: 7365 6d6f 6465 6c5f 6772 6f75 703a 0d0a  semodel_group:..
+000182c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000182d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000182e0: 2020 2020 6669 6c65 6e61 6d65 202b 3d20      filename += 
+000182f0: 6366 672e 6669 6c65 7479 7065 5f73 656d  cfg.filetype_sem
+00018300: 6f64 656c 5f67 726f 7570 0d0a 2020 2020  odel_group..    
+00018310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018320: 2020 2020 2020 2020 2020 2020 5365 676d              Segm
+00018330: 656e 7461 7469 6f6e 4564 6974 6f72 2e73  entationEditor.s
+00018340: 6176 655f 6d6f 6465 6c5f 6772 6f75 7028  ave_model_group(
+00018350: 6669 6c65 6e61 6d65 290d 0a20 2020 2020  filename)..     
+00018360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018370: 2020 2065 7863 6570 7420 4578 6365 7074     except Except
+00018380: 696f 6e20 6173 2065 3a0d 0a20 2020 2020  ion as e:..     
+00018390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000183a0: 2020 2020 2020 2063 6667 2e73 6574 5f65         cfg.set_e
+000183b0: 7272 6f72 2865 2c20 2243 6f75 6c64 206e  rror(e, "Could n
+000183c0: 6f74 2073 6176 6520 6d6f 6465 6c20 6772  ot save model gr
+000183d0: 6f75 702c 2073 6565 2064 6574 6169 6c73  oup, see details
+000183e0: 2062 656c 6f77 2e22 290d 0a20 2020 2020   below.")..     
+000183f0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00018400: 6d67 7569 2e73 6570 6172 6174 6f72 2829  mgui.separator()
+00018410: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00018420: 2020 2020 2020 6966 2069 6d67 7569 2e6d        if imgui.m
+00018430: 656e 755f 6974 656d 2822 4578 706f 7274  enu_item("Export
+00018440: 2076 616c 6964 6174 696f 6e20 736c 6963   validation slic
+00018450: 6522 295b 305d 3a0d 0a20 2020 2020 2020  e")[0]:..       
+00018460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018470: 2074 7279 3a0d 0a20 2020 2020 2020 2020   try:..         
+00018480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018490: 2020 2066 696c 656e 616d 6520 3d20 6669     filename = fi
+000184a0: 6c65 6469 616c 6f67 2e61 736b 7361 7665  ledialog.asksave
+000184b0: 6173 6669 6c65 6e61 6d65 2866 696c 6574  asfilename(filet
+000184c0: 7970 6573 3d5b 2822 7469 6666 6669 6c65  ypes=[("tifffile
+000184d0: 222c 2022 2e74 6966 6622 295d 290d 0a20  ", ".tiff")]).. 
+000184e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000184f0: 2020 2020 2020 2020 2020 2069 6620 6669             if fi
+00018500: 6c65 6e61 6d65 2021 3d20 2727 3a0d 0a20  lename != '':.. 
+00018510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018520: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00018530: 6620 6669 6c65 6e61 6d65 5b2d 353a 5d20  f filename[-5:] 
+00018540: 213d 2027 2e74 6966 6627 3a0d 0a20 2020  != '.tiff':..   
+00018550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018570: 2066 696c 656e 616d 6520 2b3d 2027 2e74   filename += '.t
+00018580: 6966 6627 0d0a 2020 2020 2020 2020 2020  iff'..          
+00018590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000185a0: 2020 2020 2020 7469 6666 6669 6c65 2e69        tifffile.i
+000185b0: 6d77 7269 7465 2866 696c 656e 616d 652c  mwrite(filename,
+000185c0: 2063 6667 2e73 655f 6163 7469 7665 5f66   cfg.se_active_f
+000185d0: 7261 6d65 2e64 6174 612e 6173 7479 7065  rame.data.astype
+000185e0: 286e 702e 666c 6f61 7433 3229 290d 0a20  (np.float32)).. 
+000185f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018600: 2020 2020 2020 2065 7863 6570 7420 4578         except Ex
+00018610: 6365 7074 696f 6e20 6173 2065 3a0d 0a20  ception as e:.. 
+00018620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018630: 2020 2020 2020 2020 2020 2063 6667 2e73             cfg.s
+00018640: 6574 5f65 7272 6f72 2865 2c20 2243 6f75  et_error(e, "Cou
+00018650: 6c64 206e 6f74 2065 7870 6f72 7420 6375  ld not export cu
+00018660: 7272 656e 7420 736c 6963 6520 6173 202e  rrent slice as .
+00018670: 7469 6666 2c20 7365 6520 6465 7461 696c  tiff, see detail
+00018680: 7320 6265 6c6f 772e 2229 0d0a 2020 2020  s below.")..    
+00018690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000186a0: 696d 6775 692e 7365 7061 7261 746f 7228  imgui.separator(
+000186b0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+000186c0: 2020 2020 2020 2069 6d67 7569 2e74 6578         imgui.tex
+000186d0: 7428 6627 7665 7273 696f 6e20 7b63 6667  t(f'version {cfg
+000186e0: 2e76 6572 7369 6f6e 7d27 290d 0a20 2020  .version}')..   
+000186f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018700: 2069 6d67 7569 2e65 6e64 5f6d 656e 7528   imgui.end_menu(
+00018710: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
+00018720: 2020 2020 2069 6620 454d 4245 4444 4544       if EMBEDDED
+00018730: 2061 6e64 2069 6d67 7569 2e62 6567 696e   and imgui.begin
+00018740: 5f6d 656e 7528 2245 6469 746f 7222 293a  _menu("Editor"):
+00018750: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00018760: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
+00018770: 616e 6765 286c 656e 2873 636e 5f63 6667  ange(len(scn_cfg
+00018780: 2e65 6469 746f 7273 2929 3a0d 0a20 2020  .editors)):..   
+00018790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000187a0: 2020 2020 2073 656c 6563 742c 205f 203d       select, _ =
+000187b0: 2069 6d67 7569 2e6d 656e 755f 6974 656d   imgui.menu_item
+000187c0: 2873 636e 5f63 6667 2e65 6469 746f 7273  (scn_cfg.editors
+000187d0: 5b69 5d2c 204e 6f6e 652c 2046 616c 7365  [i], None, False
+000187e0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+000187f0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+00018800: 6c65 6374 3a0d 0a20 2020 2020 2020 2020  lect:..         
+00018810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018820: 2020 2073 636e 5f63 6667 2e61 6374 6976     scn_cfg.activ
+00018830: 655f 6564 6974 6f72 203d 2069 0d0a 2020  e_editor = i..  
+00018840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018850: 2020 696d 6775 692e 656e 645f 6d65 6e75    imgui.end_menu
+00018860: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
+00018870: 2020 2020 6966 2069 6d67 7569 2e62 6567      if imgui.beg
+00018880: 696e 5f6d 656e 7528 2243 6f6e 7472 6f6c  in_menu("Control
+00018890: 7322 293a 0d0a 2020 2020 2020 2020 2020  s"):..          
+000188a0: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
+000188b0: 7465 7874 2863 6667 2e63 6f6e 7472 6f6c  text(cfg.control
+000188c0: 735f 696e 666f 5f74 6578 7429 0d0a 2020  s_info_text)..  
+000188d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000188e0: 2020 696d 6775 692e 656e 645f 6d65 6e75    imgui.end_menu
+000188f0: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
+00018900: 2020 2020 696d 6775 692e 656e 645f 6d61      imgui.end_ma
+00018910: 696e 5f6d 656e 755f 6261 7228 290d 0a0d  in_menu_bar()...
+00018920: 0a20 2020 2020 2020 2020 2020 2069 6d67  .            img
+00018930: 7569 2e70 6f70 5f73 7479 6c65 5f63 6f6c  ui.pop_style_col
+00018940: 6f72 2836 290d 0a20 2020 2020 2020 2020  or(6)..         
+00018950: 2020 2069 6d67 7569 2e70 6f70 5f73 7479     imgui.pop_sty
+00018960: 6c65 5f76 6172 2831 290d 0a0d 0a20 2020  le_var(1)....   
+00018970: 2020 2020 2064 6566 2073 6c69 6365 725f       def slicer_
+00018980: 7769 6e64 6f77 2829 3a0d 0a20 2020 2020  window():..     
+00018990: 2020 2020 2020 2069 6620 6366 672e 7365         if cfg.se
+000189a0: 5f61 6374 6976 655f 6672 616d 6520 6973  _active_frame is
+000189b0: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
+000189c0: 2020 2020 2020 2020 7265 7475 726e 0d0a          return..
+000189d0: 0d0a 2020 2020 2020 2020 2020 2020 696d  ..            im
+000189e0: 6775 692e 7075 7368 5f73 7479 6c65 5f76  gui.push_style_v
+000189f0: 6172 2869 6d67 7569 2e53 5459 4c45 5f47  ar(imgui.STYLE_G
+00018a00: 5241 425f 524f 554e 4449 4e47 2c20 6366  RAB_ROUNDING, cf
+00018a10: 672e 4345 5f57 4944 4745 545f 524f 554e  g.CE_WIDGET_ROUN
+00018a20: 4449 4e47 290d 0a20 2020 2020 2020 2020  DING)..         
+00018a30: 2020 2069 6d67 7569 2e70 7573 685f 7374     imgui.push_st
+00018a40: 796c 655f 7661 7228 696d 6775 692e 5354  yle_var(imgui.ST
+00018a50: 594c 455f 4652 414d 455f 524f 554e 4449  YLE_FRAME_ROUNDI
+00018a60: 4e47 2c20 6366 672e 4345 5f57 4944 4745  NG, cfg.CE_WIDGE
+00018a70: 545f 524f 554e 4449 4e47 290d 0a20 2020  T_ROUNDING)..   
+00018a80: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
+00018a90: 7573 685f 7374 796c 655f 7661 7228 696d  ush_style_var(im
+00018aa0: 6775 692e 5354 594c 455f 4652 414d 455f  gui.STYLE_FRAME_
+00018ab0: 424f 5244 4552 5349 5a45 2c20 312e 3029  BORDERSIZE, 1.0)
+00018ac0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+00018ad0: 696d 6775 692e 7075 7368 5f73 7479 6c65  imgui.push_style
+00018ae0: 5f63 6f6c 6f72 2869 6d67 7569 2e43 4f4c  _color(imgui.COL
+00018af0: 4f52 5f46 5241 4d45 5f42 4143 4b47 524f  OR_FRAME_BACKGRO
+00018b00: 554e 442c 202a 6366 672e 434f 4c4f 5552  UND, *cfg.COLOUR
+00018b10: 5f50 414e 454c 5f42 4143 4b47 524f 554e  _PANEL_BACKGROUN
+00018b20: 4429 0d0a 2020 2020 2020 2020 2020 2020  D)..            
+00018b30: 696d 6775 692e 7075 7368 5f73 7479 6c65  imgui.push_style
+00018b40: 5f63 6f6c 6f72 2869 6d67 7569 2e43 4f4c  _color(imgui.COL
+00018b50: 4f52 5f46 5241 4d45 5f42 4143 4b47 524f  OR_FRAME_BACKGRO
+00018b60: 554e 445f 484f 5645 5245 442c 202a 6366  UND_HOVERED, *cf
+00018b70: 672e 434f 4c4f 5552 5f50 414e 454c 5f42  g.COLOUR_PANEL_B
+00018b80: 4143 4b47 524f 554e 4429 0d0a 2020 2020  ACKGROUND)..    
+00018b90: 2020 2020 2020 2020 696d 6775 692e 7075          imgui.pu
+00018ba0: 7368 5f73 7479 6c65 5f63 6f6c 6f72 2869  sh_style_color(i
+00018bb0: 6d67 7569 2e43 4f4c 4f52 5f46 5241 4d45  mgui.COLOR_FRAME
+00018bc0: 5f42 4143 4b47 524f 554e 445f 4143 5449  _BACKGROUND_ACTI
+00018bd0: 5645 2c20 2a63 6667 2e43 4f4c 4f55 525f  VE, *cfg.COLOUR_
+00018be0: 5041 4e45 4c5f 4241 434b 4752 4f55 4e44  PANEL_BACKGROUND
+00018bf0: 290d 0a20 2020 2020 2020 2020 2020 2069  )..            i
+00018c00: 6d67 7569 2e70 7573 685f 7374 796c 655f  mgui.push_style_
+00018c10: 636f 6c6f 7228 696d 6775 692e 434f 4c4f  color(imgui.COLO
+00018c20: 525f 534c 4944 4552 5f47 5241 422c 202a  R_SLIDER_GRAB, *
+00018c30: 6366 672e 434f 4c4f 5552 5f46 5241 4d45  cfg.COLOUR_FRAME
+00018c40: 5f45 5854 5241 5f44 4152 4b5b 303a 335d  _EXTRA_DARK[0:3]
+00018c50: 2c20 302e 3829 0d0a 2020 2020 2020 2020  , 0.8)..        
+00018c60: 2020 2020 696d 6775 692e 7075 7368 5f73      imgui.push_s
+00018c70: 7479 6c65 5f63 6f6c 6f72 2869 6d67 7569  tyle_color(imgui
+00018c80: 2e43 4f4c 4f52 5f53 4c49 4445 525f 4752  .COLOR_SLIDER_GR
+00018c90: 4142 5f41 4354 4956 452c 202a 6366 672e  AB_ACTIVE, *cfg.
+00018ca0: 434f 4c4f 5552 5f46 5241 4d45 5f45 5854  COLOUR_FRAME_EXT
+00018cb0: 5241 5f44 4152 4b5b 303a 335d 2c20 302e  RA_DARK[0:3], 0.
+00018cc0: 3829 0d0a 2020 2020 2020 2020 2020 2020  8)..            
+00018cd0: 696d 6775 692e 7365 745f 6e65 7874 5f77  imgui.set_next_w
+00018ce0: 696e 646f 775f 7369 7a65 2853 6567 6d65  indow_size(Segme
+00018cf0: 6e74 6174 696f 6e45 6469 746f 722e 534c  ntationEditor.SL
+00018d00: 4943 4552 5f57 494e 444f 575f 5749 4454  ICER_WINDOW_WIDT
+00018d10: 482c 2030 2e30 290d 0a20 2020 2020 2020  H, 0.0)..       
+00018d20: 2020 2020 2077 696e 646f 775f 785f 706f       window_x_po
+00018d30: 7320 3d20 5365 676d 656e 7461 7469 6f6e  s = Segmentation
+00018d40: 4564 6974 6f72 2e4d 4149 4e5f 5749 4e44  Editor.MAIN_WIND
+00018d50: 4f57 5f57 4944 5448 202b 2028 7365 6c66  OW_WIDTH + (self
+00018d60: 2e77 696e 646f 772e 7769 6474 6820 2d20  .window.width - 
+00018d70: 5365 676d 656e 7461 7469 6f6e 4564 6974  SegmentationEdit
+00018d80: 6f72 2e4d 4149 4e5f 5749 4e44 4f57 5f57  or.MAIN_WINDOW_W
+00018d90: 4944 5448 202d 2053 6567 6d65 6e74 6174  IDTH - Segmentat
+00018da0: 696f 6e45 6469 746f 722e 534c 4943 4552  ionEditor.SLICER
+00018db0: 5f57 494e 444f 575f 5749 4454 4829 202f  _WINDOW_WIDTH) /
+00018dc0: 2032 0d0a 0d0a 2020 2020 2020 2020 2020   2....          
+00018dd0: 2020 6578 706f 7274 5f6d 6f64 6520 3d20    export_mode = 
+00018de0: 7365 6c66 2e65 7870 6f72 745f 6c69 6d69  self.export_limi
+00018df0: 745f 7261 6e67 6520 616e 6420 7365 6c66  t_range and self
+00018e00: 2e61 6374 6976 655f 7461 6220 3d3d 2022  .active_tab == "
+00018e10: 4578 706f 7274 220d 0a20 2020 2020 2020  Export"..       
+00018e20: 2020 2020 2076 6572 7469 6361 6c5f 6f66       vertical_of
+00018e30: 6673 6574 203d 2073 656c 662e 7769 6e64  fset = self.wind
+00018e40: 6f77 2e68 6569 6768 7420 2d20 5365 676d  ow.height - Segm
+00018e50: 656e 7461 7469 6f6e 4564 6974 6f72 2e53  entationEditor.S
+00018e60: 4c49 4345 525f 5749 4e44 4f57 5f56 4552  LICER_WINDOW_VER
+00018e70: 5449 4341 4c5f 4f46 4653 4554 202d 2028  TICAL_OFFSET - (
+00018e80: 3430 2069 6620 6578 706f 7274 5f6d 6f64  40 if export_mod
+00018e90: 6520 656c 7365 2032 3329 0d0a 2020 2020  e else 23)..    
+00018ea0: 2020 2020 2020 2020 696d 6775 692e 7365          imgui.se
+00018eb0: 745f 6e65 7874 5f77 696e 646f 775f 706f  t_next_window_po
+00018ec0: 7369 7469 6f6e 2877 696e 646f 775f 785f  sition(window_x_
+00018ed0: 706f 732c 2076 6572 7469 6361 6c5f 6f66  pos, vertical_of
+00018ee0: 6673 6574 290d 0a20 2020 2020 2020 2020  fset)..         
+00018ef0: 2020 2069 6d67 7569 2e62 6567 696e 2822     imgui.begin("
+00018f00: 2323 736c 6963 6572 222c 2046 616c 7365  ##slicer", False
+00018f10: 2c20 696d 6775 692e 5749 4e44 4f57 5f4e  , imgui.WINDOW_N
+00018f20: 4f5f 5449 544c 455f 4241 5220 7c20 696d  O_TITLE_BAR | im
+00018f30: 6775 692e 5749 4e44 4f57 5f4e 4f5f 5245  gui.WINDOW_NO_RE
+00018f40: 5349 5a45 207c 2069 6d67 7569 2e57 494e  SIZE | imgui.WIN
+00018f50: 444f 575f 4e4f 5f42 4143 4b47 524f 554e  DOW_NO_BACKGROUN
+00018f60: 4429 0d0a 0d0a 2020 2020 2020 2020 2020  D)....          
+00018f70: 2020 6377 203d 2069 6d67 7569 2e67 6574    cw = imgui.get
+00018f80: 5f63 6f6e 7465 6e74 5f72 6567 696f 6e5f  _content_region_
+00018f90: 6176 6169 6c61 626c 655f 7769 6474 6828  available_width(
+00018fa0: 290d 0a20 2020 2020 2020 2020 2020 2069  )..            i
+00018fb0: 6d67 7569 2e70 7573 685f 6974 656d 5f77  mgui.push_item_w
+00018fc0: 6964 7468 2863 7729 0d0a 0d0a 2020 2020  idth(cw)....    
+00018fd0: 2020 2020 2020 2020 6672 616d 6520 3d20          frame = 
+00018fe0: 6366 672e 7365 5f61 6374 6976 655f 6672  cfg.se_active_fr
+00018ff0: 616d 650d 0a20 2020 2020 2020 2020 2020  ame..           
+00019000: 2069 6d67 7569 2e70 7573 685f 7374 796c   imgui.push_styl
+00019010: 655f 636f 6c6f 7228 696d 6775 692e 434f  e_color(imgui.CO
+00019020: 4c4f 525f 4652 414d 455f 4241 434b 4752  LOR_FRAME_BACKGR
+00019030: 4f55 4e44 2c20 2a63 6667 2e43 4f4c 4f55  OUND, *cfg.COLOU
+00019040: 525f 4652 414d 455f 4241 434b 4752 4f55  R_FRAME_BACKGROU
+00019050: 4e44 5b30 3a33 5d2c 2030 2e37 290d 0a20  ND[0:3], 0.7).. 
+00019060: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
+00019070: 2e70 7573 685f 7374 796c 655f 636f 6c6f  .push_style_colo
+00019080: 7228 696d 6775 692e 434f 4c4f 525f 4652  r(imgui.COLOR_FR
+00019090: 414d 455f 4241 434b 4752 4f55 4e44 5f41  AME_BACKGROUND_A
+000190a0: 4354 4956 452c 202a 6366 672e 434f 4c4f  CTIVE, *cfg.COLO
+000190b0: 5552 5f46 5241 4d45 5f42 4143 4b47 524f  UR_FRAME_BACKGRO
+000190c0: 554e 445b 303a 335d 2c20 302e 3729 0d0a  UND[0:3], 0.7)..
+000190d0: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
+000190e0: 692e 7075 7368 5f73 7479 6c65 5f63 6f6c  i.push_style_col
+000190f0: 6f72 2869 6d67 7569 2e43 4f4c 4f52 5f46  or(imgui.COLOR_F
+00019100: 5241 4d45 5f42 4143 4b47 524f 554e 445f  RAME_BACKGROUND_
+00019110: 484f 5645 5245 442c 202a 6366 672e 434f  HOVERED, *cfg.CO
+00019120: 4c4f 5552 5f46 5241 4d45 5f42 4143 4b47  LOUR_FRAME_BACKG
+00019130: 524f 554e 445b 303a 335d 2c20 302e 3729  ROUND[0:3], 0.7)
+00019140: 0d0a 2020 2020 2020 2020 2020 2020 696d  ..            im
+00019150: 6775 692e 7075 7368 5f73 7479 6c65 5f63  gui.push_style_c
+00019160: 6f6c 6f72 2869 6d67 7569 2e43 4f4c 4f52  olor(imgui.COLOR
+00019170: 5f42 4f52 4445 522c 2030 2e33 2c20 302e  _BORDER, 0.3, 0.
+00019180: 332c 2030 2e33 2c20 312e 3029 0d0a 0d0a  3, 0.3, 1.0)....
+00019190: 2020 2020 2020 2020 2020 2020 6966 2065              if e
+000191a0: 7870 6f72 745f 6d6f 6465 3a0d 0a20 2020  xport_mode:..   
+000191b0: 2020 2020 2020 2020 2020 2020 2069 6d67               img
+000191c0: 7569 2e70 7573 685f 7374 796c 655f 7661  ui.push_style_va
+000191d0: 7228 696d 6775 692e 5354 594c 455f 4652  r(imgui.STYLE_FR
+000191e0: 414d 455f 5041 4444 494e 472c 2028 302c  AME_PADDING, (0,
+000191f0: 2030 2929 0d0a 2020 2020 2020 2020 2020   0))..          
+00019200: 2020 2020 2020 5f2c 2066 7261 6d65 2e65        _, frame.e
+00019210: 7870 6f72 745f 746f 7020 3d20 696d 6775  xport_top = imgu
+00019220: 692e 736c 6964 6572 5f69 6e74 2822 2323  i.slider_int("##
+00019230: 6578 706f 7274 5f74 6f70 222c 2066 7261  export_top", fra
+00019240: 6d65 2e65 7870 6f72 745f 746f 702c 2031  me.export_top, 1
+00019250: 2c20 6672 616d 652e 6e5f 736c 6963 6573  , frame.n_slices
+00019260: 2c20 666f 726d 6174 3d66 2265 7870 6f72  , format=f"expor
+00019270: 7420 7374 6f70 207b 6672 616d 652e 6578  t stop {frame.ex
+00019280: 706f 7274 5f74 6f70 202b 2031 7d22 290d  port_top + 1}").
+00019290: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000192a0: 2069 6d67 7569 2e70 6f70 5f73 7479 6c65   imgui.pop_style
+000192b0: 5f76 6172 2831 290d 0a20 2020 2020 2020  _var(1)..       
+000192c0: 2020 2020 2020 2020 2069 6620 5f3a 0d0a           if _:..
+000192d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000192e0: 2020 2020 6672 616d 652e 7365 745f 736c      frame.set_sl
+000192f0: 6963 6528 6672 616d 652e 6578 706f 7274  ice(frame.export
+00019300: 5f74 6f70 290d 0a20 2020 2020 2020 2020  _top)..         
+00019310: 2020 2020 2020 2020 2020 2053 6567 6d65             Segme
+00019320: 6e74 6174 696f 6e45 6469 746f 722e 4652  ntationEditor.FR
+00019330: 414d 455f 5445 5854 5552 455f 5245 5155  AME_TEXTURE_REQU
+00019340: 4952 4553 5f55 5044 4154 4520 7c3d 2054  IRES_UPDATE |= T
+00019350: 7275 650d 0a20 2020 2020 2020 2020 2020  rue..           
+00019360: 2020 2020 2020 2020 2066 7261 6d65 2e65           frame.e
+00019370: 7870 6f72 745f 626f 7474 6f6d 203d 206d  xport_bottom = m
+00019380: 696e 285b 6672 616d 652e 6578 706f 7274  in([frame.export
+00019390: 5f62 6f74 746f 6d2c 2066 7261 6d65 2e65  _bottom, frame.e
+000193a0: 7870 6f72 745f 746f 7020 2d20 315d 290d  xport_top - 1]).
+000193b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000193c0: 2020 2020 2066 7261 6d65 2e65 7870 6f72       frame.expor
+000193d0: 745f 626f 7474 6f6d 203d 206d 6178 285b  t_bottom = max([
+000193e0: 6672 616d 652e 6578 706f 7274 5f62 6f74  frame.export_bot
+000193f0: 746f 6d2c 2031 5d29 0d0a 2020 2020 2020  tom, 1])..      
+00019400: 2020 2020 2020 2020 2020 6f72 6967 696e            origin
+00019410: 203d 2069 6d67 7569 2e67 6574 5f77 696e   = imgui.get_win
+00019420: 646f 775f 706f 7369 7469 6f6e 2829 0d0a  dow_position()..
+00019430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019440: 7920 3d20 696d 6775 692e 6765 745f 6375  y = imgui.get_cu
+00019450: 7273 6f72 5f73 6372 6565 6e5f 706f 7328  rsor_screen_pos(
+00019460: 295b 315d 0d0a 2020 2020 2020 2020 2020  )[1]..          
+00019470: 2020 2020 2020 6472 6177 5f6c 6973 7420        draw_list 
+00019480: 3d20 696d 6775 692e 6765 745f 6261 636b  = imgui.get_back
+00019490: 6772 6f75 6e64 5f64 7261 775f 6c69 7374  ground_draw_list
+000194a0: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
+000194b0: 2020 2020 6c65 6674 203d 2038 202b 206f      left = 8 + o
+000194c0: 7269 6769 6e5b 305d 202b 2063 7720 2a20  rigin[0] + cw * 
+000194d0: 6672 616d 652e 6578 706f 7274 5f62 6f74  frame.export_bot
+000194e0: 746f 6d20 2f20 6672 616d 652e 6e5f 736c  tom / frame.n_sl
+000194f0: 6963 6573 0d0a 2020 2020 2020 2020 2020  ices..          
+00019500: 2020 2020 2020 7269 6768 7420 3d20 3820        right = 8 
+00019510: 2b20 6f72 6967 696e 5b30 5d20 2b20 6377  + origin[0] + cw
+00019520: 202a 2066 7261 6d65 2e65 7870 6f72 745f   * frame.export_
+00019530: 746f 7020 2f20 6672 616d 652e 6e5f 736c  top / frame.n_sl
+00019540: 6963 6573 0d0a 2020 2020 2020 2020 2020  ices..          
+00019550: 2020 2020 2020 6472 6177 5f6c 6973 742e        draw_list.
+00019560: 6164 645f 7265 6374 5f66 696c 6c65 6428  add_rect_filled(
+00019570: 6c65 6674 2c20 792c 2072 6967 6874 2c20  left, y, right, 
+00019580: 7920 2b20 3138 2c20 696d 6775 692e 6765  y + 18, imgui.ge
+00019590: 745f 636f 6c6f 725f 7533 325f 7267 6261  t_color_u32_rgba
+000195a0: 282a 6366 672e 434f 4c4f 5552 5f50 4f53  (*cfg.COLOUR_POS
+000195b0: 4954 4956 4529 2c20 3130 290d 0a0d 0a20  ITIVE), 10).... 
+000195c0: 2020 2020 2020 2020 2020 205f 2c20 7265             _, re
+000195d0: 7175 6573 7465 645f 736c 6963 6520 3d20  quested_slice = 
+000195e0: 696d 6775 692e 736c 6964 6572 5f69 6e74  imgui.slider_int
+000195f0: 2822 2323 736c 6963 6572 5f73 6c69 6465  ("##slicer_slide
+00019600: 7222 2c20 6672 616d 652e 6375 7272 656e  r", frame.curren
+00019610: 745f 736c 6963 652c 2030 2c20 6672 616d  t_slice, 0, fram
+00019620: 652e 6e5f 736c 6963 6573 2c20 666f 726d  e.n_slices, form
+00019630: 6174 3d66 2273 6c69 6365 207b 312b 6672  at=f"slice {1+fr
+00019640: 616d 652e 6375 7272 656e 745f 736c 6963  ame.current_slic
+00019650: 657d 2f7b 6672 616d 652e 6e5f 736c 6963  e}/{frame.n_slic
+00019660: 6573 7d22 290d 0a20 2020 2020 2020 2020  es}")..         
+00019670: 2020 2069 6620 5f3a 0d0a 2020 2020 2020     if _:..      
+00019680: 2020 2020 2020 2020 2020 6672 616d 652e            frame.
+00019690: 7365 745f 736c 6963 6528 7265 7175 6573  set_slice(reques
+000196a0: 7465 645f 736c 6963 6529 0d0a 2020 2020  ted_slice)..    
+000196b0: 2020 2020 2020 2020 2020 2020 5365 676d              Segm
+000196c0: 656e 7461 7469 6f6e 4564 6974 6f72 2e46  entationEditor.F
+000196d0: 5241 4d45 5f54 4558 5455 5245 5f52 4551  RAME_TEXTURE_REQ
+000196e0: 5549 5245 535f 5550 4441 5445 207c 3d20  UIRES_UPDATE |= 
+000196f0: 5472 7565 0d0a 2020 2020 2020 2020 2020  True..          
+00019700: 2020 2020 2020 5365 676d 656e 7461 7469        Segmentati
+00019710: 6f6e 4564 6974 6f72 2e56 4945 575f 5245  onEditor.VIEW_RE
+00019720: 5155 4952 4553 5f55 5044 4154 4520 3d20  QUIRES_UPDATE = 
+00019730: 5472 7565 0d0a 2020 2020 2020 2020 2020  True..          
+00019740: 2020 6966 2065 7870 6f72 745f 6d6f 6465    if export_mode
+00019750: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00019760: 2020 2069 6d67 7569 2e70 7573 685f 7374     imgui.push_st
+00019770: 796c 655f 7661 7228 696d 6775 692e 5354  yle_var(imgui.ST
+00019780: 594c 455f 4652 414d 455f 5041 4444 494e  YLE_FRAME_PADDIN
+00019790: 472c 2028 302c 2030 2929 0d0a 2020 2020  G, (0, 0))..    
+000197a0: 2020 2020 2020 2020 2020 2020 5f2c 2066              _, f
+000197b0: 7261 6d65 2e65 7870 6f72 745f 626f 7474  rame.export_bott
+000197c0: 6f6d 203d 2069 6d67 7569 2e73 6c69 6465  om = imgui.slide
+000197d0: 725f 696e 7428 2223 2365 7870 6f72 745f  r_int("##export_
+000197e0: 626f 7474 6f6d 222c 2066 7261 6d65 2e65  bottom", frame.e
+000197f0: 7870 6f72 745f 626f 7474 6f6d 2c20 302c  xport_bottom, 0,
+00019800: 2066 7261 6d65 2e6e 5f73 6c69 6365 7320   frame.n_slices 
+00019810: 2d20 312c 2066 6f72 6d61 743d 6622 6578  - 1, format=f"ex
+00019820: 706f 7274 2073 7461 7274 207b 6672 616d  port start {fram
+00019830: 652e 6578 706f 7274 5f62 6f74 746f 6d20  e.export_bottom 
+00019840: 2b20 317d 2229 0d0a 2020 2020 2020 2020  + 1}")..        
+00019850: 2020 2020 2020 2020 696d 6775 692e 706f          imgui.po
+00019860: 705f 7374 796c 655f 7661 7228 3129 0d0a  p_style_var(1)..
+00019870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019880: 6966 205f 3a0d 0a20 2020 2020 2020 2020  if _:..         
+00019890: 2020 2020 2020 2020 2020 2066 7261 6d65             frame
+000198a0: 2e73 6574 5f73 6c69 6365 2866 7261 6d65  .set_slice(frame
+000198b0: 2e65 7870 6f72 745f 626f 7474 6f6d 290d  .export_bottom).
+000198c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000198d0: 2020 2020 2053 6567 6d65 6e74 6174 696f       Segmentatio
+000198e0: 6e45 6469 746f 722e 4652 414d 455f 5445  nEditor.FRAME_TE
+000198f0: 5854 5552 455f 5245 5155 4952 4553 5f55  XTURE_REQUIRES_U
+00019900: 5044 4154 4520 7c3d 2054 7275 650d 0a20  PDATE |= True.. 
 00019910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019920: 2020 2020 5365 676d 656e 7461 7469 6f6e      Segmentation
-00019930: 4564 6974 6f72 2e72 656e 6465 7265 722e  Editor.renderer.
-00019940: 6164 645f 6369 7263 6c65 2877 6f72 6c64  add_circle(world
-00019950: 5f70 6f73 6974 696f 6e2c 2072 6164 6975  _position, radiu
-00019960: 732c 2061 6374 6976 655f 6665 6174 7572  s, active_featur
-00019970: 652e 636f 6c6f 7572 290d 0a20 2020 2020  e.colour)..     
-00019980: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00019990: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-000199a0: 2020 2020 2020 2020 2020 2020 2020 5365                Se
-000199b0: 676d 656e 7461 7469 6f6e 4564 6974 6f72  gmentationEditor
-000199c0: 2e72 656e 6465 7265 722e 6164 645f 7371  .renderer.add_sq
-000199d0: 7561 7265 2877 6f72 6c64 5f70 6f73 6974  uare(world_posit
-000199e0: 696f 6e2c 2061 6374 6976 655f 6665 6174  ion, active_feat
-000199f0: 7572 652e 626f 785f 7369 7a65 5f6e 6d2c  ure.box_size_nm,
-00019a00: 2061 6374 6976 655f 6665 6174 7572 652e   active_feature.
-00019a10: 636f 6c6f 7572 290d 0a20 2020 2020 2020  colour)..       
-00019a20: 2020 2020 2020 2020 2066 6f72 2066 2069           for f i
-00019a30: 6e20 6366 672e 7365 5f61 6374 6976 655f  n cfg.se_active_
-00019a40: 6672 616d 652e 6665 6174 7572 6573 3a0d  frame.features:.
-00019a50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019a60: 2020 2020 2066 7261 6d65 5f78 7920 3d20       frame_xy = 
-00019a70: 662e 7061 7265 6e74 2e74 7261 6e73 666f  f.parent.transfo
-00019a80: 726d 2e74 7261 6e73 6c61 7469 6f6e 0d0a  rm.translation..
-00019a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019aa0: 2020 2020 6966 2066 2e73 686f 775f 626f      if f.show_bo
-00019ab0: 7865 7320 616e 6420 6e6f 7420 662e 6869  xes and not f.hi
-00019ac0: 6465 2061 6e64 2066 2e63 7572 7265 6e74  de and f.current
-00019ad0: 5f73 6c69 6365 2069 6e20 662e 626f 7865  _slice in f.boxe
-00019ae0: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
-00019af0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00019b00: 626f 7820 696e 2066 2e62 6f78 6573 5b66  box in f.boxes[f
-00019b10: 2e63 7572 7265 6e74 5f73 6c69 6365 5d3a  .current_slice]:
-00019b20: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00019b30: 2020 2020 2020 2020 2020 2020 2020 626f                bo
-00019b40: 785f 785f 706f 7320 3d20 6672 616d 655f  x_x_pos = frame_
-00019b50: 7879 5b30 5d20 2b20 2862 6f78 5b30 5d20  xy[0] + (box[0] 
-00019b60: 2d20 662e 7061 7265 6e74 2e77 6964 7468  - f.parent.width
-00019b70: 202f 2032 2920 2a20 662e 7061 7265 6e74   / 2) * f.parent
-00019b80: 2e70 6978 656c 5f73 697a 650d 0a20 2020  .pixel_size..   
-00019b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019ba0: 2020 2020 2020 2020 2062 6f78 5f79 5f70           box_y_p
-00019bb0: 6f73 203d 2066 7261 6d65 5f78 795b 315d  os = frame_xy[1]
-00019bc0: 202b 2028 626f 785b 315d 202d 2066 2e70   + (box[1] - f.p
-00019bd0: 6172 656e 742e 6865 6967 6874 202f 2032  arent.height / 2
-00019be0: 2920 2a20 662e 7061 7265 6e74 2e70 6978  ) * f.parent.pix
-00019bf0: 656c 5f73 697a 650d 0a20 2020 2020 2020  el_size..       
-00019c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019c10: 2020 2020 2053 6567 6d65 6e74 6174 696f       Segmentatio
-00019c20: 6e45 6469 746f 722e 7265 6e64 6572 6572  nEditor.renderer
-00019c30: 2e61 6464 5f73 7175 6172 6528 2862 6f78  .add_square((box
-00019c40: 5f78 5f70 6f73 2c20 626f 785f 795f 706f  _x_pos, box_y_po
-00019c50: 7329 2c20 662e 626f 785f 7369 7a65 5f6e  s), f.box_size_n
-00019c60: 6d2c 2066 2e63 6f6c 6f75 7229 0d0a 2020  m, f.colour)..  
-00019c70: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-00019c80: 662e 6163 7469 7665 5f74 6162 2069 6e20  f.active_tab in 
-00019c90: 5b22 4d6f 6465 6c73 222c 2022 4578 706f  ["Models", "Expo
-00019ca0: 7274 225d 3a0d 0a20 2020 2020 2020 2020  rt"]:..         
-00019cb0: 2020 2020 2020 2053 6567 6d65 6e74 6174         Segmentat
-00019cc0: 696f 6e45 6469 746f 722e 7265 6e64 6572  ionEditor.render
-00019cd0: 6572 2e72 656e 6465 725f 6d6f 6465 6c73  er.render_models
-00019ce0: 2863 6667 2e73 655f 6163 7469 7665 5f66  (cfg.se_active_f
-00019cf0: 7261 6d65 2c20 7365 6c66 2e63 616d 6572  rame, self.camer
-00019d00: 6129 0d0a 2020 2020 2020 2020 2020 2020  a)..            
-00019d10: 6966 2073 656c 662e 6163 7469 7665 5f74  if self.active_t
-00019d20: 6162 203d 3d20 224d 6f64 656c 7322 2061  ab == "Models" a
-00019d30: 6e64 2073 656c 662e 7368 6f77 5f74 7261  nd self.show_tra
-00019d40: 696e 7365 745f 626f 7865 733a 0d0a 2020  inset_boxes:..  
-00019d50: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-00019d60: 7220 6620 696e 2063 6667 2e73 655f 6163  r f in cfg.se_ac
-00019d70: 7469 7665 5f66 7261 6d65 2e66 6561 7475  tive_frame.featu
-00019d80: 7265 733a 0d0a 2020 2020 2020 2020 2020  res:..          
-00019d90: 2020 2020 2020 2020 2020 6672 616d 655f            frame_
-00019da0: 7879 203d 2066 2e70 6172 656e 742e 7472  xy = f.parent.tr
-00019db0: 616e 7366 6f72 6d2e 7472 616e 736c 6174  ansform.translat
-00019dc0: 696f 6e0d 0a20 2020 2020 2020 2020 2020  ion..           
-00019dd0: 2020 2020 2020 2020 2069 6620 662e 6375           if f.cu
-00019de0: 7272 656e 745f 736c 6963 6520 696e 2066  rrent_slice in f
-00019df0: 2e62 6f78 6573 2061 6e64 2066 2e74 6974  .boxes and f.tit
-00019e00: 6c65 2069 6e20 7365 6c66 2e74 7261 696e  le in self.train
-00019e10: 7365 745f 6665 6174 7572 655f 7365 6c65  set_feature_sele
-00019e20: 6374 696f 6e3a 0d0a 2020 2020 2020 2020  ction:..        
-00019e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019e40: 7376 616c 203d 2073 656c 662e 7472 6169  sval = self.trai
-00019e50: 6e73 6574 5f66 6561 7475 7265 5f73 656c  nset_feature_sel
-00019e60: 6563 7469 6f6e 5b66 2e74 6974 6c65 5d0d  ection[f.title].
-00019e70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019e80: 2020 2020 2020 2020 2069 6620 7376 616c           if sval
-00019e90: 203d 3d20 302e 303a 0d0a 2020 2020 2020   == 0.0:..      
-00019ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019eb0: 2020 2020 2020 636f 6e74 696e 7565 0d0a        continue..
-00019ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019ed0: 2020 2020 2020 2020 636c 7220 3d20 6366          clr = cf
-00019ee0: 672e 434f 4c4f 5552 5f50 4f53 4954 4956  g.COLOUR_POSITIV
-00019ef0: 4520 6966 2073 7661 6c20 3d3d 2031 2e30  E if sval == 1.0
-00019f00: 2065 6c73 6520 6366 672e 434f 4c4f 5552   else cfg.COLOUR
-00019f10: 5f4e 4547 4154 4956 450d 0a20 2020 2020  _NEGATIVE..     
-00019f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019f30: 2020 2066 6f72 2062 6f78 2069 6e20 662e     for box in f.
-00019f40: 626f 7865 735b 662e 6375 7272 656e 745f  boxes[f.current_
-00019f50: 736c 6963 655d 3a0d 0a20 2020 2020 2020  slice]:..       
-00019f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019f70: 2020 2020 2062 6f78 5f78 5f70 6f73 203d       box_x_pos =
-00019f80: 2066 7261 6d65 5f78 795b 305d 202b 2028   frame_xy[0] + (
-00019f90: 626f 785b 305d 202d 2066 2e70 6172 656e  box[0] - f.paren
-00019fa0: 742e 7769 6474 6820 2f20 3229 202a 2066  t.width / 2) * f
-00019fb0: 2e70 6172 656e 742e 7069 7865 6c5f 7369  .parent.pixel_si
-00019fc0: 7a65 0d0a 2020 2020 2020 2020 2020 2020  ze..            
-00019fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019fe0: 626f 785f 795f 706f 7320 3d20 6672 616d  box_y_pos = fram
-00019ff0: 655f 7879 5b31 5d20 2b20 2862 6f78 5b31  e_xy[1] + (box[1
-0001a000: 5d20 2d20 662e 7061 7265 6e74 2e68 6569  ] - f.parent.hei
-0001a010: 6768 7420 2f20 3229 202a 2066 2e70 6172  ght / 2) * f.par
-0001a020: 656e 742e 7069 7865 6c5f 7369 7a65 0d0a  ent.pixel_size..
-0001a030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a040: 2020 2020 2020 2020 2020 2020 626f 785f              box_
-0001a050: 7369 7a65 203d 2053 6567 6d65 6e74 6174  size = Segmentat
-0001a060: 696f 6e45 6469 746f 722e 7472 6169 6e73  ionEditor.trains
-0001a070: 6574 5f61 7069 7820 2a20 7365 6c66 2e74  et_apix * self.t
-0001a080: 7261 696e 7365 745f 626f 7873 697a 6520  rainset_boxsize 
-0001a090: 2f20 3130 2e30 0d0a 2020 2020 2020 2020  / 10.0..        
-0001a0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a0b0: 2020 2020 5365 676d 656e 7461 7469 6f6e      Segmentation
-0001a0c0: 4564 6974 6f72 2e72 656e 6465 7265 722e  Editor.renderer.
-0001a0d0: 6164 645f 7371 7561 7265 2828 626f 785f  add_square((box_
-0001a0e0: 785f 706f 732c 2062 6f78 5f79 5f70 6f73  x_pos, box_y_pos
-0001a0f0: 292c 2062 6f78 5f73 697a 652c 2063 6c72  ), box_size, clr
-0001a100: 290d 0a20 2020 2020 2020 2020 2020 2069  )..            i
-0001a110: 6620 7365 6c66 2e61 6374 6976 655f 7461  f self.active_ta
-0001a120: 6220 213d 2022 5265 6e64 6572 223a 0d0a  b != "Render":..
+00019920: 2020 2066 7261 6d65 2e65 7870 6f72 745f     frame.export_
+00019930: 746f 7020 3d20 6d61 7828 5b66 7261 6d65  top = max([frame
+00019940: 2e65 7870 6f72 745f 746f 702c 2066 7261  .export_top, fra
+00019950: 6d65 2e65 7870 6f72 745f 626f 7474 6f6d  me.export_bottom
+00019960: 202b 2031 5d29 0d0a 2020 2020 2020 2020   + 1])..        
+00019970: 2020 2020 2020 2020 2020 2020 6672 616d              fram
+00019980: 652e 6578 706f 7274 5f74 6f70 203d 206d  e.export_top = m
+00019990: 696e 285b 6672 616d 652e 6578 706f 7274  in([frame.export
+000199a0: 5f74 6f70 2c20 6672 616d 652e 6e5f 736c  _top, frame.n_sl
+000199b0: 6963 6573 5d29 0d0a 2020 2020 2020 2020  ices])..        
+000199c0: 2020 2020 696d 6775 692e 706f 705f 7374      imgui.pop_st
+000199d0: 796c 655f 636f 6c6f 7228 3429 0d0a 2020  yle_color(4)..  
+000199e0: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
+000199f0: 706f 705f 6974 656d 5f77 6964 7468 2829  pop_item_width()
+00019a00: 0d0a 2020 2020 2020 2020 2020 2020 696d  ..            im
+00019a10: 6775 692e 656e 6428 290d 0a0d 0a20 2020  gui.end()....   
+00019a20: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
+00019a30: 6f70 5f73 7479 6c65 5f76 6172 2833 290d  op_style_var(3).
+00019a40: 0a20 2020 2020 2020 2020 2020 2069 6d67  .            img
+00019a50: 7569 2e70 6f70 5f73 7479 6c65 5f63 6f6c  ui.pop_style_col
+00019a60: 6f72 2835 290d 0a0d 0a20 2020 2020 2020  or(5)....       
+00019a70: 2023 2053 5441 5254 2047 5549 3a0d 0a20   # START GUI:.. 
+00019a80: 2020 2020 2020 2023 204d 656e 7520 6261         # Menu ba
+00019a90: 720d 0a20 2020 2020 2020 206d 656e 755f  r..        menu_
+00019aa0: 6261 7228 290d 0a0d 0a20 2020 2020 2020  bar()....       
+00019ab0: 2023 2052 656e 6465 7220 7468 6520 6375   # Render the cu
+00019ac0: 7272 656e 746c 7920 6163 7469 7665 2066  rrently active f
+00019ad0: 7261 6d65 0d0a 0d0a 2020 2020 2020 2020  rame....        
+00019ae0: 6966 2063 6667 2e73 655f 6163 7469 7665  if cfg.se_active
+00019af0: 5f66 7261 6d65 2069 7320 6e6f 7420 4e6f  _frame is not No
+00019b00: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
+00019b10: 2069 6620 7365 6c66 2e61 6374 6976 655f   if self.active_
+00019b20: 7461 6220 213d 2022 5265 6e64 6572 223a  tab != "Render":
+00019b30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00019b40: 2020 7078 6420 3d20 5365 676d 656e 7461    pxd = Segmenta
+00019b50: 7469 6f6e 4564 6974 6f72 2e72 656e 6465  tionEditor.rende
+00019b60: 7265 722e 7265 6e64 6572 5f66 696c 7465  rer.render_filte
+00019b70: 7265 645f 6672 616d 6528 6366 672e 7365  red_frame(cfg.se
+00019b80: 5f61 6374 6976 655f 6672 616d 652c 2073  _active_frame, s
+00019b90: 656c 662e 6361 6d65 7261 2c20 7365 6c66  elf.camera, self
+00019ba0: 2e77 696e 646f 772c 2073 656c 662e 6669  .window, self.fi
+00019bb0: 6c74 6572 732c 2065 6d70 6861 7369 7a65  lters, emphasize
+00019bc0: 5f72 6f69 3d73 656c 662e 6163 7469 7665  _roi=self.active
+00019bd0: 5f74 6162 206e 6f74 2069 6e20 5b22 5365  _tab not in ["Se
+00019be0: 676d 656e 7461 7469 6f6e 222c 2022 5265  gmentation", "Re
+00019bf0: 6e64 6572 225d 290d 0a20 2020 2020 2020  nder"])..       
+00019c00: 2020 2020 2020 2020 2069 6620 7078 6420           if pxd 
+00019c10: 6973 206e 6f74 204e 6f6e 653a 0d0a 2020  is not None:..  
+00019c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019c30: 2020 6366 672e 7365 5f61 6374 6976 655f    cfg.se_active_
+00019c40: 6672 616d 652e 7265 6e64 6572 6564 5f64  frame.rendered_d
+00019c50: 6174 6120 3d20 7078 640d 0a20 2020 2020  ata = pxd..     
+00019c60: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00019c70: 6667 2e73 655f 6163 7469 7665 5f66 7261  fg.se_active_fra
+00019c80: 6d65 2e75 7064 6174 655f 696d 6167 655f  me.update_image_
+00019c90: 7465 7874 7572 6528 290d 0a20 2020 2020  texture()..     
+00019ca0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00019cb0: 6667 2e73 655f 6163 7469 7665 5f66 7261  fg.se_active_fra
+00019cc0: 6d65 2e63 6f6d 7075 7465 5f68 6973 746f  me.compute_histo
+00019cd0: 6772 616d 2870 7864 290d 0a20 2020 2020  gram(pxd)..     
+00019ce0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00019cf0: 6620 6366 672e 7365 5f61 6374 6976 655f  f cfg.se_active_
+00019d00: 6672 616d 652e 6175 746f 636f 6e74 7261  frame.autocontra
+00019d10: 7374 3a0d 0a20 2020 2020 2020 2020 2020  st:..           
+00019d20: 2020 2020 2020 2020 2020 2020 2063 6667               cfg
+00019d30: 2e73 655f 6163 7469 7665 5f66 7261 6d65  .se_active_frame
+00019d40: 2e63 6f6d 7075 7465 5f61 7574 6f63 6f6e  .compute_autocon
+00019d50: 7472 6173 7428 4e6f 6e65 2c20 7078 6429  trast(None, pxd)
+00019d60: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00019d70: 2020 5365 676d 656e 7461 7469 6f6e 4564    SegmentationEd
+00019d80: 6974 6f72 2e46 5241 4d45 5f54 4558 5455  itor.FRAME_TEXTU
+00019d90: 5245 5f52 4551 5549 5245 535f 5550 4441  RE_REQUIRES_UPDA
+00019da0: 5445 203d 2046 616c 7365 0d0a 2020 2020  TE = False..    
+00019db0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00019dc0: 6163 7469 7665 5f74 6162 203d 3d20 2253  active_tab == "S
+00019dd0: 6567 6d65 6e74 6174 696f 6e22 3a0d 0a20  egmentation":.. 
+00019de0: 2020 2020 2020 2020 2020 2020 2020 2053                 S
+00019df0: 6567 6d65 6e74 6174 696f 6e45 6469 746f  egmentationEdito
+00019e00: 722e 7265 6e64 6572 6572 2e72 656e 6465  r.renderer.rende
+00019e10: 725f 7365 676d 656e 7461 7469 6f6e 7328  r_segmentations(
+00019e20: 6366 672e 7365 5f61 6374 6976 655f 6672  cfg.se_active_fr
+00019e30: 616d 652c 2073 656c 662e 6361 6d65 7261  ame, self.camera
+00019e40: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
+00019e50: 2020 2020 2023 2072 656e 6465 7220 6472       # render dr
+00019e60: 6177 696e 6720 524f 4920 696e 6469 6361  awing ROI indica
+00019e70: 746f 720d 0a20 2020 2020 2020 2020 2020  tor..           
+00019e80: 2020 2020 2061 6374 6976 655f 6665 6174       active_feat
+00019e90: 7572 6520 3d20 6366 672e 7365 5f61 6374  ure = cfg.se_act
+00019ea0: 6976 655f 6672 616d 652e 6163 7469 7665  ive_frame.active
+00019eb0: 5f66 6561 7475 7265 0d0a 2020 2020 2020  _feature..      
+00019ec0: 2020 2020 2020 2020 2020 6966 2061 6374            if act
+00019ed0: 6976 655f 6665 6174 7572 6520 6973 206e  ive_feature is n
+00019ee0: 6f74 204e 6f6e 653a 0d0a 2020 2020 2020  ot None:..      
+00019ef0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+00019f00: 6469 7573 203d 2061 6374 6976 655f 6665  dius = active_fe
+00019f10: 6174 7572 652e 6272 7573 685f 7369 7a65  ature.brush_size
+00019f20: 202a 2061 6374 6976 655f 6665 6174 7572   * active_featur
+00019f30: 652e 7061 7265 6e74 2e70 6978 656c 5f73  e.parent.pixel_s
+00019f40: 697a 650d 0a20 2020 2020 2020 2020 2020  ize..           
+00019f50: 2020 2020 2020 2020 2077 6f72 6c64 5f70           world_p
+00019f60: 6f73 6974 696f 6e20 3d20 7365 6c66 2e63  osition = self.c
+00019f70: 616d 6572 612e 6375 7273 6f72 5f74 6f5f  amera.cursor_to_
+00019f80: 776f 726c 645f 706f 7369 7469 6f6e 2873  world_position(s
+00019f90: 656c 662e 7769 6e64 6f77 2e63 7572 736f  elf.window.curso
+00019fa0: 725f 706f 7329 0d0a 2020 2020 2020 2020  r_pos)..        
+00019fb0: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+00019fc0: 6f74 2053 6567 6d65 6e74 6174 696f 6e45  ot SegmentationE
+00019fd0: 6469 746f 722e 6973 5f73 6869 6674 5f64  ditor.is_shift_d
+00019fe0: 6f77 6e28 293a 0d0a 2020 2020 2020 2020  own():..        
+00019ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a000: 5365 676d 656e 7461 7469 6f6e 4564 6974  SegmentationEdit
+0001a010: 6f72 2e72 656e 6465 7265 722e 6164 645f  or.renderer.add_
+0001a020: 6369 7263 6c65 2877 6f72 6c64 5f70 6f73  circle(world_pos
+0001a030: 6974 696f 6e2c 2072 6164 6975 732c 2061  ition, radius, a
+0001a040: 6374 6976 655f 6665 6174 7572 652e 636f  ctive_feature.co
+0001a050: 6c6f 7572 290d 0a20 2020 2020 2020 2020  lour)..         
+0001a060: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+0001a070: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001a080: 2020 2020 2020 2020 2020 5365 676d 656e            Segmen
+0001a090: 7461 7469 6f6e 4564 6974 6f72 2e72 656e  tationEditor.ren
+0001a0a0: 6465 7265 722e 6164 645f 7371 7561 7265  derer.add_square
+0001a0b0: 2877 6f72 6c64 5f70 6f73 6974 696f 6e2c  (world_position,
+0001a0c0: 2061 6374 6976 655f 6665 6174 7572 652e   active_feature.
+0001a0d0: 626f 785f 7369 7a65 5f6e 6d2c 2061 6374  box_size_nm, act
+0001a0e0: 6976 655f 6665 6174 7572 652e 636f 6c6f  ive_feature.colo
+0001a0f0: 7572 290d 0a20 2020 2020 2020 2020 2020  ur)..           
+0001a100: 2020 2020 2066 6f72 2066 2069 6e20 6366       for f in cf
+0001a110: 672e 7365 5f61 6374 6976 655f 6672 616d  g.se_active_fram
+0001a120: 652e 6665 6174 7572 6573 3a0d 0a20 2020  e.features:..   
 0001a130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a140: 6f76 6572 6c61 795f 626c 656e 645f 6d6f  overlay_blend_mo
-0001a150: 6465 203d 2053 6567 6d65 6e74 6174 696f  de = Segmentatio
-0001a160: 6e45 6469 746f 722e 424c 454e 445f 4d4f  nEditor.BLEND_MO
-0001a170: 4445 535b 5365 676d 656e 7461 7469 6f6e  DES[Segmentation
-0001a180: 4564 6974 6f72 2e42 4c45 4e44 5f4d 4f44  Editor.BLEND_MOD
-0001a190: 4553 5f4c 4953 545b 5365 676d 656e 7461  ES_LIST[Segmenta
-0001a1a0: 7469 6f6e 4564 6974 6f72 2e4f 5645 524c  tionEditor.OVERL
-0001a1b0: 4159 5f42 4c45 4e44 5f4d 4f44 455d 5d0d  AY_BLEND_MODE]].
-0001a1c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001a1d0: 2053 6567 6d65 6e74 6174 696f 6e45 6469   SegmentationEdi
-0001a1e0: 746f 722e 7265 6e64 6572 6572 2e72 656e  tor.renderer.ren
-0001a1f0: 6465 725f 6f76 6572 6c61 7928 6366 672e  der_overlay(cfg.
-0001a200: 7365 5f61 6374 6976 655f 6672 616d 652c  se_active_frame,
-0001a210: 2073 656c 662e 6361 6d65 7261 2c20 6f76   self.camera, ov
-0001a220: 6572 6c61 795f 626c 656e 645f 6d6f 6465  erlay_blend_mode
-0001a230: 2c20 5365 676d 656e 7461 7469 6f6e 4564  , SegmentationEd
-0001a240: 6974 6f72 2e4f 5645 524c 4159 5f41 4c50  itor.OVERLAY_ALP
-0001a250: 4841 290d 0a20 2020 2020 2020 2020 2020  HA)..           
-0001a260: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-0001a270: 2020 2020 2020 2020 6966 2053 6567 6d65          if Segme
-0001a280: 6e74 6174 696f 6e45 6469 746f 722e 5245  ntationEditor.RE
-0001a290: 4e44 4552 5f42 4f58 3a0d 0a20 2020 2020  NDER_BOX:..     
-0001a2a0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0001a2b0: 2052 656e 6465 7220 3344 2062 6f78 2061   Render 3D box a
-0001a2c0: 726f 756e 6420 7468 6520 766f 6c75 6d65  round the volume
-0001a2d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001a2e0: 2020 2020 2020 7365 6c66 2e72 656e 6465        self.rende
-0001a2f0: 7265 722e 7265 6e64 6572 5f6c 696e 655f  rer.render_line_
-0001a300: 7661 2873 656c 662e 7069 636b 5f62 6f78  va(self.pick_box
-0001a310: 5f76 612c 2073 656c 662e 6361 6d65 7261  _va, self.camera
-0001a320: 3364 290d 0a0d 0a20 2020 2020 2020 2020  3d)....         
-0001a330: 2020 2020 2020 2023 2052 656e 6465 7220         # Render 
-0001a340: 6c69 6e65 7320 616c 6f6e 6720 6564 6765  lines along edge
-0001a350: 7320 6f66 2066 7261 6d65 0d0a 2020 2020  s of frame..    
-0001a360: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001a370: 2e72 656e 6465 7265 722e 7265 6e64 6572  .renderer.render
-0001a380: 5f66 7261 6d65 5f62 6f72 6465 7228 6366  _frame_border(cf
-0001a390: 672e 7365 5f61 6374 6976 655f 6672 616d  g.se_active_fram
-0001a3a0: 652c 2073 656c 662e 6361 6d65 7261 3364  e, self.camera3d
-0001a3b0: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
-0001a3c0: 2020 2020 2023 2052 656e 6465 7220 7375       # Render su
-0001a3d0: 7266 6163 6520 6d6f 6465 6c73 2069 6e20  rface models in 
-0001a3e0: 3344 0d0a 2020 2020 2020 2020 2020 2020  3D..            
-0001a3f0: 2020 2020 6966 206e 6f74 2069 6d67 7569      if not imgui
-0001a400: 2e69 735f 6b65 795f 646f 776e 2867 6c66  .is_key_down(glf
-0001a410: 772e 4b45 595f 5129 3a0d 0a20 2020 2020  w.KEY_Q):..     
-0001a420: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001a430: 656c 662e 7265 6e64 6572 6572 2e72 656e  elf.renderer.ren
-0001a440: 6465 725f 7375 7266 6163 655f 6d6f 6465  der_surface_mode
-0001a450: 6c73 2863 6667 2e73 655f 7375 7266 6163  ls(cfg.se_surfac
-0001a460: 655f 6d6f 6465 6c73 2c20 7365 6c66 2e63  e_models, self.c
-0001a470: 616d 6572 6133 642c 2053 6567 6d65 6e74  amera3d, Segment
-0001a480: 6174 696f 6e45 6469 746f 722e 4c49 4748  ationEditor.LIGH
-0001a490: 545f 414d 4249 454e 545f 5354 5245 4e47  T_AMBIENT_STRENG
-0001a4a0: 5448 2c20 5365 676d 656e 7461 7469 6f6e  TH, Segmentation
-0001a4b0: 4564 6974 6f72 2e4c 4947 4854 5f53 504f  Editor.LIGHT_SPO
-0001a4c0: 5429 0d0a 0d0a 2020 2020 2020 2020 2020  T)....          
-0001a4d0: 2020 2020 2020 2320 5265 6e64 6572 2074        # Render t
-0001a4e0: 6865 2066 7261 6d65 0d0a 2020 2020 2020  he frame..      
-0001a4f0: 2020 2020 2020 2020 2020 7078 6420 3d20            pxd = 
-0001a500: 5365 676d 656e 7461 7469 6f6e 4564 6974  SegmentationEdit
-0001a510: 6f72 2e72 656e 6465 7265 722e 7265 6e64  or.renderer.rend
-0001a520: 6572 5f66 696c 7465 7265 645f 6672 616d  er_filtered_fram
-0001a530: 6528 6366 672e 7365 5f61 6374 6976 655f  e(cfg.se_active_
-0001a540: 6672 616d 652c 2073 656c 662e 6361 6d65  frame, self.came
-0001a550: 7261 2c20 7365 6c66 2e77 696e 646f 772c  ra, self.window,
-0001a560: 2073 656c 662e 6669 6c74 6572 732c 2063   self.filters, c
-0001a570: 616d 6572 6133 643d 7365 6c66 2e63 616d  amera3d=self.cam
-0001a580: 6572 6133 6429 0d0a 2020 2020 2020 2020  era3d)..        
-0001a590: 2020 2020 2020 2020 6966 2070 7864 2069          if pxd i
-0001a5a0: 7320 6e6f 7420 4e6f 6e65 3a0d 0a20 2020  s not None:..   
-0001a5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a5c0: 2063 6667 2e73 655f 6163 7469 7665 5f66   cfg.se_active_f
-0001a5d0: 7261 6d65 2e72 656e 6465 7265 645f 6461  rame.rendered_da
-0001a5e0: 7461 203d 2070 7864 0d0a 2020 2020 2020  ta = pxd..      
-0001a5f0: 2020 2020 2020 2020 2020 2020 2020 6366                cf
-0001a600: 672e 7365 5f61 6374 6976 655f 6672 616d  g.se_active_fram
-0001a610: 652e 7570 6461 7465 5f69 6d61 6765 5f74  e.update_image_t
-0001a620: 6578 7475 7265 2829 0d0a 2020 2020 2020  exture()..      
-0001a630: 2020 2020 2020 2020 2020 2020 2020 6366                cf
-0001a640: 672e 7365 5f61 6374 6976 655f 6672 616d  g.se_active_fram
-0001a650: 652e 636f 6d70 7574 655f 6869 7374 6f67  e.compute_histog
-0001a660: 7261 6d28 7078 6429 0d0a 2020 2020 2020  ram(pxd)..      
-0001a670: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0001a680: 2063 6667 2e73 655f 6163 7469 7665 5f66   cfg.se_active_f
-0001a690: 7261 6d65 2e61 7574 6f63 6f6e 7472 6173  rame.autocontras
-0001a6a0: 743a 0d0a 2020 2020 2020 2020 2020 2020  t:..            
-0001a6b0: 2020 2020 2020 2020 2020 2020 6366 672e              cfg.
-0001a6c0: 7365 5f61 6374 6976 655f 6672 616d 652e  se_active_frame.
-0001a6d0: 636f 6d70 7574 655f 6175 746f 636f 6e74  compute_autocont
-0001a6e0: 7261 7374 284e 6f6e 652c 2070 7864 290d  rast(None, pxd).
-0001a6f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001a700: 2053 6567 6d65 6e74 6174 696f 6e45 6469   SegmentationEdi
-0001a710: 746f 722e 4652 414d 455f 5445 5854 5552  tor.FRAME_TEXTUR
-0001a720: 455f 5245 5155 4952 4553 5f55 5044 4154  E_REQUIRES_UPDAT
-0001a730: 4520 3d20 4661 6c73 650d 0a0d 0a20 2020  E = False....   
-0001a740: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0001a750: 6e6f 7420 696d 6775 692e 6973 5f6b 6579  not imgui.is_key
-0001a760: 5f64 6f77 6e28 676c 6677 2e4b 4559 5f51  _down(glfw.KEY_Q
-0001a770: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-0001a780: 2020 2020 2020 2020 7365 6c66 2e72 656e          self.ren
-0001a790: 6465 7265 722e 7265 6e64 6572 5f73 7572  derer.render_sur
-0001a7a0: 6661 6365 5f6d 6f64 656c 5f70 6172 7469  face_model_parti
-0001a7b0: 636c 6573 2863 6667 2e73 655f 7375 7266  cles(cfg.se_surf
-0001a7c0: 6163 655f 6d6f 6465 6c73 2c20 7365 6c66  ace_models, self
-0001a7d0: 2e63 616d 6572 6133 6429 0d0a 0d0a 2020  .camera3d)....  
-0001a7e0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-0001a7f0: 5265 6e64 6572 206f 7665 726c 6179 2c20  Render overlay, 
-0001a800: 6966 2070 6f73 7369 626c 653a 0d0a 2020  if possible:..  
-0001a810: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0001a820: 2063 6667 2e73 655f 6163 7469 7665 5f66   cfg.se_active_f
-0001a830: 7261 6d65 2e6f 7665 726c 6179 2069 7320  rame.overlay is 
-0001a840: 6e6f 7420 4e6f 6e65 3a0d 0a20 2020 2020  not None:..     
-0001a850: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0001a860: 6620 5365 676d 656e 7461 7469 6f6e 4564  f SegmentationEd
-0001a870: 6974 6f72 2e56 4945 575f 5245 5155 4952  itor.VIEW_REQUIR
-0001a880: 4553 5f55 5044 4154 453a 0d0a 2020 2020  ES_UPDATE:..    
-0001a890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a8a0: 2020 2020 7365 6c66 2e72 656e 6465 7265      self.rendere
-0001a8b0: 722e 7261 795f 7472 6163 655f 6f76 6572  r.ray_trace_over
-0001a8c0: 6c61 7928 2873 656c 662e 7769 6e64 6f77  lay((self.window
-0001a8d0: 2e77 6964 7468 2c20 7365 6c66 2e77 696e  .width, self.win
-0001a8e0: 646f 772e 6865 6967 6874 292c 2063 6667  dow.height), cfg
-0001a8f0: 2e73 655f 6163 7469 7665 5f66 7261 6d65  .se_active_frame
-0001a900: 2c20 7365 6c66 2e63 616d 6572 6133 642c  , self.camera3d,
-0001a910: 2073 656c 662e 7069 636b 5f62 6f78 5f71   self.pick_box_q
-0001a920: 7561 645f 7661 290d 0a20 2020 2020 2020  uad_va)..       
-0001a930: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0001a940: 7365 6c66 2e70 6963 6b5f 6f76 6572 6c61  self.pick_overla
-0001a950: 795f 3364 3a0d 0a20 2020 2020 2020 2020  y_3d:..         
-0001a960: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001a970: 656c 662e 7265 6e64 6572 6572 2e72 656e  elf.renderer.ren
-0001a980: 6465 725f 6f76 6572 6c61 795f 3364 2853  der_overlay_3d(S
-0001a990: 6567 6d65 6e74 6174 696f 6e45 6469 746f  egmentationEdito
-0001a9a0: 722e 4f56 4552 4c41 595f 414c 5048 412c  r.OVERLAY_ALPHA,
-0001a9b0: 2053 6567 6d65 6e74 6174 696f 6e45 6469   SegmentationEdi
-0001a9c0: 746f 722e 4f56 4552 4c41 595f 494e 5445  tor.OVERLAY_INTE
-0001a9d0: 4e53 4954 5929 0d0a 2020 2020 2020 2020  NSITY)..        
-0001a9e0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0001a9f0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0001aa00: 2020 2020 2020 2020 2020 206f 7665 726c             overl
-0001aa10: 6179 5f62 6c65 6e64 5f6d 6f64 6520 3d20  ay_blend_mode = 
-0001aa20: 5365 676d 656e 7461 7469 6f6e 4564 6974  SegmentationEdit
-0001aa30: 6f72 2e42 4c45 4e44 5f4d 4f44 4553 5b53  or.BLEND_MODES[S
-0001aa40: 6567 6d65 6e74 6174 696f 6e45 6469 746f  egmentationEdito
-0001aa50: 722e 424c 454e 445f 4d4f 4445 535f 4c49  r.BLEND_MODES_LI
-0001aa60: 5354 5b53 6567 6d65 6e74 6174 696f 6e45  ST[SegmentationE
-0001aa70: 6469 746f 722e 4f56 4552 4c41 595f 424c  ditor.OVERLAY_BL
-0001aa80: 454e 445f 4d4f 4445 5d5d 0d0a 2020 2020  END_MODE]]..    
-0001aa90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001aaa0: 2020 2020 7365 6c66 2e72 656e 6465 7265      self.rendere
-0001aab0: 722e 7265 6e64 6572 5f6f 7665 726c 6179  r.render_overlay
-0001aac0: 2863 6667 2e73 655f 6163 7469 7665 5f66  (cfg.se_active_f
-0001aad0: 7261 6d65 2c20 7365 6c66 2e63 616d 6572  rame, self.camer
-0001aae0: 6133 642c 206f 7665 726c 6179 5f62 6c65  a3d, overlay_ble
-0001aaf0: 6e64 5f6d 6f64 652c 2053 6567 6d65 6e74  nd_mode, Segment
-0001ab00: 6174 696f 6e45 6469 746f 722e 4f56 4552  ationEditor.OVER
-0001ab10: 4c41 595f 414c 5048 4129 0d0a 2020 2020  LAY_ALPHA)..    
-0001ab20: 2020 2020 2320 4d41 494e 2057 494e 444f      # MAIN WINDO
-0001ab30: 570d 0a20 2020 2020 2020 2069 6d67 7569  W..        imgui
-0001ab40: 2e73 6574 5f6e 6578 745f 7769 6e64 6f77  .set_next_window
-0001ab50: 5f70 6f73 6974 696f 6e28 302c 2031 372c  _position(0, 17,
-0001ab60: 2069 6d67 7569 2e4f 4e43 4529 0d0a 2020   imgui.ONCE)..  
-0001ab70: 2020 2020 2020 696d 6775 692e 7365 745f        imgui.set_
-0001ab80: 6e65 7874 5f77 696e 646f 775f 7369 7a65  next_window_size
-0001ab90: 2853 6567 6d65 6e74 6174 696f 6e45 6469  (SegmentationEdi
-0001aba0: 746f 722e 4d41 494e 5f57 494e 444f 575f  tor.MAIN_WINDOW_
-0001abb0: 5749 4454 482c 2073 656c 662e 7769 6e64  WIDTH, self.wind
-0001abc0: 6f77 2e68 6569 6768 7420 2d20 3137 290d  ow.height - 17).
-0001abd0: 0a0d 0a20 2020 2020 2020 2069 6d67 7569  ...        imgui
-0001abe0: 2e62 6567 696e 2822 2323 7365 5f6d 6169  .begin("##se_mai
-0001abf0: 6e22 2c20 4661 6c73 652c 2069 6d67 7569  n", False, imgui
-0001ac00: 2e57 494e 444f 575f 4e4f 5f54 4954 4c45  .WINDOW_NO_TITLE
-0001ac10: 5f42 4152 207c 2069 6d67 7569 2e57 494e  _BAR | imgui.WIN
-0001ac20: 444f 575f 4e4f 5f52 4553 495a 4520 7c20  DOW_NO_RESIZE | 
-0001ac30: 696d 6775 692e 5749 4e44 4f57 5f4e 4f5f  imgui.WINDOW_NO_
-0001ac40: 4d4f 5645 290d 0a20 2020 2020 2020 2073  MOVE)..        s
-0001ac50: 6861 7265 645f 6775 6928 290d 0a20 2020  hared_gui()..   
-0001ac60: 2020 2020 2069 6d67 7569 2e73 7061 6369       imgui.spaci
-0001ac70: 6e67 2829 0d0a 2020 2020 2020 2020 696d  ng()..        im
-0001ac80: 6775 692e 7370 6163 696e 6728 290d 0a0d  gui.spacing()...
-0001ac90: 0a20 2020 2020 2020 2069 6620 696d 6775  .        if imgu
-0001aca0: 692e 6265 6769 6e5f 7461 625f 6261 7228  i.begin_tab_bar(
-0001acb0: 2223 2374 6162 7322 293a 0d0a 2020 2020  "##tabs"):..    
-0001acc0: 2020 2020 2020 2020 7365 6c66 2e77 696e          self.win
-0001acd0: 646f 772e 636c 6561 725f 636f 6c6f 7220  dow.clear_color 
-0001ace0: 3d20 6366 672e 434f 4c4f 5552 5f57 494e  = cfg.COLOUR_WIN
-0001acf0: 444f 575f 4241 434b 4752 4f55 4e44 0d0a  DOW_BACKGROUND..
-0001ad00: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-0001ad10: 6d67 7569 2e62 6567 696e 5f74 6162 5f69  mgui.begin_tab_i
-0001ad20: 7465 6d28 2220 2041 6e6e 6f74 6174 696f  tem("  Annotatio
-0001ad30: 6e20 2229 5b30 5d3a 0d0a 2020 2020 2020  n ")[0]:..      
-0001ad40: 2020 2020 2020 2020 2020 7365 676d 656e            segmen
-0001ad50: 7461 7469 6f6e 5f74 6162 2829 0d0a 2020  tation_tab()..  
-0001ad60: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0001ad70: 6c66 2e61 6374 6976 655f 7461 6220 3d20  lf.active_tab = 
-0001ad80: 2253 6567 6d65 6e74 6174 696f 6e22 2020  "Segmentation"  
-0001ad90: 2023 2075 7365 6420 746f 2062 6520 6c61   # used to be la
-0001ada0: 6265 6c6c 6564 2053 6567 6d65 6e74 6174  belled Segmentat
-0001adb0: 696f 6e20 7468 656e 2063 6861 6e67 6564  ion then changed
-0001adc0: 2074 6f20 2741 6e6e 6f74 6174 696f 6e27   to 'Annotation'
-0001add0: 2e20 4469 6420 6e6f 7420 6368 616e 6765  . Did not change
-0001ade0: 2074 6865 2061 6374 6976 655f 7461 6220   the active_tab 
-0001adf0: 656e 756d 2076 616c 7565 2074 686f 7567  enum value thoug
-0001ae00: 682e 0d0a 2020 2020 2020 2020 2020 2020  h...            
-0001ae10: 2020 2020 696d 6775 692e 656e 645f 7461      imgui.end_ta
-0001ae20: 625f 6974 656d 2829 0d0a 2020 2020 2020  b_item()..      
-0001ae30: 2020 2020 2020 6966 2069 6d67 7569 2e62        if imgui.b
-0001ae40: 6567 696e 5f74 6162 5f69 7465 6d28 2220  egin_tab_item(" 
-0001ae50: 4d6f 6465 6c73 2022 295b 305d 3a0d 0a20  Models ")[0]:.. 
-0001ae60: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0001ae70: 6620 7365 6c66 2e61 6374 6976 655f 7461  f self.active_ta
-0001ae80: 6220 213d 2022 4d6f 6465 6c73 223a 0d0a  b != "Models":..
-0001ae90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001aea0: 2020 2020 7365 6c66 2e70 6172 7365 5f61      self.parse_a
-0001aeb0: 7661 696c 6162 6c65 5f66 6561 7475 7265  vailable_feature
-0001aec0: 7328 290d 0a20 2020 2020 2020 2020 2020  s()..           
-0001aed0: 2020 2020 2073 656c 662e 6163 7469 7665       self.active
-0001aee0: 5f74 6162 203d 2022 4d6f 6465 6c73 220d  _tab = "Models".
-0001aef0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001af00: 206d 6f64 656c 735f 7461 6228 290d 0a20   models_tab().. 
-0001af10: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0001af20: 6d67 7569 2e65 6e64 5f74 6162 5f69 7465  mgui.end_tab_ite
-0001af30: 6d28 290d 0a20 2020 2020 2020 2020 2020  m()..           
-0001af40: 2069 6620 696d 6775 692e 6265 6769 6e5f   if imgui.begin_
-0001af50: 7461 625f 6974 656d 2822 2045 7870 6f72  tab_item(" Expor
-0001af60: 7420 2229 5b30 5d3a 0d0a 2020 2020 2020  t ")[0]:..      
-0001af70: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-0001af80: 6374 6976 655f 7461 6220 3d20 2245 7870  ctive_tab = "Exp
-0001af90: 6f72 7422 0d0a 2020 2020 2020 2020 2020  ort"..          
-0001afa0: 2020 2020 2020 6578 706f 7274 5f74 6162        export_tab
-0001afb0: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
-0001afc0: 2020 2020 696d 6775 692e 656e 645f 7461      imgui.end_ta
-0001afd0: 625f 6974 656d 2829 0d0a 2020 2020 2020  b_item()..      
-0001afe0: 2020 2020 2020 6966 2069 6d67 7569 2e62        if imgui.b
-0001aff0: 6567 696e 5f74 6162 5f69 7465 6d28 2220  egin_tab_item(" 
-0001b000: 5265 6e64 6572 2020 2229 5b30 5d3a 0d0a  Render  ")[0]:..
-0001b010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b020: 7365 6c66 2e77 696e 646f 772e 636c 6561  self.window.clea
-0001b030: 725f 636f 6c6f 7220 3d20 5b2a 5365 676d  r_color = [*Segm
-0001b040: 656e 7461 7469 6f6e 4564 6974 6f72 2e52  entationEditor.R
-0001b050: 454e 4445 525f 434c 4541 525f 434f 4c4f  ENDER_CLEAR_COLO
-0001b060: 5552 2c20 312e 305d 0d0a 2020 2020 2020  UR, 1.0]..      
-0001b070: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-0001b080: 6374 6976 655f 7461 6220 3d20 2252 656e  ctive_tab = "Ren
-0001b090: 6465 7222 0d0a 2020 2020 2020 2020 2020  der"..          
-0001b0a0: 2020 2020 2020 7069 636b 696e 675f 7461        picking_ta
-0001b0b0: 6228 290d 0a20 2020 2020 2020 2020 2020  b()..           
-0001b0c0: 2020 2020 2069 6d67 7569 2e65 6e64 5f74       imgui.end_t
-0001b0d0: 6162 5f69 7465 6d28 290d 0a20 2020 2020  ab_item()..     
-0001b0e0: 2020 2020 2020 2069 6d67 7569 2e65 6e64         imgui.end
-0001b0f0: 5f74 6162 5f62 6172 2829 0d0a 0d0a 2020  _tab_bar()....  
-0001b100: 2020 2020 2020 696d 6775 692e 656e 6428        imgui.end(
-0001b110: 290d 0a0d 0a20 2020 2020 2020 2073 6c69  )....        sli
-0001b120: 6365 725f 7769 6e64 6f77 2829 0d0a 2020  cer_window()..  
-0001b130: 2020 2020 2020 7365 6c66 2e5f 7761 726e        self._warn
-0001b140: 696e 675f 7769 6e64 6f77 2829 0d0a 2020  ing_window()..  
-0001b150: 2020 2020 2020 626f 6f74 5f73 7072 6974        boot_sprit
-0001b160: 6528 290d 0a20 2020 2020 2020 2069 6d67  e()..        img
-0001b170: 7569 2e70 6f70 5f73 7479 6c65 5f63 6f6c  ui.pop_style_col
-0001b180: 6f72 2833 3229 0d0a 2020 2020 2020 2020  or(32)..        
-0001b190: 696d 6775 692e 706f 705f 7374 796c 655f  imgui.pop_style_
-0001b1a0: 7661 7228 3129 0d0a 0d0a 2020 2020 6465  var(1)....    de
-0001b1b0: 6620 5f77 6172 6e69 6e67 5f77 696e 646f  f _warning_windo
-0001b1c0: 7728 7365 6c66 293a 0d0a 2020 2020 2020  w(self):..      
-0001b1d0: 2020 6465 6620 7777 5f63 6f6e 7465 7874    def ww_context
-0001b1e0: 5f6d 656e 7528 293a 0d0a 2020 2020 2020  _menu():..      
-0001b1f0: 2020 2020 2020 696d 6775 692e 7075 7368        imgui.push
-0001b200: 5f73 7479 6c65 5f63 6f6c 6f72 2869 6d67  _style_color(img
-0001b210: 7569 2e43 4f4c 4f52 5f50 4f50 5550 5f42  ui.COLOR_POPUP_B
-0001b220: 4143 4b47 524f 554e 442c 202a 6366 672e  ACKGROUND, *cfg.
-0001b230: 434f 4c4f 5552 5f4d 454e 555f 5749 4e44  COLOUR_MENU_WIND
-0001b240: 4f57 5f42 4143 4b47 524f 554e 4429 0d0a  OW_BACKGROUND)..
-0001b250: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-0001b260: 6d67 7569 2e62 6567 696e 5f70 6f70 7570  mgui.begin_popup
-0001b270: 5f63 6f6e 7465 7874 5f77 696e 646f 7728  _context_window(
-0001b280: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-0001b290: 2020 2020 6366 672e 6572 726f 725f 7769      cfg.error_wi
-0001b2a0: 6e64 6f77 5f61 6374 6976 6520 3d20 5472  ndow_active = Tr
-0001b2b0: 7565 0d0a 2020 2020 2020 2020 2020 2020  ue..            
-0001b2c0: 2020 2020 636f 7079 5f65 7272 6f72 2c20      copy_error, 
-0001b2d0: 5f20 3d20 696d 6775 692e 6d65 6e75 5f69  _ = imgui.menu_i
-0001b2e0: 7465 6d28 2243 6f70 7920 746f 2063 6c69  tem("Copy to cli
-0001b2f0: 7062 6f61 7264 2229 0d0a 2020 2020 2020  pboard")..      
-0001b300: 2020 2020 2020 2020 2020 6966 2063 6f70            if cop
-0001b310: 795f 6572 726f 723a 0d0a 2020 2020 2020  y_error:..      
-0001b320: 2020 2020 2020 2020 2020 2020 2020 7079                py
-0001b330: 7065 7263 6c69 702e 636f 7079 2863 6667  perclip.copy(cfg
-0001b340: 2e65 7272 6f72 5f6d 7367 290d 0a20 2020  .error_msg)..   
-0001b350: 2020 2020 2020 2020 2020 2020 2063 6f70               cop
-0001b360: 795f 7061 7468 5f74 6f5f 6c6f 672c 205f  y_path_to_log, _
-0001b370: 203d 2069 6d67 7569 2e6d 656e 755f 6974   = imgui.menu_it
-0001b380: 656d 2822 436f 7079 2070 6174 6820 746f  em("Copy path to
-0001b390: 2073 634e 6f64 6573 2e6c 6f67 2229 0d0a   scNodes.log")..
-0001b3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b3b0: 6966 2063 6f70 795f 7061 7468 5f74 6f5f  if copy_path_to_
-0001b3c0: 6c6f 673a 0d0a 2020 2020 2020 2020 2020  log:..          
-0001b3d0: 2020 2020 2020 2020 2020 7079 7065 7263            pyperc
-0001b3e0: 6c69 702e 636f 7079 286f 732e 7061 7468  lip.copy(os.path
-0001b3f0: 2e61 6273 7061 7468 2863 6667 2e6c 6f67  .abspath(cfg.log
-0001b400: 7061 7468 2929 0d0a 2020 2020 2020 2020  path))..        
-0001b410: 2020 2020 2020 2020 696d 6775 692e 656e          imgui.en
-0001b420: 645f 706f 7075 7028 290d 0a20 2020 2020  d_popup()..     
-0001b430: 2020 2020 2020 2069 6d67 7569 2e70 6f70         imgui.pop
-0001b440: 5f73 7479 6c65 5f63 6f6c 6f72 2831 290d  _style_color(1).
-0001b450: 0a20 2020 2020 2020 2023 2320 4572 726f  .        ## Erro
-0001b460: 7220 6d65 7373 6167 650d 0a20 2020 2020  r message..     
-0001b470: 2020 2069 6620 6366 672e 6572 726f 725f     if cfg.error_
-0001b480: 6d73 6720 6973 206e 6f74 204e 6f6e 653a  msg is not None:
-0001b490: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-0001b4a0: 2063 6667 2e65 7272 6f72 5f6e 6577 3a0d   cfg.error_new:.
-0001b4b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001b4c0: 2069 6d67 7569 2e70 7573 685f 7374 796c   imgui.push_styl
-0001b4d0: 655f 636f 6c6f 7228 696d 6775 692e 434f  e_color(imgui.CO
-0001b4e0: 4c4f 525f 5449 544c 455f 4241 434b 4752  LOR_TITLE_BACKGR
-0001b4f0: 4f55 4e44 2c20 2a63 6667 2e43 4f4c 4f55  OUND, *cfg.COLOU
-0001b500: 525f 4552 524f 525f 5749 4e44 4f57 5f48  R_ERROR_WINDOW_H
-0001b510: 4541 4445 525f 4e45 5729 0d0a 2020 2020  EADER_NEW)..    
-0001b520: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
-0001b530: 692e 7075 7368 5f73 7479 6c65 5f63 6f6c  i.push_style_col
-0001b540: 6f72 2869 6d67 7569 2e43 4f4c 4f52 5f54  or(imgui.COLOR_T
-0001b550: 4954 4c45 5f42 4143 4b47 524f 554e 445f  ITLE_BACKGROUND_
-0001b560: 4143 5449 5645 2c20 2a63 6667 2e43 4f4c  ACTIVE, *cfg.COL
-0001b570: 4f55 525f 4552 524f 525f 5749 4e44 4f57  OUR_ERROR_WINDOW
-0001b580: 5f48 4541 4445 525f 4e45 5729 0d0a 2020  _HEADER_NEW)..  
-0001b590: 2020 2020 2020 2020 2020 2020 2020 696d                im
-0001b5a0: 6775 692e 7075 7368 5f73 7479 6c65 5f63  gui.push_style_c
-0001b5b0: 6f6c 6f72 2869 6d67 7569 2e43 4f4c 4f52  olor(imgui.COLOR
-0001b5c0: 5f54 4954 4c45 5f42 4143 4b47 524f 554e  _TITLE_BACKGROUN
-0001b5d0: 445f 434f 4c4c 4150 5345 442c 202a 6366  D_COLLAPSED, *cf
-0001b5e0: 672e 434f 4c4f 5552 5f45 5252 4f52 5f57  g.COLOUR_ERROR_W
-0001b5f0: 494e 444f 575f 4845 4144 4552 5f4e 4557  INDOW_HEADER_NEW
-0001b600: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
-0001b610: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-0001b620: 2020 2020 2020 696d 6775 692e 7075 7368        imgui.push
-0001b630: 5f73 7479 6c65 5f63 6f6c 6f72 2869 6d67  _style_color(img
-0001b640: 7569 2e43 4f4c 4f52 5f54 4954 4c45 5f42  ui.COLOR_TITLE_B
-0001b650: 4143 4b47 524f 554e 442c 202a 6366 672e  ACKGROUND, *cfg.
-0001b660: 434f 4c4f 5552 5f45 5252 4f52 5f57 494e  COLOUR_ERROR_WIN
-0001b670: 444f 575f 4845 4144 4552 290d 0a20 2020  DOW_HEADER)..   
-0001b680: 2020 2020 2020 2020 2020 2020 2069 6d67               img
-0001b690: 7569 2e70 7573 685f 7374 796c 655f 636f  ui.push_style_co
-0001b6a0: 6c6f 7228 696d 6775 692e 434f 4c4f 525f  lor(imgui.COLOR_
-0001b6b0: 5449 544c 455f 4241 434b 4752 4f55 4e44  TITLE_BACKGROUND
-0001b6c0: 5f41 4354 4956 452c 202a 6366 672e 434f  _ACTIVE, *cfg.CO
-0001b6d0: 4c4f 5552 5f45 5252 4f52 5f57 494e 444f  LOUR_ERROR_WINDO
-0001b6e0: 575f 4845 4144 4552 290d 0a20 2020 2020  W_HEADER)..     
-0001b6f0: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
-0001b700: 2e70 7573 685f 7374 796c 655f 636f 6c6f  .push_style_colo
-0001b710: 7228 696d 6775 692e 434f 4c4f 525f 5449  r(imgui.COLOR_TI
-0001b720: 544c 455f 4241 434b 4752 4f55 4e44 5f43  TLE_BACKGROUND_C
-0001b730: 4f4c 4c41 5053 4544 2c20 2a63 6667 2e43  OLLAPSED, *cfg.C
-0001b740: 4f4c 4f55 525f 4552 524f 525f 5749 4e44  OLOUR_ERROR_WIND
-0001b750: 4f57 5f48 4541 4445 5229 0d0a 2020 2020  OW_HEADER)..    
-0001b760: 2020 2020 2020 2020 696d 6775 692e 7075          imgui.pu
-0001b770: 7368 5f73 7479 6c65 5f63 6f6c 6f72 2869  sh_style_color(i
-0001b780: 6d67 7569 2e43 4f4c 4f52 5f57 494e 444f  mgui.COLOR_WINDO
-0001b790: 575f 4241 434b 4752 4f55 4e44 2c20 2a63  W_BACKGROUND, *c
-0001b7a0: 6667 2e43 4f4c 4f55 525f 4552 524f 525f  fg.COLOUR_ERROR_
-0001b7b0: 5749 4e44 4f57 5f42 4143 4b47 524f 554e  WINDOW_BACKGROUN
-0001b7c0: 4429 0d0a 2020 2020 2020 2020 2020 2020  D)..            
-0001b7d0: 696d 6775 692e 7075 7368 5f73 7479 6c65  imgui.push_style
-0001b7e0: 5f63 6f6c 6f72 2869 6d67 7569 2e43 4f4c  _color(imgui.COL
-0001b7f0: 4f52 5f54 4558 542c 202a 6366 672e 434f  OR_TEXT, *cfg.CO
-0001b800: 4c4f 5552 5f45 5252 4f52 5f57 494e 444f  LOUR_ERROR_WINDO
-0001b810: 575f 5445 5854 290d 0a20 2020 2020 2020  W_TEXT)..       
-0001b820: 2020 2020 2069 6d67 7569 2e70 7573 685f       imgui.push_
-0001b830: 7374 796c 655f 7661 7228 696d 6775 692e  style_var(imgui.
-0001b840: 5354 594c 455f 5749 4e44 4f57 5f52 4f55  STYLE_WINDOW_ROU
-0001b850: 4e44 494e 472c 2033 2e30 290d 0a20 2020  NDING, 3.0)..   
-0001b860: 2020 2020 2020 2020 2069 6d67 7569 2e73           imgui.s
-0001b870: 6574 5f6e 6578 745f 7769 6e64 6f77 5f73  et_next_window_s
-0001b880: 697a 6528 7365 6c66 2e77 696e 646f 772e  ize(self.window.
-0001b890: 7769 6474 682c 2063 6667 2e45 5252 4f52  width, cfg.ERROR
-0001b8a0: 5f57 494e 444f 575f 4845 4947 4854 290d  _WINDOW_HEIGHT).
-0001b8b0: 0a20 2020 2020 2020 2020 2020 2077 696e  .            win
-0001b8c0: 646f 775f 7665 7274 6963 616c 5f6f 6666  dow_vertical_off
-0001b8d0: 7365 7420 3d20 3020 6966 2063 6667 2e65  set = 0 if cfg.e
-0001b8e0: 7272 6f72 5f77 696e 646f 775f 6163 7469  rror_window_acti
-0001b8f0: 7665 2065 6c73 6520 6366 672e 4552 524f  ve else cfg.ERRO
-0001b900: 525f 5749 4e44 4f57 5f48 4549 4748 5420  R_WINDOW_HEIGHT 
-0001b910: 2d20 3139 0d0a 2020 2020 2020 2020 2020  - 19..          
-0001b920: 2020 696d 6775 692e 7365 745f 6e65 7874    imgui.set_next
-0001b930: 5f77 696e 646f 775f 706f 7369 7469 6f6e  _window_position
-0001b940: 2830 2c20 7365 6c66 2e77 696e 646f 772e  (0, self.window.
-0001b950: 6865 6967 6874 202d 2063 6667 2e45 5252  height - cfg.ERR
-0001b960: 4f52 5f57 494e 444f 575f 4845 4947 4854  OR_WINDOW_HEIGHT
-0001b970: 202b 2077 696e 646f 775f 7665 7274 6963   + window_vertic
-0001b980: 616c 5f6f 6666 7365 7429 0d0a 2020 2020  al_offset)..    
-0001b990: 2020 2020 2020 2020 5f2c 2073 7461 795f          _, stay_
-0001b9a0: 6f70 656e 203d 2069 6d67 7569 2e62 6567  open = imgui.beg
-0001b9b0: 696e 2822 4e6f 7469 6669 6361 7469 6f6e  in("Notification
-0001b9c0: 222c 2054 7275 652c 2069 6d67 7569 2e57  ", True, imgui.W
-0001b9d0: 494e 444f 575f 4e4f 5f4d 4f56 4520 7c20  INDOW_NO_MOVE | 
-0001b9e0: 696d 6775 692e 5749 4e44 4f57 5f4e 4f5f  imgui.WINDOW_NO_
-0001b9f0: 5245 5349 5a45 207c 2069 6d67 7569 2e57  RESIZE | imgui.W
-0001ba00: 494e 444f 575f 4e4f 5f43 4f4c 4c41 5053  INDOW_NO_COLLAPS
-0001ba10: 4529 0d0a 2020 2020 2020 2020 2020 2020  E)..            
-0001ba20: 6966 2069 6d67 7569 2e69 735f 7769 6e64  if imgui.is_wind
-0001ba30: 6f77 5f66 6f63 7573 6564 2829 3a0d 0a20  ow_focused():.. 
-0001ba40: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-0001ba50: 6667 2e65 7272 6f72 5f77 696e 646f 775f  fg.error_window_
-0001ba60: 6163 7469 7665 203d 2054 7275 650d 0a20  active = True.. 
-0001ba70: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0001ba80: 6620 7365 6c66 2e77 696e 646f 772e 6765  f self.window.ge
-0001ba90: 745f 6d6f 7573 655f 6576 656e 7428 676c  t_mouse_event(gl
-0001baa0: 6677 2e4d 4f55 5345 5f42 5554 544f 4e5f  fw.MOUSE_BUTTON_
-0001bab0: 4c45 4654 2c20 676c 6677 2e50 5245 5353  LEFT, glfw.PRESS
-0001bac0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-0001bad0: 2020 2020 2020 2020 6366 672e 6572 726f          cfg.erro
-0001bae0: 725f 6e65 7720 3d20 4661 6c73 650d 0a20  r_new = False.. 
-0001baf0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-0001bb00: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001bb10: 2020 6366 672e 6572 726f 725f 7769 6e64    cfg.error_wind
-0001bb20: 6f77 5f61 6374 6976 6520 3d20 4661 6c73  ow_active = Fals
-0001bb30: 650d 0a20 2020 2020 2020 2020 2020 2069  e..            i
-0001bb40: 6620 6e6f 7420 6366 672e 6572 726f 725f  f not cfg.error_
-0001bb50: 6c6f 6767 6564 3a0d 0a20 2020 2020 2020  logged:..       
-0001bb60: 2020 2020 2020 2020 2063 6667 2e77 7269           cfg.wri
-0001bb70: 7465 5f74 6f5f 6c6f 6728 6366 672e 6572  te_to_log(cfg.er
-0001bb80: 726f 725f 6d73 6729 0d0a 2020 2020 2020  ror_msg)..      
-0001bb90: 2020 2020 2020 2020 2020 6366 672e 6572            cfg.er
-0001bba0: 726f 725f 6c6f 6767 6564 203d 2054 7275  ror_logged = Tru
-0001bbb0: 650d 0a20 2020 2020 2020 2020 2020 2069  e..            i
-0001bbc0: 6d67 7569 2e74 6578 7428 6366 672e 6572  mgui.text(cfg.er
-0001bbd0: 726f 725f 6d73 6729 0d0a 2020 2020 2020  ror_msg)..      
-0001bbe0: 2020 2020 2020 7777 5f63 6f6e 7465 7874        ww_context
-0001bbf0: 5f6d 656e 7528 290d 0a20 2020 2020 2020  _menu()..       
-0001bc00: 2020 2020 2069 6d67 7569 2e65 6e64 2829       imgui.end()
-0001bc10: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-0001bc20: 206e 6f74 2073 7461 795f 6f70 656e 3a0d   not stay_open:.
-0001bc30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001bc40: 2063 6667 2e65 7272 6f72 5f6d 7367 203d   cfg.error_msg =
-0001bc50: 204e 6f6e 650d 0a20 2020 2020 2020 2020   None..         
-0001bc60: 2020 2020 2020 2063 6667 2e65 7272 6f72         cfg.error
-0001bc70: 5f6e 6577 203d 2054 7275 650d 0a20 2020  _new = True..   
-0001bc80: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
-0001bc90: 6f70 5f73 7479 6c65 5f63 6f6c 6f72 2835  op_style_color(5
-0001bca0: 290d 0a20 2020 2020 2020 2020 2020 2069  )..            i
-0001bcb0: 6d67 7569 2e70 6f70 5f73 7479 6c65 5f76  mgui.pop_style_v
-0001bcc0: 6172 2831 290d 0a0d 0a20 2020 2064 6566  ar(1)....    def
-0001bcd0: 2070 6172 7365 5f61 7661 696c 6162 6c65   parse_available
-0001bce0: 5f66 6561 7475 7265 7328 7365 6c66 293a  _features(self):
-0001bcf0: 0d0a 2020 2020 2020 2020 2320 7570 6f6e  ..        # upon
-0001bd00: 206f 7065 6e69 6e67 204d 6f64 656c 7320   opening Models 
-0001bd10: 7461 622e 0d0a 2020 2020 2020 2020 7365  tab...        se
-0001bd20: 6c66 2e61 6c6c 5f66 6561 7475 7265 5f6e  lf.all_feature_n
-0001bd30: 616d 6573 203d 206c 6973 7428 290d 0a20  ames = list().. 
-0001bd40: 2020 2020 2020 2073 656c 662e 6665 6174         self.feat
-0001bd50: 7572 655f 636f 6c6f 7572 5f64 6963 7420  ure_colour_dict 
-0001bd60: 3d20 6469 6374 2829 0d0a 2020 2020 2020  = dict()..      
-0001bd70: 2020 666f 7220 7365 6620 696e 2063 6667    for sef in cfg
-0001bd80: 2e73 655f 6672 616d 6573 3a0d 0a20 2020  .se_frames:..   
-0001bd90: 2020 2020 2020 2020 2066 6f72 2066 7472           for ftr
-0001bda0: 2069 6e20 7365 662e 6665 6174 7572 6573   in sef.features
-0001bdb0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0001bdc0: 2020 2069 6620 7365 662e 7361 6d70 6c65     if sef.sample
-0001bdd0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0001bde0: 2020 2020 2020 2069 6620 6674 722e 7469         if ftr.ti
-0001bdf0: 746c 6520 6e6f 7420 696e 2073 656c 662e  tle not in self.
-0001be00: 616c 6c5f 6665 6174 7572 655f 6e61 6d65  all_feature_name
-0001be10: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
-0001be20: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001be30: 2e61 6c6c 5f66 6561 7475 7265 5f6e 616d  .all_feature_nam
-0001be40: 6573 2e61 7070 656e 6428 6674 722e 7469  es.append(ftr.ti
-0001be50: 746c 6529 0d0a 2020 2020 2020 2020 2020  tle)..          
-0001be60: 2020 2020 2020 2020 2020 6966 2066 7472            if ftr
-0001be70: 2e74 6974 6c65 206e 6f74 2069 6e20 7365  .title not in se
-0001be80: 6c66 2e74 7261 696e 7365 745f 6665 6174  lf.trainset_feat
-0001be90: 7572 655f 7365 6c65 6374 696f 6e3a 0d0a  ure_selection:..
-0001bea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001beb0: 2020 2020 2020 2020 7365 6c66 2e74 7261          self.tra
-0001bec0: 696e 7365 745f 6665 6174 7572 655f 7365  inset_feature_se
-0001bed0: 6c65 6374 696f 6e5b 6674 722e 7469 746c  lection[ftr.titl
-0001bee0: 655d 203d 2030 2e30 0d0a 2020 2020 2020  e] = 0.0..      
-0001bef0: 2020 2020 2020 2020 2020 6966 2066 7472            if ftr
-0001bf00: 2e74 6974 6c65 206e 6f74 2069 6e20 7365  .title not in se
-0001bf10: 6c66 2e66 6561 7475 7265 5f63 6f6c 6f75  lf.feature_colou
-0001bf20: 725f 6469 6374 3a0d 0a20 2020 2020 2020  r_dict:..       
-0001bf30: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0001bf40: 662e 6665 6174 7572 655f 636f 6c6f 7572  f.feature_colour
-0001bf50: 5f64 6963 745b 6674 722e 7469 746c 655d  _dict[ftr.title]
-0001bf60: 203d 2066 7472 2e63 6f6c 6f75 720d 0a20   = ftr.colour.. 
-0001bf70: 2020 2020 2020 2074 6f5f 706f 7020 3d20         to_pop = 
-0001bf80: 6c69 7374 2829 0d0a 2020 2020 2020 2020  list()..        
-0001bf90: 666f 7220 6b65 7920 696e 2073 656c 662e  for key in self.
-0001bfa0: 7472 6169 6e73 6574 5f66 6561 7475 7265  trainset_feature
-0001bfb0: 5f73 656c 6563 7469 6f6e 2e6b 6579 7328  _selection.keys(
-0001bfc0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-0001bfd0: 6966 206b 6579 206e 6f74 2069 6e20 7365  if key not in se
-0001bfe0: 6c66 2e61 6c6c 5f66 6561 7475 7265 5f6e  lf.all_feature_n
-0001bff0: 616d 6573 3a0d 0a20 2020 2020 2020 2020  ames:..         
-0001c000: 2020 2020 2020 2074 6f5f 706f 702e 6170         to_pop.ap
-0001c010: 7065 6e64 286b 6579 290d 0a20 2020 2020  pend(key)..     
-0001c020: 2020 2066 6f72 206b 6579 2069 6e20 746f     for key in to
-0001c030: 5f70 6f70 3a0d 0a20 2020 2020 2020 2020  _pop:..         
-0001c040: 2020 2073 656c 662e 7472 6169 6e73 6574     self.trainset
-0001c050: 5f66 6561 7475 7265 5f73 656c 6563 7469  _feature_selecti
-0001c060: 6f6e 2e70 6f70 286b 6579 290d 0a0d 0a20  on.pop(key).... 
-0001c070: 2020 2064 6566 205f 6775 695f 6261 636b     def _gui_back
-0001c080: 6772 6f75 6e64 5f70 726f 6365 7373 5f70  ground_process_p
-0001c090: 726f 6772 6573 735f 6261 7228 7365 6c66  rogress_bar(self
-0001c0a0: 2c20 7072 6f63 6573 732c 2063 6f6c 6f75  , process, colou
-0001c0b0: 723d 6366 672e 434f 4c4f 5552 5f50 4f53  r=cfg.COLOUR_POS
-0001c0c0: 4954 4956 452c 2063 616e 6365 6c6c 6162  ITIVE, cancellab
-0001c0d0: 6c65 3d46 616c 7365 2c20 6865 6967 6874  le=False, height
-0001c0e0: 3d4e 6f6e 652c 2074 7261 6e73 7061 7265  =None, transpare
-0001c0f0: 6e74 5f62 6163 6b67 726f 756e 643d 4661  nt_background=Fa
-0001c100: 6c73 6529 3a0d 0a20 2020 2020 2020 2068  lse):..        h
-0001c110: 6569 6768 7420 3d20 5365 676d 656e 7461  eight = Segmenta
-0001c120: 7469 6f6e 4564 6974 6f72 2e50 524f 4752  tionEditor.PROGR
-0001c130: 4553 535f 4241 525f 4845 4947 4854 2069  ESS_BAR_HEIGHT i
-0001c140: 6620 6865 6967 6874 2069 7320 4e6f 6e65  f height is None
-0001c150: 2065 6c73 6520 6865 6967 6874 0d0a 2020   else height..  
-0001c160: 2020 2020 2020 6377 203d 2069 6d67 7569        cw = imgui
-0001c170: 2e67 6574 5f63 6f6e 7465 6e74 5f72 6567  .get_content_reg
-0001c180: 696f 6e5f 6176 6169 6c61 626c 655f 7769  ion_available_wi
-0001c190: 6474 6828 290d 0a20 2020 2020 2020 2063  dth()..        c
-0001c1a0: 616e 6365 6c5f 6275 7474 6f6e 5f77 203d  ancel_button_w =
-0001c1b0: 2053 6567 6d65 6e74 6174 696f 6e45 6469   SegmentationEdi
-0001c1c0: 746f 722e 5052 4f47 5245 5353 5f42 4152  tor.PROGRESS_BAR
-0001c1d0: 5f48 4549 4748 5420 2b20 3520 6966 2063  _HEIGHT + 5 if c
-0001c1e0: 616e 6365 6c6c 6162 6c65 2065 6c73 6520  ancellable else 
-0001c1f0: 300d 0a20 2020 2020 2020 206f 7269 6769  0..        origi
-0001c200: 6e20 3d20 696d 6775 692e 6765 745f 7769  n = imgui.get_wi
-0001c210: 6e64 6f77 5f70 6f73 6974 696f 6e28 290d  ndow_position().
-0001c220: 0a20 2020 2020 2020 2079 203d 2069 6d67  .        y = img
-0001c230: 7569 2e67 6574 5f63 7572 736f 725f 7363  ui.get_cursor_sc
-0001c240: 7265 656e 5f70 6f73 2829 5b31 5d0d 0a20  reen_pos()[1].. 
-0001c250: 2020 2020 2020 2064 7261 776c 6973 7420         drawlist 
-0001c260: 3d20 696d 6775 692e 6765 745f 7769 6e64  = imgui.get_wind
-0001c270: 6f77 5f64 7261 775f 6c69 7374 2829 0d0a  ow_draw_list()..
-0001c280: 2020 2020 2020 2020 6472 6177 6c69 7374          drawlist
-0001c290: 2e61 6464 5f72 6563 745f 6669 6c6c 6564  .add_rect_filled
-0001c2a0: 2838 202b 206f 7269 6769 6e5b 305d 2c20  (8 + origin[0], 
-0001c2b0: 792c 0d0a 2020 2020 2020 2020 2020 2020  y,..            
-0001c2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c2d0: 2020 2020 2038 202b 206f 7269 6769 6e5b       8 + origin[
-0001c2e0: 305d 202b 206d 6178 2830 2c20 6377 202d  0] + max(0, cw -
-0001c2f0: 2063 616e 6365 6c5f 6275 7474 6f6e 5f77   cancel_button_w
-0001c300: 292c 0d0a 2020 2020 2020 2020 2020 2020  ),..            
-0001c310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c320: 2020 2020 2079 202b 2068 6569 6768 742c       y + height,
-0001c330: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001c340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c350: 2020 2069 6d67 7569 2e67 6574 5f63 6f6c     imgui.get_col
-0001c360: 6f72 5f75 3332 5f72 6762 6128 2a63 6667  or_u32_rgba(*cfg
-0001c370: 2e43 4f4c 4f55 525f 4e45 5554 5241 4c29  .COLOUR_NEUTRAL)
-0001c380: 2069 6620 6e6f 7420 7472 616e 7370 6172   if not transpar
-0001c390: 656e 745f 6261 636b 6772 6f75 6e64 2065  ent_background e
-0001c3a0: 6c73 6520 696d 6775 692e 6765 745f 636f  lse imgui.get_co
-0001c3b0: 6c6f 725f 7533 325f 7267 6261 2830 2e30  lor_u32_rgba(0.0
-0001c3c0: 2c20 302e 302c 2030 2e30 2c20 302e 3029  , 0.0, 0.0, 0.0)
-0001c3d0: 290d 0a20 2020 2020 2020 2064 7261 776c  )..        drawl
-0001c3e0: 6973 742e 6164 645f 7265 6374 5f66 696c  ist.add_rect_fil
-0001c3f0: 6c65 6428 3820 2b20 6f72 6967 696e 5b30  led(8 + origin[0
-0001c400: 5d2c 2079 2c0d 0a20 2020 2020 2020 2020  ], y,..         
-0001c410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c420: 2020 2020 2020 2020 3820 2b20 6f72 6967          8 + orig
-0001c430: 696e 5b30 5d20 2b20 6d61 7828 302c 2063  in[0] + max(0, c
-0001c440: 7720 2a20 6d69 6e28 5b31 2e30 2c20 7072  w * min([1.0, pr
-0001c450: 6f63 6573 732e 7072 6f67 7265 7373 5d29  ocess.progress])
-0001c460: 202d 2063 616e 6365 6c5f 6275 7474 6f6e   - cancel_button
-0001c470: 5f77 292c 0d0a 2020 2020 2020 2020 2020  _w),..          
-0001c480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c490: 2020 2020 2020 2079 202b 2068 6569 6768         y + heigh
-0001c4a0: 742c 0d0a 2020 2020 2020 2020 2020 2020  t,..            
+0001a140: 2066 7261 6d65 5f78 7920 3d20 662e 7061   frame_xy = f.pa
+0001a150: 7265 6e74 2e74 7261 6e73 666f 726d 2e74  rent.transform.t
+0001a160: 7261 6e73 6c61 7469 6f6e 0d0a 2020 2020  ranslation..    
+0001a170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a180: 6966 2066 2e73 686f 775f 626f 7865 7320  if f.show_boxes 
+0001a190: 616e 6420 6e6f 7420 662e 6869 6465 2061  and not f.hide a
+0001a1a0: 6e64 2066 2e63 7572 7265 6e74 5f73 6c69  nd f.current_sli
+0001a1b0: 6365 2069 6e20 662e 626f 7865 733a 0d0a  ce in f.boxes:..
+0001a1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a1d0: 2020 2020 2020 2020 666f 7220 626f 7820          for box 
+0001a1e0: 696e 2066 2e62 6f78 6573 5b66 2e63 7572  in f.boxes[f.cur
+0001a1f0: 7265 6e74 5f73 6c69 6365 5d3a 0d0a 2020  rent_slice]:..  
+0001a200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a210: 2020 2020 2020 2020 2020 626f 785f 785f            box_x_
+0001a220: 706f 7320 3d20 6672 616d 655f 7879 5b30  pos = frame_xy[0
+0001a230: 5d20 2b20 2862 6f78 5b30 5d20 2d20 662e  ] + (box[0] - f.
+0001a240: 7061 7265 6e74 2e77 6964 7468 202f 2032  parent.width / 2
+0001a250: 2920 2a20 662e 7061 7265 6e74 2e70 6978  ) * f.parent.pix
+0001a260: 656c 5f73 697a 650d 0a20 2020 2020 2020  el_size..       
+0001a270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a280: 2020 2020 2062 6f78 5f79 5f70 6f73 203d       box_y_pos =
+0001a290: 2066 7261 6d65 5f78 795b 315d 202b 2028   frame_xy[1] + (
+0001a2a0: 626f 785b 315d 202d 2066 2e70 6172 656e  box[1] - f.paren
+0001a2b0: 742e 6865 6967 6874 202f 2032 2920 2a20  t.height / 2) * 
+0001a2c0: 662e 7061 7265 6e74 2e70 6978 656c 5f73  f.parent.pixel_s
+0001a2d0: 697a 650d 0a20 2020 2020 2020 2020 2020  ize..           
+0001a2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a2f0: 2053 6567 6d65 6e74 6174 696f 6e45 6469   SegmentationEdi
+0001a300: 746f 722e 7265 6e64 6572 6572 2e61 6464  tor.renderer.add
+0001a310: 5f73 7175 6172 6528 2862 6f78 5f78 5f70  _square((box_x_p
+0001a320: 6f73 2c20 626f 785f 795f 706f 7329 2c20  os, box_y_pos), 
+0001a330: 662e 626f 785f 7369 7a65 5f6e 6d2c 2066  f.box_size_nm, f
+0001a340: 2e63 6f6c 6f75 7229 0d0a 2020 2020 2020  .colour)..      
+0001a350: 2020 2020 2020 6966 2073 656c 662e 6163        if self.ac
+0001a360: 7469 7665 5f74 6162 2069 6e20 5b22 4d6f  tive_tab in ["Mo
+0001a370: 6465 6c73 222c 2022 4578 706f 7274 225d  dels", "Export"]
+0001a380: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0001a390: 2020 2053 6567 6d65 6e74 6174 696f 6e45     SegmentationE
+0001a3a0: 6469 746f 722e 7265 6e64 6572 6572 2e72  ditor.renderer.r
+0001a3b0: 656e 6465 725f 6d6f 6465 6c73 2863 6667  ender_models(cfg
+0001a3c0: 2e73 655f 6163 7469 7665 5f66 7261 6d65  .se_active_frame
+0001a3d0: 2c20 7365 6c66 2e63 616d 6572 6129 0d0a  , self.camera)..
+0001a3e0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+0001a3f0: 656c 662e 6163 7469 7665 5f74 6162 203d  elf.active_tab =
+0001a400: 3d20 224d 6f64 656c 7322 2061 6e64 2073  = "Models" and s
+0001a410: 656c 662e 7368 6f77 5f74 7261 696e 7365  elf.show_trainse
+0001a420: 745f 626f 7865 733a 0d0a 2020 2020 2020  t_boxes:..      
+0001a430: 2020 2020 2020 2020 2020 666f 7220 6620            for f 
+0001a440: 696e 2063 6667 2e73 655f 6163 7469 7665  in cfg.se_active
+0001a450: 5f66 7261 6d65 2e66 6561 7475 7265 733a  _frame.features:
+0001a460: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001a470: 2020 2020 2020 6672 616d 655f 7879 203d        frame_xy =
+0001a480: 2066 2e70 6172 656e 742e 7472 616e 7366   f.parent.transf
+0001a490: 6f72 6d2e 7472 616e 736c 6174 696f 6e0d  orm.translation.
+0001a4a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001a4b0: 2020 2020 2069 6620 662e 6375 7272 656e       if f.curren
+0001a4c0: 745f 736c 6963 6520 696e 2066 2e62 6f78  t_slice in f.box
+0001a4d0: 6573 2061 6e64 2066 2e74 6974 6c65 2069  es and f.title i
+0001a4e0: 6e20 7365 6c66 2e74 7261 696e 7365 745f  n self.trainset_
+0001a4f0: 6665 6174 7572 655f 7365 6c65 6374 696f  feature_selectio
+0001a500: 6e3a 0d0a 2020 2020 2020 2020 2020 2020  n:..            
+0001a510: 2020 2020 2020 2020 2020 2020 7376 616c              sval
+0001a520: 203d 2073 656c 662e 7472 6169 6e73 6574   = self.trainset
+0001a530: 5f66 6561 7475 7265 5f73 656c 6563 7469  _feature_selecti
+0001a540: 6f6e 5b66 2e74 6974 6c65 5d0d 0a20 2020  on[f.title]..   
+0001a550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a560: 2020 2020 2069 6620 7376 616c 203d 3d20       if sval == 
+0001a570: 302e 303a 0d0a 2020 2020 2020 2020 2020  0.0:..          
+0001a580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a590: 2020 636f 6e74 696e 7565 0d0a 2020 2020    continue..    
+0001a5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a5b0: 2020 2020 636c 7220 3d20 6366 672e 434f      clr = cfg.CO
+0001a5c0: 4c4f 5552 5f50 4f53 4954 4956 4520 6966  LOUR_POSITIVE if
+0001a5d0: 2073 7661 6c20 3d3d 2031 2e30 2065 6c73   sval == 1.0 els
+0001a5e0: 6520 6366 672e 434f 4c4f 5552 5f4e 4547  e cfg.COLOUR_NEG
+0001a5f0: 4154 4956 450d 0a20 2020 2020 2020 2020  ATIVE..         
+0001a600: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0001a610: 6f72 2062 6f78 2069 6e20 662e 626f 7865  or box in f.boxe
+0001a620: 735b 662e 6375 7272 656e 745f 736c 6963  s[f.current_slic
+0001a630: 655d 3a0d 0a20 2020 2020 2020 2020 2020  e]:..           
+0001a640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a650: 2062 6f78 5f78 5f70 6f73 203d 2066 7261   box_x_pos = fra
+0001a660: 6d65 5f78 795b 305d 202b 2028 626f 785b  me_xy[0] + (box[
+0001a670: 305d 202d 2066 2e70 6172 656e 742e 7769  0] - f.parent.wi
+0001a680: 6474 6820 2f20 3229 202a 2066 2e70 6172  dth / 2) * f.par
+0001a690: 656e 742e 7069 7865 6c5f 7369 7a65 0d0a  ent.pixel_size..
+0001a6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a6b0: 2020 2020 2020 2020 2020 2020 626f 785f              box_
+0001a6c0: 795f 706f 7320 3d20 6672 616d 655f 7879  y_pos = frame_xy
+0001a6d0: 5b31 5d20 2b20 2862 6f78 5b31 5d20 2d20  [1] + (box[1] - 
+0001a6e0: 662e 7061 7265 6e74 2e68 6569 6768 7420  f.parent.height 
+0001a6f0: 2f20 3229 202a 2066 2e70 6172 656e 742e  / 2) * f.parent.
+0001a700: 7069 7865 6c5f 7369 7a65 0d0a 2020 2020  pixel_size..    
+0001a710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a720: 2020 2020 2020 2020 626f 785f 7369 7a65          box_size
+0001a730: 203d 2053 6567 6d65 6e74 6174 696f 6e45   = SegmentationE
+0001a740: 6469 746f 722e 7472 6169 6e73 6574 5f61  ditor.trainset_a
+0001a750: 7069 7820 2a20 7365 6c66 2e74 7261 696e  pix * self.train
+0001a760: 7365 745f 626f 7873 697a 6520 2f20 3130  set_boxsize / 10
+0001a770: 2e30 0d0a 2020 2020 2020 2020 2020 2020  .0..            
+0001a780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a790: 5365 676d 656e 7461 7469 6f6e 4564 6974  SegmentationEdit
+0001a7a0: 6f72 2e72 656e 6465 7265 722e 6164 645f  or.renderer.add_
+0001a7b0: 7371 7561 7265 2828 626f 785f 785f 706f  square((box_x_po
+0001a7c0: 732c 2062 6f78 5f79 5f70 6f73 292c 2062  s, box_y_pos), b
+0001a7d0: 6f78 5f73 697a 652c 2063 6c72 290d 0a20  ox_size, clr).. 
+0001a7e0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+0001a7f0: 6c66 2e61 6374 6976 655f 7461 6220 213d  lf.active_tab !=
+0001a800: 2022 5265 6e64 6572 223a 0d0a 2020 2020   "Render":..    
+0001a810: 2020 2020 2020 2020 2020 2020 6f76 6572              over
+0001a820: 6c61 795f 626c 656e 645f 6d6f 6465 203d  lay_blend_mode =
+0001a830: 2053 6567 6d65 6e74 6174 696f 6e45 6469   SegmentationEdi
+0001a840: 746f 722e 424c 454e 445f 4d4f 4445 535b  tor.BLEND_MODES[
+0001a850: 5365 676d 656e 7461 7469 6f6e 4564 6974  SegmentationEdit
+0001a860: 6f72 2e42 4c45 4e44 5f4d 4f44 4553 5f4c  or.BLEND_MODES_L
+0001a870: 4953 545b 5365 676d 656e 7461 7469 6f6e  IST[Segmentation
+0001a880: 4564 6974 6f72 2e4f 5645 524c 4159 5f42  Editor.OVERLAY_B
+0001a890: 4c45 4e44 5f4d 4f44 455d 5d0d 0a20 2020  LEND_MODE]]..   
+0001a8a0: 2020 2020 2020 2020 2020 2020 2053 6567               Seg
+0001a8b0: 6d65 6e74 6174 696f 6e45 6469 746f 722e  mentationEditor.
+0001a8c0: 7265 6e64 6572 6572 2e72 656e 6465 725f  renderer.render_
+0001a8d0: 6f76 6572 6c61 7928 6366 672e 7365 5f61  overlay(cfg.se_a
+0001a8e0: 6374 6976 655f 6672 616d 652c 2073 656c  ctive_frame, sel
+0001a8f0: 662e 6361 6d65 7261 2c20 6f76 6572 6c61  f.camera, overla
+0001a900: 795f 626c 656e 645f 6d6f 6465 2c20 5365  y_blend_mode, Se
+0001a910: 676d 656e 7461 7469 6f6e 4564 6974 6f72  gmentationEditor
+0001a920: 2e4f 5645 524c 4159 5f41 4c50 4841 290d  .OVERLAY_ALPHA).
+0001a930: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+0001a940: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+0001a950: 2020 2020 6966 2053 6567 6d65 6e74 6174      if Segmentat
+0001a960: 696f 6e45 6469 746f 722e 5245 4e44 4552  ionEditor.RENDER
+0001a970: 5f42 4f58 3a0d 0a20 2020 2020 2020 2020  _BOX:..         
+0001a980: 2020 2020 2020 2020 2020 2023 2052 656e             # Ren
+0001a990: 6465 7220 3344 2062 6f78 2061 726f 756e  der 3D box aroun
+0001a9a0: 6420 7468 6520 766f 6c75 6d65 0d0a 2020  d the volume..  
+0001a9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a9c0: 2020 7365 6c66 2e72 656e 6465 7265 722e    self.renderer.
+0001a9d0: 7265 6e64 6572 5f6c 696e 655f 7661 2873  render_line_va(s
+0001a9e0: 656c 662e 7069 636b 5f62 6f78 5f76 612c  elf.pick_box_va,
+0001a9f0: 2073 656c 662e 6361 6d65 7261 3364 290d   self.camera3d).
+0001aa00: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+0001aa10: 2020 2023 2052 656e 6465 7220 6c69 6e65     # Render line
+0001aa20: 7320 616c 6f6e 6720 6564 6765 7320 6f66  s along edges of
+0001aa30: 2066 7261 6d65 0d0a 2020 2020 2020 2020   frame..        
+0001aa40: 2020 2020 2020 2020 7365 6c66 2e72 656e          self.ren
+0001aa50: 6465 7265 722e 7265 6e64 6572 5f66 7261  derer.render_fra
+0001aa60: 6d65 5f62 6f72 6465 7228 6366 672e 7365  me_border(cfg.se
+0001aa70: 5f61 6374 6976 655f 6672 616d 652c 2073  _active_frame, s
+0001aa80: 656c 662e 6361 6d65 7261 3364 290d 0a0d  elf.camera3d)...
+0001aa90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001aaa0: 2023 2052 656e 6465 7220 7375 7266 6163   # Render surfac
+0001aab0: 6520 6d6f 6465 6c73 2069 6e20 3344 0d0a  e models in 3D..
+0001aac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001aad0: 6966 206e 6f74 2069 6d67 7569 2e69 735f  if not imgui.is_
+0001aae0: 6b65 795f 646f 776e 2867 6c66 772e 4b45  key_down(glfw.KE
+0001aaf0: 595f 5129 3a0d 0a20 2020 2020 2020 2020  Y_Q):..         
+0001ab00: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001ab10: 7265 6e64 6572 6572 2e72 656e 6465 725f  renderer.render_
+0001ab20: 7375 7266 6163 655f 6d6f 6465 6c73 2863  surface_models(c
+0001ab30: 6667 2e73 655f 7375 7266 6163 655f 6d6f  fg.se_surface_mo
+0001ab40: 6465 6c73 2c20 7365 6c66 2e63 616d 6572  dels, self.camer
+0001ab50: 6133 642c 2053 6567 6d65 6e74 6174 696f  a3d, Segmentatio
+0001ab60: 6e45 6469 746f 722e 4c49 4748 545f 414d  nEditor.LIGHT_AM
+0001ab70: 4249 454e 545f 5354 5245 4e47 5448 2c20  BIENT_STRENGTH, 
+0001ab80: 5365 676d 656e 7461 7469 6f6e 4564 6974  SegmentationEdit
+0001ab90: 6f72 2e4c 4947 4854 5f53 504f 5429 0d0a  or.LIGHT_SPOT)..
+0001aba0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001abb0: 2020 2320 5265 6e64 6572 2074 6865 2066    # Render the f
+0001abc0: 7261 6d65 0d0a 2020 2020 2020 2020 2020  rame..          
+0001abd0: 2020 2020 2020 7078 6420 3d20 5365 676d        pxd = Segm
+0001abe0: 656e 7461 7469 6f6e 4564 6974 6f72 2e72  entationEditor.r
+0001abf0: 656e 6465 7265 722e 7265 6e64 6572 5f66  enderer.render_f
+0001ac00: 696c 7465 7265 645f 6672 616d 6528 6366  iltered_frame(cf
+0001ac10: 672e 7365 5f61 6374 6976 655f 6672 616d  g.se_active_fram
+0001ac20: 652c 2073 656c 662e 6361 6d65 7261 2c20  e, self.camera, 
+0001ac30: 7365 6c66 2e77 696e 646f 772c 2073 656c  self.window, sel
+0001ac40: 662e 6669 6c74 6572 732c 2063 616d 6572  f.filters, camer
+0001ac50: 6133 643d 7365 6c66 2e63 616d 6572 6133  a3d=self.camera3
+0001ac60: 6429 0d0a 2020 2020 2020 2020 2020 2020  d)..            
+0001ac70: 2020 2020 6966 2070 7864 2069 7320 6e6f      if pxd is no
+0001ac80: 7420 4e6f 6e65 3a0d 0a20 2020 2020 2020  t None:..       
+0001ac90: 2020 2020 2020 2020 2020 2020 2063 6667               cfg
+0001aca0: 2e73 655f 6163 7469 7665 5f66 7261 6d65  .se_active_frame
+0001acb0: 2e72 656e 6465 7265 645f 6461 7461 203d  .rendered_data =
+0001acc0: 2070 7864 0d0a 2020 2020 2020 2020 2020   pxd..          
+0001acd0: 2020 2020 2020 2020 2020 6366 672e 7365            cfg.se
+0001ace0: 5f61 6374 6976 655f 6672 616d 652e 7570  _active_frame.up
+0001acf0: 6461 7465 5f69 6d61 6765 5f74 6578 7475  date_image_textu
+0001ad00: 7265 2829 0d0a 2020 2020 2020 2020 2020  re()..          
+0001ad10: 2020 2020 2020 2020 2020 6366 672e 7365            cfg.se
+0001ad20: 5f61 6374 6976 655f 6672 616d 652e 636f  _active_frame.co
+0001ad30: 6d70 7574 655f 6869 7374 6f67 7261 6d28  mpute_histogram(
+0001ad40: 7078 6429 0d0a 2020 2020 2020 2020 2020  pxd)..          
+0001ad50: 2020 2020 2020 2020 2020 6966 2063 6667            if cfg
+0001ad60: 2e73 655f 6163 7469 7665 5f66 7261 6d65  .se_active_frame
+0001ad70: 2e61 7574 6f63 6f6e 7472 6173 743a 0d0a  .autocontrast:..
+0001ad80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ad90: 2020 2020 2020 2020 6366 672e 7365 5f61          cfg.se_a
+0001ada0: 6374 6976 655f 6672 616d 652e 636f 6d70  ctive_frame.comp
+0001adb0: 7574 655f 6175 746f 636f 6e74 7261 7374  ute_autocontrast
+0001adc0: 284e 6f6e 652c 2070 7864 290d 0a20 2020  (None, pxd)..   
+0001add0: 2020 2020 2020 2020 2020 2020 2053 6567               Seg
+0001ade0: 6d65 6e74 6174 696f 6e45 6469 746f 722e  mentationEditor.
+0001adf0: 4652 414d 455f 5445 5854 5552 455f 5245  FRAME_TEXTURE_RE
+0001ae00: 5155 4952 4553 5f55 5044 4154 4520 3d20  QUIRES_UPDATE = 
+0001ae10: 4661 6c73 650d 0a0d 0a20 2020 2020 2020  False....       
+0001ae20: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
+0001ae30: 696d 6775 692e 6973 5f6b 6579 5f64 6f77  imgui.is_key_dow
+0001ae40: 6e28 676c 6677 2e4b 4559 5f51 293a 0d0a  n(glfw.KEY_Q):..
+0001ae50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ae60: 2020 2020 7365 6c66 2e72 656e 6465 7265      self.rendere
+0001ae70: 722e 7265 6e64 6572 5f73 7572 6661 6365  r.render_surface
+0001ae80: 5f6d 6f64 656c 5f70 6172 7469 636c 6573  _model_particles
+0001ae90: 2863 6667 2e73 655f 7375 7266 6163 655f  (cfg.se_surface_
+0001aea0: 6d6f 6465 6c73 2c20 7365 6c66 2e63 616d  models, self.cam
+0001aeb0: 6572 6133 6429 0d0a 0d0a 2020 2020 2020  era3d)....      
+0001aec0: 2020 2020 2020 2020 2020 2320 5265 6e64            # Rend
+0001aed0: 6572 206f 7665 726c 6179 2c20 6966 2070  er overlay, if p
+0001aee0: 6f73 7369 626c 653a 0d0a 2020 2020 2020  ossible:..      
+0001aef0: 2020 2020 2020 2020 2020 6966 2063 6667            if cfg
+0001af00: 2e73 655f 6163 7469 7665 5f66 7261 6d65  .se_active_frame
+0001af10: 2e6f 7665 726c 6179 2069 7320 6e6f 7420  .overlay is not 
+0001af20: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
+0001af30: 2020 2020 2020 2020 2020 2069 6620 5365             if Se
+0001af40: 676d 656e 7461 7469 6f6e 4564 6974 6f72  gmentationEditor
+0001af50: 2e56 4945 575f 5245 5155 4952 4553 5f55  .VIEW_REQUIRES_U
+0001af60: 5044 4154 453a 0d0a 2020 2020 2020 2020  PDATE:..        
+0001af70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001af80: 7365 6c66 2e72 656e 6465 7265 722e 7261  self.renderer.ra
+0001af90: 795f 7472 6163 655f 6f76 6572 6c61 7928  y_trace_overlay(
+0001afa0: 2873 656c 662e 7769 6e64 6f77 2e77 6964  (self.window.wid
+0001afb0: 7468 2c20 7365 6c66 2e77 696e 646f 772e  th, self.window.
+0001afc0: 6865 6967 6874 292c 2063 6667 2e73 655f  height), cfg.se_
+0001afd0: 6163 7469 7665 5f66 7261 6d65 2c20 7365  active_frame, se
+0001afe0: 6c66 2e63 616d 6572 6133 642c 2073 656c  lf.camera3d, sel
+0001aff0: 662e 7069 636b 5f62 6f78 5f71 7561 645f  f.pick_box_quad_
+0001b000: 7661 290d 0a20 2020 2020 2020 2020 2020  va)..           
+0001b010: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+0001b020: 2e70 6963 6b5f 6f76 6572 6c61 795f 3364  .pick_overlay_3d
+0001b030: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0001b040: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001b050: 7265 6e64 6572 6572 2e72 656e 6465 725f  renderer.render_
+0001b060: 6f76 6572 6c61 795f 3364 2853 6567 6d65  overlay_3d(Segme
+0001b070: 6e74 6174 696f 6e45 6469 746f 722e 4f56  ntationEditor.OV
+0001b080: 4552 4c41 595f 414c 5048 412c 2053 6567  ERLAY_ALPHA, Seg
+0001b090: 6d65 6e74 6174 696f 6e45 6469 746f 722e  mentationEditor.
+0001b0a0: 4f56 4552 4c41 595f 494e 5445 4e53 4954  OVERLAY_INTENSIT
+0001b0b0: 5929 0d0a 2020 2020 2020 2020 2020 2020  Y)..            
+0001b0c0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+0001b0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b0e0: 2020 2020 2020 206f 7665 726c 6179 5f62         overlay_b
+0001b0f0: 6c65 6e64 5f6d 6f64 6520 3d20 5365 676d  lend_mode = Segm
+0001b100: 656e 7461 7469 6f6e 4564 6974 6f72 2e42  entationEditor.B
+0001b110: 4c45 4e44 5f4d 4f44 4553 5b53 6567 6d65  LEND_MODES[Segme
+0001b120: 6e74 6174 696f 6e45 6469 746f 722e 424c  ntationEditor.BL
+0001b130: 454e 445f 4d4f 4445 535f 4c49 5354 5b53  END_MODES_LIST[S
+0001b140: 6567 6d65 6e74 6174 696f 6e45 6469 746f  egmentationEdito
+0001b150: 722e 4f56 4552 4c41 595f 424c 454e 445f  r.OVERLAY_BLEND_
+0001b160: 4d4f 4445 5d5d 0d0a 2020 2020 2020 2020  MODE]]..        
+0001b170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b180: 7365 6c66 2e72 656e 6465 7265 722e 7265  self.renderer.re
+0001b190: 6e64 6572 5f6f 7665 726c 6179 2863 6667  nder_overlay(cfg
+0001b1a0: 2e73 655f 6163 7469 7665 5f66 7261 6d65  .se_active_frame
+0001b1b0: 2c20 7365 6c66 2e63 616d 6572 6133 642c  , self.camera3d,
+0001b1c0: 206f 7665 726c 6179 5f62 6c65 6e64 5f6d   overlay_blend_m
+0001b1d0: 6f64 652c 2053 6567 6d65 6e74 6174 696f  ode, Segmentatio
+0001b1e0: 6e45 6469 746f 722e 4f56 4552 4c41 595f  nEditor.OVERLAY_
+0001b1f0: 414c 5048 4129 0d0a 2020 2020 2020 2020  ALPHA)..        
+0001b200: 2320 4d41 494e 2057 494e 444f 570d 0a20  # MAIN WINDOW.. 
+0001b210: 2020 2020 2020 2069 6d67 7569 2e73 6574         imgui.set
+0001b220: 5f6e 6578 745f 7769 6e64 6f77 5f70 6f73  _next_window_pos
+0001b230: 6974 696f 6e28 302c 2031 372c 2069 6d67  ition(0, 17, img
+0001b240: 7569 2e4f 4e43 4529 0d0a 2020 2020 2020  ui.ONCE)..      
+0001b250: 2020 696d 6775 692e 7365 745f 6e65 7874    imgui.set_next
+0001b260: 5f77 696e 646f 775f 7369 7a65 2853 6567  _window_size(Seg
+0001b270: 6d65 6e74 6174 696f 6e45 6469 746f 722e  mentationEditor.
+0001b280: 4d41 494e 5f57 494e 444f 575f 5749 4454  MAIN_WINDOW_WIDT
+0001b290: 482c 2073 656c 662e 7769 6e64 6f77 2e68  H, self.window.h
+0001b2a0: 6569 6768 7420 2d20 3137 290d 0a0d 0a20  eight - 17).... 
+0001b2b0: 2020 2020 2020 2069 6d67 7569 2e62 6567         imgui.beg
+0001b2c0: 696e 2822 2323 7365 5f6d 6169 6e22 2c20  in("##se_main", 
+0001b2d0: 4661 6c73 652c 2069 6d67 7569 2e57 494e  False, imgui.WIN
+0001b2e0: 444f 575f 4e4f 5f54 4954 4c45 5f42 4152  DOW_NO_TITLE_BAR
+0001b2f0: 207c 2069 6d67 7569 2e57 494e 444f 575f   | imgui.WINDOW_
+0001b300: 4e4f 5f52 4553 495a 4520 7c20 696d 6775  NO_RESIZE | imgu
+0001b310: 692e 5749 4e44 4f57 5f4e 4f5f 4d4f 5645  i.WINDOW_NO_MOVE
+0001b320: 290d 0a20 2020 2020 2020 2073 6861 7265  )..        share
+0001b330: 645f 6775 6928 290d 0a20 2020 2020 2020  d_gui()..       
+0001b340: 2069 6d67 7569 2e73 7061 6369 6e67 2829   imgui.spacing()
+0001b350: 0d0a 2020 2020 2020 2020 696d 6775 692e  ..        imgui.
+0001b360: 7370 6163 696e 6728 290d 0a0d 0a20 2020  spacing()....   
+0001b370: 2020 2020 2069 6620 696d 6775 692e 6265       if imgui.be
+0001b380: 6769 6e5f 7461 625f 6261 7228 2223 2374  gin_tab_bar("##t
+0001b390: 6162 7322 293a 0d0a 2020 2020 2020 2020  abs"):..        
+0001b3a0: 2020 2020 7365 6c66 2e77 696e 646f 772e      self.window.
+0001b3b0: 636c 6561 725f 636f 6c6f 7220 3d20 6366  clear_color = cf
+0001b3c0: 672e 434f 4c4f 5552 5f57 494e 444f 575f  g.COLOUR_WINDOW_
+0001b3d0: 4241 434b 4752 4f55 4e44 0d0a 2020 2020  BACKGROUND..    
+0001b3e0: 2020 2020 2020 2020 6966 2069 6d67 7569          if imgui
+0001b3f0: 2e62 6567 696e 5f74 6162 5f69 7465 6d28  .begin_tab_item(
+0001b400: 2220 2041 6e6e 6f74 6174 696f 6e20 2229  "  Annotation ")
+0001b410: 5b30 5d3a 0d0a 2020 2020 2020 2020 2020  [0]:..          
+0001b420: 2020 2020 2020 7365 676d 656e 7461 7469        segmentati
+0001b430: 6f6e 5f74 6162 2829 0d0a 2020 2020 2020  on_tab()..      
+0001b440: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+0001b450: 6374 6976 655f 7461 6220 3d20 2253 6567  ctive_tab = "Seg
+0001b460: 6d65 6e74 6174 696f 6e22 2020 2023 2075  mentation"   # u
+0001b470: 7365 6420 746f 2062 6520 6c61 6265 6c6c  sed to be labell
+0001b480: 6564 2053 6567 6d65 6e74 6174 696f 6e20  ed Segmentation 
+0001b490: 7468 656e 2063 6861 6e67 6564 2074 6f20  then changed to 
+0001b4a0: 2741 6e6e 6f74 6174 696f 6e27 2e20 4469  'Annotation'. Di
+0001b4b0: 6420 6e6f 7420 6368 616e 6765 2074 6865  d not change the
+0001b4c0: 2061 6374 6976 655f 7461 6220 656e 756d   active_tab enum
+0001b4d0: 2076 616c 7565 2074 686f 7567 682e 0d0a   value though...
+0001b4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b4f0: 696d 6775 692e 656e 645f 7461 625f 6974  imgui.end_tab_it
+0001b500: 656d 2829 0d0a 2020 2020 2020 2020 2020  em()..          
+0001b510: 2020 6966 2069 6d67 7569 2e62 6567 696e    if imgui.begin
+0001b520: 5f74 6162 5f69 7465 6d28 2220 4d6f 6465  _tab_item(" Mode
+0001b530: 6c73 2022 295b 305d 3a0d 0a20 2020 2020  ls ")[0]:..     
+0001b540: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+0001b550: 6c66 2e61 6374 6976 655f 7461 6220 213d  lf.active_tab !=
+0001b560: 2022 4d6f 6465 6c73 223a 0d0a 2020 2020   "Models":..    
+0001b570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b580: 7365 6c66 2e70 6172 7365 5f61 7661 696c  self.parse_avail
+0001b590: 6162 6c65 5f66 6561 7475 7265 7328 290d  able_features().
+0001b5a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b5b0: 2073 656c 662e 6163 7469 7665 5f74 6162   self.active_tab
+0001b5c0: 203d 2022 4d6f 6465 6c73 220d 0a20 2020   = "Models"..   
+0001b5d0: 2020 2020 2020 2020 2020 2020 206d 6f64               mod
+0001b5e0: 656c 735f 7461 6228 290d 0a20 2020 2020  els_tab()..     
+0001b5f0: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
+0001b600: 2e65 6e64 5f74 6162 5f69 7465 6d28 290d  .end_tab_item().
+0001b610: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0001b620: 696d 6775 692e 6265 6769 6e5f 7461 625f  imgui.begin_tab_
+0001b630: 6974 656d 2822 2045 7870 6f72 7420 2229  item(" Export ")
+0001b640: 5b30 5d3a 0d0a 2020 2020 2020 2020 2020  [0]:..          
+0001b650: 2020 2020 2020 7365 6c66 2e61 6374 6976        self.activ
+0001b660: 655f 7461 6220 3d20 2245 7870 6f72 7422  e_tab = "Export"
+0001b670: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001b680: 2020 6578 706f 7274 5f74 6162 2829 0d0a    export_tab()..
+0001b690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b6a0: 696d 6775 692e 656e 645f 7461 625f 6974  imgui.end_tab_it
+0001b6b0: 656d 2829 0d0a 2020 2020 2020 2020 2020  em()..          
+0001b6c0: 2020 6966 2069 6d67 7569 2e62 6567 696e    if imgui.begin
+0001b6d0: 5f74 6162 5f69 7465 6d28 2220 5265 6e64  _tab_item(" Rend
+0001b6e0: 6572 2020 2229 5b30 5d3a 0d0a 2020 2020  er  ")[0]:..    
+0001b6f0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0001b700: 2e77 696e 646f 772e 636c 6561 725f 636f  .window.clear_co
+0001b710: 6c6f 7220 3d20 5b2a 5365 676d 656e 7461  lor = [*Segmenta
+0001b720: 7469 6f6e 4564 6974 6f72 2e52 454e 4445  tionEditor.RENDE
+0001b730: 525f 434c 4541 525f 434f 4c4f 5552 2c20  R_CLEAR_COLOUR, 
+0001b740: 312e 305d 0d0a 2020 2020 2020 2020 2020  1.0]..          
+0001b750: 2020 2020 2020 7365 6c66 2e61 6374 6976        self.activ
+0001b760: 655f 7461 6220 3d20 2252 656e 6465 7222  e_tab = "Render"
+0001b770: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001b780: 2020 7069 636b 696e 675f 7461 6228 290d    picking_tab().
+0001b790: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b7a0: 2069 6d67 7569 2e65 6e64 5f74 6162 5f69   imgui.end_tab_i
+0001b7b0: 7465 6d28 290d 0a20 2020 2020 2020 2020  tem()..         
+0001b7c0: 2020 2069 6d67 7569 2e65 6e64 5f74 6162     imgui.end_tab
+0001b7d0: 5f62 6172 2829 0d0a 0d0a 2020 2020 2020  _bar()....      
+0001b7e0: 2020 696d 6775 692e 656e 6428 290d 0a0d    imgui.end()...
+0001b7f0: 0a20 2020 2020 2020 2073 6c69 6365 725f  .        slicer_
+0001b800: 7769 6e64 6f77 2829 0d0a 2020 2020 2020  window()..      
+0001b810: 2020 7365 6c66 2e5f 7761 726e 696e 675f    self._warning_
+0001b820: 7769 6e64 6f77 2829 0d0a 2020 2020 2020  window()..      
+0001b830: 2020 626f 6f74 5f73 7072 6974 6528 290d    boot_sprite().
+0001b840: 0a20 2020 2020 2020 2069 6d67 7569 2e70  .        imgui.p
+0001b850: 6f70 5f73 7479 6c65 5f63 6f6c 6f72 2833  op_style_color(3
+0001b860: 3229 0d0a 2020 2020 2020 2020 696d 6775  2)..        imgu
+0001b870: 692e 706f 705f 7374 796c 655f 7661 7228  i.pop_style_var(
+0001b880: 3129 0d0a 0d0a 2020 2020 6465 6620 5f77  1)....    def _w
+0001b890: 6172 6e69 6e67 5f77 696e 646f 7728 7365  arning_window(se
+0001b8a0: 6c66 293a 0d0a 2020 2020 2020 2020 6465  lf):..        de
+0001b8b0: 6620 7777 5f63 6f6e 7465 7874 5f6d 656e  f ww_context_men
+0001b8c0: 7528 293a 0d0a 2020 2020 2020 2020 2020  u():..          
+0001b8d0: 2020 696d 6775 692e 7075 7368 5f73 7479    imgui.push_sty
+0001b8e0: 6c65 5f63 6f6c 6f72 2869 6d67 7569 2e43  le_color(imgui.C
+0001b8f0: 4f4c 4f52 5f50 4f50 5550 5f42 4143 4b47  OLOR_POPUP_BACKG
+0001b900: 524f 554e 442c 202a 6366 672e 434f 4c4f  ROUND, *cfg.COLO
+0001b910: 5552 5f4d 454e 555f 5749 4e44 4f57 5f42  UR_MENU_WINDOW_B
+0001b920: 4143 4b47 524f 554e 4429 0d0a 2020 2020  ACKGROUND)..    
+0001b930: 2020 2020 2020 2020 6966 2069 6d67 7569          if imgui
+0001b940: 2e62 6567 696e 5f70 6f70 7570 5f63 6f6e  .begin_popup_con
+0001b950: 7465 7874 5f77 696e 646f 7728 293a 0d0a  text_window():..
+0001b960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b970: 6366 672e 6572 726f 725f 7769 6e64 6f77  cfg.error_window
+0001b980: 5f61 6374 6976 6520 3d20 5472 7565 0d0a  _active = True..
+0001b990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b9a0: 636f 7079 5f65 7272 6f72 2c20 5f20 3d20  copy_error, _ = 
+0001b9b0: 696d 6775 692e 6d65 6e75 5f69 7465 6d28  imgui.menu_item(
+0001b9c0: 2243 6f70 7920 746f 2063 6c69 7062 6f61  "Copy to clipboa
+0001b9d0: 7264 2229 0d0a 2020 2020 2020 2020 2020  rd")..          
+0001b9e0: 2020 2020 2020 6966 2063 6f70 795f 6572        if copy_er
+0001b9f0: 726f 723a 0d0a 2020 2020 2020 2020 2020  ror:..          
+0001ba00: 2020 2020 2020 2020 2020 7079 7065 7263            pyperc
+0001ba10: 6c69 702e 636f 7079 2863 6667 2e65 7272  lip.copy(cfg.err
+0001ba20: 6f72 5f6d 7367 290d 0a20 2020 2020 2020  or_msg)..       
+0001ba30: 2020 2020 2020 2020 2063 6f70 795f 7061           copy_pa
+0001ba40: 7468 5f74 6f5f 6c6f 672c 205f 203d 2069  th_to_log, _ = i
+0001ba50: 6d67 7569 2e6d 656e 755f 6974 656d 2822  mgui.menu_item("
+0001ba60: 436f 7079 2070 6174 6820 746f 2073 634e  Copy path to scN
+0001ba70: 6f64 6573 2e6c 6f67 2229 0d0a 2020 2020  odes.log")..    
+0001ba80: 2020 2020 2020 2020 2020 2020 6966 2063              if c
+0001ba90: 6f70 795f 7061 7468 5f74 6f5f 6c6f 673a  opy_path_to_log:
+0001baa0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001bab0: 2020 2020 2020 7079 7065 7263 6c69 702e        pyperclip.
+0001bac0: 636f 7079 286f 732e 7061 7468 2e61 6273  copy(os.path.abs
+0001bad0: 7061 7468 2863 6667 2e6c 6f67 7061 7468  path(cfg.logpath
+0001bae0: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
+0001baf0: 2020 2020 696d 6775 692e 656e 645f 706f      imgui.end_po
+0001bb00: 7075 7028 290d 0a20 2020 2020 2020 2020  pup()..         
+0001bb10: 2020 2069 6d67 7569 2e70 6f70 5f73 7479     imgui.pop_sty
+0001bb20: 6c65 5f63 6f6c 6f72 2831 290d 0a20 2020  le_color(1)..   
+0001bb30: 2020 2020 2023 2320 4572 726f 7220 6d65       ## Error me
+0001bb40: 7373 6167 650d 0a20 2020 2020 2020 2069  ssage..        i
+0001bb50: 6620 6366 672e 6572 726f 725f 6d73 6720  f cfg.error_msg 
+0001bb60: 6973 206e 6f74 204e 6f6e 653a 0d0a 2020  is not None:..  
+0001bb70: 2020 2020 2020 2020 2020 6966 2063 6667            if cfg
+0001bb80: 2e65 7272 6f72 5f6e 6577 3a0d 0a20 2020  .error_new:..   
+0001bb90: 2020 2020 2020 2020 2020 2020 2069 6d67               img
+0001bba0: 7569 2e70 7573 685f 7374 796c 655f 636f  ui.push_style_co
+0001bbb0: 6c6f 7228 696d 6775 692e 434f 4c4f 525f  lor(imgui.COLOR_
+0001bbc0: 5449 544c 455f 4241 434b 4752 4f55 4e44  TITLE_BACKGROUND
+0001bbd0: 2c20 2a63 6667 2e43 4f4c 4f55 525f 4552  , *cfg.COLOUR_ER
+0001bbe0: 524f 525f 5749 4e44 4f57 5f48 4541 4445  ROR_WINDOW_HEADE
+0001bbf0: 525f 4e45 5729 0d0a 2020 2020 2020 2020  R_NEW)..        
+0001bc00: 2020 2020 2020 2020 696d 6775 692e 7075          imgui.pu
+0001bc10: 7368 5f73 7479 6c65 5f63 6f6c 6f72 2869  sh_style_color(i
+0001bc20: 6d67 7569 2e43 4f4c 4f52 5f54 4954 4c45  mgui.COLOR_TITLE
+0001bc30: 5f42 4143 4b47 524f 554e 445f 4143 5449  _BACKGROUND_ACTI
+0001bc40: 5645 2c20 2a63 6667 2e43 4f4c 4f55 525f  VE, *cfg.COLOUR_
+0001bc50: 4552 524f 525f 5749 4e44 4f57 5f48 4541  ERROR_WINDOW_HEA
+0001bc60: 4445 525f 4e45 5729 0d0a 2020 2020 2020  DER_NEW)..      
+0001bc70: 2020 2020 2020 2020 2020 696d 6775 692e            imgui.
+0001bc80: 7075 7368 5f73 7479 6c65 5f63 6f6c 6f72  push_style_color
+0001bc90: 2869 6d67 7569 2e43 4f4c 4f52 5f54 4954  (imgui.COLOR_TIT
+0001bca0: 4c45 5f42 4143 4b47 524f 554e 445f 434f  LE_BACKGROUND_CO
+0001bcb0: 4c4c 4150 5345 442c 202a 6366 672e 434f  LLAPSED, *cfg.CO
+0001bcc0: 4c4f 5552 5f45 5252 4f52 5f57 494e 444f  LOUR_ERROR_WINDO
+0001bcd0: 575f 4845 4144 4552 5f4e 4557 290d 0a20  W_HEADER_NEW).. 
+0001bce0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+0001bcf0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001bd00: 2020 696d 6775 692e 7075 7368 5f73 7479    imgui.push_sty
+0001bd10: 6c65 5f63 6f6c 6f72 2869 6d67 7569 2e43  le_color(imgui.C
+0001bd20: 4f4c 4f52 5f54 4954 4c45 5f42 4143 4b47  OLOR_TITLE_BACKG
+0001bd30: 524f 554e 442c 202a 6366 672e 434f 4c4f  ROUND, *cfg.COLO
+0001bd40: 5552 5f45 5252 4f52 5f57 494e 444f 575f  UR_ERROR_WINDOW_
+0001bd50: 4845 4144 4552 290d 0a20 2020 2020 2020  HEADER)..       
+0001bd60: 2020 2020 2020 2020 2069 6d67 7569 2e70           imgui.p
+0001bd70: 7573 685f 7374 796c 655f 636f 6c6f 7228  ush_style_color(
+0001bd80: 696d 6775 692e 434f 4c4f 525f 5449 544c  imgui.COLOR_TITL
+0001bd90: 455f 4241 434b 4752 4f55 4e44 5f41 4354  E_BACKGROUND_ACT
+0001bda0: 4956 452c 202a 6366 672e 434f 4c4f 5552  IVE, *cfg.COLOUR
+0001bdb0: 5f45 5252 4f52 5f57 494e 444f 575f 4845  _ERROR_WINDOW_HE
+0001bdc0: 4144 4552 290d 0a20 2020 2020 2020 2020  ADER)..         
+0001bdd0: 2020 2020 2020 2069 6d67 7569 2e70 7573         imgui.pus
+0001bde0: 685f 7374 796c 655f 636f 6c6f 7228 696d  h_style_color(im
+0001bdf0: 6775 692e 434f 4c4f 525f 5449 544c 455f  gui.COLOR_TITLE_
+0001be00: 4241 434b 4752 4f55 4e44 5f43 4f4c 4c41  BACKGROUND_COLLA
+0001be10: 5053 4544 2c20 2a63 6667 2e43 4f4c 4f55  PSED, *cfg.COLOU
+0001be20: 525f 4552 524f 525f 5749 4e44 4f57 5f48  R_ERROR_WINDOW_H
+0001be30: 4541 4445 5229 0d0a 2020 2020 2020 2020  EADER)..        
+0001be40: 2020 2020 696d 6775 692e 7075 7368 5f73      imgui.push_s
+0001be50: 7479 6c65 5f63 6f6c 6f72 2869 6d67 7569  tyle_color(imgui
+0001be60: 2e43 4f4c 4f52 5f57 494e 444f 575f 4241  .COLOR_WINDOW_BA
+0001be70: 434b 4752 4f55 4e44 2c20 2a63 6667 2e43  CKGROUND, *cfg.C
+0001be80: 4f4c 4f55 525f 4552 524f 525f 5749 4e44  OLOUR_ERROR_WIND
+0001be90: 4f57 5f42 4143 4b47 524f 554e 4429 0d0a  OW_BACKGROUND)..
+0001bea0: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
+0001beb0: 692e 7075 7368 5f73 7479 6c65 5f63 6f6c  i.push_style_col
+0001bec0: 6f72 2869 6d67 7569 2e43 4f4c 4f52 5f54  or(imgui.COLOR_T
+0001bed0: 4558 542c 202a 6366 672e 434f 4c4f 5552  EXT, *cfg.COLOUR
+0001bee0: 5f45 5252 4f52 5f57 494e 444f 575f 5445  _ERROR_WINDOW_TE
+0001bef0: 5854 290d 0a20 2020 2020 2020 2020 2020  XT)..           
+0001bf00: 2069 6d67 7569 2e70 7573 685f 7374 796c   imgui.push_styl
+0001bf10: 655f 7661 7228 696d 6775 692e 5354 594c  e_var(imgui.STYL
+0001bf20: 455f 5749 4e44 4f57 5f52 4f55 4e44 494e  E_WINDOW_ROUNDIN
+0001bf30: 472c 2033 2e30 290d 0a20 2020 2020 2020  G, 3.0)..       
+0001bf40: 2020 2020 2069 6d67 7569 2e73 6574 5f6e       imgui.set_n
+0001bf50: 6578 745f 7769 6e64 6f77 5f73 697a 6528  ext_window_size(
+0001bf60: 7365 6c66 2e77 696e 646f 772e 7769 6474  self.window.widt
+0001bf70: 682c 2063 6667 2e45 5252 4f52 5f57 494e  h, cfg.ERROR_WIN
+0001bf80: 444f 575f 4845 4947 4854 290d 0a20 2020  DOW_HEIGHT)..   
+0001bf90: 2020 2020 2020 2020 2077 696e 646f 775f           window_
+0001bfa0: 7665 7274 6963 616c 5f6f 6666 7365 7420  vertical_offset 
+0001bfb0: 3d20 3020 6966 2063 6667 2e65 7272 6f72  = 0 if cfg.error
+0001bfc0: 5f77 696e 646f 775f 6163 7469 7665 2065  _window_active e
+0001bfd0: 6c73 6520 6366 672e 4552 524f 525f 5749  lse cfg.ERROR_WI
+0001bfe0: 4e44 4f57 5f48 4549 4748 5420 2d20 3139  NDOW_HEIGHT - 19
+0001bff0: 0d0a 2020 2020 2020 2020 2020 2020 696d  ..            im
+0001c000: 6775 692e 7365 745f 6e65 7874 5f77 696e  gui.set_next_win
+0001c010: 646f 775f 706f 7369 7469 6f6e 2830 2c20  dow_position(0, 
+0001c020: 7365 6c66 2e77 696e 646f 772e 6865 6967  self.window.heig
+0001c030: 6874 202d 2063 6667 2e45 5252 4f52 5f57  ht - cfg.ERROR_W
+0001c040: 494e 444f 575f 4845 4947 4854 202b 2077  INDOW_HEIGHT + w
+0001c050: 696e 646f 775f 7665 7274 6963 616c 5f6f  indow_vertical_o
+0001c060: 6666 7365 7429 0d0a 2020 2020 2020 2020  ffset)..        
+0001c070: 2020 2020 5f2c 2073 7461 795f 6f70 656e      _, stay_open
+0001c080: 203d 2069 6d67 7569 2e62 6567 696e 2822   = imgui.begin("
+0001c090: 4e6f 7469 6669 6361 7469 6f6e 222c 2054  Notification", T
+0001c0a0: 7275 652c 2069 6d67 7569 2e57 494e 444f  rue, imgui.WINDO
+0001c0b0: 575f 4e4f 5f4d 4f56 4520 7c20 696d 6775  W_NO_MOVE | imgu
+0001c0c0: 692e 5749 4e44 4f57 5f4e 4f5f 5245 5349  i.WINDOW_NO_RESI
+0001c0d0: 5a45 207c 2069 6d67 7569 2e57 494e 444f  ZE | imgui.WINDO
+0001c0e0: 575f 4e4f 5f43 4f4c 4c41 5053 4529 0d0a  W_NO_COLLAPSE)..
+0001c0f0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+0001c100: 6d67 7569 2e69 735f 7769 6e64 6f77 5f66  mgui.is_window_f
+0001c110: 6f63 7573 6564 2829 3a0d 0a20 2020 2020  ocused():..     
+0001c120: 2020 2020 2020 2020 2020 2063 6667 2e65             cfg.e
+0001c130: 7272 6f72 5f77 696e 646f 775f 6163 7469  rror_window_acti
+0001c140: 7665 203d 2054 7275 650d 0a20 2020 2020  ve = True..     
+0001c150: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+0001c160: 6c66 2e77 696e 646f 772e 6765 745f 6d6f  lf.window.get_mo
+0001c170: 7573 655f 6576 656e 7428 676c 6677 2e4d  use_event(glfw.M
+0001c180: 4f55 5345 5f42 5554 544f 4e5f 4c45 4654  OUSE_BUTTON_LEFT
+0001c190: 2c20 676c 6677 2e50 5245 5353 293a 0d0a  , glfw.PRESS):..
+0001c1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c1b0: 2020 2020 6366 672e 6572 726f 725f 6e65      cfg.error_ne
+0001c1c0: 7720 3d20 4661 6c73 650d 0a20 2020 2020  w = False..     
+0001c1d0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+0001c1e0: 2020 2020 2020 2020 2020 2020 2020 6366                cf
+0001c1f0: 672e 6572 726f 725f 7769 6e64 6f77 5f61  g.error_window_a
+0001c200: 6374 6976 6520 3d20 4661 6c73 650d 0a20  ctive = False.. 
+0001c210: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
+0001c220: 7420 6366 672e 6572 726f 725f 6c6f 6767  t cfg.error_logg
+0001c230: 6564 3a0d 0a20 2020 2020 2020 2020 2020  ed:..           
+0001c240: 2020 2020 2063 6667 2e77 7269 7465 5f74       cfg.write_t
+0001c250: 6f5f 6c6f 6728 6366 672e 6572 726f 725f  o_log(cfg.error_
+0001c260: 6d73 6729 0d0a 2020 2020 2020 2020 2020  msg)..          
+0001c270: 2020 2020 2020 6366 672e 6572 726f 725f        cfg.error_
+0001c280: 6c6f 6767 6564 203d 2054 7275 650d 0a20  logged = True.. 
+0001c290: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
+0001c2a0: 2e74 6578 7428 6366 672e 6572 726f 725f  .text(cfg.error_
+0001c2b0: 6d73 6729 0d0a 2020 2020 2020 2020 2020  msg)..          
+0001c2c0: 2020 7777 5f63 6f6e 7465 7874 5f6d 656e    ww_context_men
+0001c2d0: 7528 290d 0a20 2020 2020 2020 2020 2020  u()..           
+0001c2e0: 2069 6d67 7569 2e65 6e64 2829 0d0a 2020   imgui.end()..  
+0001c2f0: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
+0001c300: 2073 7461 795f 6f70 656e 3a0d 0a20 2020   stay_open:..   
+0001c310: 2020 2020 2020 2020 2020 2020 2063 6667               cfg
+0001c320: 2e65 7272 6f72 5f6d 7367 203d 204e 6f6e  .error_msg = Non
+0001c330: 650d 0a20 2020 2020 2020 2020 2020 2020  e..             
+0001c340: 2020 2063 6667 2e65 7272 6f72 5f6e 6577     cfg.error_new
+0001c350: 203d 2054 7275 650d 0a20 2020 2020 2020   = True..       
+0001c360: 2020 2020 2069 6d67 7569 2e70 6f70 5f73       imgui.pop_s
+0001c370: 7479 6c65 5f63 6f6c 6f72 2835 290d 0a20  tyle_color(5).. 
+0001c380: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
+0001c390: 2e70 6f70 5f73 7479 6c65 5f76 6172 2831  .pop_style_var(1
+0001c3a0: 290d 0a0d 0a20 2020 2064 6566 2070 6172  )....    def par
+0001c3b0: 7365 5f61 7661 696c 6162 6c65 5f66 6561  se_available_fea
+0001c3c0: 7475 7265 7328 7365 6c66 293a 0d0a 2020  tures(self):..  
+0001c3d0: 2020 2020 2020 2320 7570 6f6e 206f 7065        # upon ope
+0001c3e0: 6e69 6e67 204d 6f64 656c 7320 7461 622e  ning Models tab.
+0001c3f0: 0d0a 2020 2020 2020 2020 7365 6c66 2e61  ..        self.a
+0001c400: 6c6c 5f66 6561 7475 7265 5f6e 616d 6573  ll_feature_names
+0001c410: 203d 206c 6973 7428 290d 0a20 2020 2020   = list()..     
+0001c420: 2020 2073 656c 662e 6665 6174 7572 655f     self.feature_
+0001c430: 636f 6c6f 7572 5f64 6963 7420 3d20 6469  colour_dict = di
+0001c440: 6374 2829 0d0a 2020 2020 2020 2020 666f  ct()..        fo
+0001c450: 7220 7365 6620 696e 2063 6667 2e73 655f  r sef in cfg.se_
+0001c460: 6672 616d 6573 3a0d 0a20 2020 2020 2020  frames:..       
+0001c470: 2020 2020 2066 6f72 2066 7472 2069 6e20       for ftr in 
+0001c480: 7365 662e 6665 6174 7572 6573 3a0d 0a20  sef.features:.. 
+0001c490: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0001c4a0: 6620 7365 662e 7361 6d70 6c65 3a0d 0a20  f sef.sample:.. 
 0001c4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c4c0: 2020 2020 2069 6d67 7569 2e67 6574 5f63       imgui.get_c
-0001c4d0: 6f6c 6f72 5f75 3332 5f72 6762 6128 2a63  olor_u32_rgba(*c
-0001c4e0: 6f6c 6f75 7229 290d 0a20 2020 2020 2020  olour))..       
-0001c4f0: 2069 6d67 7569 2e64 756d 6d79 2863 7720   imgui.dummy(cw 
-0001c500: 2d20 6361 6e63 656c 5f62 7574 746f 6e5f  - cancel_button_
-0001c510: 772c 2068 6569 6768 7429 0d0a 2020 2020  w, height)..    
-0001c520: 2020 2020 7265 7476 616c 203d 2046 616c      retval = Fal
-0001c530: 7365 0d0a 2020 2020 2020 2020 6966 2063  se..        if c
-0001c540: 616e 6365 6c6c 6162 6c65 3a0d 0a20 2020  ancellable:..   
-0001c550: 2020 2020 2020 2020 2069 6d67 7569 2e73           imgui.s
-0001c560: 616d 655f 6c69 6e65 2873 7061 6369 6e67  ame_line(spacing
-0001c570: 3d35 290d 0a20 2020 2020 2020 2020 2020  =5)..           
-0001c580: 2072 6574 7661 6c20 3d20 696d 6775 692e   retval = imgui.
-0001c590: 696d 6167 655f 6275 7474 6f6e 2873 656c  image_button(sel
-0001c5a0: 662e 6963 6f6e 5f63 6c6f 7365 2e72 656e  f.icon_close.ren
-0001c5b0: 6465 7265 725f 6964 2c20 5365 676d 656e  derer_id, Segmen
-0001c5c0: 7461 7469 6f6e 4564 6974 6f72 2e50 524f  tationEditor.PRO
-0001c5d0: 4752 4553 535f 4241 525f 4845 4947 4854  GRESS_BAR_HEIGHT
-0001c5e0: 2c20 5365 676d 656e 7461 7469 6f6e 4564  , SegmentationEd
-0001c5f0: 6974 6f72 2e50 524f 4752 4553 535f 4241  itor.PROGRESS_BA
-0001c600: 525f 4845 4947 4854 290d 0a20 2020 2020  R_HEIGHT)..     
-0001c610: 2020 2072 6574 7572 6e20 7265 7476 616c     return retval
-0001c620: 0d0a 0d0a 2020 2020 6465 6620 5f67 7569  ....    def _gui
-0001c630: 5f66 6561 7475 7265 5f74 6974 6c65 5f63  _feature_title_c
-0001c640: 6f6e 7465 7874 5f6d 656e 7528 7365 6c66  ontext_menu(self
-0001c650: 2c20 6665 6174 7572 655f 6f72 5f6d 6f64  , feature_or_mod
-0001c660: 656c 293a 0d0a 2020 2020 2020 2020 6966  el):..        if
-0001c670: 2069 6d67 7569 2e62 6567 696e 5f70 6f70   imgui.begin_pop
-0001c680: 7570 5f63 6f6e 7465 7874 5f69 7465 6d28  up_context_item(
-0001c690: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-0001c6a0: 666f 7220 7420 696e 2073 656c 662e 6665  for t in self.fe
-0001c6b0: 6174 7572 655f 636f 6c6f 7572 5f64 6963  ature_colour_dic
-0001c6c0: 743a 0d0a 2020 2020 2020 2020 2020 2020  t:..            
-0001c6d0: 2020 2020 696d 6775 692e 7365 6c65 6374      imgui.select
-0001c6e0: 6162 6c65 2874 290d 0a20 2020 2020 2020  able(t)..       
-0001c6f0: 2020 2020 2020 2020 2069 6620 696d 6775           if imgu
-0001c700: 692e 6973 5f69 7465 6d5f 686f 7665 7265  i.is_item_hovere
-0001c710: 6428 293a 0d0a 2020 2020 2020 2020 2020  d():..          
-0001c720: 2020 2020 2020 2020 2020 6665 6174 7572            featur
-0001c730: 655f 6f72 5f6d 6f64 656c 2e74 6974 6c65  e_or_model.title
-0001c740: 203d 2074 0d0a 2020 2020 2020 2020 2020   = t..          
-0001c750: 2020 2020 2020 2020 2020 6665 6174 7572            featur
-0001c760: 655f 6f72 5f6d 6f64 656c 2e63 6f6c 6f75  e_or_model.colou
-0001c770: 7220 3d20 7365 6c66 2e66 6561 7475 7265  r = self.feature
-0001c780: 5f63 6f6c 6f75 725f 6469 6374 5b74 5d0d  _colour_dict[t].
-0001c790: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001c7a0: 2069 6d67 7569 2e73 7061 6369 6e67 2829   imgui.spacing()
-0001c7b0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-0001c7c0: 696d 6775 692e 656e 645f 706f 7075 7028  imgui.end_popup(
-0001c7d0: 290d 0a0d 0a20 2020 2040 7374 6174 6963  )....    @static
-0001c7e0: 6d65 7468 6f64 0d0a 2020 2020 6465 6620  method..    def 
-0001c7f0: 6578 7472 6163 745f 636f 6f72 6469 6e61  extract_coordina
-0001c800: 7465 735f 6d65 6e75 2866 6561 7475 7265  tes_menu(feature
-0001c810: 293a 0d0a 2020 2020 2020 2020 696d 6775  ):..        imgu
-0001c820: 692e 7075 7368 5f73 7479 6c65 5f63 6f6c  i.push_style_col
-0001c830: 6f72 2869 6d67 7569 2e43 4f4c 4f52 5f43  or(imgui.COLOR_C
-0001c840: 4845 434b 5f4d 4152 4b2c 202a 6665 6174  HECK_MARK, *feat
-0001c850: 7572 652e 636f 6c6f 7572 290d 0a20 2020  ure.colour)..   
-0001c860: 2020 2020 2069 6d67 7569 2e74 6578 7428       imgui.text(
-0001c870: 2245 7874 7261 6374 2063 6f6f 7264 696e  "Extract coordin
-0001c880: 6174 6573 3a22 290d 0a20 2020 2020 2020  ates:")..       
-0001c890: 2069 6d67 7569 2e73 7061 6369 6e67 2829   imgui.spacing()
-0001c8a0: 0d0a 2020 2020 2020 2020 5f2c 2053 6567  ..        _, Seg
-0001c8b0: 6d65 6e74 6174 696f 6e45 6469 746f 722e  mentationEditor.
-0001c8c0: 4558 5452 4143 545f 414c 4c20 3d20 696d  EXTRACT_ALL = im
-0001c8d0: 6775 692e 6368 6563 6b62 6f78 2822 7468  gui.checkbox("th
-0001c8e0: 6973 2064 6174 6173 6574 222c 2053 6567  is dataset", Seg
-0001c8f0: 6d65 6e74 6174 696f 6e45 6469 746f 722e  mentationEditor.
-0001c900: 4558 5452 4143 545f 414c 4c29 0d0a 2020  EXTRACT_ALL)..  
-0001c910: 2020 2020 2020 5f2c 2065 7874 7261 6374        _, extract
-0001c920: 5f73 696e 676c 6520 3d20 696d 6775 692e  _single = imgui.
-0001c930: 6368 6563 6b62 6f78 2822 616c 6c20 6461  checkbox("all da
-0001c940: 7461 7365 7473 222c 206e 6f74 2053 6567  tasets", not Seg
-0001c950: 6d65 6e74 6174 696f 6e45 6469 746f 722e  mentationEditor.
-0001c960: 4558 5452 4143 545f 414c 4c29 0d0a 2020  EXTRACT_ALL)..  
-0001c970: 2020 2020 2020 6966 205f 3a0d 0a20 2020        if _:..   
-0001c980: 2020 2020 2020 2020 2053 6567 6d65 6e74           Segment
-0001c990: 6174 696f 6e45 6469 746f 722e 4558 5452  ationEditor.EXTR
-0001c9a0: 4143 545f 414c 4c20 3d20 6e6f 7420 6578  ACT_ALL = not ex
-0001c9b0: 7472 6163 745f 7369 6e67 6c65 0d0a 2020  tract_single..  
-0001c9c0: 2020 2020 2020 696d 6775 692e 7370 6163        imgui.spac
-0001c9d0: 696e 6728 290d 0a0d 0a20 2020 2020 2020  ing()....       
-0001c9e0: 2069 6d67 7569 2e74 6578 7428 224d 696e   imgui.text("Min
-0001c9f0: 696d 756d 2070 6172 7469 636c 6520 7370  imum particle sp
-0001ca00: 6163 696e 673a 2229 0d0a 2020 2020 2020  acing:")..      
-0001ca10: 2020 6377 203d 2069 6d67 7569 2e67 6574    cw = imgui.get
-0001ca20: 5f63 6f6e 7465 6e74 5f72 6567 696f 6e5f  _content_region_
-0001ca30: 6176 6169 6c61 626c 655f 7769 6474 6828  available_width(
-0001ca40: 290d 0a20 2020 2020 2020 2069 6d67 7569  )..        imgui
-0001ca50: 2e73 6574 5f6e 6578 745f 6974 656d 5f77  .set_next_item_w
-0001ca60: 6964 7468 2863 7729 0d0a 2020 2020 2020  idth(cw)..      
-0001ca70: 2020 5f2c 2053 6567 6d65 6e74 6174 696f    _, Segmentatio
-0001ca80: 6e45 6469 746f 722e 4558 5452 4143 545f  nEditor.EXTRACT_
-0001ca90: 4d49 4e5f 5350 4143 494e 4720 3d20 696d  MIN_SPACING = im
-0001caa0: 6775 692e 736c 6964 6572 5f66 6c6f 6174  gui.slider_float
-0001cab0: 2822 2323 6d69 6e5f 6469 7374 222c 2053  ("##min_dist", S
-0001cac0: 6567 6d65 6e74 6174 696f 6e45 6469 746f  egmentationEdito
-0001cad0: 722e 4558 5452 4143 545f 4d49 4e5f 5350  r.EXTRACT_MIN_SP
-0001cae0: 4143 494e 472c 2030 2e31 2c20 3235 2e30  ACING, 0.1, 25.0
-0001caf0: 2c20 666f 726d 6174 203d 2066 227b 5365  , format = f"{Se
-0001cb00: 676d 656e 7461 7469 6f6e 4564 6974 6f72  gmentationEditor
-0001cb10: 2e45 5854 5241 4354 5f4d 494e 5f53 5041  .EXTRACT_MIN_SPA
-0001cb20: 4349 4e47 3a2e 3166 7d20 6e6d 2229 0d0a  CING:.1f} nm")..
-0001cb30: 0d0a 2020 2020 2020 2020 696d 6775 692e  ..        imgui.
-0001cb40: 7370 6163 696e 6728 290d 0a20 2020 2020  spacing()..     
-0001cb50: 2020 2069 6620 7769 6467 6574 732e 6365     if widgets.ce
-0001cb60: 6e74 7265 645f 6275 7474 6f6e 2822 7374  ntred_button("st
-0001cb70: 6172 7422 2c20 3530 2c20 3230 293a 0d0a  art", 50, 20):..
-0001cb80: 2020 2020 2020 2020 2020 2020 5365 676d              Segm
-0001cb90: 656e 7461 7469 6f6e 4564 6974 6f72 2e6c  entationEditor.l
-0001cba0: 6175 6e63 685f 6578 706f 7274 5f63 6f6f  aunch_export_coo
-0001cbb0: 7264 696e 6174 6573 2866 6561 7475 7265  rdinates(feature
-0001cbc0: 290d 0a20 2020 2020 2020 2020 2020 2069  )..            i
-0001cbd0: 6d67 7569 2e63 6c6f 7365 5f63 7572 7265  mgui.close_curre
-0001cbe0: 6e74 5f70 6f70 7570 2829 0d0a 0d0a 2020  nt_popup()....  
-0001cbf0: 2020 2020 2020 696d 6775 692e 706f 705f        imgui.pop_
-0001cc00: 7374 796c 655f 636f 6c6f 7228 290d 0a0d  style_color()...
-0001cc10: 0a20 2020 2040 7374 6174 6963 6d65 7468  .    @staticmeth
-0001cc20: 6f64 0d0a 2020 2020 6465 6620 746f 6f6c  od..    def tool
-0001cc30: 7469 7028 7465 7874 293a 0d0a 2020 2020  tip(text):..    
-0001cc40: 2020 2020 6966 2069 6d67 7569 2e69 735f      if imgui.is_
-0001cc50: 6974 656d 5f68 6f76 6572 6564 2829 2061  item_hovered() a
-0001cc60: 6e64 206e 6f74 2069 6d67 7569 2e69 735f  nd not imgui.is_
-0001cc70: 6d6f 7573 655f 646f 776e 2830 293a 0d0a  mouse_down(0):..
-0001cc80: 2020 2020 2020 2020 2020 2020 6966 2053              if S
-0001cc90: 6567 6d65 6e74 6174 696f 6e45 6469 746f  egmentationEdito
-0001cca0: 722e 544f 4f4c 5449 505f 484f 5645 5245  r.TOOLTIP_HOVERE
-0001ccb0: 445f 5449 4d45 5220 3d3d 2030 2e30 3a0d  D_TIMER == 0.0:.
-0001ccc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001ccd0: 2053 6567 6d65 6e74 6174 696f 6e45 6469   SegmentationEdi
-0001cce0: 746f 722e 544f 4f4c 5449 505f 484f 5645  tor.TOOLTIP_HOVE
-0001ccf0: 5245 445f 5354 4152 545f 5449 4d45 203d  RED_START_TIME =
-0001cd00: 2074 696d 652e 7469 6d65 2829 0d0a 2020   time.time()..  
-0001cd10: 2020 2020 2020 2020 2020 2020 2020 5365                Se
-0001cd20: 676d 656e 7461 7469 6f6e 4564 6974 6f72  gmentationEditor
-0001cd30: 2e54 4f4f 4c54 4950 5f48 4f56 4552 4544  .TOOLTIP_HOVERED
-0001cd40: 5f54 494d 4552 203d 2030 2e30 3031 2020  _TIMER = 0.001  
-0001cd50: 2320 6164 6420 6120 6661 6b65 2031 206d  # add a fake 1 m
-0001cd60: 7320 746f 2067 6574 2062 7970 6173 7320  s to get bypass 
-0001cd70: 6f66 2074 6869 7320 6966 2063 6c61 7573  of this if claus
-0001cd80: 6520 696e 2074 6865 206e 6578 7420 6974  e in the next it
-0001cd90: 6572 2e0d 0a20 2020 2020 2020 2020 2020  er...           
-0001cda0: 2065 6c69 6620 5365 676d 656e 7461 7469   elif Segmentati
-0001cdb0: 6f6e 4564 6974 6f72 2e54 4f4f 4c54 4950  onEditor.TOOLTIP
-0001cdc0: 5f48 4f56 4552 4544 5f54 494d 4552 203e  _HOVERED_TIMER >
-0001cdd0: 2053 6567 6d65 6e74 6174 696f 6e45 6469   SegmentationEdi
-0001cde0: 746f 722e 544f 4f4c 5449 505f 4150 5045  tor.TOOLTIP_APPE
-0001cdf0: 4152 5f44 454c 4159 3a0d 0a20 2020 2020  AR_DELAY:..     
-0001ce00: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
-0001ce10: 2e73 6574 5f74 6f6f 6c74 6970 2874 6578  .set_tooltip(tex
-0001ce20: 7429 0d0a 2020 2020 2020 2020 2020 2020  t)..            
-0001ce30: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-0001ce40: 2020 2020 2020 2053 6567 6d65 6e74 6174         Segmentat
-0001ce50: 696f 6e45 6469 746f 722e 544f 4f4c 5449  ionEditor.TOOLTI
-0001ce60: 505f 484f 5645 5245 445f 5449 4d45 5220  P_HOVERED_TIMER 
-0001ce70: 3d20 7469 6d65 2e74 696d 6528 2920 2d20  = time.time() - 
-0001ce80: 5365 676d 656e 7461 7469 6f6e 4564 6974  SegmentationEdit
-0001ce90: 6f72 2e54 4f4f 4c54 4950 5f48 4f56 4552  or.TOOLTIP_HOVER
-0001cea0: 4544 5f53 5441 5254 5f54 494d 450d 0a20  ED_START_TIME.. 
-0001ceb0: 2020 2020 2020 2069 6620 6e6f 7420 696d         if not im
-0001cec0: 6775 692e 6973 5f61 6e79 5f69 7465 6d5f  gui.is_any_item_
-0001ced0: 686f 7665 7265 6428 293a 0d0a 2020 2020  hovered():..    
-0001cee0: 2020 2020 2020 2020 5365 676d 656e 7461          Segmenta
-0001cef0: 7469 6f6e 4564 6974 6f72 2e54 4f4f 4c54  tionEditor.TOOLT
-0001cf00: 4950 5f48 4f56 4552 4544 5f54 494d 4552  IP_HOVERED_TIMER
-0001cf10: 203d 2030 2e30 0d0a 0d0a 2020 2020 4073   = 0.0....    @s
-0001cf20: 7461 7469 636d 6574 686f 640d 0a20 2020  taticmethod..   
-0001cf30: 2064 6566 206c 6175 6e63 685f 6578 706f   def launch_expo
-0001cf40: 7274 5f63 6f6f 7264 696e 6174 6573 2866  rt_coordinates(f
-0001cf50: 6561 7475 7265 293a 0d0a 2020 2020 2020  eature):..      
-0001cf60: 2020 7472 793a 0d0a 2020 2020 2020 2020    try:..        
-0001cf70: 2020 2020 6966 2053 6567 6d65 6e74 6174      if Segmentat
-0001cf80: 696f 6e45 6469 746f 722e 4558 5452 4143  ionEditor.EXTRAC
-0001cf90: 545f 414c 4c3a 0d0a 2020 2020 2020 2020  T_ALL:..        
-0001cfa0: 2020 2020 2020 2020 6461 7461 7365 7473          datasets
-0001cfb0: 203d 2067 6c6f 622e 676c 6f62 286f 732e   = glob.glob(os.
-0001cfc0: 7061 7468 2e6a 6f69 6e28 5365 676d 656e  path.join(Segmen
-0001cfd0: 7461 7469 6f6e 4564 6974 6f72 2e73 6567  tationEditor.seg
-0001cfe0: 5f66 6f6c 6465 722c 2066 272a 5f5f 7b66  _folder, f'*__{f
-0001cff0: 6561 7475 7265 2e74 6974 6c65 7d2a 2e6d  eature.title}*.m
-0001d000: 7263 2729 290d 0a20 2020 2020 2020 2020  rc'))..         
-0001d010: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-0001d020: 2020 2020 2020 2020 2020 7365 5f66 7261            se_fra
-0001d030: 6d65 203d 2063 6667 2e73 655f 6163 7469  me = cfg.se_acti
-0001d040: 7665 5f66 7261 6d65 0d0a 2020 2020 2020  ve_frame..      
-0001d050: 2020 2020 2020 2020 2020 6461 7461 7365            datase
-0001d060: 7473 203d 2067 6c6f 622e 676c 6f62 286f  ts = glob.glob(o
-0001d070: 732e 7061 7468 2e6a 6f69 6e28 5365 676d  s.path.join(Segm
-0001d080: 656e 7461 7469 6f6e 4564 6974 6f72 2e73  entationEditor.s
-0001d090: 6567 5f66 6f6c 6465 722c 2066 272a 7b6f  eg_folder, f'*{o
-0001d0a0: 732e 7061 7468 2e73 706c 6974 6578 7428  s.path.splitext(
-0001d0b0: 7365 5f66 7261 6d65 2e74 6974 6c65 295b  se_frame.title)[
-0001d0c0: 305d 7d2a 5f5f 7b66 6561 7475 7265 2e74  0]}*__{feature.t
-0001d0d0: 6974 6c65 7d2a 2e6d 7263 2729 295b 305d  itle}*.mrc'))[0]
-0001d0e0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-0001d0f0: 6966 206e 6f74 2064 6174 6173 6574 733a  if not datasets:
-0001d100: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001d110: 2020 7072 696e 7428 224e 6f20 6461 7461    print("No data
-0001d120: 7365 7473 2073 656c 6563 7465 6422 290d  sets selected").
-0001d130: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001d140: 2072 6574 7572 6e0d 0a0d 0a20 2020 2020   return....     
-0001d150: 2020 2020 2020 2066 6f72 2064 2069 6e20         for d in 
-0001d160: 6461 7461 7365 7473 3a0d 0a20 2020 2020  datasets:..     
-0001d170: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-0001d180: 2864 290d 0a20 2020 2020 2020 2020 2020  (d)..           
-0001d190: 2020 2020 2053 6567 6d65 6e74 6174 696f       Segmentatio
-0001d1a0: 6e45 6469 746f 722e 7175 6575 6564 5f65  nEditor.queued_e
-0001d1b0: 7870 6f72 7473 2e61 7070 656e 6428 5175  xports.append(Qu
-0001d1c0: 6575 6564 4578 7472 6163 7428 642c 2074  euedExtract(d, t
-0001d1d0: 6872 6573 686f 6c64 3d66 6561 7475 7265  hreshold=feature
-0001d1e0: 2e6c 6576 656c 2c20 6d69 6e5f 7369 7a65  .level, min_size
-0001d1f0: 3d66 6561 7475 7265 2e64 7573 742c 206d  =feature.dust, m
-0001d200: 696e 5f73 7061 6369 6e67 3d53 6567 6d65  in_spacing=Segme
-0001d210: 6e74 6174 696f 6e45 6469 746f 722e 4558  ntationEditor.EX
-0001d220: 5452 4143 545f 4d49 4e5f 5350 4143 494e  TRACT_MIN_SPACIN
-0001d230: 472c 2073 6176 655f 6469 723d 5365 676d  G, save_dir=Segm
-0001d240: 656e 7461 7469 6f6e 4564 6974 6f72 2e73  entationEditor.s
-0001d250: 6567 5f66 6f6c 6465 722c 2062 696e 6e69  eg_folder, binni
-0001d260: 6e67 3d66 6561 7475 7265 2e62 696e 2929  ng=feature.bin))
-0001d270: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001d280: 2020 5365 676d 656e 7461 7469 6f6e 4564    SegmentationEd
-0001d290: 6974 6f72 2e71 7565 7565 645f 6578 706f  itor.queued_expo
-0001d2a0: 7274 735b 2d31 5d2e 636f 6c6f 7572 203d  rts[-1].colour =
-0001d2b0: 2066 6561 7475 7265 2e63 6f6c 6f75 720d   feature.colour.
-0001d2c0: 0a0d 0a20 2020 2020 2020 2020 2020 2069  ...            i
-0001d2d0: 6620 5365 676d 656e 7461 7469 6f6e 4564  f SegmentationEd
-0001d2e0: 6974 6f72 2e71 7565 7565 645f 6578 706f  itor.queued_expo
-0001d2f0: 7274 733a 0d0a 2020 2020 2020 2020 2020  rts:..          
-0001d300: 2020 2020 2020 6966 2053 6567 6d65 6e74        if Segment
-0001d310: 6174 696f 6e45 6469 746f 722e 7175 6575  ationEditor.queu
-0001d320: 6564 5f65 7870 6f72 7473 5b30 5d2e 7072  ed_exports[0].pr
-0001d330: 6f63 6573 732e 7072 6f67 7265 7373 203d  ocess.progress =
-0001d340: 3d20 302e 303a 0d0a 2020 2020 2020 2020  = 0.0:..        
-0001d350: 2020 2020 2020 2020 2020 2020 5365 676d              Segm
-0001d360: 656e 7461 7469 6f6e 4564 6974 6f72 2e71  entationEditor.q
-0001d370: 7565 7565 645f 6578 706f 7274 735b 305d  ueued_exports[0]
-0001d380: 2e73 7461 7274 2829 0d0a 0d0a 2020 2020  .start()....    
-0001d390: 2020 2020 6578 6365 7074 2045 7863 6570      except Excep
-0001d3a0: 7469 6f6e 2061 7320 653a 0d0a 2020 2020  tion as e:..    
-0001d3b0: 2020 2020 2020 2020 6366 672e 7365 745f          cfg.set_
-0001d3c0: 6572 726f 7228 652c 2022 436f 756c 6420  error(e, "Could 
-0001d3d0: 6e6f 7420 6578 706f 7274 2063 6f6f 7264  not export coord
-0001d3e0: 696e 6174 6573 202d 2073 6565 2064 6574  inates - see det
-0001d3f0: 6169 6c73 2062 656c 6f77 3a22 290d 0a0d  ails below:")...
-0001d400: 0a20 2020 2064 6566 206c 6175 6e63 685f  .    def launch_
-0001d410: 6578 706f 7274 5f76 6f6c 756d 6573 2873  export_volumes(s
-0001d420: 656c 6629 3a0d 0a20 2020 2020 2020 2074  elf):..        t
-0001d430: 7279 3a0d 0a20 2020 2020 2020 2020 2020  ry:..           
-0001d440: 2064 6174 6173 6574 7320 3d20 5b64 2066   datasets = [d f
-0001d450: 6f72 2064 2069 6e20 6366 672e 7365 5f66  or d in cfg.se_f
-0001d460: 7261 6d65 7320 6966 2064 2e65 7870 6f72  rames if d.expor
-0001d470: 745d 0d0a 2020 2020 2020 2020 2020 2020  t]..            
-0001d480: 6d6f 6465 6c73 203d 205b 6d20 666f 7220  models = [m for 
-0001d490: 6d20 696e 2063 6667 2e73 655f 6d6f 6465  m in cfg.se_mode
-0001d4a0: 6c73 2069 6620 6d2e 6578 706f 7274 5d0d  ls if m.export].
-0001d4b0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0001d4c0: 6e6f 7420 6461 7461 7365 7473 3a0d 0a20  not datasets:.. 
-0001d4d0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0001d4e0: 6574 7572 6e0d 0a20 2020 2020 2020 2020  eturn..         
-0001d4f0: 2020 2069 6620 6e6f 7420 6f73 2e70 6174     if not os.pat
-0001d500: 682e 6973 6469 7228 5365 676d 656e 7461  h.isdir(Segmenta
-0001d510: 7469 6f6e 4564 6974 6f72 2e65 7870 6f72  tionEditor.expor
-0001d520: 745f 6469 7229 3a0d 0a20 2020 2020 2020  t_dir):..       
-0001d530: 2020 2020 2020 2020 206f 732e 6d61 6b65           os.make
-0001d540: 6469 7273 2853 6567 6d65 6e74 6174 696f  dirs(Segmentatio
-0001d550: 6e45 6469 746f 722e 6578 706f 7274 5f64  nEditor.export_d
-0001d560: 6972 290d 0a0d 0a20 2020 2020 2020 2020  ir)....         
-0001d570: 2020 2066 6f72 2064 2069 6e20 6461 7461     for d in data
-0001d580: 7365 7473 3a0d 0a20 2020 2020 2020 2020  sets:..         
-0001d590: 2020 2020 2020 2053 6567 6d65 6e74 6174         Segmentat
-0001d5a0: 696f 6e45 6469 746f 722e 7175 6575 6564  ionEditor.queued
-0001d5b0: 5f65 7870 6f72 7473 2e61 7070 656e 6428  _exports.append(
-0001d5c0: 5175 6575 6564 4578 706f 7274 2853 6567  QueuedExport(Seg
-0001d5d0: 6d65 6e74 6174 696f 6e45 6469 746f 722e  mentationEditor.
-0001d5e0: 6578 706f 7274 5f64 6972 2c20 642c 206d  export_dir, d, m
-0001d5f0: 6f64 656c 732c 2073 656c 662e 6578 706f  odels, self.expo
-0001d600: 7274 5f62 6174 6368 5f73 697a 652c 2073  rt_batch_size, s
-0001d610: 656c 662e 6578 706f 7274 5f6f 7665 726c  elf.export_overl
-0001d620: 6179 7329 290d 0a0d 0a20 2020 2020 2020  ays))....       
-0001d630: 2020 2020 2069 6620 5365 676d 656e 7461       if Segmenta
-0001d640: 7469 6f6e 4564 6974 6f72 2e71 7565 7565  tionEditor.queue
-0001d650: 645f 6578 706f 7274 733a 0d0a 2020 2020  d_exports:..    
-0001d660: 2020 2020 2020 2020 2020 2020 6966 2053              if S
-0001d670: 6567 6d65 6e74 6174 696f 6e45 6469 746f  egmentationEdito
-0001d680: 722e 7175 6575 6564 5f65 7870 6f72 7473  r.queued_exports
-0001d690: 5b30 5d2e 7072 6f63 6573 732e 7072 6f67  [0].process.prog
-0001d6a0: 7265 7373 203d 3d20 302e 303a 0d0a 2020  ress == 0.0:..  
-0001d6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d6c0: 2020 5365 676d 656e 7461 7469 6f6e 4564    SegmentationEd
-0001d6d0: 6974 6f72 2e71 7565 7565 645f 6578 706f  itor.queued_expo
-0001d6e0: 7274 735b 305d 2e73 7461 7274 2829 0d0a  rts[0].start()..
-0001d6f0: 2020 2020 2020 2020 6578 6365 7074 2045          except E
-0001d700: 7863 6570 7469 6f6e 2061 7320 653a 0d0a  xception as e:..
-0001d710: 2020 2020 2020 2020 2020 2020 6366 672e              cfg.
-0001d720: 7365 745f 6572 726f 7228 652c 2022 436f  set_error(e, "Co
-0001d730: 756c 6420 6e6f 7420 6578 706f 7274 2076  uld not export v
-0001d740: 6f6c 756d 6573 202d 2073 6565 2064 6574  olumes - see det
-0001d750: 6169 6c73 2062 656c 6f77 3a22 290d 0a0d  ails below:")...
-0001d760: 0a20 2020 2064 6566 206c 6175 6e63 685f  .    def launch_
-0001d770: 6372 6561 7465 5f74 7261 696e 696e 675f  create_training_
-0001d780: 7365 7428 7365 6c66 293a 0d0a 2020 2020  set(self):..    
-0001d790: 2020 2020 706f 7369 7469 7665 5f66 6561      positive_fea
-0001d7a0: 7475 7265 5f6e 616d 6573 203d 206c 6973  ture_names = lis
-0001d7b0: 7428 290d 0a20 2020 2020 2020 206e 6567  t()..        neg
-0001d7c0: 6174 6976 655f 6665 6174 7572 655f 6e61  ative_feature_na
-0001d7d0: 6d65 7320 3d20 6c69 7374 2829 0d0a 2020  mes = list()..  
-0001d7e0: 2020 2020 2020 666f 7220 6620 696e 2073        for f in s
-0001d7f0: 656c 662e 616c 6c5f 6665 6174 7572 655f  elf.all_feature_
-0001d800: 6e61 6d65 733a 0d0a 2020 2020 2020 2020  names:..        
-0001d810: 2020 2020 6966 2073 656c 662e 7472 6169      if self.trai
-0001d820: 6e73 6574 5f66 6561 7475 7265 5f73 656c  nset_feature_sel
-0001d830: 6563 7469 6f6e 5b66 5d20 3d3d 2031 3a0d  ection[f] == 1:.
-0001d840: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001d850: 2070 6f73 6974 6976 655f 6665 6174 7572   positive_featur
-0001d860: 655f 6e61 6d65 732e 6170 7065 6e64 2866  e_names.append(f
-0001d870: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
-0001d880: 6c69 6620 7365 6c66 2e74 7261 696e 7365  lif self.trainse
-0001d890: 745f 6665 6174 7572 655f 7365 6c65 6374  t_feature_select
-0001d8a0: 696f 6e5b 665d 203d 3d20 2d31 3a0d 0a20  ion[f] == -1:.. 
-0001d8b0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-0001d8c0: 6567 6174 6976 655f 6665 6174 7572 655f  egative_feature_
-0001d8d0: 6e61 6d65 732e 6170 7065 6e64 2866 290d  names.append(f).
-0001d8e0: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
-0001d8f0: 706f 7369 7469 7665 5f66 6561 7475 7265  positive_feature
-0001d900: 5f6e 616d 6573 2920 3d3d 2030 3a0d 0a20  _names) == 0:.. 
-0001d910: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0001d920: 6e0d 0a20 2020 2020 2020 2070 6174 6820  n..        path 
-0001d930: 3d20 6669 6c65 6469 616c 6f67 2e61 736b  = filedialog.ask
-0001d940: 7361 7665 6173 6669 6c65 6e61 6d65 2866  saveasfilename(f
-0001d950: 696c 6574 7970 6573 3d5b 2822 7363 4e6f  iletypes=[("scNo
-0001d960: 6465 7320 7472 6169 6e64 6174 6122 2c20  des traindata", 
-0001d970: 6366 672e 6669 6c65 7479 7065 5f74 7261  cfg.filetype_tra
-0001d980: 696e 6461 7461 295d 2c20 696e 6974 6961  indata)], initia
-0001d990: 6c66 696c 653d 6622 7b73 656c 662e 7472  lfile=f"{self.tr
-0001d9a0: 6169 6e73 6574 5f62 6f78 7369 7a65 7d5f  ainset_boxsize}_
-0001d9b0: 7b53 6567 6d65 6e74 6174 696f 6e45 6469  {SegmentationEdi
-0001d9c0: 746f 722e 7472 6169 6e73 6574 5f61 7069  tor.trainset_api
-0001d9d0: 783a 2e33 667d 5f7b 706f 7369 7469 7665  x:.3f}_{positive
-0001d9e0: 5f66 6561 7475 7265 5f6e 616d 6573 5b30  _feature_names[0
-0001d9f0: 5d7d 2229 0d0a 2020 2020 2020 2020 6966  ]}")..        if
-0001da00: 2070 6174 6820 3d3d 2022 223a 0d0a 2020   path == "":..  
-0001da10: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0001da20: 0d0a 2020 2020 2020 2020 6966 2070 6174  ..        if pat
-0001da30: 685b 2d6c 656e 2863 6667 2e66 696c 6574  h[-len(cfg.filet
-0001da40: 7970 655f 7472 6169 6e64 6174 6129 3a5d  ype_traindata):]
-0001da50: 2021 3d20 6366 672e 6669 6c65 7479 7065   != cfg.filetype
-0001da60: 5f74 7261 696e 6461 7461 3a0d 0a20 2020  _traindata:..   
-0001da70: 2020 2020 2020 2020 2070 6174 6820 2b3d           path +=
-0001da80: 2063 6667 2e66 696c 6574 7970 655f 7472   cfg.filetype_tr
-0001da90: 6169 6e64 6174 610d 0a20 2020 2020 2020  aindata..       
-0001daa0: 2023 0d0a 0d0a 0d0a 2020 2020 2020 2020   #......        
-0001dab0: 6461 7461 7365 7473 5f74 6f5f 7361 6d70  datasets_to_samp
-0001dac0: 6c65 203d 206c 6973 7428 290d 0a20 2020  le = list()..   
-0001dad0: 2020 2020 2066 6f72 2064 6174 6173 6574       for dataset
-0001dae0: 2069 6e20 6366 672e 7365 5f66 7261 6d65   in cfg.se_frame
-0001daf0: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
-0001db00: 6966 2064 6174 6173 6574 2e73 616d 706c  if dataset.sampl
-0001db10: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-0001db20: 2020 2020 6461 7461 7365 7473 5f74 6f5f      datasets_to_
-0001db30: 7361 6d70 6c65 2e61 7070 656e 6428 6461  sample.append(da
-0001db40: 7461 7365 7429 0d0a 0d0a 2020 2020 2020  taset)....      
-0001db50: 2020 6e5f 626f 7865 7320 3d20 7365 6c66    n_boxes = self
-0001db60: 2e74 7261 696e 7365 745f 6e75 6d5f 626f  .trainset_num_bo
-0001db70: 7865 735f 706f 7369 7469 7665 202b 2073  xes_positive + s
-0001db80: 656c 662e 7472 6169 6e73 6574 5f6e 756d  elf.trainset_num
-0001db90: 5f62 6f78 6573 5f6e 6567 6174 6976 650d  _boxes_negative.
-0001dba0: 0a20 2020 2020 2020 2069 6620 6e5f 626f  .        if n_bo
-0001dbb0: 7865 7320 3d3d 2030 3a0d 0a20 2020 2020  xes == 0:..     
-0001dbc0: 2020 2020 2020 2072 6574 7572 6e0d 0a20         return.. 
-0001dbd0: 2020 2020 2020 2061 7267 7320 3d20 2870         args = (p
-0001dbe0: 6174 682c 206e 5f62 6f78 6573 2c20 706f  ath, n_boxes, po
-0001dbf0: 7369 7469 7665 5f66 6561 7475 7265 5f6e  sitive_feature_n
-0001dc00: 616d 6573 2c20 6e65 6761 7469 7665 5f66  ames, negative_f
-0001dc10: 6561 7475 7265 5f6e 616d 6573 2c20 6461  eature_names, da
-0001dc20: 7461 7365 7473 5f74 6f5f 7361 6d70 6c65  tasets_to_sample
-0001dc30: 2c20 7365 6c66 2e74 7261 696e 7365 745f  , self.trainset_
-0001dc40: 626f 7873 697a 652c 2053 6567 6d65 6e74  boxsize, Segment
-0001dc50: 6174 696f 6e45 6469 746f 722e 7472 6169  ationEditor.trai
-0001dc60: 6e73 6574 5f61 7069 7829 0d0a 0d0a 2020  nset_apix)....  
-0001dc70: 2020 2020 2020 7072 6f63 6573 7320 3d20        process = 
-0001dc80: 4261 636b 6772 6f75 6e64 5072 6f63 6573  BackgroundProces
-0001dc90: 7328 7365 6c66 2e5f 6372 6561 7465 5f74  s(self._create_t
-0001dca0: 7261 696e 696e 675f 7365 742c 2061 7267  raining_set, arg
-0001dcb0: 7329 0d0a 2020 2020 2020 2020 7072 6f63  s)..        proc
-0001dcc0: 6573 732e 7374 6172 7428 290d 0a20 2020  ess.start()..   
-0001dcd0: 2020 2020 2073 656c 662e 6163 7469 7665       self.active
-0001dce0: 5f74 7261 696e 7365 745f 6578 706f 7274  _trainset_export
-0001dcf0: 732e 6170 7065 6e64 2870 726f 6365 7373  s.append(process
-0001dd00: 290d 0a0d 0a20 2020 2064 6566 205f 6372  )....    def _cr
-0001dd10: 6561 7465 5f74 7261 696e 696e 675f 7365  eate_training_se
-0001dd20: 7428 7365 6c66 2c20 7061 7468 2c20 6e5f  t(self, path, n_
-0001dd30: 626f 7865 732c 2070 6f73 6974 6976 6573  boxes, positives
-0001dd40: 2c20 6e65 6761 7469 7665 732c 2064 6174  , negatives, dat
-0001dd50: 6173 6574 732c 2062 6f78 7369 7a65 2c20  asets, boxsize, 
-0001dd60: 6170 6978 2c20 7072 6f63 6573 7329 3a0d  apix, process):.
-0001dd70: 0a20 2020 2020 2020 2070 6f73 6974 6976  .        positiv
-0001dd80: 6520 3d20 6c69 7374 2829 0d0a 2020 2020  e = list()..    
-0001dd90: 2020 2020 6e65 6761 7469 7665 203d 206c      negative = l
-0001dda0: 6973 7428 290d 0a0d 0a20 2020 2020 2020  ist()....       
-0001ddb0: 206e 5f64 6f6e 6520 3d20 300d 0a20 2020   n_done = 0..   
-0001ddc0: 2020 2020 2074 6172 6765 745f 7479 7065       target_type
-0001ddd0: 5f64 6963 7420 3d20 7b6e 702e 666c 6f61  _dict = {np.floa
-0001dde0: 7433 323a 2066 6c6f 6174 2c20 666c 6f61  t32: float, floa
-0001ddf0: 743a 2066 6c6f 6174 2c20 6e70 2e64 7479  t: float, np.dty
-0001de00: 7065 2827 696e 7438 2729 3a20 6e70 2e64  pe('int8'): np.d
-0001de10: 7479 7065 2827 7569 6e74 3827 292c 206e  type('uint8'), n
-0001de20: 702e 6474 7970 6528 2769 6e74 3136 2729  p.dtype('int16')
-0001de30: 3a20 6e70 2e64 7479 7065 2827 666c 6f61  : np.dtype('floa
-0001de40: 7433 3227 297d 0d0a 2020 2020 2020 2020  t32')}..        
-0001de50: 666f 7220 6420 696e 2064 6174 6173 6574  for d in dataset
-0001de60: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
-0001de70: 6d72 6366 203d 206d 7263 6669 6c65 2e6d  mrcf = mrcfile.m
-0001de80: 6d61 7028 642e 7061 7468 2c20 6d6f 6465  map(d.path, mode
-0001de90: 3d22 7222 2c20 7065 726d 6973 7369 7665  ="r", permissive
-0001dea0: 3d54 7275 6529 0d0a 2020 2020 2020 2020  =True)..        
-0001deb0: 2020 2020 7261 775f 7479 7065 203d 206d      raw_type = m
-0001dec0: 7263 662e 6461 7461 2e64 7479 7065 0d0a  rcf.data.dtype..
-0001ded0: 2020 2020 2020 2020 2020 2020 6f75 745f              out_
-0001dee0: 7479 7065 203d 2066 6c6f 6174 0d0a 2020  type = float..  
-0001def0: 2020 2020 2020 2020 2020 6966 2072 6177            if raw
-0001df00: 5f74 7970 6520 696e 2074 6172 6765 745f  _type in target_
-0001df10: 7479 7065 5f64 6963 743a 0d0a 2020 2020  type_dict:..    
-0001df20: 2020 2020 2020 2020 2020 2020 6f75 745f              out_
-0001df30: 7479 7065 203d 2074 6172 6765 745f 7479  type = target_ty
-0001df40: 7065 5f64 6963 745b 7261 775f 7479 7065  pe_dict[raw_type
-0001df50: 5d0d 0a0d 0a20 2020 2020 2020 2020 2020  ]....           
-0001df60: 2077 203d 2064 2e77 6964 7468 0d0a 2020   w = d.width..  
-0001df70: 2020 2020 2020 2020 2020 6820 3d20 642e            h = d.
-0001df80: 6865 6967 6874 0d0a 2020 2020 2020 2020  height..        
-0001df90: 2020 2020 6372 6f70 5f70 7820 3d20 696e      crop_px = in
-0001dfa0: 7428 6e70 2e63 6569 6c28 2862 6f78 7369  t(np.ceil((boxsi
-0001dfb0: 7a65 202a 2061 7069 7829 202f 2028 642e  ze * apix) / (d.
-0001dfc0: 7069 7865 6c5f 7369 7a65 202a 2031 302e  pixel_size * 10.
-0001dfd0: 3029 2929 2020 2320 7369 7a65 2074 6f20  0)))  # size to 
-0001dfe0: 6372 6f70 2073 6f20 7468 6174 2074 6865  crop so that the
-0001dff0: 2063 726f 7020 636f 6e74 6169 6e73 2061   crop contains a
-0001e000: 7420 6c65 6173 7420 6120 626f 7873 697a  t least a boxsiz
-0001e010: 652a 6170 6978 2073 697a 6564 2072 6567  e*apix sized reg
-0001e020: 696f 6e0d 0a20 2020 2020 2020 2020 2020  ion..           
-0001e030: 2073 6361 6c65 5f66 6163 203d 2028 642e   scale_fac = (d.
-0001e040: 7069 7865 6c5f 7369 7a65 202a 2031 302e  pixel_size * 10.
-0001e050: 3029 202f 2061 7069 7820 2023 2068 6f77  0) / apix  # how
-0001e060: 206d 7563 6820 746f 2073 6361 6c65 2074   much to scale t
-0001e070: 6865 2063 726f 7070 6564 2069 6d61 6765  he cropped image
-0001e080: 732e 0d0a 2020 2020 2020 2020 2020 2020  s...            
-0001e090: 6e6d 203d 2069 6e74 286e 702e 666c 6f6f  nm = int(np.floo
-0001e0a0: 7228 6372 6f70 5f70 7820 2f20 3229 290d  r(crop_px / 2)).
-0001e0b0: 0a20 2020 2020 2020 2020 2020 2070 6d20  .            pm 
-0001e0c0: 3d20 696e 7428 6e70 2e63 6569 6c28 6372  = int(np.ceil(cr
-0001e0d0: 6f70 5f70 7820 2f20 3229 290d 0a20 2020  op_px / 2))..   
-0001e0e0: 2020 2020 2020 2020 2069 735f 706f 7369           is_posi
-0001e0f0: 7469 7665 203d 2054 7275 650d 0a20 2020  tive = True..   
-0001e100: 2020 2020 2020 2020 2023 2066 696e 6420           # find 
-0001e110: 616c 6c20 626f 7865 730d 0a20 2020 2020  all boxes..     
-0001e120: 2020 2020 2020 2066 6f72 2066 2069 6e20         for f in 
-0001e130: 642e 6665 6174 7572 6573 3a0d 0a20 2020  d.features:..   
-0001e140: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0001e150: 662e 7469 746c 6520 696e 2070 6f73 6974  f.title in posit
-0001e160: 6976 6573 3a0d 0a20 2020 2020 2020 2020  ives:..         
-0001e170: 2020 2020 2020 2020 2020 2069 735f 706f             is_po
-0001e180: 7369 7469 7665 203d 2054 7275 650d 0a20  sitive = True.. 
-0001e190: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0001e1a0: 6c69 6620 662e 7469 746c 6520 696e 206e  lif f.title in n
-0001e1b0: 6567 6174 6976 6573 3a0d 0a20 2020 2020  egatives:..     
-0001e1c0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0001e1d0: 735f 706f 7369 7469 7665 203d 2046 616c  s_positive = Fal
-0001e1e0: 7365 0d0a 2020 2020 2020 2020 2020 2020  se..            
-0001e1f0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-0001e200: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-0001e210: 6f6e 7469 6e75 650d 0a0d 0a20 2020 2020  ontinue....     
-0001e220: 2020 2020 2020 2020 2020 2023 2066 696e             # fin
-0001e230: 6420 626f 7865 730d 0a20 2020 2020 2020  d boxes..       
-0001e240: 2020 2020 2020 2020 2066 6f72 207a 2069           for z i
-0001e250: 6e20 662e 626f 7865 732e 6b65 7973 2829  n f.boxes.keys()
-0001e260: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0001e270: 2020 2020 2020 2069 6620 662e 626f 7865         if f.boxe
-0001e280: 735b 7a5d 2069 7320 6e6f 7420 4e6f 6e65  s[z] is not None
-0001e290: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0001e2a0: 2020 2020 2020 2020 2020 2066 6f72 2028             for (
-0001e2b0: 782c 2079 2920 696e 2066 2e62 6f78 6573  x, y) in f.boxes
-0001e2c0: 5b7a 5d3a 0d0a 2020 2020 2020 2020 2020  [z]:..          
-0001e2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e2e0: 2020 785f 6d69 6e20 3d20 2878 2d6e 6d29    x_min = (x-nm)
-0001e2f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001e300: 2020 2020 2020 2020 2020 2020 2020 785f                x_
-0001e310: 6d61 7820 3d20 2878 2b70 6d29 0d0a 2020  max = (x+pm)..  
-0001e320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e330: 2020 2020 2020 2020 2020 795f 6d69 6e20            y_min 
-0001e340: 3d20 2879 2d6e 6d29 0d0a 2020 2020 2020  = (y-nm)..      
-0001e350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e360: 2020 2020 2020 795f 6d61 7820 3d20 2879        y_max = (y
-0001e370: 2b70 6d29 0d0a 2020 2020 2020 2020 2020  +pm)..          
-0001e380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e390: 2020 6966 2078 5f6d 696e 203e 2030 2061    if x_min > 0 a
-0001e3a0: 6e64 2079 5f6d 696e 203e 2030 2061 6e64  nd y_min > 0 and
-0001e3b0: 2078 5f6d 6178 203c 2077 2061 6e64 2079   x_max < w and y
-0001e3c0: 5f6d 6178 203c 2068 3a0d 0a20 2020 2020  _max < h:..     
-0001e3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e3e0: 2020 2020 2020 2020 2020 2069 6d61 6765             image
-0001e3f0: 203d 206e 702e 666c 6970 7564 286d 7263   = np.flipud(mrc
-0001e400: 662e 6461 7461 5b7a 2c20 795f 6d69 6e3a  f.data[z, y_min:
-0001e410: 795f 6d61 782c 2078 5f6d 696e 3a78 5f6d  y_max, x_min:x_m
-0001e420: 6178 5d29 0d0a 2020 2020 2020 2020 2020  ax])..          
-0001e430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e440: 2020 2020 2020 696d 6167 6520 3d20 6e70        image = np
-0001e450: 2e61 7272 6179 2869 6d61 6765 2e61 7374  .array(image.ast
-0001e460: 7970 6528 6f75 745f 7479 7065 2c20 636f  ype(out_type, co
-0001e470: 7079 3d46 616c 7365 292c 2064 7479 7065  py=False), dtype
-0001e480: 3d66 6c6f 6174 290d 0a20 2020 2020 2020  =float)..       
-0001e490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e4a0: 2020 2020 2020 2020 2069 6d61 6765 203d           image =
-0001e4b0: 207a 6f6f 6d28 696d 6167 652c 2073 6361   zoom(image, sca
-0001e4c0: 6c65 5f66 6163 290d 0a20 2020 2020 2020  le_fac)..       
-0001e4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e4e0: 2020 2020 2020 2020 2069 6d61 6765 203d           image =
-0001e4f0: 2069 6d61 6765 5b3a 626f 7873 697a 652c   image[:boxsize,
-0001e500: 203a 626f 7873 697a 655d 0d0a 2020 2020   :boxsize]..    
-0001e510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e520: 2020 2020 2020 2020 2020 2020 6966 207a              if z
-0001e530: 2069 6e20 662e 736c 6963 6573 2061 6e64   in f.slices and
-0001e540: 2066 2e73 6c69 6365 735b 7a5d 2069 7320   f.slices[z] is 
-0001e550: 6e6f 7420 4e6f 6e65 2061 6e64 2069 735f  not None and is_
-0001e560: 706f 7369 7469 7665 3a0d 0a20 2020 2020  positive:..     
-0001e570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e580: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001e590: 6567 6d65 6e74 6174 696f 6e20 3d20 6e70  egmentation = np
-0001e5a0: 2e66 6c69 7075 6428 662e 736c 6963 6573  .flipud(f.slices
-0001e5b0: 5b7a 5d5b 795f 6d69 6e3a 795f 6d61 782c  [z][y_min:y_max,
-0001e5c0: 2078 5f6d 696e 3a78 5f6d 6178 5d29 0d0a   x_min:x_max])..
-0001e5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e5f0: 2020 2020 7365 676d 656e 7461 7469 6f6e      segmentation
-0001e600: 203d 207a 6f6f 6d28 7365 676d 656e 7461   = zoom(segmenta
-0001e610: 7469 6f6e 2c20 7363 616c 655f 6661 6329  tion, scale_fac)
-0001e620: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001e630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e640: 2020 2020 2020 7365 676d 656e 7461 7469        segmentati
-0001e650: 6f6e 203d 2073 6567 6d65 6e74 6174 696f  on = segmentatio
-0001e660: 6e5b 3a62 6f78 7369 7a65 2c20 3a62 6f78  n[:boxsize, :box
-0001e670: 7369 7a65 5d0d 0a20 2020 2020 2020 2020  size]..         
-0001e680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e690: 2020 2020 2020 2020 2020 2073 6567 6d65             segme
-0001e6a0: 6e74 6174 696f 6e20 3d20 7a6f 6f6d 2873  ntation = zoom(s
-0001e6b0: 6567 6d65 6e74 6174 696f 6e2c 2073 6361  egmentation, sca
-0001e6c0: 6c65 5f66 6163 290d 0a20 2020 2020 2020  le_fac)..       
-0001e6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e6e0: 2020 2020 2020 2020 2020 2020 2073 6567               seg
-0001e6f0: 6d65 6e74 6174 696f 6e20 3d20 7365 676d  mentation = segm
-0001e700: 656e 7461 7469 6f6e 5b3a 626f 7873 697a  entation[:boxsiz
-0001e710: 652c 203a 626f 7873 697a 655d 0d0a 2020  e, :boxsize]..  
-0001e720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e730: 2020 2020 2020 2020 2020 2020 2020 656c                el
-0001e740: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-0001e750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e760: 2020 2020 2020 2020 2073 6567 6d65 6e74           segment
-0001e770: 6174 696f 6e20 3d20 6e70 2e7a 6572 6f73  ation = np.zeros
-0001e780: 5f6c 696b 6528 696d 6167 6529 0d0a 2020  _like(image)..  
-0001e790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e7a0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0001e7b0: 2069 735f 706f 7369 7469 7665 3a0d 0a20   is_positive:.. 
-0001e7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e7e0: 2020 2070 6f73 6974 6976 652e 6170 7065     positive.appe
-0001e7f0: 6e64 285b 696d 6167 652c 2073 6567 6d65  nd([image, segme
-0001e800: 6e74 6174 696f 6e5d 290d 0a20 2020 2020  ntation])..     
-0001e810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e820: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-0001e830: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001e840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e850: 2020 2020 2020 6e65 6761 7469 7665 2e61        negative.a
-0001e860: 7070 656e 6428 5b69 6d61 6765 2c20 7365  ppend([image, se
-0001e870: 676d 656e 7461 7469 6f6e 5d29 0d0a 2020  gmentation])..  
-0001e880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e890: 2020 2020 2020 2020 2020 6e5f 646f 6e65            n_done
-0001e8a0: 202b 3d20 310d 0a20 2020 2020 2020 2020   += 1..         
-0001e8b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e8c0: 2020 2070 726f 6365 7373 2e73 6574 5f70     process.set_p
-0001e8d0: 726f 6772 6573 7328 6e5f 646f 6e65 202f  rogress(n_done /
-0001e8e0: 206e 5f62 6f78 6573 290d 0a0d 0a20 2020   n_boxes)....   
-0001e8f0: 2020 2020 2069 6620 6e6f 7420 6e65 6761       if not nega
-0001e900: 7469 7665 3a0d 0a20 2020 2020 2020 2020  tive:..         
-0001e910: 2020 2061 6c6c 5f69 6d67 7320 3d20 6e70     all_imgs = np
-0001e920: 2e61 7272 6179 2870 6f73 6974 6976 6529  .array(positive)
-0001e930: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
-0001e940: 0a20 2020 2020 2020 2020 2020 2061 6c6c  .            all
-0001e950: 5f69 6d67 7320 3d20 6e70 2e61 7272 6179  _imgs = np.array
-0001e960: 2870 6f73 6974 6976 6520 2b20 6e65 6761  (positive + nega
-0001e970: 7469 7665 290d 0a20 2020 2020 2020 2074  tive)..        t
-0001e980: 6966 6666 696c 652e 696d 7772 6974 6528  ifffile.imwrite(
-0001e990: 7061 7468 2c20 616c 6c5f 696d 6773 2c20  path, all_imgs, 
-0001e9a0: 6465 7363 7269 7074 696f 6e3d 6622 6170  description=f"ap
-0001e9b0: 6978 3d7b 6170 6978 3a2e 3266 7d22 290d  ix={apix:.2f}").
-0001e9c0: 0a0d 0a20 2020 2040 7374 6174 6963 6d65  ...    @staticme
-0001e9d0: 7468 6f64 0d0a 2020 2020 6465 6620 7365  thod..    def se
-0001e9e0: 6672 616d 655f 6672 6f6d 5f63 6c65 6d66  frame_from_clemf
-0001e9f0: 7261 6d65 2863 6c65 6d66 7261 6d65 293a  rame(clemframe):
-0001ea00: 0d0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
-0001ea10: 206f 732e 7061 7468 2e65 7869 7374 7328   os.path.exists(
-0001ea20: 636c 656d 6672 616d 652e 7061 7468 293a  clemframe.path):
-0001ea30: 0d0a 2020 2020 2020 2020 2020 2020 6366  ..            cf
-0001ea40: 672e 7365 745f 6572 726f 7228 4578 6365  g.set_error(Exce
-0001ea50: 7074 696f 6e28 6622 4e6f 2066 696c 6520  ption(f"No file 
-0001ea60: 6578 6973 7473 2061 7420 7061 7468 207b  exists at path {
-0001ea70: 636c 656d 6672 616d 652e 7061 7468 7d22  clemframe.path}"
-0001ea80: 292c 2022 436f 756c 6420 6e6f 7420 636f  ), "Could not co
-0001ea90: 6e76 6572 7420 434c 454d 4672 616d 6520  nvert CLEMFrame 
-0001eaa0: 746f 2053 4546 7261 6d65 202d 2073 6565  to SEFrame - see
-0001eab0: 2062 656c 6f77 2e22 290d 0a20 2020 2020   below.")..     
-0001eac0: 2020 2020 2020 2072 6574 7572 6e0d 0a20         return.. 
-0001ead0: 2020 2020 2020 206e 6577 5f73 655f 6672         new_se_fr
-0001eae0: 616d 6520 3d20 5345 4672 616d 6528 636c  ame = SEFrame(cl
-0001eaf0: 656d 6672 616d 652e 7061 7468 290d 0a20  emframe.path).. 
-0001eb00: 2020 2020 2020 206e 6577 5f73 655f 6672         new_se_fr
-0001eb10: 616d 652e 636c 656d 5f66 7261 6d65 203d  ame.clem_frame =
-0001eb20: 2063 6c65 6d66 7261 6d65 0d0a 2020 2020   clemframe..    
-0001eb30: 2020 2020 6e65 775f 7365 5f66 7261 6d65      new_se_frame
-0001eb40: 2e63 6c65 6d5f 6672 616d 655f 7061 7468  .clem_frame_path
-0001eb50: 203d 2063 6c65 6d66 7261 6d65 2e70 6174   = clemframe.pat
-0001eb60: 680d 0a20 2020 2020 2020 206e 6577 5f73  h..        new_s
-0001eb70: 655f 6672 616d 652e 6175 746f 636f 6e74  e_frame.autocont
-0001eb80: 7261 7374 203d 2046 616c 7365 0d0a 2020  rast = False..  
-0001eb90: 2020 2020 2020 6e65 775f 7365 5f66 7261        new_se_fra
-0001eba0: 6d65 2e74 6974 6c65 203d 2063 6c65 6d66  me.title = clemf
-0001ebb0: 7261 6d65 2e74 6974 6c65 0d0a 2020 2020  rame.title..    
-0001ebc0: 2020 2020 6e65 775f 7365 5f66 7261 6d65      new_se_frame
-0001ebd0: 2e63 6f6e 7472 6173 745f 6c69 6d73 203d  .contrast_lims =
-0001ebe0: 2063 6c65 6d66 7261 6d65 2e63 6f6e 7472   clemframe.contr
-0001ebf0: 6173 745f 6c69 6d73 0d0a 2020 2020 2020  ast_lims..      
-0001ec00: 2020 6e65 775f 7365 5f66 7261 6d65 2e73    new_se_frame.s
-0001ec10: 6574 5f73 6c69 6365 2863 6c65 6d66 7261  et_slice(clemfra
-0001ec20: 6d65 2e63 7572 7265 6e74 5f73 6c69 6365  me.current_slice
-0001ec30: 290d 0a0d 0a20 2020 2020 2020 2063 6667  )....        cfg
-0001ec40: 2e73 655f 6672 616d 6573 2e61 7070 656e  .se_frames.appen
-0001ec50: 6428 6e65 775f 7365 5f66 7261 6d65 290d  d(new_se_frame).
-0001ec60: 0a20 2020 2020 2020 2053 6567 6d65 6e74  .        Segment
-0001ec70: 6174 696f 6e45 6469 746f 722e 7365 745f  ationEditor.set_
-0001ec80: 6163 7469 7665 5f64 6174 6173 6574 2863  active_dataset(c
-0001ec90: 6667 2e73 655f 6672 616d 6573 5b2d 315d  fg.se_frames[-1]
-0001eca0: 290d 0a20 2020 2020 2020 2072 6574 7572  )..        retur
-0001ecb0: 6e20 6366 672e 7365 5f66 7261 6d65 735b  n cfg.se_frames[
-0001ecc0: 2d31 5d0d 0a0d 0a20 2020 2040 7374 6174  -1]....    @stat
-0001ecd0: 6963 6d65 7468 6f64 0d0a 2020 2020 6465  icmethod..    de
-0001ece0: 6620 6c6f 6164 5f6d 6f64 656c 5f67 726f  f load_model_gro
-0001ecf0: 7570 2870 6174 6829 3a0d 0a20 2020 2020  up(path):..     
-0001ed00: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
-0001ed10: 2020 2020 2077 6974 6820 7465 6d70 6669       with tempfi
-0001ed20: 6c65 2e54 656d 706f 7261 7279 4469 7265  le.TemporaryDire
-0001ed30: 6374 6f72 7928 2920 6173 2074 656d 705f  ctory() as temp_
-0001ed40: 6469 723a 0d0a 2020 2020 2020 2020 2020  dir:..          
-0001ed50: 2020 2020 2020 2320 4578 7472 6163 7420        # Extract 
-0001ed60: 7468 6520 2e74 6172 2e67 7a20 6172 6368  the .tar.gz arch
-0001ed70: 6976 6520 746f 2074 6865 2074 656d 706f  ive to the tempo
-0001ed80: 7261 7279 2064 6972 6563 746f 7279 0d0a  rary directory..
-0001ed90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001eda0: 7769 7468 2074 6172 6669 6c65 2e6f 7065  with tarfile.ope
-0001edb0: 6e28 7061 7468 2c20 2772 2729 2061 7320  n(path, 'r') as 
-0001edc0: 7461 723a 0d0a 2020 2020 2020 2020 2020  tar:..          
-0001edd0: 2020 2020 2020 2020 2020 7461 722e 6578            tar.ex
-0001ede0: 7472 6163 7461 6c6c 2870 6174 683d 7465  tractall(path=te
-0001edf0: 6d70 5f64 6972 290d 0a0d 0a20 2020 2020  mp_dir)....     
-0001ee00: 2020 2020 2020 2020 2020 2023 2041 7373             # Ass
-0001ee10: 756d 696e 6720 7468 6520 6669 7273 7420  uming the first 
-0001ee20: 6669 6c65 2069 7320 616c 7761 7973 2074  file is always t
-0001ee30: 6865 2069 6e74 6572 6163 7469 6f6e 7320  he interactions 
-0001ee40: 4a53 4f4e 2c0d 0a20 2020 2020 2020 2020  JSON,..         
-0001ee50: 2020 2020 2020 2023 2061 6e64 2074 6865         # and the
-0001ee60: 2072 6573 7420 6172 6520 6d6f 6465 6c20   rest are model 
-0001ee70: 6669 6c65 730d 0a20 2020 2020 2020 2020  files..         
-0001ee80: 2020 2020 2020 2066 696c 6573 203d 206f         files = o
-0001ee90: 732e 6c69 7374 6469 7228 7465 6d70 5f64  s.listdir(temp_d
-0001eea0: 6972 290d 0a20 2020 2020 2020 2020 2020  ir)..           
-0001eeb0: 2020 2020 206a 736f 6e5f 7061 7468 203d       json_path =
-0001eec0: 205b 6620 666f 7220 6620 696e 2066 696c   [f for f in fil
-0001eed0: 6573 2069 6620 662e 656e 6473 7769 7468  es if f.endswith
-0001eee0: 2827 5f69 6e74 6572 6163 7469 6f6e 732e  ('_interactions.
-0001eef0: 6a73 6f6e 2729 5d5b 305d 0d0a 2020 2020  json')][0]..    
-0001ef00: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
-0001ef10: 6c5f 6669 6c65 7320 3d20 5b66 2066 6f72  l_files = [f for
-0001ef20: 2066 2069 6e20 6669 6c65 7320 6966 2066   f in files if f
-0001ef30: 2021 3d20 6a73 6f6e 5f70 6174 685d 0d0a   != json_path]..
-0001ef40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001ef50: 2020 2320 4c6f 6164 206d 6f64 656c 730d    # Load models.
-0001ef60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001ef70: 2066 6f72 206d 5f66 696c 6520 696e 206d   for m_file in m
-0001ef80: 6f64 656c 5f66 696c 6573 3a0d 0a20 2020  odel_files:..   
-0001ef90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001efa0: 206d 6f64 656c 5f70 6174 6820 3d20 6f73   model_path = os
-0001efb0: 2e70 6174 682e 6a6f 696e 2874 656d 705f  .path.join(temp_
-0001efc0: 6469 722c 206d 5f66 696c 6529 0d0a 2020  dir, m_file)..  
-0001efd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001efe0: 2020 2320 4173 7375 6d69 6e67 2053 454d    # Assuming SEM
-0001eff0: 6f64 656c 2068 6173 2061 206c 6f61 6420  odel has a load 
-0001f000: 6d65 7468 6f64 2074 6861 7420 6163 6365  method that acce
-0001f010: 7074 7320 6120 6669 6c65 2070 6174 680d  pts a file path.
-0001f020: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001f030: 2020 2020 206d 6f64 656c 203d 2053 454d       model = SEM
-0001f040: 6f64 656c 2829 0d0a 2020 2020 2020 2020  odel()..        
-0001f050: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
-0001f060: 6c2e 6c6f 6164 286d 6f64 656c 5f70 6174  l.load(model_pat
-0001f070: 6829 0d0a 2020 2020 2020 2020 2020 2020  h)..            
-0001f080: 2020 2020 2020 2020 6366 672e 7365 5f6d          cfg.se_m
-0001f090: 6f64 656c 732e 6170 7065 6e64 286d 6f64  odels.append(mod
-0001f0a0: 656c 290d 0a0d 0a20 2020 2020 2020 2020  el)....         
-0001f0b0: 2020 2020 2020 2023 204c 6f61 6420 696e         # Load in
-0001f0c0: 7465 7261 6374 696f 6e73 0d0a 2020 2020  teractions..    
-0001f0d0: 2020 2020 2020 2020 2020 2020 7769 7468              with
-0001f0e0: 206f 7065 6e28 6f73 2e70 6174 682e 6a6f   open(os.path.jo
-0001f0f0: 696e 2874 656d 705f 6469 722c 206a 736f  in(temp_dir, jso
-0001f100: 6e5f 7061 7468 292c 2027 7227 2920 6173  n_path), 'r') as
-0001f110: 2066 3a0d 0a20 2020 2020 2020 2020 2020   f:..           
-0001f120: 2020 2020 2020 2020 2069 6e74 6572 6163           interac
-0001f130: 7469 6f6e 5f64 6963 745f 6c69 7374 203d  tion_dict_list =
-0001f140: 206a 736f 6e2e 6c6f 6164 2866 290d 0a20   json.load(f).. 
-0001f150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f160: 2020 2066 6f72 2064 2069 6e20 696e 7465     for d in inte
-0001f170: 7261 6374 696f 6e5f 6469 6374 5f6c 6973  raction_dict_lis
-0001f180: 743a 0d0a 2020 2020 2020 2020 2020 2020  t:..            
-0001f190: 2020 2020 2020 2020 2020 2020 4d6f 6465              Mode
-0001f1a0: 6c49 6e74 6572 6163 7469 6f6e 2e66 726f  lInteraction.fro
-0001f1b0: 6d5f 6469 6374 2864 290d 0a0d 0a20 2020  m_dict(d)....   
-0001f1c0: 2020 2020 2065 7863 6570 7420 4578 6365       except Exce
-0001f1d0: 7074 696f 6e20 6173 2065 3a0d 0a20 2020  ption as e:..   
-0001f1e0: 2020 2020 2020 2020 2063 6667 2e73 6574           cfg.set
-0001f1f0: 5f65 7272 6f72 2865 2c20 2245 7272 6f72  _error(e, "Error
-0001f200: 206c 6f61 6469 6e67 206d 6f64 656c 2067   loading model g
-0001f210: 726f 7570 2c20 7365 6520 6465 7461 696c  roup, see detail
-0001f220: 7320 6265 6c6f 772e 2229 0d0a 0d0a 2020  s below.")....  
-0001f230: 2020 4073 7461 7469 636d 6574 686f 640d    @staticmethod.
-0001f240: 0a20 2020 2064 6566 206c 6f61 645f 6d6f  .    def load_mo
-0001f250: 6465 6c28 7061 7468 293a 0d0a 2020 2020  del(path):..    
-0001f260: 2020 2020 7472 793a 0d0a 2020 2020 2020      try:..      
-0001f270: 2020 2020 2020 6d6f 6465 6c20 3d20 5345        model = SE
-0001f280: 4d6f 6465 6c28 290d 0a20 2020 2020 2020  Model()..       
-0001f290: 2020 2020 206d 6f64 656c 2e6c 6f61 6428       model.load(
-0001f2a0: 7061 7468 290d 0a20 2020 2020 2020 2020  path)..         
-0001f2b0: 2020 2063 6667 2e73 655f 6d6f 6465 6c73     cfg.se_models
-0001f2c0: 2e61 7070 656e 6428 6d6f 6465 6c29 0d0a  .append(model)..
-0001f2d0: 2020 2020 2020 2020 6578 6365 7074 2045          except E
-0001f2e0: 7863 6570 7469 6f6e 2061 7320 653a 0d0a  xception as e:..
-0001f2f0: 2020 2020 2020 2020 2020 2020 6366 672e              cfg.
-0001f300: 7365 745f 6572 726f 7228 652c 2022 4572  set_error(e, "Er
-0001f310: 726f 7220 6c6f 6164 696e 6720 6d6f 6465  ror loading mode
-0001f320: 6c2c 2073 6565 2064 6574 6169 6c73 2062  l, see details b
-0001f330: 656c 6f77 2e22 290d 0a0d 0a20 2020 2040  elow.")....    @
-0001f340: 7374 6174 6963 6d65 7468 6f64 0d0a 2020  staticmethod..  
-0001f350: 2020 6465 6620 7361 7665 5f6d 6f64 656c    def save_model
-0001f360: 5f67 726f 7570 2870 6174 6829 3a0d 0a20  _group(path):.. 
-0001f370: 2020 2020 2020 2074 7279 3a0d 0a20 2020         try:..   
-0001f380: 2020 2020 2020 2020 2067 726f 7570 5f6e           group_n
-0001f390: 616d 6520 3d20 6f73 2e70 6174 682e 7370  ame = os.path.sp
-0001f3a0: 6c69 7465 7874 286f 732e 7061 7468 2e62  litext(os.path.b
-0001f3b0: 6173 656e 616d 6528 7061 7468 2929 5b30  asename(path))[0
-0001f3c0: 5d0d 0a0d 0a20 2020 2020 2020 2020 2020  ]....           
-0001f3d0: 2023 2043 7265 6174 6520 6120 7465 6d70   # Create a temp
-0001f3e0: 6f72 6172 7920 6469 7265 6374 6f72 7920  orary directory 
-0001f3f0: 746f 2068 6f6c 6420 7468 6520 6669 6c65  to hold the file
-0001f400: 7320 6265 666f 7265 2061 7263 6869 7669  s before archivi
-0001f410: 6e67 0d0a 2020 2020 2020 2020 2020 2020  ng..            
-0001f420: 7769 7468 2074 656d 7066 696c 652e 5465  with tempfile.Te
-0001f430: 6d70 6f72 6172 7944 6972 6563 746f 7279  mporaryDirectory
-0001f440: 2829 2061 7320 7465 6d70 5f64 6972 3a0d  () as temp_dir:.
-0001f450: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001f460: 206d 6f64 656c 5f70 6174 6873 203d 206c   model_paths = l
-0001f470: 6973 7428 290d 0a20 2020 2020 2020 2020  ist()..         
-0001f480: 2020 2020 2020 2069 203d 2030 0d0a 2020         i = 0..  
-0001f490: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-0001f4a0: 7220 6d20 696e 2063 6667 2e73 655f 6d6f  r m in cfg.se_mo
-0001f4b0: 6465 6c73 3a0d 0a20 2020 2020 2020 2020  dels:..         
-0001f4c0: 2020 2020 2020 2020 2020 206d 5f70 6174             m_pat
-0001f4d0: 6820 3d20 6f73 2e70 6174 682e 6a6f 696e  h = os.path.join
-0001f4e0: 2874 656d 705f 6469 722c 2067 726f 7570  (temp_dir, group
-0001f4f0: 5f6e 616d 6520 2b20 6622 5f6d 6f64 656c  _name + f"_model
-0001f500: 5f7b 697d 2220 2b20 6366 672e 6669 6c65  _{i}" + cfg.file
-0001f510: 7479 7065 5f73 656d 6f64 656c 290d 0a20  type_semodel).. 
-0001f520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f530: 2020 206d 2e73 6176 6528 6d5f 7061 7468     m.save(m_path
-0001f540: 2920 2023 2053 6176 6520 6d6f 6465 6c20  )  # Save model 
-0001f550: 6469 7265 6374 6c79 2074 6f20 7468 6520  directly to the 
-0001f560: 7465 6d70 6f72 6172 7920 6469 7265 6374  temporary direct
-0001f570: 6f72 790d 0a20 2020 2020 2020 2020 2020  ory..           
-0001f580: 2020 2020 2020 2020 206d 6f64 656c 5f70           model_p
-0001f590: 6174 6873 2e61 7070 656e 6428 6d5f 7061  aths.append(m_pa
-0001f5a0: 7468 290d 0a20 2020 2020 2020 2020 2020  th)..           
-0001f5b0: 2020 2020 2020 2020 2069 202b 3d20 310d           i += 1.
-0001f5c0: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
-0001f5d0: 2020 2023 2053 6176 6520 696e 7465 7261     # Save intera
-0001f5e0: 6374 696f 6e73 2061 7320 6a73 6f6e 2069  ctions as json i
-0001f5f0: 6e20 7468 6520 7465 6d70 6f72 6172 7920  n the temporary 
-0001f600: 6469 7265 6374 6f72 790d 0a20 2020 2020  directory..     
-0001f610: 2020 2020 2020 2020 2020 2069 6e74 6572             inter
-0001f620: 6163 7469 6f6e 5f64 6963 745f 6c69 7374  action_dict_list
-0001f630: 203d 206c 6973 7428 290d 0a20 2020 2020   = list()..     
-0001f640: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
-0001f650: 6e74 6572 6163 7469 6f6e 2069 6e20 4d6f  nteraction in Mo
-0001f660: 6465 6c49 6e74 6572 6163 7469 6f6e 2e61  delInteraction.a
-0001f670: 6c6c 3a0d 0a20 2020 2020 2020 2020 2020  ll:..           
-0001f680: 2020 2020 2020 2020 2069 6e74 6572 6163           interac
-0001f690: 7469 6f6e 5f64 6963 745f 6c69 7374 2e61  tion_dict_list.a
-0001f6a0: 7070 656e 6428 696e 7465 7261 6374 696f  ppend(interactio
-0001f6b0: 6e2e 6173 5f64 6963 7428 2929 0d0a 2020  n.as_dict())..  
-0001f6c0: 2020 2020 2020 2020 2020 2020 2020 6a73                js
-0001f6d0: 6f6e 5f70 6174 6820 3d20 6f73 2e70 6174  on_path = os.pat
-0001f6e0: 682e 6a6f 696e 2874 656d 705f 6469 722c  h.join(temp_dir,
-0001f6f0: 2066 227b 6772 6f75 705f 6e61 6d65 7d5f   f"{group_name}_
-0001f700: 696e 7465 7261 6374 696f 6e73 2e6a 736f  interactions.jso
-0001f710: 6e22 290d 0a20 2020 2020 2020 2020 2020  n")..           
-0001f720: 2020 2020 2077 6974 6820 6f70 656e 286a       with open(j
-0001f730: 736f 6e5f 7061 7468 2c20 2777 2729 2061  son_path, 'w') a
-0001f740: 7320 6f75 7466 696c 653a 0d0a 2020 2020  s outfile:..    
+0001c4c0: 2020 2069 6620 6674 722e 7469 746c 6520     if ftr.title 
+0001c4d0: 6e6f 7420 696e 2073 656c 662e 616c 6c5f  not in self.all_
+0001c4e0: 6665 6174 7572 655f 6e61 6d65 733a 0d0a  feature_names:..
+0001c4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c500: 2020 2020 2020 2020 7365 6c66 2e61 6c6c          self.all
+0001c510: 5f66 6561 7475 7265 5f6e 616d 6573 2e61  _feature_names.a
+0001c520: 7070 656e 6428 6674 722e 7469 746c 6529  ppend(ftr.title)
+0001c530: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001c540: 2020 2020 2020 6966 2066 7472 2e74 6974        if ftr.tit
+0001c550: 6c65 206e 6f74 2069 6e20 7365 6c66 2e74  le not in self.t
+0001c560: 7261 696e 7365 745f 6665 6174 7572 655f  rainset_feature_
+0001c570: 7365 6c65 6374 696f 6e3a 0d0a 2020 2020  selection:..    
+0001c580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c590: 2020 2020 7365 6c66 2e74 7261 696e 7365      self.trainse
+0001c5a0: 745f 6665 6174 7572 655f 7365 6c65 6374  t_feature_select
+0001c5b0: 696f 6e5b 6674 722e 7469 746c 655d 203d  ion[ftr.title] =
+0001c5c0: 2030 2e30 0d0a 2020 2020 2020 2020 2020   0.0..          
+0001c5d0: 2020 2020 2020 6966 2066 7472 2e74 6974        if ftr.tit
+0001c5e0: 6c65 206e 6f74 2069 6e20 7365 6c66 2e66  le not in self.f
+0001c5f0: 6561 7475 7265 5f63 6f6c 6f75 725f 6469  eature_colour_di
+0001c600: 6374 3a0d 0a20 2020 2020 2020 2020 2020  ct:..           
+0001c610: 2020 2020 2020 2020 2073 656c 662e 6665           self.fe
+0001c620: 6174 7572 655f 636f 6c6f 7572 5f64 6963  ature_colour_dic
+0001c630: 745b 6674 722e 7469 746c 655d 203d 2066  t[ftr.title] = f
+0001c640: 7472 2e63 6f6c 6f75 720d 0a20 2020 2020  tr.colour..     
+0001c650: 2020 2074 6f5f 706f 7020 3d20 6c69 7374     to_pop = list
+0001c660: 2829 0d0a 2020 2020 2020 2020 666f 7220  ()..        for 
+0001c670: 6b65 7920 696e 2073 656c 662e 7472 6169  key in self.trai
+0001c680: 6e73 6574 5f66 6561 7475 7265 5f73 656c  nset_feature_sel
+0001c690: 6563 7469 6f6e 2e6b 6579 7328 293a 0d0a  ection.keys():..
+0001c6a0: 2020 2020 2020 2020 2020 2020 6966 206b              if k
+0001c6b0: 6579 206e 6f74 2069 6e20 7365 6c66 2e61  ey not in self.a
+0001c6c0: 6c6c 5f66 6561 7475 7265 5f6e 616d 6573  ll_feature_names
+0001c6d0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0001c6e0: 2020 2074 6f5f 706f 702e 6170 7065 6e64     to_pop.append
+0001c6f0: 286b 6579 290d 0a20 2020 2020 2020 2066  (key)..        f
+0001c700: 6f72 206b 6579 2069 6e20 746f 5f70 6f70  or key in to_pop
+0001c710: 3a0d 0a20 2020 2020 2020 2020 2020 2073  :..            s
+0001c720: 656c 662e 7472 6169 6e73 6574 5f66 6561  elf.trainset_fea
+0001c730: 7475 7265 5f73 656c 6563 7469 6f6e 2e70  ture_selection.p
+0001c740: 6f70 286b 6579 290d 0a0d 0a20 2020 2064  op(key)....    d
+0001c750: 6566 205f 6775 695f 6261 636b 6772 6f75  ef _gui_backgrou
+0001c760: 6e64 5f70 726f 6365 7373 5f70 726f 6772  nd_process_progr
+0001c770: 6573 735f 6261 7228 7365 6c66 2c20 7072  ess_bar(self, pr
+0001c780: 6f63 6573 732c 2063 6f6c 6f75 723d 6366  ocess, colour=cf
+0001c790: 672e 434f 4c4f 5552 5f50 4f53 4954 4956  g.COLOUR_POSITIV
+0001c7a0: 452c 2063 616e 6365 6c6c 6162 6c65 3d46  E, cancellable=F
+0001c7b0: 616c 7365 2c20 6865 6967 6874 3d4e 6f6e  alse, height=Non
+0001c7c0: 652c 2074 7261 6e73 7061 7265 6e74 5f62  e, transparent_b
+0001c7d0: 6163 6b67 726f 756e 643d 4661 6c73 6529  ackground=False)
+0001c7e0: 3a0d 0a20 2020 2020 2020 2068 6569 6768  :..        heigh
+0001c7f0: 7420 3d20 5365 676d 656e 7461 7469 6f6e  t = Segmentation
+0001c800: 4564 6974 6f72 2e50 524f 4752 4553 535f  Editor.PROGRESS_
+0001c810: 4241 525f 4845 4947 4854 2069 6620 6865  BAR_HEIGHT if he
+0001c820: 6967 6874 2069 7320 4e6f 6e65 2065 6c73  ight is None els
+0001c830: 6520 6865 6967 6874 0d0a 2020 2020 2020  e height..      
+0001c840: 2020 6377 203d 2069 6d67 7569 2e67 6574    cw = imgui.get
+0001c850: 5f63 6f6e 7465 6e74 5f72 6567 696f 6e5f  _content_region_
+0001c860: 6176 6169 6c61 626c 655f 7769 6474 6828  available_width(
+0001c870: 290d 0a20 2020 2020 2020 2063 616e 6365  )..        cance
+0001c880: 6c5f 6275 7474 6f6e 5f77 203d 2053 6567  l_button_w = Seg
+0001c890: 6d65 6e74 6174 696f 6e45 6469 746f 722e  mentationEditor.
+0001c8a0: 5052 4f47 5245 5353 5f42 4152 5f48 4549  PROGRESS_BAR_HEI
+0001c8b0: 4748 5420 2b20 3520 6966 2063 616e 6365  GHT + 5 if cance
+0001c8c0: 6c6c 6162 6c65 2065 6c73 6520 300d 0a20  llable else 0.. 
+0001c8d0: 2020 2020 2020 206f 7269 6769 6e20 3d20         origin = 
+0001c8e0: 696d 6775 692e 6765 745f 7769 6e64 6f77  imgui.get_window
+0001c8f0: 5f70 6f73 6974 696f 6e28 290d 0a20 2020  _position()..   
+0001c900: 2020 2020 2079 203d 2069 6d67 7569 2e67       y = imgui.g
+0001c910: 6574 5f63 7572 736f 725f 7363 7265 656e  et_cursor_screen
+0001c920: 5f70 6f73 2829 5b31 5d0d 0a20 2020 2020  _pos()[1]..     
+0001c930: 2020 2064 7261 776c 6973 7420 3d20 696d     drawlist = im
+0001c940: 6775 692e 6765 745f 7769 6e64 6f77 5f64  gui.get_window_d
+0001c950: 7261 775f 6c69 7374 2829 0d0a 2020 2020  raw_list()..    
+0001c960: 2020 2020 6472 6177 6c69 7374 2e61 6464      drawlist.add
+0001c970: 5f72 6563 745f 6669 6c6c 6564 2838 202b  _rect_filled(8 +
+0001c980: 206f 7269 6769 6e5b 305d 2c20 792c 0d0a   origin[0], y,..
+0001c990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c9b0: 2038 202b 206f 7269 6769 6e5b 305d 202b   8 + origin[0] +
+0001c9c0: 206d 6178 2830 2c20 6377 202d 2063 616e   max(0, cw - can
+0001c9d0: 6365 6c5f 6275 7474 6f6e 5f77 292c 0d0a  cel_button_w),..
+0001c9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ca00: 2079 202b 2068 6569 6768 742c 0d0a 2020   y + height,..  
+0001ca10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ca20: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0001ca30: 6d67 7569 2e67 6574 5f63 6f6c 6f72 5f75  mgui.get_color_u
+0001ca40: 3332 5f72 6762 6128 2a63 6667 2e43 4f4c  32_rgba(*cfg.COL
+0001ca50: 4f55 525f 4e45 5554 5241 4c29 2069 6620  OUR_NEUTRAL) if 
+0001ca60: 6e6f 7420 7472 616e 7370 6172 656e 745f  not transparent_
+0001ca70: 6261 636b 6772 6f75 6e64 2065 6c73 6520  background else 
+0001ca80: 696d 6775 692e 6765 745f 636f 6c6f 725f  imgui.get_color_
+0001ca90: 7533 325f 7267 6261 2830 2e30 2c20 302e  u32_rgba(0.0, 0.
+0001caa0: 302c 2030 2e30 2c20 302e 3029 290d 0a20  0, 0.0, 0.0)).. 
+0001cab0: 2020 2020 2020 2064 7261 776c 6973 742e         drawlist.
+0001cac0: 6164 645f 7265 6374 5f66 696c 6c65 6428  add_rect_filled(
+0001cad0: 3820 2b20 6f72 6967 696e 5b30 5d2c 2079  8 + origin[0], y
+0001cae0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0001caf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cb00: 2020 2020 3820 2b20 6f72 6967 696e 5b30      8 + origin[0
+0001cb10: 5d20 2b20 6d61 7828 302c 2063 7720 2a20  ] + max(0, cw * 
+0001cb20: 6d69 6e28 5b31 2e30 2c20 7072 6f63 6573  min([1.0, proces
+0001cb30: 732e 7072 6f67 7265 7373 5d29 202d 2063  s.progress]) - c
+0001cb40: 616e 6365 6c5f 6275 7474 6f6e 5f77 292c  ancel_button_w),
+0001cb50: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001cb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cb70: 2020 2079 202b 2068 6569 6768 742c 0d0a     y + height,..
+0001cb80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cb90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cba0: 2069 6d67 7569 2e67 6574 5f63 6f6c 6f72   imgui.get_color
+0001cbb0: 5f75 3332 5f72 6762 6128 2a63 6f6c 6f75  _u32_rgba(*colou
+0001cbc0: 7229 290d 0a20 2020 2020 2020 2069 6d67  r))..        img
+0001cbd0: 7569 2e64 756d 6d79 2863 7720 2d20 6361  ui.dummy(cw - ca
+0001cbe0: 6e63 656c 5f62 7574 746f 6e5f 772c 2068  ncel_button_w, h
+0001cbf0: 6569 6768 7429 0d0a 2020 2020 2020 2020  eight)..        
+0001cc00: 7265 7476 616c 203d 2046 616c 7365 0d0a  retval = False..
+0001cc10: 2020 2020 2020 2020 6966 2063 616e 6365          if cance
+0001cc20: 6c6c 6162 6c65 3a0d 0a20 2020 2020 2020  llable:..       
+0001cc30: 2020 2020 2069 6d67 7569 2e73 616d 655f       imgui.same_
+0001cc40: 6c69 6e65 2873 7061 6369 6e67 3d35 290d  line(spacing=5).
+0001cc50: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0001cc60: 7661 6c20 3d20 696d 6775 692e 696d 6167  val = imgui.imag
+0001cc70: 655f 6275 7474 6f6e 2873 656c 662e 6963  e_button(self.ic
+0001cc80: 6f6e 5f63 6c6f 7365 2e72 656e 6465 7265  on_close.rendere
+0001cc90: 725f 6964 2c20 5365 676d 656e 7461 7469  r_id, Segmentati
+0001cca0: 6f6e 4564 6974 6f72 2e50 524f 4752 4553  onEditor.PROGRES
+0001ccb0: 535f 4241 525f 4845 4947 4854 2c20 5365  S_BAR_HEIGHT, Se
+0001ccc0: 676d 656e 7461 7469 6f6e 4564 6974 6f72  gmentationEditor
+0001ccd0: 2e50 524f 4752 4553 535f 4241 525f 4845  .PROGRESS_BAR_HE
+0001cce0: 4947 4854 290d 0a20 2020 2020 2020 2072  IGHT)..        r
+0001ccf0: 6574 7572 6e20 7265 7476 616c 0d0a 0d0a  eturn retval....
+0001cd00: 2020 2020 6465 6620 5f67 7569 5f66 6561      def _gui_fea
+0001cd10: 7475 7265 5f74 6974 6c65 5f63 6f6e 7465  ture_title_conte
+0001cd20: 7874 5f6d 656e 7528 7365 6c66 2c20 6665  xt_menu(self, fe
+0001cd30: 6174 7572 655f 6f72 5f6d 6f64 656c 293a  ature_or_model):
+0001cd40: 0d0a 2020 2020 2020 2020 6966 2069 6d67  ..        if img
+0001cd50: 7569 2e62 6567 696e 5f70 6f70 7570 5f63  ui.begin_popup_c
+0001cd60: 6f6e 7465 7874 5f69 7465 6d28 293a 0d0a  ontext_item():..
+0001cd70: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+0001cd80: 7420 696e 2073 656c 662e 6665 6174 7572  t in self.featur
+0001cd90: 655f 636f 6c6f 7572 5f64 6963 743a 0d0a  e_colour_dict:..
+0001cda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cdb0: 696d 6775 692e 7365 6c65 6374 6162 6c65  imgui.selectable
+0001cdc0: 2874 290d 0a20 2020 2020 2020 2020 2020  (t)..           
+0001cdd0: 2020 2020 2069 6620 696d 6775 692e 6973       if imgui.is
+0001cde0: 5f69 7465 6d5f 686f 7665 7265 6428 293a  _item_hovered():
+0001cdf0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001ce00: 2020 2020 2020 6665 6174 7572 655f 6f72        feature_or
+0001ce10: 5f6d 6f64 656c 2e74 6974 6c65 203d 2074  _model.title = t
+0001ce20: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001ce30: 2020 2020 2020 6665 6174 7572 655f 6f72        feature_or
+0001ce40: 5f6d 6f64 656c 2e63 6f6c 6f75 7220 3d20  _model.colour = 
+0001ce50: 7365 6c66 2e66 6561 7475 7265 5f63 6f6c  self.feature_col
+0001ce60: 6f75 725f 6469 6374 5b74 5d0d 0a20 2020  our_dict[t]..   
+0001ce70: 2020 2020 2020 2020 2020 2020 2069 6d67               img
+0001ce80: 7569 2e73 7061 6369 6e67 2829 0d0a 0d0a  ui.spacing()....
+0001ce90: 2020 2020 2020 2020 2020 2020 696d 6775              imgu
+0001cea0: 692e 656e 645f 706f 7075 7028 290d 0a0d  i.end_popup()...
+0001ceb0: 0a20 2020 2040 7374 6174 6963 6d65 7468  .    @staticmeth
+0001cec0: 6f64 0d0a 2020 2020 6465 6620 6578 7472  od..    def extr
+0001ced0: 6163 745f 636f 6f72 6469 6e61 7465 735f  act_coordinates_
+0001cee0: 6d65 6e75 2866 6561 7475 7265 293a 0d0a  menu(feature):..
+0001cef0: 2020 2020 2020 2020 696d 6775 692e 7075          imgui.pu
+0001cf00: 7368 5f73 7479 6c65 5f63 6f6c 6f72 2869  sh_style_color(i
+0001cf10: 6d67 7569 2e43 4f4c 4f52 5f43 4845 434b  mgui.COLOR_CHECK
+0001cf20: 5f4d 4152 4b2c 202a 6665 6174 7572 652e  _MARK, *feature.
+0001cf30: 636f 6c6f 7572 290d 0a20 2020 2020 2020  colour)..       
+0001cf40: 2069 6d67 7569 2e74 6578 7428 2245 7874   imgui.text("Ext
+0001cf50: 7261 6374 2063 6f6f 7264 696e 6174 6573  ract coordinates
+0001cf60: 3a22 290d 0a20 2020 2020 2020 2069 6d67  :")..        img
+0001cf70: 7569 2e73 7061 6369 6e67 2829 0d0a 2020  ui.spacing()..  
+0001cf80: 2020 2020 2020 5f2c 2053 6567 6d65 6e74        _, Segment
+0001cf90: 6174 696f 6e45 6469 746f 722e 4558 5452  ationEditor.EXTR
+0001cfa0: 4143 545f 414c 4c20 3d20 696d 6775 692e  ACT_ALL = imgui.
+0001cfb0: 6368 6563 6b62 6f78 2822 7468 6973 2064  checkbox("this d
+0001cfc0: 6174 6173 6574 222c 2053 6567 6d65 6e74  ataset", Segment
+0001cfd0: 6174 696f 6e45 6469 746f 722e 4558 5452  ationEditor.EXTR
+0001cfe0: 4143 545f 414c 4c29 0d0a 2020 2020 2020  ACT_ALL)..      
+0001cff0: 2020 5f2c 2065 7874 7261 6374 5f73 696e    _, extract_sin
+0001d000: 676c 6520 3d20 696d 6775 692e 6368 6563  gle = imgui.chec
+0001d010: 6b62 6f78 2822 616c 6c20 6461 7461 7365  kbox("all datase
+0001d020: 7473 222c 206e 6f74 2053 6567 6d65 6e74  ts", not Segment
+0001d030: 6174 696f 6e45 6469 746f 722e 4558 5452  ationEditor.EXTR
+0001d040: 4143 545f 414c 4c29 0d0a 2020 2020 2020  ACT_ALL)..      
+0001d050: 2020 6966 205f 3a0d 0a20 2020 2020 2020    if _:..       
+0001d060: 2020 2020 2053 6567 6d65 6e74 6174 696f       Segmentatio
+0001d070: 6e45 6469 746f 722e 4558 5452 4143 545f  nEditor.EXTRACT_
+0001d080: 414c 4c20 3d20 6e6f 7420 6578 7472 6163  ALL = not extrac
+0001d090: 745f 7369 6e67 6c65 0d0a 2020 2020 2020  t_single..      
+0001d0a0: 2020 696d 6775 692e 7370 6163 696e 6728    imgui.spacing(
+0001d0b0: 290d 0a0d 0a20 2020 2020 2020 2069 6d67  )....        img
+0001d0c0: 7569 2e74 6578 7428 224d 696e 696d 756d  ui.text("Minimum
+0001d0d0: 2070 6172 7469 636c 6520 7370 6163 696e   particle spacin
+0001d0e0: 673a 2229 0d0a 2020 2020 2020 2020 6377  g:")..        cw
+0001d0f0: 203d 2069 6d67 7569 2e67 6574 5f63 6f6e   = imgui.get_con
+0001d100: 7465 6e74 5f72 6567 696f 6e5f 6176 6169  tent_region_avai
+0001d110: 6c61 626c 655f 7769 6474 6828 290d 0a20  lable_width().. 
+0001d120: 2020 2020 2020 2069 6d67 7569 2e73 6574         imgui.set
+0001d130: 5f6e 6578 745f 6974 656d 5f77 6964 7468  _next_item_width
+0001d140: 2863 7729 0d0a 2020 2020 2020 2020 5f2c  (cw)..        _,
+0001d150: 2053 6567 6d65 6e74 6174 696f 6e45 6469   SegmentationEdi
+0001d160: 746f 722e 4558 5452 4143 545f 4d49 4e5f  tor.EXTRACT_MIN_
+0001d170: 5350 4143 494e 4720 3d20 696d 6775 692e  SPACING = imgui.
+0001d180: 736c 6964 6572 5f66 6c6f 6174 2822 2323  slider_float("##
+0001d190: 6d69 6e5f 6469 7374 222c 2053 6567 6d65  min_dist", Segme
+0001d1a0: 6e74 6174 696f 6e45 6469 746f 722e 4558  ntationEditor.EX
+0001d1b0: 5452 4143 545f 4d49 4e5f 5350 4143 494e  TRACT_MIN_SPACIN
+0001d1c0: 472c 2030 2e31 2c20 3235 2e30 2c20 666f  G, 0.1, 25.0, fo
+0001d1d0: 726d 6174 203d 2066 227b 5365 676d 656e  rmat = f"{Segmen
+0001d1e0: 7461 7469 6f6e 4564 6974 6f72 2e45 5854  tationEditor.EXT
+0001d1f0: 5241 4354 5f4d 494e 5f53 5041 4349 4e47  RACT_MIN_SPACING
+0001d200: 3a2e 3166 7d20 6e6d 2229 0d0a 0d0a 2020  :.1f} nm")....  
+0001d210: 2020 2020 2020 696d 6775 692e 7370 6163        imgui.spac
+0001d220: 696e 6728 290d 0a20 2020 2020 2020 2069  ing()..        i
+0001d230: 6620 7769 6467 6574 732e 6365 6e74 7265  f widgets.centre
+0001d240: 645f 6275 7474 6f6e 2822 7374 6172 7422  d_button("start"
+0001d250: 2c20 3530 2c20 3230 293a 0d0a 2020 2020  , 50, 20):..    
+0001d260: 2020 2020 2020 2020 5365 676d 656e 7461          Segmenta
+0001d270: 7469 6f6e 4564 6974 6f72 2e6c 6175 6e63  tionEditor.launc
+0001d280: 685f 6578 706f 7274 5f63 6f6f 7264 696e  h_export_coordin
+0001d290: 6174 6573 2866 6561 7475 7265 290d 0a20  ates(feature).. 
+0001d2a0: 2020 2020 2020 2020 2020 2069 6d67 7569             imgui
+0001d2b0: 2e63 6c6f 7365 5f63 7572 7265 6e74 5f70  .close_current_p
+0001d2c0: 6f70 7570 2829 0d0a 0d0a 2020 2020 2020  opup()....      
+0001d2d0: 2020 696d 6775 692e 706f 705f 7374 796c    imgui.pop_styl
+0001d2e0: 655f 636f 6c6f 7228 290d 0a0d 0a20 2020  e_color()....   
+0001d2f0: 2040 7374 6174 6963 6d65 7468 6f64 0d0a   @staticmethod..
+0001d300: 2020 2020 6465 6620 746f 6f6c 7469 7028      def tooltip(
+0001d310: 7465 7874 293a 0d0a 2020 2020 2020 2020  text):..        
+0001d320: 6966 2069 6d67 7569 2e69 735f 6974 656d  if imgui.is_item
+0001d330: 5f68 6f76 6572 6564 2829 2061 6e64 206e  _hovered() and n
+0001d340: 6f74 2069 6d67 7569 2e69 735f 6d6f 7573  ot imgui.is_mous
+0001d350: 655f 646f 776e 2830 293a 0d0a 2020 2020  e_down(0):..    
+0001d360: 2020 2020 2020 2020 6966 2053 6567 6d65          if Segme
+0001d370: 6e74 6174 696f 6e45 6469 746f 722e 544f  ntationEditor.TO
+0001d380: 4f4c 5449 505f 484f 5645 5245 445f 5449  OLTIP_HOVERED_TI
+0001d390: 4d45 5220 3d3d 2030 2e30 3a0d 0a20 2020  MER == 0.0:..   
+0001d3a0: 2020 2020 2020 2020 2020 2020 2053 6567               Seg
+0001d3b0: 6d65 6e74 6174 696f 6e45 6469 746f 722e  mentationEditor.
+0001d3c0: 544f 4f4c 5449 505f 484f 5645 5245 445f  TOOLTIP_HOVERED_
+0001d3d0: 5354 4152 545f 5449 4d45 203d 2074 696d  START_TIME = tim
+0001d3e0: 652e 7469 6d65 2829 0d0a 2020 2020 2020  e.time()..      
+0001d3f0: 2020 2020 2020 2020 2020 5365 676d 656e            Segmen
+0001d400: 7461 7469 6f6e 4564 6974 6f72 2e54 4f4f  tationEditor.TOO
+0001d410: 4c54 4950 5f48 4f56 4552 4544 5f54 494d  LTIP_HOVERED_TIM
+0001d420: 4552 203d 2030 2e30 3031 2020 2320 6164  ER = 0.001  # ad
+0001d430: 6420 6120 6661 6b65 2031 206d 7320 746f  d a fake 1 ms to
+0001d440: 2067 6574 2062 7970 6173 7320 6f66 2074   get bypass of t
+0001d450: 6869 7320 6966 2063 6c61 7573 6520 696e  his if clause in
+0001d460: 2074 6865 206e 6578 7420 6974 6572 2e0d   the next iter..
+0001d470: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
+0001d480: 6620 5365 676d 656e 7461 7469 6f6e 4564  f SegmentationEd
+0001d490: 6974 6f72 2e54 4f4f 4c54 4950 5f48 4f56  itor.TOOLTIP_HOV
+0001d4a0: 4552 4544 5f54 494d 4552 203e 2053 6567  ERED_TIMER > Seg
+0001d4b0: 6d65 6e74 6174 696f 6e45 6469 746f 722e  mentationEditor.
+0001d4c0: 544f 4f4c 5449 505f 4150 5045 4152 5f44  TOOLTIP_APPEAR_D
+0001d4d0: 454c 4159 3a0d 0a20 2020 2020 2020 2020  ELAY:..         
+0001d4e0: 2020 2020 2020 2069 6d67 7569 2e73 6574         imgui.set
+0001d4f0: 5f74 6f6f 6c74 6970 2874 6578 7429 0d0a  _tooltip(text)..
+0001d500: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0001d510: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0001d520: 2020 2053 6567 6d65 6e74 6174 696f 6e45     SegmentationE
+0001d530: 6469 746f 722e 544f 4f4c 5449 505f 484f  ditor.TOOLTIP_HO
+0001d540: 5645 5245 445f 5449 4d45 5220 3d20 7469  VERED_TIMER = ti
+0001d550: 6d65 2e74 696d 6528 2920 2d20 5365 676d  me.time() - Segm
+0001d560: 656e 7461 7469 6f6e 4564 6974 6f72 2e54  entationEditor.T
+0001d570: 4f4f 4c54 4950 5f48 4f56 4552 4544 5f53  OOLTIP_HOVERED_S
+0001d580: 5441 5254 5f54 494d 450d 0a20 2020 2020  TART_TIME..     
+0001d590: 2020 2069 6620 6e6f 7420 696d 6775 692e     if not imgui.
+0001d5a0: 6973 5f61 6e79 5f69 7465 6d5f 686f 7665  is_any_item_hove
+0001d5b0: 7265 6428 293a 0d0a 2020 2020 2020 2020  red():..        
+0001d5c0: 2020 2020 5365 676d 656e 7461 7469 6f6e      Segmentation
+0001d5d0: 4564 6974 6f72 2e54 4f4f 4c54 4950 5f48  Editor.TOOLTIP_H
+0001d5e0: 4f56 4552 4544 5f54 494d 4552 203d 2030  OVERED_TIMER = 0
+0001d5f0: 2e30 0d0a 0d0a 2020 2020 4073 7461 7469  .0....    @stati
+0001d600: 636d 6574 686f 640d 0a20 2020 2064 6566  cmethod..    def
+0001d610: 206c 6175 6e63 685f 6578 706f 7274 5f63   launch_export_c
+0001d620: 6f6f 7264 696e 6174 6573 2866 6561 7475  oordinates(featu
+0001d630: 7265 293a 0d0a 2020 2020 2020 2020 7472  re):..        tr
+0001d640: 793a 0d0a 2020 2020 2020 2020 2020 2020  y:..            
+0001d650: 6966 2053 6567 6d65 6e74 6174 696f 6e45  if SegmentationE
+0001d660: 6469 746f 722e 4558 5452 4143 545f 414c  ditor.EXTRACT_AL
+0001d670: 4c3a 0d0a 2020 2020 2020 2020 2020 2020  L:..            
+0001d680: 2020 2020 6461 7461 7365 7473 203d 2067      datasets = g
+0001d690: 6c6f 622e 676c 6f62 286f 732e 7061 7468  lob.glob(os.path
+0001d6a0: 2e6a 6f69 6e28 5365 676d 656e 7461 7469  .join(Segmentati
+0001d6b0: 6f6e 4564 6974 6f72 2e73 6567 5f66 6f6c  onEditor.seg_fol
+0001d6c0: 6465 722c 2066 272a 5f5f 7b66 6561 7475  der, f'*__{featu
+0001d6d0: 7265 2e74 6974 6c65 7d2a 2e6d 7263 2729  re.title}*.mrc')
+0001d6e0: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
+0001d6f0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+0001d700: 2020 2020 2020 7365 5f66 7261 6d65 203d        se_frame =
+0001d710: 2063 6667 2e73 655f 6163 7469 7665 5f66   cfg.se_active_f
+0001d720: 7261 6d65 0d0a 2020 2020 2020 2020 2020  rame..          
+0001d730: 2020 2020 2020 6461 7461 7365 7473 203d        datasets =
+0001d740: 2067 6c6f 622e 676c 6f62 286f 732e 7061   glob.glob(os.pa
+0001d750: 7468 2e6a 6f69 6e28 5365 676d 656e 7461  th.join(Segmenta
+0001d760: 7469 6f6e 4564 6974 6f72 2e73 6567 5f66  tionEditor.seg_f
+0001d770: 6f6c 6465 722c 2066 272a 7b6f 732e 7061  older, f'*{os.pa
+0001d780: 7468 2e73 706c 6974 6578 7428 7365 5f66  th.splitext(se_f
+0001d790: 7261 6d65 2e74 6974 6c65 295b 305d 7d2a  rame.title)[0]}*
+0001d7a0: 5f5f 7b66 6561 7475 7265 2e74 6974 6c65  __{feature.title
+0001d7b0: 7d2a 2e6d 7263 2729 295b 305d 0d0a 0d0a  }*.mrc'))[0]....
+0001d7c0: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+0001d7d0: 6f74 2064 6174 6173 6574 733a 0d0a 2020  ot datasets:..  
+0001d7e0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+0001d7f0: 696e 7428 224e 6f20 6461 7461 7365 7473  int("No datasets
+0001d800: 2073 656c 6563 7465 6422 290d 0a20 2020   selected")..   
+0001d810: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+0001d820: 7572 6e0d 0a0d 0a20 2020 2020 2020 2020  urn....         
+0001d830: 2020 2066 6f72 2064 2069 6e20 6461 7461     for d in data
+0001d840: 7365 7473 3a0d 0a20 2020 2020 2020 2020  sets:..         
+0001d850: 2020 2020 2020 2070 7269 6e74 2864 290d         print(d).
+0001d860: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001d870: 2053 6567 6d65 6e74 6174 696f 6e45 6469   SegmentationEdi
+0001d880: 746f 722e 7175 6575 6564 5f65 7870 6f72  tor.queued_expor
+0001d890: 7473 2e61 7070 656e 6428 5175 6575 6564  ts.append(Queued
+0001d8a0: 4578 7472 6163 7428 642c 2074 6872 6573  Extract(d, thres
+0001d8b0: 686f 6c64 3d66 6561 7475 7265 2e6c 6576  hold=feature.lev
+0001d8c0: 656c 2c20 6d69 6e5f 7369 7a65 3d66 6561  el, min_size=fea
+0001d8d0: 7475 7265 2e64 7573 742c 206d 696e 5f73  ture.dust, min_s
+0001d8e0: 7061 6369 6e67 3d53 6567 6d65 6e74 6174  pacing=Segmentat
+0001d8f0: 696f 6e45 6469 746f 722e 4558 5452 4143  ionEditor.EXTRAC
+0001d900: 545f 4d49 4e5f 5350 4143 494e 472c 2073  T_MIN_SPACING, s
+0001d910: 6176 655f 6469 723d 5365 676d 656e 7461  ave_dir=Segmenta
+0001d920: 7469 6f6e 4564 6974 6f72 2e73 6567 5f66  tionEditor.seg_f
+0001d930: 6f6c 6465 722c 2062 696e 6e69 6e67 3d66  older, binning=f
+0001d940: 6561 7475 7265 2e62 696e 2929 0d0a 2020  eature.bin))..  
+0001d950: 2020 2020 2020 2020 2020 2020 2020 5365                Se
+0001d960: 676d 656e 7461 7469 6f6e 4564 6974 6f72  gmentationEditor
+0001d970: 2e71 7565 7565 645f 6578 706f 7274 735b  .queued_exports[
+0001d980: 2d31 5d2e 636f 6c6f 7572 203d 2066 6561  -1].colour = fea
+0001d990: 7475 7265 2e63 6f6c 6f75 720d 0a0d 0a20  ture.colour.... 
+0001d9a0: 2020 2020 2020 2020 2020 2069 6620 5365             if Se
+0001d9b0: 676d 656e 7461 7469 6f6e 4564 6974 6f72  gmentationEditor
+0001d9c0: 2e71 7565 7565 645f 6578 706f 7274 733a  .queued_exports:
+0001d9d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001d9e0: 2020 6966 2053 6567 6d65 6e74 6174 696f    if Segmentatio
+0001d9f0: 6e45 6469 746f 722e 7175 6575 6564 5f65  nEditor.queued_e
+0001da00: 7870 6f72 7473 5b30 5d2e 7072 6f63 6573  xports[0].proces
+0001da10: 732e 7072 6f67 7265 7373 203d 3d20 302e  s.progress == 0.
+0001da20: 303a 0d0a 2020 2020 2020 2020 2020 2020  0:..            
+0001da30: 2020 2020 2020 2020 5365 676d 656e 7461          Segmenta
+0001da40: 7469 6f6e 4564 6974 6f72 2e71 7565 7565  tionEditor.queue
+0001da50: 645f 6578 706f 7274 735b 305d 2e73 7461  d_exports[0].sta
+0001da60: 7274 2829 0d0a 0d0a 2020 2020 2020 2020  rt()....        
+0001da70: 6578 6365 7074 2045 7863 6570 7469 6f6e  except Exception
+0001da80: 2061 7320 653a 0d0a 2020 2020 2020 2020   as e:..        
+0001da90: 2020 2020 6366 672e 7365 745f 6572 726f      cfg.set_erro
+0001daa0: 7228 652c 2022 436f 756c 6420 6e6f 7420  r(e, "Could not 
+0001dab0: 6578 706f 7274 2063 6f6f 7264 696e 6174  export coordinat
+0001dac0: 6573 202d 2073 6565 2064 6574 6169 6c73  es - see details
+0001dad0: 2062 656c 6f77 3a22 290d 0a0d 0a20 2020   below:")....   
+0001dae0: 2064 6566 206c 6175 6e63 685f 6578 706f   def launch_expo
+0001daf0: 7274 5f76 6f6c 756d 6573 2873 656c 6629  rt_volumes(self)
+0001db00: 3a0d 0a20 2020 2020 2020 2074 7279 3a0d  :..        try:.
+0001db10: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
+0001db20: 6173 6574 7320 3d20 5b64 2066 6f72 2064  asets = [d for d
+0001db30: 2069 6e20 6366 672e 7365 5f66 7261 6d65   in cfg.se_frame
+0001db40: 7320 6966 2064 2e65 7870 6f72 745d 0d0a  s if d.export]..
+0001db50: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
+0001db60: 6c73 203d 205b 6d20 666f 7220 6d20 696e  ls = [m for m in
+0001db70: 2063 6667 2e73 655f 6d6f 6465 6c73 2069   cfg.se_models i
+0001db80: 6620 6d2e 6578 706f 7274 5d0d 0a20 2020  f m.export]..   
+0001db90: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
+0001dba0: 6461 7461 7365 7473 3a0d 0a20 2020 2020  datasets:..     
+0001dbb0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0001dbc0: 6e0d 0a20 2020 2020 2020 2020 2020 2069  n..            i
+0001dbd0: 6620 6e6f 7420 6f73 2e70 6174 682e 6973  f not os.path.is
+0001dbe0: 6469 7228 5365 676d 656e 7461 7469 6f6e  dir(Segmentation
+0001dbf0: 4564 6974 6f72 2e65 7870 6f72 745f 6469  Editor.export_di
+0001dc00: 7229 3a0d 0a20 2020 2020 2020 2020 2020  r):..           
+0001dc10: 2020 2020 206f 732e 6d61 6b65 6469 7273       os.makedirs
+0001dc20: 2853 6567 6d65 6e74 6174 696f 6e45 6469  (SegmentationEdi
+0001dc30: 746f 722e 6578 706f 7274 5f64 6972 290d  tor.export_dir).
+0001dc40: 0a0d 0a20 2020 2020 2020 2020 2020 2066  ...            f
+0001dc50: 6f72 2064 2069 6e20 6461 7461 7365 7473  or d in datasets
+0001dc60: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0001dc70: 2020 2053 6567 6d65 6e74 6174 696f 6e45     SegmentationE
+0001dc80: 6469 746f 722e 7175 6575 6564 5f65 7870  ditor.queued_exp
+0001dc90: 6f72 7473 2e61 7070 656e 6428 5175 6575  orts.append(Queu
+0001dca0: 6564 4578 706f 7274 2853 6567 6d65 6e74  edExport(Segment
+0001dcb0: 6174 696f 6e45 6469 746f 722e 6578 706f  ationEditor.expo
+0001dcc0: 7274 5f64 6972 2c20 642c 206d 6f64 656c  rt_dir, d, model
+0001dcd0: 732c 2073 656c 662e 6578 706f 7274 5f62  s, self.export_b
+0001dce0: 6174 6368 5f73 697a 652c 2073 656c 662e  atch_size, self.
+0001dcf0: 6578 706f 7274 5f6f 7665 726c 6179 7329  export_overlays)
+0001dd00: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
+0001dd10: 2069 6620 5365 676d 656e 7461 7469 6f6e   if Segmentation
+0001dd20: 4564 6974 6f72 2e71 7565 7565 645f 6578  Editor.queued_ex
+0001dd30: 706f 7274 733a 0d0a 2020 2020 2020 2020  ports:..        
+0001dd40: 2020 2020 2020 2020 6966 2053 6567 6d65          if Segme
+0001dd50: 6e74 6174 696f 6e45 6469 746f 722e 7175  ntationEditor.qu
+0001dd60: 6575 6564 5f65 7870 6f72 7473 5b30 5d2e  eued_exports[0].
+0001dd70: 7072 6f63 6573 732e 7072 6f67 7265 7373  process.progress
+0001dd80: 203d 3d20 302e 303a 0d0a 2020 2020 2020   == 0.0:..      
+0001dd90: 2020 2020 2020 2020 2020 2020 2020 5365                Se
+0001dda0: 676d 656e 7461 7469 6f6e 4564 6974 6f72  gmentationEditor
+0001ddb0: 2e71 7565 7565 645f 6578 706f 7274 735b  .queued_exports[
+0001ddc0: 305d 2e73 7461 7274 2829 0d0a 2020 2020  0].start()..    
+0001ddd0: 2020 2020 6578 6365 7074 2045 7863 6570      except Excep
+0001dde0: 7469 6f6e 2061 7320 653a 0d0a 2020 2020  tion as e:..    
+0001ddf0: 2020 2020 2020 2020 6366 672e 7365 745f          cfg.set_
+0001de00: 6572 726f 7228 652c 2022 436f 756c 6420  error(e, "Could 
+0001de10: 6e6f 7420 6578 706f 7274 2076 6f6c 756d  not export volum
+0001de20: 6573 202d 2073 6565 2064 6574 6169 6c73  es - see details
+0001de30: 2062 656c 6f77 3a22 290d 0a0d 0a20 2020   below:")....   
+0001de40: 2064 6566 206c 6175 6e63 685f 6372 6561   def launch_crea
+0001de50: 7465 5f74 7261 696e 696e 675f 7365 7428  te_training_set(
+0001de60: 7365 6c66 293a 0d0a 2020 2020 2020 2020  self):..        
+0001de70: 706f 7369 7469 7665 5f66 6561 7475 7265  positive_feature
+0001de80: 5f6e 616d 6573 203d 206c 6973 7428 290d  _names = list().
+0001de90: 0a20 2020 2020 2020 206e 6567 6174 6976  .        negativ
+0001dea0: 655f 6665 6174 7572 655f 6e61 6d65 7320  e_feature_names 
+0001deb0: 3d20 6c69 7374 2829 0d0a 2020 2020 2020  = list()..      
+0001dec0: 2020 666f 7220 6620 696e 2073 656c 662e    for f in self.
+0001ded0: 616c 6c5f 6665 6174 7572 655f 6e61 6d65  all_feature_name
+0001dee0: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
+0001def0: 6966 2073 656c 662e 7472 6169 6e73 6574  if self.trainset
+0001df00: 5f66 6561 7475 7265 5f73 656c 6563 7469  _feature_selecti
+0001df10: 6f6e 5b66 5d20 3d3d 2031 3a0d 0a20 2020  on[f] == 1:..   
+0001df20: 2020 2020 2020 2020 2020 2020 2070 6f73               pos
+0001df30: 6974 6976 655f 6665 6174 7572 655f 6e61  itive_feature_na
+0001df40: 6d65 732e 6170 7065 6e64 2866 290d 0a20  mes.append(f).. 
+0001df50: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+0001df60: 7365 6c66 2e74 7261 696e 7365 745f 6665  self.trainset_fe
+0001df70: 6174 7572 655f 7365 6c65 6374 696f 6e5b  ature_selection[
+0001df80: 665d 203d 3d20 2d31 3a0d 0a20 2020 2020  f] == -1:..     
+0001df90: 2020 2020 2020 2020 2020 206e 6567 6174             negat
+0001dfa0: 6976 655f 6665 6174 7572 655f 6e61 6d65  ive_feature_name
+0001dfb0: 732e 6170 7065 6e64 2866 290d 0a20 2020  s.append(f)..   
+0001dfc0: 2020 2020 2069 6620 6c65 6e28 706f 7369       if len(posi
+0001dfd0: 7469 7665 5f66 6561 7475 7265 5f6e 616d  tive_feature_nam
+0001dfe0: 6573 2920 3d3d 2030 3a0d 0a20 2020 2020  es) == 0:..     
+0001dff0: 2020 2020 2020 2072 6574 7572 6e0d 0a20         return.. 
+0001e000: 2020 2020 2020 2070 6174 6820 3d20 6669         path = fi
+0001e010: 6c65 6469 616c 6f67 2e61 736b 7361 7665  ledialog.asksave
+0001e020: 6173 6669 6c65 6e61 6d65 2866 696c 6574  asfilename(filet
+0001e030: 7970 6573 3d5b 2822 7363 4e6f 6465 7320  ypes=[("scNodes 
+0001e040: 7472 6169 6e64 6174 6122 2c20 6366 672e  traindata", cfg.
+0001e050: 6669 6c65 7479 7065 5f74 7261 696e 6461  filetype_trainda
+0001e060: 7461 295d 2c20 696e 6974 6961 6c66 696c  ta)], initialfil
+0001e070: 653d 6622 7b73 656c 662e 7472 6169 6e73  e=f"{self.trains
+0001e080: 6574 5f62 6f78 7369 7a65 7d5f 7b53 6567  et_boxsize}_{Seg
+0001e090: 6d65 6e74 6174 696f 6e45 6469 746f 722e  mentationEditor.
+0001e0a0: 7472 6169 6e73 6574 5f61 7069 783a 2e33  trainset_apix:.3
+0001e0b0: 667d 5f7b 706f 7369 7469 7665 5f66 6561  f}_{positive_fea
+0001e0c0: 7475 7265 5f6e 616d 6573 5b30 5d7d 2229  ture_names[0]}")
+0001e0d0: 0d0a 2020 2020 2020 2020 6966 2070 6174  ..        if pat
+0001e0e0: 6820 3d3d 2022 223a 0d0a 2020 2020 2020  h == "":..      
+0001e0f0: 2020 2020 2020 7265 7475 726e 0d0a 2020        return..  
+0001e100: 2020 2020 2020 6966 2070 6174 685b 2d6c        if path[-l
+0001e110: 656e 2863 6667 2e66 696c 6574 7970 655f  en(cfg.filetype_
+0001e120: 7472 6169 6e64 6174 6129 3a5d 2021 3d20  traindata):] != 
+0001e130: 6366 672e 6669 6c65 7479 7065 5f74 7261  cfg.filetype_tra
+0001e140: 696e 6461 7461 3a0d 0a20 2020 2020 2020  indata:..       
+0001e150: 2020 2020 2070 6174 6820 2b3d 2063 6667       path += cfg
+0001e160: 2e66 696c 6574 7970 655f 7472 6169 6e64  .filetype_traind
+0001e170: 6174 610d 0a20 2020 2020 2020 2023 0d0a  ata..        #..
+0001e180: 0d0a 0d0a 2020 2020 2020 2020 6461 7461  ....        data
+0001e190: 7365 7473 5f74 6f5f 7361 6d70 6c65 203d  sets_to_sample =
+0001e1a0: 206c 6973 7428 290d 0a20 2020 2020 2020   list()..       
+0001e1b0: 2066 6f72 2064 6174 6173 6574 2069 6e20   for dataset in 
+0001e1c0: 6366 672e 7365 5f66 7261 6d65 733a 0d0a  cfg.se_frames:..
+0001e1d0: 2020 2020 2020 2020 2020 2020 6966 2064              if d
+0001e1e0: 6174 6173 6574 2e73 616d 706c 653a 0d0a  ataset.sample:..
+0001e1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e200: 6461 7461 7365 7473 5f74 6f5f 7361 6d70  datasets_to_samp
+0001e210: 6c65 2e61 7070 656e 6428 6461 7461 7365  le.append(datase
+0001e220: 7429 0d0a 0d0a 2020 2020 2020 2020 6e5f  t)....        n_
+0001e230: 626f 7865 7320 3d20 7365 6c66 2e74 7261  boxes = self.tra
+0001e240: 696e 7365 745f 6e75 6d5f 626f 7865 735f  inset_num_boxes_
+0001e250: 706f 7369 7469 7665 202b 2073 656c 662e  positive + self.
+0001e260: 7472 6169 6e73 6574 5f6e 756d 5f62 6f78  trainset_num_box
+0001e270: 6573 5f6e 6567 6174 6976 650d 0a20 2020  es_negative..   
+0001e280: 2020 2020 2069 6620 6e5f 626f 7865 7320       if n_boxes 
+0001e290: 3d3d 2030 3a0d 0a20 2020 2020 2020 2020  == 0:..         
+0001e2a0: 2020 2072 6574 7572 6e0d 0a20 2020 2020     return..     
+0001e2b0: 2020 2061 7267 7320 3d20 2870 6174 682c     args = (path,
+0001e2c0: 206e 5f62 6f78 6573 2c20 706f 7369 7469   n_boxes, positi
+0001e2d0: 7665 5f66 6561 7475 7265 5f6e 616d 6573  ve_feature_names
+0001e2e0: 2c20 6e65 6761 7469 7665 5f66 6561 7475  , negative_featu
+0001e2f0: 7265 5f6e 616d 6573 2c20 6461 7461 7365  re_names, datase
+0001e300: 7473 5f74 6f5f 7361 6d70 6c65 2c20 7365  ts_to_sample, se
+0001e310: 6c66 2e74 7261 696e 7365 745f 626f 7873  lf.trainset_boxs
+0001e320: 697a 652c 2053 6567 6d65 6e74 6174 696f  ize, Segmentatio
+0001e330: 6e45 6469 746f 722e 7472 6169 6e73 6574  nEditor.trainset
+0001e340: 5f61 7069 7829 0d0a 0d0a 2020 2020 2020  _apix)....      
+0001e350: 2020 7072 6f63 6573 7320 3d20 4261 636b    process = Back
+0001e360: 6772 6f75 6e64 5072 6f63 6573 7328 7365  groundProcess(se
+0001e370: 6c66 2e5f 6372 6561 7465 5f74 7261 696e  lf._create_train
+0001e380: 696e 675f 7365 742c 2061 7267 7329 0d0a  ing_set, args)..
+0001e390: 2020 2020 2020 2020 7072 6f63 6573 732e          process.
+0001e3a0: 7374 6172 7428 290d 0a20 2020 2020 2020  start()..       
+0001e3b0: 2073 656c 662e 6163 7469 7665 5f74 7261   self.active_tra
+0001e3c0: 696e 7365 745f 6578 706f 7274 732e 6170  inset_exports.ap
+0001e3d0: 7065 6e64 2870 726f 6365 7373 290d 0a0d  pend(process)...
+0001e3e0: 0a20 2020 2064 6566 205f 6372 6561 7465  .    def _create
+0001e3f0: 5f74 7261 696e 696e 675f 7365 7428 7365  _training_set(se
+0001e400: 6c66 2c20 7061 7468 2c20 6e5f 626f 7865  lf, path, n_boxe
+0001e410: 732c 2070 6f73 6974 6976 6573 2c20 6e65  s, positives, ne
+0001e420: 6761 7469 7665 732c 2064 6174 6173 6574  gatives, dataset
+0001e430: 732c 2062 6f78 7369 7a65 2c20 6170 6978  s, boxsize, apix
+0001e440: 2c20 7072 6f63 6573 7329 3a0d 0a20 2020  , process):..   
+0001e450: 2020 2020 2070 6f73 6974 6976 6520 3d20       positive = 
+0001e460: 6c69 7374 2829 0d0a 2020 2020 2020 2020  list()..        
+0001e470: 6e65 6761 7469 7665 203d 206c 6973 7428  negative = list(
+0001e480: 290d 0a0d 0a20 2020 2020 2020 206e 5f64  )....        n_d
+0001e490: 6f6e 6520 3d20 300d 0a20 2020 2020 2020  one = 0..       
+0001e4a0: 2074 6172 6765 745f 7479 7065 5f64 6963   target_type_dic
+0001e4b0: 7420 3d20 7b6e 702e 666c 6f61 7433 323a  t = {np.float32:
+0001e4c0: 2066 6c6f 6174 2c20 666c 6f61 743a 2066   float, float: f
+0001e4d0: 6c6f 6174 2c20 6e70 2e64 7479 7065 2827  loat, np.dtype('
+0001e4e0: 696e 7438 2729 3a20 6e70 2e64 7479 7065  int8'): np.dtype
+0001e4f0: 2827 7569 6e74 3827 292c 206e 702e 6474  ('uint8'), np.dt
+0001e500: 7970 6528 2769 6e74 3136 2729 3a20 6e70  ype('int16'): np
+0001e510: 2e64 7479 7065 2827 666c 6f61 7433 3227  .dtype('float32'
+0001e520: 297d 0d0a 2020 2020 2020 2020 666f 7220  )}..        for 
+0001e530: 6420 696e 2064 6174 6173 6574 733a 0d0a  d in datasets:..
+0001e540: 2020 2020 2020 2020 2020 2020 6d72 6366              mrcf
+0001e550: 203d 206d 7263 6669 6c65 2e6d 6d61 7028   = mrcfile.mmap(
+0001e560: 642e 7061 7468 2c20 6d6f 6465 3d22 7222  d.path, mode="r"
+0001e570: 2c20 7065 726d 6973 7369 7665 3d54 7275  , permissive=Tru
+0001e580: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
+0001e590: 7261 775f 7479 7065 203d 206d 7263 662e  raw_type = mrcf.
+0001e5a0: 6461 7461 2e64 7479 7065 0d0a 2020 2020  data.dtype..    
+0001e5b0: 2020 2020 2020 2020 6f75 745f 7479 7065          out_type
+0001e5c0: 203d 2066 6c6f 6174 0d0a 2020 2020 2020   = float..      
+0001e5d0: 2020 2020 2020 6966 2072 6177 5f74 7970        if raw_typ
+0001e5e0: 6520 696e 2074 6172 6765 745f 7479 7065  e in target_type
+0001e5f0: 5f64 6963 743a 0d0a 2020 2020 2020 2020  _dict:..        
+0001e600: 2020 2020 2020 2020 6f75 745f 7479 7065          out_type
+0001e610: 203d 2074 6172 6765 745f 7479 7065 5f64   = target_type_d
+0001e620: 6963 745b 7261 775f 7479 7065 5d0d 0a0d  ict[raw_type]...
+0001e630: 0a20 2020 2020 2020 2020 2020 2077 203d  .            w =
+0001e640: 2064 2e77 6964 7468 0d0a 2020 2020 2020   d.width..      
+0001e650: 2020 2020 2020 6820 3d20 642e 6865 6967        h = d.heig
+0001e660: 6874 0d0a 2020 2020 2020 2020 2020 2020  ht..            
+0001e670: 6372 6f70 5f70 7820 3d20 696e 7428 6e70  crop_px = int(np
+0001e680: 2e63 6569 6c28 2862 6f78 7369 7a65 202a  .ceil((boxsize *
+0001e690: 2061 7069 7829 202f 2028 642e 7069 7865   apix) / (d.pixe
+0001e6a0: 6c5f 7369 7a65 202a 2031 302e 3029 2929  l_size * 10.0)))
+0001e6b0: 2020 2320 7369 7a65 2074 6f20 6372 6f70    # size to crop
+0001e6c0: 2073 6f20 7468 6174 2074 6865 2063 726f   so that the cro
+0001e6d0: 7020 636f 6e74 6169 6e73 2061 7420 6c65  p contains at le
+0001e6e0: 6173 7420 6120 626f 7873 697a 652a 6170  ast a boxsize*ap
+0001e6f0: 6978 2073 697a 6564 2072 6567 696f 6e0d  ix sized region.
+0001e700: 0a20 2020 2020 2020 2020 2020 2073 6361  .            sca
+0001e710: 6c65 5f66 6163 203d 2028 642e 7069 7865  le_fac = (d.pixe
+0001e720: 6c5f 7369 7a65 202a 2031 302e 3029 202f  l_size * 10.0) /
+0001e730: 2061 7069 7820 2023 2068 6f77 206d 7563   apix  # how muc
+0001e740: 6820 746f 2073 6361 6c65 2074 6865 2063  h to scale the c
+0001e750: 726f 7070 6564 2069 6d61 6765 732e 0d0a  ropped images...
+0001e760: 2020 2020 2020 2020 2020 2020 6e6d 203d              nm =
+0001e770: 2069 6e74 286e 702e 666c 6f6f 7228 6372   int(np.floor(cr
+0001e780: 6f70 5f70 7820 2f20 3229 290d 0a20 2020  op_px / 2))..   
+0001e790: 2020 2020 2020 2020 2070 6d20 3d20 696e           pm = in
+0001e7a0: 7428 6e70 2e63 6569 6c28 6372 6f70 5f70  t(np.ceil(crop_p
+0001e7b0: 7820 2f20 3229 290d 0a20 2020 2020 2020  x / 2))..       
+0001e7c0: 2020 2020 2069 735f 706f 7369 7469 7665       is_positive
+0001e7d0: 203d 2054 7275 650d 0a20 2020 2020 2020   = True..       
+0001e7e0: 2020 2020 2023 2066 696e 6420 616c 6c20       # find all 
+0001e7f0: 626f 7865 730d 0a20 2020 2020 2020 2020  boxes..         
+0001e800: 2020 2066 6f72 2066 2069 6e20 642e 6665     for f in d.fe
+0001e810: 6174 7572 6573 3a0d 0a20 2020 2020 2020  atures:..       
+0001e820: 2020 2020 2020 2020 2069 6620 662e 7469           if f.ti
+0001e830: 746c 6520 696e 2070 6f73 6974 6976 6573  tle in positives
+0001e840: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0001e850: 2020 2020 2020 2069 735f 706f 7369 7469         is_positi
+0001e860: 7665 203d 2054 7275 650d 0a20 2020 2020  ve = True..     
+0001e870: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+0001e880: 662e 7469 746c 6520 696e 206e 6567 6174  f.title in negat
+0001e890: 6976 6573 3a0d 0a20 2020 2020 2020 2020  ives:..         
+0001e8a0: 2020 2020 2020 2020 2020 2069 735f 706f             is_po
+0001e8b0: 7369 7469 7665 203d 2046 616c 7365 0d0a  sitive = False..
+0001e8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e8d0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+0001e8e0: 2020 2020 2020 2020 2020 2063 6f6e 7469             conti
+0001e8f0: 6e75 650d 0a0d 0a20 2020 2020 2020 2020  nue....         
+0001e900: 2020 2020 2020 2023 2066 696e 6420 626f         # find bo
+0001e910: 7865 730d 0a20 2020 2020 2020 2020 2020  xes..           
+0001e920: 2020 2020 2066 6f72 207a 2069 6e20 662e       for z in f.
+0001e930: 626f 7865 732e 6b65 7973 2829 3a0d 0a20  boxes.keys():.. 
+0001e940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e950: 2020 2069 6620 662e 626f 7865 735b 7a5d     if f.boxes[z]
+0001e960: 2069 7320 6e6f 7420 4e6f 6e65 3a0d 0a20   is not None:.. 
+0001e970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e980: 2020 2020 2020 2066 6f72 2028 782c 2079         for (x, y
+0001e990: 2920 696e 2066 2e62 6f78 6573 5b7a 5d3a  ) in f.boxes[z]:
+0001e9a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001e9b0: 2020 2020 2020 2020 2020 2020 2020 785f                x_
+0001e9c0: 6d69 6e20 3d20 2878 2d6e 6d29 0d0a 2020  min = (x-nm)..  
+0001e9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e9e0: 2020 2020 2020 2020 2020 785f 6d61 7820            x_max 
+0001e9f0: 3d20 2878 2b70 6d29 0d0a 2020 2020 2020  = (x+pm)..      
+0001ea00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ea10: 2020 2020 2020 795f 6d69 6e20 3d20 2879        y_min = (y
+0001ea20: 2d6e 6d29 0d0a 2020 2020 2020 2020 2020  -nm)..          
+0001ea30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ea40: 2020 795f 6d61 7820 3d20 2879 2b70 6d29    y_max = (y+pm)
+0001ea50: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001ea60: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0001ea70: 2078 5f6d 696e 203e 2030 2061 6e64 2079   x_min > 0 and y
+0001ea80: 5f6d 696e 203e 2030 2061 6e64 2078 5f6d  _min > 0 and x_m
+0001ea90: 6178 203c 2077 2061 6e64 2079 5f6d 6178  ax < w and y_max
+0001eaa0: 203c 2068 3a0d 0a20 2020 2020 2020 2020   < h:..         
+0001eab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001eac0: 2020 2020 2020 2069 6d61 6765 203d 206e         image = n
+0001ead0: 702e 666c 6970 7564 286d 7263 662e 6461  p.flipud(mrcf.da
+0001eae0: 7461 5b7a 2c20 795f 6d69 6e3a 795f 6d61  ta[z, y_min:y_ma
+0001eaf0: 782c 2078 5f6d 696e 3a78 5f6d 6178 5d29  x, x_min:x_max])
+0001eb00: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001eb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001eb20: 2020 696d 6167 6520 3d20 6e70 2e61 7272    image = np.arr
+0001eb30: 6179 2869 6d61 6765 2e61 7374 7970 6528  ay(image.astype(
+0001eb40: 6f75 745f 7479 7065 2c20 636f 7079 3d46  out_type, copy=F
+0001eb50: 616c 7365 292c 2064 7479 7065 3d66 6c6f  alse), dtype=flo
+0001eb60: 6174 290d 0a20 2020 2020 2020 2020 2020  at)..           
+0001eb70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001eb80: 2020 2020 2069 6d61 6765 203d 207a 6f6f       image = zoo
+0001eb90: 6d28 696d 6167 652c 2073 6361 6c65 5f66  m(image, scale_f
+0001eba0: 6163 290d 0a20 2020 2020 2020 2020 2020  ac)..           
+0001ebb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ebc0: 2020 2020 2069 6d61 6765 203d 2069 6d61       image = ima
+0001ebd0: 6765 5b3a 626f 7873 697a 652c 203a 626f  ge[:boxsize, :bo
+0001ebe0: 7873 697a 655d 0d0a 2020 2020 2020 2020  xsize]..        
+0001ebf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ec00: 2020 2020 2020 2020 6966 207a 2069 6e20          if z in 
+0001ec10: 662e 736c 6963 6573 2061 6e64 2066 2e73  f.slices and f.s
+0001ec20: 6c69 6365 735b 7a5d 2069 7320 6e6f 7420  lices[z] is not 
+0001ec30: 4e6f 6e65 2061 6e64 2069 735f 706f 7369  None and is_posi
+0001ec40: 7469 7665 3a0d 0a20 2020 2020 2020 2020  tive:..         
+0001ec50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ec60: 2020 2020 2020 2020 2020 2073 6567 6d65             segme
+0001ec70: 6e74 6174 696f 6e20 3d20 6e70 2e66 6c69  ntation = np.fli
+0001ec80: 7075 6428 662e 736c 6963 6573 5b7a 5d5b  pud(f.slices[z][
+0001ec90: 795f 6d69 6e3a 795f 6d61 782c 2078 5f6d  y_min:y_max, x_m
+0001eca0: 696e 3a78 5f6d 6178 5d29 0d0a 2020 2020  in:x_max])..    
+0001ecb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ecc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ecd0: 7365 676d 656e 7461 7469 6f6e 203d 207a  segmentation = z
+0001ece0: 6f6f 6d28 7365 676d 656e 7461 7469 6f6e  oom(segmentation
+0001ecf0: 2c20 7363 616c 655f 6661 6329 0d0a 2020  , scale_fac)..  
+0001ed00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ed10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ed20: 2020 7365 676d 656e 7461 7469 6f6e 203d    segmentation =
+0001ed30: 2073 6567 6d65 6e74 6174 696f 6e5b 3a62   segmentation[:b
+0001ed40: 6f78 7369 7a65 2c20 3a62 6f78 7369 7a65  oxsize, :boxsize
+0001ed50: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
+0001ed60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ed70: 2020 2020 2020 2073 6567 6d65 6e74 6174         segmentat
+0001ed80: 696f 6e20 3d20 7a6f 6f6d 2873 6567 6d65  ion = zoom(segme
+0001ed90: 6e74 6174 696f 6e2c 2073 6361 6c65 5f66  ntation, scale_f
+0001eda0: 6163 290d 0a20 2020 2020 2020 2020 2020  ac)..           
+0001edb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001edc0: 2020 2020 2020 2020 2073 6567 6d65 6e74           segment
+0001edd0: 6174 696f 6e20 3d20 7365 676d 656e 7461  ation = segmenta
+0001ede0: 7469 6f6e 5b3a 626f 7873 697a 652c 203a  tion[:boxsize, :
+0001edf0: 626f 7873 697a 655d 0d0a 2020 2020 2020  boxsize]..      
+0001ee00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ee10: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
+0001ee20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001ee30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ee40: 2020 2020 2073 6567 6d65 6e74 6174 696f       segmentatio
+0001ee50: 6e20 3d20 6e70 2e7a 6572 6f73 5f6c 696b  n = np.zeros_lik
+0001ee60: 6528 696d 6167 6529 0d0a 2020 2020 2020  e(image)..      
+0001ee70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ee80: 2020 2020 2020 2020 2020 6966 2069 735f            if is_
+0001ee90: 706f 7369 7469 7665 3a0d 0a20 2020 2020  positive:..     
+0001eea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001eeb0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0001eec0: 6f73 6974 6976 652e 6170 7065 6e64 285b  ositive.append([
+0001eed0: 696d 6167 652c 2073 6567 6d65 6e74 6174  image, segmentat
+0001eee0: 696f 6e5d 290d 0a20 2020 2020 2020 2020  ion])..         
+0001eef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ef00: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+0001ef10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ef20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ef30: 2020 6e65 6761 7469 7665 2e61 7070 656e    negative.appen
+0001ef40: 6428 5b69 6d61 6765 2c20 7365 676d 656e  d([image, segmen
+0001ef50: 7461 7469 6f6e 5d29 0d0a 2020 2020 2020  tation])..      
+0001ef60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ef70: 2020 2020 2020 6e5f 646f 6e65 202b 3d20        n_done += 
+0001ef80: 310d 0a20 2020 2020 2020 2020 2020 2020  1..             
+0001ef90: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0001efa0: 726f 6365 7373 2e73 6574 5f70 726f 6772  rocess.set_progr
+0001efb0: 6573 7328 6e5f 646f 6e65 202f 206e 5f62  ess(n_done / n_b
+0001efc0: 6f78 6573 290d 0a0d 0a20 2020 2020 2020  oxes)....       
+0001efd0: 2069 6620 6e6f 7420 6e65 6761 7469 7665   if not negative
+0001efe0: 3a0d 0a20 2020 2020 2020 2020 2020 2061  :..            a
+0001eff0: 6c6c 5f69 6d67 7320 3d20 6e70 2e61 7272  ll_imgs = np.arr
+0001f000: 6179 2870 6f73 6974 6976 6529 0d0a 2020  ay(positive)..  
+0001f010: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+0001f020: 2020 2020 2020 2020 2061 6c6c 5f69 6d67           all_img
+0001f030: 7320 3d20 6e70 2e61 7272 6179 2870 6f73  s = np.array(pos
+0001f040: 6974 6976 6520 2b20 6e65 6761 7469 7665  itive + negative
+0001f050: 290d 0a20 2020 2020 2020 2074 6966 6666  )..        tifff
+0001f060: 696c 652e 696d 7772 6974 6528 7061 7468  ile.imwrite(path
+0001f070: 2c20 616c 6c5f 696d 6773 2c20 6465 7363  , all_imgs, desc
+0001f080: 7269 7074 696f 6e3d 6622 6170 6978 3d7b  ription=f"apix={
+0001f090: 6170 6978 3a2e 3266 7d22 290d 0a0d 0a20  apix:.2f}").... 
+0001f0a0: 2020 2040 7374 6174 6963 6d65 7468 6f64     @staticmethod
+0001f0b0: 0d0a 2020 2020 6465 6620 7365 6672 616d  ..    def sefram
+0001f0c0: 655f 6672 6f6d 5f63 6c65 6d66 7261 6d65  e_from_clemframe
+0001f0d0: 2863 6c65 6d66 7261 6d65 293a 0d0a 2020  (clemframe):..  
+0001f0e0: 2020 2020 2020 6966 206e 6f74 206f 732e        if not os.
+0001f0f0: 7061 7468 2e65 7869 7374 7328 636c 656d  path.exists(clem
+0001f100: 6672 616d 652e 7061 7468 293a 0d0a 2020  frame.path):..  
+0001f110: 2020 2020 2020 2020 2020 6366 672e 7365            cfg.se
+0001f120: 745f 6572 726f 7228 4578 6365 7074 696f  t_error(Exceptio
+0001f130: 6e28 6622 4e6f 2066 696c 6520 6578 6973  n(f"No file exis
+0001f140: 7473 2061 7420 7061 7468 207b 636c 656d  ts at path {clem
+0001f150: 6672 616d 652e 7061 7468 7d22 292c 2022  frame.path}"), "
+0001f160: 436f 756c 6420 6e6f 7420 636f 6e76 6572  Could not conver
+0001f170: 7420 434c 454d 4672 616d 6520 746f 2053  t CLEMFrame to S
+0001f180: 4546 7261 6d65 202d 2073 6565 2062 656c  EFrame - see bel
+0001f190: 6f77 2e22 290d 0a20 2020 2020 2020 2020  ow.")..         
+0001f1a0: 2020 2072 6574 7572 6e0d 0a20 2020 2020     return..     
+0001f1b0: 2020 206e 6577 5f73 655f 6672 616d 6520     new_se_frame 
+0001f1c0: 3d20 5345 4672 616d 6528 636c 656d 6672  = SEFrame(clemfr
+0001f1d0: 616d 652e 7061 7468 290d 0a20 2020 2020  ame.path)..     
+0001f1e0: 2020 206e 6577 5f73 655f 6672 616d 652e     new_se_frame.
+0001f1f0: 636c 656d 5f66 7261 6d65 203d 2063 6c65  clem_frame = cle
+0001f200: 6d66 7261 6d65 0d0a 2020 2020 2020 2020  mframe..        
+0001f210: 6e65 775f 7365 5f66 7261 6d65 2e63 6c65  new_se_frame.cle
+0001f220: 6d5f 6672 616d 655f 7061 7468 203d 2063  m_frame_path = c
+0001f230: 6c65 6d66 7261 6d65 2e70 6174 680d 0a20  lemframe.path.. 
+0001f240: 2020 2020 2020 206e 6577 5f73 655f 6672         new_se_fr
+0001f250: 616d 652e 6175 746f 636f 6e74 7261 7374  ame.autocontrast
+0001f260: 203d 2046 616c 7365 0d0a 2020 2020 2020   = False..      
+0001f270: 2020 6e65 775f 7365 5f66 7261 6d65 2e74    new_se_frame.t
+0001f280: 6974 6c65 203d 2063 6c65 6d66 7261 6d65  itle = clemframe
+0001f290: 2e74 6974 6c65 0d0a 2020 2020 2020 2020  .title..        
+0001f2a0: 6e65 775f 7365 5f66 7261 6d65 2e63 6f6e  new_se_frame.con
+0001f2b0: 7472 6173 745f 6c69 6d73 203d 2063 6c65  trast_lims = cle
+0001f2c0: 6d66 7261 6d65 2e63 6f6e 7472 6173 745f  mframe.contrast_
+0001f2d0: 6c69 6d73 0d0a 2020 2020 2020 2020 6e65  lims..        ne
+0001f2e0: 775f 7365 5f66 7261 6d65 2e73 6574 5f73  w_se_frame.set_s
+0001f2f0: 6c69 6365 2863 6c65 6d66 7261 6d65 2e63  lice(clemframe.c
+0001f300: 7572 7265 6e74 5f73 6c69 6365 290d 0a0d  urrent_slice)...
+0001f310: 0a20 2020 2020 2020 2063 6667 2e73 655f  .        cfg.se_
+0001f320: 6672 616d 6573 2e61 7070 656e 6428 6e65  frames.append(ne
+0001f330: 775f 7365 5f66 7261 6d65 290d 0a20 2020  w_se_frame)..   
+0001f340: 2020 2020 2053 6567 6d65 6e74 6174 696f       Segmentatio
+0001f350: 6e45 6469 746f 722e 7365 745f 6163 7469  nEditor.set_acti
+0001f360: 7665 5f64 6174 6173 6574 2863 6667 2e73  ve_dataset(cfg.s
+0001f370: 655f 6672 616d 6573 5b2d 315d 290d 0a20  e_frames[-1]).. 
+0001f380: 2020 2020 2020 2072 6574 7572 6e20 6366         return cf
+0001f390: 672e 7365 5f66 7261 6d65 735b 2d31 5d0d  g.se_frames[-1].
+0001f3a0: 0a0d 0a20 2020 2040 7374 6174 6963 6d65  ...    @staticme
+0001f3b0: 7468 6f64 0d0a 2020 2020 6465 6620 6c6f  thod..    def lo
+0001f3c0: 6164 5f6d 6f64 656c 5f67 726f 7570 2870  ad_model_group(p
+0001f3d0: 6174 6829 3a0d 0a20 2020 2020 2020 2074  ath):..        t
+0001f3e0: 7279 3a0d 0a20 2020 2020 2020 2020 2020  ry:..           
+0001f3f0: 2077 6974 6820 7465 6d70 6669 6c65 2e54   with tempfile.T
+0001f400: 656d 706f 7261 7279 4469 7265 6374 6f72  emporaryDirector
+0001f410: 7928 2920 6173 2074 656d 705f 6469 723a  y() as temp_dir:
+0001f420: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001f430: 2020 2320 4578 7472 6163 7420 7468 6520    # Extract the 
+0001f440: 2e74 6172 2e67 7a20 6172 6368 6976 6520  .tar.gz archive 
+0001f450: 746f 2074 6865 2074 656d 706f 7261 7279  to the temporary
+0001f460: 2064 6972 6563 746f 7279 0d0a 2020 2020   directory..    
+0001f470: 2020 2020 2020 2020 2020 2020 7769 7468              with
+0001f480: 2074 6172 6669 6c65 2e6f 7065 6e28 7061   tarfile.open(pa
+0001f490: 7468 2c20 2772 2729 2061 7320 7461 723a  th, 'r') as tar:
+0001f4a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001f4b0: 2020 2020 2020 7461 722e 6578 7472 6163        tar.extrac
+0001f4c0: 7461 6c6c 2870 6174 683d 7465 6d70 5f64  tall(path=temp_d
+0001f4d0: 6972 290d 0a0d 0a20 2020 2020 2020 2020  ir)....         
+0001f4e0: 2020 2020 2020 2023 2041 7373 756d 696e         # Assumin
+0001f4f0: 6720 7468 6520 6669 7273 7420 6669 6c65  g the first file
+0001f500: 2069 7320 616c 7761 7973 2074 6865 2069   is always the i
+0001f510: 6e74 6572 6163 7469 6f6e 7320 4a53 4f4e  nteractions JSON
+0001f520: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0001f530: 2020 2023 2061 6e64 2074 6865 2072 6573     # and the res
+0001f540: 7420 6172 6520 6d6f 6465 6c20 6669 6c65  t are model file
+0001f550: 730d 0a20 2020 2020 2020 2020 2020 2020  s..             
+0001f560: 2020 2066 696c 6573 203d 206f 732e 6c69     files = os.li
+0001f570: 7374 6469 7228 7465 6d70 5f64 6972 290d  stdir(temp_dir).
+0001f580: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001f590: 206a 736f 6e5f 7061 7468 203d 205b 6620   json_path = [f 
+0001f5a0: 666f 7220 6620 696e 2066 696c 6573 2069  for f in files i
+0001f5b0: 6620 662e 656e 6473 7769 7468 2827 5f69  f f.endswith('_i
+0001f5c0: 6e74 6572 6163 7469 6f6e 732e 6a73 6f6e  nteractions.json
+0001f5d0: 2729 5d5b 305d 0d0a 2020 2020 2020 2020  ')][0]..        
+0001f5e0: 2020 2020 2020 2020 6d6f 6465 6c5f 6669          model_fi
+0001f5f0: 6c65 7320 3d20 5b66 2066 6f72 2066 2069  les = [f for f i
+0001f600: 6e20 6669 6c65 7320 6966 2066 2021 3d20  n files if f != 
+0001f610: 6a73 6f6e 5f70 6174 685d 0d0a 0d0a 2020  json_path]....  
+0001f620: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+0001f630: 4c6f 6164 206d 6f64 656c 730d 0a20 2020  Load models..   
+0001f640: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+0001f650: 206d 5f66 696c 6520 696e 206d 6f64 656c   m_file in model
+0001f660: 5f66 696c 6573 3a0d 0a20 2020 2020 2020  _files:..       
+0001f670: 2020 2020 2020 2020 2020 2020 206d 6f64               mod
+0001f680: 656c 5f70 6174 6820 3d20 6f73 2e70 6174  el_path = os.pat
+0001f690: 682e 6a6f 696e 2874 656d 705f 6469 722c  h.join(temp_dir,
+0001f6a0: 206d 5f66 696c 6529 0d0a 2020 2020 2020   m_file)..      
+0001f6b0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+0001f6c0: 4173 7375 6d69 6e67 2053 454d 6f64 656c  Assuming SEModel
+0001f6d0: 2068 6173 2061 206c 6f61 6420 6d65 7468   has a load meth
+0001f6e0: 6f64 2074 6861 7420 6163 6365 7074 7320  od that accepts 
+0001f6f0: 6120 6669 6c65 2070 6174 680d 0a20 2020  a file path..   
+0001f700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f710: 206d 6f64 656c 203d 2053 454d 6f64 656c   model = SEModel
+0001f720: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
+0001f730: 2020 2020 2020 2020 6d6f 6465 6c2e 6c6f          model.lo
+0001f740: 6164 286d 6f64 656c 5f70 6174 6829 0d0a  ad(model_path)..
 0001f750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f760: 6a73 6f6e 2e64 756d 7028 696e 7465 7261  json.dump(intera
-0001f770: 6374 696f 6e5f 6469 6374 5f6c 6973 742c  ction_dict_list,
-0001f780: 206f 7574 6669 6c65 2c20 696e 6465 6e74   outfile, indent
-0001f790: 3d32 290d 0a0d 0a20 2020 2020 2020 2020  =2)....         
-0001f7a0: 2020 2020 2020 2023 2043 7265 6174 6520         # Create 
-0001f7b0: 6120 2e74 6172 2e67 7a20 6172 6368 6976  a .tar.gz archiv
-0001f7c0: 6520 616e 6420 6164 6420 616c 6c20 7468  e and add all th
-0001f7d0: 6520 6d6f 6465 6c20 616e 6420 4a53 4f4e  e model and JSON
-0001f7e0: 2066 696c 6573 0d0a 2020 2020 2020 2020   files..        
-0001f7f0: 2020 2020 2020 2020 7769 7468 2074 6172          with tar
-0001f800: 6669 6c65 2e6f 7065 6e28 7061 7468 2c20  file.open(path, 
-0001f810: 2777 2729 2061 7320 7461 723a 0d0a 2020  'w') as tar:..  
-0001f820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f830: 2020 666f 7220 6669 6c65 5f70 6174 6820    for file_path 
-0001f840: 696e 206d 6f64 656c 5f70 6174 6873 202b  in model_paths +
-0001f850: 205b 6a73 6f6e 5f70 6174 685d 3a0d 0a20   [json_path]:.. 
+0001f760: 2020 2020 6366 672e 7365 5f6d 6f64 656c      cfg.se_model
+0001f770: 732e 6170 7065 6e64 286d 6f64 656c 290d  s.append(model).
+0001f780: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+0001f790: 2020 2023 204c 6f61 6420 696e 7465 7261     # Load intera
+0001f7a0: 6374 696f 6e73 0d0a 2020 2020 2020 2020  ctions..        
+0001f7b0: 2020 2020 2020 2020 7769 7468 206f 7065          with ope
+0001f7c0: 6e28 6f73 2e70 6174 682e 6a6f 696e 2874  n(os.path.join(t
+0001f7d0: 656d 705f 6469 722c 206a 736f 6e5f 7061  emp_dir, json_pa
+0001f7e0: 7468 292c 2027 7227 2920 6173 2066 3a0d  th), 'r') as f:.
+0001f7f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001f800: 2020 2020 2069 6e74 6572 6163 7469 6f6e       interaction
+0001f810: 5f64 6963 745f 6c69 7374 203d 206a 736f  _dict_list = jso
+0001f820: 6e2e 6c6f 6164 2866 290d 0a20 2020 2020  n.load(f)..     
+0001f830: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0001f840: 6f72 2064 2069 6e20 696e 7465 7261 6374  or d in interact
+0001f850: 696f 6e5f 6469 6374 5f6c 6973 743a 0d0a  ion_dict_list:..
 0001f860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f870: 2020 2020 2020 2074 6172 2e61 6464 2866         tar.add(f
-0001f880: 696c 655f 7061 7468 2c20 6172 636e 616d  ile_path, arcnam
-0001f890: 653d 6f73 2e70 6174 682e 6261 7365 6e61  e=os.path.basena
-0001f8a0: 6d65 2866 696c 655f 7061 7468 2929 0d0a  me(file_path))..
-0001f8b0: 0d0a 2020 2020 2020 2020 6578 6365 7074  ..        except
-0001f8c0: 2045 7863 6570 7469 6f6e 2061 7320 653a   Exception as e:
-0001f8d0: 0d0a 2020 2020 2020 2020 2020 2020 6366  ..            cf
-0001f8e0: 672e 7365 745f 6572 726f 7228 652c 2022  g.set_error(e, "
-0001f8f0: 4572 726f 7220 7361 7669 6e67 206d 6f64  Error saving mod
-0001f900: 656c 2067 726f 7570 2c20 7365 6520 6465  el group, see de
-0001f910: 7461 696c 7320 6265 6c6f 7722 290d 0a0d  tails below")...
-0001f920: 0a20 2020 2040 7374 6174 6963 6d65 7468  .    @staticmeth
-0001f930: 6f64 0d0a 2020 2020 6465 6620 7361 7665  od..    def save
-0001f940: 5f73 7572 6661 6365 5f6d 6f64 656c 735f  _surface_models_
-0001f950: 6173 5f6f 626a 7328 293a 0d0a 2020 2020  as_objs():..    
-0001f960: 2020 2020 6f62 6a5f 7061 7468 203d 206f      obj_path = o
-0001f970: 732e 7061 7468 2e64 6972 6e61 6d65 2863  s.path.dirname(c
-0001f980: 6667 2e73 655f 6163 7469 7665 5f66 7261  fg.se_active_fra
-0001f990: 6d65 2e70 6174 6829 0d0a 2020 2020 2020  me.path)..      
-0001f9a0: 2020 7061 7468 7320 3d20 6c69 7374 2829    paths = list()
-0001f9b0: 0d0a 2020 2020 2020 2020 666f 7220 6d20  ..        for m 
-0001f9c0: 696e 2063 6667 2e73 655f 7375 7266 6163  in cfg.se_surfac
-0001f9d0: 655f 6d6f 6465 6c73 3a0d 0a20 2020 2020  e_models:..     
-0001f9e0: 2020 2020 2020 206d 5f70 6174 6820 3d20         m_path = 
-0001f9f0: 6d2e 7361 7665 5f61 735f 6f62 6a28 7061  m.save_as_obj(pa
-0001fa00: 7468 3d6f 732e 7061 7468 2e6a 6f69 6e28  th=os.path.join(
-0001fa10: 6f62 6a5f 7061 7468 2c20 6d2e 7469 746c  obj_path, m.titl
-0001fa20: 6520 2b20 222e 6f62 6a22 2929 0d0a 2020  e + ".obj"))..  
-0001fa30: 2020 2020 2020 2020 2020 6966 206d 5f70            if m_p
-0001fa40: 6174 6820 6973 206e 6f74 204e 6f6e 653a  ath is not None:
-0001fa50: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001fa60: 2020 7061 7468 732e 6170 7065 6e64 286d    paths.append(m
-0001fa70: 5f70 6174 6829 0d0a 2020 2020 2020 2020  _path)..        
-0001fa80: 7265 7475 726e 2070 6174 6873 0d0a 0d0a  return paths....
-0001fa90: 2020 2020 4073 7461 7469 636d 6574 686f      @staticmetho
-0001faa0: 640d 0a20 2020 2064 6566 206f 7065 6e5f  d..    def open_
-0001fab0: 6f62 6a73 5f69 6e5f 626c 656e 6465 7228  objs_in_blender(
-0001fac0: 7061 7468 7329 3a0d 0a20 2020 2020 2020  paths):..       
-0001fad0: 2074 7279 3a0d 0a20 2020 2020 2020 2020   try:..         
-0001fae0: 2020 2077 6974 6820 6f70 656e 286f 732e     with open(os.
-0001faf0: 7061 7468 2e6a 6f69 6e28 6366 672e 726f  path.join(cfg.ro
-0001fb00: 6f74 2c20 2263 6f72 6522 2c20 226f 7065  ot, "core", "ope
-0001fb10: 6e5f 696e 5f62 6c65 6e64 6572 2e70 7922  n_in_blender.py"
-0001fb20: 292c 2022 7222 2920 6173 2066 3a0d 0a20  ), "r") as f:.. 
-0001fb30: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-0001fb40: 696e 6573 203d 2066 2e72 6561 646c 696e  ines = f.readlin
-0001fb50: 6573 2829 0d0a 0d0a 2020 2020 2020 2020  es()....        
-0001fb60: 2020 2020 6c69 6e65 7320 3d20 5b66 226f      lines = [f"o
-0001fb70: 626a 5f70 6174 6873 203d 207b 7061 7468  bj_paths = {path
-0001fb80: 737d 5c6e 2220 6966 2022 6f62 6a5f 7061  s}\n" if "obj_pa
-0001fb90: 7468 7320 3d20 5b22 2069 6e20 6c69 6e65  ths = [" in line
-0001fba0: 2065 6c73 6520 6c69 6e65 2066 6f72 206c   else line for l
-0001fbb0: 696e 6520 696e 206c 696e 6573 5d0d 0a0d  ine in lines]...
-0001fbc0: 0a20 2020 2020 2020 2020 2020 2077 6974  .            wit
-0001fbd0: 6820 6f70 656e 286f 732e 7061 7468 2e6a  h open(os.path.j
-0001fbe0: 6f69 6e28 6366 672e 726f 6f74 2c20 2263  oin(cfg.root, "c
-0001fbf0: 6f72 6522 2c20 226f 7065 6e5f 696e 5f62  ore", "open_in_b
-0001fc00: 6c65 6e64 6572 2e70 7922 292c 2022 7722  lender.py"), "w"
-0001fc10: 2920 6173 2066 3a0d 0a20 2020 2020 2020  ) as f:..       
-0001fc20: 2020 2020 2020 2020 2066 2e77 7269 7465           f.write
-0001fc30: 6c69 6e65 7328 6c69 6e65 7329 0d0a 0d0a  lines(lines)....
-0001fc40: 2020 2020 2020 2020 2020 2020 7375 6270              subp
-0001fc50: 726f 6365 7373 2e50 6f70 656e 285b 6366  rocess.Popen([cf
-0001fc60: 672e 7365 7474 696e 6773 5b22 424c 454e  g.settings["BLEN
-0001fc70: 4445 525f 4558 4522 5d2c 2022 2d2d 7079  DER_EXE"], "--py
-0001fc80: 7468 6f6e 222c 206f 732e 7061 7468 2e6a  thon", os.path.j
-0001fc90: 6f69 6e28 6366 672e 726f 6f74 2c20 2263  oin(cfg.root, "c
-0001fca0: 6f72 6522 2c20 226f 7065 6e5f 696e 5f62  ore", "open_in_b
-0001fcb0: 6c65 6e64 6572 2e70 7922 295d 290d 0a0d  lender.py")])...
-0001fcc0: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
-0001fcd0: 4578 6365 7074 696f 6e20 6173 2065 3a0d  Exception as e:.
-0001fce0: 0a20 2020 2020 2020 2020 2020 2063 6667  .            cfg
-0001fcf0: 2e73 6574 5f65 7272 6f72 2865 2c20 2243  .set_error(e, "C
-0001fd00: 6f75 6c64 206e 6f74 206f 7065 6e20 6d6f  ould not open mo
-0001fd10: 6465 6c73 2069 6e20 426c 656e 6465 7220  dels in Blender 
-0001fd20: 2d20 6973 2074 6865 2070 6174 6820 746f  - is the path to
-0001fd30: 2074 6865 2042 6c65 6e64 6572 2065 7865   the Blender exe
-0001fd40: 6375 7461 626c 6520 7365 7420 696e 2073  cutable set in s
-0001fd50: 6574 7469 6e67 732e 7478 743f 2229 0d0a  ettings.txt?")..
-0001fd60: 0d0a 2020 2020 4073 7461 7469 636d 6574  ..    @staticmet
-0001fd70: 686f 640d 0a20 2020 2064 6566 206f 7065  hod..    def ope
-0001fd80: 6e5f 696e 5f63 6869 6d65 7261 7828 7375  n_in_chimerax(su
-0001fd90: 7266 6163 655f 6d6f 6465 6c73 293a 0d0a  rface_models):..
-0001fda0: 2020 2020 2020 2020 7472 793a 0d0a 2020          try:..  
-0001fdb0: 2020 2020 2020 2020 2020 7061 7468 7320            paths 
-0001fdc0: 3d20 6c69 7374 2829 0d0a 2020 2020 2020  = list()..      
-0001fdd0: 2020 2020 2020 6c65 7665 6c20 3d20 6c69        level = li
-0001fde0: 7374 2829 0d0a 2020 2020 2020 2020 2020  st()..          
-0001fdf0: 2020 636f 6c6f 7572 203d 206c 6973 7428    colour = list(
-0001fe00: 290d 0a20 2020 2020 2020 2020 2020 2064  )..            d
-0001fe10: 7573 7420 3d20 6c69 7374 2829 0d0a 2020  ust = list()..  
-0001fe20: 2020 2020 2020 2020 2020 666f 7220 6d20            for m 
-0001fe30: 696e 2073 7572 6661 6365 5f6d 6f64 656c  in surface_model
-0001fe40: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
-0001fe50: 2020 2020 7061 7468 732e 6170 7065 6e64      paths.append
-0001fe60: 286d 2e70 6174 6829 0d0a 2020 2020 2020  (m.path)..      
-0001fe70: 2020 2020 2020 2020 2020 6c65 7665 6c2e            level.
-0001fe80: 6170 7065 6e64 286d 2e6c 6576 656c 290d  append(m.level).
-0001fe90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001fea0: 2063 6f6c 6f75 722e 6170 7065 6e64 286d   colour.append(m
-0001feb0: 2e63 6f6c 6f75 7229 0d0a 2020 2020 2020  .colour)..      
-0001fec0: 2020 2020 2020 2020 2020 6475 7374 2e61            dust.a
-0001fed0: 7070 656e 6428 6d2e 6475 7374 290d 0a20  ppend(m.dust).. 
-0001fee0: 2020 2020 2020 2020 2020 2077 6974 6820             with 
-0001fef0: 6f70 656e 286f 732e 7061 7468 2e6a 6f69  open(os.path.joi
-0001ff00: 6e28 6366 672e 726f 6f74 2c20 2263 6f72  n(cfg.root, "cor
-0001ff10: 6522 2c20 226f 7065 6e5f 696e 5f63 6869  e", "open_in_chi
-0001ff20: 6d65 7261 782e 7079 2229 2c20 2272 2229  merax.py"), "r")
-0001ff30: 2061 7320 663a 0d0a 2020 2020 2020 2020   as f:..        
-0001ff40: 2020 2020 2020 2020 6c69 6e65 7320 3d20          lines = 
-0001ff50: 662e 7265 6164 6c69 6e65 7328 290d 0a0d  f.readlines()...
-0001ff60: 0a20 2020 2020 2020 2020 2020 2023 2073  .            # s
-0001ff70: 7570 6572 2069 6e65 6666 6963 6965 6e74  uper inefficient
-0001ff80: 2c20 6275 7420 6974 2077 6f72 6b73 202e  , but it works .
-0001ff90: 2e2e 0d0a 2020 2020 2020 2020 2020 2020  ....            
-0001ffa0: 6c69 6e65 7320 3d20 5b66 2270 6174 6873  lines = [f"paths
-0001ffb0: 203d 207b 7061 7468 737d 5c6e 2220 6966   = {paths}\n" if
-0001ffc0: 2022 7061 7468 7320 3d20 5b22 2069 6e20   "paths = [" in 
-0001ffd0: 6c69 6e65 2065 6c73 6520 6c69 6e65 2066  line else line f
-0001ffe0: 6f72 206c 696e 6520 696e 206c 696e 6573  or line in lines
-0001fff0: 5d0d 0a20 2020 2020 2020 2020 2020 206c  ]..            l
-00020000: 696e 6573 203d 205b 6622 6c65 7665 6c20  ines = [f"level 
-00020010: 3d20 7b6c 6576 656c 7d5c 6e22 2069 6620  = {level}\n" if 
-00020020: 226c 6576 656c 203d 205b 2220 696e 206c  "level = [" in l
-00020030: 696e 6520 656c 7365 206c 696e 6520 666f  ine else line fo
-00020040: 7220 6c69 6e65 2069 6e20 6c69 6e65 735d  r line in lines]
-00020050: 0d0a 2020 2020 2020 2020 2020 2020 6c69  ..            li
-00020060: 6e65 7320 3d20 5b66 2263 6f6c 6f75 7220  nes = [f"colour 
-00020070: 3d20 7b63 6f6c 6f75 727d 5c6e 2220 6966  = {colour}\n" if
-00020080: 2022 636f 6c6f 7572 203d 205b 2220 696e   "colour = [" in
-00020090: 206c 696e 6520 656c 7365 206c 696e 6520   line else line 
-000200a0: 666f 7220 6c69 6e65 2069 6e20 6c69 6e65  for line in line
-000200b0: 735d 0d0a 2020 2020 2020 2020 2020 2020  s]..            
-000200c0: 6c69 6e65 7320 3d20 5b66 2264 7573 7420  lines = [f"dust 
-000200d0: 3d20 7b64 7573 747d 5c6e 2220 6966 2022  = {dust}\n" if "
-000200e0: 6475 7374 203d 205b 2220 696e 206c 696e  dust = [" in lin
-000200f0: 6520 656c 7365 206c 696e 6520 666f 7220  e else line for 
-00020100: 6c69 6e65 2069 6e20 6c69 6e65 735d 0d0a  line in lines]..
-00020110: 2020 2020 2020 2020 2020 2020 6c69 6e65              line
-00020120: 7320 3d20 5b66 2262 6763 6c72 203d 207b  s = [f"bgclr = {
-00020130: 5365 676d 656e 7461 7469 6f6e 4564 6974  SegmentationEdit
-00020140: 6f72 2e52 454e 4445 525f 434c 4541 525f  or.RENDER_CLEAR_
-00020150: 434f 4c4f 5552 7d5c 6e22 2069 6620 2262  COLOUR}\n" if "b
-00020160: 6763 6c72 203d 205b 2220 696e 206c 696e  gclr = [" in lin
-00020170: 6520 656c 7365 206c 696e 6520 666f 7220  e else line for 
-00020180: 6c69 6e65 2069 6e20 6c69 6e65 735d 0d0a  line in lines]..
-00020190: 0d0a 2020 2020 2020 2020 2020 2020 7769  ..            wi
-000201a0: 7468 206f 7065 6e28 6f73 2e70 6174 682e  th open(os.path.
-000201b0: 6a6f 696e 2863 6667 2e72 6f6f 742c 2022  join(cfg.root, "
-000201c0: 636f 7265 222c 2022 6f70 656e 5f69 6e5f  core", "open_in_
-000201d0: 6368 696d 6572 6178 2e70 7922 292c 2022  chimerax.py"), "
-000201e0: 7722 2920 6173 2066 3a0d 0a20 2020 2020  w") as f:..     
-000201f0: 2020 2020 2020 2020 2020 2066 2e77 7269             f.wri
-00020200: 7465 6c69 6e65 7328 6c69 6e65 7329 0d0a  telines(lines)..
-00020210: 0d0a 2020 2020 2020 2020 2020 2020 7375  ..            su
-00020220: 6270 726f 6365 7373 2e50 6f70 656e 285b  bprocess.Popen([
-00020230: 6366 672e 7365 7474 696e 6773 5b22 4348  cfg.settings["CH
-00020240: 494d 4552 4158 5f45 5845 225d 2c20 6f73  IMERAX_EXE"], os
-00020250: 2e70 6174 682e 6a6f 696e 2863 6667 2e72  .path.join(cfg.r
-00020260: 6f6f 742c 2022 636f 7265 222c 2022 6f70  oot, "core", "op
-00020270: 656e 5f69 6e5f 6368 696d 6572 6178 2e70  en_in_chimerax.p
-00020280: 7922 295d 290d 0a20 2020 2020 2020 2065  y")])..        e
-00020290: 7863 6570 7420 4578 6365 7074 696f 6e20  xcept Exception 
-000202a0: 6173 2065 3a0d 0a20 2020 2020 2020 2020  as e:..         
-000202b0: 2020 2063 6667 2e73 6574 5f65 7272 6f72     cfg.set_error
-000202c0: 2865 2c20 2243 6f75 6c64 206e 6f74 206f  (e, "Could not o
-000202d0: 7065 6e20 766f 6c75 6d65 7320 696e 2043  pen volumes in C
-000202e0: 6869 6d65 7261 5820 2d20 6973 2074 6865  himeraX - is the
-000202f0: 2070 6174 6820 746f 2074 6865 2043 6869   path to the Chi
-00020300: 6d65 7261 5820 6578 6563 7574 6162 6c65  meraX executable
-00020310: 2073 6574 2069 6e20 7365 7474 696e 6773   set in settings
-00020320: 2e74 7874 3f22 290d 0a0d 0a20 2020 2064  .txt?")....    d
-00020330: 6566 2063 616d 6572 615f 636f 6e74 726f  ef camera_contro
-00020340: 6c28 7365 6c66 293a 0d0a 2020 2020 2020  l(self):..      
-00020350: 2020 6966 2069 6d67 7569 2e67 6574 5f69    if imgui.get_i
-00020360: 6f28 292e 7761 6e74 5f63 6170 7475 7265  o().want_capture
-00020370: 5f6d 6f75 7365 206f 7220 696d 6775 692e  _mouse or imgui.
-00020380: 6765 745f 696f 2829 2e77 616e 745f 6361  get_io().want_ca
-00020390: 7074 7572 655f 6b65 7962 6f61 7264 3a0d  pture_keyboard:.
-000203a0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-000203b0: 7572 6e20 4e6f 6e65 0d0a 2020 2020 2020  urn None..      
-000203c0: 2020 6966 2073 656c 662e 6163 7469 7665    if self.active
-000203d0: 5f74 6162 2021 3d20 2252 656e 6465 7222  _tab != "Render"
-000203e0: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
-000203f0: 6620 7365 6c66 2e77 696e 646f 772e 6765  f self.window.ge
-00020400: 745f 6d6f 7573 655f 6275 7474 6f6e 2867  t_mouse_button(g
-00020410: 6c66 772e 4d4f 5553 455f 4255 5454 4f4e  lfw.MOUSE_BUTTON
-00020420: 5f4d 4944 444c 4529 3a0d 0a20 2020 2020  _MIDDLE):..     
-00020430: 2020 2020 2020 2020 2020 2064 656c 7461             delta
-00020440: 5f63 7572 736f 7220 3d20 7365 6c66 2e77  _cursor = self.w
-00020450: 696e 646f 772e 6375 7273 6f72 5f64 656c  indow.cursor_del
-00020460: 7461 0d0a 2020 2020 2020 2020 2020 2020  ta..            
-00020470: 2020 2020 7365 6c66 2e63 616d 6572 612e      self.camera.
-00020480: 706f 7369 7469 6f6e 5b30 5d20 2b3d 2064  position[0] += d
-00020490: 656c 7461 5f63 7572 736f 725b 305d 202f  elta_cursor[0] /
-000204a0: 2073 656c 662e 6361 6d65 7261 2e7a 6f6f   self.camera.zoo
-000204b0: 6d0d 0a20 2020 2020 2020 2020 2020 2020  m..             
-000204c0: 2020 2073 656c 662e 6361 6d65 7261 2e70     self.camera.p
-000204d0: 6f73 6974 696f 6e5b 315d 202d 3d20 6465  osition[1] -= de
-000204e0: 6c74 615f 6375 7273 6f72 5b31 5d20 2f20  lta_cursor[1] / 
-000204f0: 7365 6c66 2e63 616d 6572 612e 7a6f 6f6d  self.camera.zoom
-00020500: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-00020510: 2053 6567 6d65 6e74 6174 696f 6e45 6469   SegmentationEdi
-00020520: 746f 722e 6973 5f73 6869 6674 5f64 6f77  tor.is_shift_dow
-00020530: 6e28 293a 0d0a 2020 2020 2020 2020 2020  n():..          
-00020540: 2020 2020 2020 7365 6c66 2e63 616d 6572        self.camer
-00020550: 612e 7a6f 6f6d 202a 3d20 2831 2e30 202b  a.zoom *= (1.0 +
-00020560: 2073 656c 662e 7769 6e64 6f77 2e73 6372   self.window.scr
-00020570: 6f6c 6c5f 6465 6c74 615b 315d 202a 2053  oll_delta[1] * S
-00020580: 6567 6d65 6e74 6174 696f 6e45 6469 746f  egmentationEdito
-00020590: 722e 4341 4d45 5241 5f5a 4f4f 4d5f 5354  r.CAMERA_ZOOM_ST
-000205a0: 4550 290d 0a20 2020 2020 2020 2020 2020  EP)..           
-000205b0: 2020 2020 2073 656c 662e 6361 6d65 7261       self.camera
-000205c0: 2e7a 6f6f 6d20 3d20 6d69 6e28 5b73 656c  .zoom = min([sel
-000205d0: 662e 6361 6d65 7261 2e7a 6f6f 6d2c 2053  f.camera.zoom, S
-000205e0: 6567 6d65 6e74 6174 696f 6e45 6469 746f  egmentationEdito
-000205f0: 722e 4341 4d45 5241 5f4d 4158 5f5a 4f4f  r.CAMERA_MAX_ZOO
-00020600: 4d5d 290d 0a20 2020 2020 2020 2065 6c73  M])..        els
-00020610: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00020620: 6966 2053 6567 6d65 6e74 6174 696f 6e45  if SegmentationE
-00020630: 6469 746f 722e 6973 5f73 6869 6674 5f64  ditor.is_shift_d
-00020640: 6f77 6e28 293a 0d0a 2020 2020 2020 2020  own():..        
-00020650: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00020660: 7769 6e64 6f77 2e67 6574 5f6d 6f75 7365  window.get_mouse
-00020670: 5f62 7574 746f 6e28 676c 6677 2e4d 4f55  _button(glfw.MOU
-00020680: 5345 5f42 5554 544f 4e5f 4d49 4444 4c45  SE_BUTTON_MIDDLE
-00020690: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-000206a0: 2020 2020 2020 2020 7365 6c66 2e63 616d          self.cam
-000206b0: 6572 6133 642e 7069 7463 6820 2b3d 2073  era3d.pitch += s
-000206c0: 656c 662e 7769 6e64 6f77 2e63 7572 736f  elf.window.curso
-000206d0: 725f 6465 6c74 615b 315d 202a 2053 6567  r_delta[1] * Seg
-000206e0: 6d65 6e74 6174 696f 6e45 6469 746f 722e  mentationEditor.
-000206f0: 5649 4557 5f33 445f 5049 564f 545f 5350  VIEW_3D_PIVOT_SP
-00020700: 4545 440d 0a20 2020 2020 2020 2020 2020  EED..           
-00020710: 2020 2020 2020 2020 2073 656c 662e 6361           self.ca
-00020720: 6d65 7261 3364 2e79 6177 202b 3d20 7365  mera3d.yaw += se
-00020730: 6c66 2e77 696e 646f 772e 6375 7273 6f72  lf.window.cursor
-00020740: 5f64 656c 7461 5b30 5d20 2a20 5365 676d  _delta[0] * Segm
-00020750: 656e 7461 7469 6f6e 4564 6974 6f72 2e56  entationEditor.V
-00020760: 4945 575f 3344 5f50 4956 4f54 5f53 5045  IEW_3D_PIVOT_SPE
-00020770: 4544 0d0a 2020 2020 2020 2020 2020 2020  ED..            
-00020780: 2020 2020 2020 2020 7365 6c66 2e63 616d          self.cam
-00020790: 6572 6133 642e 7069 7463 6820 3d20 636c  era3d.pitch = cl
-000207a0: 616d 7028 7365 6c66 2e63 616d 6572 6133  amp(self.camera3
-000207b0: 642e 7069 7463 682c 202d 3839 2e39 2c20  d.pitch, -89.9, 
-000207c0: 3839 2e39 290d 0a20 2020 2020 2020 2020  89.9)..         
-000207d0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-000207e0: 6c66 2e77 696e 646f 772e 6375 7273 6f72  lf.window.cursor
-000207f0: 5f64 656c 7461 5b30 5d20 213d 2030 206f  _delta[0] != 0 o
-00020800: 7220 7365 6c66 2e77 696e 646f 772e 6375  r self.window.cu
-00020810: 7273 6f72 5f64 656c 7461 5b31 5d20 213d  rsor_delta[1] !=
-00020820: 2030 3a0d 0a20 2020 2020 2020 2020 2020   0:..           
-00020830: 2020 2020 2020 2020 2020 2020 2053 6567               Seg
-00020840: 6d65 6e74 6174 696f 6e45 6469 746f 722e  mentationEditor.
-00020850: 5649 4557 5f52 4551 5549 5245 535f 5550  VIEW_REQUIRES_UP
-00020860: 4441 5445 203d 2054 7275 650d 0a20 2020  DATE = True..   
-00020870: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00020880: 662e 6361 6d65 7261 3364 2e64 6973 7461  f.camera3d.dista
-00020890: 6e63 6520 2d3d 2073 656c 662e 7769 6e64  nce -= self.wind
-000208a0: 6f77 2e73 6372 6f6c 6c5f 6465 6c74 615b  ow.scroll_delta[
-000208b0: 315d 202a 2053 6567 6d65 6e74 6174 696f  1] * Segmentatio
-000208c0: 6e45 6469 746f 722e 5649 4557 5f33 445f  nEditor.VIEW_3D_
-000208d0: 4d4f 5645 5f53 5045 4544 0d0a 2020 2020  MOVE_SPEED..    
-000208e0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-000208f0: 656c 662e 7769 6e64 6f77 2e73 6372 6f6c  elf.window.scrol
-00020900: 6c5f 6465 6c74 615b 315d 2021 3d20 303a  l_delta[1] != 0:
-00020910: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00020920: 2020 2020 2020 5365 676d 656e 7461 7469        Segmentati
-00020930: 6f6e 4564 6974 6f72 2e56 4945 575f 5245  onEditor.VIEW_RE
-00020940: 5155 4952 4553 5f55 5044 4154 4520 3d20  QUIRES_UPDATE = 
-00020950: 5472 7565 0d0a 2020 2020 2020 2020 2020  True..          
-00020960: 2020 2020 2020 7365 6c66 2e63 616d 6572        self.camer
-00020970: 6133 642e 6469 7374 616e 6365 203d 206d  a3d.distance = m
-00020980: 6178 2831 302e 302c 2073 656c 662e 6361  ax(10.0, self.ca
-00020990: 6d65 7261 3364 2e64 6973 7461 6e63 6529  mera3d.distance)
-000209a0: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
-000209b0: 6966 2073 656c 662e 7769 6e64 6f77 2e67  if self.window.g
-000209c0: 6574 5f6d 6f75 7365 5f62 7574 746f 6e28  et_mouse_button(
-000209d0: 676c 6677 2e4d 4f55 5345 5f42 5554 544f  glfw.MOUSE_BUTTO
-000209e0: 4e5f 4d49 4444 4c45 293a 0d0a 2020 2020  N_MIDDLE):..    
-000209f0: 2020 2020 2020 2020 2020 2020 6478 203d              dx =
-00020a00: 202d 7365 6c66 2e77 696e 646f 772e 6375   -self.window.cu
-00020a10: 7273 6f72 5f64 656c 7461 5b30 5d0d 0a20  rsor_delta[0].. 
-00020a20: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00020a30: 7920 3d20 2d73 656c 662e 7769 6e64 6f77  y = -self.window
-00020a40: 2e63 7572 736f 725f 6465 6c74 615b 315d  .cursor_delta[1]
-00020a50: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00020a60: 2020 776f 726c 645f 6465 6c74 6120 3d20    world_delta = 
-00020a70: 7365 6c66 2e63 616d 6572 6133 642e 6375  self.camera3d.cu
-00020a80: 7273 6f72 5f64 656c 7461 5f74 6f5f 776f  rsor_delta_to_wo
-00020a90: 726c 645f 6465 6c74 6128 2864 782c 2064  rld_delta((dx, d
-00020aa0: 7929 290d 0a20 2020 2020 2020 2020 2020  y))..           
-00020ab0: 2020 2020 2073 656c 662e 6361 6d65 7261       self.camera
-00020ac0: 3364 2e66 6f63 7573 5b30 5d20 2b3d 2077  3d.focus[0] += w
-00020ad0: 6f72 6c64 5f64 656c 7461 5b30 5d0d 0a20  orld_delta[0].. 
-00020ae0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00020af0: 656c 662e 6361 6d65 7261 3364 2e66 6f63  elf.camera3d.foc
-00020b00: 7573 5b31 5d20 2b3d 2077 6f72 6c64 5f64  us[1] += world_d
-00020b10: 656c 7461 5b31 5d0d 0a20 2020 2020 2020  elta[1]..       
-00020b20: 2020 2020 2020 2020 2073 656c 662e 6361           self.ca
-00020b30: 6d65 7261 3364 2e66 6f63 7573 5b32 5d20  mera3d.focus[2] 
-00020b40: 2b3d 2077 6f72 6c64 5f64 656c 7461 5b32  += world_delta[2
-00020b50: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
-00020b60: 2020 2069 6620 6478 2021 3d20 3020 6f72     if dx != 0 or
-00020b70: 2064 7920 213d 2030 3a0d 0a20 2020 2020   dy != 0:..     
-00020b80: 2020 2020 2020 2020 2020 2020 2020 2053                 S
-00020b90: 6567 6d65 6e74 6174 696f 6e45 6469 746f  egmentationEdito
-00020ba0: 722e 5649 4557 5f52 4551 5549 5245 535f  r.VIEW_REQUIRES_
-00020bb0: 5550 4441 5445 203d 2054 7275 650d 0a0d  UPDATE = True...
-00020bc0: 0a20 2020 2064 6566 2065 6e64 5f66 7261  .    def end_fra
-00020bd0: 6d65 2873 656c 6629 3a0d 0a20 2020 2020  me(self):..     
-00020be0: 2020 2073 656c 662e 7769 6e64 6f77 2e65     self.window.e
-00020bf0: 6e64 5f66 7261 6d65 2829 0d0a 0d0a 2020  nd_frame()....  
-00020c00: 2020 4073 7461 7469 636d 6574 686f 640d    @staticmethod.
-00020c10: 0a20 2020 2064 6566 2073 6574 5f6c 6f67  .    def set_log
-00020c20: 5f70 6174 6828 7061 7468 293a 0d0a 2020  _path(path):..  
-00020c30: 2020 2020 2020 6366 672e 6c6f 675f 7061        cfg.log_pa
-00020c40: 7468 203d 2070 6174 680d 0a20 2020 2020  th = path..     
-00020c50: 2020 2063 6667 2e73 7461 7274 5f6c 6f67     cfg.start_log
-00020c60: 2829 0d0a 0d0a 2020 2020 4073 7461 7469  ()....    @stati
-00020c70: 636d 6574 686f 640d 0a20 2020 2064 6566  cmethod..    def
-00020c80: 2066 6f72 6365 5f6e 6f74 5f65 6d62 6564   force_not_embed
-00020c90: 6465 6428 293a 0d0a 2020 2020 2020 2020  ded():..        
-00020ca0: 676c 6f62 616c 2045 4d42 4544 4445 440d  global EMBEDDED.
-00020cb0: 0a20 2020 2020 2020 2045 4d42 4544 4445  .        EMBEDDE
-00020cc0: 4420 3d20 4661 6c73 650d 0a0d 0a0d 0a20  D = False...... 
-00020cd0: 2020 2040 7374 6174 6963 6d65 7468 6f64     @staticmethod
-00020ce0: 0d0a 2020 2020 6465 6620 6973 5f73 6869  ..    def is_shi
-00020cf0: 6674 5f64 6f77 6e28 293a 0d0a 2020 2020  ft_down():..    
-00020d00: 2020 2020 7265 7475 726e 2069 6d67 7569      return imgui
-00020d10: 2e69 735f 6b65 795f 646f 776e 2867 6c66  .is_key_down(glf
-00020d20: 772e 4b45 595f 4c45 4654 5f53 4849 4654  w.KEY_LEFT_SHIFT
-00020d30: 2920 6f72 2069 6d67 7569 2e69 735f 6b65  ) or imgui.is_ke
-00020d40: 795f 646f 776e 2867 6c66 772e 4b45 595f  y_down(glfw.KEY_
-00020d50: 5249 4748 545f 5348 4946 5429 0d0a 0d0a  RIGHT_SHIFT)....
-00020d60: 2020 2020 4073 7461 7469 636d 6574 686f      @staticmetho
-00020d70: 640d 0a20 2020 2064 6566 2069 735f 6374  d..    def is_ct
-00020d80: 726c 5f64 6f77 6e28 293a 0d0a 2020 2020  rl_down():..    
-00020d90: 2020 2020 7265 7475 726e 2069 6d67 7569      return imgui
-00020da0: 2e69 735f 6b65 795f 646f 776e 2867 6c66  .is_key_down(glf
-00020db0: 772e 4b45 595f 4c45 4654 5f43 4f4e 5452  w.KEY_LEFT_CONTR
-00020dc0: 4f4c 2920 6f72 2069 6d67 7569 2e69 735f  OL) or imgui.is_
-00020dd0: 6b65 795f 646f 776e 2867 6c66 772e 4b45  key_down(glfw.KE
-00020de0: 595f 5249 4748 545f 434f 4e54 524f 4c29  Y_RIGHT_CONTROL)
-00020df0: 0d0a 0d0a 0d0a 636c 6173 7320 4272 7573  ......class Brus
-00020e00: 683a 0d0a 2020 2020 6369 7263 756c 6172  h:..    circular
-00020e10: 5f72 6f69 203d 206e 702e 7a65 726f 7328  _roi = np.zeros(
-00020e20: 312c 2064 7479 7065 3d6e 702e 7569 6e74  1, dtype=np.uint
-00020e30: 3829 0d0a 2020 2020 6369 7263 756c 6172  8)..    circular
-00020e40: 5f72 6f69 5f72 6164 6975 7320 3d20 2d31  _roi_radius = -1
-00020e50: 0d0a 2020 2020 6d61 6769 635f 726f 6920  ..    magic_roi 
-00020e60: 3d20 6e70 2e7a 6572 6f73 2831 2c20 6474  = np.zeros(1, dt
-00020e70: 7970 653d 6e70 2e75 696e 7438 290d 0a20  ype=np.uint8).. 
-00020e80: 2020 206d 6167 6963 5f72 6f69 5f72 6164     magic_roi_rad
-00020e90: 6975 7320 3d20 2d31 0d0a 0d0a 2020 2020  ius = -1....    
-00020ea0: 4073 7461 7469 636d 6574 686f 640d 0a20  @staticmethod.. 
-00020eb0: 2020 2064 6566 2073 6574 5f63 6972 6375     def set_circu
-00020ec0: 6c61 725f 726f 695f 7261 6469 7573 2872  lar_roi_radius(r
-00020ed0: 6164 6975 7329 3a0d 0a20 2020 2020 2020  adius):..       
-00020ee0: 2069 6620 4272 7573 682e 6369 7263 756c   if Brush.circul
-00020ef0: 6172 5f72 6f69 5f72 6164 6975 7320 3d3d  ar_roi_radius ==
-00020f00: 2072 6164 6975 733a 0d0a 2020 2020 2020   radius:..      
-00020f10: 2020 2020 2020 7265 7475 726e 0d0a 2020        return..  
-00020f20: 2020 2020 2020 4272 7573 682e 6369 7263        Brush.circ
-00020f30: 756c 6172 5f72 6f69 5f72 6164 6975 7320  ular_roi_radius 
-00020f40: 3d20 7261 6469 7573 0d0a 2020 2020 2020  = radius..      
-00020f50: 2020 4272 7573 682e 6369 7263 756c 6172    Brush.circular
-00020f60: 5f72 6f69 203d 206e 702e 7a65 726f 7328  _roi = np.zeros(
-00020f70: 2832 2a72 6164 6975 732b 312c 2032 2a72  (2*radius+1, 2*r
-00020f80: 6164 6975 732b 3129 2c20 6474 7970 653d  adius+1), dtype=
-00020f90: 6e70 2e75 696e 7438 290d 0a20 2020 2020  np.uint8)..     
-00020fa0: 2020 2072 203d 2072 6164 6975 732a 2a32     r = radius**2
-00020fb0: 0d0a 2020 2020 2020 2020 666f 7220 7820  ..        for x 
-00020fc0: 696e 2072 616e 6765 2830 2c20 322a 7261  in range(0, 2*ra
-00020fd0: 6469 7573 2b31 293a 0d0a 2020 2020 2020  dius+1):..      
-00020fe0: 2020 2020 2020 666f 7220 7920 696e 2072        for y in r
-00020ff0: 616e 6765 2830 2c20 322a 7261 6469 7573  ange(0, 2*radius
-00021000: 2b31 293a 0d0a 2020 2020 2020 2020 2020  +1):..          
-00021010: 2020 2020 2020 6966 2028 2878 2d72 6164        if ((x-rad
-00021020: 6975 7329 2a2a 3220 2b20 2879 2d72 6164  ius)**2 + (y-rad
-00021030: 6975 7329 2a2a 3229 203c 2072 3a0d 0a20  ius)**2) < r:.. 
-00021040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021050: 2020 2042 7275 7368 2e63 6972 6375 6c61     Brush.circula
-00021060: 725f 726f 695b 782c 2079 5d20 3d20 5472  r_roi[x, y] = Tr
-00021070: 7565 0d0a 0d0a 2020 2020 4073 7461 7469  ue....    @stati
-00021080: 636d 6574 686f 640d 0a20 2020 2064 6566  cmethod..    def
-00021090: 2073 6574 5f6d 6167 6963 5f72 6f69 5f72   set_magic_roi_r
-000210a0: 6164 6975 7328 7261 6469 7573 293a 0d0a  adius(radius):..
-000210b0: 2020 2020 2020 2020 6966 2042 7275 7368          if Brush
-000210c0: 2e6d 6167 6963 5f72 6f69 5f72 6164 6975  .magic_roi_radiu
-000210d0: 7320 3d3d 2072 6164 6975 733a 0d0a 2020  s == radius:..  
-000210e0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-000210f0: 0d0a 2020 2020 2020 2020 4272 7573 682e  ..        Brush.
-00021100: 6d61 6769 635f 726f 695f 7261 6469 7573  magic_roi_radius
-00021110: 203d 2072 6164 6975 730d 0a20 2020 2020   = radius..     
-00021120: 2020 2042 7275 7368 2e6d 6167 6963 5f72     Brush.magic_r
-00021130: 6f69 203d 206e 702e 7a65 726f 7328 2832  oi = np.zeros((2
-00021140: 202a 2072 6164 6975 7320 2b20 312c 2032   * radius + 1, 2
-00021150: 202a 2072 6164 6975 7320 2b20 3129 2c20   * radius + 1), 
-00021160: 6474 7970 653d 6e70 2e75 696e 7438 290d  dtype=np.uint8).
-00021170: 0a20 2020 2020 2020 2072 203d 2072 6164  .        r = rad
-00021180: 6975 7320 2a2a 2032 0d0a 2020 2020 2020  ius ** 2..      
-00021190: 2020 666f 7220 7820 696e 2072 616e 6765    for x in range
-000211a0: 2830 2c20 3220 2a20 7261 6469 7573 202b  (0, 2 * radius +
-000211b0: 2031 293a 0d0a 2020 2020 2020 2020 2020   1):..          
-000211c0: 2020 666f 7220 7920 696e 2072 616e 6765    for y in range
-000211d0: 2830 2c20 3220 2a20 7261 6469 7573 202b  (0, 2 * radius +
-000211e0: 2031 293a 0d0a 2020 2020 2020 2020 2020   1):..          
-000211f0: 2020 2020 2020 6966 2028 2878 202d 2072        if ((x - r
-00021200: 6164 6975 7329 202a 2a20 3220 2b20 2879  adius) ** 2 + (y
-00021210: 202d 2072 6164 6975 7329 202a 2a20 3229   - radius) ** 2)
-00021220: 203c 2072 3a0d 0a20 2020 2020 2020 2020   < r:..         
-00021230: 2020 2020 2020 2020 2020 2042 7275 7368             Brush
-00021240: 2e6d 6167 6963 5f72 6f69 5b78 2c20 795d  .magic_roi[x, y]
-00021250: 203d 2054 7275 650d 0a0d 0a20 2020 2040   = True....    @
-00021260: 7374 6174 6963 6d65 7468 6f64 0d0a 2020  staticmethod..  
-00021270: 2020 6465 6620 6170 706c 795f 6369 7263    def apply_circ
-00021280: 756c 6172 2873 6567 6d65 6e74 6174 696f  ular(segmentatio
-00021290: 6e2c 2063 656e 7465 725f 636f 6f72 6469  n, center_coordi
-000212a0: 6e61 7465 732c 2076 616c 3d54 7275 6529  nates, val=True)
-000212b0: 3a0d 0a20 2020 2020 2020 2023 2063 6865  :..        # che
-000212c0: 636b 2069 6620 7468 6520 6375 7272 656e  ck if the curren
-000212d0: 7420 736c 6963 6520 616c 7265 6164 7920  t slice already 
-000212e0: 6578 6973 7473 3b20 6966 206e 6f74 2c20  exists; if not, 
-000212f0: 6d61 6b65 2069 742e 0d0a 2020 2020 2020  make it...      
-00021300: 2020 7365 676d 656e 7461 7469 6f6e 2e72    segmentation.r
-00021310: 6571 7565 7374 5f64 7261 775f 696e 5f63  equest_draw_in_c
-00021320: 7572 7265 6e74 5f73 6c69 6365 2829 0d0a  urrent_slice()..
-00021330: 2020 2020 2020 2020 7220 3d20 696e 7428          r = int(
-00021340: 7365 676d 656e 7461 7469 6f6e 2e62 7275  segmentation.bru
-00021350: 7368 5f73 697a 6529 0d0a 2020 2020 2020  sh_size)..      
-00021360: 2020 6365 6e74 6572 5f63 6f6f 7264 696e    center_coordin
-00021370: 6174 6573 5b30 5d2c 2063 656e 7465 725f  ates[0], center_
-00021380: 636f 6f72 6469 6e61 7465 735b 315d 203d  coordinates[1] =
-00021390: 2063 656e 7465 725f 636f 6f72 6469 6e61   center_coordina
-000213a0: 7465 735b 315d 2c20 6365 6e74 6572 5f63  tes[1], center_c
-000213b0: 6f6f 7264 696e 6174 6573 5b30 5d0d 0a20  oordinates[0].. 
-000213c0: 2020 2020 2020 2042 7275 7368 2e73 6574         Brush.set
-000213d0: 5f63 6972 6375 6c61 725f 726f 695f 7261  _circular_roi_ra
-000213e0: 6469 7573 2872 290d 0a0d 0a20 2020 2020  dius(r)....     
-000213f0: 2020 2078 203d 205b 6365 6e74 6572 5f63     x = [center_c
-00021400: 6f6f 7264 696e 6174 6573 5b30 5d20 2d20  oordinates[0] - 
-00021410: 722c 2063 656e 7465 725f 636f 6f72 6469  r, center_coordi
-00021420: 6e61 7465 735b 305d 202b 2072 202b 2031  nates[0] + r + 1
-00021430: 5d0d 0a20 2020 2020 2020 2079 203d 205b  ]..        y = [
-00021440: 6365 6e74 6572 5f63 6f6f 7264 696e 6174  center_coordinat
-00021450: 6573 5b31 5d20 2d20 722c 2063 656e 7465  es[1] - r, cente
-00021460: 725f 636f 6f72 6469 6e61 7465 735b 315d  r_coordinates[1]
-00021470: 202b 2072 202b 2031 5d0d 0a20 2020 2020   + r + 1]..     
-00021480: 2020 2072 7820 3d20 5b30 2c20 3220 2a20     rx = [0, 2 * 
-00021490: 7220 2b20 315d 0d0a 2020 2020 2020 2020  r + 1]..        
-000214a0: 7279 203d 205b 302c 2032 202a 2072 202b  ry = [0, 2 * r +
-000214b0: 2031 5d0d 0a20 2020 2020 2020 2069 6620   1]..        if 
-000214c0: 785b 305d 203e 2073 6567 6d65 6e74 6174  x[0] > segmentat
-000214d0: 696f 6e2e 6865 6967 6874 206f 7220 785b  ion.height or x[
-000214e0: 315d 203c 2030 206f 7220 795b 305d 203e  1] < 0 or y[0] >
-000214f0: 2073 6567 6d65 6e74 6174 696f 6e2e 7769   segmentation.wi
-00021500: 6474 6820 6f72 2079 5b31 5d20 3c20 303a  dth or y[1] < 0:
-00021510: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
-00021520: 7475 726e 0d0a 2020 2020 2020 2020 6966  turn..        if
-00021530: 2078 5b30 5d20 3c20 303a 0d0a 2020 2020   x[0] < 0:..    
-00021540: 2020 2020 2020 2020 7278 5b30 5d20 2d3d          rx[0] -=
-00021550: 2078 5b30 5d0d 0a20 2020 2020 2020 2020   x[0]..         
-00021560: 2020 2078 5b30 5d20 3d20 300d 0a20 2020     x[0] = 0..   
-00021570: 2020 2020 2069 6620 795b 305d 203c 2030       if y[0] < 0
-00021580: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
-00021590: 795b 305d 202d 3d20 795b 305d 0d0a 2020  y[0] -= y[0]..  
-000215a0: 2020 2020 2020 2020 2020 795b 305d 203d            y[0] =
-000215b0: 2030 0d0a 2020 2020 2020 2020 6966 2078   0..        if x
-000215c0: 5b31 5d20 3e20 7365 676d 656e 7461 7469  [1] > segmentati
-000215d0: 6f6e 2e68 6569 6768 743a 0d0a 2020 2020  on.height:..    
-000215e0: 2020 2020 2020 2020 7278 5b31 5d20 2d3d          rx[1] -=
-000215f0: 2028 785b 315d 202d 2073 6567 6d65 6e74   (x[1] - segment
-00021600: 6174 696f 6e2e 6865 6967 6874 290d 0a20  ation.height).. 
-00021610: 2020 2020 2020 2020 2020 2078 5b31 5d20             x[1] 
-00021620: 3d20 7365 676d 656e 7461 7469 6f6e 2e68  = segmentation.h
-00021630: 6569 6768 740d 0a20 2020 2020 2020 2069  eight..        i
-00021640: 6620 795b 315d 203e 2073 6567 6d65 6e74  f y[1] > segment
-00021650: 6174 696f 6e2e 7769 6474 683a 0d0a 2020  ation.width:..  
-00021660: 2020 2020 2020 2020 2020 7279 5b31 5d20            ry[1] 
-00021670: 2d3d 2028 795b 315d 202d 2073 6567 6d65  -= (y[1] - segme
-00021680: 6e74 6174 696f 6e2e 7769 6474 6829 0d0a  ntation.width)..
-00021690: 2020 2020 2020 2020 2020 2020 795b 315d              y[1]
-000216a0: 203d 2073 6567 6d65 6e74 6174 696f 6e2e   = segmentation.
-000216b0: 7769 6474 680d 0a0d 0a20 2020 2020 2020  width....       
-000216c0: 2069 6620 7661 6c3a 0d0a 2020 2020 2020   if val:..      
-000216d0: 2020 2020 2020 7365 676d 656e 7461 7469        segmentati
-000216e0: 6f6e 2e64 6174 615b 785b 305d 3a78 5b31  on.data[x[0]:x[1
-000216f0: 5d2c 2079 5b30 5d3a 795b 315d 5d20 2b3d  ], y[0]:y[1]] +=
-00021700: 2042 7275 7368 2e63 6972 6375 6c61 725f   Brush.circular_
-00021710: 726f 695b 7278 5b30 5d3a 7278 5b31 5d2c  roi[rx[0]:rx[1],
-00021720: 2072 795b 305d 3a72 795b 315d 5d0d 0a20   ry[0]:ry[1]].. 
-00021730: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-00021740: 2020 2020 2020 2020 2020 7365 676d 656e            segmen
-00021750: 7461 7469 6f6e 2e64 6174 615b 785b 305d  tation.data[x[0]
-00021760: 3a78 5b31 5d2c 2079 5b30 5d3a 795b 315d  :x[1], y[0]:y[1]
-00021770: 5d20 2a3d 2028 6e70 2e75 696e 7438 2831  ] *= (np.uint8(1
-00021780: 2e30 2920 2d20 4272 7573 682e 6369 7263  .0) - Brush.circ
-00021790: 756c 6172 5f72 6f69 5b72 785b 305d 3a72  ular_roi[rx[0]:r
-000217a0: 785b 315d 2c20 7279 5b30 5d3a 7279 5b31  x[1], ry[0]:ry[1
-000217b0: 5d5d 290d 0a0d 0a20 2020 2020 2020 2073  ]])....        s
-000217c0: 6567 6d65 6e74 6174 696f 6e2e 6461 7461  egmentation.data
-000217d0: 5b78 5b30 5d3a 785b 315d 2c20 795b 305d  [x[0]:x[1], y[0]
-000217e0: 3a79 5b31 5d5d 203d 206e 702e 636c 6970  :y[1]] = np.clip
-000217f0: 2873 6567 6d65 6e74 6174 696f 6e2e 6461  (segmentation.da
-00021800: 7461 5b78 5b30 5d3a 785b 315d 2c20 795b  ta[x[0]:x[1], y[
-00021810: 305d 3a79 5b31 5d5d 2c20 302c 2031 290d  0]:y[1]], 0, 1).
-00021820: 0a20 2020 2020 2020 2073 6567 6d65 6e74  .        segment
-00021830: 6174 696f 6e2e 7465 7874 7572 652e 7570  ation.texture.up
-00021840: 6461 7465 5f73 7562 696d 6167 6528 7365  date_subimage(se
-00021850: 676d 656e 7461 7469 6f6e 2e64 6174 615b  gmentation.data[
-00021860: 785b 305d 3a78 5b31 5d2c 2079 5b30 5d3a  x[0]:x[1], y[0]:
-00021870: 795b 315d 5d2c 2079 5b30 5d2c 2078 5b30  y[1]], y[0], x[0
-00021880: 5d29 0d0a 0d0a 2020 2020 4073 7461 7469  ])....    @stati
-00021890: 636d 6574 686f 640d 0a20 2020 2064 6566  cmethod..    def
-000218a0: 2061 7070 6c79 5f6d 6167 6963 2873 6567   apply_magic(seg
-000218b0: 6d65 6e74 6174 696f 6e2c 2069 6d61 6765  mentation, image
-000218c0: 2c20 6365 6e74 6572 5f63 6f6f 7264 696e  , center_coordin
-000218d0: 6174 6573 293a 0d0a 2020 2020 2020 2020  ates):..        
-000218e0: 7365 676d 656e 7461 7469 6f6e 2e72 6571  segmentation.req
-000218f0: 7565 7374 5f64 7261 775f 696e 5f63 7572  uest_draw_in_cur
-00021900: 7265 6e74 5f73 6c69 6365 2829 0d0a 2020  rent_slice()..  
-00021910: 2020 2020 2020 7220 3d20 696e 7428 7365        r = int(se
-00021920: 676d 656e 7461 7469 6f6e 2e62 7275 7368  gmentation.brush
-00021930: 5f73 697a 6529 0d0a 2020 2020 2020 2020  _size)..        
-00021940: 6365 6e74 6572 5f63 6f6f 7264 696e 6174  center_coordinat
-00021950: 6573 5b30 5d2c 2063 656e 7465 725f 636f  es[0], center_co
-00021960: 6f72 6469 6e61 7465 735b 315d 203d 2063  ordinates[1] = c
+0001f870: 2020 2020 2020 2020 4d6f 6465 6c49 6e74          ModelInt
+0001f880: 6572 6163 7469 6f6e 2e66 726f 6d5f 6469  eraction.from_di
+0001f890: 6374 2864 290d 0a0d 0a20 2020 2020 2020  ct(d)....       
+0001f8a0: 2065 7863 6570 7420 4578 6365 7074 696f   except Exceptio
+0001f8b0: 6e20 6173 2065 3a0d 0a20 2020 2020 2020  n as e:..       
+0001f8c0: 2020 2020 2063 6667 2e73 6574 5f65 7272       cfg.set_err
+0001f8d0: 6f72 2865 2c20 2245 7272 6f72 206c 6f61  or(e, "Error loa
+0001f8e0: 6469 6e67 206d 6f64 656c 2067 726f 7570  ding model group
+0001f8f0: 2c20 7365 6520 6465 7461 696c 7320 6265  , see details be
+0001f900: 6c6f 772e 2229 0d0a 0d0a 2020 2020 4073  low.")....    @s
+0001f910: 7461 7469 636d 6574 686f 640d 0a20 2020  taticmethod..   
+0001f920: 2064 6566 206c 6f61 645f 6d6f 6465 6c28   def load_model(
+0001f930: 7061 7468 293a 0d0a 2020 2020 2020 2020  path):..        
+0001f940: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
+0001f950: 2020 6d6f 6465 6c20 3d20 5345 4d6f 6465    model = SEMode
+0001f960: 6c28 290d 0a20 2020 2020 2020 2020 2020  l()..           
+0001f970: 206d 6f64 656c 2e6c 6f61 6428 7061 7468   model.load(path
+0001f980: 290d 0a20 2020 2020 2020 2020 2020 2063  )..            c
+0001f990: 6667 2e73 655f 6d6f 6465 6c73 2e61 7070  fg.se_models.app
+0001f9a0: 656e 6428 6d6f 6465 6c29 0d0a 2020 2020  end(model)..    
+0001f9b0: 2020 2020 6578 6365 7074 2045 7863 6570      except Excep
+0001f9c0: 7469 6f6e 2061 7320 653a 0d0a 2020 2020  tion as e:..    
+0001f9d0: 2020 2020 2020 2020 6366 672e 7365 745f          cfg.set_
+0001f9e0: 6572 726f 7228 652c 2022 4572 726f 7220  error(e, "Error 
+0001f9f0: 6c6f 6164 696e 6720 6d6f 6465 6c2c 2073  loading model, s
+0001fa00: 6565 2064 6574 6169 6c73 2062 656c 6f77  ee details below
+0001fa10: 2e22 290d 0a0d 0a20 2020 2040 7374 6174  .")....    @stat
+0001fa20: 6963 6d65 7468 6f64 0d0a 2020 2020 6465  icmethod..    de
+0001fa30: 6620 7361 7665 5f6d 6f64 656c 5f67 726f  f save_model_gro
+0001fa40: 7570 2870 6174 6829 3a0d 0a20 2020 2020  up(path):..     
+0001fa50: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
+0001fa60: 2020 2020 2067 726f 7570 5f6e 616d 6520       group_name 
+0001fa70: 3d20 6f73 2e70 6174 682e 7370 6c69 7465  = os.path.splite
+0001fa80: 7874 286f 732e 7061 7468 2e62 6173 656e  xt(os.path.basen
+0001fa90: 616d 6528 7061 7468 2929 5b30 5d0d 0a0d  ame(path))[0]...
+0001faa0: 0a20 2020 2020 2020 2020 2020 2023 2043  .            # C
+0001fab0: 7265 6174 6520 6120 7465 6d70 6f72 6172  reate a temporar
+0001fac0: 7920 6469 7265 6374 6f72 7920 746f 2068  y directory to h
+0001fad0: 6f6c 6420 7468 6520 6669 6c65 7320 6265  old the files be
+0001fae0: 666f 7265 2061 7263 6869 7669 6e67 0d0a  fore archiving..
+0001faf0: 2020 2020 2020 2020 2020 2020 7769 7468              with
+0001fb00: 2074 656d 7066 696c 652e 5465 6d70 6f72   tempfile.Tempor
+0001fb10: 6172 7944 6972 6563 746f 7279 2829 2061  aryDirectory() a
+0001fb20: 7320 7465 6d70 5f64 6972 3a0d 0a20 2020  s temp_dir:..   
+0001fb30: 2020 2020 2020 2020 2020 2020 206d 6f64               mod
+0001fb40: 656c 5f70 6174 6873 203d 206c 6973 7428  el_paths = list(
+0001fb50: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0001fb60: 2020 2069 203d 2030 0d0a 2020 2020 2020     i = 0..      
+0001fb70: 2020 2020 2020 2020 2020 666f 7220 6d20            for m 
+0001fb80: 696e 2063 6667 2e73 655f 6d6f 6465 6c73  in cfg.se_models
+0001fb90: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0001fba0: 2020 2020 2020 206d 5f70 6174 6820 3d20         m_path = 
+0001fbb0: 6f73 2e70 6174 682e 6a6f 696e 2874 656d  os.path.join(tem
+0001fbc0: 705f 6469 722c 2067 726f 7570 5f6e 616d  p_dir, group_nam
+0001fbd0: 6520 2b20 6622 5f6d 6f64 656c 5f7b 697d  e + f"_model_{i}
+0001fbe0: 2220 2b20 6366 672e 6669 6c65 7479 7065  " + cfg.filetype
+0001fbf0: 5f73 656d 6f64 656c 290d 0a20 2020 2020  _semodel)..     
+0001fc00: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+0001fc10: 2e73 6176 6528 6d5f 7061 7468 2920 2023  .save(m_path)  #
+0001fc20: 2053 6176 6520 6d6f 6465 6c20 6469 7265   Save model dire
+0001fc30: 6374 6c79 2074 6f20 7468 6520 7465 6d70  ctly to the temp
+0001fc40: 6f72 6172 7920 6469 7265 6374 6f72 790d  orary directory.
+0001fc50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001fc60: 2020 2020 206d 6f64 656c 5f70 6174 6873       model_paths
+0001fc70: 2e61 7070 656e 6428 6d5f 7061 7468 290d  .append(m_path).
+0001fc80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001fc90: 2020 2020 2069 202b 3d20 310d 0a0d 0a20       i += 1.... 
+0001fca0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0001fcb0: 2053 6176 6520 696e 7465 7261 6374 696f   Save interactio
+0001fcc0: 6e73 2061 7320 6a73 6f6e 2069 6e20 7468  ns as json in th
+0001fcd0: 6520 7465 6d70 6f72 6172 7920 6469 7265  e temporary dire
+0001fce0: 6374 6f72 790d 0a20 2020 2020 2020 2020  ctory..         
+0001fcf0: 2020 2020 2020 2069 6e74 6572 6163 7469         interacti
+0001fd00: 6f6e 5f64 6963 745f 6c69 7374 203d 206c  on_dict_list = l
+0001fd10: 6973 7428 290d 0a20 2020 2020 2020 2020  ist()..         
+0001fd20: 2020 2020 2020 2066 6f72 2069 6e74 6572         for inter
+0001fd30: 6163 7469 6f6e 2069 6e20 4d6f 6465 6c49  action in ModelI
+0001fd40: 6e74 6572 6163 7469 6f6e 2e61 6c6c 3a0d  nteraction.all:.
+0001fd50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001fd60: 2020 2020 2069 6e74 6572 6163 7469 6f6e       interaction
+0001fd70: 5f64 6963 745f 6c69 7374 2e61 7070 656e  _dict_list.appen
+0001fd80: 6428 696e 7465 7261 6374 696f 6e2e 6173  d(interaction.as
+0001fd90: 5f64 6963 7428 2929 0d0a 2020 2020 2020  _dict())..      
+0001fda0: 2020 2020 2020 2020 2020 6a73 6f6e 5f70            json_p
+0001fdb0: 6174 6820 3d20 6f73 2e70 6174 682e 6a6f  ath = os.path.jo
+0001fdc0: 696e 2874 656d 705f 6469 722c 2066 227b  in(temp_dir, f"{
+0001fdd0: 6772 6f75 705f 6e61 6d65 7d5f 696e 7465  group_name}_inte
+0001fde0: 7261 6374 696f 6e73 2e6a 736f 6e22 290d  ractions.json").
+0001fdf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001fe00: 2077 6974 6820 6f70 656e 286a 736f 6e5f   with open(json_
+0001fe10: 7061 7468 2c20 2777 2729 2061 7320 6f75  path, 'w') as ou
+0001fe20: 7466 696c 653a 0d0a 2020 2020 2020 2020  tfile:..        
+0001fe30: 2020 2020 2020 2020 2020 2020 6a73 6f6e              json
+0001fe40: 2e64 756d 7028 696e 7465 7261 6374 696f  .dump(interactio
+0001fe50: 6e5f 6469 6374 5f6c 6973 742c 206f 7574  n_dict_list, out
+0001fe60: 6669 6c65 2c20 696e 6465 6e74 3d32 290d  file, indent=2).
+0001fe70: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+0001fe80: 2020 2023 2043 7265 6174 6520 6120 2e74     # Create a .t
+0001fe90: 6172 2e67 7a20 6172 6368 6976 6520 616e  ar.gz archive an
+0001fea0: 6420 6164 6420 616c 6c20 7468 6520 6d6f  d add all the mo
+0001feb0: 6465 6c20 616e 6420 4a53 4f4e 2066 696c  del and JSON fil
+0001fec0: 6573 0d0a 2020 2020 2020 2020 2020 2020  es..            
+0001fed0: 2020 2020 7769 7468 2074 6172 6669 6c65      with tarfile
+0001fee0: 2e6f 7065 6e28 7061 7468 2c20 2777 2729  .open(path, 'w')
+0001fef0: 2061 7320 7461 723a 0d0a 2020 2020 2020   as tar:..      
+0001ff00: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+0001ff10: 7220 6669 6c65 5f70 6174 6820 696e 206d  r file_path in m
+0001ff20: 6f64 656c 5f70 6174 6873 202b 205b 6a73  odel_paths + [js
+0001ff30: 6f6e 5f70 6174 685d 3a0d 0a20 2020 2020  on_path]:..     
+0001ff40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ff50: 2020 2074 6172 2e61 6464 2866 696c 655f     tar.add(file_
+0001ff60: 7061 7468 2c20 6172 636e 616d 653d 6f73  path, arcname=os
+0001ff70: 2e70 6174 682e 6261 7365 6e61 6d65 2866  .path.basename(f
+0001ff80: 696c 655f 7061 7468 2929 0d0a 0d0a 2020  ile_path))....  
+0001ff90: 2020 2020 2020 6578 6365 7074 2045 7863        except Exc
+0001ffa0: 6570 7469 6f6e 2061 7320 653a 0d0a 2020  eption as e:..  
+0001ffb0: 2020 2020 2020 2020 2020 6366 672e 7365            cfg.se
+0001ffc0: 745f 6572 726f 7228 652c 2022 4572 726f  t_error(e, "Erro
+0001ffd0: 7220 7361 7669 6e67 206d 6f64 656c 2067  r saving model g
+0001ffe0: 726f 7570 2c20 7365 6520 6465 7461 696c  roup, see detail
+0001fff0: 7320 6265 6c6f 7722 290d 0a0d 0a20 2020  s below")....   
+00020000: 2040 7374 6174 6963 6d65 7468 6f64 0d0a   @staticmethod..
+00020010: 2020 2020 6465 6620 7361 7665 5f73 7572      def save_sur
+00020020: 6661 6365 5f6d 6f64 656c 735f 6173 5f6f  face_models_as_o
+00020030: 626a 7328 293a 0d0a 2020 2020 2020 2020  bjs():..        
+00020040: 6f62 6a5f 7061 7468 203d 206f 732e 7061  obj_path = os.pa
+00020050: 7468 2e64 6972 6e61 6d65 2863 6667 2e73  th.dirname(cfg.s
+00020060: 655f 6163 7469 7665 5f66 7261 6d65 2e70  e_active_frame.p
+00020070: 6174 6829 0d0a 2020 2020 2020 2020 7061  ath)..        pa
+00020080: 7468 7320 3d20 6c69 7374 2829 0d0a 2020  ths = list()..  
+00020090: 2020 2020 2020 666f 7220 6d20 696e 2063        for m in c
+000200a0: 6667 2e73 655f 7375 7266 6163 655f 6d6f  fg.se_surface_mo
+000200b0: 6465 6c73 3a0d 0a20 2020 2020 2020 2020  dels:..         
+000200c0: 2020 206d 5f70 6174 6820 3d20 6d2e 7361     m_path = m.sa
+000200d0: 7665 5f61 735f 6f62 6a28 7061 7468 3d6f  ve_as_obj(path=o
+000200e0: 732e 7061 7468 2e6a 6f69 6e28 6f62 6a5f  s.path.join(obj_
+000200f0: 7061 7468 2c20 6d2e 7469 746c 6520 2b20  path, m.title + 
+00020100: 222e 6f62 6a22 2929 0d0a 2020 2020 2020  ".obj"))..      
+00020110: 2020 2020 2020 6966 206d 5f70 6174 6820        if m_path 
+00020120: 6973 206e 6f74 204e 6f6e 653a 0d0a 2020  is not None:..  
+00020130: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+00020140: 7468 732e 6170 7065 6e64 286d 5f70 6174  ths.append(m_pat
+00020150: 6829 0d0a 2020 2020 2020 2020 7265 7475  h)..        retu
+00020160: 726e 2070 6174 6873 0d0a 0d0a 2020 2020  rn paths....    
+00020170: 4073 7461 7469 636d 6574 686f 640d 0a20  @staticmethod.. 
+00020180: 2020 2064 6566 206f 7065 6e5f 6f62 6a73     def open_objs
+00020190: 5f69 6e5f 626c 656e 6465 7228 7061 7468  _in_blender(path
+000201a0: 7329 3a0d 0a20 2020 2020 2020 2074 7279  s):..        try
+000201b0: 3a0d 0a20 2020 2020 2020 2020 2020 2077  :..            w
+000201c0: 6974 6820 6f70 656e 286f 732e 7061 7468  ith open(os.path
+000201d0: 2e6a 6f69 6e28 6366 672e 726f 6f74 2c20  .join(cfg.root, 
+000201e0: 2263 6f72 6522 2c20 226f 7065 6e5f 696e  "core", "open_in
+000201f0: 5f62 6c65 6e64 6572 2e70 7922 292c 2022  _blender.py"), "
+00020200: 7222 2920 6173 2066 3a0d 0a20 2020 2020  r") as f:..     
+00020210: 2020 2020 2020 2020 2020 206c 696e 6573             lines
+00020220: 203d 2066 2e72 6561 646c 696e 6573 2829   = f.readlines()
+00020230: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+00020240: 6c69 6e65 7320 3d20 5b66 226f 626a 5f70  lines = [f"obj_p
+00020250: 6174 6873 203d 207b 7061 7468 737d 5c6e  aths = {paths}\n
+00020260: 2220 6966 2022 6f62 6a5f 7061 7468 7320  " if "obj_paths 
+00020270: 3d20 5b22 2069 6e20 6c69 6e65 2065 6c73  = [" in line els
+00020280: 6520 6c69 6e65 2066 6f72 206c 696e 6520  e line for line 
+00020290: 696e 206c 696e 6573 5d0d 0a0d 0a20 2020  in lines]....   
+000202a0: 2020 2020 2020 2020 2077 6974 6820 6f70           with op
+000202b0: 656e 286f 732e 7061 7468 2e6a 6f69 6e28  en(os.path.join(
+000202c0: 6366 672e 726f 6f74 2c20 2263 6f72 6522  cfg.root, "core"
+000202d0: 2c20 226f 7065 6e5f 696e 5f62 6c65 6e64  , "open_in_blend
+000202e0: 6572 2e70 7922 292c 2022 7722 2920 6173  er.py"), "w") as
+000202f0: 2066 3a0d 0a20 2020 2020 2020 2020 2020   f:..           
+00020300: 2020 2020 2066 2e77 7269 7465 6c69 6e65       f.writeline
+00020310: 7328 6c69 6e65 7329 0d0a 0d0a 2020 2020  s(lines)....    
+00020320: 2020 2020 2020 2020 7375 6270 726f 6365          subproce
+00020330: 7373 2e50 6f70 656e 285b 6366 672e 7365  ss.Popen([cfg.se
+00020340: 7474 696e 6773 5b22 424c 454e 4445 525f  ttings["BLENDER_
+00020350: 4558 4522 5d2c 2022 2d2d 7079 7468 6f6e  EXE"], "--python
+00020360: 222c 206f 732e 7061 7468 2e6a 6f69 6e28  ", os.path.join(
+00020370: 6366 672e 726f 6f74 2c20 2263 6f72 6522  cfg.root, "core"
+00020380: 2c20 226f 7065 6e5f 696e 5f62 6c65 6e64  , "open_in_blend
+00020390: 6572 2e70 7922 295d 290d 0a0d 0a20 2020  er.py")])....   
+000203a0: 2020 2020 2065 7863 6570 7420 4578 6365       except Exce
+000203b0: 7074 696f 6e20 6173 2065 3a0d 0a20 2020  ption as e:..   
+000203c0: 2020 2020 2020 2020 2063 6667 2e73 6574           cfg.set
+000203d0: 5f65 7272 6f72 2865 2c20 2243 6f75 6c64  _error(e, "Could
+000203e0: 206e 6f74 206f 7065 6e20 6d6f 6465 6c73   not open models
+000203f0: 2069 6e20 426c 656e 6465 7220 2d20 6973   in Blender - is
+00020400: 2074 6865 2070 6174 6820 746f 2074 6865   the path to the
+00020410: 2042 6c65 6e64 6572 2065 7865 6375 7461   Blender executa
+00020420: 626c 6520 7365 7420 696e 2073 6574 7469  ble set in setti
+00020430: 6e67 732e 7478 743f 2229 0d0a 0d0a 2020  ngs.txt?")....  
+00020440: 2020 4073 7461 7469 636d 6574 686f 640d    @staticmethod.
+00020450: 0a20 2020 2064 6566 206f 7065 6e5f 696e  .    def open_in
+00020460: 5f63 6869 6d65 7261 7828 7375 7266 6163  _chimerax(surfac
+00020470: 655f 6d6f 6465 6c73 293a 0d0a 2020 2020  e_models):..    
+00020480: 2020 2020 7472 793a 0d0a 2020 2020 2020      try:..      
+00020490: 2020 2020 2020 7061 7468 7320 3d20 6c69        paths = li
+000204a0: 7374 2829 0d0a 2020 2020 2020 2020 2020  st()..          
+000204b0: 2020 6c65 7665 6c20 3d20 6c69 7374 2829    level = list()
+000204c0: 0d0a 2020 2020 2020 2020 2020 2020 636f  ..            co
+000204d0: 6c6f 7572 203d 206c 6973 7428 290d 0a20  lour = list().. 
+000204e0: 2020 2020 2020 2020 2020 2064 7573 7420             dust 
+000204f0: 3d20 6c69 7374 2829 0d0a 2020 2020 2020  = list()..      
+00020500: 2020 2020 2020 666f 7220 6d20 696e 2073        for m in s
+00020510: 7572 6661 6365 5f6d 6f64 656c 733a 0d0a  urface_models:..
+00020520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020530: 7061 7468 732e 6170 7065 6e64 286d 2e70  paths.append(m.p
+00020540: 6174 6829 0d0a 2020 2020 2020 2020 2020  ath)..          
+00020550: 2020 2020 2020 6c65 7665 6c2e 6170 7065        level.appe
+00020560: 6e64 286d 2e6c 6576 656c 290d 0a20 2020  nd(m.level)..   
+00020570: 2020 2020 2020 2020 2020 2020 2063 6f6c               col
+00020580: 6f75 722e 6170 7065 6e64 286d 2e63 6f6c  our.append(m.col
+00020590: 6f75 7229 0d0a 2020 2020 2020 2020 2020  our)..          
+000205a0: 2020 2020 2020 6475 7374 2e61 7070 656e        dust.appen
+000205b0: 6428 6d2e 6475 7374 290d 0a20 2020 2020  d(m.dust)..     
+000205c0: 2020 2020 2020 2077 6974 6820 6f70 656e         with open
+000205d0: 286f 732e 7061 7468 2e6a 6f69 6e28 6366  (os.path.join(cf
+000205e0: 672e 726f 6f74 2c20 2263 6f72 6522 2c20  g.root, "core", 
+000205f0: 226f 7065 6e5f 696e 5f63 6869 6d65 7261  "open_in_chimera
+00020600: 782e 7079 2229 2c20 2272 2229 2061 7320  x.py"), "r") as 
+00020610: 663a 0d0a 2020 2020 2020 2020 2020 2020  f:..            
+00020620: 2020 2020 6c69 6e65 7320 3d20 662e 7265      lines = f.re
+00020630: 6164 6c69 6e65 7328 290d 0a0d 0a20 2020  adlines()....   
+00020640: 2020 2020 2020 2020 2023 2073 7570 6572           # super
+00020650: 2069 6e65 6666 6963 6965 6e74 2c20 6275   inefficient, bu
+00020660: 7420 6974 2077 6f72 6b73 202e 2e2e 0d0a  t it works .....
+00020670: 2020 2020 2020 2020 2020 2020 6c69 6e65              line
+00020680: 7320 3d20 5b66 2270 6174 6873 203d 207b  s = [f"paths = {
+00020690: 7061 7468 737d 5c6e 2220 6966 2022 7061  paths}\n" if "pa
+000206a0: 7468 7320 3d20 5b22 2069 6e20 6c69 6e65  ths = [" in line
+000206b0: 2065 6c73 6520 6c69 6e65 2066 6f72 206c   else line for l
+000206c0: 696e 6520 696e 206c 696e 6573 5d0d 0a20  ine in lines].. 
+000206d0: 2020 2020 2020 2020 2020 206c 696e 6573             lines
+000206e0: 203d 205b 6622 6c65 7665 6c20 3d20 7b6c   = [f"level = {l
+000206f0: 6576 656c 7d5c 6e22 2069 6620 226c 6576  evel}\n" if "lev
+00020700: 656c 203d 205b 2220 696e 206c 696e 6520  el = [" in line 
+00020710: 656c 7365 206c 696e 6520 666f 7220 6c69  else line for li
+00020720: 6e65 2069 6e20 6c69 6e65 735d 0d0a 2020  ne in lines]..  
+00020730: 2020 2020 2020 2020 2020 6c69 6e65 7320            lines 
+00020740: 3d20 5b66 2263 6f6c 6f75 7220 3d20 7b63  = [f"colour = {c
+00020750: 6f6c 6f75 727d 5c6e 2220 6966 2022 636f  olour}\n" if "co
+00020760: 6c6f 7572 203d 205b 2220 696e 206c 696e  lour = [" in lin
+00020770: 6520 656c 7365 206c 696e 6520 666f 7220  e else line for 
+00020780: 6c69 6e65 2069 6e20 6c69 6e65 735d 0d0a  line in lines]..
+00020790: 2020 2020 2020 2020 2020 2020 6c69 6e65              line
+000207a0: 7320 3d20 5b66 2264 7573 7420 3d20 7b64  s = [f"dust = {d
+000207b0: 7573 747d 5c6e 2220 6966 2022 6475 7374  ust}\n" if "dust
+000207c0: 203d 205b 2220 696e 206c 696e 6520 656c   = [" in line el
+000207d0: 7365 206c 696e 6520 666f 7220 6c69 6e65  se line for line
+000207e0: 2069 6e20 6c69 6e65 735d 0d0a 2020 2020   in lines]..    
+000207f0: 2020 2020 2020 2020 6c69 6e65 7320 3d20          lines = 
+00020800: 5b66 2262 6763 6c72 203d 207b 5365 676d  [f"bgclr = {Segm
+00020810: 656e 7461 7469 6f6e 4564 6974 6f72 2e52  entationEditor.R
+00020820: 454e 4445 525f 434c 4541 525f 434f 4c4f  ENDER_CLEAR_COLO
+00020830: 5552 7d5c 6e22 2069 6620 2262 6763 6c72  UR}\n" if "bgclr
+00020840: 203d 205b 2220 696e 206c 696e 6520 656c   = [" in line el
+00020850: 7365 206c 696e 6520 666f 7220 6c69 6e65  se line for line
+00020860: 2069 6e20 6c69 6e65 735d 0d0a 0d0a 2020   in lines]....  
+00020870: 2020 2020 2020 2020 2020 7769 7468 206f            with o
+00020880: 7065 6e28 6f73 2e70 6174 682e 6a6f 696e  pen(os.path.join
+00020890: 2863 6667 2e72 6f6f 742c 2022 636f 7265  (cfg.root, "core
+000208a0: 222c 2022 6f70 656e 5f69 6e5f 6368 696d  ", "open_in_chim
+000208b0: 6572 6178 2e70 7922 292c 2022 7722 2920  erax.py"), "w") 
+000208c0: 6173 2066 3a0d 0a20 2020 2020 2020 2020  as f:..         
+000208d0: 2020 2020 2020 2066 2e77 7269 7465 6c69         f.writeli
+000208e0: 6e65 7328 6c69 6e65 7329 0d0a 0d0a 2020  nes(lines)....  
+000208f0: 2020 2020 2020 2020 2020 7375 6270 726f            subpro
+00020900: 6365 7373 2e50 6f70 656e 285b 6366 672e  cess.Popen([cfg.
+00020910: 7365 7474 696e 6773 5b22 4348 494d 4552  settings["CHIMER
+00020920: 4158 5f45 5845 225d 2c20 6f73 2e70 6174  AX_EXE"], os.pat
+00020930: 682e 6a6f 696e 2863 6667 2e72 6f6f 742c  h.join(cfg.root,
+00020940: 2022 636f 7265 222c 2022 6f70 656e 5f69   "core", "open_i
+00020950: 6e5f 6368 696d 6572 6178 2e70 7922 295d  n_chimerax.py")]
+00020960: 290d 0a20 2020 2020 2020 2065 7863 6570  )..        excep
+00020970: 7420 4578 6365 7074 696f 6e20 6173 2065  t Exception as e
+00020980: 3a0d 0a20 2020 2020 2020 2020 2020 2063  :..            c
+00020990: 6667 2e73 6574 5f65 7272 6f72 2865 2c20  fg.set_error(e, 
+000209a0: 2243 6f75 6c64 206e 6f74 206f 7065 6e20  "Could not open 
+000209b0: 766f 6c75 6d65 7320 696e 2043 6869 6d65  volumes in Chime
+000209c0: 7261 5820 2d20 6973 2074 6865 2070 6174  raX - is the pat
+000209d0: 6820 746f 2074 6865 2043 6869 6d65 7261  h to the Chimera
+000209e0: 5820 6578 6563 7574 6162 6c65 2073 6574  X executable set
+000209f0: 2069 6e20 7365 7474 696e 6773 2e74 7874   in settings.txt
+00020a00: 3f22 290d 0a0d 0a20 2020 2064 6566 2063  ?")....    def c
+00020a10: 616d 6572 615f 636f 6e74 726f 6c28 7365  amera_control(se
+00020a20: 6c66 293a 0d0a 2020 2020 2020 2020 6966  lf):..        if
+00020a30: 2069 6d67 7569 2e67 6574 5f69 6f28 292e   imgui.get_io().
+00020a40: 7761 6e74 5f63 6170 7475 7265 5f6d 6f75  want_capture_mou
+00020a50: 7365 206f 7220 696d 6775 692e 6765 745f  se or imgui.get_
+00020a60: 696f 2829 2e77 616e 745f 6361 7074 7572  io().want_captur
+00020a70: 655f 6b65 7962 6f61 7264 3a0d 0a20 2020  e_keyboard:..   
+00020a80: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00020a90: 4e6f 6e65 0d0a 2020 2020 2020 2020 6966  None..        if
+00020aa0: 2073 656c 662e 6163 7469 7665 5f74 6162   self.active_tab
+00020ab0: 2021 3d20 2252 656e 6465 7222 3a0d 0a20   != "Render":.. 
+00020ac0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+00020ad0: 6c66 2e77 696e 646f 772e 6765 745f 6d6f  lf.window.get_mo
+00020ae0: 7573 655f 6275 7474 6f6e 2867 6c66 772e  use_button(glfw.
+00020af0: 4d4f 5553 455f 4255 5454 4f4e 5f4d 4944  MOUSE_BUTTON_MID
+00020b00: 444c 4529 3a0d 0a20 2020 2020 2020 2020  DLE):..         
+00020b10: 2020 2020 2020 2064 656c 7461 5f63 7572         delta_cur
+00020b20: 736f 7220 3d20 7365 6c66 2e77 696e 646f  sor = self.windo
+00020b30: 772e 6375 7273 6f72 5f64 656c 7461 0d0a  w.cursor_delta..
+00020b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020b50: 7365 6c66 2e63 616d 6572 612e 706f 7369  self.camera.posi
+00020b60: 7469 6f6e 5b30 5d20 2b3d 2064 656c 7461  tion[0] += delta
+00020b70: 5f63 7572 736f 725b 305d 202f 2073 656c  _cursor[0] / sel
+00020b80: 662e 6361 6d65 7261 2e7a 6f6f 6d0d 0a20  f.camera.zoom.. 
+00020b90: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00020ba0: 656c 662e 6361 6d65 7261 2e70 6f73 6974  elf.camera.posit
+00020bb0: 696f 6e5b 315d 202d 3d20 6465 6c74 615f  ion[1] -= delta_
+00020bc0: 6375 7273 6f72 5b31 5d20 2f20 7365 6c66  cursor[1] / self
+00020bd0: 2e63 616d 6572 612e 7a6f 6f6d 0d0a 2020  .camera.zoom..  
+00020be0: 2020 2020 2020 2020 2020 6966 2053 6567            if Seg
+00020bf0: 6d65 6e74 6174 696f 6e45 6469 746f 722e  mentationEditor.
+00020c00: 6973 5f73 6869 6674 5f64 6f77 6e28 293a  is_shift_down():
+00020c10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00020c20: 2020 7365 6c66 2e63 616d 6572 612e 7a6f    self.camera.zo
+00020c30: 6f6d 202a 3d20 2831 2e30 202b 2073 656c  om *= (1.0 + sel
+00020c40: 662e 7769 6e64 6f77 2e73 6372 6f6c 6c5f  f.window.scroll_
+00020c50: 6465 6c74 615b 315d 202a 2053 6567 6d65  delta[1] * Segme
+00020c60: 6e74 6174 696f 6e45 6469 746f 722e 4341  ntationEditor.CA
+00020c70: 4d45 5241 5f5a 4f4f 4d5f 5354 4550 290d  MERA_ZOOM_STEP).
+00020c80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00020c90: 2073 656c 662e 6361 6d65 7261 2e7a 6f6f   self.camera.zoo
+00020ca0: 6d20 3d20 6d69 6e28 5b73 656c 662e 6361  m = min([self.ca
+00020cb0: 6d65 7261 2e7a 6f6f 6d2c 2053 6567 6d65  mera.zoom, Segme
+00020cc0: 6e74 6174 696f 6e45 6469 746f 722e 4341  ntationEditor.CA
+00020cd0: 4d45 5241 5f4d 4158 5f5a 4f4f 4d5d 290d  MERA_MAX_ZOOM]).
+00020ce0: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
+00020cf0: 2020 2020 2020 2020 2020 2020 6966 2053              if S
+00020d00: 6567 6d65 6e74 6174 696f 6e45 6469 746f  egmentationEdito
+00020d10: 722e 6973 5f73 6869 6674 5f64 6f77 6e28  r.is_shift_down(
+00020d20: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+00020d30: 2020 2020 6966 2073 656c 662e 7769 6e64      if self.wind
+00020d40: 6f77 2e67 6574 5f6d 6f75 7365 5f62 7574  ow.get_mouse_but
+00020d50: 746f 6e28 676c 6677 2e4d 4f55 5345 5f42  ton(glfw.MOUSE_B
+00020d60: 5554 544f 4e5f 4d49 4444 4c45 293a 0d0a  UTTON_MIDDLE):..
+00020d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020d80: 2020 2020 7365 6c66 2e63 616d 6572 6133      self.camera3
+00020d90: 642e 7069 7463 6820 2b3d 2073 656c 662e  d.pitch += self.
+00020da0: 7769 6e64 6f77 2e63 7572 736f 725f 6465  window.cursor_de
+00020db0: 6c74 615b 315d 202a 2053 6567 6d65 6e74  lta[1] * Segment
+00020dc0: 6174 696f 6e45 6469 746f 722e 5649 4557  ationEditor.VIEW
+00020dd0: 5f33 445f 5049 564f 545f 5350 4545 440d  _3D_PIVOT_SPEED.
+00020de0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00020df0: 2020 2020 2073 656c 662e 6361 6d65 7261       self.camera
+00020e00: 3364 2e79 6177 202b 3d20 7365 6c66 2e77  3d.yaw += self.w
+00020e10: 696e 646f 772e 6375 7273 6f72 5f64 656c  indow.cursor_del
+00020e20: 7461 5b30 5d20 2a20 5365 676d 656e 7461  ta[0] * Segmenta
+00020e30: 7469 6f6e 4564 6974 6f72 2e56 4945 575f  tionEditor.VIEW_
+00020e40: 3344 5f50 4956 4f54 5f53 5045 4544 0d0a  3D_PIVOT_SPEED..
+00020e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020e60: 2020 2020 7365 6c66 2e63 616d 6572 6133      self.camera3
+00020e70: 642e 7069 7463 6820 3d20 636c 616d 7028  d.pitch = clamp(
+00020e80: 7365 6c66 2e63 616d 6572 6133 642e 7069  self.camera3d.pi
+00020e90: 7463 682c 202d 3839 2e39 2c20 3839 2e39  tch, -89.9, 89.9
+00020ea0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00020eb0: 2020 2020 2020 2069 6620 7365 6c66 2e77         if self.w
+00020ec0: 696e 646f 772e 6375 7273 6f72 5f64 656c  indow.cursor_del
+00020ed0: 7461 5b30 5d20 213d 2030 206f 7220 7365  ta[0] != 0 or se
+00020ee0: 6c66 2e77 696e 646f 772e 6375 7273 6f72  lf.window.cursor
+00020ef0: 5f64 656c 7461 5b31 5d20 213d 2030 3a0d  _delta[1] != 0:.
+00020f00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00020f10: 2020 2020 2020 2020 2053 6567 6d65 6e74           Segment
+00020f20: 6174 696f 6e45 6469 746f 722e 5649 4557  ationEditor.VIEW
+00020f30: 5f52 4551 5549 5245 535f 5550 4441 5445  _REQUIRES_UPDATE
+00020f40: 203d 2054 7275 650d 0a20 2020 2020 2020   = True..       
+00020f50: 2020 2020 2020 2020 2073 656c 662e 6361           self.ca
+00020f60: 6d65 7261 3364 2e64 6973 7461 6e63 6520  mera3d.distance 
+00020f70: 2d3d 2073 656c 662e 7769 6e64 6f77 2e73  -= self.window.s
+00020f80: 6372 6f6c 6c5f 6465 6c74 615b 315d 202a  croll_delta[1] *
+00020f90: 2053 6567 6d65 6e74 6174 696f 6e45 6469   SegmentationEdi
+00020fa0: 746f 722e 5649 4557 5f33 445f 4d4f 5645  tor.VIEW_3D_MOVE
+00020fb0: 5f53 5045 4544 0d0a 2020 2020 2020 2020  _SPEED..        
+00020fc0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00020fd0: 7769 6e64 6f77 2e73 6372 6f6c 6c5f 6465  window.scroll_de
+00020fe0: 6c74 615b 315d 2021 3d20 303a 0d0a 2020  lta[1] != 0:..  
+00020ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021000: 2020 5365 676d 656e 7461 7469 6f6e 4564    SegmentationEd
+00021010: 6974 6f72 2e56 4945 575f 5245 5155 4952  itor.VIEW_REQUIR
+00021020: 4553 5f55 5044 4154 4520 3d20 5472 7565  ES_UPDATE = True
+00021030: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00021040: 2020 7365 6c66 2e63 616d 6572 6133 642e    self.camera3d.
+00021050: 6469 7374 616e 6365 203d 206d 6178 2831  distance = max(1
+00021060: 302e 302c 2073 656c 662e 6361 6d65 7261  0.0, self.camera
+00021070: 3364 2e64 6973 7461 6e63 6529 0d0a 2020  3d.distance)..  
+00021080: 2020 2020 2020 2020 2020 656c 6966 2073            elif s
+00021090: 656c 662e 7769 6e64 6f77 2e67 6574 5f6d  elf.window.get_m
+000210a0: 6f75 7365 5f62 7574 746f 6e28 676c 6677  ouse_button(glfw
+000210b0: 2e4d 4f55 5345 5f42 5554 544f 4e5f 4d49  .MOUSE_BUTTON_MI
+000210c0: 4444 4c45 293a 0d0a 2020 2020 2020 2020  DDLE):..        
+000210d0: 2020 2020 2020 2020 6478 203d 202d 7365          dx = -se
+000210e0: 6c66 2e77 696e 646f 772e 6375 7273 6f72  lf.window.cursor
+000210f0: 5f64 656c 7461 5b30 5d0d 0a20 2020 2020  _delta[0]..     
+00021100: 2020 2020 2020 2020 2020 2064 7920 3d20             dy = 
+00021110: 2d73 656c 662e 7769 6e64 6f77 2e63 7572  -self.window.cur
+00021120: 736f 725f 6465 6c74 615b 315d 0d0a 2020  sor_delta[1]..  
+00021130: 2020 2020 2020 2020 2020 2020 2020 776f                wo
+00021140: 726c 645f 6465 6c74 6120 3d20 7365 6c66  rld_delta = self
+00021150: 2e63 616d 6572 6133 642e 6375 7273 6f72  .camera3d.cursor
+00021160: 5f64 656c 7461 5f74 6f5f 776f 726c 645f  _delta_to_world_
+00021170: 6465 6c74 6128 2864 782c 2064 7929 290d  delta((dx, dy)).
+00021180: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00021190: 2073 656c 662e 6361 6d65 7261 3364 2e66   self.camera3d.f
+000211a0: 6f63 7573 5b30 5d20 2b3d 2077 6f72 6c64  ocus[0] += world
+000211b0: 5f64 656c 7461 5b30 5d0d 0a20 2020 2020  _delta[0]..     
+000211c0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000211d0: 6361 6d65 7261 3364 2e66 6f63 7573 5b31  camera3d.focus[1
+000211e0: 5d20 2b3d 2077 6f72 6c64 5f64 656c 7461  ] += world_delta
+000211f0: 5b31 5d0d 0a20 2020 2020 2020 2020 2020  [1]..           
+00021200: 2020 2020 2073 656c 662e 6361 6d65 7261       self.camera
+00021210: 3364 2e66 6f63 7573 5b32 5d20 2b3d 2077  3d.focus[2] += w
+00021220: 6f72 6c64 5f64 656c 7461 5b32 5d0d 0a20  orld_delta[2].. 
+00021230: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00021240: 6620 6478 2021 3d20 3020 6f72 2064 7920  f dx != 0 or dy 
+00021250: 213d 2030 3a0d 0a20 2020 2020 2020 2020  != 0:..         
+00021260: 2020 2020 2020 2020 2020 2053 6567 6d65             Segme
+00021270: 6e74 6174 696f 6e45 6469 746f 722e 5649  ntationEditor.VI
+00021280: 4557 5f52 4551 5549 5245 535f 5550 4441  EW_REQUIRES_UPDA
+00021290: 5445 203d 2054 7275 650d 0a0d 0a20 2020  TE = True....   
+000212a0: 2064 6566 2065 6e64 5f66 7261 6d65 2873   def end_frame(s
+000212b0: 656c 6629 3a0d 0a20 2020 2020 2020 2073  elf):..        s
+000212c0: 656c 662e 7769 6e64 6f77 2e65 6e64 5f66  elf.window.end_f
+000212d0: 7261 6d65 2829 0d0a 0d0a 2020 2020 4073  rame()....    @s
+000212e0: 7461 7469 636d 6574 686f 640d 0a20 2020  taticmethod..   
+000212f0: 2064 6566 2073 6574 5f6c 6f67 5f70 6174   def set_log_pat
+00021300: 6828 7061 7468 293a 0d0a 2020 2020 2020  h(path):..      
+00021310: 2020 6366 672e 6c6f 675f 7061 7468 203d    cfg.log_path =
+00021320: 2070 6174 680d 0a20 2020 2020 2020 2063   path..        c
+00021330: 6667 2e73 7461 7274 5f6c 6f67 2829 0d0a  fg.start_log()..
+00021340: 0d0a 2020 2020 4073 7461 7469 636d 6574  ..    @staticmet
+00021350: 686f 640d 0a20 2020 2064 6566 2066 6f72  hod..    def for
+00021360: 6365 5f6e 6f74 5f65 6d62 6564 6465 6428  ce_not_embedded(
+00021370: 293a 0d0a 2020 2020 2020 2020 676c 6f62  ):..        glob
+00021380: 616c 2045 4d42 4544 4445 440d 0a20 2020  al EMBEDDED..   
+00021390: 2020 2020 2045 4d42 4544 4445 4420 3d20       EMBEDDED = 
+000213a0: 4661 6c73 650d 0a0d 0a0d 0a20 2020 2040  False......    @
+000213b0: 7374 6174 6963 6d65 7468 6f64 0d0a 2020  staticmethod..  
+000213c0: 2020 6465 6620 6973 5f73 6869 6674 5f64    def is_shift_d
+000213d0: 6f77 6e28 293a 0d0a 2020 2020 2020 2020  own():..        
+000213e0: 7265 7475 726e 2069 6d67 7569 2e69 735f  return imgui.is_
+000213f0: 6b65 795f 646f 776e 2867 6c66 772e 4b45  key_down(glfw.KE
+00021400: 595f 4c45 4654 5f53 4849 4654 2920 6f72  Y_LEFT_SHIFT) or
+00021410: 2069 6d67 7569 2e69 735f 6b65 795f 646f   imgui.is_key_do
+00021420: 776e 2867 6c66 772e 4b45 595f 5249 4748  wn(glfw.KEY_RIGH
+00021430: 545f 5348 4946 5429 0d0a 0d0a 2020 2020  T_SHIFT)....    
+00021440: 4073 7461 7469 636d 6574 686f 640d 0a20  @staticmethod.. 
+00021450: 2020 2064 6566 2069 735f 6374 726c 5f64     def is_ctrl_d
+00021460: 6f77 6e28 293a 0d0a 2020 2020 2020 2020  own():..        
+00021470: 7265 7475 726e 2069 6d67 7569 2e69 735f  return imgui.is_
+00021480: 6b65 795f 646f 776e 2867 6c66 772e 4b45  key_down(glfw.KE
+00021490: 595f 4c45 4654 5f43 4f4e 5452 4f4c 2920  Y_LEFT_CONTROL) 
+000214a0: 6f72 2069 6d67 7569 2e69 735f 6b65 795f  or imgui.is_key_
+000214b0: 646f 776e 2867 6c66 772e 4b45 595f 5249  down(glfw.KEY_RI
+000214c0: 4748 545f 434f 4e54 524f 4c29 0d0a 0d0a  GHT_CONTROL)....
+000214d0: 0d0a 636c 6173 7320 4272 7573 683a 0d0a  ..class Brush:..
+000214e0: 2020 2020 6369 7263 756c 6172 5f72 6f69      circular_roi
+000214f0: 203d 206e 702e 7a65 726f 7328 312c 2064   = np.zeros(1, d
+00021500: 7479 7065 3d6e 702e 7569 6e74 3829 0d0a  type=np.uint8)..
+00021510: 2020 2020 6369 7263 756c 6172 5f72 6f69      circular_roi
+00021520: 5f72 6164 6975 7320 3d20 2d31 0d0a 2020  _radius = -1..  
+00021530: 2020 6d61 6769 635f 726f 6920 3d20 6e70    magic_roi = np
+00021540: 2e7a 6572 6f73 2831 2c20 6474 7970 653d  .zeros(1, dtype=
+00021550: 6e70 2e75 696e 7438 290d 0a20 2020 206d  np.uint8)..    m
+00021560: 6167 6963 5f72 6f69 5f72 6164 6975 7320  agic_roi_radius 
+00021570: 3d20 2d31 0d0a 0d0a 2020 2020 4073 7461  = -1....    @sta
+00021580: 7469 636d 6574 686f 640d 0a20 2020 2064  ticmethod..    d
+00021590: 6566 2073 6574 5f63 6972 6375 6c61 725f  ef set_circular_
+000215a0: 726f 695f 7261 6469 7573 2872 6164 6975  roi_radius(radiu
+000215b0: 7329 3a0d 0a20 2020 2020 2020 2069 6620  s):..        if 
+000215c0: 4272 7573 682e 6369 7263 756c 6172 5f72  Brush.circular_r
+000215d0: 6f69 5f72 6164 6975 7320 3d3d 2072 6164  oi_radius == rad
+000215e0: 6975 733a 0d0a 2020 2020 2020 2020 2020  ius:..          
+000215f0: 2020 7265 7475 726e 0d0a 2020 2020 2020    return..      
+00021600: 2020 4272 7573 682e 6369 7263 756c 6172    Brush.circular
+00021610: 5f72 6f69 5f72 6164 6975 7320 3d20 7261  _roi_radius = ra
+00021620: 6469 7573 0d0a 2020 2020 2020 2020 4272  dius..        Br
+00021630: 7573 682e 6369 7263 756c 6172 5f72 6f69  ush.circular_roi
+00021640: 203d 206e 702e 7a65 726f 7328 2832 2a72   = np.zeros((2*r
+00021650: 6164 6975 732b 312c 2032 2a72 6164 6975  adius+1, 2*radiu
+00021660: 732b 3129 2c20 6474 7970 653d 6e70 2e75  s+1), dtype=np.u
+00021670: 696e 7438 290d 0a20 2020 2020 2020 2072  int8)..        r
+00021680: 203d 2072 6164 6975 732a 2a32 0d0a 2020   = radius**2..  
+00021690: 2020 2020 2020 666f 7220 7820 696e 2072        for x in r
+000216a0: 616e 6765 2830 2c20 322a 7261 6469 7573  ange(0, 2*radius
+000216b0: 2b31 293a 0d0a 2020 2020 2020 2020 2020  +1):..          
+000216c0: 2020 666f 7220 7920 696e 2072 616e 6765    for y in range
+000216d0: 2830 2c20 322a 7261 6469 7573 2b31 293a  (0, 2*radius+1):
+000216e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000216f0: 2020 6966 2028 2878 2d72 6164 6975 7329    if ((x-radius)
+00021700: 2a2a 3220 2b20 2879 2d72 6164 6975 7329  **2 + (y-radius)
+00021710: 2a2a 3229 203c 2072 3a0d 0a20 2020 2020  **2) < r:..     
+00021720: 2020 2020 2020 2020 2020 2020 2020 2042                 B
+00021730: 7275 7368 2e63 6972 6375 6c61 725f 726f  rush.circular_ro
+00021740: 695b 782c 2079 5d20 3d20 5472 7565 0d0a  i[x, y] = True..
+00021750: 0d0a 2020 2020 4073 7461 7469 636d 6574  ..    @staticmet
+00021760: 686f 640d 0a20 2020 2064 6566 2073 6574  hod..    def set
+00021770: 5f6d 6167 6963 5f72 6f69 5f72 6164 6975  _magic_roi_radiu
+00021780: 7328 7261 6469 7573 293a 0d0a 2020 2020  s(radius):..    
+00021790: 2020 2020 6966 2042 7275 7368 2e6d 6167      if Brush.mag
+000217a0: 6963 5f72 6f69 5f72 6164 6975 7320 3d3d  ic_roi_radius ==
+000217b0: 2072 6164 6975 733a 0d0a 2020 2020 2020   radius:..      
+000217c0: 2020 2020 2020 7265 7475 726e 0d0a 2020        return..  
+000217d0: 2020 2020 2020 4272 7573 682e 6d61 6769        Brush.magi
+000217e0: 635f 726f 695f 7261 6469 7573 203d 2072  c_roi_radius = r
+000217f0: 6164 6975 730d 0a20 2020 2020 2020 2042  adius..        B
+00021800: 7275 7368 2e6d 6167 6963 5f72 6f69 203d  rush.magic_roi =
+00021810: 206e 702e 7a65 726f 7328 2832 202a 2072   np.zeros((2 * r
+00021820: 6164 6975 7320 2b20 312c 2032 202a 2072  adius + 1, 2 * r
+00021830: 6164 6975 7320 2b20 3129 2c20 6474 7970  adius + 1), dtyp
+00021840: 653d 6e70 2e75 696e 7438 290d 0a20 2020  e=np.uint8)..   
+00021850: 2020 2020 2072 203d 2072 6164 6975 7320       r = radius 
+00021860: 2a2a 2032 0d0a 2020 2020 2020 2020 666f  ** 2..        fo
+00021870: 7220 7820 696e 2072 616e 6765 2830 2c20  r x in range(0, 
+00021880: 3220 2a20 7261 6469 7573 202b 2031 293a  2 * radius + 1):
+00021890: 0d0a 2020 2020 2020 2020 2020 2020 666f  ..            fo
+000218a0: 7220 7920 696e 2072 616e 6765 2830 2c20  r y in range(0, 
+000218b0: 3220 2a20 7261 6469 7573 202b 2031 293a  2 * radius + 1):
+000218c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000218d0: 2020 6966 2028 2878 202d 2072 6164 6975    if ((x - radiu
+000218e0: 7329 202a 2a20 3220 2b20 2879 202d 2072  s) ** 2 + (y - r
+000218f0: 6164 6975 7329 202a 2a20 3229 203c 2072  adius) ** 2) < r
+00021900: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00021910: 2020 2020 2020 2042 7275 7368 2e6d 6167         Brush.mag
+00021920: 6963 5f72 6f69 5b78 2c20 795d 203d 2054  ic_roi[x, y] = T
+00021930: 7275 650d 0a0d 0a20 2020 2040 7374 6174  rue....    @stat
+00021940: 6963 6d65 7468 6f64 0d0a 2020 2020 6465  icmethod..    de
+00021950: 6620 6170 706c 795f 6369 7263 756c 6172  f apply_circular
+00021960: 2873 6567 6d65 6e74 6174 696f 6e2c 2063  (segmentation, c
 00021970: 656e 7465 725f 636f 6f72 6469 6e61 7465  enter_coordinate
-00021980: 735b 315d 2c20 6365 6e74 6572 5f63 6f6f  s[1], center_coo
-00021990: 7264 696e 6174 6573 5b30 5d0d 0a20 2020  rdinates[0]..   
-000219a0: 2020 2020 2042 7275 7368 2e73 6574 5f6d       Brush.set_m
-000219b0: 6167 6963 5f72 6f69 5f72 6164 6975 7328  agic_roi_radius(
-000219c0: 7229 0d0a 0d0a 2020 2020 2020 2020 2320  r)....        # 
-000219d0: 7365 7420 7570 2074 6865 2052 4f49 2063  set up the ROI c
-000219e0: 6f6f 7264 696e 6174 6573 2061 6e64 2069  oordinates and i
-000219f0: 6d61 6765 2063 6f6f 7264 696e 6174 6573  mage coordinates
-00021a00: 206f 6620 7468 6520 7265 6769 6f6e 2074   of the region t
-00021a10: 6f20 7361 6d70 6c65 2066 726f 6d0d 0a20  o sample from.. 
-00021a20: 2020 2020 2020 2078 2c20 7920 3d20 6365         x, y = ce
-00021a30: 6e74 6572 5f63 6f6f 7264 696e 6174 6573  nter_coordinates
-00021a40: 5b30 5d2c 2063 656e 7465 725f 636f 6f72  [0], center_coor
-00021a50: 6469 6e61 7465 735b 315d 0d0a 2020 2020  dinates[1]..    
-00021a60: 2020 2020 6966 2078 203e 2073 6567 6d65      if x > segme
-00021a70: 6e74 6174 696f 6e2e 6865 6967 6874 206f  ntation.height o
-00021a80: 7220 7820 3c20 3020 6f72 2079 203e 2073  r x < 0 or y > s
-00021a90: 6567 6d65 6e74 6174 696f 6e2e 7769 6474  egmentation.widt
-00021aa0: 6820 6f72 2079 203c 2030 3a0d 0a20 2020  h or y < 0:..   
-00021ab0: 2020 2020 2020 2020 2072 6574 7572 6e0d           return.
-00021ac0: 0a0d 0a0d 0a20 2020 2020 2020 206d 7520  .....        mu 
-00021ad0: 3d20 696d 6167 655b 782c 2079 5d0d 0a20  = image[x, y].. 
-00021ae0: 2020 2020 2020 2076 616c 7565 5f72 616e         value_ran
-00021af0: 6765 203d 205b 6d75 202a 2028 312e 3020  ge = [mu * (1.0 
-00021b00: 2d20 2831 3030 2e30 202d 2028 3530 202b  - (100.0 - (50 +
-00021b10: 2030 2e35 202a 2073 6567 6d65 6e74 6174   0.5 * segmentat
-00021b20: 696f 6e2e 6d61 6769 635f 7374 7265 6e67  ion.magic_streng
-00021b30: 7468 2929 202f 2031 3030 2e30 292c 206d  th)) / 100.0), m
-00021b40: 7520 2a20 2831 2e30 202b 2028 3130 302e  u * (1.0 + (100.
-00021b50: 3020 2d20 2835 3020 2b20 302e 3520 2a20  0 - (50 + 0.5 * 
-00021b60: 7365 676d 656e 7461 7469 6f6e 2e6d 6167  segmentation.mag
-00021b70: 6963 5f73 7472 656e 6774 6829 2920 2f20  ic_strength)) / 
-00021b80: 3130 302e 3029 5d0d 0a20 2020 2020 2020  100.0)]..       
-00021b90: 2069 6620 7661 6c75 655f 7261 6e67 655b   if value_range[
-00021ba0: 305d 203e 2076 616c 7565 5f72 616e 6765  0] > value_range
-00021bb0: 5b31 5d3a 0d0a 2020 2020 2020 2020 2020  [1]:..          
-00021bc0: 2020 7661 6c75 655f 7261 6e67 655b 305d    value_range[0]
-00021bd0: 2c20 7661 6c75 655f 7261 6e67 655b 315d  , value_range[1]
-00021be0: 203d 2076 616c 7565 5f72 616e 6765 5b31   = value_range[1
-00021bf0: 5d2c 2076 616c 7565 5f72 616e 6765 5b30  ], value_range[0
-00021c00: 5d0d 0a20 2020 2020 2020 2023 2073 6574  ]..        # set
-00021c10: 2075 7020 7468 6520 524f 4920 636f 6f72   up the ROI coor
-00021c20: 6469 6e61 7465 7320 616e 6420 696d 6167  dinates and imag
-00021c30: 6520 636f 6f72 6469 6e61 7465 7320 6f66  e coordinates of
-00021c40: 2074 6865 2072 6567 696f 6e20 746f 2064   the region to d
-00021c50: 7261 7720 696e 0d0a 2020 2020 2020 2020  raw in..        
-00021c60: 7220 3d20 720d 0a20 2020 2020 2020 2078  r = r..        x
-00021c70: 203d 205b 6365 6e74 6572 5f63 6f6f 7264   = [center_coord
-00021c80: 696e 6174 6573 5b30 5d20 2d20 722c 2063  inates[0] - r, c
-00021c90: 656e 7465 725f 636f 6f72 6469 6e61 7465  enter_coordinate
-00021ca0: 735b 305d 202b 2072 202b 2031 5d0d 0a20  s[0] + r + 1].. 
-00021cb0: 2020 2020 2020 2079 203d 205b 6365 6e74         y = [cent
-00021cc0: 6572 5f63 6f6f 7264 696e 6174 6573 5b31  er_coordinates[1
-00021cd0: 5d20 2d20 722c 2063 656e 7465 725f 636f  ] - r, center_co
-00021ce0: 6f72 6469 6e61 7465 735b 315d 202b 2072  ordinates[1] + r
-00021cf0: 202b 2031 5d0d 0a20 2020 2020 2020 2072   + 1]..        r
-00021d00: 7820 3d20 5b30 2c20 3220 2a20 7220 2b20  x = [0, 2 * r + 
-00021d10: 315d 0d0a 2020 2020 2020 2020 7279 203d  1]..        ry =
-00021d20: 205b 302c 2032 202a 2072 202b 2031 5d0d   [0, 2 * r + 1].
-00021d30: 0a0d 0a20 2020 2020 2020 2069 6620 785b  ...        if x[
-00021d40: 305d 203e 2073 6567 6d65 6e74 6174 696f  0] > segmentatio
-00021d50: 6e2e 6865 6967 6874 206f 7220 785b 315d  n.height or x[1]
-00021d60: 203c 2030 206f 7220 795b 305d 203e 2073   < 0 or y[0] > s
-00021d70: 6567 6d65 6e74 6174 696f 6e2e 7769 6474  egmentation.widt
-00021d80: 6820 6f72 2079 5b31 5d20 3c20 303a 0d0a  h or y[1] < 0:..
-00021d90: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00021da0: 726e 0d0a 2020 2020 2020 2020 6966 2078  rn..        if x
-00021db0: 5b30 5d20 3c20 303a 0d0a 2020 2020 2020  [0] < 0:..      
-00021dc0: 2020 2020 2020 7278 5b30 5d20 2d3d 2078        rx[0] -= x
-00021dd0: 5b30 5d0d 0a20 2020 2020 2020 2020 2020  [0]..           
-00021de0: 2078 5b30 5d20 3d20 300d 0a20 2020 2020   x[0] = 0..     
-00021df0: 2020 2069 6620 795b 305d 203c 2030 3a0d     if y[0] < 0:.
-00021e00: 0a20 2020 2020 2020 2020 2020 2072 795b  .            ry[
-00021e10: 305d 202d 3d20 795b 305d 0d0a 2020 2020  0] -= y[0]..    
-00021e20: 2020 2020 2020 2020 795b 305d 203d 2030          y[0] = 0
-00021e30: 0d0a 2020 2020 2020 2020 6966 2078 5b31  ..        if x[1
-00021e40: 5d20 3e20 7365 676d 656e 7461 7469 6f6e  ] > segmentation
-00021e50: 2e68 6569 6768 743a 0d0a 2020 2020 2020  .height:..      
-00021e60: 2020 2020 2020 7278 5b31 5d20 2d3d 2028        rx[1] -= (
-00021e70: 785b 315d 202d 2073 6567 6d65 6e74 6174  x[1] - segmentat
-00021e80: 696f 6e2e 6865 6967 6874 290d 0a20 2020  ion.height)..   
-00021e90: 2020 2020 2020 2020 2078 5b31 5d20 3d20           x[1] = 
-00021ea0: 7365 676d 656e 7461 7469 6f6e 2e68 6569  segmentation.hei
-00021eb0: 6768 740d 0a20 2020 2020 2020 2069 6620  ght..        if 
-00021ec0: 795b 315d 203e 2073 6567 6d65 6e74 6174  y[1] > segmentat
-00021ed0: 696f 6e2e 7769 6474 683a 0d0a 2020 2020  ion.width:..    
-00021ee0: 2020 2020 2020 2020 7279 5b31 5d20 2d3d          ry[1] -=
-00021ef0: 2028 795b 315d 202d 2073 6567 6d65 6e74   (y[1] - segment
-00021f00: 6174 696f 6e2e 7769 6474 6829 0d0a 2020  ation.width)..  
-00021f10: 2020 2020 2020 2020 2020 795b 315d 203d            y[1] =
-00021f20: 2073 6567 6d65 6e74 6174 696f 6e2e 7769   segmentation.wi
-00021f30: 6474 680d 0a0d 0a20 2020 2020 2020 2063  dth....        c
-00021f40: 6f6e 7469 6775 6f75 735f 6d61 736b 203d  ontiguous_mask =
-00021f50: 206e 702e 7a65 726f 7328 2872 785b 315d   np.zeros((rx[1]
-00021f60: 2d72 785b 305d 2c20 7279 5b31 5d2d 7279  -rx[0], ry[1]-ry
-00021f70: 5b30 5d29 2c20 6474 7970 653d 6e70 2e75  [0]), dtype=np.u
-00021f80: 696e 7438 290d 0a20 2020 2020 2020 2066  int8)..        f
-00021f90: 6f72 205f 782c 205f 7278 2069 6e20 7a69  or _x, _rx in zi
-00021fa0: 7028 7261 6e67 6528 785b 305d 2c20 785b  p(range(x[0], x[
-00021fb0: 315d 292c 2072 616e 6765 2872 785b 305d  1]), range(rx[0]
-00021fc0: 2c20 7278 5b31 5d29 293a 0d0a 2020 2020  , rx[1])):..    
-00021fd0: 2020 2020 2020 2020 666f 7220 5f79 2c20          for _y, 
-00021fe0: 5f72 7920 696e 207a 6970 2872 616e 6765  _ry in zip(range
-00021ff0: 2879 5b30 5d2c 2079 5b31 5d29 2c20 7261  (y[0], y[1]), ra
-00022000: 6e67 6528 7279 5b30 5d2c 2072 795b 315d  nge(ry[0], ry[1]
-00022010: 2929 3a0d 0a20 2020 2020 2020 2020 2020  )):..           
-00022020: 2020 2020 2069 6620 4272 7573 682e 6d61       if Brush.ma
-00022030: 6769 635f 726f 695b 5f72 782c 205f 7279  gic_roi[_rx, _ry
-00022040: 5d20 616e 6420 7661 6c75 655f 7261 6e67  ] and value_rang
-00022050: 655b 305d 203c 2069 6d61 6765 5b5f 782c  e[0] < image[_x,
-00022060: 205f 795d 203c 2076 616c 7565 5f72 616e   _y] < value_ran
-00022070: 6765 5b31 5d3a 0d0a 2020 2020 2020 2020  ge[1]:..        
-00022080: 2020 2020 2020 2020 2020 2020 636f 6e74              cont
-00022090: 6967 756f 7573 5f6d 6173 6b5b 5f72 782c  iguous_mask[_rx,
-000220a0: 205f 7279 5d20 3d20 310d 0a0d 0a20 2020   _ry] = 1....   
-000220b0: 2020 2020 2073 7461 636b 203d 205b 2872       stack = [(r
-000220c0: 202d 2072 785b 305d 2c20 7220 2d20 7279   - rx[0], r - ry
-000220d0: 5b30 5d29 5d0d 0a20 2020 2020 2020 2077  [0])]..        w
-000220e0: 2c20 6820 3d20 2872 785b 315d 202d 2072  , h = (rx[1] - r
-000220f0: 785b 305d 2c20 7279 5b31 5d20 2d20 7279  x[0], ry[1] - ry
-00022100: 5b30 5d29 0d0a 2020 2020 2020 2020 7768  [0])..        wh
-00022110: 696c 6520 7374 6163 6b3a 0d0a 2020 2020  ile stack:..    
-00022120: 2020 2020 2020 2020 6d78 2c20 6d79 203d          mx, my =
-00022130: 2073 7461 636b 2e70 6f70 2829 0d0a 2020   stack.pop()..  
-00022140: 2020 2020 2020 2020 2020 6966 2063 6f6e            if con
-00022150: 7469 6775 6f75 735f 6d61 736b 5b6d 782c  tiguous_mask[mx,
-00022160: 206d 795d 203d 3d20 313a 0d0a 2020 2020   my] == 1:..    
-00022170: 2020 2020 2020 2020 2020 2020 636f 6e74              cont
-00022180: 6967 756f 7573 5f6d 6173 6b5b 6d78 2c20  iguous_mask[mx, 
-00022190: 6d79 5d20 3d20 320d 0a20 2020 2020 2020  my] = 2..       
-000221a0: 2020 2020 2020 2020 2069 6620 6d78 202b           if mx +
-000221b0: 2031 203c 2077 3a0d 0a20 2020 2020 2020   1 < w:..       
-000221c0: 2020 2020 2020 2020 2020 2020 2073 7461               sta
-000221d0: 636b 2e61 7070 656e 6428 286d 7820 2b20  ck.append((mx + 
-000221e0: 312c 206d 7929 290d 0a20 2020 2020 2020  1, my))..       
-000221f0: 2020 2020 2020 2020 2069 6620 6d78 202d           if mx -
-00022200: 2031 203e 3d20 303a 0d0a 2020 2020 2020   1 >= 0:..      
-00022210: 2020 2020 2020 2020 2020 2020 2020 7374                st
-00022220: 6163 6b2e 6170 7065 6e64 2828 6d78 202d  ack.append((mx -
-00022230: 2031 2c20 6d79 2929 0d0a 2020 2020 2020   1, my))..      
-00022240: 2020 2020 2020 2020 2020 6966 206d 7920            if my 
-00022250: 2b20 3120 3c20 683a 0d0a 2020 2020 2020  + 1 < h:..      
-00022260: 2020 2020 2020 2020 2020 2020 2020 7374                st
-00022270: 6163 6b2e 6170 7065 6e64 2828 6d78 2c20  ack.append((mx, 
-00022280: 6d79 202b 2031 2929 0d0a 2020 2020 2020  my + 1))..      
-00022290: 2020 2020 2020 2020 2020 6966 206d 7920            if my 
-000222a0: 2d20 3120 3e3d 2030 3a0d 0a20 2020 2020  - 1 >= 0:..     
-000222b0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-000222c0: 7461 636b 2e61 7070 656e 6428 286d 782c  tack.append((mx,
-000222d0: 206d 7920 2d20 3129 290d 0a20 2020 2020   my - 1))..     
-000222e0: 2020 2063 6f6e 7469 6775 6f75 735f 6d61     contiguous_ma
-000222f0: 736b 203d 2063 6f6e 7469 6775 6f75 735f  sk = contiguous_
-00022300: 6d61 736b 203d 3d20 320d 0a20 2020 2020  mask == 2..     
-00022310: 2020 2073 6567 6d65 6e74 6174 696f 6e2e     segmentation.
-00022320: 6461 7461 5b78 5b30 5d3a 785b 315d 2c20  data[x[0]:x[1], 
-00022330: 795b 305d 3a79 5b31 5d5d 202b 3d20 636f  y[0]:y[1]] += co
-00022340: 6e74 6967 756f 7573 5f6d 6173 6b0d 0a20  ntiguous_mask.. 
-00022350: 2020 2020 2020 2073 6567 6d65 6e74 6174         segmentat
-00022360: 696f 6e2e 6461 7461 5b78 5b30 5d3a 785b  ion.data[x[0]:x[
-00022370: 315d 2c20 795b 305d 3a79 5b31 5d5d 203d  1], y[0]:y[1]] =
-00022380: 206e 702e 636c 6970 2873 6567 6d65 6e74   np.clip(segment
-00022390: 6174 696f 6e2e 6461 7461 5b78 5b30 5d3a  ation.data[x[0]:
-000223a0: 785b 315d 2c20 795b 305d 3a79 5b31 5d5d  x[1], y[0]:y[1]]
-000223b0: 2c20 302c 2031 290d 0a20 2020 2020 2020  , 0, 1)..       
-000223c0: 2073 6567 6d65 6e74 6174 696f 6e2e 7465   segmentation.te
-000223d0: 7874 7572 652e 7570 6461 7465 5f73 7562  xture.update_sub
-000223e0: 696d 6167 6528 7365 676d 656e 7461 7469  image(segmentati
-000223f0: 6f6e 2e64 6174 615b 785b 305d 3a78 5b31  on.data[x[0]:x[1
-00022400: 5d2c 2079 5b30 5d3a 795b 315d 5d2c 2079  ], y[0]:y[1]], y
-00022410: 5b30 5d2c 2078 5b30 5d29 0d0a 0d0a 0d0a  [0], x[0])......
-00022420: 636c 6173 7320 5265 6e64 6572 6572 3a0d  class Renderer:.
-00022430: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
-00022440: 5f28 7365 6c66 293a 0d0a 2020 2020 2020  _(self):..      
-00022450: 2020 7365 6c66 2e71 7561 645f 7368 6164    self.quad_shad
-00022460: 6572 203d 2053 6861 6465 7228 6f73 2e70  er = Shader(os.p
-00022470: 6174 682e 6a6f 696e 2863 6667 2e72 6f6f  ath.join(cfg.roo
-00022480: 742c 2022 7368 6164 6572 7322 2c20 2273  t, "shaders", "s
-00022490: 655f 7175 6164 5f73 6861 6465 722e 676c  e_quad_shader.gl
-000224a0: 736c 2229 290d 0a20 2020 2020 2020 2073  sl"))..        s
-000224b0: 656c 662e 625f 7365 676d 656e 7461 7469  elf.b_segmentati
-000224c0: 6f6e 5f73 6861 6465 7220 3d20 5368 6164  on_shader = Shad
-000224d0: 6572 286f 732e 7061 7468 2e6a 6f69 6e28  er(os.path.join(
-000224e0: 6366 672e 726f 6f74 2c20 2273 6861 6465  cfg.root, "shade
-000224f0: 7273 222c 2022 7365 5f62 696e 6172 795f  rs", "se_binary_
-00022500: 7365 676d 656e 7461 7469 6f6e 5f73 6861  segmentation_sha
-00022510: 6465 722e 676c 736c 2229 290d 0a20 2020  der.glsl"))..   
-00022520: 2020 2020 2073 656c 662e 665f 7365 676d       self.f_segm
-00022530: 656e 7461 7469 6f6e 5f73 6861 6465 7220  entation_shader 
-00022540: 3d20 5368 6164 6572 286f 732e 7061 7468  = Shader(os.path
-00022550: 2e6a 6f69 6e28 6366 672e 726f 6f74 2c20  .join(cfg.root, 
-00022560: 2273 6861 6465 7273 222c 2022 7365 5f66  "shaders", "se_f
-00022570: 6c6f 6174 5f73 6567 6d65 6e74 6174 696f  loat_segmentatio
-00022580: 6e5f 7368 6164 6572 2e67 6c73 6c22 2929  n_shader.glsl"))
-00022590: 0d0a 2020 2020 2020 2020 7365 6c66 2e6f  ..        self.o
-000225a0: 7665 726c 6179 5f73 6861 6465 7220 3d20  verlay_shader = 
-000225b0: 5368 6164 6572 286f 732e 7061 7468 2e6a  Shader(os.path.j
-000225c0: 6f69 6e28 6366 672e 726f 6f74 2c20 2273  oin(cfg.root, "s
-000225d0: 6861 6465 7273 222c 2022 7365 5f6f 7665  haders", "se_ove
-000225e0: 726c 6179 5f73 6861 6465 722e 676c 736c  rlay_shader.glsl
-000225f0: 2229 290d 0a20 2020 2020 2020 2073 656c  "))..        sel
-00022600: 662e 626f 7264 6572 5f73 6861 6465 7220  f.border_shader 
-00022610: 3d20 5368 6164 6572 286f 732e 7061 7468  = Shader(os.path
-00022620: 2e6a 6f69 6e28 6366 672e 726f 6f74 2c20  .join(cfg.root, 
-00022630: 2273 6861 6465 7273 222c 2022 7365 5f62  "shaders", "se_b
-00022640: 6f72 6465 725f 7368 6164 6572 2e67 6c73  order_shader.gls
-00022650: 6c22 2929 0d0a 2020 2020 2020 2020 7365  l"))..        se
-00022660: 6c66 2e6b 6572 6e65 6c5f 6669 6c74 6572  lf.kernel_filter
-00022670: 203d 2053 6861 6465 7228 6f73 2e70 6174   = Shader(os.pat
-00022680: 682e 6a6f 696e 2863 6667 2e72 6f6f 742c  h.join(cfg.root,
-00022690: 2022 7368 6164 6572 7322 2c20 2273 655f   "shaders", "se_
-000226a0: 636f 6d70 7574 655f 6b65 726e 656c 5f66  compute_kernel_f
-000226b0: 696c 7465 722e 676c 736c 2229 290d 0a20  ilter.glsl")).. 
-000226c0: 2020 2020 2020 2073 656c 662e 6d69 785f         self.mix_
-000226d0: 6669 6c74 6572 6564 203d 2053 6861 6465  filtered = Shade
-000226e0: 7228 6f73 2e70 6174 682e 6a6f 696e 2863  r(os.path.join(c
-000226f0: 6667 2e72 6f6f 742c 2022 7368 6164 6572  fg.root, "shader
-00022700: 7322 2c20 2273 655f 636f 6d70 7574 655f  s", "se_compute_
-00022710: 6d69 782e 676c 736c 2229 290d 0a20 2020  mix.glsl"))..   
-00022720: 2020 2020 2073 656c 662e 6c69 6e65 5f73       self.line_s
-00022730: 6861 6465 7220 3d20 5368 6164 6572 286f  hader = Shader(o
-00022740: 732e 7061 7468 2e6a 6f69 6e28 6366 672e  s.path.join(cfg.
-00022750: 726f 6f74 2c20 2273 6861 6465 7273 222c  root, "shaders",
-00022760: 2022 6365 5f6c 696e 655f 7368 6164 6572   "ce_line_shader
-00022770: 2e67 6c73 6c22 2929 0d0a 2020 2020 2020  .glsl"))..      
-00022780: 2020 7365 6c66 2e69 636f 6e5f 7368 6164    self.icon_shad
-00022790: 6572 203d 2053 6861 6465 7228 6f73 2e70  er = Shader(os.p
-000227a0: 6174 682e 6a6f 696e 2863 6667 2e72 6f6f  ath.join(cfg.roo
-000227b0: 742c 2022 7368 6164 6572 7322 2c20 2273  t, "shaders", "s
-000227c0: 655f 6963 6f6e 5f73 6861 6465 722e 676c  e_icon_shader.gl
-000227d0: 736c 2229 290d 0a20 2020 2020 2020 2073  sl"))..        s
-000227e0: 656c 662e 7375 7266 6163 655f 6d6f 6465  elf.surface_mode
-000227f0: 6c5f 7368 6164 6572 203d 2053 6861 6465  l_shader = Shade
-00022800: 7228 6f73 2e70 6174 682e 6a6f 696e 2863  r(os.path.join(c
-00022810: 6667 2e72 6f6f 742c 2022 7368 6164 6572  fg.root, "shader
-00022820: 7322 2c20 2273 655f 7375 7266 6163 655f  s", "se_surface_
-00022830: 6d6f 6465 6c5f 7368 6164 6572 2e67 6c73  model_shader.gls
-00022840: 6c22 2929 0d0a 2020 2020 2020 2020 7365  l"))..        se
-00022850: 6c66 2e6c 696e 655f 3364 5f73 6861 6465  lf.line_3d_shade
-00022860: 7220 3d20 5368 6164 6572 286f 732e 7061  r = Shader(os.pa
-00022870: 7468 2e6a 6f69 6e28 6366 672e 726f 6f74  th.join(cfg.root
-00022880: 2c20 2273 6861 6465 7273 222c 2022 7365  , "shaders", "se
-00022890: 5f6c 696e 655f 3364 5f73 6861 6465 722e  _line_3d_shader.
-000228a0: 676c 736c 2229 290d 0a20 2020 2020 2020  glsl"))..       
-000228b0: 2073 656c 662e 7175 6164 5f33 645f 7368   self.quad_3d_sh
-000228c0: 6164 6572 203d 2053 6861 6465 7228 6f73  ader = Shader(os
-000228d0: 2e70 6174 682e 6a6f 696e 2863 6667 2e72  .path.join(cfg.r
-000228e0: 6f6f 742c 2022 7368 6164 6572 7322 2c20  oot, "shaders", 
-000228f0: 2273 655f 7175 6164 5f33 645f 7368 6164  "se_quad_3d_shad
-00022900: 6572 2e67 6c73 6c22 2929 0d0a 2020 2020  er.glsl"))..    
-00022910: 2020 2020 7365 6c66 2e64 6570 7468 5f6d      self.depth_m
-00022920: 6173 6b5f 7368 6164 6572 203d 2053 6861  ask_shader = Sha
-00022930: 6465 7228 6f73 2e70 6174 682e 6a6f 696e  der(os.path.join
-00022940: 2863 6667 2e72 6f6f 742c 2022 7368 6164  (cfg.root, "shad
-00022950: 6572 7322 2c20 2273 655f 6465 7074 685f  ers", "se_depth_
-00022960: 6d61 736b 5f73 6861 6465 722e 676c 736c  mask_shader.glsl
-00022970: 2229 290d 0a20 2020 2020 2020 2073 656c  "))..        sel
-00022980: 662e 7261 795f 7472 6163 655f 7368 6164  f.ray_trace_shad
-00022990: 6572 203d 2053 6861 6465 7228 6f73 2e70  er = Shader(os.p
-000229a0: 6174 682e 6a6f 696e 2863 6667 2e72 6f6f  ath.join(cfg.roo
-000229b0: 742c 2022 7368 6164 6572 7322 2c20 2273  t, "shaders", "s
-000229c0: 655f 6f76 6572 6c61 795f 7261 795f 7472  e_overlay_ray_tr
-000229d0: 6163 655f 7368 6164 6572 2e67 6c73 6c22  ace_shader.glsl"
-000229e0: 2929 0d0a 2020 2020 2020 2020 7365 6c66  ))..        self
-000229f0: 2e6f 7665 726c 6179 5f62 6c65 6e64 5f73  .overlay_blend_s
-00022a00: 6861 6465 7220 3d20 5368 6164 6572 286f  hader = Shader(o
-00022a10: 732e 7061 7468 2e6a 6f69 6e28 6366 672e  s.path.join(cfg.
-00022a20: 726f 6f74 2c20 2273 6861 6465 7273 222c  root, "shaders",
-00022a30: 2022 7365 5f6f 7665 726c 6179 5f62 6c65   "se_overlay_ble
-00022a40: 6e64 5f73 6861 6465 722e 676c 736c 2229  nd_shader.glsl")
-00022a50: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
-00022a60: 7061 7274 6963 6c65 5f73 6861 6465 7220  particle_shader 
-00022a70: 3d20 5368 6164 6572 286f 732e 7061 7468  = Shader(os.path
-00022a80: 2e6a 6f69 6e28 6366 672e 726f 6f74 2c20  .join(cfg.root, 
-00022a90: 2273 6861 6465 7273 222c 2022 7365 5f70  "shaders", "se_p
-00022aa0: 6172 7469 636c 655f 7368 6164 6572 2e67  article_shader.g
-00022ab0: 6c73 6c22 2929 0d0a 2020 2020 2020 2020  lsl"))..        
-00022ac0: 7365 6c66 2e6c 696e 655f 6c69 7374 203d  self.line_list =
-00022ad0: 206c 6973 7428 290d 0a20 2020 2020 2020   list()..       
-00022ae0: 2073 656c 662e 6c69 6e65 5f6c 6973 745f   self.line_list_
-00022af0: 7320 3d20 6c69 7374 2829 0d0a 2020 2020  s = list()..    
-00022b00: 2020 2020 7365 6c66 2e6c 696e 655f 7661      self.line_va
-00022b10: 203d 2056 6572 7465 7841 7272 6179 284e   = VertexArray(N
-00022b20: 6f6e 652c 204e 6f6e 652c 2061 7474 7269  one, None, attri
-00022b30: 6275 7465 5f66 6f72 6d61 743d 2278 7972  bute_format="xyr
-00022b40: 6762 2229 0d0a 2020 2020 2020 2020 7365  gb")..        se
-00022b50: 6c66 2e66 626f 3120 3d20 4672 616d 6542  lf.fbo1 = FrameB
-00022b60: 7566 6665 7228 290d 0a20 2020 2020 2020  uffer()..       
-00022b70: 2073 656c 662e 6662 6f32 203d 2046 7261   self.fbo2 = Fra
-00022b80: 6d65 4275 6666 6572 2829 0d0a 2020 2020  meBuffer()..    
-00022b90: 2020 2020 7365 6c66 2e66 626f 3320 3d20      self.fbo3 = 
-00022ba0: 4672 616d 6542 7566 6665 7228 3130 302c  FrameBuffer(100,
-00022bb0: 2031 3030 290d 0a20 2020 2020 2020 2073   100)..        s
-00022bc0: 656c 662e 7261 795f 7472 6163 655f 6662  elf.ray_trace_fb
-00022bd0: 6f5f 6120 3d20 4672 616d 6542 7566 6665  o_a = FrameBuffe
-00022be0: 7228 290d 0a20 2020 2020 2020 2073 656c  r()..        sel
-00022bf0: 662e 7261 795f 7472 6163 655f 6662 6f5f  f.ray_trace_fbo_
-00022c00: 6220 3d20 4672 616d 6542 7566 6665 7228  b = FrameBuffer(
-00022c10: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
-00022c20: 6e64 635f 7363 7265 656e 5f76 6120 3d20  ndc_screen_va = 
-00022c30: 5665 7274 6578 4172 7261 7928 6174 7472  VertexArray(attr
-00022c40: 6962 7574 655f 666f 726d 6174 3d22 7879  ibute_format="xy
-00022c50: 2229 0d0a 2020 2020 2020 2020 7365 6c66  ")..        self
-00022c60: 2e6e 6463 5f73 6372 6565 6e5f 7661 2e75  .ndc_screen_va.u
-00022c70: 7064 6174 6528 5665 7274 6578 4275 6666  pdate(VertexBuff
-00022c80: 6572 285b 2d31 2c20 2d31 2c20 312c 202d  er([-1, -1, 1, -
-00022c90: 312c 2031 2c20 312c 202d 312c 2031 5d29  1, 1, 1, -1, 1])
-00022ca0: 2c20 496e 6465 7842 7566 6665 7228 5b30  , IndexBuffer([0
-00022cb0: 2c20 312c 2032 2c20 302c 2032 2c20 335d  , 1, 2, 0, 2, 3]
-00022cc0: 2929 0d0a 2020 2020 2020 2020 7365 6c66  ))..        self
-00022cd0: 2e72 6179 5f74 7261 6365 5f66 626f 5f73  .ray_trace_fbo_s
-00022ce0: 697a 6520 3d20 5b30 2e30 2c20 302e 305d  ize = [0.0, 0.0]
-00022cf0: 0d0a 2020 2020 2020 2020 7665 7274 6963  ..        vertic
-00022d00: 6573 2c20 696e 6469 6365 7320 3d20 6963  es, indices = ic
-00022d10: 6f73 7068 6572 655f 7661 2829 0d0a 2020  osphere_va()..  
-00022d20: 2020 2020 2020 7365 6c66 2e70 6172 7469        self.parti
-00022d30: 636c 655f 7661 203d 2056 6572 7465 7841  cle_va = VertexA
-00022d40: 7272 6179 2856 6572 7465 7842 7566 6665  rray(VertexBuffe
-00022d50: 7228 7665 7274 6963 6573 292c 2049 6e64  r(vertices), Ind
-00022d60: 6578 4275 6666 6572 2869 6e64 6963 6573  exBuffer(indices
-00022d70: 292c 2061 7474 7269 6275 7465 5f66 6f72  ), attribute_for
-00022d80: 6d61 743d 2278 797a 2229 0d0a 0d0a 2020  mat="xyz")....  
-00022d90: 2020 6465 6620 7265 636f 6d70 696c 655f    def recompile_
-00022da0: 7368 6164 6572 7328 7365 6c66 293a 2020  shaders(self):  
-00022db0: 2320 666f 7220 6465 6275 6767 696e 670d  # for debugging.
-00022dc0: 0a20 2020 2020 2020 2074 7279 3a0d 0a20  .        try:.. 
-00022dd0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00022de0: 7175 6164 5f73 6861 6465 7220 3d20 5368  quad_shader = Sh
-00022df0: 6164 6572 286f 732e 7061 7468 2e6a 6f69  ader(os.path.joi
-00022e00: 6e28 6366 672e 726f 6f74 2c20 2273 6861  n(cfg.root, "sha
-00022e10: 6465 7273 222c 2022 7365 5f71 7561 645f  ders", "se_quad_
-00022e20: 7368 6164 6572 2e67 6c73 6c22 2929 0d0a  shader.glsl"))..
-00022e30: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00022e40: 2e62 5f73 6567 6d65 6e74 6174 696f 6e5f  .b_segmentation_
-00022e50: 7368 6164 6572 203d 2053 6861 6465 7228  shader = Shader(
-00022e60: 6f73 2e70 6174 682e 6a6f 696e 2863 6667  os.path.join(cfg
-00022e70: 2e72 6f6f 742c 2022 7368 6164 6572 7322  .root, "shaders"
-00022e80: 2c20 2273 655f 6269 6e61 7279 5f73 6567  , "se_binary_seg
-00022e90: 6d65 6e74 6174 696f 6e5f 7368 6164 6572  mentation_shader
-00022ea0: 2e67 6c73 6c22 2929 0d0a 2020 2020 2020  .glsl"))..      
-00022eb0: 2020 2020 2020 7365 6c66 2e66 5f73 6567        self.f_seg
-00022ec0: 6d65 6e74 6174 696f 6e5f 7368 6164 6572  mentation_shader
-00022ed0: 203d 2053 6861 6465 7228 6f73 2e70 6174   = Shader(os.pat
-00022ee0: 682e 6a6f 696e 2863 6667 2e72 6f6f 742c  h.join(cfg.root,
-00022ef0: 2022 7368 6164 6572 7322 2c20 2273 655f   "shaders", "se_
-00022f00: 666c 6f61 745f 7365 676d 656e 7461 7469  float_segmentati
-00022f10: 6f6e 5f73 6861 6465 722e 676c 736c 2229  on_shader.glsl")
-00022f20: 290d 0a20 2020 2020 2020 2020 2020 2073  )..            s
-00022f30: 656c 662e 6f76 6572 6c61 795f 7368 6164  elf.overlay_shad
-00022f40: 6572 203d 2053 6861 6465 7228 6f73 2e70  er = Shader(os.p
-00022f50: 6174 682e 6a6f 696e 2863 6667 2e72 6f6f  ath.join(cfg.roo
-00022f60: 742c 2022 7368 6164 6572 7322 2c20 2273  t, "shaders", "s
-00022f70: 655f 6f76 6572 6c61 795f 7368 6164 6572  e_overlay_shader
-00022f80: 2e67 6c73 6c22 2929 0d0a 2020 2020 2020  .glsl"))..      
-00022f90: 2020 2020 2020 7365 6c66 2e62 6f72 6465        self.borde
-00022fa0: 725f 7368 6164 6572 203d 2053 6861 6465  r_shader = Shade
-00022fb0: 7228 6f73 2e70 6174 682e 6a6f 696e 2863  r(os.path.join(c
-00022fc0: 6667 2e72 6f6f 742c 2022 7368 6164 6572  fg.root, "shader
-00022fd0: 7322 2c20 2273 655f 626f 7264 6572 5f73  s", "se_border_s
-00022fe0: 6861 6465 722e 676c 736c 2229 290d 0a20  hader.glsl")).. 
-00022ff0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00023000: 6b65 726e 656c 5f66 696c 7465 7220 3d20  kernel_filter = 
-00023010: 5368 6164 6572 286f 732e 7061 7468 2e6a  Shader(os.path.j
-00023020: 6f69 6e28 6366 672e 726f 6f74 2c20 2273  oin(cfg.root, "s
-00023030: 6861 6465 7273 222c 2022 7365 5f63 6f6d  haders", "se_com
-00023040: 7075 7465 5f6b 6572 6e65 6c5f 6669 6c74  pute_kernel_filt
-00023050: 6572 2e67 6c73 6c22 2929 0d0a 2020 2020  er.glsl"))..    
-00023060: 2020 2020 2020 2020 7365 6c66 2e6d 6978          self.mix
-00023070: 5f66 696c 7465 7265 6420 3d20 5368 6164  _filtered = Shad
-00023080: 6572 286f 732e 7061 7468 2e6a 6f69 6e28  er(os.path.join(
-00023090: 6366 672e 726f 6f74 2c20 2273 6861 6465  cfg.root, "shade
-000230a0: 7273 222c 2022 7365 5f63 6f6d 7075 7465  rs", "se_compute
-000230b0: 5f6d 6978 2e67 6c73 6c22 2929 0d0a 2020  _mix.glsl"))..  
-000230c0: 2020 2020 2020 2020 2020 7365 6c66 2e6c            self.l
-000230d0: 696e 655f 7368 6164 6572 203d 2053 6861  ine_shader = Sha
-000230e0: 6465 7228 6f73 2e70 6174 682e 6a6f 696e  der(os.path.join
-000230f0: 2863 6667 2e72 6f6f 742c 2022 7368 6164  (cfg.root, "shad
-00023100: 6572 7322 2c20 2263 655f 6c69 6e65 5f73  ers", "ce_line_s
-00023110: 6861 6465 722e 676c 736c 2229 290d 0a20  hader.glsl")).. 
-00023120: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00023130: 6963 6f6e 5f73 6861 6465 7220 3d20 5368  icon_shader = Sh
-00023140: 6164 6572 286f 732e 7061 7468 2e6a 6f69  ader(os.path.joi
-00023150: 6e28 6366 672e 726f 6f74 2c20 2273 6861  n(cfg.root, "sha
-00023160: 6465 7273 222c 2022 7365 5f69 636f 6e5f  ders", "se_icon_
-00023170: 7368 6164 6572 2e67 6c73 6c22 2929 0d0a  shader.glsl"))..
-00023180: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00023190: 2e73 7572 6661 6365 5f6d 6f64 656c 5f73  .surface_model_s
-000231a0: 6861 6465 7220 3d20 5368 6164 6572 286f  hader = Shader(o
-000231b0: 732e 7061 7468 2e6a 6f69 6e28 6366 672e  s.path.join(cfg.
-000231c0: 726f 6f74 2c20 2273 6861 6465 7273 222c  root, "shaders",
-000231d0: 2022 7365 5f73 7572 6661 6365 5f6d 6f64   "se_surface_mod
-000231e0: 656c 5f73 6861 6465 722e 676c 736c 2229  el_shader.glsl")
-000231f0: 290d 0a20 2020 2020 2020 2020 2020 2073  )..            s
-00023200: 656c 662e 6c69 6e65 5f33 645f 7368 6164  elf.line_3d_shad
-00023210: 6572 203d 2053 6861 6465 7228 6f73 2e70  er = Shader(os.p
-00023220: 6174 682e 6a6f 696e 2863 6667 2e72 6f6f  ath.join(cfg.roo
-00023230: 742c 2022 7368 6164 6572 7322 2c20 2273  t, "shaders", "s
-00023240: 655f 6c69 6e65 5f33 645f 7368 6164 6572  e_line_3d_shader
-00023250: 2e67 6c73 6c22 2929 0d0a 2020 2020 2020  .glsl"))..      
-00023260: 2020 2020 2020 7365 6c66 2e71 7561 645f        self.quad_
-00023270: 3364 5f73 6861 6465 7220 3d20 5368 6164  3d_shader = Shad
-00023280: 6572 286f 732e 7061 7468 2e6a 6f69 6e28  er(os.path.join(
-00023290: 6366 672e 726f 6f74 2c20 2273 6861 6465  cfg.root, "shade
-000232a0: 7273 222c 2022 7365 5f71 7561 645f 3364  rs", "se_quad_3d
-000232b0: 5f73 6861 6465 722e 676c 736c 2229 290d  _shader.glsl")).
-000232c0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-000232d0: 662e 6465 7074 685f 6d61 736b 5f73 6861  f.depth_mask_sha
-000232e0: 6465 7220 3d20 5368 6164 6572 286f 732e  der = Shader(os.
-000232f0: 7061 7468 2e6a 6f69 6e28 6366 672e 726f  path.join(cfg.ro
-00023300: 6f74 2c20 2273 6861 6465 7273 222c 2022  ot, "shaders", "
-00023310: 7365 5f64 6570 7468 5f6d 6173 6b5f 7368  se_depth_mask_sh
-00023320: 6164 6572 2e67 6c73 6c22 2929 0d0a 2020  ader.glsl"))..  
-00023330: 2020 2020 2020 2020 2020 7365 6c66 2e72            self.r
-00023340: 6179 5f74 7261 6365 5f73 6861 6465 7220  ay_trace_shader 
-00023350: 3d20 5368 6164 6572 286f 732e 7061 7468  = Shader(os.path
-00023360: 2e6a 6f69 6e28 6366 672e 726f 6f74 2c20  .join(cfg.root, 
-00023370: 2273 6861 6465 7273 222c 2022 7365 5f6f  "shaders", "se_o
-00023380: 7665 726c 6179 5f72 6179 5f74 7261 6365  verlay_ray_trace
-00023390: 5f73 6861 6465 722e 676c 736c 2229 290d  _shader.glsl")).
-000233a0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-000233b0: 662e 6f76 6572 6c61 795f 626c 656e 645f  f.overlay_blend_
-000233c0: 7368 6164 6572 203d 2053 6861 6465 7228  shader = Shader(
-000233d0: 6f73 2e70 6174 682e 6a6f 696e 2863 6667  os.path.join(cfg
-000233e0: 2e72 6f6f 742c 2022 7368 6164 6572 7322  .root, "shaders"
-000233f0: 2c20 2273 655f 6f76 6572 6c61 795f 626c  , "se_overlay_bl
-00023400: 656e 645f 7368 6164 6572 2e67 6c73 6c22  end_shader.glsl"
-00023410: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
-00023420: 7365 6c66 2e70 6172 7469 636c 655f 7368  self.particle_sh
-00023430: 6164 6572 203d 2053 6861 6465 7228 6f73  ader = Shader(os
-00023440: 2e70 6174 682e 6a6f 696e 2863 6667 2e72  .path.join(cfg.r
-00023450: 6f6f 742c 2022 7368 6164 6572 7322 2c20  oot, "shaders", 
-00023460: 2273 655f 7061 7274 6963 6c65 5f73 6861  "se_particle_sha
-00023470: 6465 722e 676c 736c 2229 290d 0a20 2020  der.glsl"))..   
-00023480: 2020 2020 2066 696e 616c 6c79 3a0d 0a20       finally:.. 
-00023490: 2020 2020 2020 2020 2020 2070 6173 730d             pass.
-000234a0: 0a0d 0a20 2020 2064 6566 2072 656e 6465  ...    def rende
-000234b0: 725f 6669 6c74 6572 6564 5f66 7261 6d65  r_filtered_frame
-000234c0: 2873 656c 662c 2073 655f 6672 616d 652c  (self, se_frame,
-000234d0: 2063 616d 6572 612c 2077 696e 646f 772c   camera, window,
-000234e0: 2066 696c 7465 7273 2c20 6361 6d65 7261   filters, camera
-000234f0: 3364 3d4e 6f6e 652c 2065 6d70 6861 7369  3d=None, emphasi
-00023500: 7a65 5f72 6f69 3d46 616c 7365 293a 0d0a  ze_roi=False):..
-00023510: 2020 2020 2020 2020 7365 5f66 7261 6d65          se_frame
-00023520: 2e75 7064 6174 655f 6d6f 6465 6c5f 6d61  .update_model_ma
-00023530: 7472 6978 2829 0d0a 2020 2020 2020 2020  trix()..        
-00023540: 676c 426c 656e 6446 756e 6328 474c 5f53  glBlendFunc(GL_S
-00023550: 5243 5f41 4c50 4841 2c20 474c 5f4f 4e45  RC_ALPHA, GL_ONE
-00023560: 5f4d 494e 5553 5f53 5243 5f41 4c50 4841  _MINUS_SRC_ALPHA
-00023570: 290d 0a20 2020 2020 2020 2067 6c42 6c65  )..        glBle
-00023580: 6e64 4571 7561 7469 6f6e 2847 4c5f 4655  ndEquation(GL_FU
-00023590: 4e43 5f41 4444 290d 0a0d 0a20 2020 2020  NC_ADD)....     
-000235a0: 2020 2073 656c 662e 6662 6f31 2e63 6c65     self.fbo1.cle
-000235b0: 6172 2828 302e 302c 2030 2e30 2c20 302e  ar((0.0, 0.0, 0.
-000235c0: 302c 2031 2e30 2929 0d0a 2020 2020 2020  0, 1.0))..      
-000235d0: 2020 7365 6c66 2e66 626f 322e 636c 6561    self.fbo2.clea
-000235e0: 7228 2830 2e30 2c20 302e 302c 2030 2e30  r((0.0, 0.0, 0.0
-000235f0: 2c20 312e 3029 290d 0a20 2020 2020 2020  , 1.0))..       
-00023600: 2073 656c 662e 6662 6f33 2e63 6c65 6172   self.fbo3.clear
-00023610: 2828 302e 302c 2030 2e30 2c20 302e 302c  ((0.0, 0.0, 0.0,
-00023620: 2032 2e30 2929 0d0a 0d0a 2020 2020 2020   2.0))....      
-00023630: 2020 2320 6966 2061 6e79 2066 696c 7465    # if any filte
-00023640: 7273 2077 696c 6c20 6265 2061 7070 6c69  rs will be appli
-00023650: 6564 2062 656c 6f77 2c20 7265 7365 7420  ed below, reset 
-00023660: 7468 6520 6672 616d 6527 7320 6461 7461  the frame's data
-00023670: 2074 6f20 7468 6520 6f72 6967 696e 616c   to the original
-00023680: 2072 6177 2070 6978 656c 2064 6174 610d   raw pixel data.
-00023690: 0a20 2020 2020 2020 2070 7864 203d 204e  .        pxd = N
-000236a0: 6f6e 650d 0a20 2020 2020 2020 206f 7665  one..        ove
-000236b0: 7272 6964 655f 636f 6e74 7261 7374 5f72  rride_contrast_r
-000236c0: 6f69 203d 2046 616c 7365 0d0a 2020 2020  oi = False..    
-000236d0: 2020 2020 6966 2053 6567 6d65 6e74 6174      if Segmentat
-000236e0: 696f 6e45 6469 746f 722e 4652 414d 455f  ionEditor.FRAME_
-000236f0: 5445 5854 5552 455f 5245 5155 4952 4553  TEXTURE_REQUIRES
-00023700: 5f55 5044 4154 453a 0d0a 2020 2020 2020  _UPDATE:..      
-00023710: 2020 2020 2020 2320 7365 7420 7468 6520        # set the 
-00023720: 6672 616d 6527 7320 2e72 656e 6465 7265  frame's .rendere
-00023730: 645f 6461 7461 2074 6f20 7468 6520 7261  d_data to the ra
-00023740: 7720 696d 6167 6520 6461 7461 202d 2074  w image data - t
-00023750: 6865 6e20 7265 6e64 6572 2061 7320 7573  hen render as us
-00023760: 7561 6c2e 0d0a 2020 2020 2020 2020 2020  ual...          
-00023770: 2020 6366 672e 7365 5f61 6374 6976 655f    cfg.se_active_
-00023780: 6672 616d 652e 7265 6e64 6572 6564 5f64  frame.rendered_d
-00023790: 6174 6120 3d20 6366 672e 7365 5f61 6374  ata = cfg.se_act
-000237a0: 6976 655f 6672 616d 652e 6461 7461 0d0a  ive_frame.data..
-000237b0: 2020 2020 2020 2020 2020 2020 6366 672e              cfg.
-000237c0: 7365 5f61 6374 6976 655f 6672 616d 652e  se_active_frame.
-000237d0: 7570 6461 7465 5f69 6d61 6765 5f74 6578  update_image_tex
-000237e0: 7475 7265 2829 0d0a 2020 2020 2020 2020  ture()..        
-000237f0: 2020 2020 7078 6420 3d20 6366 672e 7365      pxd = cfg.se
-00023800: 5f61 6374 6976 655f 6672 616d 652e 7265  _active_frame.re
-00023810: 6e64 6572 6564 5f64 6174 610d 0a20 2020  ndered_data..   
-00023820: 2020 2020 2020 2020 206f 7665 7272 6964           overrid
-00023830: 655f 636f 6e74 7261 7374 5f72 6f69 203d  e_contrast_roi =
-00023840: 2054 7275 650d 0a0d 0a20 2020 2020 2020   True....       
-00023850: 2023 2072 656e 6465 7220 7468 6520 696d   # render the im
-00023860: 6167 6520 746f 2061 2066 7261 6d65 6275  age to a framebu
-00023870: 6666 6572 0d0a 2020 2020 2020 2020 6661  ffer..        fa
-00023880: 6b65 5f63 616d 6572 615f 6d61 7472 6978  ke_camera_matrix
-00023890: 203d 206e 702e 6d61 7472 6978 285b 5b32   = np.matrix([[2
-000238a0: 202f 2073 656c 662e 6662 6f31 2e77 6964   / self.fbo1.wid
-000238b0: 7468 2c20 302c 2030 2c20 305d 2c20 5b30  th, 0, 0, 0], [0
-000238c0: 2c20 3220 2f20 7365 6c66 2e66 626f 312e  , 2 / self.fbo1.
-000238d0: 6865 6967 6874 2c20 302c 2030 5d2c 205b  height, 0, 0], [
-000238e0: 302c 2030 2c20 2d32 202f 2031 3030 2c20  0, 0, -2 / 100, 
-000238f0: 305d 2c20 5b30 2c20 302c 2030 2c20 315d  0], [0, 0, 0, 1]
-00023900: 5d29 0d0a 2020 2020 2020 2020 7365 6c66  ])..        self
-00023910: 2e66 626f 312e 6269 6e64 2829 0d0a 2020  .fbo1.bind()..  
-00023920: 2020 2020 2020 7365 6c66 2e71 7561 645f        self.quad_
-00023930: 7368 6164 6572 2e62 696e 6428 290d 0a20  shader.bind().. 
-00023940: 2020 2020 2020 2073 655f 6672 616d 652e         se_frame.
-00023950: 7175 6164 5f76 612e 6269 6e64 2829 0d0a  quad_va.bind()..
-00023960: 2020 2020 2020 2020 7365 5f66 7261 6d65          se_frame
-00023970: 2e74 6578 7475 7265 2e62 696e 6428 3029  .texture.bind(0)
-00023980: 0d0a 2020 2020 2020 2020 7365 6c66 2e71  ..        self.q
-00023990: 7561 645f 7368 6164 6572 2e75 6e69 666f  uad_shader.unifo
-000239a0: 726d 6d61 7434 2822 6361 6d65 7261 4d61  rmmat4("cameraMa
-000239b0: 7472 6978 222c 2066 616b 655f 6361 6d65  trix", fake_came
-000239c0: 7261 5f6d 6174 7269 7829 0d0a 2020 2020  ra_matrix)..    
-000239d0: 2020 2020 7365 6c66 2e71 7561 645f 7368      self.quad_sh
-000239e0: 6164 6572 2e75 6e69 666f 726d 6d61 7434  ader.uniformmat4
-000239f0: 2822 6d6f 6465 6c4d 6174 7269 7822 2c20  ("modelMatrix", 
-00023a00: 6e70 2e69 6465 6e74 6974 7928 3429 290d  np.identity(4)).
-00023a10: 0a20 2020 2020 2020 2073 656c 662e 7175  .        self.qu
-00023a20: 6164 5f73 6861 6465 722e 756e 6966 6f72  ad_shader.unifor
-00023a30: 6d31 6628 2261 6c70 6861 222c 2073 655f  m1f("alpha", se_
-00023a40: 6672 616d 652e 616c 7068 6129 0d0a 2020  frame.alpha)..  
-00023a50: 2020 2020 2020 7365 6c66 2e71 7561 645f        self.quad_
-00023a60: 7368 6164 6572 2e75 6e69 666f 726d 3166  shader.uniform1f
-00023a70: 2822 636f 6e74 7261 7374 4d69 6e22 2c20  ("contrastMin", 
-00023a80: 302e 3029 0d0a 2020 2020 2020 2020 7365  0.0)..        se
-00023a90: 6c66 2e71 7561 645f 7368 6164 6572 2e75  lf.quad_shader.u
-00023aa0: 6e69 666f 726d 3166 2822 636f 6e74 7261  niform1f("contra
-00023ab0: 7374 4d61 7822 2c20 312e 3029 0d0a 2020  stMax", 1.0)..  
-00023ac0: 2020 2020 2020 676c 4472 6177 456c 656d        glDrawElem
-00023ad0: 656e 7473 2847 4c5f 5452 4941 4e47 4c45  ents(GL_TRIANGLE
-00023ae0: 532c 2073 655f 6672 616d 652e 7175 6164  S, se_frame.quad
-00023af0: 5f76 612e 696e 6465 7842 7566 6665 722e  _va.indexBuffer.
-00023b00: 6765 7443 6f75 6e74 2829 2c20 474c 5f55  getCount(), GL_U
-00023b10: 4e53 4947 4e45 445f 5348 4f52 542c 204e  NSIGNED_SHORT, N
-00023b20: 6f6e 6529 0d0a 2020 2020 2020 2020 7365  one)..        se
-00023b30: 6c66 2e71 7561 645f 7368 6164 6572 2e75  lf.quad_shader.u
-00023b40: 6e62 696e 6428 290d 0a20 2020 2020 2020  nbind()..       
-00023b50: 2073 655f 6672 616d 652e 7175 6164 5f76   se_frame.quad_v
-00023b60: 612e 756e 6269 6e64 2829 0d0a 2020 2020  a.unbind()..    
-00023b70: 2020 2020 676c 4163 7469 7665 5465 7874      glActiveText
-00023b80: 7572 6528 474c 5f54 4558 5455 5245 3029  ure(GL_TEXTURE0)
-00023b90: 0d0a 2020 2020 2020 2020 7365 6c66 2e66  ..        self.f
-00023ba0: 626f 312e 756e 6269 6e64 2829 0d0a 2020  bo1.unbind()..  
-00023bb0: 2020 2020 2020 7769 6e64 6f77 2e73 6574        window.set
-00023bc0: 5f66 756c 6c5f 7669 6577 706f 7274 2829  _full_viewport()
-00023bd0: 0d0a 0d0a 2020 2020 2020 2020 2320 6669  ....        # fi
-00023be0: 6c74 6572 2066 7261 6d65 6275 6666 6572  lter framebuffer
-00023bf0: 202d 2062 7574 206f 6e6c 7920 6966 2074   - but only if t
-00023c00: 6865 2053 6567 6d65 6e74 6174 696f 6e45  he SegmentationE
-00023c10: 6469 746f 7220 7361 7973 2074 6861 7420  ditor says that 
-00023c20: 7468 6520 696d 6167 6520 6e65 6564 7320  the image needs 
-00023c30: 7570 6461 7469 6e67 210d 0a20 2020 2020  updating!..     
-00023c40: 2020 2069 6620 5365 676d 656e 7461 7469     if Segmentati
-00023c50: 6f6e 4564 6974 6f72 2e46 5241 4d45 5f54  onEditor.FRAME_T
-00023c60: 4558 5455 5245 5f52 4551 5549 5245 535f  EXTURE_REQUIRES_
-00023c70: 5550 4441 5445 3a0d 0a20 2020 2020 2020  UPDATE:..       
-00023c80: 2020 2020 2073 656c 662e 6b65 726e 656c       self.kernel
-00023c90: 5f66 696c 7465 722e 6269 6e64 2829 0d0a  _filter.bind()..
-00023ca0: 2020 2020 2020 2020 2020 2020 636f 6d70              comp
-00023cb0: 7574 655f 7369 7a65 203d 2028 696e 7428  ute_size = (int(
-00023cc0: 6e70 2e63 6569 6c28 7365 5f66 7261 6d65  np.ceil(se_frame
-00023cd0: 2e77 6964 7468 202f 2031 3629 292c 2069  .width / 16)), i
-00023ce0: 6e74 286e 702e 6365 696c 2873 655f 6672  nt(np.ceil(se_fr
-00023cf0: 616d 652e 6865 6967 6874 202f 2031 3629  ame.height / 16)
-00023d00: 292c 2031 290d 0a20 2020 2020 2020 2020  ), 1)..         
-00023d10: 2020 2066 6f72 2066 6c74 7220 696e 2066     for fltr in f
-00023d20: 696c 7465 7273 3a0d 0a20 2020 2020 2020  ilters:..       
-00023d30: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
-00023d40: 666c 7472 2e65 6e61 626c 6564 3a0d 0a20  fltr.enabled:.. 
-00023d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023d60: 2020 2063 6f6e 7469 6e75 650d 0a20 2020     continue..   
-00023d70: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00023d80: 662e 6b65 726e 656c 5f66 696c 7465 722e  f.kernel_filter.
-00023d90: 6269 6e64 2829 0d0a 0d0a 2020 2020 2020  bind()....      
-00023da0: 2020 2020 2020 2020 2020 2320 686f 7269            # hori
-00023db0: 7a6f 6e74 616c 2073 6861 6465 7220 7061  zontal shader pa
-00023dc0: 7373 0d0a 2020 2020 2020 2020 2020 2020  ss..            
-00023dd0: 2020 2020 666c 7472 2e62 696e 6428 686f      fltr.bind(ho
-00023de0: 7269 7a6f 6e74 616c 3d54 7275 6529 0d0a  rizontal=True)..
-00023df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023e00: 676c 4269 6e64 496d 6167 6554 6578 7475  glBindImageTextu
-00023e10: 7265 2830 2c20 7365 6c66 2e66 626f 312e  re(0, self.fbo1.
-00023e20: 7465 7874 7572 652e 7265 6e64 6572 6572  texture.renderer
-00023e30: 5f69 642c 2030 2c20 474c 5f46 414c 5345  _id, 0, GL_FALSE
-00023e40: 2c20 302c 2047 4c5f 5245 4144 5f4f 4e4c  , 0, GL_READ_ONL
-00023e50: 592c 2047 4c5f 5247 4241 3332 4629 0d0a  Y, GL_RGBA32F)..
-00023e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023e70: 676c 4269 6e64 496d 6167 6554 6578 7475  glBindImageTextu
-00023e80: 7265 2831 2c20 7365 6c66 2e66 626f 322e  re(1, self.fbo2.
-00023e90: 7465 7874 7572 652e 7265 6e64 6572 6572  texture.renderer
-00023ea0: 5f69 642c 2030 2c20 474c 5f46 414c 5345  _id, 0, GL_FALSE
-00023eb0: 2c20 302c 2047 4c5f 5752 4954 455f 4f4e  , 0, GL_WRITE_ON
-00023ec0: 4c59 2c20 474c 5f52 4742 4133 3246 290d  LY, GL_RGBA32F).
-00023ed0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00023ee0: 2073 656c 662e 6b65 726e 656c 5f66 696c   self.kernel_fil
-00023ef0: 7465 722e 756e 6966 6f72 6d31 6928 2264  ter.uniform1i("d
-00023f00: 6972 6563 7469 6f6e 222c 2030 290d 0a20  irection", 0).. 
-00023f10: 2020 2020 2020 2020 2020 2020 2020 2067                 g
-00023f20: 6c44 6973 7061 7463 6843 6f6d 7075 7465  lDispatchCompute
-00023f30: 282a 636f 6d70 7574 655f 7369 7a65 290d  (*compute_size).
-00023f40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00023f50: 2067 6c4d 656d 6f72 7942 6172 7269 6572   glMemoryBarrier
-00023f60: 2847 4c5f 5348 4144 4552 5f49 4d41 4745  (GL_SHADER_IMAGE
-00023f70: 5f41 4343 4553 535f 4241 5252 4945 525f  _ACCESS_BARRIER_
-00023f80: 4249 5429 0d0a 0d0a 2020 2020 2020 2020  BIT)....        
-00023f90: 2020 2020 2020 2020 2320 7665 7274 6963          # vertic
-00023fa0: 616c 2073 6861 6465 7220 7061 7373 0d0a  al shader pass..
-00023fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023fc0: 666c 7472 2e62 696e 6428 686f 7269 7a6f  fltr.bind(horizo
-00023fd0: 6e74 616c 3d46 616c 7365 290d 0a20 2020  ntal=False)..   
-00023fe0: 2020 2020 2020 2020 2020 2020 2067 6c42               glB
-00023ff0: 696e 6449 6d61 6765 5465 7874 7572 6528  indImageTexture(
-00024000: 302c 2073 656c 662e 6662 6f32 2e74 6578  0, self.fbo2.tex
-00024010: 7475 7265 2e72 656e 6465 7265 725f 6964  ture.renderer_id
-00024020: 2c20 302c 2047 4c5f 4641 4c53 452c 2030  , 0, GL_FALSE, 0
-00024030: 2c20 474c 5f52 4541 445f 4f4e 4c59 2c20  , GL_READ_ONLY, 
-00024040: 474c 5f52 4742 4133 3246 290d 0a20 2020  GL_RGBA32F)..   
-00024050: 2020 2020 2020 2020 2020 2020 2067 6c42               glB
-00024060: 696e 6449 6d61 6765 5465 7874 7572 6528  indImageTexture(
-00024070: 312c 2073 656c 662e 6662 6f33 2e74 6578  1, self.fbo3.tex
-00024080: 7475 7265 2e72 656e 6465 7265 725f 6964  ture.renderer_id
-00024090: 2c20 302c 2047 4c5f 4641 4c53 452c 2030  , 0, GL_FALSE, 0
-000240a0: 2c20 474c 5f57 5249 5445 5f4f 4e4c 592c  , GL_WRITE_ONLY,
-000240b0: 2047 4c5f 5247 4241 3332 4629 0d0a 2020   GL_RGBA32F)..  
-000240c0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-000240d0: 6c66 2e6b 6572 6e65 6c5f 6669 6c74 6572  lf.kernel_filter
-000240e0: 2e75 6e69 666f 726d 3169 2822 6469 7265  .uniform1i("dire
-000240f0: 6374 696f 6e22 2c20 3129 0d0a 2020 2020  ction", 1)..    
-00024100: 2020 2020 2020 2020 2020 2020 676c 4469              glDi
-00024110: 7370 6174 6368 436f 6d70 7574 6528 2a63  spatchCompute(*c
-00024120: 6f6d 7075 7465 5f73 697a 6529 0d0a 2020  ompute_size)..  
-00024130: 2020 2020 2020 2020 2020 2020 2020 676c                gl
-00024140: 4d65 6d6f 7279 4261 7272 6965 7228 474c  MemoryBarrier(GL
-00024150: 5f53 4841 4445 525f 494d 4147 455f 4143  _SHADER_IMAGE_AC
-00024160: 4345 5353 5f42 4152 5249 4552 5f42 4954  CESS_BARRIER_BIT
-00024170: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00024180: 2020 2066 6c74 722e 756e 6269 6e64 2829     fltr.unbind()
-00024190: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000241a0: 2020 7365 6c66 2e6b 6572 6e65 6c5f 6669    self.kernel_fi
-000241b0: 6c74 6572 2e75 6e62 696e 6428 290d 0a0d  lter.unbind()...
-000241c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000241d0: 2023 206d 6978 2074 6865 2066 696c 7465   # mix the filte
-000241e0: 7265 6420 616e 6420 7468 6520 6f72 6967  red and the orig
-000241f0: 696e 616c 2069 6d61 6765 0d0a 2020 2020  inal image..    
-00024200: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00024210: 2e6d 6978 5f66 696c 7465 7265 642e 6269  .mix_filtered.bi
-00024220: 6e64 2829 0d0a 2020 2020 2020 2020 2020  nd()..          
-00024230: 2020 2020 2020 676c 4269 6e64 496d 6167        glBindImag
-00024240: 6554 6578 7475 7265 2830 2c20 7365 6c66  eTexture(0, self
-00024250: 2e66 626f 332e 7465 7874 7572 652e 7265  .fbo3.texture.re
-00024260: 6e64 6572 6572 5f69 642c 2030 2c20 474c  nderer_id, 0, GL
-00024270: 5f46 414c 5345 2c20 302c 2047 4c5f 5245  _FALSE, 0, GL_RE
-00024280: 4144 5f4f 4e4c 592c 2047 4c5f 5247 4241  AD_ONLY, GL_RGBA
-00024290: 3332 4629 0d0a 2020 2020 2020 2020 2020  32F)..          
-000242a0: 2020 2020 2020 676c 4269 6e64 496d 6167        glBindImag
-000242b0: 6554 6578 7475 7265 2831 2c20 7365 6c66  eTexture(1, self
-000242c0: 2e66 626f 312e 7465 7874 7572 652e 7265  .fbo1.texture.re
-000242d0: 6e64 6572 6572 5f69 642c 2030 2c20 474c  nderer_id, 0, GL
-000242e0: 5f46 414c 5345 2c20 302c 2047 4c5f 5245  _FALSE, 0, GL_RE
-000242f0: 4144 5f57 5249 5445 2c20 474c 5f52 4742  AD_WRITE, GL_RGB
-00024300: 4133 3246 290d 0a20 2020 2020 2020 2020  A32F)..         
-00024310: 2020 2020 2020 2073 656c 662e 6d69 785f         self.mix_
-00024320: 6669 6c74 6572 6564 2e75 6e69 666f 726d  filtered.uniform
-00024330: 3166 2822 7374 7265 6e67 7468 222c 2066  1f("strength", f
-00024340: 6c74 722e 7374 7265 6e67 7468 290d 0a20  ltr.strength).. 
-00024350: 2020 2020 2020 2020 2020 2020 2020 2067                 g
-00024360: 6c44 6973 7061 7463 6843 6f6d 7075 7465  lDispatchCompute
-00024370: 282a 636f 6d70 7574 655f 7369 7a65 290d  (*compute_size).
-00024380: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00024390: 2067 6c4d 656d 6f72 7942 6172 7269 6572   glMemoryBarrier
-000243a0: 2847 4c5f 5348 4144 4552 5f49 4d41 4745  (GL_SHADER_IMAGE
-000243b0: 5f41 4343 4553 535f 4241 5252 4945 525f  _ACCESS_BARRIER_
-000243c0: 4249 5429 0d0a 2020 2020 2020 2020 2020  BIT)..          
-000243d0: 2020 2020 2020 7365 6c66 2e6d 6978 5f66        self.mix_f
-000243e0: 696c 7465 7265 642e 756e 6269 6e64 2829  iltered.unbind()
-000243f0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-00024400: 2320 7570 6461 7465 2068 6973 746f 6772  # update histogr
-00024410: 616d 0d0a 2020 2020 2020 2020 2020 2020  am..            
-00024420: 7365 6c66 2e66 626f 312e 6269 6e64 2829  self.fbo1.bind()
-00024430: 0d0a 2020 2020 2020 2020 2020 2020 7078  ..            px
-00024440: 6420 3d20 676c 5265 6164 5069 7865 6c73  d = glReadPixels
-00024450: 2830 2c20 302c 2073 656c 662e 6662 6f31  (0, 0, self.fbo1
-00024460: 2e77 6964 7468 2c20 7365 6c66 2e66 626f  .width, self.fbo
-00024470: 312e 6865 6967 6874 2c20 474c 5f52 4544  1.height, GL_RED
-00024480: 2c20 474c 5f46 4c4f 4154 290d 0a20 2020  , GL_FLOAT)..   
-00024490: 2020 2020 2020 2020 2070 7864 203d 206e           pxd = n
-000244a0: 702e 6672 6f6d 6275 6666 6572 2870 7864  p.frombuffer(pxd
-000244b0: 2c20 6e70 2e66 6c6f 6174 3332 292e 7265  , np.float32).re
-000244c0: 7368 6170 6528 7365 6c66 2e66 626f 312e  shape(self.fbo1.
-000244d0: 6865 6967 6874 2c20 7365 6c66 2e66 626f  height, self.fbo
-000244e0: 312e 7769 6474 6829 0d0a 2020 2020 2020  1.width)..      
-000244f0: 2020 2020 2020 7365 6c66 2e66 626f 312e        self.fbo1.
-00024500: 756e 6269 6e64 2829 0d0a 2020 2020 2020  unbind()..      
-00024510: 2020 2020 2020 7769 6e64 6f77 2e73 6574        window.set
-00024520: 5f66 756c 6c5f 7669 6577 706f 7274 2829  _full_viewport()
-00024530: 0d0a 0d0a 2020 2020 2020 2020 2320 7265  ....        # re
-00024540: 6e64 6572 2074 6865 2066 7261 6d65 6275  nder the framebu
-00024550: 6666 6572 2074 6f20 7468 6520 7363 7265  ffer to the scre
-00024560: 656e 0d0a 2020 2020 2020 2020 7368 6164  en..        shad
-00024570: 6572 203d 2073 656c 662e 7175 6164 5f73  er = self.quad_s
-00024580: 6861 6465 7220 6966 206e 6f74 2063 616d  hader if not cam
-00024590: 6572 6133 6420 656c 7365 2073 656c 662e  era3d else self.
-000245a0: 7175 6164 5f33 645f 7368 6164 6572 0d0a  quad_3d_shader..
-000245b0: 2020 2020 2020 2020 7670 6d61 7420 3d20          vpmat = 
-000245c0: 6361 6d65 7261 2e76 6965 775f 7072 6f6a  camera.view_proj
-000245d0: 6563 7469 6f6e 5f6d 6174 7269 7820 6966  ection_matrix if
-000245e0: 206e 6f74 2063 616d 6572 6133 6420 656c   not camera3d el
-000245f0: 7365 2063 616d 6572 6133 642e 6d61 7472  se camera3d.matr
-00024600: 6978 0d0a 2020 2020 2020 2020 7368 6164  ix..        shad
-00024610: 6572 2e62 696e 6428 290d 0a20 2020 2020  er.bind()..     
-00024620: 2020 2073 655f 6672 616d 652e 7175 6164     se_frame.quad
-00024630: 5f76 612e 6269 6e64 2829 0d0a 2020 2020  _va.bind()..    
-00024640: 2020 2020 7365 6c66 2e66 626f 312e 7465      self.fbo1.te
-00024650: 7874 7572 652e 6269 6e64 2830 290d 0a20  xture.bind(0).. 
-00024660: 2020 2020 2020 2073 6861 6465 722e 756e         shader.un
-00024670: 6966 6f72 6d6d 6174 3428 2263 616d 6572  iformmat4("camer
-00024680: 614d 6174 7269 7822 2c20 7670 6d61 7429  aMatrix", vpmat)
-00024690: 0d0a 2020 2020 2020 2020 7368 6164 6572  ..        shader
-000246a0: 2e75 6e69 666f 726d 6d61 7434 2822 6d6f  .uniformmat4("mo
-000246b0: 6465 6c4d 6174 7269 7822 2c20 7365 5f66  delMatrix", se_f
-000246c0: 7261 6d65 2e74 7261 6e73 666f 726d 2e6d  rame.transform.m
-000246d0: 6174 7269 7829 0d0a 2020 2020 2020 2020  atrix)..        
-000246e0: 6372 6f70 5f78 5f6c 696d 7320 3d20 5b73  crop_x_lims = [s
-000246f0: 655f 6672 616d 652e 6372 6f70 5f72 6f69  e_frame.crop_roi
-00024700: 5b30 5d20 2f20 7365 5f66 7261 6d65 2e77  [0] / se_frame.w
-00024710: 6964 7468 2c20 312e 3020 2d20 2873 655f  idth, 1.0 - (se_
-00024720: 6672 616d 652e 7769 6474 6820 2d20 7365  frame.width - se
-00024730: 5f66 7261 6d65 2e63 726f 705f 726f 695b  _frame.crop_roi[
-00024740: 325d 2920 2f20 7365 5f66 7261 6d65 2e77  2]) / se_frame.w
-00024750: 6964 7468 5d0d 0a20 2020 2020 2020 2063  idth]..        c
-00024760: 726f 705f 795f 6c69 6d73 203d 205b 2873  rop_y_lims = [(s
-00024770: 655f 6672 616d 652e 6865 6967 6874 202d  e_frame.height -
-00024780: 2073 655f 6672 616d 652e 6372 6f70 5f72   se_frame.crop_r
-00024790: 6f69 5b33 5d29 202f 2073 655f 6672 616d  oi[3]) / se_fram
-000247a0: 652e 6865 6967 6874 2c20 312e 3020 2d20  e.height, 1.0 - 
-000247b0: 7365 5f66 7261 6d65 2e63 726f 705f 726f  se_frame.crop_ro
-000247c0: 695b 315d 202f 2073 655f 6672 616d 652e  i[1] / se_frame.
-000247d0: 6865 6967 6874 5d0d 0a20 2020 2020 2020  height]..       
-000247e0: 2069 6620 6f76 6572 7269 6465 5f63 6f6e   if override_con
-000247f0: 7472 6173 745f 726f 693a 0d0a 2020 2020  trast_roi:..    
-00024800: 2020 2020 2020 2020 6372 6f70 5f78 5f6c          crop_x_l
-00024810: 696d 7320 3d20 5b30 2c20 315d 0d0a 2020  ims = [0, 1]..  
-00024820: 2020 2020 2020 2020 2020 6372 6f70 5f79            crop_y
-00024830: 5f6c 696d 7320 3d20 5b30 2c20 315d 0d0a  _lims = [0, 1]..
-00024840: 2020 2020 2020 2020 7368 6164 6572 2e75          shader.u
-00024850: 6e69 666f 726d 3266 2822 784c 696d 7322  niform2f("xLims"
-00024860: 2c20 6372 6f70 5f78 5f6c 696d 7329 0d0a  , crop_x_lims)..
-00024870: 2020 2020 2020 2020 7368 6164 6572 2e75          shader.u
-00024880: 6e69 666f 726d 3266 2822 794c 696d 7322  niform2f("yLims"
-00024890: 2c20 6372 6f70 5f79 5f6c 696d 7329 0d0a  , crop_y_lims)..
-000248a0: 2020 2020 2020 2020 7368 6164 6572 2e75          shader.u
-000248b0: 6e69 666f 726d 3166 2822 616c 7068 6122  niform1f("alpha"
-000248c0: 2c20 7365 5f66 7261 6d65 2e61 6c70 6861  , se_frame.alpha
-000248d0: 2069 6620 6361 6d65 7261 3364 2069 7320   if camera3d is 
-000248e0: 4e6f 6e65 2065 6c73 6520 5365 676d 656e  None else Segmen
-000248f0: 7461 7469 6f6e 4564 6974 6f72 2e50 4943  tationEditor.PIC
-00024900: 4b49 4e47 5f46 5241 4d45 5f41 4c50 4841  KING_FRAME_ALPHA
-00024910: 290d 0a20 2020 2020 2020 2069 6620 6361  )..        if ca
-00024920: 6d65 7261 3364 2069 7320 6e6f 7420 4e6f  mera3d is not No
-00024930: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
-00024940: 2067 6c45 6e61 626c 6528 474c 5f44 4550   glEnable(GL_DEP
-00024950: 5448 5f54 4553 5429 0d0a 2020 2020 2020  TH_TEST)..      
-00024960: 2020 2020 2020 7368 6164 6572 2e75 6e69        shader.uni
-00024970: 666f 726d 3166 2822 7a5f 706f 7322 2c20  form1f("z_pos", 
-00024980: 2873 655f 6672 616d 652e 6375 7272 656e  (se_frame.curren
-00024990: 745f 736c 6963 6520 2d20 7365 5f66 7261  t_slice - se_fra
-000249a0: 6d65 2e6e 5f73 6c69 6365 7320 2f20 3229  me.n_slices / 2)
-000249b0: 202a 2073 655f 6672 616d 652e 7069 7865   * se_frame.pixe
-000249c0: 6c5f 7369 7a65 290d 0a20 2020 2020 2020  l_size)..       
-000249d0: 2020 2020 2073 6861 6465 722e 756e 6966       shader.unif
-000249e0: 6f72 6d31 6628 2270 6978 656c 5f73 697a  orm1f("pixel_siz
-000249f0: 6522 2c20 7365 5f66 7261 6d65 2e70 6978  e", se_frame.pix
-00024a00: 656c 5f73 697a 6529 2020 2320 5468 6973  el_size)  # This
-00024a10: 2066 6163 746f 7220 7368 6f75 6c64 2062   factor should b
-00024a20: 6520 696e 2074 6865 2056 412c 2062 7574  e in the VA, but
-00024a30: 2066 6978 696e 6720 7468 6174 206d 6573   fixing that mes
-00024a40: 7365 6420 7570 2074 6865 2032 4420 7669  sed up the 2D vi
-00024a50: 6577 202d 2063 6865 6170 2066 6978 2066  ew - cheap fix f
-00024a60: 6f72 206e 6f77 0d0a 2020 2020 2020 2020  or now..        
-00024a70: 6966 2073 655f 6672 616d 652e 696e 7665  if se_frame.inve
-00024a80: 7274 3a0d 0a20 2020 2020 2020 2020 2020  rt:..           
-00024a90: 2073 6861 6465 722e 756e 6966 6f72 6d31   shader.uniform1
-00024aa0: 6628 2263 6f6e 7472 6173 744d 696e 222c  f("contrastMin",
-00024ab0: 2073 655f 6672 616d 652e 636f 6e74 7261   se_frame.contra
-00024ac0: 7374 5f6c 696d 735b 315d 290d 0a20 2020  st_lims[1])..   
-00024ad0: 2020 2020 2020 2020 2073 6861 6465 722e           shader.
-00024ae0: 756e 6966 6f72 6d31 6628 2263 6f6e 7472  uniform1f("contr
-00024af0: 6173 744d 6178 222c 2073 655f 6672 616d  astMax", se_fram
-00024b00: 652e 636f 6e74 7261 7374 5f6c 696d 735b  e.contrast_lims[
-00024b10: 305d 290d 0a20 2020 2020 2020 2065 6c73  0])..        els
-00024b20: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00024b30: 7368 6164 6572 2e75 6e69 666f 726d 3166  shader.uniform1f
-00024b40: 2822 636f 6e74 7261 7374 4d69 6e22 2c20  ("contrastMin", 
-00024b50: 7365 5f66 7261 6d65 2e63 6f6e 7472 6173  se_frame.contras
-00024b60: 745f 6c69 6d73 5b30 5d29 0d0a 2020 2020  t_lims[0])..    
-00024b70: 2020 2020 2020 2020 7368 6164 6572 2e75          shader.u
-00024b80: 6e69 666f 726d 3166 2822 636f 6e74 7261  niform1f("contra
-00024b90: 7374 4d61 7822 2c20 7365 5f66 7261 6d65  stMax", se_frame
-00024ba0: 2e63 6f6e 7472 6173 745f 6c69 6d73 5b31  .contrast_lims[1
-00024bb0: 5d29 0d0a 2020 2020 2020 2020 676c 4472  ])..        glDr
-00024bc0: 6177 456c 656d 656e 7473 2847 4c5f 5452  awElements(GL_TR
-00024bd0: 4941 4e47 4c45 532c 2073 655f 6672 616d  IANGLES, se_fram
-00024be0: 652e 7175 6164 5f76 612e 696e 6465 7842  e.quad_va.indexB
-00024bf0: 7566 6665 722e 6765 7443 6f75 6e74 2829  uffer.getCount()
-00024c00: 2c20 474c 5f55 4e53 4947 4e45 445f 5348  , GL_UNSIGNED_SH
-00024c10: 4f52 542c 204e 6f6e 6529 0d0a 2020 2020  ORT, None)..    
-00024c20: 2020 2020 7368 6164 6572 2e75 6e62 696e      shader.unbin
-00024c30: 6428 290d 0a20 2020 2020 2020 2073 655f  d()..        se_
-00024c40: 6672 616d 652e 7175 6164 5f76 612e 756e  frame.quad_va.un
-00024c50: 6269 6e64 2829 0d0a 2020 2020 2020 2020  bind()..        
-00024c60: 676c 4163 7469 7665 5465 7874 7572 6528  glActiveTexture(
-00024c70: 474c 5f54 4558 5455 5245 3029 0d0a 2020  GL_TEXTURE0)..  
-00024c80: 2020 2020 2020 6966 2063 616d 6572 6133        if camera3
-00024c90: 6420 6973 206e 6f74 204e 6f6e 653a 0d0a  d is not None:..
-00024ca0: 2020 2020 2020 2020 2020 2020 676c 4469              glDi
-00024cb0: 7361 626c 6528 474c 5f44 4550 5448 5f54  sable(GL_DEPTH_T
-00024cc0: 4553 5429 0d0a 2020 2020 2020 2020 7265  EST)..        re
-00024cd0: 7475 726e 2070 7864 0d0a 0d0a 2020 2020  turn pxd....    
-00024ce0: 6465 6620 7265 6e64 6572 5f6d 6f64 656c  def render_model
-00024cf0: 7328 7365 6c66 2c20 7365 5f66 7261 6d65  s(self, se_frame
-00024d00: 2c20 6361 6d65 7261 293a 0d0a 2020 2020  , camera):..    
-00024d10: 2020 2020 2320 7265 6e64 6572 206f 7665      # render ove
-00024d20: 726c 6179 7320 2866 726f 6d20 6d6f 6465  rlays (from mode
-00024d30: 6c73 290d 0a20 2020 2020 2020 2073 655f  ls)..        se_
-00024d40: 6672 616d 652e 7175 6164 5f76 612e 6269  frame.quad_va.bi
-00024d50: 6e64 2829 0d0a 2020 2020 2020 2020 7365  nd()..        se
-00024d60: 6c66 2e66 5f73 6567 6d65 6e74 6174 696f  lf.f_segmentatio
-00024d70: 6e5f 7368 6164 6572 2e62 696e 6428 290d  n_shader.bind().
-00024d80: 0a20 2020 2020 2020 2073 656c 662e 665f  .        self.f_
-00024d90: 7365 676d 656e 7461 7469 6f6e 5f73 6861  segmentation_sha
-00024da0: 6465 722e 756e 6966 6f72 6d6d 6174 3428  der.uniformmat4(
-00024db0: 2263 616d 6572 614d 6174 7269 7822 2c20  "cameraMatrix", 
-00024dc0: 6361 6d65 7261 2e76 6965 775f 7072 6f6a  camera.view_proj
-00024dd0: 6563 7469 6f6e 5f6d 6174 7269 7829 0d0a  ection_matrix)..
-00024de0: 2020 2020 2020 2020 7365 6c66 2e66 5f73          self.f_s
-00024df0: 6567 6d65 6e74 6174 696f 6e5f 7368 6164  egmentation_shad
-00024e00: 6572 2e75 6e69 666f 726d 6d61 7434 2822  er.uniformmat4("
-00024e10: 6d6f 6465 6c4d 6174 7269 7822 2c20 7365  modelMatrix", se
-00024e20: 5f66 7261 6d65 2e74 7261 6e73 666f 726d  _frame.transform
-00024e30: 2e6d 6174 7269 7829 0d0a 2020 2020 2020  .matrix)..      
-00024e40: 2020 7265 6e64 6572 5f6c 6973 7420 3d20    render_list = 
-00024e50: 636f 7079 2863 6667 2e73 655f 6d6f 6465  copy(cfg.se_mode
-00024e60: 6c73 290d 0a20 2020 2020 2020 2069 6620  ls)..        if 
-00024e70: 6366 672e 7365 5f61 6374 6976 655f 6d6f  cfg.se_active_mo
-00024e80: 6465 6c20 696e 2072 656e 6465 725f 6c69  del in render_li
-00024e90: 7374 3a0d 0a20 2020 2020 2020 2020 2020  st:..           
-00024ea0: 2072 656e 6465 725f 6c69 7374 2e72 656d   render_list.rem
-00024eb0: 6f76 6528 6366 672e 7365 5f61 6374 6976  ove(cfg.se_activ
-00024ec0: 655f 6d6f 6465 6c29 0d0a 2020 2020 2020  e_model)..      
-00024ed0: 2020 2020 2020 7265 6e64 6572 5f6c 6973        render_lis
-00024ee0: 742e 6170 7065 6e64 2863 6667 2e73 655f  t.append(cfg.se_
-00024ef0: 6163 7469 7665 5f6d 6f64 656c 290d 0a20  active_model).. 
-00024f00: 2020 2020 2020 2066 6f72 206d 6f64 656c         for model
-00024f10: 2069 6e20 7265 6e64 6572 5f6c 6973 743a   in render_list:
-00024f20: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-00024f30: 206e 6f74 206d 6f64 656c 2e61 6374 6976   not model.activ
-00024f40: 6520 6f72 206e 6f74 206d 6f64 656c 2e73  e or not model.s
-00024f50: 686f 773a 0d0a 2020 2020 2020 2020 2020  how:..          
-00024f60: 2020 2020 2020 636f 6e74 696e 7565 0d0a        continue..
-00024f70: 2020 2020 2020 2020 2020 2020 6966 206d              if m
-00024f80: 6f64 656c 2e64 6174 6120 6973 204e 6f6e  odel.data is Non
-00024f90: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00024fa0: 2020 2020 636f 6e74 696e 7565 0d0a 2020      continue..  
-00024fb0: 2020 2020 2020 2020 2020 6966 206d 6f64            if mod
-00024fc0: 656c 2e62 6c65 6e64 3a0d 0a20 2020 2020  el.blend:..     
-00024fd0: 2020 2020 2020 2020 2020 2067 6c42 6c65             glBle
-00024fe0: 6e64 4675 6e63 2847 4c5f 4453 545f 434f  ndFunc(GL_DST_CO
-00024ff0: 4c4f 522c 2047 4c5f 4453 545f 414c 5048  LOR, GL_DST_ALPH
-00025000: 4129 0d0a 2020 2020 2020 2020 2020 2020  A)..            
-00025010: 2020 2020 676c 426c 656e 6445 7175 6174      glBlendEquat
-00025020: 696f 6e28 474c 5f46 554e 435f 4144 4429  ion(GL_FUNC_ADD)
-00025030: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
-00025040: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-00025050: 2020 2020 2067 6c42 6c65 6e64 4675 6e63       glBlendFunc
-00025060: 2847 4c5f 5352 435f 414c 5048 412c 2047  (GL_SRC_ALPHA, G
-00025070: 4c5f 4f4e 455f 4d49 4e55 535f 5352 435f  L_ONE_MINUS_SRC_
-00025080: 414c 5048 4129 0d0a 2020 2020 2020 2020  ALPHA)..        
-00025090: 2020 2020 2020 2020 676c 426c 656e 6445          glBlendE
-000250a0: 7175 6174 696f 6e28 474c 5f46 554e 435f  quation(GL_FUNC_
-000250b0: 4144 4429 0d0a 2020 2020 2020 2020 2020  ADD)..          
-000250c0: 2020 7365 6c66 2e66 5f73 6567 6d65 6e74    self.f_segment
-000250d0: 6174 696f 6e5f 7368 6164 6572 2e75 6e69  ation_shader.uni
-000250e0: 666f 726d 3166 2822 616c 7068 6122 2c20  form1f("alpha", 
-000250f0: 6d6f 6465 6c2e 616c 7068 6129 0d0a 2020  model.alpha)..  
-00025100: 2020 2020 2020 2020 2020 636c 7220 3d20            clr = 
-00025110: 6d6f 6465 6c2e 636f 6c6f 7572 0d0a 2020  model.colour..  
-00025120: 2020 2020 2020 2020 2020 616c 7068 6120            alpha 
-00025130: 3d20 6d6f 6465 6c2e 616c 7068 610d 0a20  = model.alpha.. 
-00025140: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00025150: 665f 7365 676d 656e 7461 7469 6f6e 5f73  f_segmentation_s
-00025160: 6861 6465 722e 756e 6966 6f72 6d33 6628  hader.uniform3f(
-00025170: 2263 6f6c 6f75 7222 2c20 2863 6c72 5b30  "colour", (clr[0
-00025180: 5d20 2a20 616c 7068 612c 2063 6c72 5b31  ] * alpha, clr[1
-00025190: 5d20 2a20 616c 7068 612c 2063 6c72 5b32  ] * alpha, clr[2
-000251a0: 5d20 2a20 616c 7068 6129 290d 0a20 2020  ] * alpha))..   
-000251b0: 2020 2020 2020 2020 2073 656c 662e 665f           self.f_
-000251c0: 7365 676d 656e 7461 7469 6f6e 5f73 6861  segmentation_sha
-000251d0: 6465 722e 756e 6966 6f72 6d31 6628 2274  der.uniform1f("t
-000251e0: 6872 6573 686f 6c64 222c 206d 6f64 656c  hreshold", model
-000251f0: 2e74 6872 6573 686f 6c64 290d 0a20 2020  .threshold)..   
-00025200: 2020 2020 2020 2020 206d 6f64 656c 2e74           model.t
-00025210: 6578 7475 7265 2e62 696e 6428 3029 0d0a  exture.bind(0)..
-00025220: 2020 2020 2020 2020 2020 2020 676c 4472              glDr
-00025230: 6177 456c 656d 656e 7473 2847 4c5f 5452  awElements(GL_TR
-00025240: 4941 4e47 4c45 532c 2073 655f 6672 616d  IANGLES, se_fram
-00025250: 652e 7175 6164 5f76 612e 696e 6465 7842  e.quad_va.indexB
-00025260: 7566 6665 722e 6765 7443 6f75 6e74 2829  uffer.getCount()
-00025270: 2c20 474c 5f55 4e53 4947 4e45 445f 5348  , GL_UNSIGNED_SH
-00025280: 4f52 542c 204e 6f6e 6529 0d0a 2020 2020  ORT, None)..    
-00025290: 2020 2020 7365 5f66 7261 6d65 2e71 7561      se_frame.qua
-000252a0: 645f 7661 2e75 6e62 696e 6428 290d 0a20  d_va.unbind().. 
-000252b0: 2020 2020 2020 2073 656c 662e 665f 7365         self.f_se
-000252c0: 676d 656e 7461 7469 6f6e 5f73 6861 6465  gmentation_shade
-000252d0: 722e 756e 6269 6e64 2829 0d0a 2020 2020  r.unbind()..    
-000252e0: 2020 2020 676c 4163 7469 7665 5465 7874      glActiveText
-000252f0: 7572 6528 474c 5f54 4558 5455 5245 3029  ure(GL_TEXTURE0)
-00025300: 0d0a 0d0a 2020 2020 2020 2020 2320 7265  ....        # re
-00025310: 6e64 6572 2062 6f72 6465 720d 0a20 2020  nder border..   
-00025320: 2020 2020 2067 6c42 6c65 6e64 4675 6e63       glBlendFunc
-00025330: 2847 4c5f 5352 435f 414c 5048 412c 2047  (GL_SRC_ALPHA, G
-00025340: 4c5f 4f4e 455f 4d49 4e55 535f 5352 435f  L_ONE_MINUS_SRC_
-00025350: 414c 5048 4129 0d0a 2020 2020 2020 2020  ALPHA)..        
-00025360: 676c 426c 656e 6445 7175 6174 696f 6e28  glBlendEquation(
-00025370: 474c 5f46 554e 435f 4144 4429 0d0a 2020  GL_FUNC_ADD)..  
-00025380: 2020 2020 2020 7365 6c66 2e62 6f72 6465        self.borde
-00025390: 725f 7368 6164 6572 2e62 696e 6428 290d  r_shader.bind().
-000253a0: 0a20 2020 2020 2020 2073 655f 6672 616d  .        se_fram
-000253b0: 652e 626f 7264 6572 5f76 612e 6269 6e64  e.border_va.bind
-000253c0: 2829 0d0a 2020 2020 2020 2020 7365 6c66  ()..        self
-000253d0: 2e62 6f72 6465 725f 7368 6164 6572 2e75  .border_shader.u
-000253e0: 6e69 666f 726d 6d61 7434 2822 6361 6d65  niformmat4("came
-000253f0: 7261 4d61 7472 6978 222c 2063 616d 6572  raMatrix", camer
-00025400: 612e 7669 6577 5f70 726f 6a65 6374 696f  a.view_projectio
-00025410: 6e5f 6d61 7472 6978 290d 0a20 2020 2020  n_matrix)..     
-00025420: 2020 2073 656c 662e 626f 7264 6572 5f73     self.border_s
-00025430: 6861 6465 722e 756e 6966 6f72 6d6d 6174  hader.uniformmat
-00025440: 3428 226d 6f64 656c 4d61 7472 6978 222c  4("modelMatrix",
-00025450: 2073 655f 6672 616d 652e 7472 616e 7366   se_frame.transf
-00025460: 6f72 6d2e 6d61 7472 6978 290d 0a20 2020  orm.matrix)..   
-00025470: 2020 2020 2073 656c 662e 626f 7264 6572       self.border
-00025480: 5f73 6861 6465 722e 756e 6966 6f72 6d31  _shader.uniform1
-00025490: 6628 227a 5f70 6f73 222c 2030 290d 0a20  f("z_pos", 0).. 
-000254a0: 2020 2020 2020 2073 656c 662e 626f 7264         self.bord
-000254b0: 6572 5f73 6861 6465 722e 756e 6966 6f72  er_shader.unifor
-000254c0: 6d31 6628 2261 6c70 6861 222c 2031 2e30  m1f("alpha", 1.0
-000254d0: 290d 0a20 2020 2020 2020 2067 6c44 7261  )..        glDra
-000254e0: 7745 6c65 6d65 6e74 7328 474c 5f4c 494e  wElements(GL_LIN
-000254f0: 4553 2c20 7365 5f66 7261 6d65 2e62 6f72  ES, se_frame.bor
-00025500: 6465 725f 7661 2e69 6e64 6578 4275 6666  der_va.indexBuff
-00025510: 6572 2e67 6574 436f 756e 7428 292c 2047  er.getCount(), G
-00025520: 4c5f 554e 5349 474e 4544 5f53 484f 5254  L_UNSIGNED_SHORT
-00025530: 2c20 4e6f 6e65 290d 0a20 2020 2020 2020  , None)..       
-00025540: 2073 656c 662e 626f 7264 6572 5f73 6861   self.border_sha
-00025550: 6465 722e 756e 6269 6e64 2829 0d0a 2020  der.unbind()..  
-00025560: 2020 2020 2020 7365 5f66 7261 6d65 2e62        se_frame.b
-00025570: 6f72 6465 725f 7661 2e75 6e62 696e 6428  order_va.unbind(
-00025580: 290d 0a0d 0a20 2020 2064 6566 2072 656e  )....    def ren
-00025590: 6465 725f 7365 676d 656e 7461 7469 6f6e  der_segmentation
-000255a0: 7328 7365 6c66 2c20 7365 5f66 7261 6d65  s(self, se_frame
-000255b0: 2c20 6361 6d65 7261 293a 0d0a 2020 2020  , camera):..    
-000255c0: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
-000255d0: 2073 655f 6672 616d 653a 2074 6865 2053   se_frame: the S
-000255e0: 4546 7261 6d65 206f 626a 6563 7420 746f  EFrame object to
-000255f0: 2072 656e 6465 722e 0d0a 2020 2020 2020   render...      
-00025600: 2020 6361 6d65 7261 3a20 6120 4361 6d65    camera: a Came
-00025610: 7261 206f 626a 6563 7420 746f 2072 656e  ra object to ren
-00025620: 6465 7220 7769 7468 2e0d 0a20 2020 2020  der with...     
-00025630: 2020 2077 696e 646f 773a 2074 6865 2057     window: the W
-00025640: 696e 646f 7720 6f62 6a65 6374 2028 746f  indow object (to
-00025650: 2077 6869 6368 2074 6865 2076 6965 7770   which the viewp
-00025660: 6f72 7420 7369 7a65 2077 696c 6c20 6265  ort size will be
-00025670: 2072 6573 6574 290d 0a20 2020 2020 2020   reset)..       
-00025680: 2066 696c 7465 7273 3a20 6120 6c69 7374   filters: a list
-00025690: 206f 6620 4669 6c74 6572 206f 626a 6563   of Filter objec
-000256a0: 746d 2c20 746f 2061 7070 6c79 2074 6f20  tm, to apply to 
-000256b0: 7468 6520 7365 5f66 7261 6d65 2070 6978  the se_frame pix
-000256c0: 656c 6461 7461 2e0d 0a20 2020 2020 2020  eldata...       
-000256d0: 2022 2222 0d0a 0d0a 2020 2020 2020 2020   """....        
-000256e0: 2320 7265 6e64 6572 2073 6567 6d65 6e74  # render segment
-000256f0: 6174 696f 6e20 6f76 6572 6c61 7973 0d0a  ation overlays..
-00025700: 2020 2020 2020 2020 7365 5f66 7261 6d65          se_frame
-00025710: 2e71 7561 645f 7661 2e62 696e 6428 290d  .quad_va.bind().
-00025720: 0a20 2020 2020 2020 2073 656c 662e 625f  .        self.b_
-00025730: 7365 676d 656e 7461 7469 6f6e 5f73 6861  segmentation_sha
-00025740: 6465 722e 6269 6e64 2829 0d0a 2020 2020  der.bind()..    
-00025750: 2020 2020 7365 6c66 2e62 5f73 6567 6d65      self.b_segme
-00025760: 6e74 6174 696f 6e5f 7368 6164 6572 2e75  ntation_shader.u
-00025770: 6e69 666f 726d 6d61 7434 2822 6361 6d65  niformmat4("came
-00025780: 7261 4d61 7472 6978 222c 2063 616d 6572  raMatrix", camer
-00025790: 612e 7669 6577 5f70 726f 6a65 6374 696f  a.view_projectio
-000257a0: 6e5f 6d61 7472 6978 290d 0a20 2020 2020  n_matrix)..     
-000257b0: 2020 2073 656c 662e 625f 7365 676d 656e     self.b_segmen
-000257c0: 7461 7469 6f6e 5f73 6861 6465 722e 756e  tation_shader.un
-000257d0: 6966 6f72 6d6d 6174 3428 226d 6f64 656c  iformmat4("model
-000257e0: 4d61 7472 6978 222c 2073 655f 6672 616d  Matrix", se_fram
-000257f0: 652e 7472 616e 7366 6f72 6d2e 6d61 7472  e.transform.matr
-00025800: 6978 290d 0a20 2020 2020 2020 2072 656e  ix)..        ren
-00025810: 6465 725f 6c69 7374 203d 2063 6f70 7928  der_list = copy(
-00025820: 7365 5f66 7261 6d65 2e66 6561 7475 7265  se_frame.feature
-00025830: 7329 0d0a 2020 2020 2020 2020 6966 2073  s)..        if s
-00025840: 655f 6672 616d 652e 6163 7469 7665 5f66  e_frame.active_f
-00025850: 6561 7475 7265 2069 6e20 7265 6e64 6572  eature in render
-00025860: 5f6c 6973 743a 0d0a 2020 2020 2020 2020  _list:..        
-00025870: 2020 2020 7265 6e64 6572 5f6c 6973 742e      render_list.
-00025880: 7265 6d6f 7665 2873 655f 6672 616d 652e  remove(se_frame.
-00025890: 6163 7469 7665 5f66 6561 7475 7265 290d  active_feature).
-000258a0: 0a20 2020 2020 2020 2020 2020 2072 656e  .            ren
-000258b0: 6465 725f 6c69 7374 2e61 7070 656e 6428  der_list.append(
-000258c0: 7365 5f66 7261 6d65 2e61 6374 6976 655f  se_frame.active_
-000258d0: 6665 6174 7572 6529 0d0a 2020 2020 2020  feature)..      
-000258e0: 2020 666f 7220 7365 676d 656e 7461 7469    for segmentati
-000258f0: 6f6e 2069 6e20 7265 6e64 6572 5f6c 6973  on in render_lis
-00025900: 743a 0d0a 2020 2020 2020 2020 2020 2020  t:..            
-00025910: 6966 2073 6567 6d65 6e74 6174 696f 6e2e  if segmentation.
-00025920: 6869 6465 3a0d 0a20 2020 2020 2020 2020  hide:..         
-00025930: 2020 2020 2020 2063 6f6e 7469 6e75 650d         continue.
-00025940: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00025950: 7365 676d 656e 7461 7469 6f6e 2e64 6174  segmentation.dat
-00025960: 6120 6973 204e 6f6e 653a 0d0a 2020 2020  a is None:..    
-00025970: 2020 2020 2020 2020 2020 2020 636f 6e74              cont
-00025980: 696e 7565 0d0a 2020 2020 2020 2020 2020  inue..          
-00025990: 2020 6966 206e 6f74 2073 6567 6d65 6e74    if not segment
-000259a0: 6174 696f 6e2e 636f 6e74 6f75 723a 0d0a  ation.contour:..
-000259b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000259c0: 676c 426c 656e 6446 756e 6328 474c 5f44  glBlendFunc(GL_D
-000259d0: 5354 5f43 4f4c 4f52 2c20 474c 5f44 5354  ST_COLOR, GL_DST
-000259e0: 5f41 4c50 4841 290d 0a20 2020 2020 2020  _ALPHA)..       
-000259f0: 2020 2020 2020 2020 2067 6c42 6c65 6e64           glBlend
-00025a00: 4571 7561 7469 6f6e 2847 4c5f 4655 4e43  Equation(GL_FUNC
-00025a10: 5f41 4444 290d 0a20 2020 2020 2020 2020  _ADD)..         
-00025a20: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00025a30: 2020 2020 2020 2020 2020 676c 426c 656e            glBlen
-00025a40: 6446 756e 6328 474c 5f53 5243 5f41 4c50  dFunc(GL_SRC_ALP
-00025a50: 4841 2c20 474c 5f4f 4e45 5f4d 494e 5553  HA, GL_ONE_MINUS
-00025a60: 5f53 5243 5f41 4c50 4841 290d 0a20 2020  _SRC_ALPHA)..   
-00025a70: 2020 2020 2020 2020 2020 2020 2067 6c42               glB
-00025a80: 6c65 6e64 4571 7561 7469 6f6e 2847 4c5f  lendEquation(GL_
-00025a90: 4655 4e43 5f41 4444 290d 0a20 2020 2020  FUNC_ADD)..     
-00025aa0: 2020 2020 2020 2073 656c 662e 625f 7365         self.b_se
-00025ab0: 676d 656e 7461 7469 6f6e 5f73 6861 6465  gmentation_shade
-00025ac0: 722e 756e 6966 6f72 6d31 6628 2261 6c70  r.uniform1f("alp
-00025ad0: 6861 222c 2073 6567 6d65 6e74 6174 696f  ha", segmentatio
-00025ae0: 6e2e 616c 7068 6129 0d0a 2020 2020 2020  n.alpha)..      
-00025af0: 2020 2020 2020 636c 7220 3d20 7365 676d        clr = segm
-00025b00: 656e 7461 7469 6f6e 2e63 6f6c 6f75 720d  entation.colour.
-00025b10: 0a20 2020 2020 2020 2020 2020 2061 6c70  .            alp
-00025b20: 6861 203d 2073 6567 6d65 6e74 6174 696f  ha = segmentatio
-00025b30: 6e2e 616c 7068 610d 0a20 2020 2020 2020  n.alpha..       
-00025b40: 2020 2020 2073 656c 662e 625f 7365 676d       self.b_segm
-00025b50: 656e 7461 7469 6f6e 5f73 6861 6465 722e  entation_shader.
-00025b60: 756e 6966 6f72 6d33 6628 2263 6f6c 6f75  uniform3f("colou
-00025b70: 7222 2c20 2863 6c72 5b30 5d20 2a20 616c  r", (clr[0] * al
-00025b80: 7068 612c 2063 6c72 5b31 5d20 2a20 616c  pha, clr[1] * al
-00025b90: 7068 612c 2063 6c72 5b32 5d20 2a20 616c  pha, clr[2] * al
-00025ba0: 7068 6129 290d 0a20 2020 2020 2020 2020  pha))..         
-00025bb0: 2020 2073 656c 662e 625f 7365 676d 656e     self.b_segmen
-00025bc0: 7461 7469 6f6e 5f73 6861 6465 722e 756e  tation_shader.un
-00025bd0: 6966 6f72 6d31 6928 2263 6f6e 746f 7572  iform1i("contour
-00025be0: 222c 2069 6e74 2873 6567 6d65 6e74 6174  ", int(segmentat
-00025bf0: 696f 6e2e 636f 6e74 6f75 7229 290d 0a0d  ion.contour))...
-00025c00: 0a20 2020 2020 2020 2020 2020 2073 6567  .            seg
-00025c10: 6d65 6e74 6174 696f 6e2e 7465 7874 7572  mentation.textur
-00025c20: 652e 6269 6e64 2830 290d 0a20 2020 2020  e.bind(0)..     
-00025c30: 2020 2020 2020 2067 6c44 7261 7745 6c65         glDrawEle
-00025c40: 6d65 6e74 7328 474c 5f54 5249 414e 474c  ments(GL_TRIANGL
-00025c50: 4553 2c20 7365 5f66 7261 6d65 2e71 7561  ES, se_frame.qua
-00025c60: 645f 7661 2e69 6e64 6578 4275 6666 6572  d_va.indexBuffer
-00025c70: 2e67 6574 436f 756e 7428 292c 2047 4c5f  .getCount(), GL_
-00025c80: 554e 5349 474e 4544 5f53 484f 5254 2c20  UNSIGNED_SHORT, 
-00025c90: 4e6f 6e65 290d 0a20 2020 2020 2020 2073  None)..        s
-00025ca0: 655f 6672 616d 652e 7175 6164 5f76 612e  e_frame.quad_va.
-00025cb0: 756e 6269 6e64 2829 0d0a 2020 2020 2020  unbind()..      
-00025cc0: 2020 7365 6c66 2e62 5f73 6567 6d65 6e74    self.b_segment
-00025cd0: 6174 696f 6e5f 7368 6164 6572 2e75 6e62  ation_shader.unb
-00025ce0: 696e 6428 290d 0a20 2020 2020 2020 2067  ind()..        g
-00025cf0: 6c41 6374 6976 6554 6578 7475 7265 2847  lActiveTexture(G
-00025d00: 4c5f 5445 5854 5552 4530 290d 0a0d 0a20  L_TEXTURE0).... 
-00025d10: 2020 2020 2020 2023 2072 656e 6465 7220         # render 
-00025d20: 626f 7264 6572 0d0a 2020 2020 2020 2020  border..        
-00025d30: 676c 426c 656e 6446 756e 6328 474c 5f53  glBlendFunc(GL_S
-00025d40: 5243 5f41 4c50 4841 2c20 474c 5f4f 4e45  RC_ALPHA, GL_ONE
-00025d50: 5f4d 494e 5553 5f53 5243 5f41 4c50 4841  _MINUS_SRC_ALPHA
-00025d60: 290d 0a20 2020 2020 2020 2067 6c42 6c65  )..        glBle
-00025d70: 6e64 4571 7561 7469 6f6e 2847 4c5f 4655  ndEquation(GL_FU
-00025d80: 4e43 5f41 4444 290d 0a20 2020 2020 2020  NC_ADD)..       
-00025d90: 2073 656c 662e 626f 7264 6572 5f73 6861   self.border_sha
-00025da0: 6465 722e 6269 6e64 2829 0d0a 2020 2020  der.bind()..    
-00025db0: 2020 2020 7365 5f66 7261 6d65 2e62 6f72      se_frame.bor
-00025dc0: 6465 725f 7661 2e62 696e 6428 290d 0a20  der_va.bind().. 
-00025dd0: 2020 2020 2020 2073 656c 662e 626f 7264         self.bord
-00025de0: 6572 5f73 6861 6465 722e 756e 6966 6f72  er_shader.unifor
-00025df0: 6d6d 6174 3428 2263 616d 6572 614d 6174  mmat4("cameraMat
-00025e00: 7269 7822 2c20 6361 6d65 7261 2e76 6965  rix", camera.vie
-00025e10: 775f 7072 6f6a 6563 7469 6f6e 5f6d 6174  w_projection_mat
-00025e20: 7269 7829 0d0a 2020 2020 2020 2020 7365  rix)..        se
-00025e30: 6c66 2e62 6f72 6465 725f 7368 6164 6572  lf.border_shader
-00025e40: 2e75 6e69 666f 726d 6d61 7434 2822 6d6f  .uniformmat4("mo
-00025e50: 6465 6c4d 6174 7269 7822 2c20 7365 5f66  delMatrix", se_f
-00025e60: 7261 6d65 2e74 7261 6e73 666f 726d 2e6d  rame.transform.m
-00025e70: 6174 7269 7829 0d0a 2020 2020 2020 2020  atrix)..        
-00025e80: 7365 6c66 2e62 6f72 6465 725f 7368 6164  self.border_shad
-00025e90: 6572 2e75 6e69 666f 726d 3166 2822 7a5f  er.uniform1f("z_
-00025ea0: 706f 7322 2c20 3029 0d0a 2020 2020 2020  pos", 0)..      
-00025eb0: 2020 7365 6c66 2e62 6f72 6465 725f 7368    self.border_sh
-00025ec0: 6164 6572 2e75 6e69 666f 726d 3166 2822  ader.uniform1f("
-00025ed0: 616c 7068 6122 2c20 312e 3029 0d0a 2020  alpha", 1.0)..  
-00025ee0: 2020 2020 2020 676c 4472 6177 456c 656d        glDrawElem
-00025ef0: 656e 7473 2847 4c5f 4c49 4e45 532c 2073  ents(GL_LINES, s
-00025f00: 655f 6672 616d 652e 626f 7264 6572 5f76  e_frame.border_v
-00025f10: 612e 696e 6465 7842 7566 6665 722e 6765  a.indexBuffer.ge
-00025f20: 7443 6f75 6e74 2829 2c20 474c 5f55 4e53  tCount(), GL_UNS
-00025f30: 4947 4e45 445f 5348 4f52 542c 204e 6f6e  IGNED_SHORT, Non
-00025f40: 6529 0d0a 2020 2020 2020 2020 7365 6c66  e)..        self
-00025f50: 2e62 6f72 6465 725f 7368 6164 6572 2e75  .border_shader.u
-00025f60: 6e62 696e 6428 290d 0a20 2020 2020 2020  nbind()..       
-00025f70: 2073 655f 6672 616d 652e 626f 7264 6572   se_frame.border
-00025f80: 5f76 612e 756e 6269 6e64 2829 0d0a 0d0a  _va.unbind()....
-00025f90: 2020 2020 6465 6620 7265 6e64 6572 5f66      def render_f
-00025fa0: 7261 6d65 5f62 6f72 6465 7228 7365 6c66  rame_border(self
-00025fb0: 2c20 7365 5f66 7261 6d65 2c20 6361 6d65  , se_frame, came
-00025fc0: 7261 293a 0d0a 2020 2020 2020 2020 676c  ra):..        gl
-00025fd0: 426c 656e 6446 756e 6328 474c 5f53 5243  BlendFunc(GL_SRC
-00025fe0: 5f41 4c50 4841 2c20 474c 5f4f 4e45 5f4d  _ALPHA, GL_ONE_M
-00025ff0: 494e 5553 5f53 5243 5f41 4c50 4841 290d  INUS_SRC_ALPHA).
-00026000: 0a20 2020 2020 2020 2067 6c42 6c65 6e64  .        glBlend
-00026010: 4571 7561 7469 6f6e 2847 4c5f 4655 4e43  Equation(GL_FUNC
-00026020: 5f41 4444 290d 0a20 2020 2020 2020 2073  _ADD)..        s
-00026030: 656c 662e 626f 7264 6572 5f73 6861 6465  elf.border_shade
-00026040: 722e 6269 6e64 2829 0d0a 2020 2020 2020  r.bind()..      
-00026050: 2020 7365 5f66 7261 6d65 2e62 6f72 6465    se_frame.borde
-00026060: 725f 7661 2e62 696e 6428 290d 0a20 2020  r_va.bind()..   
-00026070: 2020 2020 2073 656c 662e 626f 7264 6572       self.border
-00026080: 5f73 6861 6465 722e 756e 6966 6f72 6d6d  _shader.uniformm
-00026090: 6174 3428 2263 616d 6572 614d 6174 7269  at4("cameraMatri
-000260a0: 7822 2c20 6361 6d65 7261 2e76 6965 775f  x", camera.view_
-000260b0: 7072 6f6a 6563 7469 6f6e 5f6d 6174 7269  projection_matri
-000260c0: 7829 0d0a 2020 2020 2020 2020 7365 6c66  x)..        self
-000260d0: 2e62 6f72 6465 725f 7368 6164 6572 2e75  .border_shader.u
-000260e0: 6e69 666f 726d 6d61 7434 2822 6d6f 6465  niformmat4("mode
-000260f0: 6c4d 6174 7269 7822 2c20 7365 5f66 7261  lMatrix", se_fra
-00026100: 6d65 2e74 7261 6e73 666f 726d 2e6d 6174  me.transform.mat
-00026110: 7269 7829 0d0a 2020 2020 2020 2020 7365  rix)..        se
-00026120: 6c66 2e62 6f72 6465 725f 7368 6164 6572  lf.border_shader
-00026130: 2e75 6e69 666f 726d 3166 2822 7a5f 706f  .uniform1f("z_po
-00026140: 7322 2c20 2873 655f 6672 616d 652e 6375  s", (se_frame.cu
-00026150: 7272 656e 745f 736c 6963 6520 2d20 7365  rrent_slice - se
-00026160: 5f66 7261 6d65 2e6e 5f73 6c69 6365 7320  _frame.n_slices 
-00026170: 2f20 3229 290d 0a20 2020 2020 2020 2073  / 2))..        s
-00026180: 656c 662e 626f 7264 6572 5f73 6861 6465  elf.border_shade
-00026190: 722e 756e 6966 6f72 6d31 6628 2261 6c70  r.uniform1f("alp
-000261a0: 6861 222c 2053 6567 6d65 6e74 6174 696f  ha", Segmentatio
-000261b0: 6e45 6469 746f 722e 5049 434b 494e 475f  nEditor.PICKING_
-000261c0: 4652 414d 455f 414c 5048 4129 0d0a 2020  FRAME_ALPHA)..  
-000261d0: 2020 2020 2020 676c 4472 6177 456c 656d        glDrawElem
-000261e0: 656e 7473 2847 4c5f 4c49 4e45 532c 2073  ents(GL_LINES, s
-000261f0: 655f 6672 616d 652e 626f 7264 6572 5f76  e_frame.border_v
-00026200: 612e 696e 6465 7842 7566 6665 722e 6765  a.indexBuffer.ge
-00026210: 7443 6f75 6e74 2829 2c20 474c 5f55 4e53  tCount(), GL_UNS
-00026220: 4947 4e45 445f 5348 4f52 542c 204e 6f6e  IGNED_SHORT, Non
-00026230: 6529 0d0a 2020 2020 2020 2020 7365 6c66  e)..        self
-00026240: 2e62 6f72 6465 725f 7368 6164 6572 2e75  .border_shader.u
-00026250: 6e62 696e 6428 290d 0a20 2020 2020 2020  nbind()..       
-00026260: 2073 655f 6672 616d 652e 626f 7264 6572   se_frame.border
-00026270: 5f76 612e 756e 6269 6e64 2829 0d0a 0d0a  _va.unbind()....
-00026280: 2020 2020 6465 6620 7265 6e64 6572 5f63      def render_c
-00026290: 726f 705f 6861 6e64 6c65 7328 7365 6c66  rop_handles(self
-000262a0: 2c20 7365 5f66 7261 6d65 2c20 6361 6d65  , se_frame, came
-000262b0: 7261 2c20 6861 6e64 6c65 7329 3a0d 0a20  ra, handles):.. 
-000262c0: 2020 2020 2020 2073 656c 662e 6963 6f6e         self.icon
-000262d0: 5f73 6861 6465 722e 6269 6e64 2829 0d0a  _shader.bind()..
-000262e0: 2020 2020 2020 2020 685f 7661 203d 2068          h_va = h
-000262f0: 616e 646c 6573 5b30 5d2e 6765 745f 7661  andles[0].get_va
-00026300: 2829 0d0a 2020 2020 2020 2020 685f 7661  ()..        h_va
-00026310: 2e62 696e 6428 290d 0a20 2020 2020 2020  .bind()..       
-00026320: 2068 616e 646c 6573 5b30 5d2e 6765 745f   handles[0].get_
-00026330: 7465 7874 7572 6528 292e 6269 6e64 2830  texture().bind(0
-00026340: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
-00026350: 6963 6f6e 5f73 6861 6465 722e 756e 6966  icon_shader.unif
-00026360: 6f72 6d6d 6174 3428 2263 616d 6572 614d  ormmat4("cameraM
-00026370: 6174 7269 7822 2c20 6361 6d65 7261 2e76  atrix", camera.v
-00026380: 6965 775f 7072 6f6a 6563 7469 6f6e 5f6d  iew_projection_m
-00026390: 6174 7269 7829 0d0a 2020 2020 2020 2020  atrix)..        
-000263a0: 666f 7220 6820 696e 2068 616e 646c 6573  for h in handles
-000263b0: 3a0d 0a20 2020 2020 2020 2020 2020 2068  :..            h
-000263c0: 2e63 6f6d 7075 7465 5f6d 6174 7269 7828  .compute_matrix(
-000263d0: 7365 5f66 7261 6d65 2c20 6361 6d65 7261  se_frame, camera
-000263e0: 290d 0a20 2020 2020 2020 2020 2020 2073  )..            s
-000263f0: 656c 662e 6963 6f6e 5f73 6861 6465 722e  elf.icon_shader.
-00026400: 756e 6966 6f72 6d6d 6174 3428 226d 6f64  uniformmat4("mod
-00026410: 656c 4d61 7472 6978 222c 2068 2e74 7261  elMatrix", h.tra
-00026420: 6e73 666f 726d 2e6d 6174 7269 7829 0d0a  nsform.matrix)..
-00026430: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00026440: 2e69 636f 6e5f 7368 6164 6572 2e75 6e69  .icon_shader.uni
-00026450: 666f 726d 3169 2822 696e 7665 7274 222c  form1i("invert",
-00026460: 2069 6e74 2873 655f 6672 616d 652e 696e   int(se_frame.in
-00026470: 7665 7274 2929 0d0a 2020 2020 2020 2020  vert))..        
-00026480: 2020 2020 676c 4472 6177 456c 656d 656e      glDrawElemen
-00026490: 7473 2847 4c5f 5452 4941 4e47 4c45 532c  ts(GL_TRIANGLES,
-000264a0: 2068 5f76 612e 696e 6465 7842 7566 6665   h_va.indexBuffe
-000264b0: 722e 6765 7443 6f75 6e74 2829 2c20 474c  r.getCount(), GL
-000264c0: 5f55 4e53 4947 4e45 445f 5348 4f52 542c  _UNSIGNED_SHORT,
-000264d0: 204e 6f6e 6529 0d0a 2020 2020 2020 2020   None)..        
-000264e0: 7365 6c66 2e69 636f 6e5f 7368 6164 6572  self.icon_shader
-000264f0: 2e75 6e62 696e 6428 290d 0a20 2020 2020  .unbind()..     
-00026500: 2020 2068 5f76 612e 756e 6269 6e64 2829     h_va.unbind()
-00026510: 0d0a 0d0a 2020 2020 6465 6620 7265 6e64  ....    def rend
-00026520: 6572 5f73 7572 6661 6365 5f6d 6f64 656c  er_surface_model
-00026530: 7328 7365 6c66 2c20 7375 7266 6163 655f  s(self, surface_
-00026540: 6d6f 6465 6c73 2c20 6361 6d65 7261 2c20  models, camera, 
-00026550: 616d 6269 656e 745f 7374 7265 6e67 7468  ambient_strength
-00026560: 2c20 7370 6f74 5f6c 6967 6874 293a 0d0a  , spot_light):..
-00026570: 2020 2020 2020 2020 676c 456e 6162 6c65          glEnable
-00026580: 2847 4c5f 4445 5054 485f 5445 5354 290d  (GL_DEPTH_TEST).
-00026590: 0a20 2020 2020 2020 2073 656c 662e 7375  .        self.su
-000265a0: 7266 6163 655f 6d6f 6465 6c5f 7368 6164  rface_model_shad
-000265b0: 6572 2e62 696e 6428 290d 0a20 2020 2020  er.bind()..     
-000265c0: 2020 2073 656c 662e 7375 7266 6163 655f     self.surface_
-000265d0: 6d6f 6465 6c5f 7368 6164 6572 2e75 6e69  model_shader.uni
-000265e0: 666f 726d 6d61 7434 2822 7670 4d61 7422  formmat4("vpMat"
-000265f0: 2c20 6361 6d65 7261 2e6d 6174 7269 7829  , camera.matrix)
-00026600: 0d0a 2020 2020 2020 2020 7365 6c66 2e73  ..        self.s
-00026610: 7572 6661 6365 5f6d 6f64 656c 5f73 6861  urface_model_sha
-00026620: 6465 722e 756e 6966 6f72 6d33 6628 2276  der.uniform3f("v
-00026630: 6965 7744 6972 222c 2063 616d 6572 612e  iewDir", camera.
-00026640: 6765 745f 7669 6577 5f64 6972 6563 7469  get_view_directi
-00026650: 6f6e 2829 290d 0a20 2020 2020 2020 2073  on())..        s
-00026660: 656c 662e 7375 7266 6163 655f 6d6f 6465  elf.surface_mode
-00026670: 6c5f 7368 6164 6572 2e75 6e69 666f 726d  l_shader.uniform
-00026680: 3366 2822 6c69 6768 7444 6972 222c 2073  3f("lightDir", s
-00026690: 706f 745f 6c69 6768 742e 7665 6329 0d0a  pot_light.vec)..
-000266a0: 2020 2020 2020 2020 7365 6c66 2e73 7572          self.sur
-000266b0: 6661 6365 5f6d 6f64 656c 5f73 6861 6465  face_model_shade
-000266c0: 722e 756e 6966 6f72 6d31 6628 2261 6d62  r.uniform1f("amb
-000266d0: 6965 6e74 5374 7265 6e67 7468 222c 2061  ientStrength", a
-000266e0: 6d62 6965 6e74 5f73 7472 656e 6774 6829  mbient_strength)
-000266f0: 0d0a 2020 2020 2020 2020 7365 6c66 2e73  ..        self.s
-00026700: 7572 6661 6365 5f6d 6f64 656c 5f73 6861  urface_model_sha
-00026710: 6465 722e 756e 6966 6f72 6d31 6628 226c  der.uniform1f("l
-00026720: 6967 6874 5374 7265 6e67 7468 222c 2073  ightStrength", s
-00026730: 706f 745f 6c69 6768 742e 7374 7265 6e67  pot_light.streng
-00026740: 7468 290d 0a20 2020 2020 2020 2073 656c  th)..        sel
-00026750: 662e 7375 7266 6163 655f 6d6f 6465 6c5f  f.surface_model_
-00026760: 7368 6164 6572 2e75 6e69 666f 726d 3366  shader.uniform3f
-00026770: 2822 6c69 6768 7443 6f6c 6f75 7222 2c20  ("lightColour", 
-00026780: 7370 6f74 5f6c 6967 6874 2e63 6f6c 6f75  spot_light.colou
-00026790: 7229 0d0a 2020 2020 2020 2020 7365 6c66  r)..        self
-000267a0: 2e73 7572 6661 6365 5f6d 6f64 656c 5f73  .surface_model_s
-000267b0: 6861 6465 722e 756e 6966 6f72 6d31 6928  hader.uniform1i(
-000267c0: 2273 7479 6c65 222c 2053 6567 6d65 6e74  "style", Segment
-000267d0: 6174 696f 6e45 6469 746f 722e 5345 4c45  ationEditor.SELE
-000267e0: 4354 4544 5f52 454e 4445 525f 5354 594c  CTED_RENDER_STYL
-000267f0: 4529 0d0a 2020 2020 2020 2020 676c 456e  E)..        glEn
-00026800: 6162 6c65 2847 4c5f 4445 5054 485f 5445  able(GL_DEPTH_TE
-00026810: 5354 290d 0a20 2020 2020 2020 2061 6c70  ST)..        alp
-00026820: 6861 5f73 6f72 7465 645f 7375 7266 6163  ha_sorted_surfac
-00026830: 655f 6d6f 6465 6c73 203d 2073 6f72 7465  e_models = sorte
-00026840: 6428 7375 7266 6163 655f 6d6f 6465 6c73  d(surface_models
-00026850: 2c20 6b65 793d 6c61 6d62 6461 2078 3a20  , key=lambda x: 
-00026860: 782e 616c 7068 612c 2072 6576 6572 7365  x.alpha, reverse
-00026870: 3d54 7275 6529 0d0a 2020 2020 2020 2020  =True)..        
-00026880: 666f 7220 7320 696e 2061 6c70 6861 5f73  for s in alpha_s
-00026890: 6f72 7465 645f 7375 7266 6163 655f 6d6f  orted_surface_mo
-000268a0: 6465 6c73 3a0d 0a20 2020 2020 2020 2020  dels:..         
-000268b0: 2020 2069 6620 732e 6869 6465 3a0d 0a20     if s.hide:.. 
-000268c0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-000268d0: 6f6e 7469 6e75 650d 0a20 2020 2020 2020  ontinue..       
-000268e0: 2020 2020 2073 656c 662e 7375 7266 6163       self.surfac
-000268f0: 655f 6d6f 6465 6c5f 7368 6164 6572 2e75  e_model_shader.u
-00026900: 6e69 666f 726d 3466 2822 636f 6c6f 7222  niform4f("color"
-00026910: 2c20 5b2a 732e 636f 6c6f 7572 2c20 732e  , [*s.colour, s.
-00026920: 616c 7068 615d 290d 0a20 2020 2020 2020  alpha])..       
-00026930: 2020 2020 2066 6f72 2062 6c6f 6220 696e       for blob in
-00026940: 2073 2e62 6c6f 6273 2e76 616c 7565 7328   s.blobs.values(
-00026950: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-00026960: 2020 2020 6966 2062 6c6f 622e 636f 6d70      if blob.comp
-00026970: 6c65 7465 2061 6e64 206e 6f74 2062 6c6f  lete and not blo
-00026980: 622e 6869 6465 3a0d 0a20 2020 2020 2020  b.hide:..       
-00026990: 2020 2020 2020 2020 2020 2020 2062 6c6f               blo
-000269a0: 622e 7661 2e62 696e 6428 290d 0a20 2020  b.va.bind()..   
-000269b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000269c0: 2067 6c44 7261 7745 6c65 6d65 6e74 7328   glDrawElements(
-000269d0: 474c 5f54 5249 414e 474c 4553 2c20 626c  GL_TRIANGLES, bl
-000269e0: 6f62 2e76 612e 696e 6465 7842 7566 6665  ob.va.indexBuffe
-000269f0: 722e 6765 7443 6f75 6e74 2829 2c20 474c  r.getCount(), GL
-00026a00: 5f55 4e53 4947 4e45 445f 494e 542c 204e  _UNSIGNED_INT, N
-00026a10: 6f6e 6529 0d0a 2020 2020 2020 2020 2020  one)..          
-00026a20: 2020 2020 2020 2020 2020 626c 6f62 2e76            blob.v
-00026a30: 612e 756e 6269 6e64 2829 0d0a 2020 2020  a.unbind()..    
-00026a40: 2020 2020 7365 6c66 2e73 7572 6661 6365      self.surface
-00026a50: 5f6d 6f64 656c 5f73 6861 6465 722e 756e  _model_shader.un
-00026a60: 6269 6e64 2829 0d0a 2020 2020 2020 2020  bind()..        
-00026a70: 676c 4469 7361 626c 6528 474c 5f44 4550  glDisable(GL_DEP
-00026a80: 5448 5f54 4553 5429 0d0a 0d0a 2020 2020  TH_TEST)....    
-00026a90: 6465 6620 7265 6e64 6572 5f73 7572 6661  def render_surfa
-00026aa0: 6365 5f6d 6f64 656c 5f70 6172 7469 636c  ce_model_particl
-00026ab0: 6573 2873 656c 662c 2073 7572 6661 6365  es(self, surface
-00026ac0: 5f6d 6f64 656c 732c 2063 616d 6572 6129  _models, camera)
-00026ad0: 3a0d 0a20 2020 2020 2020 2069 6620 5365  :..        if Se
-00026ae0: 676d 656e 7461 7469 6f6e 4564 6974 6f72  gmentationEditor
-00026af0: 2e52 454e 4445 525f 5041 5254 4943 4c45  .RENDER_PARTICLE
-00026b00: 535f 5852 4159 3a0d 0a20 2020 2020 2020  S_XRAY:..       
-00026b10: 2020 2020 2067 6c44 6973 6162 6c65 2847       glDisable(G
-00026b20: 4c5f 4445 5054 485f 5445 5354 290d 0a20  L_DEPTH_TEST).. 
-00026b30: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-00026b40: 2020 2020 2020 2020 2020 676c 456e 6162            glEnab
-00026b50: 6c65 2847 4c5f 4445 5054 485f 5445 5354  le(GL_DEPTH_TEST
-00026b60: 290d 0a20 2020 2020 2020 2061 6c70 6861  )..        alpha
-00026b70: 5f73 6f72 7465 645f 7375 7266 6163 655f  _sorted_surface_
-00026b80: 6d6f 6465 6c73 203d 2073 6f72 7465 6428  models = sorted(
-00026b90: 7375 7266 6163 655f 6d6f 6465 6c73 2c20  surface_models, 
-00026ba0: 6b65 793d 6c61 6d62 6461 2078 3a20 782e  key=lambda x: x.
-00026bb0: 616c 7068 612c 2072 6576 6572 7365 3d54  alpha, reverse=T
-00026bc0: 7275 6529 0d0a 2020 2020 2020 2020 7365  rue)..        se
-00026bd0: 6c66 2e70 6172 7469 636c 655f 7661 2e62  lf.particle_va.b
-00026be0: 696e 6428 290d 0a20 2020 2020 2020 2073  ind()..        s
-00026bf0: 656c 662e 7061 7274 6963 6c65 5f73 6861  elf.particle_sha
-00026c00: 6465 722e 6269 6e64 2829 0d0a 2020 2020  der.bind()..    
-00026c10: 2020 2020 7365 6c66 2e70 6172 7469 636c      self.particl
-00026c20: 655f 7368 6164 6572 2e75 6e69 666f 726d  e_shader.uniform
-00026c30: 6d61 7434 2822 7670 4d61 7422 2c20 6361  mat4("vpMat", ca
-00026c40: 6d65 7261 2e6d 6174 7269 7829 0d0a 2020  mera.matrix)..  
-00026c50: 2020 2020 2020 666f 7220 7320 696e 2061        for s in a
-00026c60: 6c70 6861 5f73 6f72 7465 645f 7375 7266  lpha_sorted_surf
-00026c70: 6163 655f 6d6f 6465 6c73 3a0d 0a20 2020  ace_models:..   
-00026c80: 2020 2020 2020 2020 2069 6620 732e 6869           if s.hi
-00026c90: 6465 3a0d 0a20 2020 2020 2020 2020 2020  de:..           
-00026ca0: 2020 2020 2063 6f6e 7469 6e75 650d 0a20       continue.. 
-00026cb0: 2020 2020 2020 2020 2020 2069 6620 732e             if s.
-00026cc0: 7061 7274 6963 6c65 5f73 697a 6520 3e20  particle_size > 
-00026cd0: 302e 303a 0d0a 2020 2020 2020 2020 2020  0.0:..          
-00026ce0: 2020 2020 2020 7365 6c66 2e70 6172 7469        self.parti
-00026cf0: 636c 655f 7368 6164 6572 2e75 6e69 666f  cle_shader.unifo
-00026d00: 726d 3366 2822 7061 7274 6963 6c65 436f  rm3f("particleCo
-00026d10: 6c6f 7572 222c 2073 2e70 6172 7469 636c  lour", s.particl
-00026d20: 655f 636f 6c6f 7572 290d 0a20 2020 2020  e_colour)..     
-00026d30: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00026d40: 7061 7274 6963 6c65 5f73 6861 6465 722e  particle_shader.
-00026d50: 756e 6966 6f72 6d31 6628 2270 6172 7469  uniform1f("parti
-00026d60: 636c 6553 697a 6522 2c20 732e 7061 7274  cleSize", s.part
-00026d70: 6963 6c65 5f73 697a 6529 0d0a 2020 2020  icle_size)..    
-00026d80: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00026d90: 2e70 6172 7469 636c 655f 7368 6164 6572  .particle_shader
-00026da0: 2e75 6e69 666f 726d 3166 2822 7069 7865  .uniform1f("pixe
-00026db0: 6c53 697a 6522 2c20 732e 7069 7865 6c5f  lSize", s.pixel_
-00026dc0: 7369 7a65 290d 0a20 2020 2020 2020 2020  size)..         
-00026dd0: 2020 2020 2020 2073 656c 662e 7061 7274         self.part
-00026de0: 6963 6c65 5f73 6861 6465 722e 756e 6966  icle_shader.unif
-00026df0: 6f72 6d33 6628 226f 7269 6769 6e22 2c20  orm3f("origin", 
-00026e00: 732e 6365 6e74 6572 5f78 797a 202f 2032  s.center_xyz / 2
-00026e10: 2e30 290d 0a20 2020 2020 2020 2020 2020  .0)..           
-00026e20: 2020 2020 2066 6f72 2070 2069 6e20 732e       for p in s.
-00026e30: 7061 7274 6963 6c65 733a 0d0a 2020 2020  particles:..    
-00026e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026e50: 7365 6c66 2e70 6172 7469 636c 655f 7368  self.particle_sh
-00026e60: 6164 6572 2e75 6e69 666f 726d 3366 2822  ader.uniform3f("
-00026e70: 7061 7274 6963 6c65 506f 7369 7469 6f6e  particlePosition
-00026e80: 222c 2070 290d 0a20 2020 2020 2020 2020  ", p)..         
-00026e90: 2020 2020 2020 2020 2020 2067 6c44 7261             glDra
-00026ea0: 7745 6c65 6d65 6e74 7328 474c 5f54 5249  wElements(GL_TRI
-00026eb0: 414e 474c 4553 2c20 7365 6c66 2e70 6172  ANGLES, self.par
-00026ec0: 7469 636c 655f 7661 2e69 6e64 6578 4275  ticle_va.indexBu
-00026ed0: 6666 6572 2e67 6574 436f 756e 7428 292c  ffer.getCount(),
-00026ee0: 2047 4c5f 554e 5349 474e 4544 5f53 484f   GL_UNSIGNED_SHO
-00026ef0: 5254 2c20 4e6f 6e65 290d 0a20 2020 2020  RT, None)..     
-00026f00: 2020 2073 656c 662e 7061 7274 6963 6c65     self.particle
-00026f10: 5f76 612e 756e 6269 6e64 2829 0d0a 2020  _va.unbind()..  
-00026f20: 2020 2020 2020 7365 6c66 2e70 6172 7469        self.parti
-00026f30: 636c 655f 7368 6164 6572 2e75 6e62 696e  cle_shader.unbin
-00026f40: 6428 290d 0a20 2020 2020 2020 2067 6c44  d()..        glD
-00026f50: 6973 6162 6c65 2847 4c5f 4445 5054 485f  isable(GL_DEPTH_
-00026f60: 5445 5354 290d 0a0d 0a0d 0a0d 0a20 2020  TEST)........   
-00026f70: 2064 6566 2072 656e 6465 725f 6c69 6e65   def render_line
-00026f80: 5f76 6128 7365 6c66 2c20 7661 2c20 6361  _va(self, va, ca
-00026f90: 6d65 7261 293a 0d0a 2020 2020 2020 2020  mera):..        
-00026fa0: 676c 456e 6162 6c65 2847 4c5f 4445 5054  glEnable(GL_DEPT
-00026fb0: 485f 5445 5354 290d 0a20 2020 2020 2020  H_TEST)..       
-00026fc0: 2073 656c 662e 6c69 6e65 5f33 645f 7368   self.line_3d_sh
-00026fd0: 6164 6572 2e62 696e 6428 290d 0a20 2020  ader.bind()..   
-00026fe0: 2020 2020 2073 656c 662e 6c69 6e65 5f33       self.line_3
-00026ff0: 645f 7368 6164 6572 2e75 6e69 666f 726d  d_shader.uniform
-00027000: 6d61 7434 2822 6361 6d65 7261 4d61 7472  mat4("cameraMatr
-00027010: 6978 222c 2063 616d 6572 612e 6d61 7472  ix", camera.matr
-00027020: 6978 290d 0a20 2020 2020 2020 2076 612e  ix)..        va.
-00027030: 6269 6e64 2829 0d0a 2020 2020 2020 2020  bind()..        
-00027040: 676c 4472 6177 456c 656d 656e 7473 2847  glDrawElements(G
-00027050: 4c5f 4c49 4e45 532c 2076 612e 696e 6465  L_LINES, va.inde
-00027060: 7842 7566 6665 722e 6765 7443 6f75 6e74  xBuffer.getCount
-00027070: 2829 2c20 474c 5f55 4e53 4947 4e45 445f  (), GL_UNSIGNED_
-00027080: 5348 4f52 542c 204e 6f6e 6529 0d0a 2020  SHORT, None)..  
-00027090: 2020 2020 2020 7661 2e75 6e62 696e 6428        va.unbind(
-000270a0: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
-000270b0: 6c69 6e65 5f33 645f 7368 6164 6572 2e75  line_3d_shader.u
-000270c0: 6e62 696e 6428 290d 0a20 2020 2020 2020  nbind()..       
-000270d0: 2067 6c44 6973 6162 6c65 2847 4c5f 4445   glDisable(GL_DE
-000270e0: 5054 485f 5445 5354 290d 0a0d 0a20 2020  PTH_TEST)....   
-000270f0: 2064 6566 2072 6179 5f74 7261 6365 5f6f   def ray_trace_o
-00027100: 7665 726c 6179 2873 656c 662c 2077 696e  verlay(self, win
-00027110: 646f 775f 7369 7a65 2c20 7365 5f66 7261  dow_size, se_fra
-00027120: 6d65 2c20 6361 6d65 7261 2c20 626f 785f  me, camera, box_
-00027130: 7661 293a 0d0a 2020 2020 2020 2020 6966  va):..        if
-00027140: 2073 655f 6672 616d 652e 6f76 6572 6c61   se_frame.overla
-00027150: 7920 6973 204e 6f6e 653a 0d0a 2020 2020  y is None:..    
-00027160: 2020 2020 2020 2020 7265 7475 726e 0d0a          return..
-00027170: 0d0a 2020 2020 2020 2020 2320 3120 2d20  ..        # 1 - 
-00027180: 5265 6e64 6572 696e 6720 6120 6465 7074  Rendering a dept
-00027190: 6820 6d61 736b 2074 6f20 6669 6e64 2077  h mask to find w
-000271a0: 6865 7265 2074 6f20 5354 4152 5420 7361  here to START sa
-000271b0: 6d70 6c69 6e67 2072 6179 732e 0d0a 2020  mpling rays...  
-000271c0: 2020 2020 2020 6966 2073 656c 662e 7261        if self.ra
-000271d0: 795f 7472 6163 655f 6662 6f5f 7369 7a65  y_trace_fbo_size
-000271e0: 2021 3d20 7769 6e64 6f77 5f73 697a 653a   != window_size:
-000271f0: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-00027200: 6c66 2e72 6179 5f74 7261 6365 5f66 626f  lf.ray_trace_fbo
-00027210: 5f73 697a 6520 3d20 7769 6e64 6f77 5f73  _size = window_s
-00027220: 697a 650d 0a20 2020 2020 2020 2020 2020  ize..           
-00027230: 2073 656c 662e 7261 795f 7472 6163 655f   self.ray_trace_
-00027240: 6662 6f5f 6120 3d20 4672 616d 6542 7566  fbo_a = FrameBuf
-00027250: 6665 7228 7769 6e64 6f77 5f73 697a 655b  fer(window_size[
-00027260: 305d 2c20 7769 6e64 6f77 5f73 697a 655b  0], window_size[
-00027270: 315d 2c20 2272 6762 6133 3266 2229 0d0a  1], "rgba32f")..
-00027280: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00027290: 2e72 6179 5f74 7261 6365 5f66 626f 5f62  .ray_trace_fbo_b
-000272a0: 203d 2046 7261 6d65 4275 6666 6572 2877   = FrameBuffer(w
-000272b0: 696e 646f 775f 7369 7a65 5b30 5d2c 2077  indow_size[0], w
-000272c0: 696e 646f 775f 7369 7a65 5b31 5d2c 2022  indow_size[1], "
-000272d0: 7267 6261 3332 6622 290d 0a0d 0a20 2020  rgba32f")....   
-000272e0: 2020 2020 2073 656c 662e 7261 795f 7472       self.ray_tr
-000272f0: 6163 655f 6662 6f5f 612e 6269 6e64 2829  ace_fbo_a.bind()
-00027300: 0d0a 2020 2020 2020 2020 676c 436c 6561  ..        glClea
-00027310: 7244 6570 7468 2831 2e30 290d 0a20 2020  rDepth(1.0)..   
-00027320: 2020 2020 2067 6c45 6e61 626c 6528 474c       glEnable(GL
-00027330: 5f44 4550 5448 5f54 4553 5429 0d0a 2020  _DEPTH_TEST)..  
-00027340: 2020 2020 2020 676c 4465 7074 6846 756e        glDepthFun
-00027350: 6328 474c 5f4c 4553 5329 0d0a 2020 2020  c(GL_LESS)..    
-00027360: 2020 2020 676c 4465 7074 684d 6173 6b28      glDepthMask(
-00027370: 474c 5f54 5255 4529 0d0a 2020 2020 2020  GL_TRUE)..      
-00027380: 2020 676c 436c 6561 7228 474c 5f44 4550    glClear(GL_DEP
-00027390: 5448 5f42 5546 4645 525f 4249 5429 0d0a  TH_BUFFER_BIT)..
-000273a0: 0d0a 2020 2020 2020 2020 7365 6c66 2e64  ..        self.d
-000273b0: 6570 7468 5f6d 6173 6b5f 7368 6164 6572  epth_mask_shader
-000273c0: 2e62 696e 6428 290d 0a20 2020 2020 2020  .bind()..       
-000273d0: 2073 656c 662e 6465 7074 685f 6d61 736b   self.depth_mask
-000273e0: 5f73 6861 6465 722e 756e 6966 6f72 6d6d  _shader.uniformm
-000273f0: 6174 3428 2276 704d 6174 222c 2063 616d  at4("vpMat", cam
-00027400: 6572 612e 6d61 7472 6978 290d 0a20 2020  era.matrix)..   
-00027410: 2020 2020 2073 656c 662e 6465 7074 685f       self.depth_
-00027420: 6d61 736b 5f73 6861 6465 722e 756e 6966  mask_shader.unif
-00027430: 6f72 6d31 6928 226f 7665 7272 6964 655f  orm1i("override_
-00027440: 7a22 2c20 3029 0d0a 2020 2020 2020 2020  z", 0)..        
-00027450: 7365 6c66 2e64 6570 7468 5f6d 6173 6b5f  self.depth_mask_
-00027460: 7368 6164 6572 2e75 6e69 666f 726d 3166  shader.uniform1f
-00027470: 2822 6f76 6572 7269 6465 5f7a 5f76 616c  ("override_z_val
-00027480: 222c 2030 2e30 290d 0a20 2020 2020 2020  ", 0.0)..       
-00027490: 2062 6f78 5f76 612e 6269 6e64 2829 2020   box_va.bind()  
-000274a0: 2320 626f 7820 6465 7074 6820 6d61 736b  # box depth mask
-000274b0: 0d0a 2020 2020 2020 2020 676c 4472 6177  ..        glDraw
-000274c0: 456c 656d 656e 7473 2847 4c5f 5452 4941  Elements(GL_TRIA
-000274d0: 4e47 4c45 532c 2062 6f78 5f76 612e 696e  NGLES, box_va.in
-000274e0: 6465 7842 7566 6665 722e 6765 7443 6f75  dexBuffer.getCou
-000274f0: 6e74 2829 2c20 474c 5f55 4e53 4947 4e45  nt(), GL_UNSIGNE
-00027500: 445f 5348 4f52 542c 204e 6f6e 6529 0d0a  D_SHORT, None)..
-00027510: 2020 2020 2020 2020 626f 785f 7661 2e75          box_va.u
-00027520: 6e62 696e 6428 290d 0a20 2020 2020 2020  nbind()..       
-00027530: 2073 656c 662e 6465 7074 685f 6d61 736b   self.depth_mask
-00027540: 5f73 6861 6465 722e 756e 6269 6e64 2829  _shader.unbind()
-00027550: 0d0a 2020 2020 2020 2020 7365 6c66 2e72  ..        self.r
-00027560: 6179 5f74 7261 6365 5f66 626f 5f61 2e75  ay_trace_fbo_a.u
-00027570: 6e62 696e 6428 2830 2c20 302c 2077 696e  nbind((0, 0, win
-00027580: 646f 775f 7369 7a65 5b30 5d2c 2077 696e  dow_size[0], win
-00027590: 646f 775f 7369 7a65 5b31 5d29 290d 0a0d  dow_size[1]))...
-000275a0: 0a20 2020 2020 2020 2023 202d 2052 656e  .        # - Ren
-000275b0: 6465 7269 6e67 2061 2064 6570 7468 206d  dering a depth m
-000275c0: 6173 6b20 746f 2066 696e 6420 7768 6572  ask to find wher
-000275d0: 6520 746f 2053 544f 5020 7361 6d70 6c69  e to STOP sampli
-000275e0: 6e67 2072 6179 730d 0a20 2020 2020 2020  ng rays..       
-000275f0: 2073 656c 662e 7261 795f 7472 6163 655f   self.ray_trace_
-00027600: 6662 6f5f 622e 6269 6e64 2829 0d0a 2020  fbo_b.bind()..  
-00027610: 2020 2020 2020 676c 436c 6561 7244 6570        glClearDep
-00027620: 7468 2830 2e30 290d 0a20 2020 2020 2020  th(0.0)..       
-00027630: 2067 6c45 6e61 626c 6528 474c 5f44 4550   glEnable(GL_DEP
-00027640: 5448 5f54 4553 5429 0d0a 2020 2020 2020  TH_TEST)..      
-00027650: 2020 676c 4465 7074 6846 756e 6328 474c    glDepthFunc(GL
-00027660: 5f47 5245 4154 4552 290d 0a20 2020 2020  _GREATER)..     
-00027670: 2020 2067 6c44 6570 7468 4d61 736b 2847     glDepthMask(G
-00027680: 4c5f 5452 5545 290d 0a20 2020 2020 2020  L_TRUE)..       
-00027690: 2067 6c43 6c65 6172 2847 4c5f 4445 5054   glClear(GL_DEPT
-000276a0: 485f 4255 4646 4552 5f42 4954 290d 0a0d  H_BUFFER_BIT)...
-000276b0: 0a20 2020 2020 2020 2073 656c 662e 6465  .        self.de
-000276c0: 7074 685f 6d61 736b 5f73 6861 6465 722e  pth_mask_shader.
-000276d0: 6269 6e64 2829 0d0a 2020 2020 2020 2020  bind()..        
-000276e0: 7365 6c66 2e64 6570 7468 5f6d 6173 6b5f  self.depth_mask_
-000276f0: 7368 6164 6572 2e75 6e69 666f 726d 6d61  shader.uniformma
-00027700: 7434 2822 7670 4d61 7422 2c20 6361 6d65  t4("vpMat", came
-00027710: 7261 2e6d 6174 7269 7829 0d0a 2020 2020  ra.matrix)..    
-00027720: 2020 2020 7365 6c66 2e64 6570 7468 5f6d      self.depth_m
-00027730: 6173 6b5f 7368 6164 6572 2e75 6e69 666f  ask_shader.unifo
-00027740: 726d 3169 2822 6f76 6572 7269 6465 5f7a  rm1i("override_z
-00027750: 222c 2030 290d 0a20 2020 2020 2020 2073  ", 0)..        s
-00027760: 656c 662e 6465 7074 685f 6d61 736b 5f73  elf.depth_mask_s
-00027770: 6861 6465 722e 756e 6966 6f72 6d31 6628  hader.uniform1f(
-00027780: 226f 7665 7272 6964 655f 7a5f 7661 6c22  "override_z_val"
-00027790: 2c20 302e 3029 0d0a 2020 2020 2020 2020  , 0.0)..        
-000277a0: 626f 785f 7661 2e62 696e 6428 290d 0a20  box_va.bind().. 
-000277b0: 2020 2020 2020 2067 6c44 7261 7745 6c65         glDrawEle
-000277c0: 6d65 6e74 7328 474c 5f54 5249 414e 474c  ments(GL_TRIANGL
-000277d0: 4553 2c20 626f 785f 7661 2e69 6e64 6578  ES, box_va.index
-000277e0: 4275 6666 6572 2e67 6574 436f 756e 7428  Buffer.getCount(
-000277f0: 292c 2047 4c5f 554e 5349 474e 4544 5f53  ), GL_UNSIGNED_S
-00027800: 484f 5254 2c20 4e6f 6e65 290d 0a20 2020  HORT, None)..   
-00027810: 2020 2020 2062 6f78 5f76 612e 756e 6269       box_va.unbi
-00027820: 6e64 2829 0d0a 2020 2020 2020 2020 6966  nd()..        if
-00027830: 2053 6567 6d65 6e74 6174 696f 6e45 6469   SegmentationEdi
-00027840: 746f 722e 5049 434b 494e 475f 4652 414d  tor.PICKING_FRAM
-00027850: 455f 414c 5048 4120 213d 2030 2e30 3a20  E_ALPHA != 0.0: 
-00027860: 2023 2066 7261 6d65 2075 7365 6420 696e   # frame used in
-00027870: 2074 6865 2064 6570 7468 206d 6173 6b20   the depth mask 
-00027880: 6173 2077 656c 6c0d 0a20 2020 2020 2020  as well..       
-00027890: 2020 2020 2067 6c44 6570 7468 4675 6e63       glDepthFunc
-000278a0: 2847 4c5f 4c45 5353 290d 0a20 2020 2020  (GL_LESS)..     
-000278b0: 2020 2020 2020 2073 656c 662e 6465 7074         self.dept
-000278c0: 685f 6d61 736b 5f73 6861 6465 722e 756e  h_mask_shader.un
-000278d0: 6966 6f72 6d31 6928 226f 7665 7272 6964  iform1i("overrid
-000278e0: 655f 7a22 2c20 3129 0d0a 2020 2020 2020  e_z", 1)..      
-000278f0: 2020 2020 2020 7365 6c66 2e64 6570 7468        self.depth
-00027900: 5f6d 6173 6b5f 7368 6164 6572 2e75 6e69  _mask_shader.uni
-00027910: 666f 726d 3166 2822 6f76 6572 7269 6465  form1f("override
-00027920: 5f7a 5f76 616c 222c 2028 7365 5f66 7261  _z_val", (se_fra
-00027930: 6d65 2e63 7572 7265 6e74 5f73 6c69 6365  me.current_slice
-00027940: 202d 2073 655f 6672 616d 652e 6e5f 736c   - se_frame.n_sl
-00027950: 6963 6573 202f 2032 2920 2a20 7365 5f66  ices / 2) * se_f
-00027960: 7261 6d65 2e70 6978 656c 5f73 697a 6529  rame.pixel_size)
-00027970: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-00027980: 6c66 2e64 6570 7468 5f6d 6173 6b5f 7368  lf.depth_mask_sh
-00027990: 6164 6572 2e75 6e69 666f 726d 3166 2822  ader.uniform1f("
-000279a0: 7069 7865 6c5f 7369 7a65 222c 2073 655f  pixel_size", se_
-000279b0: 6672 616d 652e 7069 7865 6c5f 7369 7a65  frame.pixel_size
-000279c0: 290d 0a20 2020 2020 2020 2020 2020 2073  )..            s
-000279d0: 655f 6672 616d 652e 7175 6164 5f76 612e  e_frame.quad_va.
-000279e0: 6269 6e64 2829 2020 2320 6672 616d 6520  bind()  # frame 
-000279f0: 6465 7074 6820 6d61 736b 2061 7320 7765  depth mask as we
-00027a00: 6c6c 2e0d 0a20 2020 2020 2020 2020 2020  ll...           
-00027a10: 2067 6c44 7261 7745 6c65 6d65 6e74 7328   glDrawElements(
-00027a20: 474c 5f54 5249 414e 474c 4553 2c20 7365  GL_TRIANGLES, se
-00027a30: 5f66 7261 6d65 2e71 7561 645f 7661 2e69  _frame.quad_va.i
-00027a40: 6e64 6578 4275 6666 6572 2e67 6574 436f  ndexBuffer.getCo
-00027a50: 756e 7428 292c 2047 4c5f 554e 5349 474e  unt(), GL_UNSIGN
-00027a60: 4544 5f53 484f 5254 2c20 4e6f 6e65 290d  ED_SHORT, None).
-00027a70: 0a20 2020 2020 2020 2020 2020 2073 655f  .            se_
-00027a80: 6672 616d 652e 7175 6164 5f76 612e 756e  frame.quad_va.un
-00027a90: 6269 6e64 2829 0d0a 2020 2020 2020 2020  bind()..        
-00027aa0: 7365 6c66 2e64 6570 7468 5f6d 6173 6b5f  self.depth_mask_
-00027ab0: 7368 6164 6572 2e75 6e62 696e 6428 290d  shader.unbind().
-00027ac0: 0a20 2020 2020 2020 2073 656c 662e 7261  .        self.ra
-00027ad0: 795f 7472 6163 655f 6662 6f5f 622e 756e  y_trace_fbo_b.un
-00027ae0: 6269 6e64 2828 302c 2030 2c20 7769 6e64  bind((0, 0, wind
-00027af0: 6f77 5f73 697a 655b 305d 2c20 7769 6e64  ow_size[0], wind
-00027b00: 6f77 5f73 697a 655b 315d 2929 0d0a 0d0a  ow_size[1]))....
-00027b10: 2020 2020 2020 2020 676c 4465 7074 6846          glDepthF
-00027b20: 756e 6328 474c 5f4c 4553 5329 0d0a 2020  unc(GL_LESS)..  
-00027b30: 2020 2020 2020 676c 436c 6561 7244 6570        glClearDep
-00027b40: 7468 2831 2e30 290d 0a20 2020 2020 2020  th(1.0)..       
-00027b50: 2023 2032 202d 2072 6179 2074 7261 6369   # 2 - ray traci
-00027b60: 6e67 0d0a 2020 2020 2020 2020 7365 6c66  ng..        self
-00027b70: 2e72 6179 5f74 7261 6365 5f73 6861 6465  .ray_trace_shade
-00027b80: 722e 6269 6e64 2829 0d0a 2020 2020 2020  r.bind()..      
-00027b90: 2020 7365 6c66 2e72 6179 5f74 7261 6365    self.ray_trace
-00027ba0: 5f73 6861 6465 722e 756e 6966 6f72 6d6d  _shader.uniformm
-00027bb0: 6174 3428 2269 704d 6174 222c 2063 616d  at4("ipMat", cam
-00027bc0: 6572 612e 6970 6d61 7429 0d0a 2020 2020  era.ipmat)..    
-00027bd0: 2020 2020 7365 6c66 2e72 6179 5f74 7261      self.ray_tra
-00027be0: 6365 5f73 6861 6465 722e 756e 6966 6f72  ce_shader.unifor
-00027bf0: 6d6d 6174 3428 2269 764d 6174 222c 2063  mmat4("ivMat", c
-00027c00: 616d 6572 612e 6976 6d61 7429 0d0a 2020  amera.ivmat)..  
-00027c10: 2020 2020 2020 7365 6c66 2e72 6179 5f74        self.ray_t
-00027c20: 7261 6365 5f73 6861 6465 722e 756e 6966  race_shader.unif
-00027c30: 6f72 6d6d 6174 3428 2270 4d61 7422 2c20  ormmat4("pMat", 
-00027c40: 6361 6d65 7261 2e70 6d61 7429 0d0a 2020  camera.pmat)..  
-00027c50: 2020 2020 2020 7365 6c66 2e72 6179 5f74        self.ray_t
-00027c60: 7261 6365 5f73 6861 6465 722e 756e 6966  race_shader.unif
-00027c70: 6f72 6d31 6628 226e 6561 7222 2c20 6361  orm1f("near", ca
-00027c80: 6d65 7261 2e63 6c69 705f 6e65 6172 290d  mera.clip_near).
-00027c90: 0a20 2020 2020 2020 2073 656c 662e 7261  .        self.ra
-00027ca0: 795f 7472 6163 655f 7368 6164 6572 2e75  y_trace_shader.u
-00027cb0: 6e69 666f 726d 3166 2822 6661 7222 2c20  niform1f("far", 
-00027cc0: 6361 6d65 7261 2e63 6c69 705f 6661 7229  camera.clip_far)
-00027cd0: 0d0a 2020 2020 2020 2020 7365 6c66 2e72  ..        self.r
-00027ce0: 6179 5f74 7261 6365 5f73 6861 6465 722e  ay_trace_shader.
-00027cf0: 756e 6966 6f72 6d32 6628 2276 6965 7770  uniform2f("viewp
-00027d00: 6f72 7453 697a 6522 2c20 7769 6e64 6f77  ortSize", window
-00027d10: 5f73 697a 6529 0d0a 2020 2020 2020 2020  _size)..        
-00027d20: 7365 6c66 2e72 6179 5f74 7261 6365 5f73  self.ray_trace_s
-00027d30: 6861 6465 722e 756e 6966 6f72 6d31 6628  hader.uniform1f(
-00027d40: 227a 4c69 6d22 2c20 7365 5f66 7261 6d65  "zLim", se_frame
-00027d50: 2e6e 5f73 6c69 6365 7320 2a20 7365 5f66  .n_slices * se_f
-00027d60: 7261 6d65 2e70 6978 656c 5f73 697a 6520  rame.pixel_size 
-00027d70: 2f20 322e 3029 0d0a 2020 2020 2020 2020  / 2.0)..        
-00027d80: 7365 6c66 2e72 6179 5f74 7261 6365 5f73  self.ray_trace_s
-00027d90: 6861 6465 722e 756e 6966 6f72 6d31 6628  hader.uniform1f(
-00027da0: 2270 6978 656c 5369 7a65 222c 2073 655f  "pixelSize", se_
-00027db0: 6672 616d 652e 7069 7865 6c5f 7369 7a65  frame.pixel_size
-00027dc0: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
-00027dd0: 7261 795f 7472 6163 655f 7368 6164 6572  ray_trace_shader
-00027de0: 2e75 6e69 666f 726d 3266 2822 696d 6753  .uniform2f("imgS
-00027df0: 697a 6522 2c20 5b73 655f 6672 616d 652e  ize", [se_frame.
-00027e00: 6f76 6572 6c61 792e 7369 7a65 5b31 5d2c  overlay.size[1],
-00027e10: 2073 655f 6672 616d 652e 6f76 6572 6c61   se_frame.overla
-00027e20: 792e 7369 7a65 5b30 5d5d 290d 0a20 2020  y.size[0]])..   
-00027e30: 2020 2020 2073 656c 662e 7261 795f 7472       self.ray_tr
-00027e40: 6163 655f 7368 6164 6572 2e75 6e69 666f  ace_shader.unifo
-00027e50: 726d 3169 2822 7374 796c 6522 2c20 5365  rm1i("style", Se
-00027e60: 676d 656e 7461 7469 6f6e 4564 6974 6f72  gmentationEditor
-00027e70: 2e42 4c45 4e44 5f4d 4f44 4553 5f33 445b  .BLEND_MODES_3D[
-00027e80: 5365 676d 656e 7461 7469 6f6e 4564 6974  SegmentationEdit
-00027e90: 6f72 2e42 4c45 4e44 5f4d 4f44 4553 5f4c  or.BLEND_MODES_L
-00027ea0: 4953 545f 3344 5b53 6567 6d65 6e74 6174  IST_3D[Segmentat
-00027eb0: 696f 6e45 6469 746f 722e 4f56 4552 4c41  ionEditor.OVERLA
-00027ec0: 595f 424c 454e 445f 4d4f 4445 5f33 445d  Y_BLEND_MODE_3D]
-00027ed0: 5d5b 335d 290d 0a20 2020 2020 2020 2073  ][3])..        s
-00027ee0: 656c 662e 7261 795f 7472 6163 655f 7368  elf.ray_trace_sh
-00027ef0: 6164 6572 2e75 6e69 666f 726d 3166 2822  ader.uniform1f("
-00027f00: 696e 7465 6e73 6974 7922 2c20 5365 676d  intensity", Segm
-00027f10: 656e 7461 7469 6f6e 4564 6974 6f72 2e4f  entationEditor.O
-00027f20: 5645 524c 4159 5f49 4e54 454e 5349 5459  VERLAY_INTENSITY
-00027f30: 290d 0a20 2020 2020 2020 2073 655f 6672  )..        se_fr
-00027f40: 616d 652e 6f76 6572 6c61 792e 7465 7874  ame.overlay.text
-00027f50: 7572 652e 6269 6e64 2830 2920 2023 206f  ure.bind(0)  # o
-00027f60: 7665 726c 6179 2069 6d61 6765 2c20 746f  verlay image, to
-00027f70: 2072 6561 6420 6672 6f6d 0d0a 2020 2020   read from..    
-00027f80: 2020 2020 676c 4163 7469 7665 5465 7874      glActiveText
-00027f90: 7572 6528 474c 5f54 4558 5455 5245 3020  ure(GL_TEXTURE0 
-00027fa0: 2b20 3129 2020 2320 6465 7074 6820 6275  + 1)  # depth bu
-00027fb0: 6666 6572 2c20 746f 2072 6561 6420 6672  ffer, to read fr
-00027fc0: 6f6d 0d0a 2020 2020 2020 2020 676c 4269  om..        glBi
-00027fd0: 6e64 5465 7874 7572 6528 474c 5f54 4558  ndTexture(GL_TEX
-00027fe0: 5455 5245 5f32 442c 2073 656c 662e 7261  TURE_2D, self.ra
-00027ff0: 795f 7472 6163 655f 6662 6f5f 612e 6465  y_trace_fbo_a.de
-00028000: 7074 685f 7465 7874 7572 655f 7265 6e64  pth_texture_rend
-00028010: 6572 6572 5f69 6429 0d0a 2020 2020 2020  erer_id)..      
-00028020: 2020 676c 4163 7469 7665 5465 7874 7572    glActiveTextur
-00028030: 6528 474c 5f54 4558 5455 5245 3020 2b20  e(GL_TEXTURE0 + 
-00028040: 3229 0d0a 2020 2020 2020 2020 676c 4269  2)..        glBi
-00028050: 6e64 5465 7874 7572 6528 474c 5f54 4558  ndTexture(GL_TEX
-00028060: 5455 5245 5f32 442c 2073 656c 662e 7261  TURE_2D, self.ra
-00028070: 795f 7472 6163 655f 6662 6f5f 622e 6465  y_trace_fbo_b.de
-00028080: 7074 685f 7465 7874 7572 655f 7265 6e64  pth_texture_rend
-00028090: 6572 6572 5f69 6429 0d0a 2020 2020 2020  erer_id)..      
-000280a0: 2020 7365 6c66 2e72 6179 5f74 7261 6365    self.ray_trace
-000280b0: 5f66 626f 5f61 2e74 6578 7475 7265 2e62  _fbo_a.texture.b
-000280c0: 696e 645f 696d 6167 655f 736c 6f74 2833  ind_image_slot(3
-000280d0: 2c20 3129 2020 2320 6662 6f20 7465 7874  , 1)  # fbo text
-000280e0: 7572 652c 2074 6f20 7772 6974 6520 746f  ure, to write to
-000280f0: 0d0a 2020 2020 2020 2020 676c 4469 7370  ..        glDisp
-00028100: 6174 6368 436f 6d70 7574 6528 696e 7428  atchCompute(int(
-00028110: 7769 6e64 6f77 5f73 697a 655b 305d 202f  window_size[0] /
-00028120: 2f20 3136 2920 2b20 312c 2069 6e74 2877  / 16) + 1, int(w
-00028130: 696e 646f 775f 7369 7a65 5b31 5d20 2f2f  indow_size[1] //
-00028140: 2031 3629 202b 2031 2c20 3129 0d0a 2020   16) + 1, 1)..  
-00028150: 2020 2020 2020 676c 4d65 6d6f 7279 4261        glMemoryBa
-00028160: 7272 6965 7228 474c 5f53 4841 4445 525f  rrier(GL_SHADER_
-00028170: 494d 4147 455f 4143 4345 5353 5f42 4152  IMAGE_ACCESS_BAR
-00028180: 5249 4552 5f42 4954 290d 0a20 2020 2020  RIER_BIT)..     
-00028190: 2020 2053 6567 6d65 6e74 6174 696f 6e45     SegmentationE
-000281a0: 6469 746f 722e 5649 4557 5f52 4551 5549  ditor.VIEW_REQUI
-000281b0: 5245 535f 5550 4441 5445 203d 2046 616c  RES_UPDATE = Fal
-000281c0: 7365 0d0a 0d0a 2020 2020 6465 6620 7265  se....    def re
-000281d0: 6e64 6572 5f6f 7665 726c 6179 5f33 6428  nder_overlay_3d(
-000281e0: 7365 6c66 2c20 616c 7068 612c 2069 6e74  self, alpha, int
-000281f0: 656e 7369 7479 293a 0d0a 2020 2020 2020  ensity):..      
-00028200: 2020 2320 6164 6420 6f76 6572 6c61 7920    # add overlay 
-00028210: 696d 6167 6520 746f 2077 6861 7465 7665  image to whateve
-00028220: 7220 6861 7320 6265 656e 2072 656e 6465  r has been rende
-00028230: 7265 6420 6265 666f 7265 2e0d 0a20 2020  red before...   
-00028240: 2020 2020 2062 6c65 6e64 5f6d 6f64 6520       blend_mode 
-00028250: 3d20 5365 676d 656e 7461 7469 6f6e 4564  = SegmentationEd
-00028260: 6974 6f72 2e42 4c45 4e44 5f4d 4f44 4553  itor.BLEND_MODES
-00028270: 5f33 445b 5365 676d 656e 7461 7469 6f6e  _3D[Segmentation
-00028280: 4564 6974 6f72 2e42 4c45 4e44 5f4d 4f44  Editor.BLEND_MOD
-00028290: 4553 5f4c 4953 545f 3344 5b53 6567 6d65  ES_LIST_3D[Segme
-000282a0: 6e74 6174 696f 6e45 6469 746f 722e 4f56  ntationEditor.OV
-000282b0: 4552 4c41 595f 424c 454e 445f 4d4f 4445  ERLAY_BLEND_MODE
-000282c0: 5f33 445d 5d0d 0a20 2020 2020 2020 2067  _3D]]..        g
-000282d0: 6c42 6c65 6e64 4675 6e63 2862 6c65 6e64  lBlendFunc(blend
-000282e0: 5f6d 6f64 655b 305d 2c20 626c 656e 645f  _mode[0], blend_
-000282f0: 6d6f 6465 5b31 5d29 0d0a 2020 2020 2020  mode[1])..      
-00028300: 2020 676c 426c 656e 6445 7175 6174 696f    glBlendEquatio
-00028310: 6e28 626c 656e 645f 6d6f 6465 5b32 5d29  n(blend_mode[2])
-00028320: 0d0a 2020 2020 2020 2020 676c 4469 7361  ..        glDisa
-00028330: 626c 6528 474c 5f44 4550 5448 5f54 4553  ble(GL_DEPTH_TES
-00028340: 5429 0d0a 2020 2020 2020 2020 7365 6c66  T)..        self
-00028350: 2e6f 7665 726c 6179 5f62 6c65 6e64 5f73  .overlay_blend_s
-00028360: 6861 6465 722e 6269 6e64 2829 0d0a 2020  hader.bind()..  
-00028370: 2020 2020 2020 7365 6c66 2e6f 7665 726c        self.overl
-00028380: 6179 5f62 6c65 6e64 5f73 6861 6465 722e  ay_blend_shader.
-00028390: 756e 6966 6f72 6d31 6628 2261 6c70 6861  uniform1f("alpha
-000283a0: 222c 2061 6c70 6861 290d 0a20 2020 2020  ", alpha)..     
-000283b0: 2020 2073 656c 662e 6f76 6572 6c61 795f     self.overlay_
-000283c0: 626c 656e 645f 7368 6164 6572 2e75 6e69  blend_shader.uni
-000283d0: 666f 726d 3166 2822 696e 7465 6e73 6974  form1f("intensit
-000283e0: 7922 2c20 696e 7465 6e73 6974 7929 0d0a  y", intensity)..
-000283f0: 2020 2020 2020 2020 7365 6c66 2e72 6179          self.ray
-00028400: 5f74 7261 6365 5f66 626f 5f61 2e74 6578  _trace_fbo_a.tex
-00028410: 7475 7265 2e62 696e 6428 3029 0d0a 2020  ture.bind(0)..  
-00028420: 2020 2020 2020 7365 6c66 2e6e 6463 5f73        self.ndc_s
-00028430: 6372 6565 6e5f 7661 2e62 696e 6428 290d  creen_va.bind().
-00028440: 0a20 2020 2020 2020 2067 6c44 7261 7745  .        glDrawE
-00028450: 6c65 6d65 6e74 7328 474c 5f54 5249 414e  lements(GL_TRIAN
-00028460: 474c 4553 2c20 7365 6c66 2e6e 6463 5f73  GLES, self.ndc_s
-00028470: 6372 6565 6e5f 7661 2e69 6e64 6578 4275  creen_va.indexBu
-00028480: 6666 6572 2e67 6574 436f 756e 7428 292c  ffer.getCount(),
-00028490: 2047 4c5f 554e 5349 474e 4544 5f53 484f   GL_UNSIGNED_SHO
-000284a0: 5254 2c20 4e6f 6e65 290d 0a20 2020 2020  RT, None)..     
-000284b0: 2020 2073 656c 662e 6e64 635f 7363 7265     self.ndc_scre
-000284c0: 656e 5f76 612e 756e 6269 6e64 2829 0d0a  en_va.unbind()..
-000284d0: 2020 2020 2020 2020 7365 6c66 2e6f 7665          self.ove
-000284e0: 726c 6179 5f62 6c65 6e64 5f73 6861 6465  rlay_blend_shade
-000284f0: 722e 756e 6269 6e64 2829 0d0a 2020 2020  r.unbind()..    
-00028500: 2020 2020 676c 426c 656e 6446 756e 6328      glBlendFunc(
-00028510: 474c 5f53 5243 5f41 4c50 4841 2c20 474c  GL_SRC_ALPHA, GL
-00028520: 5f4f 4e45 5f4d 494e 5553 5f53 5243 5f41  _ONE_MINUS_SRC_A
-00028530: 4c50 4841 290d 0a20 2020 2020 2020 2067  LPHA)..        g
-00028540: 6c42 6c65 6e64 4571 7561 7469 6f6e 2847  lBlendEquation(G
-00028550: 4c5f 4655 4e43 5f41 4444 290d 0a0d 0a20  L_FUNC_ADD).... 
-00028560: 2020 2064 6566 2061 6464 5f6c 696e 6528     def add_line(
-00028570: 7365 6c66 2c20 7374 6172 745f 7879 2c20  self, start_xy, 
-00028580: 7374 6f70 5f78 792c 2063 6f6c 6f75 722c  stop_xy, colour,
-00028590: 2073 7562 7472 6163 743d 4661 6c73 6529   subtract=False)
-000285a0: 3a0d 0a20 2020 2020 2020 2069 6620 7375  :..        if su
-000285b0: 6274 7261 6374 3a0d 0a20 2020 2020 2020  btract:..       
-000285c0: 2020 2020 2073 656c 662e 6c69 6e65 5f6c       self.line_l
-000285d0: 6973 745f 732e 6170 7065 6e64 2828 7374  ist_s.append((st
-000285e0: 6172 745f 7879 2c20 7374 6f70 5f78 792c  art_xy, stop_xy,
-000285f0: 2063 6f6c 6f75 7229 290d 0a20 2020 2020   colour))..     
-00028600: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00028610: 2020 2020 2020 7365 6c66 2e6c 696e 655f        self.line_
-00028620: 6c69 7374 2e61 7070 656e 6428 2873 7461  list.append((sta
-00028630: 7274 5f78 792c 2073 746f 705f 7879 2c20  rt_xy, stop_xy, 
-00028640: 636f 6c6f 7572 2929 0d0a 0d0a 2020 2020  colour))....    
-00028650: 6465 6620 6164 645f 6369 7263 6c65 2873  def add_circle(s
-00028660: 656c 662c 2063 656e 7465 725f 7879 2c20  elf, center_xy, 
-00028670: 7261 6469 7573 2c20 636f 6c6f 7572 2c20  radius, colour, 
-00028680: 7365 676d 656e 7473 3d33 322c 2073 7562  segments=32, sub
-00028690: 7472 6163 743d 4661 6c73 6529 3a0d 0a20  tract=False):.. 
-000286a0: 2020 2020 2020 2074 6865 7461 203d 2030         theta = 0
-000286b0: 0d0a 2020 2020 2020 2020 7374 6172 745f  ..        start_
-000286c0: 7879 203d 2028 6365 6e74 6572 5f78 795b  xy = (center_xy[
-000286d0: 305d 202b 2072 6164 6975 7320 2a20 6e70  0] + radius * np
-000286e0: 2e63 6f73 2874 6865 7461 292c 2063 656e  .cos(theta), cen
-000286f0: 7465 725f 7879 5b31 5d20 2b20 7261 6469  ter_xy[1] + radi
-00028700: 7573 202a 206e 702e 7369 6e28 7468 6574  us * np.sin(thet
-00028710: 6129 290d 0a20 2020 2020 2020 2066 6f72  a))..        for
-00028720: 2069 2069 6e20 7261 6e67 6528 7365 676d   i in range(segm
-00028730: 656e 7473 293a 0d0a 2020 2020 2020 2020  ents):..        
-00028740: 2020 2020 7468 6574 6120 3d20 2869 202a      theta = (i *
-00028750: 2032 202a 206e 702e 7069 202f 2028 7365   2 * np.pi / (se
-00028760: 676d 656e 7473 202d 2031 2929 0d0a 2020  gments - 1))..  
-00028770: 2020 2020 2020 2020 2020 7374 6f70 5f78            stop_x
-00028780: 7920 3d20 2863 656e 7465 725f 7879 5b30  y = (center_xy[0
-00028790: 5d20 2b20 7261 6469 7573 202a 206e 702e  ] + radius * np.
-000287a0: 636f 7328 7468 6574 6129 2c20 6365 6e74  cos(theta), cent
-000287b0: 6572 5f78 795b 315d 202b 2072 6164 6975  er_xy[1] + radiu
-000287c0: 7320 2a20 6e70 2e73 696e 2874 6865 7461  s * np.sin(theta
-000287d0: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
-000287e0: 6966 2073 7562 7472 6163 743a 0d0a 2020  if subtract:..  
-000287f0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00028800: 6c66 2e6c 696e 655f 6c69 7374 5f73 2e61  lf.line_list_s.a
-00028810: 7070 656e 6428 2873 7461 7274 5f78 792c  ppend((start_xy,
-00028820: 2073 746f 705f 7879 2c20 636f 6c6f 7572   stop_xy, colour
-00028830: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
-00028840: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-00028850: 2020 2020 2020 2073 656c 662e 6c69 6e65         self.line
-00028860: 5f6c 6973 742e 6170 7065 6e64 2828 7374  _list.append((st
-00028870: 6172 745f 7879 2c20 7374 6f70 5f78 792c  art_xy, stop_xy,
-00028880: 2063 6f6c 6f75 7229 290d 0a20 2020 2020   colour))..     
-00028890: 2020 2020 2020 2073 7461 7274 5f78 7920         start_xy 
-000288a0: 3d20 2863 656e 7465 725f 7879 5b30 5d20  = (center_xy[0] 
-000288b0: 2b20 7261 6469 7573 202a 206e 702e 636f  + radius * np.co
-000288c0: 7328 7468 6574 6129 2c20 6365 6e74 6572  s(theta), center
-000288d0: 5f78 795b 315d 202b 2072 6164 6975 7320  _xy[1] + radius 
-000288e0: 2a20 6e70 2e73 696e 2874 6865 7461 2929  * np.sin(theta))
-000288f0: 0d0a 0d0a 2020 2020 6465 6620 6164 645f  ....    def add_
-00028900: 7371 7561 7265 2873 656c 662c 2063 656e  square(self, cen
-00028910: 7465 725f 7879 2c20 7369 7a65 2c20 636f  ter_xy, size, co
-00028920: 6c6f 7572 2c20 7375 6274 7261 6374 3d46  lour, subtract=F
-00028930: 616c 7365 293a 0d0a 2020 2020 2020 2020  alse):..        
-00028940: 626f 7474 6f6d 203d 2063 656e 7465 725f  bottom = center_
-00028950: 7879 5b31 5d20 2d20 7369 7a65 202f 2032  xy[1] - size / 2
-00028960: 0d0a 2020 2020 2020 2020 746f 7020 3d20  ..        top = 
-00028970: 6365 6e74 6572 5f78 795b 315d 202b 2073  center_xy[1] + s
-00028980: 697a 6520 2f20 320d 0a20 2020 2020 2020  ize / 2..       
-00028990: 206c 6566 7420 3d20 6365 6e74 6572 5f78   left = center_x
-000289a0: 795b 305d 202d 2073 697a 6520 2f20 320d  y[0] - size / 2.
-000289b0: 0a20 2020 2020 2020 2072 6967 6874 203d  .        right =
-000289c0: 2063 656e 7465 725f 7879 5b30 5d20 2b20   center_xy[0] + 
-000289d0: 7369 7a65 202f 2032 0d0a 2020 2020 2020  size / 2..      
-000289e0: 2020 6966 2073 7562 7472 6163 743a 0d0a    if subtract:..
-000289f0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00028a00: 2e6c 696e 655f 6c69 7374 5f73 2e61 7070  .line_list_s.app
-00028a10: 656e 6428 2828 6c65 6674 2c20 626f 7474  end(((left, bott
-00028a20: 6f6d 292c 2028 7269 6768 742c 2062 6f74  om), (right, bot
-00028a30: 746f 6d29 2c20 636f 6c6f 7572 2929 0d0a  tom), colour))..
-00028a40: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00028a50: 2e6c 696e 655f 6c69 7374 5f73 2e61 7070  .line_list_s.app
-00028a60: 656e 6428 2828 6c65 6674 2c20 746f 7029  end(((left, top)
-00028a70: 2c20 2872 6967 6874 2c20 746f 7029 2c20  , (right, top), 
-00028a80: 636f 6c6f 7572 2929 0d0a 2020 2020 2020  colour))..      
-00028a90: 2020 2020 2020 7365 6c66 2e6c 696e 655f        self.line_
-00028aa0: 6c69 7374 5f73 2e61 7070 656e 6428 2828  list_s.append(((
-00028ab0: 6c65 6674 2c20 626f 7474 6f6d 292c 2028  left, bottom), (
-00028ac0: 6c65 6674 2c20 746f 7029 2c20 636f 6c6f  left, top), colo
-00028ad0: 7572 2929 0d0a 2020 2020 2020 2020 2020  ur))..          
-00028ae0: 2020 7365 6c66 2e6c 696e 655f 6c69 7374    self.line_list
-00028af0: 5f73 2e61 7070 656e 6428 2828 7269 6768  _s.append(((righ
-00028b00: 742c 2062 6f74 746f 6d29 2c20 2872 6967  t, bottom), (rig
-00028b10: 6874 2c20 746f 7029 2c20 636f 6c6f 7572  ht, top), colour
-00028b20: 2929 0d0a 2020 2020 2020 2020 656c 7365  ))..        else
-00028b30: 3a0d 0a20 2020 2020 2020 2020 2020 2073  :..            s
-00028b40: 656c 662e 6c69 6e65 5f6c 6973 742e 6170  elf.line_list.ap
-00028b50: 7065 6e64 2828 286c 6566 742c 2062 6f74  pend(((left, bot
-00028b60: 746f 6d29 2c20 2872 6967 6874 2c20 626f  tom), (right, bo
-00028b70: 7474 6f6d 292c 2063 6f6c 6f75 7229 290d  ttom), colour)).
-00028b80: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00028b90: 662e 6c69 6e65 5f6c 6973 742e 6170 7065  f.line_list.appe
-00028ba0: 6e64 2828 286c 6566 742c 2074 6f70 292c  nd(((left, top),
-00028bb0: 2028 7269 6768 742c 2074 6f70 292c 2063   (right, top), c
-00028bc0: 6f6c 6f75 7229 290d 0a20 2020 2020 2020  olour))..       
-00028bd0: 2020 2020 2073 656c 662e 6c69 6e65 5f6c       self.line_l
-00028be0: 6973 742e 6170 7065 6e64 2828 286c 6566  ist.append(((lef
-00028bf0: 742c 2062 6f74 746f 6d29 2c20 286c 6566  t, bottom), (lef
-00028c00: 742c 2074 6f70 292c 2063 6f6c 6f75 7229  t, top), colour)
-00028c10: 290d 0a20 2020 2020 2020 2020 2020 2073  )..            s
-00028c20: 656c 662e 6c69 6e65 5f6c 6973 742e 6170  elf.line_list.ap
-00028c30: 7065 6e64 2828 2872 6967 6874 2c20 626f  pend(((right, bo
-00028c40: 7474 6f6d 292c 2028 7269 6768 742c 2074  ttom), (right, t
-00028c50: 6f70 292c 2063 6f6c 6f75 7229 290d 0a0d  op), colour))...
-00028c60: 0a20 2020 2064 6566 2072 656e 6465 725f  .    def render_
-00028c70: 6c69 6e65 7328 7365 6c66 2c20 6361 6d65  lines(self, came
-00028c80: 7261 293a 0d0a 2020 2020 2020 2020 6465  ra):..        de
-00028c90: 6620 7265 6e64 6572 5f6c 696e 6573 5f69  f render_lines_i
-00028ca0: 6e5f 6c69 7374 286c 696e 655f 6c69 7374  n_list(line_list
-00028cb0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-00028cc0: 2320 6d61 6b65 2056 410d 0a20 2020 2020  # make VA..     
-00028cd0: 2020 2020 2020 2076 6572 7469 6365 7320         vertices 
-00028ce0: 3d20 6c69 7374 2829 0d0a 2020 2020 2020  = list()..      
-00028cf0: 2020 2020 2020 696e 6469 6365 7320 3d20        indices = 
-00028d00: 6c69 7374 2829 0d0a 2020 2020 2020 2020  list()..        
-00028d10: 2020 2020 6920 3d20 300d 0a20 2020 2020      i = 0..     
-00028d20: 2020 2020 2020 2066 6f72 206c 696e 6520         for line 
-00028d30: 696e 206c 696e 655f 6c69 7374 3a0d 0a20  in line_list:.. 
-00028d40: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-00028d50: 6572 7469 6365 7320 2b3d 205b 2a6c 696e  ertices += [*lin
-00028d60: 655b 305d 2c20 2a6c 696e 655b 325d 5b3a  e[0], *line[2][:
-00028d70: 335d 5d0d 0a20 2020 2020 2020 2020 2020  3]]..           
-00028d80: 2020 2020 2076 6572 7469 6365 7320 2b3d       vertices +=
-00028d90: 205b 2a6c 696e 655b 315d 2c20 2a6c 696e   [*line[1], *lin
-00028da0: 655b 325d 5b3a 335d 5d0d 0a20 2020 2020  e[2][:3]]..     
-00028db0: 2020 2020 2020 2020 2020 2069 6e64 6963             indic
-00028dc0: 6573 202b 3d20 5b32 2a69 2c20 322a 692b  es += [2*i, 2*i+
-00028dd0: 315d 0d0a 2020 2020 2020 2020 2020 2020  1]..            
-00028de0: 2020 2020 6920 2b3d 2031 0d0a 2020 2020      i += 1..    
-00028df0: 2020 2020 2020 2020 7365 6c66 2e6c 696e          self.lin
-00028e00: 655f 7661 2e75 7064 6174 6528 5665 7274  e_va.update(Vert
-00028e10: 6578 4275 6666 6572 2876 6572 7469 6365  exBuffer(vertice
-00028e20: 7329 2c20 496e 6465 7842 7566 6665 7228  s), IndexBuffer(
-00028e30: 696e 6469 6365 7329 290d 0a0d 0a20 2020  indices))....   
-00028e40: 2020 2020 2020 2020 2023 206c 6175 6e63           # launc
-00028e50: 680d 0a20 2020 2020 2020 2020 2020 2067  h..            g
-00028e60: 6c42 6c65 6e64 4675 6e63 2847 4c5f 5352  lBlendFunc(GL_SR
-00028e70: 435f 414c 5048 412c 2047 4c5f 4f4e 455f  C_ALPHA, GL_ONE_
-00028e80: 4d49 4e55 535f 5352 435f 414c 5048 4129  MINUS_SRC_ALPHA)
-00028e90: 0d0a 2020 2020 2020 2020 2020 2020 676c  ..            gl
-00028ea0: 426c 656e 6445 7175 6174 696f 6e28 474c  BlendEquation(GL
-00028eb0: 5f46 554e 435f 4144 4429 0d0a 2020 2020  _FUNC_ADD)..    
-00028ec0: 2020 2020 2020 2020 7365 6c66 2e6c 696e          self.lin
-00028ed0: 655f 7368 6164 6572 2e62 696e 6428 290d  e_shader.bind().
-00028ee0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00028ef0: 662e 6c69 6e65 5f76 612e 6269 6e64 2829  f.line_va.bind()
-00028f00: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-00028f10: 6c66 2e6c 696e 655f 7368 6164 6572 2e75  lf.line_shader.u
-00028f20: 6e69 666f 726d 6d61 7434 2822 6361 6d65  niformmat4("came
-00028f30: 7261 4d61 7472 6978 222c 2063 616d 6572  raMatrix", camer
-00028f40: 612e 7669 6577 5f70 726f 6a65 6374 696f  a.view_projectio
-00028f50: 6e5f 6d61 7472 6978 290d 0a20 2020 2020  n_matrix)..     
-00028f60: 2020 2020 2020 2067 6c44 7261 7745 6c65         glDrawEle
-00028f70: 6d65 6e74 7328 474c 5f4c 494e 4553 2c20  ments(GL_LINES, 
-00028f80: 7365 6c66 2e6c 696e 655f 7661 2e69 6e64  self.line_va.ind
-00028f90: 6578 4275 6666 6572 2e67 6574 436f 756e  exBuffer.getCoun
-00028fa0: 7428 292c 2047 4c5f 554e 5349 474e 4544  t(), GL_UNSIGNED
-00028fb0: 5f53 484f 5254 2c20 4e6f 6e65 290d 0a20  _SHORT, None).. 
-00028fc0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00028fd0: 6c69 6e65 5f73 6861 6465 722e 756e 6269  line_shader.unbi
-00028fe0: 6e64 2829 0d0a 2020 2020 2020 2020 2020  nd()..          
-00028ff0: 2020 7365 6c66 2e6c 696e 655f 7661 2e75    self.line_va.u
-00029000: 6e62 696e 6428 290d 0a0d 0a20 2020 2020  nbind()....     
-00029010: 2020 2067 6c42 6c65 6e64 4675 6e63 2847     glBlendFunc(G
-00029020: 4c5f 4f4e 455f 4d49 4e55 535f 4453 545f  L_ONE_MINUS_DST_
-00029030: 434f 4c4f 522c 2047 4c5f 4f4e 455f 4d49  COLOR, GL_ONE_MI
-00029040: 4e55 535f 5352 435f 434f 4c4f 5229 0d0a  NUS_SRC_COLOR)..
-00029050: 2020 2020 2020 2020 676c 426c 656e 6445          glBlendE
-00029060: 7175 6174 696f 6e28 474c 5f46 554e 435f  quation(GL_FUNC_
-00029070: 4144 4429 0d0a 2020 2020 2020 2020 7265  ADD)..        re
-00029080: 6e64 6572 5f6c 696e 6573 5f69 6e5f 6c69  nder_lines_in_li
-00029090: 7374 2873 656c 662e 6c69 6e65 5f6c 6973  st(self.line_lis
-000290a0: 745f 7329 0d0a 0d0a 2020 2020 2020 2020  t_s)....        
-000290b0: 676c 426c 656e 6446 756e 6328 474c 5f53  glBlendFunc(GL_S
-000290c0: 5243 5f41 4c50 4841 2c20 474c 5f4f 4e45  RC_ALPHA, GL_ONE
-000290d0: 5f4d 494e 5553 5f53 5243 5f41 4c50 4841  _MINUS_SRC_ALPHA
-000290e0: 290d 0a20 2020 2020 2020 2067 6c42 6c65  )..        glBle
-000290f0: 6e64 4571 7561 7469 6f6e 2847 4c5f 4655  ndEquation(GL_FU
-00029100: 4e43 5f41 4444 290d 0a20 2020 2020 2020  NC_ADD)..       
-00029110: 2072 656e 6465 725f 6c69 6e65 735f 696e   render_lines_in
-00029120: 5f6c 6973 7428 7365 6c66 2e6c 696e 655f  _list(self.line_
-00029130: 6c69 7374 290d 0a0d 0a20 2020 2020 2020  list)....       
-00029140: 2073 656c 662e 6c69 6e65 5f6c 6973 745f   self.line_list_
-00029150: 7320 3d20 6c69 7374 2829 0d0a 2020 2020  s = list()..    
-00029160: 2020 2020 7365 6c66 2e6c 696e 655f 6c69      self.line_li
-00029170: 7374 203d 206c 6973 7428 290d 0a0d 0a20  st = list().... 
-00029180: 2020 2064 6566 2072 656e 6465 725f 6472     def render_dr
-00029190: 6177 5f6c 6973 7428 7365 6c66 2c20 6361  aw_list(self, ca
-000291a0: 6d65 7261 293a 0d0a 2020 2020 2020 2020  mera):..        
-000291b0: 7365 6c66 2e72 656e 6465 725f 6c69 6e65  self.render_line
-000291c0: 7328 6361 6d65 7261 290d 0a0d 0a20 2020  s(camera)....   
-000291d0: 2064 6566 2072 656e 6465 725f 6f76 6572   def render_over
-000291e0: 6c61 7928 7365 6c66 2c20 7365 5f66 7261  lay(self, se_fra
-000291f0: 6d65 2c20 6361 6d65 7261 2c20 626c 656e  me, camera, blen
-00029200: 645f 6d6f 6465 2c20 616c 7068 6129 3a0d  d_mode, alpha):.
-00029210: 0a20 2020 2020 2020 2069 6620 7365 5f66  .        if se_f
-00029220: 7261 6d65 2e6f 7665 726c 6179 2069 7320  rame.overlay is 
-00029230: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
-00029240: 2020 2072 6574 7572 6e0d 0a20 2020 2020     return..     
-00029250: 2020 2069 6620 616c 7068 6120 3d3d 2030     if alpha == 0
-00029260: 2e30 3a0d 0a20 2020 2020 2020 2020 2020  .0:..           
-00029270: 2072 6574 7572 6e0d 0a20 2020 2020 2020   return..       
-00029280: 2067 6c42 6c65 6e64 4675 6e63 2862 6c65   glBlendFunc(ble
-00029290: 6e64 5f6d 6f64 655b 305d 2c20 626c 656e  nd_mode[0], blen
-000292a0: 645f 6d6f 6465 5b31 5d29 0d0a 2020 2020  d_mode[1])..    
-000292b0: 2020 2020 676c 426c 656e 6445 7175 6174      glBlendEquat
-000292c0: 696f 6e28 626c 656e 645f 6d6f 6465 5b32  ion(blend_mode[2
-000292d0: 5d29 0d0a 2020 2020 2020 2020 676c 4469  ])..        glDi
-000292e0: 7361 626c 6528 474c 5f44 4550 5448 5f54  sable(GL_DEPTH_T
-000292f0: 4553 5429 0d0a 2020 2020 2020 2020 7368  EST)..        sh
-00029300: 6164 6572 5f62 6c65 6e64 5f63 6f64 6520  ader_blend_code 
-00029310: 3d20 626c 656e 645f 6d6f 6465 5b33 5d0d  = blend_mode[3].
-00029320: 0a20 2020 2020 2020 2073 655f 6672 616d  .        se_fram
-00029330: 652e 7175 6164 5f76 612e 6269 6e64 2829  e.quad_va.bind()
-00029340: 0d0a 2020 2020 2020 2020 7365 5f66 7261  ..        se_fra
-00029350: 6d65 2e6f 7665 726c 6179 2e74 6578 7475  me.overlay.textu
-00029360: 7265 2e62 696e 6428 290d 0a20 2020 2020  re.bind()..     
-00029370: 2020 2073 656c 662e 6f76 6572 6c61 795f     self.overlay_
-00029380: 7368 6164 6572 2e62 696e 6428 290d 0a20  shader.bind().. 
-00029390: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-000293a0: 616e 6365 2863 616d 6572 612c 2043 616d  ance(camera, Cam
-000293b0: 6572 6133 4429 3a0d 0a20 2020 2020 2020  era3D):..       
-000293c0: 2020 2020 2073 656c 662e 6f76 6572 6c61       self.overla
-000293d0: 795f 7368 6164 6572 2e75 6e69 666f 726d  y_shader.uniform
-000293e0: 3169 2822 7265 6e64 6572 5f33 6422 2c20  1i("render_3d", 
-000293f0: 3129 0d0a 2020 2020 2020 2020 2020 2020  1)..            
-00029400: 7365 6c66 2e6f 7665 726c 6179 5f73 6861  self.overlay_sha
-00029410: 6465 722e 756e 6966 6f72 6d31 6628 2269  der.uniform1f("i
-00029420: 6e74 656e 7369 7479 222c 2053 6567 6d65  ntensity", Segme
-00029430: 6e74 6174 696f 6e45 6469 746f 722e 4f56  ntationEditor.OV
-00029440: 4552 4c41 595f 494e 5445 4e53 4954 5929  ERLAY_INTENSITY)
-00029450: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-00029460: 6c66 2e6f 7665 726c 6179 5f73 6861 6465  lf.overlay_shade
-00029470: 722e 756e 6966 6f72 6d31 6628 227a 5f70  r.uniform1f("z_p
-00029480: 6f73 222c 2028 7365 5f66 7261 6d65 2e63  os", (se_frame.c
-00029490: 7572 7265 6e74 5f73 6c69 6365 202d 2073  urrent_slice - s
-000294a0: 655f 6672 616d 652e 6e5f 736c 6963 6573  e_frame.n_slices
-000294b0: 202f 2032 2920 2a20 7365 5f66 7261 6d65   / 2) * se_frame
-000294c0: 2e70 6978 656c 5f73 697a 6529 0d0a 2020  .pixel_size)..  
-000294d0: 2020 2020 2020 2020 2020 7365 6c66 2e6f            self.o
-000294e0: 7665 726c 6179 5f73 6861 6465 722e 756e  verlay_shader.un
-000294f0: 6966 6f72 6d31 6628 2270 6978 656c 5f73  iform1f("pixel_s
-00029500: 697a 6522 2c20 7365 5f66 7261 6d65 2e70  ize", se_frame.p
-00029510: 6978 656c 5f73 697a 6529 2020 2320 5468  ixel_size)  # Th
-00029520: 6973 2066 6163 746f 7220 7368 6f75 6c64  is factor should
-00029530: 2062 6520 696e 2074 6865 2056 412c 2062   be in the VA, b
-00029540: 7574 2066 6978 696e 6720 7468 6174 206d  ut fixing that m
-00029550: 6573 7365 6420 7570 2074 6865 2032 4420  essed up the 2D 
-00029560: 7669 6577 202d 2063 6865 6170 2066 6978  view - cheap fix
-00029570: 2066 6f72 206e 6f77 0d0a 2020 2020 2020   for now..      
-00029580: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-00029590: 2020 2020 2073 656c 662e 6f76 6572 6c61       self.overla
-000295a0: 795f 7368 6164 6572 2e75 6e69 666f 726d  y_shader.uniform
-000295b0: 3169 2822 7265 6e64 6572 5f33 6422 2c20  1i("render_3d", 
-000295c0: 3029 0d0a 2020 2020 2020 2020 2020 2020  0)..            
-000295d0: 7365 6c66 2e6f 7665 726c 6179 5f73 6861  self.overlay_sha
-000295e0: 6465 722e 756e 6966 6f72 6d31 6628 2269  der.uniform1f("i
-000295f0: 6e74 656e 7369 7479 222c 2031 2e30 290d  ntensity", 1.0).
-00029600: 0a20 2020 2020 2020 2073 656c 662e 6f76  .        self.ov
-00029610: 6572 6c61 795f 7368 6164 6572 2e75 6e69  erlay_shader.uni
-00029620: 666f 726d 6d61 7434 2822 6361 6d65 7261  formmat4("camera
-00029630: 4d61 7472 6978 222c 2063 616d 6572 612e  Matrix", camera.
-00029640: 7669 6577 5f70 726f 6a65 6374 696f 6e5f  view_projection_
-00029650: 6d61 7472 6978 290d 0a20 2020 2020 2020  matrix)..       
-00029660: 2073 656c 662e 6f76 6572 6c61 795f 7368   self.overlay_sh
-00029670: 6164 6572 2e75 6e69 666f 726d 6d61 7434  ader.uniformmat4
-00029680: 2822 6d6f 6465 6c4d 6174 7269 7822 2c20  ("modelMatrix", 
-00029690: 7365 5f66 7261 6d65 2e74 7261 6e73 666f  se_frame.transfo
-000296a0: 726d 2e6d 6174 7269 7829 0d0a 2020 2020  rm.matrix)..    
-000296b0: 2020 2020 7365 6c66 2e6f 7665 726c 6179      self.overlay
-000296c0: 5f73 6861 6465 722e 756e 6966 6f72 6d31  _shader.uniform1
-000296d0: 6628 2261 6c70 6861 222c 2061 6c70 6861  f("alpha", alpha
-000296e0: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
-000296f0: 6f76 6572 6c61 795f 7368 6164 6572 2e75  overlay_shader.u
-00029700: 6e69 666f 726d 3169 2822 7368 6164 6572  niform1i("shader
-00029710: 5f62 6c65 6e64 5f63 6f64 6522 2c20 7368  _blend_code", sh
-00029720: 6164 6572 5f62 6c65 6e64 5f63 6f64 6529  ader_blend_code)
-00029730: 0d0a 2020 2020 2020 2020 676c 4472 6177  ..        glDraw
-00029740: 456c 656d 656e 7473 2847 4c5f 5452 4941  Elements(GL_TRIA
-00029750: 4e47 4c45 532c 2073 655f 6672 616d 652e  NGLES, se_frame.
-00029760: 7175 6164 5f76 612e 696e 6465 7842 7566  quad_va.indexBuf
-00029770: 6665 722e 6765 7443 6f75 6e74 2829 2c20  fer.getCount(), 
-00029780: 474c 5f55 4e53 4947 4e45 445f 5348 4f52  GL_UNSIGNED_SHOR
-00029790: 542c 204e 6f6e 6529 0d0a 2020 2020 2020  T, None)..      
-000297a0: 2020 7365 6c66 2e6f 7665 726c 6179 5f73    self.overlay_s
-000297b0: 6861 6465 722e 756e 6269 6e64 2829 0d0a  hader.unbind()..
-000297c0: 2020 2020 2020 2020 7365 5f66 7261 6d65          se_frame
-000297d0: 2e71 7561 645f 7661 2e75 6e62 696e 6428  .quad_va.unbind(
-000297e0: 290d 0a20 2020 2020 2020 2067 6c41 6374  )..        glAct
-000297f0: 6976 6554 6578 7475 7265 2847 4c5f 5445  iveTexture(GL_TE
-00029800: 5854 5552 4530 290d 0a0d 0a0d 0a63 6c61  XTURE0)......cla
-00029810: 7373 2043 616d 6572 613a 0d0a 2020 2020  ss Camera:..    
-00029820: 6465 6620 5f5f 696e 6974 5f5f 2873 656c  def __init__(sel
-00029830: 6629 3a0d 0a20 2020 2020 2020 2073 656c  f):..        sel
-00029840: 662e 7669 6577 5f6d 6174 7269 7820 3d20  f.view_matrix = 
-00029850: 6e70 2e69 6465 6e74 6974 7928 3429 0d0a  np.identity(4)..
-00029860: 2020 2020 2020 2020 7365 6c66 2e70 726f          self.pro
-00029870: 6a65 6374 696f 6e5f 6d61 7472 6978 203d  jection_matrix =
-00029880: 206e 702e 6964 656e 7469 7479 2834 290d   np.identity(4).
-00029890: 0a20 2020 2020 2020 2073 656c 662e 7669  .        self.vi
-000298a0: 6577 5f70 726f 6a65 6374 696f 6e5f 6d61  ew_projection_ma
-000298b0: 7472 6978 203d 206e 702e 6964 656e 7469  trix = np.identi
-000298c0: 7479 2834 290d 0a20 2020 2020 2020 2073  ty(4)..        s
-000298d0: 656c 662e 706f 7369 7469 6f6e 203d 206e  elf.position = n
-000298e0: 702e 7a65 726f 7328 3329 0d0a 2020 2020  p.zeros(3)..    
-000298f0: 2020 2020 7365 6c66 2e7a 6f6f 6d20 3d20      self.zoom = 
-00029900: 312e 300d 0a20 2020 2020 2020 2073 656c  1.0..        sel
-00029910: 662e 7072 6f6a 6563 7469 6f6e 5f77 6964  f.projection_wid
-00029920: 7468 203d 2031 0d0a 2020 2020 2020 2020  th = 1..        
-00029930: 7365 6c66 2e70 726f 6a65 6374 696f 6e5f  self.projection_
-00029940: 6865 6967 6874 203d 2031 0d0a 2020 2020  height = 1..    
-00029950: 2020 2020 7365 6c66 2e73 6574 5f70 726f      self.set_pro
-00029960: 6a65 6374 696f 6e5f 6d61 7472 6978 2863  jection_matrix(c
-00029970: 6667 2e77 696e 646f 775f 7769 6474 682c  fg.window_width,
-00029980: 2063 6667 2e77 696e 646f 775f 6865 6967   cfg.window_heig
-00029990: 6874 290d 0a0d 0a20 2020 2064 6566 2063  ht)....    def c
-000299a0: 7572 736f 725f 746f 5f77 6f72 6c64 5f70  ursor_to_world_p
-000299b0: 6f73 6974 696f 6e28 7365 6c66 2c20 6375  osition(self, cu
-000299c0: 7273 6f72 5f70 6f73 293a 0d0a 2020 2020  rsor_pos):..    
-000299d0: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
-000299e0: 2063 7572 736f 725f 7075 733a 206c 6973   cursor_pus: lis
-000299f0: 742c 205b 782c 2079 5d0d 0a20 2020 2020  t, [x, y]..     
-00029a00: 2020 2072 6574 7572 6e73 3a20 5b77 6f72     returns: [wor
-00029a10: 6c64 5f70 6f73 5f78 2c20 776f 726c 645f  ld_pos_x, world_
-00029a20: 706f 735f 795d 0d0a 2020 2020 2020 2020  pos_y]..        
-00029a30: 436f 6e76 6572 7473 2061 6e20 696e 7075  Converts an inpu
-00029a40: 7420 6375 7273 6f72 2070 6f73 6974 696f  t cursor positio
-00029a50: 6e20 746f 2063 6f72 7265 7370 6f6e 6469  n to correspondi
-00029a60: 6e67 2077 6f72 6c64 2070 6f73 6974 696f  ng world positio
-00029a70: 6e2e 2041 7373 756d 696e 6720 6f72 7468  n. Assuming orth
-00029a80: 6f67 7261 7068 6963 2070 726f 6a65 6374  ographic project
-00029a90: 696f 6e20 6d61 7472 6978 2e0d 0a20 2020  ion matrix...   
-00029aa0: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
-00029ab0: 2020 696e 7665 7273 655f 6d61 7472 6978    inverse_matrix
-00029ac0: 203d 206e 702e 6c69 6e61 6c67 2e69 6e76   = np.linalg.inv
-00029ad0: 2873 656c 662e 7669 6577 5f70 726f 6a65  (self.view_proje
-00029ae0: 6374 696f 6e5f 6d61 7472 6978 290d 0a20  ction_matrix).. 
-00029af0: 2020 2020 2020 2077 696e 646f 775f 636f         window_co
-00029b00: 6f72 6469 6e61 7465 7320 3d20 2832 202a  ordinates = (2 *
-00029b10: 2063 7572 736f 725f 706f 735b 305d 202f   cursor_pos[0] /
-00029b20: 2063 6667 2e77 696e 646f 775f 7769 6474   cfg.window_widt
-00029b30: 6820 2d20 312c 2031 202d 2032 202a 2063  h - 1, 1 - 2 * c
-00029b40: 7572 736f 725f 706f 735b 315d 202f 2063  ursor_pos[1] / c
-00029b50: 6667 2e77 696e 646f 775f 6865 6967 6874  fg.window_height
-00029b60: 290d 0a20 2020 2020 2020 2077 696e 646f  )..        windo
-00029b70: 775f 7665 6320 3d20 6e70 2e6d 6174 7269  w_vec = np.matri
-00029b80: 7828 5b2a 7769 6e64 6f77 5f63 6f6f 7264  x([*window_coord
-00029b90: 696e 6174 6573 2c20 312e 302c 2031 2e30  inates, 1.0, 1.0
-00029ba0: 5d29 2e54 0d0a 2020 2020 2020 2020 776f  ]).T..        wo
-00029bb0: 726c 645f 7665 6320 3d20 2869 6e76 6572  rld_vec = (inver
-00029bc0: 7365 5f6d 6174 7269 7820 2a20 7769 6e64  se_matrix * wind
-00029bd0: 6f77 5f76 6563 290d 0a20 2020 2020 2020  ow_vec)..       
-00029be0: 2072 6574 7572 6e20 5b66 6c6f 6174 2877   return [float(w
-00029bf0: 6f72 6c64 5f76 6563 5b30 5d29 2c20 666c  orld_vec[0]), fl
-00029c00: 6f61 7428 776f 726c 645f 7665 635b 315d  oat(world_vec[1]
-00029c10: 295d 0d0a 0d0a 2020 2020 6465 6620 776f  )]....    def wo
-00029c20: 726c 645f 746f 5f73 6372 6565 6e5f 706f  rld_to_screen_po
-00029c30: 7369 7469 6f6e 2873 656c 662c 2077 6f72  sition(self, wor
-00029c40: 6c64 5f70 6f73 6974 696f 6e29 3a0d 0a20  ld_position):.. 
-00029c50: 2020 2020 2020 2076 6563 203d 206e 702e         vec = np.
-00029c60: 6d61 7472 6978 285b 776f 726c 645f 706f  matrix([world_po
-00029c70: 7369 7469 6f6e 5b30 5d2c 2077 6f72 6c64  sition[0], world
-00029c80: 5f70 6f73 6974 696f 6e5b 315d 2c20 302e  _position[1], 0.
-00029c90: 302c 2031 2e30 5d29 2e54 0d0a 2020 2020  0, 1.0]).T..    
-00029ca0: 2020 2020 7665 635f 6f75 7420 3d20 7365      vec_out = se
-00029cb0: 6c66 2e76 6965 775f 7072 6f6a 6563 7469  lf.view_projecti
-00029cc0: 6f6e 5f6d 6174 7269 7820 2a20 7665 630d  on_matrix * vec.
-00029cd0: 0a20 2020 2020 2020 2073 6372 6565 6e5f  .        screen_
-00029ce0: 7820 3d20 696e 7428 2831 202b 2066 6c6f  x = int((1 + flo
-00029cf0: 6174 2876 6563 5f6f 7574 5b30 5d29 2920  at(vec_out[0])) 
-00029d00: 2a20 7365 6c66 2e70 726f 6a65 6374 696f  * self.projectio
-00029d10: 6e5f 7769 6474 6820 2f20 322e 3029 0d0a  n_width / 2.0)..
-00029d20: 2020 2020 2020 2020 7363 7265 656e 5f79          screen_y
-00029d30: 203d 2069 6e74 2828 3120 2d20 666c 6f61   = int((1 - floa
-00029d40: 7428 7665 635f 6f75 745b 315d 2929 202a  t(vec_out[1])) *
-00029d50: 2073 656c 662e 7072 6f6a 6563 7469 6f6e   self.projection
-00029d60: 5f68 6569 6768 7420 2f20 322e 3029 0d0a  _height / 2.0)..
-00029d70: 2020 2020 2020 2020 7265 7475 726e 205b          return [
-00029d80: 7363 7265 656e 5f78 2c20 7363 7265 656e  screen_x, screen
-00029d90: 5f79 5d0d 0a0d 0a20 2020 2064 6566 2073  _y]....    def s
-00029da0: 6574 5f70 726f 6a65 6374 696f 6e5f 6d61  et_projection_ma
-00029db0: 7472 6978 2873 656c 662c 2077 696e 646f  trix(self, windo
-00029dc0: 775f 7769 6474 682c 2077 696e 646f 775f  w_width, window_
-00029dd0: 6865 6967 6874 293a 0d0a 2020 2020 2020  height):..      
-00029de0: 2020 7365 6c66 2e70 726f 6a65 6374 696f    self.projectio
-00029df0: 6e5f 6d61 7472 6978 203d 206e 702e 6d61  n_matrix = np.ma
-00029e00: 7472 6978 285b 0d0a 2020 2020 2020 2020  trix([..        
-00029e10: 2020 2020 5b32 202f 2077 696e 646f 775f      [2 / window_
-00029e20: 7769 6474 682c 2030 2c20 302c 2030 5d2c  width, 0, 0, 0],
-00029e30: 0d0a 2020 2020 2020 2020 2020 2020 5b30  ..            [0
-00029e40: 2c20 3220 2f20 7769 6e64 6f77 5f68 6569  , 2 / window_hei
-00029e50: 6768 742c 2030 2c20 305d 2c0d 0a20 2020  ght, 0, 0],..   
-00029e60: 2020 2020 2020 2020 205b 302c 2030 2c20           [0, 0, 
-00029e70: 2d32 202f 2031 3030 2c20 305d 2c0d 0a20  -2 / 100, 0],.. 
-00029e80: 2020 2020 2020 2020 2020 205b 302c 2030             [0, 0
-00029e90: 2c20 302c 2031 5d2c 0d0a 2020 2020 2020  , 0, 1],..      
-00029ea0: 2020 5d29 0d0a 2020 2020 2020 2020 7365    ])..        se
-00029eb0: 6c66 2e70 726f 6a65 6374 696f 6e5f 7769  lf.projection_wi
-00029ec0: 6474 6820 3d20 7769 6e64 6f77 5f77 6964  dth = window_wid
-00029ed0: 7468 0d0a 2020 2020 2020 2020 7365 6c66  th..        self
-00029ee0: 2e70 726f 6a65 6374 696f 6e5f 6865 6967  .projection_heig
-00029ef0: 6874 203d 2077 696e 646f 775f 6865 6967  ht = window_heig
-00029f00: 6874 0d0a 0d0a 2020 2020 6465 6620 6f6e  ht....    def on
-00029f10: 5f75 7064 6174 6528 7365 6c66 293a 0d0a  _update(self):..
-00029f20: 2020 2020 2020 2020 7365 6c66 2e76 6965          self.vie
-00029f30: 775f 6d61 7472 6978 203d 206e 702e 6d61  w_matrix = np.ma
-00029f40: 7472 6978 285b 0d0a 2020 2020 2020 2020  trix([..        
-00029f50: 2020 2020 5b73 656c 662e 7a6f 6f6d 2c20      [self.zoom, 
-00029f60: 302e 302c 2030 2e30 2c20 7365 6c66 2e70  0.0, 0.0, self.p
-00029f70: 6f73 6974 696f 6e5b 305d 202a 2073 656c  osition[0] * sel
-00029f80: 662e 7a6f 6f6d 5d2c 0d0a 2020 2020 2020  f.zoom],..      
-00029f90: 2020 2020 2020 5b30 2e30 2c20 7365 6c66        [0.0, self
-00029fa0: 2e7a 6f6f 6d2c 2030 2e30 2c20 7365 6c66  .zoom, 0.0, self
-00029fb0: 2e70 6f73 6974 696f 6e5b 315d 202a 2073  .position[1] * s
-00029fc0: 656c 662e 7a6f 6f6d 5d2c 0d0a 2020 2020  elf.zoom],..    
-00029fd0: 2020 2020 2020 2020 5b30 2e30 2c20 302e          [0.0, 0.
-00029fe0: 302c 2031 2e30 2c20 7365 6c66 2e70 6f73  0, 1.0, self.pos
-00029ff0: 6974 696f 6e5b 325d 5d2c 0d0a 2020 2020  ition[2]],..    
-0002a000: 2020 2020 2020 2020 5b30 2e30 2c20 302e          [0.0, 0.
-0002a010: 302c 2030 2e30 2c20 312e 305d 2c0d 0a20  0, 0.0, 1.0],.. 
-0002a020: 2020 2020 2020 205d 290d 0a20 2020 2020         ])..     
-0002a030: 2020 2073 656c 662e 7669 6577 5f70 726f     self.view_pro
-0002a040: 6a65 6374 696f 6e5f 6d61 7472 6978 203d  jection_matrix =
-0002a050: 206e 702e 6d61 746d 756c 2873 656c 662e   np.matmul(self.
-0002a060: 7072 6f6a 6563 7469 6f6e 5f6d 6174 7269  projection_matri
-0002a070: 782c 2073 656c 662e 7669 6577 5f6d 6174  x, self.view_mat
-0002a080: 7269 7829 0d0a 0d0a 0d0a 636c 6173 7320  rix)......class 
-0002a090: 4c69 6768 7433 443a 0d0a 2020 2020 6465  Light3D:..    de
-0002a0a0: 6620 5f5f 696e 6974 5f5f 2873 656c 6629  f __init__(self)
-0002a0b0: 3a0d 0a20 2020 2020 2020 2073 656c 662e  :..        self.
-0002a0c0: 636f 6c6f 7572 203d 2028 312e 302c 2031  colour = (1.0, 1
-0002a0d0: 2e30 2c20 312e 3029 0d0a 2020 2020 2020  .0, 1.0)..      
-0002a0e0: 2020 7365 6c66 2e76 6563 203d 2028 302e    self.vec = (0.
-0002a0f0: 302c 2031 2e30 2c20 302e 3029 0d0a 2020  0, 1.0, 0.0)..  
-0002a100: 2020 2020 2020 7365 6c66 2e79 6177 203d        self.yaw =
-0002a110: 2032 302e 300d 0a20 2020 2020 2020 2073   20.0..        s
-0002a120: 656c 662e 7069 7463 6820 3d20 302e 300d  elf.pitch = 0.0.
-0002a130: 0a20 2020 2020 2020 2073 656c 662e 7374  .        self.st
-0002a140: 7265 6e67 7468 203d 2030 2e35 0d0a 0d0a  rength = 0.5....
-0002a150: 2020 2020 6465 6620 636f 6d70 7574 655f      def compute_
-0002a160: 7665 6328 7365 6c66 2c20 6479 6177 3d30  vec(self, dyaw=0
-0002a170: 2c20 6470 6974 6368 3d30 293a 0d0a 2020  , dpitch=0):..  
-0002a180: 2020 2020 2020 2320 4361 6c63 756c 6174        # Calculat
-0002a190: 6520 7468 6520 6361 6d65 7261 2066 6f72  e the camera for
-0002a1a0: 7761 7264 2076 6563 746f 7220 6261 7365  ward vector base
-0002a1b0: 6420 6f6e 2070 6974 6368 2061 6e64 2079  d on pitch and y
-0002a1c0: 6177 0d0a 2020 2020 2020 2020 636f 735f  aw..        cos_
-0002a1d0: 7069 7463 6820 3d20 6e70 2e63 6f73 286e  pitch = np.cos(n
-0002a1e0: 702e 7261 6469 616e 7328 7365 6c66 2e70  p.radians(self.p
-0002a1f0: 6974 6368 202b 2064 7069 7463 6829 290d  itch + dpitch)).
-0002a200: 0a20 2020 2020 2020 2073 696e 5f70 6974  .        sin_pit
-0002a210: 6368 203d 206e 702e 7369 6e28 6e70 2e72  ch = np.sin(np.r
-0002a220: 6164 6961 6e73 2873 656c 662e 7069 7463  adians(self.pitc
-0002a230: 6820 2b20 6470 6974 6368 2929 0d0a 2020  h + dpitch))..  
-0002a240: 2020 2020 2020 636f 735f 7961 7720 3d20        cos_yaw = 
-0002a250: 6e70 2e63 6f73 286e 702e 7261 6469 616e  np.cos(np.radian
-0002a260: 7328 7365 6c66 2e79 6177 202b 2064 7961  s(self.yaw + dya
-0002a270: 7729 290d 0a20 2020 2020 2020 2073 696e  w))..        sin
-0002a280: 5f79 6177 203d 206e 702e 7369 6e28 6e70  _yaw = np.sin(np
-0002a290: 2e72 6164 6961 6e73 2873 656c 662e 7961  .radians(self.ya
-0002a2a0: 7720 2b20 6479 6177 2929 0d0a 0d0a 2020  w + dyaw))....  
-0002a2b0: 2020 2020 2020 666f 7277 6172 6420 3d20        forward = 
-0002a2c0: 6e70 2e61 7272 6179 285b 2d63 6f73 5f70  np.array([-cos_p
-0002a2d0: 6974 6368 202a 2073 696e 5f79 6177 2c20  itch * sin_yaw, 
-0002a2e0: 7369 6e5f 7069 7463 682c 202d 636f 735f  sin_pitch, -cos_
-0002a2f0: 7069 7463 6820 2a20 636f 735f 7961 775d  pitch * cos_yaw]
-0002a300: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
-0002a310: 7665 6320 3d20 666f 7277 6172 640d 0a0d  vec = forward...
-0002a320: 0a0d 0a63 6c61 7373 2043 616d 6572 6133  ...class Camera3
-0002a330: 443a 0d0a 2020 2020 6465 6620 5f5f 696e  D:..    def __in
-0002a340: 6974 5f5f 2873 656c 6629 3a0d 0a20 2020  it__(self):..   
-0002a350: 2020 2020 2073 656c 662e 7669 6577 5f6d       self.view_m
-0002a360: 6174 7269 7820 3d20 6e70 2e65 7965 2834  atrix = np.eye(4
-0002a370: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
-0002a380: 7072 6f6a 6563 7469 6f6e 5f6d 6174 7269  projection_matri
-0002a390: 7820 3d20 6e70 2e65 7965 2834 290d 0a20  x = np.eye(4).. 
-0002a3a0: 2020 2020 2020 2073 656c 662e 7669 6577         self.view
-0002a3b0: 5f70 726f 6a65 6374 696f 6e5f 6d61 7472  _projection_matr
-0002a3c0: 6978 203d 206e 702e 6579 6528 3429 0d0a  ix = np.eye(4)..
-0002a3d0: 2020 2020 2020 2020 7365 6c66 2e66 6f63          self.foc
-0002a3e0: 7573 203d 206e 702e 7a65 726f 7328 3329  us = np.zeros(3)
-0002a3f0: 0d0a 2020 2020 2020 2020 7365 6c66 2e70  ..        self.p
-0002a400: 6974 6368 203d 2030 2e30 0d0a 2020 2020  itch = 0.0..    
-0002a410: 2020 2020 7365 6c66 2e79 6177 203d 2031      self.yaw = 1
-0002a420: 3830 2e30 0d0a 2020 2020 2020 2020 7365  80.0..        se
-0002a430: 6c66 2e64 6973 7461 6e63 6520 3d20 3131  lf.distance = 11
-0002a440: 3230 2e30 0d0a 2020 2020 2020 2020 7365  20.0..        se
-0002a450: 6c66 2e63 6c69 705f 6e65 6172 203d 2031  lf.clip_near = 1
-0002a460: 652d 310d 0a20 2020 2020 2020 2073 656c  e-1..        sel
-0002a470: 662e 636c 6970 5f66 6172 203d 2031 6534  f.clip_far = 1e4
-0002a480: 0d0a 2020 2020 2020 2020 7365 6c66 2e70  ..        self.p
-0002a490: 726f 6a65 6374 696f 6e5f 7769 6474 6820  rojection_width 
-0002a4a0: 3d20 310d 0a20 2020 2020 2020 2073 656c  = 1..        sel
-0002a4b0: 662e 7072 6f6a 6563 7469 6f6e 5f68 6569  f.projection_hei
-0002a4c0: 6768 7420 3d20 310d 0a20 2020 2020 2020  ght = 1..       
-0002a4d0: 2073 656c 662e 7365 745f 7072 6f6a 6563   self.set_projec
-0002a4e0: 7469 6f6e 5f6d 6174 7269 7828 6366 672e  tion_matrix(cfg.
-0002a4f0: 7769 6e64 6f77 5f77 6964 7468 2c20 6366  window_width, cf
-0002a500: 672e 7769 6e64 6f77 5f68 6569 6768 7429  g.window_height)
-0002a510: 0d0a 0d0a 2020 2020 6465 6620 7365 745f  ....    def set_
-0002a520: 7072 6f6a 6563 7469 6f6e 5f6d 6174 7269  projection_matri
-0002a530: 7828 7365 6c66 2c20 7769 6e64 6f77 5f77  x(self, window_w
-0002a540: 6964 7468 2c20 7769 6e64 6f77 5f68 6569  idth, window_hei
-0002a550: 6768 7429 3a0d 0a20 2020 2020 2020 2073  ght):..        s
-0002a560: 656c 662e 7072 6f6a 6563 7469 6f6e 5f77  elf.projection_w
-0002a570: 6964 7468 203d 2077 696e 646f 775f 7769  idth = window_wi
-0002a580: 6474 680d 0a20 2020 2020 2020 2073 656c  dth..        sel
-0002a590: 662e 7072 6f6a 6563 7469 6f6e 5f68 6569  f.projection_hei
-0002a5a0: 6768 7420 3d20 7769 6e64 6f77 5f68 6569  ght = window_hei
-0002a5b0: 6768 740d 0a20 2020 2020 2020 2073 656c  ght..        sel
-0002a5c0: 662e 7570 6461 7465 5f70 726f 6a65 6374  f.update_project
-0002a5d0: 696f 6e5f 6d61 7472 6978 2829 0d0a 0d0a  ion_matrix()....
-0002a5e0: 2020 2020 6465 6620 6375 7273 6f72 5f64      def cursor_d
-0002a5f0: 656c 7461 5f74 6f5f 776f 726c 645f 6465  elta_to_world_de
-0002a600: 6c74 6128 7365 6c66 2c20 6375 7273 6f72  lta(self, cursor
-0002a610: 5f64 656c 7461 293a 0d0a 2020 2020 2020  _delta):..      
-0002a620: 2020 7365 6c66 2e79 6177 202a 3d20 2d31    self.yaw *= -1
-0002a630: 0d0a 2020 2020 2020 2020 6361 6d65 7261  ..        camera
-0002a640: 5f72 6967 6874 203d 206e 702e 6372 6f73  _right = np.cros
-0002a650: 7328 5b30 2c20 312c 2030 5d2c 2073 656c  s([0, 1, 0], sel
-0002a660: 662e 6765 745f 666f 7277 6172 6428 2929  f.get_forward())
-0002a670: 0d0a 2020 2020 2020 2020 6361 6d65 7261  ..        camera
-0002a680: 5f75 7020 3d20 6e70 2e63 726f 7373 2863  _up = np.cross(c
-0002a690: 616d 6572 615f 7269 6768 742c 2073 656c  amera_right, sel
-0002a6a0: 662e 6765 745f 666f 7277 6172 6428 2929  f.get_forward())
-0002a6b0: 0d0a 2020 2020 2020 2020 7365 6c66 2e79  ..        self.y
-0002a6c0: 6177 202a 3d20 2d31 0d0a 2020 2020 2020  aw *= -1..      
-0002a6d0: 2020 7265 7475 726e 2063 7572 736f 725f    return cursor_
-0002a6e0: 6465 6c74 615b 305d 202a 2063 616d 6572  delta[0] * camer
-0002a6f0: 615f 7269 6768 7420 2b20 6375 7273 6f72  a_right + cursor
-0002a700: 5f64 656c 7461 5b31 5d20 2a20 6361 6d65  _delta[1] * came
-0002a710: 7261 5f75 700d 0a0d 0a20 2020 2064 6566  ra_up....    def
-0002a720: 2067 6574 5f66 6f72 7761 7264 2873 656c   get_forward(sel
-0002a730: 6629 3a0d 0a20 2020 2020 2020 2023 2043  f):..        # C
-0002a740: 616c 6375 6c61 7465 2074 6865 2063 616d  alculate the cam
-0002a750: 6572 6120 666f 7277 6172 6420 7665 6374  era forward vect
-0002a760: 6f72 2062 6173 6564 206f 6e20 7069 7463  or based on pitc
-0002a770: 6820 616e 6420 7961 770d 0a20 2020 2020  h and yaw..     
-0002a780: 2020 2063 6f73 5f70 6974 6368 203d 206e     cos_pitch = n
-0002a790: 702e 636f 7328 6e70 2e72 6164 6961 6e73  p.cos(np.radians
-0002a7a0: 2873 656c 662e 7069 7463 6829 290d 0a20  (self.pitch)).. 
-0002a7b0: 2020 2020 2020 2073 696e 5f70 6974 6368         sin_pitch
-0002a7c0: 203d 206e 702e 7369 6e28 6e70 2e72 6164   = np.sin(np.rad
-0002a7d0: 6961 6e73 2873 656c 662e 7069 7463 6829  ians(self.pitch)
-0002a7e0: 290d 0a20 2020 2020 2020 2063 6f73 5f79  )..        cos_y
-0002a7f0: 6177 203d 206e 702e 636f 7328 6e70 2e72  aw = np.cos(np.r
-0002a800: 6164 6961 6e73 2873 656c 662e 7961 7729  adians(self.yaw)
-0002a810: 290d 0a20 2020 2020 2020 2073 696e 5f79  )..        sin_y
-0002a820: 6177 203d 206e 702e 7369 6e28 6e70 2e72  aw = np.sin(np.r
-0002a830: 6164 6961 6e73 2873 656c 662e 7961 7729  adians(self.yaw)
-0002a840: 290d 0a0d 0a20 2020 2020 2020 2066 6f72  )....        for
-0002a850: 7761 7264 203d 206e 702e 6172 7261 7928  ward = np.array(
-0002a860: 5b2d 636f 735f 7069 7463 6820 2a20 7369  [-cos_pitch * si
-0002a870: 6e5f 7961 772c 2073 696e 5f70 6974 6368  n_yaw, sin_pitch
-0002a880: 2c20 2d63 6f73 5f70 6974 6368 202a 2063  , -cos_pitch * c
-0002a890: 6f73 5f79 6177 5d29 0d0a 2020 2020 2020  os_yaw])..      
-0002a8a0: 2020 7265 7475 726e 2066 6f72 7761 7264    return forward
-0002a8b0: 0d0a 0d0a 2020 2020 4070 726f 7065 7274  ....    @propert
-0002a8c0: 790d 0a20 2020 2064 6566 206d 6174 7269  y..    def matri
-0002a8d0: 7828 7365 6c66 293a 0d0a 2020 2020 2020  x(self):..      
-0002a8e0: 2020 7265 7475 726e 2073 656c 662e 7669    return self.vi
-0002a8f0: 6577 5f70 726f 6a65 6374 696f 6e5f 6d61  ew_projection_ma
-0002a900: 7472 6978 0d0a 0d0a 2020 2020 4070 726f  trix....    @pro
-0002a910: 7065 7274 790d 0a20 2020 2064 6566 2076  perty..    def v
-0002a920: 706d 6174 2873 656c 6629 3a0d 0a20 2020  pmat(self):..   
-0002a930: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0002a940: 2e76 6965 775f 7072 6f6a 6563 7469 6f6e  .view_projection
-0002a950: 5f6d 6174 7269 780d 0a0d 0a20 2020 2040  _matrix....    @
-0002a960: 7072 6f70 6572 7479 0d0a 2020 2020 6465  property..    de
-0002a970: 6620 6976 706d 6174 2873 656c 6629 3a0d  f ivpmat(self):.
-0002a980: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0002a990: 6e70 2e6c 696e 616c 672e 696e 7628 7365  np.linalg.inv(se
-0002a9a0: 6c66 2e76 6965 775f 7072 6f6a 6563 7469  lf.view_projecti
-0002a9b0: 6f6e 5f6d 6174 7269 7829 0d0a 0d0a 2020  on_matrix)....  
-0002a9c0: 2020 4070 726f 7065 7274 790d 0a20 2020    @property..   
-0002a9d0: 2064 6566 2070 6d61 7428 7365 6c66 293a   def pmat(self):
-0002a9e0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-0002a9f0: 2073 656c 662e 7072 6f6a 6563 7469 6f6e   self.projection
-0002aa00: 5f6d 6174 7269 780d 0a0d 0a20 2020 2040  _matrix....    @
-0002aa10: 7072 6f70 6572 7479 0d0a 2020 2020 6465  property..    de
-0002aa20: 6620 766d 6174 2873 656c 6629 3a0d 0a20  f vmat(self):.. 
-0002aa30: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0002aa40: 6c66 2e76 6965 775f 6d61 7472 6978 0d0a  lf.view_matrix..
-0002aa50: 0d0a 2020 2020 4070 726f 7065 7274 790d  ..    @property.
-0002aa60: 0a20 2020 2064 6566 2069 706d 6174 2873  .    def ipmat(s
-0002aa70: 656c 6629 3a0d 0a20 2020 2020 2020 2072  elf):..        r
-0002aa80: 6574 7572 6e20 6e70 2e6c 696e 616c 672e  eturn np.linalg.
-0002aa90: 696e 7628 7365 6c66 2e70 726f 6a65 6374  inv(self.project
-0002aaa0: 696f 6e5f 6d61 7472 6978 290d 0a0d 0a20  ion_matrix).... 
-0002aab0: 2020 2040 7072 6f70 6572 7479 0d0a 2020     @property..  
-0002aac0: 2020 6465 6620 6976 6d61 7428 7365 6c66    def ivmat(self
-0002aad0: 293a 0d0a 2020 2020 2020 2020 7265 7475  ):..        retu
-0002aae0: 726e 206e 702e 6c69 6e61 6c67 2e69 6e76  rn np.linalg.inv
-0002aaf0: 2873 656c 662e 7669 6577 5f6d 6174 7269  (self.view_matri
-0002ab00: 7829 0d0a 0d0a 2020 2020 6465 6620 6f6e  x)....    def on
-0002ab10: 5f75 7064 6174 6528 7365 6c66 293a 0d0a  _update(self):..
-0002ab20: 2020 2020 2020 2020 7365 6c66 2e75 7064          self.upd
-0002ab30: 6174 655f 7072 6f6a 6563 7469 6f6e 5f6d  ate_projection_m
-0002ab40: 6174 7269 7828 290d 0a20 2020 2020 2020  atrix()..       
-0002ab50: 2073 656c 662e 7570 6461 7465 5f76 6965   self.update_vie
-0002ab60: 775f 7072 6f6a 6563 7469 6f6e 5f6d 6174  w_projection_mat
-0002ab70: 7269 7828 290d 0a0d 0a20 2020 2064 6566  rix()....    def
-0002ab80: 2075 7064 6174 655f 7072 6f6a 6563 7469   update_projecti
-0002ab90: 6f6e 5f6d 6174 7269 7828 7365 6c66 293a  on_matrix(self):
-0002aba0: 0d0a 2020 2020 2020 2020 6173 7065 6374  ..        aspect
-0002abb0: 5f72 6174 696f 203d 2073 656c 662e 7072  _ratio = self.pr
-0002abc0: 6f6a 6563 7469 6f6e 5f77 6964 7468 202f  ojection_width /
-0002abd0: 2073 656c 662e 7072 6f6a 6563 7469 6f6e   self.projection
-0002abe0: 5f68 6569 6768 740d 0a20 2020 2020 2020  _height..       
-0002abf0: 2073 656c 662e 7072 6f6a 6563 7469 6f6e   self.projection
-0002ac00: 5f6d 6174 7269 7820 3d20 4361 6d65 7261  _matrix = Camera
-0002ac10: 3344 2e63 7265 6174 655f 7065 7273 7065  3D.create_perspe
-0002ac20: 6374 6976 655f 6d61 7472 6978 2836 302e  ctive_matrix(60.
-0002ac30: 302c 2061 7370 6563 745f 7261 7469 6f2c  0, aspect_ratio,
-0002ac40: 2073 656c 662e 636c 6970 5f6e 6561 722c   self.clip_near,
-0002ac50: 2073 656c 662e 636c 6970 5f66 6172 290d   self.clip_far).
-0002ac60: 0a20 2020 2020 2020 2073 656c 662e 7570  .        self.up
-0002ac70: 6461 7465 5f76 6965 775f 7072 6f6a 6563  date_view_projec
-0002ac80: 7469 6f6e 5f6d 6174 7269 7828 290d 0a0d  tion_matrix()...
-0002ac90: 0a20 2020 2040 7374 6174 6963 6d65 7468  .    @staticmeth
-0002aca0: 6f64 0d0a 2020 2020 6465 6620 6372 6561  od..    def crea
-0002acb0: 7465 5f70 6572 7370 6563 7469 7665 5f6d  te_perspective_m
-0002acc0: 6174 7269 7828 666f 762c 2061 7370 6563  atrix(fov, aspec
-0002acd0: 745f 7261 7469 6f2c 206e 6561 722c 2066  t_ratio, near, f
-0002ace0: 6172 293a 0d0a 2020 2020 2020 2020 5320  ar):..        S 
-0002acf0: 3d20 3120 2f20 286e 702e 7461 6e28 302e  = 1 / (np.tan(0.
-0002ad00: 3520 2a20 666f 7620 2f20 3138 302e 3020  5 * fov / 180.0 
-0002ad10: 2a20 6e70 2e70 6929 290d 0a20 2020 2020  * np.pi))..     
-0002ad20: 2020 2066 203d 2066 6172 0d0a 2020 2020     f = far..    
-0002ad30: 2020 2020 6e20 3d20 6e65 6172 0d0a 0d0a      n = near....
-0002ad40: 2020 2020 2020 2020 7072 6f6a 6563 7469          projecti
-0002ad50: 6f6e 5f6d 6174 7269 7820 3d20 6e70 2e7a  on_matrix = np.z
-0002ad60: 6572 6f73 2828 342c 2034 2929 0d0a 2020  eros((4, 4))..  
-0002ad70: 2020 2020 2020 7072 6f6a 6563 7469 6f6e        projection
-0002ad80: 5f6d 6174 7269 785b 302c 2030 5d20 3d20  _matrix[0, 0] = 
-0002ad90: 5320 2f20 6173 7065 6374 5f72 6174 696f  S / aspect_ratio
-0002ada0: 0d0a 2020 2020 2020 2020 7072 6f6a 6563  ..        projec
-0002adb0: 7469 6f6e 5f6d 6174 7269 785b 312c 2031  tion_matrix[1, 1
-0002adc0: 5d20 3d20 530d 0a20 2020 2020 2020 2070  ] = S..        p
-0002add0: 726f 6a65 6374 696f 6e5f 6d61 7472 6978  rojection_matrix
-0002ade0: 5b32 2c20 325d 203d 202d 6620 2f20 2866  [2, 2] = -f / (f
-0002adf0: 202d 206e 290d 0a20 2020 2020 2020 2070   - n)..        p
-0002ae00: 726f 6a65 6374 696f 6e5f 6d61 7472 6978  rojection_matrix
-0002ae10: 5b33 2c20 325d 203d 202d 310d 0a20 2020  [3, 2] = -1..   
-0002ae20: 2020 2020 2070 726f 6a65 6374 696f 6e5f       projection_
-0002ae30: 6d61 7472 6978 5b32 2c20 335d 203d 202d  matrix[2, 3] = -
-0002ae40: 6620 2a20 6e20 2f20 2866 202d 206e 290d  f * n / (f - n).
-0002ae50: 0a0d 0a20 2020 2020 2020 2072 6574 7572  ...        retur
-0002ae60: 6e20 7072 6f6a 6563 7469 6f6e 5f6d 6174  n projection_mat
-0002ae70: 7269 780d 0a0d 0a20 2020 2064 6566 2075  rix....    def u
-0002ae80: 7064 6174 655f 7669 6577 5f70 726f 6a65  pdate_view_proje
-0002ae90: 6374 696f 6e5f 6d61 7472 6978 2873 656c  ction_matrix(sel
-0002aea0: 6629 3a0d 0a20 2020 2020 2020 2065 7965  f):..        eye
-0002aeb0: 5f70 6f73 6974 696f 6e20 3d20 7365 6c66  _position = self
-0002aec0: 2e63 616c 6375 6c61 7465 5f72 656c 6174  .calculate_relat
-0002aed0: 6976 655f 706f 7369 7469 6f6e 2873 656c  ive_position(sel
-0002aee0: 662e 666f 6375 732c 2073 656c 662e 7069  f.focus, self.pi
-0002aef0: 7463 682c 2073 656c 662e 7961 772c 2073  tch, self.yaw, s
-0002af00: 656c 662e 6469 7374 616e 6365 290d 0a20  elf.distance).. 
-0002af10: 2020 2020 2020 2073 656c 662e 7669 6577         self.view
-0002af20: 5f6d 6174 7269 7820 3d20 7365 6c66 2e63  _matrix = self.c
-0002af30: 7265 6174 655f 6c6f 6f6b 5f61 745f 6d61  reate_look_at_ma
-0002af40: 7472 6978 2865 7965 5f70 6f73 6974 696f  trix(eye_positio
-0002af50: 6e2c 2073 656c 662e 666f 6375 7329 0d0a  n, self.focus)..
-0002af60: 2020 2020 2020 2020 7365 6c66 2e76 6965          self.vie
-0002af70: 775f 7072 6f6a 6563 7469 6f6e 5f6d 6174  w_projection_mat
-0002af80: 7269 7820 3d20 7365 6c66 2e70 726f 6a65  rix = self.proje
-0002af90: 6374 696f 6e5f 6d61 7472 6978 2040 2073  ction_matrix @ s
-0002afa0: 656c 662e 7669 6577 5f6d 6174 7269 780d  elf.view_matrix.
-0002afb0: 0a0d 0a20 2020 2064 6566 2067 6574 5f76  ...    def get_v
-0002afc0: 6965 775f 6469 7265 6374 696f 6e28 7365  iew_direction(se
-0002afd0: 6c66 293a 0d0a 2020 2020 2020 2020 6579  lf):..        ey
-0002afe0: 655f 706f 7369 7469 6f6e 203d 2073 656c  e_position = sel
-0002aff0: 662e 6361 6c63 756c 6174 655f 7265 6c61  f.calculate_rela
-0002b000: 7469 7665 5f70 6f73 6974 696f 6e28 7365  tive_position(se
-0002b010: 6c66 2e66 6f63 7573 2c20 7365 6c66 2e70  lf.focus, self.p
-0002b020: 6974 6368 2c20 7365 6c66 2e79 6177 2c20  itch, self.yaw, 
-0002b030: 7365 6c66 2e64 6973 7461 6e63 6529 0d0a  self.distance)..
-0002b040: 2020 2020 2020 2020 666f 6375 735f 706f          focus_po
-0002b050: 7369 7469 6f6e 203d 206e 702e 6172 7261  sition = np.arra
-0002b060: 7928 7365 6c66 2e66 6f63 7573 290d 0a20  y(self.focus).. 
-0002b070: 2020 2020 2020 2076 6965 775f 6469 7220         view_dir 
-0002b080: 3d20 6579 655f 706f 7369 7469 6f6e 202d  = eye_position -
-0002b090: 2066 6f63 7573 5f70 6f73 6974 696f 6e0d   focus_position.
-0002b0a0: 0a20 2020 2020 2020 2076 6965 775f 6469  .        view_di
-0002b0b0: 7220 2f3d 206e 702e 7375 6d28 7669 6577  r /= np.sum(view
-0002b0c0: 5f64 6972 2a2a 3229 2a2a 302e 350d 0a20  _dir**2)**0.5.. 
-0002b0d0: 2020 2020 2020 2072 6574 7572 6e20 7669         return vi
-0002b0e0: 6577 5f64 6972 0d0a 0d0a 2020 2020 4073  ew_dir....    @s
-0002b0f0: 7461 7469 636d 6574 686f 640d 0a20 2020  taticmethod..   
-0002b100: 2064 6566 2063 616c 6375 6c61 7465 5f72   def calculate_r
-0002b110: 656c 6174 6976 655f 706f 7369 7469 6f6e  elative_position
-0002b120: 2862 6173 655f 706f 7369 7469 6f6e 2c20  (base_position, 
-0002b130: 7069 7463 682c 2079 6177 2c20 6469 7374  pitch, yaw, dist
-0002b140: 616e 6365 293a 0d0a 2020 2020 2020 2020  ance):..        
-0002b150: 636f 735f 7069 7463 6820 3d20 6e70 2e63  cos_pitch = np.c
-0002b160: 6f73 286e 702e 7261 6469 616e 7328 7069  os(np.radians(pi
-0002b170: 7463 6829 290d 0a20 2020 2020 2020 2073  tch))..        s
-0002b180: 696e 5f70 6974 6368 203d 206e 702e 7369  in_pitch = np.si
-0002b190: 6e28 6e70 2e72 6164 6961 6e73 2870 6974  n(np.radians(pit
-0002b1a0: 6368 2929 0d0a 2020 2020 2020 2020 636f  ch))..        co
-0002b1b0: 735f 7961 7720 3d20 6e70 2e63 6f73 286e  s_yaw = np.cos(n
-0002b1c0: 702e 7261 6469 616e 7328 7961 7729 290d  p.radians(yaw)).
-0002b1d0: 0a20 2020 2020 2020 2073 696e 5f79 6177  .        sin_yaw
-0002b1e0: 203d 206e 702e 7369 6e28 6e70 2e72 6164   = np.sin(np.rad
-0002b1f0: 6961 6e73 2879 6177 2929 0d0a 0d0a 2020  ians(yaw))....  
-0002b200: 2020 2020 2020 666f 7277 6172 6420 3d20        forward = 
-0002b210: 6e70 2e61 7272 6179 285b 0d0a 2020 2020  np.array([..    
-0002b220: 2020 2020 2020 2020 636f 735f 7069 7463          cos_pitc
-0002b230: 6820 2a20 7369 6e5f 7961 772c 0d0a 2020  h * sin_yaw,..  
-0002b240: 2020 2020 2020 2020 2020 7369 6e5f 7069            sin_pi
-0002b250: 7463 682c 0d0a 2020 2020 2020 2020 2020  tch,..          
-0002b260: 2020 2d63 6f73 5f70 6974 6368 202a 2063    -cos_pitch * c
-0002b270: 6f73 5f79 6177 0d0a 2020 2020 2020 2020  os_yaw..        
-0002b280: 5d29 0d0a 2020 2020 2020 2020 666f 7277  ])..        forw
-0002b290: 6172 6420 3d20 666f 7277 6172 6420 2f20  ard = forward / 
-0002b2a0: 6e70 2e6c 696e 616c 672e 6e6f 726d 2866  np.linalg.norm(f
-0002b2b0: 6f72 7761 7264 290d 0a0d 0a20 2020 2020  orward)....     
-0002b2c0: 2020 2072 656c 6174 6976 655f 706f 7369     relative_posi
-0002b2d0: 7469 6f6e 203d 2062 6173 655f 706f 7369  tion = base_posi
-0002b2e0: 7469 6f6e 202b 2066 6f72 7761 7264 202a  tion + forward *
-0002b2f0: 2064 6973 7461 6e63 650d 0a0d 0a20 2020   distance....   
-0002b300: 2020 2020 2072 6574 7572 6e20 7265 6c61       return rela
-0002b310: 7469 7665 5f70 6f73 6974 696f 6e0d 0a0d  tive_position...
-0002b320: 0a20 2020 2040 7374 6174 6963 6d65 7468  .    @staticmeth
-0002b330: 6f64 0d0a 2020 2020 6465 6620 6372 6561  od..    def crea
-0002b340: 7465 5f6c 6f6f 6b5f 6174 5f6d 6174 7269  te_look_at_matri
-0002b350: 7828 6579 652c 2070 6f73 6974 696f 6e29  x(eye, position)
-0002b360: 3a0d 0a20 2020 2020 2020 2066 6f72 7761  :..        forwa
-0002b370: 7264 203d 2043 616d 6572 6133 442e 6e6f  rd = Camera3D.no
-0002b380: 726d 616c 697a 6528 706f 7369 7469 6f6e  rmalize(position
-0002b390: 202d 2065 7965 290d 0a20 2020 2020 2020   - eye)..       
-0002b3a0: 2072 6967 6874 203d 2043 616d 6572 6133   right = Camera3
-0002b3b0: 442e 6e6f 726d 616c 697a 6528 6e70 2e63  D.normalize(np.c
-0002b3c0: 726f 7373 2866 6f72 7761 7264 2c20 6e70  ross(forward, np
-0002b3d0: 2e61 7272 6179 285b 302c 2031 2c20 305d  .array([0, 1, 0]
-0002b3e0: 2929 290d 0a20 2020 2020 2020 2075 7020  )))..        up 
-0002b3f0: 3d20 6e70 2e63 726f 7373 2872 6967 6874  = np.cross(right
-0002b400: 2c20 666f 7277 6172 6429 0d0a 0d0a 2020  , forward)....  
-0002b410: 2020 2020 2020 6c6f 6f6b 5f61 745f 6d61        look_at_ma
-0002b420: 7472 6978 203d 206e 702e 6579 6528 3429  trix = np.eye(4)
-0002b430: 0d0a 2020 2020 2020 2020 6c6f 6f6b 5f61  ..        look_a
-0002b440: 745f 6d61 7472 6978 5b30 2c20 3a33 5d20  t_matrix[0, :3] 
-0002b450: 3d20 7269 6768 740d 0a20 2020 2020 2020  = right..       
-0002b460: 206c 6f6f 6b5f 6174 5f6d 6174 7269 785b   look_at_matrix[
-0002b470: 312c 203a 335d 203d 2075 700d 0a20 2020  1, :3] = up..   
-0002b480: 2020 2020 206c 6f6f 6b5f 6174 5f6d 6174       look_at_mat
-0002b490: 7269 785b 322c 203a 335d 203d 202d 666f  rix[2, :3] = -fo
-0002b4a0: 7277 6172 640d 0a20 2020 2020 2020 206c  rward..        l
-0002b4b0: 6f6f 6b5f 6174 5f6d 6174 7269 785b 3a33  ook_at_matrix[:3
-0002b4c0: 2c20 335d 203d 202d 6e70 2e64 6f74 286c  , 3] = -np.dot(l
-0002b4d0: 6f6f 6b5f 6174 5f6d 6174 7269 785b 3a33  ook_at_matrix[:3
-0002b4e0: 2c20 3a33 5d2c 2065 7965 290d 0a20 2020  , :3], eye)..   
-0002b4f0: 2020 2020 2072 6574 7572 6e20 6c6f 6f6b       return look
-0002b500: 5f61 745f 6d61 7472 6978 0d0a 0d0a 2020  _at_matrix....  
-0002b510: 2020 4073 7461 7469 636d 6574 686f 640d    @staticmethod.
-0002b520: 0a20 2020 2064 6566 206e 6f72 6d61 6c69  .    def normali
-0002b530: 7a65 2876 293a 0d0a 2020 2020 2020 2020  ze(v):..        
-0002b540: 6e6f 726d 203d 206e 702e 6c69 6e61 6c67  norm = np.linalg
-0002b550: 2e6e 6f72 6d28 7629 0d0a 2020 2020 2020  .norm(v)..      
-0002b560: 2020 6966 206e 6f72 6d20 3d3d 2030 3a0d    if norm == 0:.
-0002b570: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0002b580: 7572 6e20 760d 0a20 2020 2020 2020 2072  urn v..        r
-0002b590: 6574 7572 6e20 7620 2f20 6e6f 726d 0d0a  eturn v / norm..
-0002b5a0: 0d0a 0d0a 636c 6173 7320 5175 6575 6564  ....class Queued
-0002b5b0: 4578 706f 7274 3a0d 0a20 2020 2064 6566  Export:..    def
-0002b5c0: 205f 5f69 6e69 745f 5f28 7365 6c66 2c20   __init__(self, 
-0002b5d0: 6469 7265 6374 6f72 792c 2064 6174 6173  directory, datas
-0002b5e0: 6574 2c20 6d6f 6465 6c73 2c20 6261 7463  et, models, batc
-0002b5f0: 685f 7369 7a65 2c20 6578 706f 7274 5f6f  h_size, export_o
-0002b600: 7665 726c 6179 293a 0d0a 2020 2020 2020  verlay):..      
-0002b610: 2020 7365 6c66 2e74 6167 203d 2064 6174    self.tag = dat
-0002b620: 6173 6574 2e70 6174 680d 0a20 2020 2020  aset.path..     
-0002b630: 2020 2073 656c 662e 6469 7265 6374 6f72     self.director
-0002b640: 7920 3d20 6469 7265 6374 6f72 790d 0a20  y = directory.. 
-0002b650: 2020 2020 2020 2073 656c 662e 6461 7461         self.data
-0002b660: 7365 7420 3d20 6461 7461 7365 740d 0a20  set = dataset.. 
-0002b670: 2020 2020 2020 2073 656c 662e 6d6f 6465         self.mode
-0002b680: 6c73 203d 206d 6f64 656c 730d 0a20 2020  ls = models..   
-0002b690: 2020 2020 2073 656c 662e 6578 706f 7274       self.export
-0002b6a0: 5f6f 7665 726c 6179 203d 2065 7870 6f72  _overlay = expor
-0002b6b0: 745f 6f76 6572 6c61 790d 0a20 2020 2020  t_overlay..     
-0002b6c0: 2020 2073 656c 662e 7072 6f63 6573 7320     self.process 
-0002b6d0: 3d20 4261 636b 6772 6f75 6e64 5072 6f63  = BackgroundProc
-0002b6e0: 6573 7328 7365 6c66 2e64 6f5f 6578 706f  ess(self.do_expo
-0002b6f0: 7274 2c20 2829 2c20 6e61 6d65 3d66 227b  rt, (), name=f"{
-0002b700: 7365 6c66 2e64 6174 6173 6574 2e74 6974  self.dataset.tit
-0002b710: 6c65 7d20 6578 706f 7274 2229 0d0a 2020  le} export")..  
-0002b720: 2020 2020 2020 6966 2073 656c 662e 6d6f        if self.mo
-0002b730: 6465 6c73 2021 3d20 5b5d 3a0d 0a20 2020  dels != []:..   
-0002b740: 2020 2020 2020 2020 2073 656c 662e 636f           self.co
-0002b750: 6c6f 7572 203d 2073 656c 662e 6d6f 6465  lour = self.mode
-0002b760: 6c73 5b30 5d2e 636f 6c6f 7572 0d0a 2020  ls[0].colour..  
-0002b770: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-0002b780: 2020 2020 2020 2020 2073 656c 662e 636f           self.co
-0002b790: 6c6f 7572 203d 2028 302e 302c 2030 2e30  lour = (0.0, 0.0
-0002b7a0: 2c20 302e 3029 0d0a 2020 2020 2020 2020  , 0.0)..        
-0002b7b0: 7365 6c66 2e62 6174 6368 5f73 697a 6520  self.batch_size 
-0002b7c0: 3d20 6261 7463 685f 7369 7a65 0d0a 0d0a  = batch_size....
-0002b7d0: 2020 2020 6465 6620 646f 5f65 7870 6f72      def do_expor
-0002b7e0: 7428 7365 6c66 2c20 7072 6f63 6573 7329  t(self, process)
-0002b7f0: 3a0d 0a20 2020 2020 2020 2074 7279 3a0d  :..        try:.
-0002b800: 0a20 2020 2020 2020 2020 2020 2070 726f  .            pro
-0002b810: 6365 7373 2e73 6574 5f70 726f 6772 6573  cess.set_progres
-0002b820: 7328 302e 3030 3031 290d 0a20 2020 2020  s(0.0001)..     
-0002b830: 2020 2020 2020 2073 7461 7274 5f74 696d         start_tim
-0002b840: 6520 3d20 7469 6d65 2e74 696d 6528 290d  e = time.time().
-0002b850: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
-0002b860: 6e74 2866 2251 7565 7565 6445 7870 6f72  nt(f"QueuedExpor
-0002b870: 7420 2d20 6c6f 6164 696e 6720 6461 7461  t - loading data
-0002b880: 7365 7420 7b73 656c 662e 6461 7461 7365  set {self.datase
-0002b890: 742e 7061 7468 7d22 290d 0a20 2020 2020  t.path}")..     
-0002b8a0: 2020 2020 2020 2072 782c 2072 7920 3d20         rx, ry = 
-0002b8b0: 7365 6c66 2e64 6174 6173 6574 2e67 6574  self.dataset.get
-0002b8c0: 5f72 6f69 5f69 6e64 6963 6573 2829 0d0a  _roi_indices()..
-0002b8d0: 2020 2020 2020 2020 2020 2020 6d72 6364              mrcd
-0002b8e0: 203d 206e 702e 6172 7261 7928 6d72 6366   = np.array(mrcf
-0002b8f0: 696c 652e 6f70 656e 2873 656c 662e 6461  ile.open(self.da
-0002b900: 7461 7365 742e 7061 7468 2c20 6d6f 6465  taset.path, mode
-0002b910: 3d27 7227 2c20 7065 726d 6973 7369 7665  ='r', permissive
-0002b920: 3d54 7275 6529 2e64 6174 615b 3a2c 203a  =True).data[:, :
-0002b930: 2c20 3a5d 290d 0a20 2020 2020 2020 2020  , :])..         
-0002b940: 2020 2074 6172 6765 745f 7479 7065 5f64     target_type_d
-0002b950: 6963 7420 3d20 7b6e 702e 666c 6f61 7433  ict = {np.float3
-0002b960: 323a 206e 702e 6474 7970 6528 2766 6c6f  2: np.dtype('flo
-0002b970: 6174 3332 2729 2c20 666c 6f61 743a 206e  at32'), float: n
-0002b980: 702e 6474 7970 6528 2766 6c6f 6174 3332  p.dtype('float32
-0002b990: 2729 2c20 6e70 2e64 7479 7065 2827 696e  '), np.dtype('in
-0002b9a0: 7438 2729 3a20 6e70 2e64 7479 7065 2827  t8'): np.dtype('
-0002b9b0: 7569 6e74 3827 292c 206e 702e 6474 7970  uint8'), np.dtyp
-0002b9c0: 6528 2769 6e74 3136 2729 3a20 6e70 2e64  e('int16'): np.d
-0002b9d0: 7479 7065 2827 666c 6f61 7433 3227 297d  type('float32')}
-0002b9e0: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-0002b9f0: 206d 7263 642e 6474 7970 6520 6e6f 7420   mrcd.dtype not 
-0002ba00: 696e 2074 6172 6765 745f 7479 7065 5f64  in target_type_d
-0002ba10: 6963 743a 0d0a 2020 2020 2020 2020 2020  ict:..          
-0002ba20: 2020 2020 2020 6d72 6364 203d 206d 7263        mrcd = mrc
-0002ba30: 642e 6173 7479 7065 2866 6c6f 6174 2c20  d.astype(float, 
-0002ba40: 636f 7079 3d46 616c 7365 290d 0a20 2020  copy=False)..   
-0002ba50: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
-0002ba60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ba70: 6d72 6364 203d 206e 702e 6172 7261 7928  mrcd = np.array(
-0002ba80: 6d72 6364 2e61 7374 7970 6528 7461 7267  mrcd.astype(targ
-0002ba90: 6574 5f74 7970 655f 6469 6374 5b6d 7263  et_type_dict[mrc
-0002baa0: 642e 6474 7970 655d 2c20 636f 7079 3d46  d.dtype], copy=F
-0002bab0: 616c 7365 292c 2064 7479 7065 3d6e 702e  alse), dtype=np.
-0002bac0: 6474 7970 6528 2766 6c6f 6174 3332 2729  dtype('float32')
-0002bad0: 290d 0a20 2020 2020 2020 2020 2020 2073  )..            s
-0002bae0: 656c 662e 6368 6563 6b5f 7374 6f70 5f72  elf.check_stop_r
-0002baf0: 6571 7565 7374 2829 0d0a 2020 2020 2020  equest()..      
-0002bb00: 2020 2020 2020 6e5f 736c 6963 6573 203d        n_slices =
-0002bb10: 206d 7263 642e 7368 6170 655b 305d 0d0a   mrcd.shape[0]..
-0002bb20: 2020 2020 2020 2020 2020 2020 6e5f 736c              n_sl
-0002bb30: 6963 6573 5f74 6f74 616c 203d 2028 7365  ices_total = (se
-0002bb40: 6c66 2e64 6174 6173 6574 2e65 7870 6f72  lf.dataset.expor
-0002bb50: 745f 746f 7020 2d20 7365 6c66 2e64 6174  t_top - self.dat
-0002bb60: 6173 6574 2e65 7870 6f72 745f 626f 7474  aset.export_bott
-0002bb70: 6f6d 2920 2a20 6d61 7828 312c 206c 656e  om) * max(1, len
-0002bb80: 2873 656c 662e 6d6f 6465 6c73 2929 0d0a  (self.models))..
-0002bb90: 2020 2020 2020 2020 2020 2020 6e5f 736c              n_sl
-0002bba0: 6963 6573 5f63 6f6d 706c 6574 6520 3d20  ices_complete = 
-0002bbb0: 300d 0a20 2020 2020 2020 2020 2020 2073  0..            s
-0002bbc0: 6567 6d65 6e74 6174 696f 6e73 203d 206e  egmentations = n
-0002bbd0: 702e 7a65 726f 7328 286c 656e 2873 656c  p.zeros((len(sel
-0002bbe0: 662e 6d6f 6465 6c73 292c 202a 6d72 6364  f.models), *mrcd
-0002bbf0: 2e73 6861 7065 292c 2064 7479 7065 3d6e  .shape), dtype=n
-0002bc00: 702e 7569 6e74 3829 0d0a 2020 2020 2020  p.uint8)..      
-0002bc10: 2020 2020 2020 6d5f 6964 7820 3d20 300d        m_idx = 0.
-0002bc20: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-0002bc30: 206d 2069 6e20 7365 6c66 2e6d 6f64 656c   m in self.model
-0002bc40: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
-0002bc50: 2020 2020 7072 696e 7428 6622 5175 6575      print(f"Queu
-0002bc60: 6564 4578 706f 7274 202d 2061 7070 6c79  edExport - apply
-0002bc70: 696e 6720 6d6f 6465 6c20 7b6d 2e74 6974  ing model {m.tit
-0002bc80: 6c65 7d20 287b 6d2e 696e 666f 7d29 2229  le} ({m.info})")
-0002bc90: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002bca0: 2020 7365 6c66 2e63 6f6c 6f75 7220 3d20    self.colour = 
-0002bcb0: 6d2e 636f 6c6f 7572 0d0a 2020 2020 2020  m.colour..      
-0002bcc0: 2020 2020 2020 2020 2020 736c 6963 6573            slices
-0002bcd0: 5f74 6f5f 7072 6f63 6573 7320 3d20 6c69  _to_process = li
-0002bce0: 7374 2872 616e 6765 2873 656c 662e 6461  st(range(self.da
-0002bcf0: 7461 7365 742e 6578 706f 7274 5f62 6f74  taset.export_bot
-0002bd00: 746f 6d2c 2073 656c 662e 6461 7461 7365  tom, self.datase
-0002bd10: 742e 6578 706f 7274 5f74 6f70 2929 0d0a  t.export_top))..
-0002bd20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bd30: 7768 696c 6520 6c65 6e28 736c 6963 6573  while len(slices
-0002bd40: 5f74 6f5f 7072 6f63 6573 7329 203e 2030  _to_process) > 0
-0002bd50: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0002bd60: 2020 2020 2020 2073 656c 662e 6368 6563         self.chec
-0002bd70: 6b5f 7374 6f70 5f72 6571 7565 7374 2829  k_stop_request()
-0002bd80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002bd90: 2020 2020 2020 696e 6469 6365 7320 3d20        indices = 
-0002bda0: 6c69 7374 2829 0d0a 2020 2020 2020 2020  list()..        
-0002bdb0: 2020 2020 2020 2020 2020 2020 696d 6167              imag
-0002bdc0: 6573 203d 206c 6973 7428 290d 0a20 2020  es = list()..   
-0002bdd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bde0: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
-0002bdf0: 7365 6c66 2e62 6174 6368 5f73 697a 6529  self.batch_size)
-0002be00: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0002be10: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
-0002be20: 6e28 736c 6963 6573 5f74 6f5f 7072 6f63  n(slices_to_proc
-0002be30: 6573 7329 203e 2030 3a0d 0a20 2020 2020  ess) > 0:..     
-0002be40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002be50: 2020 2020 2020 2069 6e64 6963 6573 2e61         indices.a
-0002be60: 7070 656e 6428 736c 6963 6573 5f74 6f5f  ppend(slices_to_
-0002be70: 7072 6f63 6573 732e 706f 7028 3029 290d  process.pop(0)).
-0002be80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002be90: 2020 2020 2020 2020 2020 2020 2069 6d61               ima
-0002bea0: 6765 732e 6170 7065 6e64 286d 7263 645b  ges.append(mrcd[
-0002beb0: 696e 6469 6365 735b 2d31 5d2c 2072 785b  indices[-1], rx[
-0002bec0: 305d 3a72 785b 315d 2c20 7279 5b30 5d3a  0]:rx[1], ry[0]:
-0002bed0: 7279 5b31 5d5d 290d 0a20 2020 2020 2020  ry[1]])..       
-0002bee0: 2020 2020 2020 2020 2020 2020 2073 6567               seg
-0002bef0: 5f69 6d61 6765 7320 3d20 6d2e 6170 706c  _images = m.appl
-0002bf00: 795f 746f 5f6d 756c 7469 706c 655f 736c  y_to_multiple_sl
-0002bf10: 6963 6573 2869 6d61 6765 732c 2073 656c  ices(images, sel
-0002bf20: 662e 6461 7461 7365 742e 7069 7865 6c5f  f.dataset.pixel_
-0002bf30: 7369 7a65 290d 0a20 2020 2020 2020 2020  size)..         
-0002bf40: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
-0002bf50: 2069 6e20 7261 6e67 6528 6c65 6e28 696e   in range(len(in
-0002bf60: 6469 6365 7329 293a 0d0a 2020 2020 2020  dices)):..      
-0002bf70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bf80: 2020 7365 676d 656e 7461 7469 6f6e 735b    segmentations[
-0002bf90: 6d5f 6964 782c 2069 6e64 6963 6573 5b69  m_idx, indices[i
-0002bfa0: 5d2c 2072 785b 305d 3a72 785b 315d 2c20  ], rx[0]:rx[1], 
-0002bfb0: 7279 5b30 5d3a 7279 5b31 5d5d 203d 2028  ry[0]:ry[1]] = (
-0002bfc0: 7365 675f 696d 6167 6573 5b69 5d20 2a20  seg_images[i] * 
-0002bfd0: 3235 3529 2e61 7374 7970 6528 6e70 2e75  255).astype(np.u
-0002bfe0: 696e 7438 290d 0a20 2020 2020 2020 2020  int8)..         
-0002bff0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-0002c000: 5f73 6c69 6365 735f 636f 6d70 6c65 7465  _slices_complete
-0002c010: 202b 3d20 310d 0a20 2020 2020 2020 2020   += 1..         
-0002c020: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0002c030: 656c 662e 7072 6f63 6573 732e 7365 745f  elf.process.set_
-0002c040: 7072 6f67 7265 7373 286d 696e 285b 302e  progress(min([0.
-0002c050: 3939 392c 206e 5f73 6c69 6365 735f 636f  999, n_slices_co
-0002c060: 6d70 6c65 7465 202f 206e 5f73 6c69 6365  mplete / n_slice
-0002c070: 735f 746f 7461 6c5d 2929 0d0a 0d0a 2020  s_total]))....  
-0002c080: 2020 2020 2020 2020 2020 2020 2020 6d5f                m_
-0002c090: 6964 7820 2b3d 2031 0d0a 2020 2020 2020  idx += 1..      
-0002c0a0: 2020 2020 2020 7365 6c66 2e63 6865 636b        self.check
-0002c0b0: 5f73 746f 705f 7265 7175 6573 7428 290d  _stop_request().
-0002c0c0: 0a20 2020 2020 2020 2020 2020 2023 2061  .            # a
-0002c0d0: 7070 6c79 2063 6f6d 7065 7469 7469 6f6e  pply competition
-0002c0e0: 0d0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
-0002c0f0: 696e 7428 6622 5175 6575 6564 4578 706f  int(f"QueuedExpo
-0002c100: 7274 202d 206d 6f64 656c 2063 6f6d 7065  rt - model compe
-0002c110: 7469 7469 6f6e 2229 0d0a 2020 2020 2020  tition")..      
-0002c120: 2020 2020 2020 656d 6973 7369 6f6e 5f69        emission_i
-0002c130: 6e64 6963 6573 203d 206c 6973 7428 290d  ndices = list().
-0002c140: 0a20 2020 2020 2020 2020 2020 2061 6273  .            abs
-0002c150: 6f72 7074 696f 6e5f 696e 6469 6365 7320  orption_indices 
-0002c160: 3d20 6c69 7374 2829 0d0a 2020 2020 2020  = list()..      
-0002c170: 2020 2020 2020 6920 3d20 300d 0a20 2020        i = 0..   
-0002c180: 2020 2020 2020 2020 2066 6f72 206d 2069           for m i
-0002c190: 6e20 7365 6c66 2e6d 6f64 656c 733a 0d0a  n self.models:..
-0002c1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c1b0: 6966 206d 2e65 6d69 743a 0d0a 2020 2020  if m.emit:..    
-0002c1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c1d0: 656d 6973 7369 6f6e 5f69 6e64 6963 6573  emission_indices
-0002c1e0: 2e61 7070 656e 6428 6929 0d0a 2020 2020  .append(i)..    
-0002c1f0: 2020 2020 2020 2020 2020 2020 6966 206d              if m
-0002c200: 2e61 6273 6f72 623a 0d0a 2020 2020 2020  .absorb:..      
-0002c210: 2020 2020 2020 2020 2020 2020 2020 6162                ab
-0002c220: 736f 7270 7469 6f6e 5f69 6e64 6963 6573  sorption_indices
-0002c230: 2e61 7070 656e 6428 6929 0d0a 2020 2020  .append(i)..    
-0002c240: 2020 2020 2020 2020 2020 2020 6920 2b3d              i +=
-0002c250: 2031 0d0a 2020 2020 2020 2020 2020 2020   1..            
-0002c260: 6966 206c 656e 2865 6d69 7373 696f 6e5f  if len(emission_
-0002c270: 696e 6469 6365 7329 203e 3d20 3120 616e  indices) >= 1 an
-0002c280: 6420 6c65 6e28 6162 736f 7270 7469 6f6e  d len(absorption
-0002c290: 5f69 6e64 6963 6573 2920 3e3d 2031 3a0d  _indices) >= 1:.
-0002c2a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002c2b0: 206d 6178 5f6d 6170 203d 206e 702e 6d61   max_map = np.ma
-0002c2c0: 7828 7365 676d 656e 7461 7469 6f6e 735b  x(segmentations[
-0002c2d0: 656d 6973 7369 6f6e 5f69 6e64 6963 6573  emission_indices
-0002c2e0: 2c20 3a2c 203a 2c20 3a5d 2c20 6178 6973  , :, :, :], axis
-0002c2f0: 3d30 290d 0a20 2020 2020 2020 2020 2020  =0)..           
-0002c300: 2020 2020 2066 6f72 2069 2069 6e20 6162       for i in ab
-0002c310: 736f 7270 7469 6f6e 5f69 6e64 6963 6573  sorption_indices
-0002c320: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0002c330: 2020 2020 2020 2073 656c 662e 6368 6563         self.chec
-0002c340: 6b5f 7374 6f70 5f72 6571 7565 7374 2829  k_stop_request()
-0002c350: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002c360: 2020 2020 2020 7365 676d 656e 7461 7469        segmentati
-0002c370: 6f6e 735b 692c 203a 2c20 3a2c 203a 5d5b  ons[i, :, :, :][
-0002c380: 7365 676d 656e 7461 7469 6f6e 735b 692c  segmentations[i,
-0002c390: 203a 2c20 3a2c 203a 5d20 3c20 6d61 785f   :, :, :] < max_
-0002c3a0: 6d61 705d 203d 2030 0d0a 0d0a 2020 2020  map] = 0....    
-0002c3b0: 2020 2020 2020 2020 2320 6170 706c 7920          # apply 
-0002c3c0: 696e 7465 7261 6374 696f 6e73 0d0a 2020  interactions..  
-0002c3d0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-0002c3e0: 6622 5175 6575 6564 4578 706f 7274 202d  f"QueuedExport -
-0002c3f0: 206d 6f64 656c 2069 6e74 6572 6163 7469   model interacti
-0002c400: 6f6e 7322 290d 0a20 2020 2020 2020 2020  ons")..         
-0002c410: 2020 2066 6f72 2069 6e74 6572 6163 7469     for interacti
-0002c420: 6f6e 2069 6e20 4d6f 6465 6c49 6e74 6572  on in ModelInter
-0002c430: 6163 7469 6f6e 2e61 6c6c 3a0d 0a20 2020  action.all:..   
-0002c440: 2020 2020 2020 2020 2020 2020 2074 6172               tar
-0002c450: 6765 745f 6d6f 6465 6c20 3d20 696e 7465  get_model = inte
-0002c460: 7261 6374 696f 6e2e 7061 7265 6e74 0d0a  raction.parent..
-0002c470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c480: 736f 7572 6365 5f6d 6f64 656c 203d 2069  source_model = i
-0002c490: 6e74 6572 6163 7469 6f6e 2e70 6172 746e  nteraction.partn
-0002c4a0: 6572 0d0a 2020 2020 2020 2020 2020 2020  er..            
-0002c4b0: 2020 2020 6966 2074 6172 6765 745f 6d6f      if target_mo
-0002c4c0: 6465 6c20 696e 2073 656c 662e 6d6f 6465  del in self.mode
-0002c4d0: 6c73 2061 6e64 2073 6f75 7263 655f 6d6f  ls and source_mo
-0002c4e0: 6465 6c20 696e 2073 656c 662e 6d6f 6465  del in self.mode
-0002c4f0: 6c73 3a0d 0a20 2020 2020 2020 2020 2020  ls:..           
-0002c500: 2020 2020 2020 2020 2074 6172 6765 745f           target_
-0002c510: 6964 7820 3d20 7365 6c66 2e6d 6f64 656c  idx = self.model
-0002c520: 732e 696e 6465 7828 7461 7267 6574 5f6d  s.index(target_m
-0002c530: 6f64 656c 290d 0a20 2020 2020 2020 2020  odel)..         
-0002c540: 2020 2020 2020 2020 2020 2073 6f75 7263             sourc
-0002c550: 655f 6964 7820 3d20 7365 6c66 2e6d 6f64  e_idx = self.mod
-0002c560: 656c 732e 696e 6465 7828 736f 7572 6365  els.index(source
-0002c570: 5f6d 6f64 656c 290d 0a20 2020 2020 2020  _model)..       
-0002c580: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-0002c590: 2069 2069 6e20 7261 6e67 6528 7365 6c66   i in range(self
-0002c5a0: 2e64 6174 6173 6574 2e65 7870 6f72 745f  .dataset.export_
-0002c5b0: 626f 7474 6f6d 2c20 7365 6c66 2e64 6174  bottom, self.dat
-0002c5c0: 6173 6574 2e65 7870 6f72 745f 746f 7029  aset.export_top)
-0002c5d0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0002c5e0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0002c5f0: 6368 6563 6b5f 7374 6f70 5f72 6571 7565  check_stop_reque
-0002c600: 7374 2829 0d0a 2020 2020 2020 2020 2020  st()..          
-0002c610: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0002c620: 676d 656e 7461 7469 6f6e 735b 7461 7267  gmentations[targ
-0002c630: 6574 5f69 6478 2c20 692c 203a 2c20 3a5d  et_idx, i, :, :]
-0002c640: 203d 2069 6e74 6572 6163 7469 6f6e 2e61   = interaction.a
-0002c650: 7070 6c79 5f74 6f5f 696d 6167 6573 2873  pply_to_images(s
-0002c660: 656c 662e 6461 7461 7365 742e 7069 7865  elf.dataset.pixe
-0002c670: 6c5f 7369 7a65 2c20 7365 676d 656e 7461  l_size, segmenta
-0002c680: 7469 6f6e 735b 736f 7572 6365 5f69 6478  tions[source_idx
-0002c690: 2c20 692c 203a 2c20 3a5d 2c20 7365 676d  , i, :, :], segm
-0002c6a0: 656e 7461 7469 6f6e 735b 7461 7267 6574  entations[target
-0002c6b0: 5f69 6478 2c20 692c 203a 2c20 3a5d 290d  _idx, i, :, :]).
-0002c6c0: 0a0d 0a20 2020 2020 2020 2020 2020 2023  ...            #
-0002c6d0: 2073 6176 6520 7468 6520 6d72 6320 6669   save the mrc fi
-0002c6e0: 6c65 730d 0a20 2020 2020 2020 2020 2020  les..           
-0002c6f0: 2069 203d 2030 0d0a 2020 2020 2020 2020   i = 0..        
-0002c700: 2020 2020 7365 6c66 2e63 6f6c 6f75 7220      self.colour 
-0002c710: 3d20 6366 672e 434f 4c4f 5552 5f50 4f53  = cfg.COLOUR_POS
-0002c720: 4954 4956 455b 303a 335d 0d0a 2020 2020  ITIVE[0:3]..    
-0002c730: 2020 2020 2020 2020 666f 7220 6d20 696e          for m in
-0002c740: 2073 656c 662e 6d6f 6465 6c73 3a0d 0a20   self.models:.. 
-0002c750: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0002c760: 656c 662e 6368 6563 6b5f 7374 6f70 5f72  elf.check_stop_r
-0002c770: 6571 7565 7374 2829 0d0a 2020 2020 2020  equest()..      
-0002c780: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-0002c790: 6622 5175 6575 6564 4578 706f 7274 202d  f"QueuedExport -
-0002c7a0: 2073 6176 696e 6720 6f75 7470 7574 206f   saving output o
-0002c7b0: 6620 6d6f 6465 6c20 7b6d 2e69 6e66 6f7d  f model {m.info}
-0002c7c0: 2229 0d0a 2020 2020 2020 2020 2020 2020  ")..            
-0002c7d0: 2020 2020 6f75 745f 7061 7468 203d 206f      out_path = o
-0002c7e0: 732e 7061 7468 2e6a 6f69 6e28 7365 6c66  s.path.join(self
-0002c7f0: 2e64 6972 6563 746f 7279 2c20 6f73 2e70  .directory, os.p
-0002c800: 6174 682e 7370 6c69 7465 7874 2873 656c  ath.splitext(sel
-0002c810: 662e 6461 7461 7365 742e 7469 746c 6529  f.dataset.title)
-0002c820: 5b30 5d2b 225f 5f22 2b6d 2e74 6974 6c65  [0]+"__"+m.title
-0002c830: 2b22 2e6d 7263 2229 0d0a 2020 2020 2020  +".mrc")..      
-0002c840: 2020 2020 2020 2020 2020 7769 7468 206d            with m
-0002c850: 7263 6669 6c65 2e6e 6577 286f 7574 5f70  rcfile.new(out_p
-0002c860: 6174 682c 206f 7665 7277 7269 7465 3d54  ath, overwrite=T
-0002c870: 7275 6529 2061 7320 6d72 633a 0d0a 2020  rue) as mrc:..  
-0002c880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c890: 2020 7320 3d20 7365 676d 656e 7461 7469    s = segmentati
-0002c8a0: 6f6e 735b 692c 203a 2c20 3a2c 203a 5d2e  ons[i, :, :, :].
-0002c8b0: 7371 7565 657a 6528 290d 0a20 2020 2020  squeeze()..     
-0002c8c0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-0002c8d0: 7263 2e73 6574 5f64 6174 6128 7329 0d0a  rc.set_data(s)..
-0002c8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c8f0: 2020 2020 6d72 632e 766f 7865 6c5f 7369      mrc.voxel_si
-0002c900: 7a65 203d 2073 656c 662e 6461 7461 7365  ze = self.datase
-0002c910: 742e 7069 7865 6c5f 7369 7a65 202a 2031  t.pixel_size * 1
-0002c920: 302e 300d 0a20 2020 2020 2020 2020 2020  0.0..           
-0002c930: 2020 2020 206e 5f73 6c69 6365 735f 636f       n_slices_co
-0002c940: 6d70 6c65 7465 202b 3d20 6e5f 736c 6963  mplete += n_slic
-0002c950: 6573 0d0a 2020 2020 2020 2020 2020 2020  es..            
-0002c960: 2020 2020 6920 2b3d 2031 0d0a 0d0a 2020      i += 1....  
-0002c970: 2020 2020 2020 2020 2020 2320 6578 706f            # expo
-0002c980: 7274 206f 7665 726c 6179 0d0a 2020 2020  rt overlay..    
-0002c990: 2020 2020 2020 2020 7365 6c66 2e63 6865          self.che
-0002c9a0: 636b 5f73 746f 705f 7265 7175 6573 7428  ck_stop_request(
-0002c9b0: 290d 0a20 2020 2020 2020 2020 2020 2069  )..            i
-0002c9c0: 6620 7365 6c66 2e65 7870 6f72 745f 6f76  f self.export_ov
-0002c9d0: 6572 6c61 7920 616e 6420 7365 6c66 2e64  erlay and self.d
-0002c9e0: 6174 6173 6574 2e6f 7665 726c 6179 2069  ataset.overlay i
-0002c9f0: 7320 6e6f 7420 4e6f 6e65 3a0d 0a20 2020  s not None:..   
-0002ca00: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-0002ca10: 6e74 2866 2251 7565 7565 6445 7870 6f72  nt(f"QueuedExpor
-0002ca20: 7420 2d20 6578 706f 7274 696e 6720 6f76  t - exporting ov
-0002ca30: 6572 6c61 7922 290d 0a20 2020 2020 2020  erlay")..       
-0002ca40: 2020 2020 2020 2020 206f 7665 726c 6179           overlay
-0002ca50: 5f67 7261 7973 6361 6c65 203d 206e 702e  _grayscale = np.
-0002ca60: 7375 6d28 7365 6c66 2e64 6174 6173 6574  sum(self.dataset
-0002ca70: 2e6f 7665 726c 6179 2e70 7864 202a 2a20  .overlay.pxd ** 
-0002ca80: 322c 2061 7869 733d 3229 0d0a 2020 2020  2, axis=2)..    
-0002ca90: 2020 2020 2020 2020 2020 2020 6f76 6572              over
-0002caa0: 6c61 795f 6772 6179 7363 616c 6520 2f3d  lay_grayscale /=
-0002cab0: 206e 702e 616d 6178 286f 7665 726c 6179   np.amax(overlay
-0002cac0: 5f67 7261 7973 6361 6c65 290d 0a20 2020  _grayscale)..   
-0002cad0: 2020 2020 2020 2020 2020 2020 206f 7665               ove
-0002cae0: 726c 6179 5f67 7261 7973 6361 6c65 202a  rlay_grayscale *
-0002caf0: 3d20 3235 350d 0a20 2020 2020 2020 2020  = 255..         
-0002cb00: 2020 2020 2020 206f 7665 726c 6179 5f67         overlay_g
-0002cb10: 7261 7973 6361 6c65 202d 3d20 3132 380d  rayscale -= 128.
-0002cb20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002cb30: 206f 7665 726c 6179 5f67 7261 7973 6361   overlay_graysca
-0002cb40: 6c65 203d 206f 7665 726c 6179 5f67 7261  le = overlay_gra
-0002cb50: 7973 6361 6c65 2e61 7374 7970 6528 6e70  yscale.astype(np
-0002cb60: 2e69 6e74 3829 0d0a 2020 2020 2020 2020  .int8)..        
-0002cb70: 2020 2020 2020 2020 6f76 6572 6c61 795f          overlay_
-0002cb80: 766f 6c75 6d65 203d 206e 702e 7469 6c65  volume = np.tile
-0002cb90: 286f 7665 726c 6179 5f67 7261 7973 6361  (overlay_graysca
-0002cba0: 6c65 5b6e 702e 6e65 7761 7869 732c 203a  le[np.newaxis, :
-0002cbb0: 2c20 3a5d 2c20 286e 5f73 6c69 6365 732c  , :], (n_slices,
-0002cbc0: 2031 2c20 3129 290d 0a20 2020 2020 2020   1, 1))..       
-0002cbd0: 2020 2020 2020 2020 206f 7574 5f70 6174           out_pat
-0002cbe0: 6820 3d20 6f73 2e70 6174 682e 6a6f 696e  h = os.path.join
-0002cbf0: 2873 656c 662e 6469 7265 6374 6f72 792c  (self.directory,
-0002cc00: 2073 656c 662e 6461 7461 7365 742e 7469   self.dataset.ti
-0002cc10: 746c 6520 2b20 225f 6f76 6572 6c61 792e  tle + "_overlay.
-0002cc20: 6d72 6322 290d 0a20 2020 2020 2020 2020  mrc")..         
-0002cc30: 2020 2020 2020 2077 6974 6820 6d72 6366         with mrcf
-0002cc40: 696c 652e 6e65 7728 6f75 745f 7061 7468  ile.new(out_path
-0002cc50: 2c20 6f76 6572 7772 6974 653d 5472 7565  , overwrite=True
-0002cc60: 2920 6173 206d 7263 3a0d 0a20 2020 2020  ) as mrc:..     
-0002cc70: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-0002cc80: 7263 2e73 6574 5f64 6174 6128 6f76 6572  rc.set_data(over
-0002cc90: 6c61 795f 766f 6c75 6d65 290d 0a20 2020  lay_volume)..   
-0002cca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ccb0: 206d 7263 2e76 6f78 656c 5f73 697a 6520   mrc.voxel_size 
-0002ccc0: 3d20 7365 6c66 2e64 6174 6173 6574 2e70  = self.dataset.p
-0002ccd0: 6978 656c 5f73 697a 6520 2a20 3130 2e30  ixel_size * 10.0
-0002cce0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-0002ccf0: 7365 6c66 2e70 726f 6365 7373 2e73 6574  self.process.set
-0002cd00: 5f70 726f 6772 6573 7328 312e 3029 0d0a  _progress(1.0)..
-0002cd10: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-0002cd20: 7428 6622 5175 6575 6564 4578 706f 7274  t(f"QueuedExport
-0002cd30: 202d 2064 6f6e 6521 2028 7b74 696d 652e   - done! ({time.
-0002cd40: 7469 6d65 2829 202d 2073 7461 7274 5f74  time() - start_t
-0002cd50: 696d 653a 2e32 667d 2073 2e29 5c6e 2229  ime:.2f} s.)\n")
-0002cd60: 0d0a 0d0a 2020 2020 2020 2020 6578 6365  ....        exce
-0002cd70: 7074 2045 7863 6570 7469 6f6e 2061 7320  pt Exception as 
-0002cd80: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-0002cd90: 6966 206e 6f74 2022 7465 726d 696e 6174  if not "terminat
-0002cda0: 6564 2062 7920 7573 6572 2220 696e 2073  ed by user" in s
-0002cdb0: 7472 2865 293a 0d0a 2020 2020 2020 2020  tr(e):..        
-0002cdc0: 2020 2020 2020 2020 6366 672e 7365 745f          cfg.set_
-0002cdd0: 6572 726f 7228 652c 2022 2229 0d0a 2020  error(e, "")..  
-0002cde0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-0002cdf0: 2241 6e20 6973 7375 6520 7761 7320 656e  "An issue was en
-0002ce00: 636f 756e 7465 7265 6420 6475 7269 6e67  countered during
-0002ce10: 2065 7870 6f72 745c 6e22 0d0a 2020 2020   export\n"..    
-0002ce20: 2020 2020 2020 2020 2020 2020 2020 6622                f"
-0002ce30: 5c74 4461 7461 7365 743a 207b 7365 6c66  \tDataset: {self
-0002ce40: 2e64 6174 6173 6574 2e70 6174 687d 5c6e  .dataset.path}\n
-0002ce50: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
-0002ce60: 2020 2020 2066 225c 7445 7272 6f72 3a20       f"\tError: 
-0002ce70: 222c 2065 290d 0a20 2020 2020 2020 2020  ", e)..         
-0002ce80: 2020 2073 656c 662e 7072 6f63 6573 732e     self.process.
-0002ce90: 7365 745f 7072 6f67 7265 7373 2831 2e30  set_progress(1.0
-0002cea0: 290d 0a0d 0a20 2020 2064 6566 2063 6865  )....    def che
-0002ceb0: 636b 5f73 746f 705f 7265 7175 6573 7428  ck_stop_request(
-0002cec0: 7365 6c66 293a 0d0a 2020 2020 2020 2020  self):..        
-0002ced0: 6966 2073 656c 662e 7072 6f63 6573 732e  if self.process.
-0002cee0: 7374 6f70 5f72 6571 7565 7374 2e69 735f  stop_request.is_
-0002cef0: 7365 7428 293a 0d0a 2020 2020 2020 2020  set():..        
-0002cf00: 2020 2020 7261 6973 6520 4578 6365 7074      raise Except
-0002cf10: 696f 6e28 2251 7565 7565 6445 7870 6f72  ion("QueuedExpor
-0002cf20: 7420 2d20 7072 6f63 6573 7320 7465 726d  t - process term
-0002cf30: 696e 6174 6564 2062 7920 7573 6572 2e20  inated by user. 
-0002cf40: 2229 0d0a 0d0a 2020 2020 6465 6620 7374  ")....    def st
-0002cf50: 6172 7428 7365 6c66 293a 0d0a 2020 2020  art(self):..    
-0002cf60: 2020 2020 7365 6c66 2e70 726f 6365 7373      self.process
-0002cf70: 2e73 6574 5f70 726f 6772 6573 7328 302e  .set_progress(0.
-0002cf80: 3030 3031 290d 0a20 2020 2020 2020 2073  0001)..        s
-0002cf90: 656c 662e 7072 6f63 6573 732e 7374 6172  elf.process.star
-0002cfa0: 7428 290d 0a0d 0a20 2020 2064 6566 2073  t()....    def s
-0002cfb0: 746f 7028 7365 6c66 293a 0d0a 2020 2020  top(self):..    
-0002cfc0: 2020 2020 6966 2073 656c 662e 7072 6f63      if self.proc
-0002cfd0: 6573 732e 7468 7265 6164 2069 7320 6e6f  ess.thread is no
-0002cfe0: 7420 4e6f 6e65 3a0d 0a20 2020 2020 2020  t None:..       
-0002cff0: 2020 2020 2073 656c 662e 7072 6f63 6573       self.proces
-0002d000: 732e 7374 6f70 5f72 6571 7565 7374 2e73  s.stop_request.s
-0002d010: 6574 2829 0d0a 0d0a 0d0a 636c 6173 7320  et()......class 
-0002d020: 5175 6575 6564 4578 7472 6163 743a 0d0a  QueuedExtract:..
-0002d030: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
-0002d040: 2873 656c 662c 206d 7263 7061 7468 2c20  (self, mrcpath, 
-0002d050: 7468 7265 7368 6f6c 642c 206d 696e 5f73  threshold, min_s
-0002d060: 697a 652c 206d 696e 5f73 7061 6369 6e67  ize, min_spacing
-0002d070: 2c20 7361 7665 5f64 6972 2c20 6269 6e6e  , save_dir, binn
-0002d080: 696e 673d 3129 3a0d 0a20 2020 2020 2020  ing=1):..       
-0002d090: 2073 656c 662e 7461 6720 3d20 6d72 6370   self.tag = mrcp
-0002d0a0: 6174 680d 0a20 2020 2020 2020 2073 656c  ath..        sel
-0002d0b0: 662e 7061 7468 203d 206d 7263 7061 7468  f.path = mrcpath
-0002d0c0: 0d0a 2020 2020 2020 2020 7365 6c66 2e74  ..        self.t
-0002d0d0: 6872 6573 686f 6c64 203d 2074 6872 6573  hreshold = thres
-0002d0e0: 686f 6c64 0d0a 2020 2020 2020 2020 7365  hold..        se
-0002d0f0: 6c66 2e6d 696e 5f73 697a 6520 3d20 6d69  lf.min_size = mi
-0002d100: 6e5f 7369 7a65 0d0a 2020 2020 2020 2020  n_size..        
-0002d110: 7365 6c66 2e6d 696e 5f73 7061 6369 6e67  self.min_spacing
-0002d120: 203d 206d 696e 5f73 7061 6369 6e67 0d0a   = min_spacing..
-0002d130: 2020 2020 2020 2020 7365 6c66 2e62 696e          self.bin
-0002d140: 6e69 6e67 203d 2062 696e 6e69 6e67 0d0a  ning = binning..
-0002d150: 2020 2020 2020 2020 7365 6c66 2e64 6972          self.dir
-0002d160: 203d 2073 6176 655f 6469 720d 0a20 2020   = save_dir..   
-0002d170: 2020 2020 2073 656c 662e 636f 6c6f 7572       self.colour
-0002d180: 203d 2028 302e 322c 2030 2e39 2c20 302e   = (0.2, 0.9, 0.
-0002d190: 3229 0d0a 2020 2020 2020 2020 7365 6c66  2)..        self
-0002d1a0: 2e70 726f 6365 7373 203d 2042 6163 6b67  .process = Backg
-0002d1b0: 726f 756e 6450 726f 6365 7373 2873 656c  roundProcess(sel
-0002d1c0: 662e 646f 5f65 7870 6f72 742c 2028 292c  f.do_export, (),
-0002d1d0: 206e 616d 653d 6622 7b73 656c 662e 7061   name=f"{self.pa
-0002d1e0: 7468 7d20 6669 6e64 2063 6f6f 7264 732e  th} find coords.
-0002d1f0: 2229 0d0a 0d0a 2020 2020 6465 6620 646f  ")....    def do
-0002d200: 5f65 7870 6f72 7428 7365 6c66 2c20 7072  _export(self, pr
-0002d210: 6f63 6573 7329 3a0d 0a20 2020 2020 2020  ocess):..       
-0002d220: 2074 7279 3a0d 0a20 2020 2020 2020 2020   try:..         
-0002d230: 2020 2067 6574 5f6d 6178 696d 615f 3364     get_maxima_3d
-0002d240: 5f77 6174 6572 7368 6564 286d 7263 7061  _watershed(mrcpa
-0002d250: 7468 3d73 656c 662e 7061 7468 2c20 7468  th=self.path, th
-0002d260: 7265 7368 6f6c 643d 7365 6c66 2e74 6872  reshold=self.thr
-0002d270: 6573 686f 6c64 2c20 6d69 6e5f 7370 6163  eshold, min_spac
-0002d280: 696e 673d 7365 6c66 2e6d 696e 5f73 7061  ing=self.min_spa
-0002d290: 6369 6e67 2c20 6d69 6e5f 7369 7a65 3d73  cing, min_size=s
-0002d2a0: 656c 662e 6d69 6e5f 7369 7a65 2c20 7361  elf.min_size, sa
-0002d2b0: 7665 5f64 6972 3d73 656c 662e 6469 722c  ve_dir=self.dir,
-0002d2c0: 2070 726f 6365 7373 3d73 656c 662e 7072   process=self.pr
-0002d2d0: 6f63 6573 732c 2062 696e 6e69 6e67 3d73  ocess, binning=s
-0002d2e0: 656c 662e 6269 6e6e 696e 6729 0d0a 2020  elf.binning)..  
-0002d2f0: 2020 2020 2020 2020 2020 666f 7220 7320            for s 
-0002d300: 696e 2063 6667 2e73 655f 7375 7266 6163  in cfg.se_surfac
-0002d310: 655f 6d6f 6465 6c73 3a0d 0a20 2020 2020  e_models:..     
-0002d320: 2020 2020 2020 2020 2020 2069 6620 732e             if s.
-0002d330: 7061 7468 203d 3d20 7365 6c66 2e70 6174  path == self.pat
-0002d340: 683a 0d0a 2020 2020 2020 2020 2020 2020  h:..            
-0002d350: 2020 2020 2020 2020 732e 6669 6e64 5f63          s.find_c
-0002d360: 6f6f 7264 696e 6174 6573 2829 0d0a 2020  oordinates()..  
-0002d370: 2020 2020 2020 6578 6365 7074 2045 7863        except Exc
-0002d380: 6570 7469 6f6e 2061 7320 653a 0d0a 2020  eption as e:..  
-0002d390: 2020 2020 2020 2020 2020 6366 672e 7365            cfg.se
-0002d3a0: 745f 6572 726f 7228 652c 2022 4572 726f  t_error(e, "Erro
-0002d3b0: 7220 696e 2051 7565 7565 6445 7874 7261  r in QueuedExtra
-0002d3c0: 6374 2028 6669 6e64 696e 6720 636f 6f72  ct (finding coor
-0002d3d0: 6469 6e61 7465 7320 696e 2061 202e 6d72  dinates in a .mr
-0002d3e0: 6329 202d 2073 6565 2064 6574 6169 6c73  c) - see details
-0002d3f0: 2062 656c 6f77 2e22 290d 0a20 2020 2020   below.")..     
-0002d400: 2020 2070 726f 6365 7373 2e73 6574 5f70     process.set_p
-0002d410: 726f 6772 6573 7328 312e 3029 0d0a 0d0a  rogress(1.0)....
-0002d420: 2020 2020 6465 6620 6368 6563 6b5f 7374      def check_st
-0002d430: 6f70 5f72 6571 7565 7374 2873 656c 6629  op_request(self)
-0002d440: 3a0d 0a20 2020 2020 2020 2069 6620 7365  :..        if se
-0002d450: 6c66 2e70 726f 6365 7373 2e73 746f 705f  lf.process.stop_
-0002d460: 7265 7175 6573 742e 6973 5f73 6574 2829  request.is_set()
-0002d470: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
-0002d480: 6169 7365 2045 7863 6570 7469 6f6e 2822  aise Exception("
-0002d490: 5175 6575 6564 4578 706f 7274 202d 2070  QueuedExport - p
-0002d4a0: 726f 6365 7373 2074 6572 6d69 6e61 7465  rocess terminate
-0002d4b0: 6420 6279 2075 7365 722e 2022 290d 0a0d  d by user. ")...
-0002d4c0: 0a20 2020 2064 6566 2073 7461 7274 2873  .    def start(s
-0002d4d0: 656c 6629 3a0d 0a20 2020 2020 2020 2073  elf):..        s
-0002d4e0: 656c 662e 7072 6f63 6573 732e 7365 745f  elf.process.set_
-0002d4f0: 7072 6f67 7265 7373 2830 2e30 3030 3129  progress(0.0001)
-0002d500: 0d0a 2020 2020 2020 2020 7365 6c66 2e70  ..        self.p
-0002d510: 726f 6365 7373 2e73 7461 7274 2829 0d0a  rocess.start()..
-0002d520: 0d0a 2020 2020 6465 6620 7374 6f70 2873  ..    def stop(s
-0002d530: 656c 6629 3a0d 0a20 2020 2020 2020 2069  elf):..        i
-0002d540: 6620 7365 6c66 2e70 726f 6365 7373 2e74  f self.process.t
-0002d550: 6872 6561 6420 6973 206e 6f74 204e 6f6e  hread is not Non
-0002d560: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-0002d570: 7365 6c66 2e70 726f 6365 7373 2e73 746f  self.process.sto
-0002d580: 705f 7265 7175 6573 742e 7365 7428 290d  p_request.set().
-0002d590: 0a0d 0a0d 0a63 6c61 7373 2057 6f72 6c64  .....class World
-0002d5a0: 5370 6163 6549 636f 6e3a 0d0a 2020 2020  SpaceIcon:..    
-0002d5b0: 2320 7468 6973 2063 6c61 7373 2069 7320  # this class is 
-0002d5c0: 6f6e 6c79 2075 7365 6420 746f 2072 656e  only used to ren
-0002d5d0: 6465 7220 616e 6420 696e 7465 7261 6374  der and interact
-0002d5e0: 2077 6974 6820 7468 6520 5365 676d 656e   with the Segmen
-0002d5f0: 7461 7469 6f6e 4564 6974 6f72 2063 726f  tationEditor cro
-0002d600: 7020 6861 6e64 6c65 732e 2066 6169 726c  p handles. fairl
-0002d610: 7920 7370 6563 6966 6963 2069 6d70 6c65  y specific imple
-0002d620: 6d65 6e74 6174 696f 6e0d 0a20 2020 2063  mentation..    c
-0002d630: 726f 705f 6963 6f6e 5f76 6120 3d20 4e6f  rop_icon_va = No
-0002d640: 6e65 0d0a 2020 2020 6372 6f70 5f69 636f  ne..    crop_ico
-0002d650: 6e5f 7465 7874 7572 6520 3d20 4e6f 6e65  n_texture = None
-0002d660: 0d0a 2020 2020 4d49 4e5f 5349 5a45 203d  ..    MIN_SIZE =
-0002d670: 2031 3238 0d0a 0d0a 2020 2020 6465 6620   128....    def 
-0002d680: 5f5f 696e 6974 5f5f 2873 656c 662c 2063  __init__(self, c
-0002d690: 6f72 6e65 725f 6964 783d 3029 3a0d 0a20  orner_idx=0):.. 
-0002d6a0: 2020 2020 2020 2069 6620 576f 726c 6453         if WorldS
-0002d6b0: 7061 6365 4963 6f6e 2e63 726f 705f 6963  paceIcon.crop_ic
-0002d6c0: 6f6e 5f76 6120 6973 204e 6f6e 653a 0d0a  on_va is None:..
-0002d6d0: 2020 2020 2020 2020 2020 2020 576f 726c              Worl
-0002d6e0: 6453 7061 6365 4963 6f6e 2e69 6e69 745f  dSpaceIcon.init_
-0002d6f0: 6f70 656e 676c 5f6f 626a 7328 290d 0a0d  opengl_objs()...
-0002d700: 0a20 2020 2020 2020 2073 656c 662e 7472  .        self.tr
-0002d710: 616e 7366 6f72 6d20 3d20 5472 616e 7366  ansform = Transf
-0002d720: 6f72 6d28 290d 0a20 2020 2020 2020 2073  orm()..        s
-0002d730: 656c 662e 636f 726e 6572 5f69 6478 203d  elf.corner_idx =
-0002d740: 2063 6f72 6e65 725f 6964 780d 0a20 2020   corner_idx..   
-0002d750: 2020 2020 2073 656c 662e 636f 726e 6572       self.corner
-0002d760: 5f70 6f73 6974 696f 6e73 5f6c 6f63 616c  _positions_local
-0002d770: 203d 205b 5b30 2c20 305d 2c20 5b31 2c20   = [[0, 0], [1, 
-0002d780: 305d 2c20 5b30 2c20 2d31 5d2c 205b 312c  0], [0, -1], [1,
-0002d790: 202d 315d 5d0d 0a20 2020 2020 2020 2073   -1]]..        s
-0002d7a0: 656c 662e 636f 726e 6572 5f70 6f73 6974  elf.corner_posit
-0002d7b0: 696f 6e73 203d 205b 5b30 2c20 305d 2c20  ions = [[0, 0], 
-0002d7c0: 5b31 2c20 305d 2c20 5b30 2c20 2d31 5d2c  [1, 0], [0, -1],
-0002d7d0: 205b 312c 202d 315d 5d0d 0a20 2020 2020   [1, -1]]..     
-0002d7e0: 2020 2073 656c 662e 7061 7265 6e74 203d     self.parent =
-0002d7f0: 204e 6f6e 650d 0a20 2020 2020 2020 2073   None..        s
-0002d800: 656c 662e 6163 7469 7665 203d 2046 616c  elf.active = Fal
-0002d810: 7365 0d0a 2020 2020 2020 2020 7365 6c66  se..        self
-0002d820: 2e6d 6f76 696e 675f 656e 7469 7265 5f72  .moving_entire_r
-0002d830: 6f69 203d 2046 616c 7365 0d0a 0d0a 2020  oi = False....  
-0002d840: 2020 6465 6620 6765 745f 7661 2873 656c    def get_va(sel
-0002d850: 6629 3a0d 0a20 2020 2020 2020 2072 6574  f):..        ret
-0002d860: 7572 6e20 576f 726c 6453 7061 6365 4963  urn WorldSpaceIc
-0002d870: 6f6e 2e63 726f 705f 6963 6f6e 5f76 610d  on.crop_icon_va.
-0002d880: 0a0d 0a20 2020 2064 6566 2067 6574 5f74  ...    def get_t
-0002d890: 6578 7475 7265 2873 656c 6629 3a0d 0a20  exture(self):.. 
-0002d8a0: 2020 2020 2020 2072 6574 7572 6e20 576f         return Wo
-0002d8b0: 726c 6453 7061 6365 4963 6f6e 2e63 726f  rldSpaceIcon.cro
-0002d8c0: 705f 6963 6f6e 5f74 6578 7475 7265 0d0a  p_icon_texture..
-0002d8d0: 0d0a 2020 2020 4073 7461 7469 636d 6574  ..    @staticmet
-0002d8e0: 686f 640d 0a20 2020 2064 6566 2069 6e69  hod..    def ini
-0002d8f0: 745f 6f70 656e 676c 5f6f 626a 7328 293a  t_opengl_objs():
-0002d900: 0d0a 2020 2020 2020 2020 2320 6372 6f70  ..        # crop
-0002d910: 2069 636f 6e0d 0a20 2020 2020 2020 2069   icon..        i
-0002d920: 636f 6e5f 7665 7274 6963 6573 203d 205b  con_vertices = [
-0002d930: 302c 2030 2c20 302c 2030 2c0d 0a20 2020  0, 0, 0, 0,..   
-0002d940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d950: 2020 2020 2020 312c 2030 2c20 312c 2030        1, 0, 1, 0
-0002d960: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-0002d970: 2020 2020 2020 2020 2020 2020 302c 202d              0, -
-0002d980: 312c 2030 2c20 312c 0d0a 2020 2020 2020  1, 0, 1,..      
-0002d990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d9a0: 2020 2031 2c20 2d31 2c20 312c 2031 5d0d     1, -1, 1, 1].
-0002d9b0: 0a20 2020 2020 2020 2069 636f 6e5f 696e  .        icon_in
-0002d9c0: 6469 6365 7320 3d20 5b30 2c20 312c 2032  dices = [0, 1, 2
-0002d9d0: 2c20 322c 2031 2c20 335d 0d0a 2020 2020  , 2, 1, 3]..    
-0002d9e0: 2020 2020 576f 726c 6453 7061 6365 4963      WorldSpaceIc
-0002d9f0: 6f6e 2e63 726f 705f 6963 6f6e 5f76 6120  on.crop_icon_va 
-0002da00: 3d20 5665 7274 6578 4172 7261 7928 5665  = VertexArray(Ve
-0002da10: 7274 6578 4275 6666 6572 2869 636f 6e5f  rtexBuffer(icon_
-0002da20: 7665 7274 6963 6573 292c 2049 6e64 6578  vertices), Index
-0002da30: 4275 6666 6572 2869 636f 6e5f 696e 6469  Buffer(icon_indi
-0002da40: 6365 7329 2c0d 0a20 2020 2020 2020 2020  ces),..         
-0002da50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002da60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002da70: 2020 2020 2020 2020 2061 7474 7269 6275           attribu
-0002da80: 7465 5f66 6f72 6d61 743d 2278 7975 7622  te_format="xyuv"
-0002da90: 290d 0a20 2020 2020 2020 2057 6f72 6c64  )..        World
-0002daa0: 5370 6163 6549 636f 6e2e 6372 6f70 5f69  SpaceIcon.crop_i
-0002dab0: 636f 6e5f 7465 7874 7572 6520 3d20 5465  con_texture = Te
-0002dac0: 7874 7572 6528 666f 726d 6174 3d22 7267  xture(format="rg
-0002dad0: 6261 3332 6622 290d 0a20 2020 2020 2020  ba32f")..       
-0002dae0: 2070 7864 5f69 636f 6e5f 6372 6f70 203d   pxd_icon_crop =
-0002daf0: 206e 702e 6173 6172 7261 7928 496d 6167   np.asarray(Imag
-0002db00: 652e 6f70 656e 286f 732e 7061 7468 2e6a  e.open(os.path.j
-0002db10: 6f69 6e28 6366 672e 726f 6f74 2c20 2269  oin(cfg.root, "i
-0002db20: 636f 6e73 222c 2022 6963 6f6e 5f63 726f  cons", "icon_cro
-0002db30: 705f 3235 362e 706e 6722 2929 292e 6173  p_256.png"))).as
-0002db40: 7479 7065 280d 0a20 2020 2020 2020 2020  type(..         
-0002db50: 2020 206e 702e 666c 6f61 7433 3229 202f     np.float32) /
-0002db60: 2032 3535 2e30 0d0a 2020 2020 2020 2020   255.0..        
-0002db70: 576f 726c 6453 7061 6365 4963 6f6e 2e63  WorldSpaceIcon.c
-0002db80: 726f 705f 6963 6f6e 5f74 6578 7475 7265  rop_icon_texture
-0002db90: 2e75 7064 6174 6528 7078 645f 6963 6f6e  .update(pxd_icon
-0002dba0: 5f63 726f 7029 0d0a 0d0a 2020 2020 6465  _crop)....    de
-0002dbb0: 6620 6166 6665 6374 5f63 726f 7028 7365  f affect_crop(se
-0002dbc0: 6c66 2c20 7069 7865 6c5f 636f 6f72 6469  lf, pixel_coordi
-0002dbd0: 6e61 7465 293a 0d0a 2020 2020 2020 2020  nate):..        
-0002dbe0: 6420 3d20 576f 726c 6453 7061 6365 4963  d = WorldSpaceIc
-0002dbf0: 6f6e 2e4d 494e 5f53 495a 450d 0a20 2020  on.MIN_SIZE..   
-0002dc00: 2020 2020 2023 2320 7468 6973 206d 6574       ## this met
-0002dc10: 686f 6420 6973 2063 616c 6c65 6420 7768  hod is called wh
-0002dc20: 656e 2074 6865 2063 726f 7020 6861 6e64  en the crop hand
-0002dc30: 6c65 2069 7320 6d6f 7665 642c 206f 6e74  le is moved, ont
-0002dc40: 6f20 7069 7865 6c5f 636f 6f72 6469 6e61  o pixel_coordina
-0002dc50: 7465 0d0a 2020 2020 2020 2020 6966 2073  te..        if s
-0002dc60: 656c 662e 636f 726e 6572 5f69 6478 203d  elf.corner_idx =
-0002dc70: 3d20 303a 0d0a 2020 2020 2020 2020 2020  = 0:..          
-0002dc80: 2020 7365 6c66 2e70 6172 656e 742e 6372    self.parent.cr
-0002dc90: 6f70 5f72 6f69 5b30 5d20 3d20 7069 7865  op_roi[0] = pixe
-0002dca0: 6c5f 636f 6f72 6469 6e61 7465 5b30 5d0d  l_coordinate[0].
-0002dcb0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0002dcc0: 662e 7061 7265 6e74 2e63 726f 705f 726f  f.parent.crop_ro
-0002dcd0: 695b 305d 203d 2063 6c61 6d70 2873 656c  i[0] = clamp(sel
-0002dce0: 662e 7061 7265 6e74 2e63 726f 705f 726f  f.parent.crop_ro
-0002dcf0: 695b 305d 2c20 302c 2073 656c 662e 7061  i[0], 0, self.pa
-0002dd00: 7265 6e74 2e63 726f 705f 726f 695b 325d  rent.crop_roi[2]
-0002dd10: 202d 2064 290d 0a20 2020 2020 2020 2020   - d)..         
-0002dd20: 2020 2073 656c 662e 7061 7265 6e74 2e63     self.parent.c
-0002dd30: 726f 705f 726f 695b 315d 203d 2028 7365  rop_roi[1] = (se
-0002dd40: 6c66 2e70 6172 656e 742e 6865 6967 6874  lf.parent.height
-0002dd50: 202d 2070 6978 656c 5f63 6f6f 7264 696e   - pixel_coordin
-0002dd60: 6174 655b 315d 290d 0a20 2020 2020 2020  ate[1])..       
-0002dd70: 2020 2020 2073 656c 662e 7061 7265 6e74       self.parent
-0002dd80: 2e63 726f 705f 726f 695b 315d 203d 2063  .crop_roi[1] = c
-0002dd90: 6c61 6d70 2873 656c 662e 7061 7265 6e74  lamp(self.parent
-0002dda0: 2e63 726f 705f 726f 695b 315d 2c20 302c  .crop_roi[1], 0,
-0002ddb0: 2073 656c 662e 7061 7265 6e74 2e63 726f   self.parent.cro
-0002ddc0: 705f 726f 695b 335d 202d 2064 290d 0a20  p_roi[3] - d).. 
-0002ddd0: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
-0002dde0: 2e63 6f72 6e65 725f 6964 7820 3d3d 2031  .corner_idx == 1
-0002ddf0: 3a0d 0a20 2020 2020 2020 2020 2020 2073  :..            s
-0002de00: 656c 662e 7061 7265 6e74 2e63 726f 705f  elf.parent.crop_
-0002de10: 726f 695b 325d 203d 2073 656c 662e 7061  roi[2] = self.pa
-0002de20: 7265 6e74 2e77 6964 7468 202d 2028 7365  rent.width - (se
-0002de30: 6c66 2e70 6172 656e 742e 7769 6474 6820  lf.parent.width 
-0002de40: 2d20 7069 7865 6c5f 636f 6f72 6469 6e61  - pixel_coordina
-0002de50: 7465 5b30 5d29 0d0a 2020 2020 2020 2020  te[0])..        
-0002de60: 2020 2020 7365 6c66 2e70 6172 656e 742e      self.parent.
-0002de70: 6372 6f70 5f72 6f69 5b32 5d20 3d20 636c  crop_roi[2] = cl
-0002de80: 616d 7028 7365 6c66 2e70 6172 656e 742e  amp(self.parent.
-0002de90: 6372 6f70 5f72 6f69 5b32 5d2c 2073 656c  crop_roi[2], sel
-0002dea0: 662e 7061 7265 6e74 2e63 726f 705f 726f  f.parent.crop_ro
-0002deb0: 695b 305d 202b 2064 2c20 7365 6c66 2e70  i[0] + d, self.p
-0002dec0: 6172 656e 742e 7769 6474 6829 0d0a 2020  arent.width)..  
-0002ded0: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
-0002dee0: 6172 656e 742e 6372 6f70 5f72 6f69 5b31  arent.crop_roi[1
-0002def0: 5d20 3d20 2873 656c 662e 7061 7265 6e74  ] = (self.parent
-0002df00: 2e68 6569 6768 7420 2d20 7069 7865 6c5f  .height - pixel_
-0002df10: 636f 6f72 6469 6e61 7465 5b31 5d29 0d0a  coordinate[1])..
-0002df20: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0002df30: 2e70 6172 656e 742e 6372 6f70 5f72 6f69  .parent.crop_roi
-0002df40: 5b31 5d20 3d20 636c 616d 7028 7365 6c66  [1] = clamp(self
-0002df50: 2e70 6172 656e 742e 6372 6f70 5f72 6f69  .parent.crop_roi
-0002df60: 5b31 5d2c 2030 2c20 7365 6c66 2e70 6172  [1], 0, self.par
-0002df70: 656e 742e 6372 6f70 5f72 6f69 5b33 5d20  ent.crop_roi[3] 
-0002df80: 2d20 6429 0d0a 2020 2020 2020 2020 656c  - d)..        el
-0002df90: 6966 2073 656c 662e 636f 726e 6572 5f69  if self.corner_i
-0002dfa0: 6478 203d 3d20 323a 0d0a 2020 2020 2020  dx == 2:..      
-0002dfb0: 2020 2020 2020 7365 6c66 2e70 6172 656e        self.paren
-0002dfc0: 742e 6372 6f70 5f72 6f69 5b32 5d20 3d20  t.crop_roi[2] = 
-0002dfd0: 7365 6c66 2e70 6172 656e 742e 7769 6474  self.parent.widt
-0002dfe0: 6820 2d20 2873 656c 662e 7061 7265 6e74  h - (self.parent
-0002dff0: 2e77 6964 7468 202d 2070 6978 656c 5f63  .width - pixel_c
-0002e000: 6f6f 7264 696e 6174 655b 305d 290d 0a20  oordinate[0]).. 
-0002e010: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0002e020: 7061 7265 6e74 2e63 726f 705f 726f 695b  parent.crop_roi[
-0002e030: 325d 203d 2063 6c61 6d70 2873 656c 662e  2] = clamp(self.
-0002e040: 7061 7265 6e74 2e63 726f 705f 726f 695b  parent.crop_roi[
-0002e050: 325d 2c20 7365 6c66 2e70 6172 656e 742e  2], self.parent.
-0002e060: 6372 6f70 5f72 6f69 5b30 5d20 2b20 642c  crop_roi[0] + d,
-0002e070: 2073 656c 662e 7061 7265 6e74 2e77 6964   self.parent.wid
-0002e080: 7468 290d 0a20 2020 2020 2020 2020 2020  th)..           
-0002e090: 2073 656c 662e 7061 7265 6e74 2e63 726f   self.parent.cro
-0002e0a0: 705f 726f 695b 335d 203d 2028 7365 6c66  p_roi[3] = (self
-0002e0b0: 2e70 6172 656e 742e 6865 6967 6874 202d  .parent.height -
-0002e0c0: 2070 6978 656c 5f63 6f6f 7264 696e 6174   pixel_coordinat
-0002e0d0: 655b 315d 290d 0a20 2020 2020 2020 2020  e[1])..         
-0002e0e0: 2020 2073 656c 662e 7061 7265 6e74 2e63     self.parent.c
-0002e0f0: 726f 705f 726f 695b 335d 203d 2063 6c61  rop_roi[3] = cla
-0002e100: 6d70 2873 656c 662e 7061 7265 6e74 2e63  mp(self.parent.c
-0002e110: 726f 705f 726f 695b 335d 2c20 7365 6c66  rop_roi[3], self
-0002e120: 2e70 6172 656e 742e 6372 6f70 5f72 6f69  .parent.crop_roi
-0002e130: 5b31 5d20 2b20 642c 2073 656c 662e 7061  [1] + d, self.pa
-0002e140: 7265 6e74 2e68 6569 6768 7429 0d0a 2020  rent.height)..  
-0002e150: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
-0002e160: 636f 726e 6572 5f69 6478 203d 3d20 333a  corner_idx == 3:
-0002e170: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-0002e180: 6c66 2e70 6172 656e 742e 6372 6f70 5f72  lf.parent.crop_r
-0002e190: 6f69 5b30 5d20 3d20 7069 7865 6c5f 636f  oi[0] = pixel_co
-0002e1a0: 6f72 6469 6e61 7465 5b30 5d0d 0a20 2020  ordinate[0]..   
-0002e1b0: 2020 2020 2020 2020 2073 656c 662e 7061           self.pa
-0002e1c0: 7265 6e74 2e63 726f 705f 726f 695b 305d  rent.crop_roi[0]
-0002e1d0: 203d 2063 6c61 6d70 2873 656c 662e 7061   = clamp(self.pa
-0002e1e0: 7265 6e74 2e63 726f 705f 726f 695b 305d  rent.crop_roi[0]
-0002e1f0: 2c20 302c 2073 656c 662e 7061 7265 6e74  , 0, self.parent
-0002e200: 2e63 726f 705f 726f 695b 325d 202d 2064  .crop_roi[2] - d
-0002e210: 290d 0a20 2020 2020 2020 2020 2020 2073  )..            s
-0002e220: 656c 662e 7061 7265 6e74 2e63 726f 705f  elf.parent.crop_
-0002e230: 726f 695b 335d 203d 2028 7365 6c66 2e70  roi[3] = (self.p
-0002e240: 6172 656e 742e 6865 6967 6874 202d 2070  arent.height - p
-0002e250: 6978 656c 5f63 6f6f 7264 696e 6174 655b  ixel_coordinate[
-0002e260: 315d 290d 0a20 2020 2020 2020 2020 2020  1])..           
-0002e270: 2073 656c 662e 7061 7265 6e74 2e63 726f   self.parent.cro
-0002e280: 705f 726f 695b 335d 203d 2063 6c61 6d70  p_roi[3] = clamp
-0002e290: 2873 656c 662e 7061 7265 6e74 2e63 726f  (self.parent.cro
-0002e2a0: 705f 726f 695b 335d 2c20 7365 6c66 2e70  p_roi[3], self.p
-0002e2b0: 6172 656e 742e 6372 6f70 5f72 6f69 5b31  arent.crop_roi[1
-0002e2c0: 5d20 2b20 642c 2073 656c 662e 7061 7265  ] + d, self.pare
-0002e2d0: 6e74 2e68 6569 6768 7429 0d0a 0d0a 2020  nt.height)....  
-0002e2e0: 2020 6465 6620 6d6f 7665 5f63 726f 705f    def move_crop_
-0002e2f0: 726f 6928 7365 6c66 2c20 6478 2c20 6479  roi(self, dx, dy
-0002e300: 293a 0d0a 2020 2020 2020 2020 7465 7374  ):..        test
-0002e310: 5f72 6f69 203d 2063 6f70 7928 7365 6c66  _roi = copy(self
-0002e320: 2e70 6172 656e 742e 6372 6f70 5f72 6f69  .parent.crop_roi
-0002e330: 290d 0a20 2020 2020 2020 2074 6573 745f  )..        test_
-0002e340: 726f 695b 305d 202b 3d20 6478 0d0a 2020  roi[0] += dx..  
-0002e350: 2020 2020 2020 7465 7374 5f72 6f69 5b32        test_roi[2
-0002e360: 5d20 2b3d 2064 780d 0a20 2020 2020 2020  ] += dx..       
-0002e370: 2074 6573 745f 726f 695b 315d 202b 3d20   test_roi[1] += 
-0002e380: 6479 0d0a 2020 2020 2020 2020 7465 7374  dy..        test
-0002e390: 5f72 6f69 5b33 5d20 2b3d 2064 790d 0a0d  _roi[3] += dy...
-0002e3a0: 0a20 2020 2020 2020 2069 6620 7465 7374  .        if test
-0002e3b0: 5f72 6f69 5b30 5d20 3e20 3020 616e 6420  _roi[0] > 0 and 
-0002e3c0: 7465 7374 5f72 6f69 5b32 5d20 3c20 7365  test_roi[2] < se
-0002e3d0: 6c66 2e70 6172 656e 742e 7769 6474 683a  lf.parent.width:
-0002e3e0: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-0002e3f0: 6c66 2e70 6172 656e 742e 6372 6f70 5f72  lf.parent.crop_r
-0002e400: 6f69 5b30 5d20 3d20 7465 7374 5f72 6f69  oi[0] = test_roi
-0002e410: 5b30 5d0d 0a20 2020 2020 2020 2020 2020  [0]..           
-0002e420: 2073 656c 662e 7061 7265 6e74 2e63 726f   self.parent.cro
-0002e430: 705f 726f 695b 325d 203d 2074 6573 745f  p_roi[2] = test_
-0002e440: 726f 695b 325d 0d0a 2020 2020 2020 2020  roi[2]..        
-0002e450: 2020 2020 7365 6c66 2e70 6172 656e 742e      self.parent.
-0002e460: 6372 6f70 5f72 6f69 5b30 5d20 3d20 636c  crop_roi[0] = cl
-0002e470: 616d 7028 7365 6c66 2e70 6172 656e 742e  amp(self.parent.
-0002e480: 6372 6f70 5f72 6f69 5b30 5d2c 2030 2c20  crop_roi[0], 0, 
-0002e490: 7365 6c66 2e70 6172 656e 742e 7769 6474  self.parent.widt
-0002e4a0: 6829 0d0a 2020 2020 2020 2020 2020 2020  h)..            
-0002e4b0: 7365 6c66 2e70 6172 656e 742e 6372 6f70  self.parent.crop
-0002e4c0: 5f72 6f69 5b32 5d20 3d20 636c 616d 7028  _roi[2] = clamp(
-0002e4d0: 7365 6c66 2e70 6172 656e 742e 6372 6f70  self.parent.crop
-0002e4e0: 5f72 6f69 5b32 5d2c 2030 2c20 7365 6c66  _roi[2], 0, self
-0002e4f0: 2e70 6172 656e 742e 7769 6474 6829 0d0a  .parent.width)..
-0002e500: 2020 2020 2020 2020 6966 2074 6573 745f          if test_
-0002e510: 726f 695b 315d 203e 2030 2061 6e64 2074  roi[1] > 0 and t
-0002e520: 6573 745f 726f 695b 335d 203c 2073 656c  est_roi[3] < sel
-0002e530: 662e 7061 7265 6e74 2e68 6569 6768 743a  f.parent.height:
-0002e540: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-0002e550: 6c66 2e70 6172 656e 742e 6372 6f70 5f72  lf.parent.crop_r
-0002e560: 6f69 5b31 5d20 3d20 7465 7374 5f72 6f69  oi[1] = test_roi
-0002e570: 5b31 5d0d 0a20 2020 2020 2020 2020 2020  [1]..           
-0002e580: 2073 656c 662e 7061 7265 6e74 2e63 726f   self.parent.cro
-0002e590: 705f 726f 695b 335d 203d 2074 6573 745f  p_roi[3] = test_
-0002e5a0: 726f 695b 335d 0d0a 2020 2020 2020 2020  roi[3]..        
-0002e5b0: 2020 2020 7365 6c66 2e70 6172 656e 742e      self.parent.
-0002e5c0: 6372 6f70 5f72 6f69 5b31 5d20 3d20 636c  crop_roi[1] = cl
-0002e5d0: 616d 7028 7365 6c66 2e70 6172 656e 742e  amp(self.parent.
-0002e5e0: 6372 6f70 5f72 6f69 5b31 5d2c 2030 2c20  crop_roi[1], 0, 
-0002e5f0: 7365 6c66 2e70 6172 656e 742e 6865 6967  self.parent.heig
-0002e600: 6874 290d 0a20 2020 2020 2020 2020 2020  ht)..           
-0002e610: 2073 656c 662e 7061 7265 6e74 2e63 726f   self.parent.cro
-0002e620: 705f 726f 695b 335d 203d 2063 6c61 6d70  p_roi[3] = clamp
-0002e630: 2873 656c 662e 7061 7265 6e74 2e63 726f  (self.parent.cro
-0002e640: 705f 726f 695b 335d 2c20 302c 2073 656c  p_roi[3], 0, sel
-0002e650: 662e 7061 7265 6e74 2e68 6569 6768 7429  f.parent.height)
-0002e660: 0d0a 0d0a 2020 2020 6465 6620 636f 6e76  ....    def conv
-0002e670: 6572 745f 6372 6f70 5f72 6f69 5f74 6f5f  ert_crop_roi_to_
-0002e680: 696e 7465 6765 7273 2873 656c 6629 3a0d  integers(self):.
-0002e690: 0a20 2020 2020 2020 2066 6f72 2069 2069  .        for i i
-0002e6a0: 6e20 7261 6e67 6528 3429 3a0d 0a20 2020  n range(4):..   
-0002e6b0: 2020 2020 2020 2020 2073 656c 662e 7061           self.pa
-0002e6c0: 7265 6e74 2e63 726f 705f 726f 695b 695d  rent.crop_roi[i]
-0002e6d0: 203d 2069 6e74 2873 656c 662e 7061 7265   = int(self.pare
-0002e6e0: 6e74 2e63 726f 705f 726f 695b 695d 290d  nt.crop_roi[i]).
-0002e6f0: 0a0d 0a20 2020 2064 6566 2063 6f6d 7075  ...    def compu
-0002e700: 7465 5f6d 6174 7269 7828 7365 6c66 2c20  te_matrix(self, 
-0002e710: 7365 5f66 7261 6d65 2c20 6361 6d65 7261  se_frame, camera
-0002e720: 293a 0d0a 2020 2020 2020 2020 7365 6c66  ):..        self
-0002e730: 2e70 6172 656e 7420 3d20 7365 5f66 7261  .parent = se_fra
-0002e740: 6d65 0d0a 2020 2020 2020 2020 6670 6f73  me..        fpos
-0002e750: 203d 2073 655f 6672 616d 652e 7472 616e   = se_frame.tran
-0002e760: 7366 6f72 6d2e 7472 616e 736c 6174 696f  sform.translatio
-0002e770: 6e0d 0a20 2020 2020 2020 2066 7820 3d20  n..        fx = 
-0002e780: 5b2d 312c 2031 2c20 312c 202d 315d 0d0a  [-1, 1, 1, -1]..
-0002e790: 2020 2020 2020 2020 6679 203d 205b 312c          fy = [1,
-0002e7a0: 2031 2c20 2d31 2c20 2d31 5d0d 0a20 2020   1, -1, -1]..   
-0002e7b0: 2020 2020 2023 2066 696e 6420 706f 7369       # find posi
-0002e7c0: 7469 6f6e 206f 6620 7468 6520 636f 726e  tion of the corn
-0002e7d0: 6572 206f 6620 7468 6520 6672 616d 6520  er of the frame 
-0002e7e0: 7468 6174 2074 6869 7320 6861 6e64 6c65  that this handle
-0002e7f0: 2062 656c 6f6e 6773 2074 6f0d 0a20 2020   belongs to..   
-0002e800: 2020 2020 2064 7820 3d20 300d 0a20 2020       dx = 0..   
-0002e810: 2020 2020 2064 7920 3d20 300d 0a20 2020       dy = 0..   
-0002e820: 2020 2020 2069 6620 7365 6c66 2e63 6f72       if self.cor
-0002e830: 6e65 725f 6964 7820 3d3d 2030 3a0d 0a20  ner_idx == 0:.. 
-0002e840: 2020 2020 2020 2020 2020 2064 7820 3d20             dx = 
-0002e850: 7365 5f66 7261 6d65 2e63 726f 705f 726f  se_frame.crop_ro
-0002e860: 695b 305d 0d0a 2020 2020 2020 2020 2020  i[0]..          
-0002e870: 2020 6479 203d 202d 7365 5f66 7261 6d65    dy = -se_frame
-0002e880: 2e63 726f 705f 726f 695b 315d 0d0a 2020  .crop_roi[1]..  
-0002e890: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
-0002e8a0: 636f 726e 6572 5f69 6478 203d 3d20 313a  corner_idx == 1:
-0002e8b0: 0d0a 2020 2020 2020 2020 2020 2020 6478  ..            dx
-0002e8c0: 203d 202d 2873 655f 6672 616d 652e 7769   = -(se_frame.wi
-0002e8d0: 6474 6820 2d20 7365 5f66 7261 6d65 2e63  dth - se_frame.c
-0002e8e0: 726f 705f 726f 695b 325d 290d 0a20 2020  rop_roi[2])..   
-0002e8f0: 2020 2020 2020 2020 2064 7920 3d20 2d73           dy = -s
-0002e900: 655f 6672 616d 652e 6372 6f70 5f72 6f69  e_frame.crop_roi
-0002e910: 5b31 5d0d 0a20 2020 2020 2020 2065 6c69  [1]..        eli
-0002e920: 6620 7365 6c66 2e63 6f72 6e65 725f 6964  f self.corner_id
-0002e930: 7820 3d3d 2032 3a0d 0a20 2020 2020 2020  x == 2:..       
-0002e940: 2020 2020 2064 7820 3d20 2d28 7365 5f66       dx = -(se_f
-0002e950: 7261 6d65 2e77 6964 7468 202d 2073 655f  rame.width - se_
-0002e960: 6672 616d 652e 6372 6f70 5f72 6f69 5b32  frame.crop_roi[2
-0002e970: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
-0002e980: 6479 203d 2073 655f 6672 616d 652e 6865  dy = se_frame.he
-0002e990: 6967 6874 202d 2073 655f 6672 616d 652e  ight - se_frame.
-0002e9a0: 6372 6f70 5f72 6f69 5b33 5d0d 0a20 2020  crop_roi[3]..   
-0002e9b0: 2020 2020 2065 6c69 6620 7365 6c66 2e63       elif self.c
-0002e9c0: 6f72 6e65 725f 6964 7820 3d3d 2033 3a0d  orner_idx == 3:.
-0002e9d0: 0a20 2020 2020 2020 2020 2020 2064 7820  .            dx 
-0002e9e0: 3d20 7365 5f66 7261 6d65 2e63 726f 705f  = se_frame.crop_
-0002e9f0: 726f 695b 305d 0d0a 2020 2020 2020 2020  roi[0]..        
-0002ea00: 2020 2020 6479 203d 2073 655f 6672 616d      dy = se_fram
-0002ea10: 652e 6865 6967 6874 202d 2073 655f 6672  e.height - se_fr
-0002ea20: 616d 652e 6372 6f70 5f72 6f69 5b33 5d0d  ame.crop_roi[3].
-0002ea30: 0a20 2020 2020 2020 2073 656c 662e 7472  .        self.tr
-0002ea40: 616e 7366 6f72 6d2e 7472 616e 736c 6174  ansform.translat
-0002ea50: 696f 6e5b 305d 203d 2066 706f 735b 305d  ion[0] = fpos[0]
-0002ea60: 202b 2028 302e 3520 2a20 6678 5b73 656c   + (0.5 * fx[sel
-0002ea70: 662e 636f 726e 6572 5f69 6478 5d20 2a20  f.corner_idx] * 
-0002ea80: 7365 5f66 7261 6d65 2e77 6964 7468 202b  se_frame.width +
-0002ea90: 2064 7829 202a 2073 655f 6672 616d 652e   dx) * se_frame.
-0002eaa0: 7069 7865 6c5f 7369 7a65 0d0a 2020 2020  pixel_size..    
-0002eab0: 2020 2020 7365 6c66 2e74 7261 6e73 666f      self.transfo
-0002eac0: 726d 2e74 7261 6e73 6c61 7469 6f6e 5b31  rm.translation[1
-0002ead0: 5d20 3d20 6670 6f73 5b31 5d20 2b20 2830  ] = fpos[1] + (0
-0002eae0: 2e35 202a 2066 795b 7365 6c66 2e63 6f72  .5 * fy[self.cor
-0002eaf0: 6e65 725f 6964 785d 202a 2073 655f 6672  ner_idx] * se_fr
-0002eb00: 616d 652e 6865 6967 6874 202b 2064 7929  ame.height + dy)
-0002eb10: 202a 2073 655f 6672 616d 652e 7069 7865   * se_frame.pixe
-0002eb20: 6c5f 7369 7a65 0d0a 2020 2020 2020 2020  l_size..        
-0002eb30: 7365 6c66 2e74 7261 6e73 666f 726d 2e72  self.transform.r
-0002eb40: 6f74 6174 696f 6e20 3d20 2d73 656c 662e  otation = -self.
-0002eb50: 636f 726e 6572 5f69 6478 202a 2039 302e  corner_idx * 90.
-0002eb60: 300d 0a20 2020 2020 2020 2073 656c 662e  0..        self.
-0002eb70: 7472 616e 7366 6f72 6d2e 7363 616c 6520  transform.scale 
-0002eb80: 3d20 3135 2e30 202f 2063 616d 6572 612e  = 15.0 / camera.
-0002eb90: 7a6f 6f6d 0d0a 2020 2020 2020 2020 7365  zoom..        se
-0002eba0: 6c66 2e74 7261 6e73 666f 726d 2e63 6f6d  lf.transform.com
-0002ebb0: 7075 7465 5f6d 6174 7269 7828 290d 0a0d  pute_matrix()...
-0002ebc0: 0a20 2020 2020 2020 2023 2073 6574 2069  .        # set i
-0002ebd0: 636f 6e27 7320 636f 726e 6572 2070 6f73  con's corner pos
-0002ebe0: 6974 696f 6e73 0d0a 2020 2020 2020 2020  itions..        
-0002ebf0: 666f 7220 6920 696e 2072 616e 6765 2834  for i in range(4
-0002ec00: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-0002ec10: 6c6f 6361 6c5f 636f 726e 6572 5f70 6f73  local_corner_pos
-0002ec20: 203d 2074 7570 6c65 2873 656c 662e 636f   = tuple(self.co
-0002ec30: 726e 6572 5f70 6f73 6974 696f 6e73 5f6c  rner_positions_l
-0002ec40: 6f63 616c 5b69 5d29 0d0a 2020 2020 2020  ocal[i])..      
-0002ec50: 2020 2020 2020 7665 6320 3d20 6e70 2e6d        vec = np.m
-0002ec60: 6174 7269 7828 5b2a 6c6f 6361 6c5f 636f  atrix([*local_co
-0002ec70: 726e 6572 5f70 6f73 2c20 302e 302c 2031  rner_pos, 0.0, 1
-0002ec80: 2e30 5d29 2e54 0d0a 2020 2020 2020 2020  .0]).T..        
-0002ec90: 2020 2020 776f 726c 645f 636f 726e 6572      world_corner
-0002eca0: 5f70 6f73 203d 2073 656c 662e 7472 616e  _pos = self.tran
-0002ecb0: 7366 6f72 6d2e 6d61 7472 6978 202a 2076  sform.matrix * v
-0002ecc0: 6563 0d0a 2020 2020 2020 2020 2020 2020  ec..            
-0002ecd0: 7365 6c66 2e63 6f72 6e65 725f 706f 7369  self.corner_posi
-0002ece0: 7469 6f6e 735b 695d 203d 205b 666c 6f61  tions[i] = [floa
-0002ecf0: 7428 776f 726c 645f 636f 726e 6572 5f70  t(world_corner_p
-0002ed00: 6f73 5b30 5d29 2c20 666c 6f61 7428 776f  os[0]), float(wo
-0002ed10: 726c 645f 636f 726e 6572 5f70 6f73 5b31  rld_corner_pos[1
-0002ed20: 5d29 5d0d 0a0d 0a20 2020 2064 6566 2069  ])]....    def i
-0002ed30: 735f 686f 7665 7265 6428 7365 6c66 2c20  s_hovered(self, 
-0002ed40: 6361 6d65 7261 2c20 6375 7273 6f72 5f70  camera, cursor_p
-0002ed50: 6f73 6974 696f 6e29 3a0d 0a20 2020 2020  osition):..     
-0002ed60: 2020 2050 203d 2063 616d 6572 612e 6375     P = camera.cu
-0002ed70: 7273 6f72 5f74 6f5f 776f 726c 645f 706f  rsor_to_world_po
-0002ed80: 7369 7469 6f6e 2863 7572 736f 725f 706f  sition(cursor_po
-0002ed90: 7369 7469 6f6e 290d 0a20 2020 2020 2020  sition)..       
-0002eda0: 2041 203d 2073 656c 662e 636f 726e 6572   A = self.corner
-0002edb0: 5f70 6f73 6974 696f 6e73 5b30 5d0d 0a20  _positions[0].. 
-0002edc0: 2020 2020 2020 2042 203d 2073 656c 662e         B = self.
-0002edd0: 636f 726e 6572 5f70 6f73 6974 696f 6e73  corner_positions
-0002ede0: 5b31 5d0d 0a20 2020 2020 2020 2044 203d  [1]..        D =
-0002edf0: 2073 656c 662e 636f 726e 6572 5f70 6f73   self.corner_pos
-0002ee00: 6974 696f 6e73 5b33 5d0d 0a20 2020 2020  itions[3]..     
-0002ee10: 2020 2061 7020 3d20 5b50 5b30 5d20 2d20     ap = [P[0] - 
-0002ee20: 415b 305d 2c20 505b 315d 202d 2041 5b31  A[0], P[1] - A[1
-0002ee30: 5d5d 0d0a 2020 2020 2020 2020 6162 203d  ]]..        ab =
-0002ee40: 205b 425b 305d 202d 2041 5b30 5d2c 2042   [B[0] - A[0], B
-0002ee50: 5b31 5d20 2d20 415b 315d 5d0d 0a20 2020  [1] - A[1]]..   
-0002ee60: 2020 2020 2061 6420 3d20 5b44 5b30 5d20       ad = [D[0] 
-0002ee70: 2d20 415b 305d 2c20 445b 315d 202d 2041  - A[0], D[1] - A
-0002ee80: 5b31 5d5d 0d0a 2020 2020 2020 2020 7265  [1]]..        re
-0002ee90: 7475 726e 2028 3020 3c20 6170 5b30 5d20  turn (0 < ap[0] 
-0002eea0: 2a20 6162 5b30 5d20 2b20 6170 5b31 5d20  * ab[0] + ap[1] 
-0002eeb0: 2a20 6162 5b31 5d20 3c20 6162 5b30 5d20  * ab[1] < ab[0] 
-0002eec0: 2a2a 2032 202b 2061 625b 315d 202a 2a20  ** 2 + ab[1] ** 
-0002eed0: 3229 2061 6e64 2028 3020 3c20 6170 5b30  2) and (0 < ap[0
-0002eee0: 5d20 2a20 6164 5b30 5d20 2b20 6170 5b31  ] * ad[0] + ap[1
-0002eef0: 5d20 2a20 6164 5b31 5d20 3c20 6164 5b30  ] * ad[1] < ad[0
-0002ef00: 5d20 2a2a 2032 202b 2061 645b 315d 202a  ] ** 2 + ad[1] *
-0002ef10: 2a20 3229 0d0a 0d0a                      * 2)....
+00021980: 732c 2076 616c 3d54 7275 6529 3a0d 0a20  s, val=True):.. 
+00021990: 2020 2020 2020 2023 2063 6865 636b 2069         # check i
+000219a0: 6620 7468 6520 6375 7272 656e 7420 736c  f the current sl
+000219b0: 6963 6520 616c 7265 6164 7920 6578 6973  ice already exis
+000219c0: 7473 3b20 6966 206e 6f74 2c20 6d61 6b65  ts; if not, make
+000219d0: 2069 742e 0d0a 2020 2020 2020 2020 7365   it...        se
+000219e0: 676d 656e 7461 7469 6f6e 2e72 6571 7565  gmentation.reque
+000219f0: 7374 5f64 7261 775f 696e 5f63 7572 7265  st_draw_in_curre
+00021a00: 6e74 5f73 6c69 6365 2829 0d0a 2020 2020  nt_slice()..    
+00021a10: 2020 2020 7220 3d20 696e 7428 7365 676d      r = int(segm
+00021a20: 656e 7461 7469 6f6e 2e62 7275 7368 5f73  entation.brush_s
+00021a30: 697a 6529 0d0a 2020 2020 2020 2020 6365  ize)..        ce
+00021a40: 6e74 6572 5f63 6f6f 7264 696e 6174 6573  nter_coordinates
+00021a50: 5b30 5d2c 2063 656e 7465 725f 636f 6f72  [0], center_coor
+00021a60: 6469 6e61 7465 735b 315d 203d 2063 656e  dinates[1] = cen
+00021a70: 7465 725f 636f 6f72 6469 6e61 7465 735b  ter_coordinates[
+00021a80: 315d 2c20 6365 6e74 6572 5f63 6f6f 7264  1], center_coord
+00021a90: 696e 6174 6573 5b30 5d0d 0a20 2020 2020  inates[0]..     
+00021aa0: 2020 2042 7275 7368 2e73 6574 5f63 6972     Brush.set_cir
+00021ab0: 6375 6c61 725f 726f 695f 7261 6469 7573  cular_roi_radius
+00021ac0: 2872 290d 0a0d 0a20 2020 2020 2020 2078  (r)....        x
+00021ad0: 203d 205b 6365 6e74 6572 5f63 6f6f 7264   = [center_coord
+00021ae0: 696e 6174 6573 5b30 5d20 2d20 722c 2063  inates[0] - r, c
+00021af0: 656e 7465 725f 636f 6f72 6469 6e61 7465  enter_coordinate
+00021b00: 735b 305d 202b 2072 202b 2031 5d0d 0a20  s[0] + r + 1].. 
+00021b10: 2020 2020 2020 2079 203d 205b 6365 6e74         y = [cent
+00021b20: 6572 5f63 6f6f 7264 696e 6174 6573 5b31  er_coordinates[1
+00021b30: 5d20 2d20 722c 2063 656e 7465 725f 636f  ] - r, center_co
+00021b40: 6f72 6469 6e61 7465 735b 315d 202b 2072  ordinates[1] + r
+00021b50: 202b 2031 5d0d 0a20 2020 2020 2020 2072   + 1]..        r
+00021b60: 7820 3d20 5b30 2c20 3220 2a20 7220 2b20  x = [0, 2 * r + 
+00021b70: 315d 0d0a 2020 2020 2020 2020 7279 203d  1]..        ry =
+00021b80: 205b 302c 2032 202a 2072 202b 2031 5d0d   [0, 2 * r + 1].
+00021b90: 0a20 2020 2020 2020 2069 6620 785b 305d  .        if x[0]
+00021ba0: 203e 2073 6567 6d65 6e74 6174 696f 6e2e   > segmentation.
+00021bb0: 6865 6967 6874 206f 7220 785b 315d 203c  height or x[1] <
+00021bc0: 2030 206f 7220 795b 305d 203e 2073 6567   0 or y[0] > seg
+00021bd0: 6d65 6e74 6174 696f 6e2e 7769 6474 6820  mentation.width 
+00021be0: 6f72 2079 5b31 5d20 3c20 303a 0d0a 2020  or y[1] < 0:..  
+00021bf0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00021c00: 0d0a 2020 2020 2020 2020 6966 2078 5b30  ..        if x[0
+00021c10: 5d20 3c20 303a 0d0a 2020 2020 2020 2020  ] < 0:..        
+00021c20: 2020 2020 7278 5b30 5d20 2d3d 2078 5b30      rx[0] -= x[0
+00021c30: 5d0d 0a20 2020 2020 2020 2020 2020 2078  ]..            x
+00021c40: 5b30 5d20 3d20 300d 0a20 2020 2020 2020  [0] = 0..       
+00021c50: 2069 6620 795b 305d 203c 2030 3a0d 0a20   if y[0] < 0:.. 
+00021c60: 2020 2020 2020 2020 2020 2072 795b 305d             ry[0]
+00021c70: 202d 3d20 795b 305d 0d0a 2020 2020 2020   -= y[0]..      
+00021c80: 2020 2020 2020 795b 305d 203d 2030 0d0a        y[0] = 0..
+00021c90: 2020 2020 2020 2020 6966 2078 5b31 5d20          if x[1] 
+00021ca0: 3e20 7365 676d 656e 7461 7469 6f6e 2e68  > segmentation.h
+00021cb0: 6569 6768 743a 0d0a 2020 2020 2020 2020  eight:..        
+00021cc0: 2020 2020 7278 5b31 5d20 2d3d 2028 785b      rx[1] -= (x[
+00021cd0: 315d 202d 2073 6567 6d65 6e74 6174 696f  1] - segmentatio
+00021ce0: 6e2e 6865 6967 6874 290d 0a20 2020 2020  n.height)..     
+00021cf0: 2020 2020 2020 2078 5b31 5d20 3d20 7365         x[1] = se
+00021d00: 676d 656e 7461 7469 6f6e 2e68 6569 6768  gmentation.heigh
+00021d10: 740d 0a20 2020 2020 2020 2069 6620 795b  t..        if y[
+00021d20: 315d 203e 2073 6567 6d65 6e74 6174 696f  1] > segmentatio
+00021d30: 6e2e 7769 6474 683a 0d0a 2020 2020 2020  n.width:..      
+00021d40: 2020 2020 2020 7279 5b31 5d20 2d3d 2028        ry[1] -= (
+00021d50: 795b 315d 202d 2073 6567 6d65 6e74 6174  y[1] - segmentat
+00021d60: 696f 6e2e 7769 6474 6829 0d0a 2020 2020  ion.width)..    
+00021d70: 2020 2020 2020 2020 795b 315d 203d 2073          y[1] = s
+00021d80: 6567 6d65 6e74 6174 696f 6e2e 7769 6474  egmentation.widt
+00021d90: 680d 0a0d 0a20 2020 2020 2020 2069 6620  h....        if 
+00021da0: 7661 6c3a 0d0a 2020 2020 2020 2020 2020  val:..          
+00021db0: 2020 7365 676d 656e 7461 7469 6f6e 2e64    segmentation.d
+00021dc0: 6174 615b 785b 305d 3a78 5b31 5d2c 2079  ata[x[0]:x[1], y
+00021dd0: 5b30 5d3a 795b 315d 5d20 2b3d 2042 7275  [0]:y[1]] += Bru
+00021de0: 7368 2e63 6972 6375 6c61 725f 726f 695b  sh.circular_roi[
+00021df0: 7278 5b30 5d3a 7278 5b31 5d2c 2072 795b  rx[0]:rx[1], ry[
+00021e00: 305d 3a72 795b 315d 5d0d 0a20 2020 2020  0]:ry[1]]..     
+00021e10: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00021e20: 2020 2020 2020 7365 676d 656e 7461 7469        segmentati
+00021e30: 6f6e 2e64 6174 615b 785b 305d 3a78 5b31  on.data[x[0]:x[1
+00021e40: 5d2c 2079 5b30 5d3a 795b 315d 5d20 2a3d  ], y[0]:y[1]] *=
+00021e50: 2028 6e70 2e75 696e 7438 2831 2e30 2920   (np.uint8(1.0) 
+00021e60: 2d20 4272 7573 682e 6369 7263 756c 6172  - Brush.circular
+00021e70: 5f72 6f69 5b72 785b 305d 3a72 785b 315d  _roi[rx[0]:rx[1]
+00021e80: 2c20 7279 5b30 5d3a 7279 5b31 5d5d 290d  , ry[0]:ry[1]]).
+00021e90: 0a0d 0a20 2020 2020 2020 2073 6567 6d65  ...        segme
+00021ea0: 6e74 6174 696f 6e2e 6461 7461 5b78 5b30  ntation.data[x[0
+00021eb0: 5d3a 785b 315d 2c20 795b 305d 3a79 5b31  ]:x[1], y[0]:y[1
+00021ec0: 5d5d 203d 206e 702e 636c 6970 2873 6567  ]] = np.clip(seg
+00021ed0: 6d65 6e74 6174 696f 6e2e 6461 7461 5b78  mentation.data[x
+00021ee0: 5b30 5d3a 785b 315d 2c20 795b 305d 3a79  [0]:x[1], y[0]:y
+00021ef0: 5b31 5d5d 2c20 302c 2031 290d 0a20 2020  [1]], 0, 1)..   
+00021f00: 2020 2020 2073 6567 6d65 6e74 6174 696f       segmentatio
+00021f10: 6e2e 7465 7874 7572 652e 7570 6461 7465  n.texture.update
+00021f20: 5f73 7562 696d 6167 6528 7365 676d 656e  _subimage(segmen
+00021f30: 7461 7469 6f6e 2e64 6174 615b 785b 305d  tation.data[x[0]
+00021f40: 3a78 5b31 5d2c 2079 5b30 5d3a 795b 315d  :x[1], y[0]:y[1]
+00021f50: 5d2c 2079 5b30 5d2c 2078 5b30 5d29 0d0a  ], y[0], x[0])..
+00021f60: 0d0a 2020 2020 4073 7461 7469 636d 6574  ..    @staticmet
+00021f70: 686f 640d 0a20 2020 2064 6566 2061 7070  hod..    def app
+00021f80: 6c79 5f6d 6167 6963 2873 6567 6d65 6e74  ly_magic(segment
+00021f90: 6174 696f 6e2c 2069 6d61 6765 2c20 6365  ation, image, ce
+00021fa0: 6e74 6572 5f63 6f6f 7264 696e 6174 6573  nter_coordinates
+00021fb0: 293a 0d0a 2020 2020 2020 2020 7365 676d  ):..        segm
+00021fc0: 656e 7461 7469 6f6e 2e72 6571 7565 7374  entation.request
+00021fd0: 5f64 7261 775f 696e 5f63 7572 7265 6e74  _draw_in_current
+00021fe0: 5f73 6c69 6365 2829 0d0a 2020 2020 2020  _slice()..      
+00021ff0: 2020 7220 3d20 696e 7428 7365 676d 656e    r = int(segmen
+00022000: 7461 7469 6f6e 2e62 7275 7368 5f73 697a  tation.brush_siz
+00022010: 6529 0d0a 2020 2020 2020 2020 6365 6e74  e)..        cent
+00022020: 6572 5f63 6f6f 7264 696e 6174 6573 5b30  er_coordinates[0
+00022030: 5d2c 2063 656e 7465 725f 636f 6f72 6469  ], center_coordi
+00022040: 6e61 7465 735b 315d 203d 2063 656e 7465  nates[1] = cente
+00022050: 725f 636f 6f72 6469 6e61 7465 735b 315d  r_coordinates[1]
+00022060: 2c20 6365 6e74 6572 5f63 6f6f 7264 696e  , center_coordin
+00022070: 6174 6573 5b30 5d0d 0a20 2020 2020 2020  ates[0]..       
+00022080: 2042 7275 7368 2e73 6574 5f6d 6167 6963   Brush.set_magic
+00022090: 5f72 6f69 5f72 6164 6975 7328 7229 0d0a  _roi_radius(r)..
+000220a0: 0d0a 2020 2020 2020 2020 2320 7365 7420  ..        # set 
+000220b0: 7570 2074 6865 2052 4f49 2063 6f6f 7264  up the ROI coord
+000220c0: 696e 6174 6573 2061 6e64 2069 6d61 6765  inates and image
+000220d0: 2063 6f6f 7264 696e 6174 6573 206f 6620   coordinates of 
+000220e0: 7468 6520 7265 6769 6f6e 2074 6f20 7361  the region to sa
+000220f0: 6d70 6c65 2066 726f 6d0d 0a20 2020 2020  mple from..     
+00022100: 2020 2078 2c20 7920 3d20 6365 6e74 6572     x, y = center
+00022110: 5f63 6f6f 7264 696e 6174 6573 5b30 5d2c  _coordinates[0],
+00022120: 2063 656e 7465 725f 636f 6f72 6469 6e61   center_coordina
+00022130: 7465 735b 315d 0d0a 2020 2020 2020 2020  tes[1]..        
+00022140: 6966 2078 203e 2073 6567 6d65 6e74 6174  if x > segmentat
+00022150: 696f 6e2e 6865 6967 6874 206f 7220 7820  ion.height or x 
+00022160: 3c20 3020 6f72 2079 203e 2073 6567 6d65  < 0 or y > segme
+00022170: 6e74 6174 696f 6e2e 7769 6474 6820 6f72  ntation.width or
+00022180: 2079 203c 2030 3a0d 0a20 2020 2020 2020   y < 0:..       
+00022190: 2020 2020 2072 6574 7572 6e0d 0a0d 0a0d       return.....
+000221a0: 0a20 2020 2020 2020 206d 7520 3d20 696d  .        mu = im
+000221b0: 6167 655b 782c 2079 5d0d 0a20 2020 2020  age[x, y]..     
+000221c0: 2020 2076 616c 7565 5f72 616e 6765 203d     value_range =
+000221d0: 205b 6d75 202a 2028 312e 3020 2d20 2831   [mu * (1.0 - (1
+000221e0: 3030 2e30 202d 2028 3530 202b 2030 2e35  00.0 - (50 + 0.5
+000221f0: 202a 2073 6567 6d65 6e74 6174 696f 6e2e   * segmentation.
+00022200: 6d61 6769 635f 7374 7265 6e67 7468 2929  magic_strength))
+00022210: 202f 2031 3030 2e30 292c 206d 7520 2a20   / 100.0), mu * 
+00022220: 2831 2e30 202b 2028 3130 302e 3020 2d20  (1.0 + (100.0 - 
+00022230: 2835 3020 2b20 302e 3520 2a20 7365 676d  (50 + 0.5 * segm
+00022240: 656e 7461 7469 6f6e 2e6d 6167 6963 5f73  entation.magic_s
+00022250: 7472 656e 6774 6829 2920 2f20 3130 302e  trength)) / 100.
+00022260: 3029 5d0d 0a20 2020 2020 2020 2069 6620  0)]..        if 
+00022270: 7661 6c75 655f 7261 6e67 655b 305d 203e  value_range[0] >
+00022280: 2076 616c 7565 5f72 616e 6765 5b31 5d3a   value_range[1]:
+00022290: 0d0a 2020 2020 2020 2020 2020 2020 7661  ..            va
+000222a0: 6c75 655f 7261 6e67 655b 305d 2c20 7661  lue_range[0], va
+000222b0: 6c75 655f 7261 6e67 655b 315d 203d 2076  lue_range[1] = v
+000222c0: 616c 7565 5f72 616e 6765 5b31 5d2c 2076  alue_range[1], v
+000222d0: 616c 7565 5f72 616e 6765 5b30 5d0d 0a20  alue_range[0].. 
+000222e0: 2020 2020 2020 2023 2073 6574 2075 7020         # set up 
+000222f0: 7468 6520 524f 4920 636f 6f72 6469 6e61  the ROI coordina
+00022300: 7465 7320 616e 6420 696d 6167 6520 636f  tes and image co
+00022310: 6f72 6469 6e61 7465 7320 6f66 2074 6865  ordinates of the
+00022320: 2072 6567 696f 6e20 746f 2064 7261 7720   region to draw 
+00022330: 696e 0d0a 2020 2020 2020 2020 7220 3d20  in..        r = 
+00022340: 720d 0a20 2020 2020 2020 2078 203d 205b  r..        x = [
+00022350: 6365 6e74 6572 5f63 6f6f 7264 696e 6174  center_coordinat
+00022360: 6573 5b30 5d20 2d20 722c 2063 656e 7465  es[0] - r, cente
+00022370: 725f 636f 6f72 6469 6e61 7465 735b 305d  r_coordinates[0]
+00022380: 202b 2072 202b 2031 5d0d 0a20 2020 2020   + r + 1]..     
+00022390: 2020 2079 203d 205b 6365 6e74 6572 5f63     y = [center_c
+000223a0: 6f6f 7264 696e 6174 6573 5b31 5d20 2d20  oordinates[1] - 
+000223b0: 722c 2063 656e 7465 725f 636f 6f72 6469  r, center_coordi
+000223c0: 6e61 7465 735b 315d 202b 2072 202b 2031  nates[1] + r + 1
+000223d0: 5d0d 0a20 2020 2020 2020 2072 7820 3d20  ]..        rx = 
+000223e0: 5b30 2c20 3220 2a20 7220 2b20 315d 0d0a  [0, 2 * r + 1]..
+000223f0: 2020 2020 2020 2020 7279 203d 205b 302c          ry = [0,
+00022400: 2032 202a 2072 202b 2031 5d0d 0a0d 0a20   2 * r + 1].... 
+00022410: 2020 2020 2020 2069 6620 785b 305d 203e         if x[0] >
+00022420: 2073 6567 6d65 6e74 6174 696f 6e2e 6865   segmentation.he
+00022430: 6967 6874 206f 7220 785b 315d 203c 2030  ight or x[1] < 0
+00022440: 206f 7220 795b 305d 203e 2073 6567 6d65   or y[0] > segme
+00022450: 6e74 6174 696f 6e2e 7769 6474 6820 6f72  ntation.width or
+00022460: 2079 5b31 5d20 3c20 303a 0d0a 2020 2020   y[1] < 0:..    
+00022470: 2020 2020 2020 2020 7265 7475 726e 0d0a          return..
+00022480: 2020 2020 2020 2020 6966 2078 5b30 5d20          if x[0] 
+00022490: 3c20 303a 0d0a 2020 2020 2020 2020 2020  < 0:..          
+000224a0: 2020 7278 5b30 5d20 2d3d 2078 5b30 5d0d    rx[0] -= x[0].
+000224b0: 0a20 2020 2020 2020 2020 2020 2078 5b30  .            x[0
+000224c0: 5d20 3d20 300d 0a20 2020 2020 2020 2069  ] = 0..        i
+000224d0: 6620 795b 305d 203c 2030 3a0d 0a20 2020  f y[0] < 0:..   
+000224e0: 2020 2020 2020 2020 2072 795b 305d 202d           ry[0] -
+000224f0: 3d20 795b 305d 0d0a 2020 2020 2020 2020  = y[0]..        
+00022500: 2020 2020 795b 305d 203d 2030 0d0a 2020      y[0] = 0..  
+00022510: 2020 2020 2020 6966 2078 5b31 5d20 3e20        if x[1] > 
+00022520: 7365 676d 656e 7461 7469 6f6e 2e68 6569  segmentation.hei
+00022530: 6768 743a 0d0a 2020 2020 2020 2020 2020  ght:..          
+00022540: 2020 7278 5b31 5d20 2d3d 2028 785b 315d    rx[1] -= (x[1]
+00022550: 202d 2073 6567 6d65 6e74 6174 696f 6e2e   - segmentation.
+00022560: 6865 6967 6874 290d 0a20 2020 2020 2020  height)..       
+00022570: 2020 2020 2078 5b31 5d20 3d20 7365 676d       x[1] = segm
+00022580: 656e 7461 7469 6f6e 2e68 6569 6768 740d  entation.height.
+00022590: 0a20 2020 2020 2020 2069 6620 795b 315d  .        if y[1]
+000225a0: 203e 2073 6567 6d65 6e74 6174 696f 6e2e   > segmentation.
+000225b0: 7769 6474 683a 0d0a 2020 2020 2020 2020  width:..        
+000225c0: 2020 2020 7279 5b31 5d20 2d3d 2028 795b      ry[1] -= (y[
+000225d0: 315d 202d 2073 6567 6d65 6e74 6174 696f  1] - segmentatio
+000225e0: 6e2e 7769 6474 6829 0d0a 2020 2020 2020  n.width)..      
+000225f0: 2020 2020 2020 795b 315d 203d 2073 6567        y[1] = seg
+00022600: 6d65 6e74 6174 696f 6e2e 7769 6474 680d  mentation.width.
+00022610: 0a0d 0a20 2020 2020 2020 2063 6f6e 7469  ...        conti
+00022620: 6775 6f75 735f 6d61 736b 203d 206e 702e  guous_mask = np.
+00022630: 7a65 726f 7328 2872 785b 315d 2d72 785b  zeros((rx[1]-rx[
+00022640: 305d 2c20 7279 5b31 5d2d 7279 5b30 5d29  0], ry[1]-ry[0])
+00022650: 2c20 6474 7970 653d 6e70 2e75 696e 7438  , dtype=np.uint8
+00022660: 290d 0a20 2020 2020 2020 2066 6f72 205f  )..        for _
+00022670: 782c 205f 7278 2069 6e20 7a69 7028 7261  x, _rx in zip(ra
+00022680: 6e67 6528 785b 305d 2c20 785b 315d 292c  nge(x[0], x[1]),
+00022690: 2072 616e 6765 2872 785b 305d 2c20 7278   range(rx[0], rx
+000226a0: 5b31 5d29 293a 0d0a 2020 2020 2020 2020  [1])):..        
+000226b0: 2020 2020 666f 7220 5f79 2c20 5f72 7920      for _y, _ry 
+000226c0: 696e 207a 6970 2872 616e 6765 2879 5b30  in zip(range(y[0
+000226d0: 5d2c 2079 5b31 5d29 2c20 7261 6e67 6528  ], y[1]), range(
+000226e0: 7279 5b30 5d2c 2072 795b 315d 2929 3a0d  ry[0], ry[1])):.
+000226f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00022700: 2069 6620 4272 7573 682e 6d61 6769 635f   if Brush.magic_
+00022710: 726f 695b 5f72 782c 205f 7279 5d20 616e  roi[_rx, _ry] an
+00022720: 6420 7661 6c75 655f 7261 6e67 655b 305d  d value_range[0]
+00022730: 203c 2069 6d61 6765 5b5f 782c 205f 795d   < image[_x, _y]
+00022740: 203c 2076 616c 7565 5f72 616e 6765 5b31   < value_range[1
+00022750: 5d3a 0d0a 2020 2020 2020 2020 2020 2020  ]:..            
+00022760: 2020 2020 2020 2020 636f 6e74 6967 756f          contiguo
+00022770: 7573 5f6d 6173 6b5b 5f72 782c 205f 7279  us_mask[_rx, _ry
+00022780: 5d20 3d20 310d 0a0d 0a20 2020 2020 2020  ] = 1....       
+00022790: 2073 7461 636b 203d 205b 2872 202d 2072   stack = [(r - r
+000227a0: 785b 305d 2c20 7220 2d20 7279 5b30 5d29  x[0], r - ry[0])
+000227b0: 5d0d 0a20 2020 2020 2020 2077 2c20 6820  ]..        w, h 
+000227c0: 3d20 2872 785b 315d 202d 2072 785b 305d  = (rx[1] - rx[0]
+000227d0: 2c20 7279 5b31 5d20 2d20 7279 5b30 5d29  , ry[1] - ry[0])
+000227e0: 0d0a 2020 2020 2020 2020 7768 696c 6520  ..        while 
+000227f0: 7374 6163 6b3a 0d0a 2020 2020 2020 2020  stack:..        
+00022800: 2020 2020 6d78 2c20 6d79 203d 2073 7461      mx, my = sta
+00022810: 636b 2e70 6f70 2829 0d0a 2020 2020 2020  ck.pop()..      
+00022820: 2020 2020 2020 6966 2063 6f6e 7469 6775        if contigu
+00022830: 6f75 735f 6d61 736b 5b6d 782c 206d 795d  ous_mask[mx, my]
+00022840: 203d 3d20 313a 0d0a 2020 2020 2020 2020   == 1:..        
+00022850: 2020 2020 2020 2020 636f 6e74 6967 756f          contiguo
+00022860: 7573 5f6d 6173 6b5b 6d78 2c20 6d79 5d20  us_mask[mx, my] 
+00022870: 3d20 320d 0a20 2020 2020 2020 2020 2020  = 2..           
+00022880: 2020 2020 2069 6620 6d78 202b 2031 203c       if mx + 1 <
+00022890: 2077 3a0d 0a20 2020 2020 2020 2020 2020   w:..           
+000228a0: 2020 2020 2020 2020 2073 7461 636b 2e61           stack.a
+000228b0: 7070 656e 6428 286d 7820 2b20 312c 206d  ppend((mx + 1, m
+000228c0: 7929 290d 0a20 2020 2020 2020 2020 2020  y))..           
+000228d0: 2020 2020 2069 6620 6d78 202d 2031 203e       if mx - 1 >
+000228e0: 3d20 303a 0d0a 2020 2020 2020 2020 2020  = 0:..          
+000228f0: 2020 2020 2020 2020 2020 7374 6163 6b2e            stack.
+00022900: 6170 7065 6e64 2828 6d78 202d 2031 2c20  append((mx - 1, 
+00022910: 6d79 2929 0d0a 2020 2020 2020 2020 2020  my))..          
+00022920: 2020 2020 2020 6966 206d 7920 2b20 3120        if my + 1 
+00022930: 3c20 683a 0d0a 2020 2020 2020 2020 2020  < h:..          
+00022940: 2020 2020 2020 2020 2020 7374 6163 6b2e            stack.
+00022950: 6170 7065 6e64 2828 6d78 2c20 6d79 202b  append((mx, my +
+00022960: 2031 2929 0d0a 2020 2020 2020 2020 2020   1))..          
+00022970: 2020 2020 2020 6966 206d 7920 2d20 3120        if my - 1 
+00022980: 3e3d 2030 3a0d 0a20 2020 2020 2020 2020  >= 0:..         
+00022990: 2020 2020 2020 2020 2020 2073 7461 636b             stack
+000229a0: 2e61 7070 656e 6428 286d 782c 206d 7920  .append((mx, my 
+000229b0: 2d20 3129 290d 0a20 2020 2020 2020 2063  - 1))..        c
+000229c0: 6f6e 7469 6775 6f75 735f 6d61 736b 203d  ontiguous_mask =
+000229d0: 2063 6f6e 7469 6775 6f75 735f 6d61 736b   contiguous_mask
+000229e0: 203d 3d20 320d 0a20 2020 2020 2020 2073   == 2..        s
+000229f0: 6567 6d65 6e74 6174 696f 6e2e 6461 7461  egmentation.data
+00022a00: 5b78 5b30 5d3a 785b 315d 2c20 795b 305d  [x[0]:x[1], y[0]
+00022a10: 3a79 5b31 5d5d 202b 3d20 636f 6e74 6967  :y[1]] += contig
+00022a20: 756f 7573 5f6d 6173 6b0d 0a20 2020 2020  uous_mask..     
+00022a30: 2020 2073 6567 6d65 6e74 6174 696f 6e2e     segmentation.
+00022a40: 6461 7461 5b78 5b30 5d3a 785b 315d 2c20  data[x[0]:x[1], 
+00022a50: 795b 305d 3a79 5b31 5d5d 203d 206e 702e  y[0]:y[1]] = np.
+00022a60: 636c 6970 2873 6567 6d65 6e74 6174 696f  clip(segmentatio
+00022a70: 6e2e 6461 7461 5b78 5b30 5d3a 785b 315d  n.data[x[0]:x[1]
+00022a80: 2c20 795b 305d 3a79 5b31 5d5d 2c20 302c  , y[0]:y[1]], 0,
+00022a90: 2031 290d 0a20 2020 2020 2020 2073 6567   1)..        seg
+00022aa0: 6d65 6e74 6174 696f 6e2e 7465 7874 7572  mentation.textur
+00022ab0: 652e 7570 6461 7465 5f73 7562 696d 6167  e.update_subimag
+00022ac0: 6528 7365 676d 656e 7461 7469 6f6e 2e64  e(segmentation.d
+00022ad0: 6174 615b 785b 305d 3a78 5b31 5d2c 2079  ata[x[0]:x[1], y
+00022ae0: 5b30 5d3a 795b 315d 5d2c 2079 5b30 5d2c  [0]:y[1]], y[0],
+00022af0: 2078 5b30 5d29 0d0a 0d0a 0d0a 636c 6173   x[0])......clas
+00022b00: 7320 5265 6e64 6572 6572 3a0d 0a20 2020  s Renderer:..   
+00022b10: 2064 6566 205f 5f69 6e69 745f 5f28 7365   def __init__(se
+00022b20: 6c66 293a 0d0a 2020 2020 2020 2020 7365  lf):..        se
+00022b30: 6c66 2e71 7561 645f 7368 6164 6572 203d  lf.quad_shader =
+00022b40: 2053 6861 6465 7228 6f73 2e70 6174 682e   Shader(os.path.
+00022b50: 6a6f 696e 2863 6667 2e72 6f6f 742c 2022  join(cfg.root, "
+00022b60: 7368 6164 6572 7322 2c20 2273 655f 7175  shaders", "se_qu
+00022b70: 6164 5f73 6861 6465 722e 676c 736c 2229  ad_shader.glsl")
+00022b80: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+00022b90: 625f 7365 676d 656e 7461 7469 6f6e 5f73  b_segmentation_s
+00022ba0: 6861 6465 7220 3d20 5368 6164 6572 286f  hader = Shader(o
+00022bb0: 732e 7061 7468 2e6a 6f69 6e28 6366 672e  s.path.join(cfg.
+00022bc0: 726f 6f74 2c20 2273 6861 6465 7273 222c  root, "shaders",
+00022bd0: 2022 7365 5f62 696e 6172 795f 7365 676d   "se_binary_segm
+00022be0: 656e 7461 7469 6f6e 5f73 6861 6465 722e  entation_shader.
+00022bf0: 676c 736c 2229 290d 0a20 2020 2020 2020  glsl"))..       
+00022c00: 2073 656c 662e 665f 7365 676d 656e 7461   self.f_segmenta
+00022c10: 7469 6f6e 5f73 6861 6465 7220 3d20 5368  tion_shader = Sh
+00022c20: 6164 6572 286f 732e 7061 7468 2e6a 6f69  ader(os.path.joi
+00022c30: 6e28 6366 672e 726f 6f74 2c20 2273 6861  n(cfg.root, "sha
+00022c40: 6465 7273 222c 2022 7365 5f66 6c6f 6174  ders", "se_float
+00022c50: 5f73 6567 6d65 6e74 6174 696f 6e5f 7368  _segmentation_sh
+00022c60: 6164 6572 2e67 6c73 6c22 2929 0d0a 2020  ader.glsl"))..  
+00022c70: 2020 2020 2020 7365 6c66 2e6f 7665 726c        self.overl
+00022c80: 6179 5f73 6861 6465 7220 3d20 5368 6164  ay_shader = Shad
+00022c90: 6572 286f 732e 7061 7468 2e6a 6f69 6e28  er(os.path.join(
+00022ca0: 6366 672e 726f 6f74 2c20 2273 6861 6465  cfg.root, "shade
+00022cb0: 7273 222c 2022 7365 5f6f 7665 726c 6179  rs", "se_overlay
+00022cc0: 5f73 6861 6465 722e 676c 736c 2229 290d  _shader.glsl")).
+00022cd0: 0a20 2020 2020 2020 2073 656c 662e 626f  .        self.bo
+00022ce0: 7264 6572 5f73 6861 6465 7220 3d20 5368  rder_shader = Sh
+00022cf0: 6164 6572 286f 732e 7061 7468 2e6a 6f69  ader(os.path.joi
+00022d00: 6e28 6366 672e 726f 6f74 2c20 2273 6861  n(cfg.root, "sha
+00022d10: 6465 7273 222c 2022 7365 5f62 6f72 6465  ders", "se_borde
+00022d20: 725f 7368 6164 6572 2e67 6c73 6c22 2929  r_shader.glsl"))
+00022d30: 0d0a 2020 2020 2020 2020 7365 6c66 2e6b  ..        self.k
+00022d40: 6572 6e65 6c5f 6669 6c74 6572 203d 2053  ernel_filter = S
+00022d50: 6861 6465 7228 6f73 2e70 6174 682e 6a6f  hader(os.path.jo
+00022d60: 696e 2863 6667 2e72 6f6f 742c 2022 7368  in(cfg.root, "sh
+00022d70: 6164 6572 7322 2c20 2273 655f 636f 6d70  aders", "se_comp
+00022d80: 7574 655f 6b65 726e 656c 5f66 696c 7465  ute_kernel_filte
+00022d90: 722e 676c 736c 2229 290d 0a20 2020 2020  r.glsl"))..     
+00022da0: 2020 2073 656c 662e 6d69 785f 6669 6c74     self.mix_filt
+00022db0: 6572 6564 203d 2053 6861 6465 7228 6f73  ered = Shader(os
+00022dc0: 2e70 6174 682e 6a6f 696e 2863 6667 2e72  .path.join(cfg.r
+00022dd0: 6f6f 742c 2022 7368 6164 6572 7322 2c20  oot, "shaders", 
+00022de0: 2273 655f 636f 6d70 7574 655f 6d69 782e  "se_compute_mix.
+00022df0: 676c 736c 2229 290d 0a20 2020 2020 2020  glsl"))..       
+00022e00: 2073 656c 662e 6c69 6e65 5f73 6861 6465   self.line_shade
+00022e10: 7220 3d20 5368 6164 6572 286f 732e 7061  r = Shader(os.pa
+00022e20: 7468 2e6a 6f69 6e28 6366 672e 726f 6f74  th.join(cfg.root
+00022e30: 2c20 2273 6861 6465 7273 222c 2022 6365  , "shaders", "ce
+00022e40: 5f6c 696e 655f 7368 6164 6572 2e67 6c73  _line_shader.gls
+00022e50: 6c22 2929 0d0a 2020 2020 2020 2020 7365  l"))..        se
+00022e60: 6c66 2e69 636f 6e5f 7368 6164 6572 203d  lf.icon_shader =
+00022e70: 2053 6861 6465 7228 6f73 2e70 6174 682e   Shader(os.path.
+00022e80: 6a6f 696e 2863 6667 2e72 6f6f 742c 2022  join(cfg.root, "
+00022e90: 7368 6164 6572 7322 2c20 2273 655f 6963  shaders", "se_ic
+00022ea0: 6f6e 5f73 6861 6465 722e 676c 736c 2229  on_shader.glsl")
+00022eb0: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+00022ec0: 7375 7266 6163 655f 6d6f 6465 6c5f 7368  surface_model_sh
+00022ed0: 6164 6572 203d 2053 6861 6465 7228 6f73  ader = Shader(os
+00022ee0: 2e70 6174 682e 6a6f 696e 2863 6667 2e72  .path.join(cfg.r
+00022ef0: 6f6f 742c 2022 7368 6164 6572 7322 2c20  oot, "shaders", 
+00022f00: 2273 655f 7375 7266 6163 655f 6d6f 6465  "se_surface_mode
+00022f10: 6c5f 7368 6164 6572 2e67 6c73 6c22 2929  l_shader.glsl"))
+00022f20: 0d0a 2020 2020 2020 2020 7365 6c66 2e6c  ..        self.l
+00022f30: 696e 655f 3364 5f73 6861 6465 7220 3d20  ine_3d_shader = 
+00022f40: 5368 6164 6572 286f 732e 7061 7468 2e6a  Shader(os.path.j
+00022f50: 6f69 6e28 6366 672e 726f 6f74 2c20 2273  oin(cfg.root, "s
+00022f60: 6861 6465 7273 222c 2022 7365 5f6c 696e  haders", "se_lin
+00022f70: 655f 3364 5f73 6861 6465 722e 676c 736c  e_3d_shader.glsl
+00022f80: 2229 290d 0a20 2020 2020 2020 2073 656c  "))..        sel
+00022f90: 662e 7175 6164 5f33 645f 7368 6164 6572  f.quad_3d_shader
+00022fa0: 203d 2053 6861 6465 7228 6f73 2e70 6174   = Shader(os.pat
+00022fb0: 682e 6a6f 696e 2863 6667 2e72 6f6f 742c  h.join(cfg.root,
+00022fc0: 2022 7368 6164 6572 7322 2c20 2273 655f   "shaders", "se_
+00022fd0: 7175 6164 5f33 645f 7368 6164 6572 2e67  quad_3d_shader.g
+00022fe0: 6c73 6c22 2929 0d0a 2020 2020 2020 2020  lsl"))..        
+00022ff0: 7365 6c66 2e64 6570 7468 5f6d 6173 6b5f  self.depth_mask_
+00023000: 7368 6164 6572 203d 2053 6861 6465 7228  shader = Shader(
+00023010: 6f73 2e70 6174 682e 6a6f 696e 2863 6667  os.path.join(cfg
+00023020: 2e72 6f6f 742c 2022 7368 6164 6572 7322  .root, "shaders"
+00023030: 2c20 2273 655f 6465 7074 685f 6d61 736b  , "se_depth_mask
+00023040: 5f73 6861 6465 722e 676c 736c 2229 290d  _shader.glsl")).
+00023050: 0a20 2020 2020 2020 2073 656c 662e 7261  .        self.ra
+00023060: 795f 7472 6163 655f 7368 6164 6572 203d  y_trace_shader =
+00023070: 2053 6861 6465 7228 6f73 2e70 6174 682e   Shader(os.path.
+00023080: 6a6f 696e 2863 6667 2e72 6f6f 742c 2022  join(cfg.root, "
+00023090: 7368 6164 6572 7322 2c20 2273 655f 6f76  shaders", "se_ov
+000230a0: 6572 6c61 795f 7261 795f 7472 6163 655f  erlay_ray_trace_
+000230b0: 7368 6164 6572 2e67 6c73 6c22 2929 0d0a  shader.glsl"))..
+000230c0: 2020 2020 2020 2020 7365 6c66 2e6f 7665          self.ove
+000230d0: 726c 6179 5f62 6c65 6e64 5f73 6861 6465  rlay_blend_shade
+000230e0: 7220 3d20 5368 6164 6572 286f 732e 7061  r = Shader(os.pa
+000230f0: 7468 2e6a 6f69 6e28 6366 672e 726f 6f74  th.join(cfg.root
+00023100: 2c20 2273 6861 6465 7273 222c 2022 7365  , "shaders", "se
+00023110: 5f6f 7665 726c 6179 5f62 6c65 6e64 5f73  _overlay_blend_s
+00023120: 6861 6465 722e 676c 736c 2229 290d 0a20  hader.glsl")).. 
+00023130: 2020 2020 2020 2073 656c 662e 7061 7274         self.part
+00023140: 6963 6c65 5f73 6861 6465 7220 3d20 5368  icle_shader = Sh
+00023150: 6164 6572 286f 732e 7061 7468 2e6a 6f69  ader(os.path.joi
+00023160: 6e28 6366 672e 726f 6f74 2c20 2273 6861  n(cfg.root, "sha
+00023170: 6465 7273 222c 2022 7365 5f70 6172 7469  ders", "se_parti
+00023180: 636c 655f 7368 6164 6572 2e67 6c73 6c22  cle_shader.glsl"
+00023190: 2929 0d0a 2020 2020 2020 2020 7365 6c66  ))..        self
+000231a0: 2e6c 696e 655f 6c69 7374 203d 206c 6973  .line_list = lis
+000231b0: 7428 290d 0a20 2020 2020 2020 2073 656c  t()..        sel
+000231c0: 662e 6c69 6e65 5f6c 6973 745f 7320 3d20  f.line_list_s = 
+000231d0: 6c69 7374 2829 0d0a 2020 2020 2020 2020  list()..        
+000231e0: 7365 6c66 2e6c 696e 655f 7661 203d 2056  self.line_va = V
+000231f0: 6572 7465 7841 7272 6179 284e 6f6e 652c  ertexArray(None,
+00023200: 204e 6f6e 652c 2061 7474 7269 6275 7465   None, attribute
+00023210: 5f66 6f72 6d61 743d 2278 7972 6762 2229  _format="xyrgb")
+00023220: 0d0a 2020 2020 2020 2020 7365 6c66 2e66  ..        self.f
+00023230: 626f 3120 3d20 4672 616d 6542 7566 6665  bo1 = FrameBuffe
+00023240: 7228 290d 0a20 2020 2020 2020 2073 656c  r()..        sel
+00023250: 662e 6662 6f32 203d 2046 7261 6d65 4275  f.fbo2 = FrameBu
+00023260: 6666 6572 2829 0d0a 2020 2020 2020 2020  ffer()..        
+00023270: 7365 6c66 2e66 626f 3320 3d20 4672 616d  self.fbo3 = Fram
+00023280: 6542 7566 6665 7228 3130 302c 2031 3030  eBuffer(100, 100
+00023290: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+000232a0: 7261 795f 7472 6163 655f 6662 6f5f 6120  ray_trace_fbo_a 
+000232b0: 3d20 4672 616d 6542 7566 6665 7228 290d  = FrameBuffer().
+000232c0: 0a20 2020 2020 2020 2073 656c 662e 7261  .        self.ra
+000232d0: 795f 7472 6163 655f 6662 6f5f 6220 3d20  y_trace_fbo_b = 
+000232e0: 4672 616d 6542 7566 6665 7228 290d 0a20  FrameBuffer().. 
+000232f0: 2020 2020 2020 2073 656c 662e 6e64 635f         self.ndc_
+00023300: 7363 7265 656e 5f76 6120 3d20 5665 7274  screen_va = Vert
+00023310: 6578 4172 7261 7928 6174 7472 6962 7574  exArray(attribut
+00023320: 655f 666f 726d 6174 3d22 7879 2229 0d0a  e_format="xy")..
+00023330: 2020 2020 2020 2020 7365 6c66 2e6e 6463          self.ndc
+00023340: 5f73 6372 6565 6e5f 7661 2e75 7064 6174  _screen_va.updat
+00023350: 6528 5665 7274 6578 4275 6666 6572 285b  e(VertexBuffer([
+00023360: 2d31 2c20 2d31 2c20 312c 202d 312c 2031  -1, -1, 1, -1, 1
+00023370: 2c20 312c 202d 312c 2031 5d29 2c20 496e  , 1, -1, 1]), In
+00023380: 6465 7842 7566 6665 7228 5b30 2c20 312c  dexBuffer([0, 1,
+00023390: 2032 2c20 302c 2032 2c20 335d 2929 0d0a   2, 0, 2, 3]))..
+000233a0: 2020 2020 2020 2020 7365 6c66 2e72 6179          self.ray
+000233b0: 5f74 7261 6365 5f66 626f 5f73 697a 6520  _trace_fbo_size 
+000233c0: 3d20 5b30 2e30 2c20 302e 305d 0d0a 2020  = [0.0, 0.0]..  
+000233d0: 2020 2020 2020 7665 7274 6963 6573 2c20        vertices, 
+000233e0: 696e 6469 6365 7320 3d20 6963 6f73 7068  indices = icosph
+000233f0: 6572 655f 7661 2829 0d0a 2020 2020 2020  ere_va()..      
+00023400: 2020 7365 6c66 2e70 6172 7469 636c 655f    self.particle_
+00023410: 7661 203d 2056 6572 7465 7841 7272 6179  va = VertexArray
+00023420: 2856 6572 7465 7842 7566 6665 7228 7665  (VertexBuffer(ve
+00023430: 7274 6963 6573 292c 2049 6e64 6578 4275  rtices), IndexBu
+00023440: 6666 6572 2869 6e64 6963 6573 292c 2061  ffer(indices), a
+00023450: 7474 7269 6275 7465 5f66 6f72 6d61 743d  ttribute_format=
+00023460: 2278 797a 2229 0d0a 0d0a 2020 2020 6465  "xyz")....    de
+00023470: 6620 7265 636f 6d70 696c 655f 7368 6164  f recompile_shad
+00023480: 6572 7328 7365 6c66 293a 2020 2320 666f  ers(self):  # fo
+00023490: 7220 6465 6275 6767 696e 670d 0a20 2020  r debugging..   
+000234a0: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
+000234b0: 2020 2020 2020 2073 656c 662e 7175 6164         self.quad
+000234c0: 5f73 6861 6465 7220 3d20 5368 6164 6572  _shader = Shader
+000234d0: 286f 732e 7061 7468 2e6a 6f69 6e28 6366  (os.path.join(cf
+000234e0: 672e 726f 6f74 2c20 2273 6861 6465 7273  g.root, "shaders
+000234f0: 222c 2022 7365 5f71 7561 645f 7368 6164  ", "se_quad_shad
+00023500: 6572 2e67 6c73 6c22 2929 0d0a 2020 2020  er.glsl"))..    
+00023510: 2020 2020 2020 2020 7365 6c66 2e62 5f73          self.b_s
+00023520: 6567 6d65 6e74 6174 696f 6e5f 7368 6164  egmentation_shad
+00023530: 6572 203d 2053 6861 6465 7228 6f73 2e70  er = Shader(os.p
+00023540: 6174 682e 6a6f 696e 2863 6667 2e72 6f6f  ath.join(cfg.roo
+00023550: 742c 2022 7368 6164 6572 7322 2c20 2273  t, "shaders", "s
+00023560: 655f 6269 6e61 7279 5f73 6567 6d65 6e74  e_binary_segment
+00023570: 6174 696f 6e5f 7368 6164 6572 2e67 6c73  ation_shader.gls
+00023580: 6c22 2929 0d0a 2020 2020 2020 2020 2020  l"))..          
+00023590: 2020 7365 6c66 2e66 5f73 6567 6d65 6e74    self.f_segment
+000235a0: 6174 696f 6e5f 7368 6164 6572 203d 2053  ation_shader = S
+000235b0: 6861 6465 7228 6f73 2e70 6174 682e 6a6f  hader(os.path.jo
+000235c0: 696e 2863 6667 2e72 6f6f 742c 2022 7368  in(cfg.root, "sh
+000235d0: 6164 6572 7322 2c20 2273 655f 666c 6f61  aders", "se_floa
+000235e0: 745f 7365 676d 656e 7461 7469 6f6e 5f73  t_segmentation_s
+000235f0: 6861 6465 722e 676c 736c 2229 290d 0a20  hader.glsl")).. 
+00023600: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00023610: 6f76 6572 6c61 795f 7368 6164 6572 203d  overlay_shader =
+00023620: 2053 6861 6465 7228 6f73 2e70 6174 682e   Shader(os.path.
+00023630: 6a6f 696e 2863 6667 2e72 6f6f 742c 2022  join(cfg.root, "
+00023640: 7368 6164 6572 7322 2c20 2273 655f 6f76  shaders", "se_ov
+00023650: 6572 6c61 795f 7368 6164 6572 2e67 6c73  erlay_shader.gls
+00023660: 6c22 2929 0d0a 2020 2020 2020 2020 2020  l"))..          
+00023670: 2020 7365 6c66 2e62 6f72 6465 725f 7368    self.border_sh
+00023680: 6164 6572 203d 2053 6861 6465 7228 6f73  ader = Shader(os
+00023690: 2e70 6174 682e 6a6f 696e 2863 6667 2e72  .path.join(cfg.r
+000236a0: 6f6f 742c 2022 7368 6164 6572 7322 2c20  oot, "shaders", 
+000236b0: 2273 655f 626f 7264 6572 5f73 6861 6465  "se_border_shade
+000236c0: 722e 676c 736c 2229 290d 0a20 2020 2020  r.glsl"))..     
+000236d0: 2020 2020 2020 2073 656c 662e 6b65 726e         self.kern
+000236e0: 656c 5f66 696c 7465 7220 3d20 5368 6164  el_filter = Shad
+000236f0: 6572 286f 732e 7061 7468 2e6a 6f69 6e28  er(os.path.join(
+00023700: 6366 672e 726f 6f74 2c20 2273 6861 6465  cfg.root, "shade
+00023710: 7273 222c 2022 7365 5f63 6f6d 7075 7465  rs", "se_compute
+00023720: 5f6b 6572 6e65 6c5f 6669 6c74 6572 2e67  _kernel_filter.g
+00023730: 6c73 6c22 2929 0d0a 2020 2020 2020 2020  lsl"))..        
+00023740: 2020 2020 7365 6c66 2e6d 6978 5f66 696c      self.mix_fil
+00023750: 7465 7265 6420 3d20 5368 6164 6572 286f  tered = Shader(o
+00023760: 732e 7061 7468 2e6a 6f69 6e28 6366 672e  s.path.join(cfg.
+00023770: 726f 6f74 2c20 2273 6861 6465 7273 222c  root, "shaders",
+00023780: 2022 7365 5f63 6f6d 7075 7465 5f6d 6978   "se_compute_mix
+00023790: 2e67 6c73 6c22 2929 0d0a 2020 2020 2020  .glsl"))..      
+000237a0: 2020 2020 2020 7365 6c66 2e6c 696e 655f        self.line_
+000237b0: 7368 6164 6572 203d 2053 6861 6465 7228  shader = Shader(
+000237c0: 6f73 2e70 6174 682e 6a6f 696e 2863 6667  os.path.join(cfg
+000237d0: 2e72 6f6f 742c 2022 7368 6164 6572 7322  .root, "shaders"
+000237e0: 2c20 2263 655f 6c69 6e65 5f73 6861 6465  , "ce_line_shade
+000237f0: 722e 676c 736c 2229 290d 0a20 2020 2020  r.glsl"))..     
+00023800: 2020 2020 2020 2073 656c 662e 6963 6f6e         self.icon
+00023810: 5f73 6861 6465 7220 3d20 5368 6164 6572  _shader = Shader
+00023820: 286f 732e 7061 7468 2e6a 6f69 6e28 6366  (os.path.join(cf
+00023830: 672e 726f 6f74 2c20 2273 6861 6465 7273  g.root, "shaders
+00023840: 222c 2022 7365 5f69 636f 6e5f 7368 6164  ", "se_icon_shad
+00023850: 6572 2e67 6c73 6c22 2929 0d0a 2020 2020  er.glsl"))..    
+00023860: 2020 2020 2020 2020 7365 6c66 2e73 7572          self.sur
+00023870: 6661 6365 5f6d 6f64 656c 5f73 6861 6465  face_model_shade
+00023880: 7220 3d20 5368 6164 6572 286f 732e 7061  r = Shader(os.pa
+00023890: 7468 2e6a 6f69 6e28 6366 672e 726f 6f74  th.join(cfg.root
+000238a0: 2c20 2273 6861 6465 7273 222c 2022 7365  , "shaders", "se
+000238b0: 5f73 7572 6661 6365 5f6d 6f64 656c 5f73  _surface_model_s
+000238c0: 6861 6465 722e 676c 736c 2229 290d 0a20  hader.glsl")).. 
+000238d0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000238e0: 6c69 6e65 5f33 645f 7368 6164 6572 203d  line_3d_shader =
+000238f0: 2053 6861 6465 7228 6f73 2e70 6174 682e   Shader(os.path.
+00023900: 6a6f 696e 2863 6667 2e72 6f6f 742c 2022  join(cfg.root, "
+00023910: 7368 6164 6572 7322 2c20 2273 655f 6c69  shaders", "se_li
+00023920: 6e65 5f33 645f 7368 6164 6572 2e67 6c73  ne_3d_shader.gls
+00023930: 6c22 2929 0d0a 2020 2020 2020 2020 2020  l"))..          
+00023940: 2020 7365 6c66 2e71 7561 645f 3364 5f73    self.quad_3d_s
+00023950: 6861 6465 7220 3d20 5368 6164 6572 286f  hader = Shader(o
+00023960: 732e 7061 7468 2e6a 6f69 6e28 6366 672e  s.path.join(cfg.
+00023970: 726f 6f74 2c20 2273 6861 6465 7273 222c  root, "shaders",
+00023980: 2022 7365 5f71 7561 645f 3364 5f73 6861   "se_quad_3d_sha
+00023990: 6465 722e 676c 736c 2229 290d 0a20 2020  der.glsl"))..   
+000239a0: 2020 2020 2020 2020 2073 656c 662e 6465           self.de
+000239b0: 7074 685f 6d61 736b 5f73 6861 6465 7220  pth_mask_shader 
+000239c0: 3d20 5368 6164 6572 286f 732e 7061 7468  = Shader(os.path
+000239d0: 2e6a 6f69 6e28 6366 672e 726f 6f74 2c20  .join(cfg.root, 
+000239e0: 2273 6861 6465 7273 222c 2022 7365 5f64  "shaders", "se_d
+000239f0: 6570 7468 5f6d 6173 6b5f 7368 6164 6572  epth_mask_shader
+00023a00: 2e67 6c73 6c22 2929 0d0a 2020 2020 2020  .glsl"))..      
+00023a10: 2020 2020 2020 7365 6c66 2e72 6179 5f74        self.ray_t
+00023a20: 7261 6365 5f73 6861 6465 7220 3d20 5368  race_shader = Sh
+00023a30: 6164 6572 286f 732e 7061 7468 2e6a 6f69  ader(os.path.joi
+00023a40: 6e28 6366 672e 726f 6f74 2c20 2273 6861  n(cfg.root, "sha
+00023a50: 6465 7273 222c 2022 7365 5f6f 7665 726c  ders", "se_overl
+00023a60: 6179 5f72 6179 5f74 7261 6365 5f73 6861  ay_ray_trace_sha
+00023a70: 6465 722e 676c 736c 2229 290d 0a20 2020  der.glsl"))..   
+00023a80: 2020 2020 2020 2020 2073 656c 662e 6f76           self.ov
+00023a90: 6572 6c61 795f 626c 656e 645f 7368 6164  erlay_blend_shad
+00023aa0: 6572 203d 2053 6861 6465 7228 6f73 2e70  er = Shader(os.p
+00023ab0: 6174 682e 6a6f 696e 2863 6667 2e72 6f6f  ath.join(cfg.roo
+00023ac0: 742c 2022 7368 6164 6572 7322 2c20 2273  t, "shaders", "s
+00023ad0: 655f 6f76 6572 6c61 795f 626c 656e 645f  e_overlay_blend_
+00023ae0: 7368 6164 6572 2e67 6c73 6c22 2929 0d0a  shader.glsl"))..
+00023af0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00023b00: 2e70 6172 7469 636c 655f 7368 6164 6572  .particle_shader
+00023b10: 203d 2053 6861 6465 7228 6f73 2e70 6174   = Shader(os.pat
+00023b20: 682e 6a6f 696e 2863 6667 2e72 6f6f 742c  h.join(cfg.root,
+00023b30: 2022 7368 6164 6572 7322 2c20 2273 655f   "shaders", "se_
+00023b40: 7061 7274 6963 6c65 5f73 6861 6465 722e  particle_shader.
+00023b50: 676c 736c 2229 290d 0a20 2020 2020 2020  glsl"))..       
+00023b60: 2066 696e 616c 6c79 3a0d 0a20 2020 2020   finally:..     
+00023b70: 2020 2020 2020 2070 6173 730d 0a0d 0a20         pass.... 
+00023b80: 2020 2064 6566 2072 656e 6465 725f 6669     def render_fi
+00023b90: 6c74 6572 6564 5f66 7261 6d65 2873 656c  ltered_frame(sel
+00023ba0: 662c 2073 655f 6672 616d 652c 2063 616d  f, se_frame, cam
+00023bb0: 6572 612c 2077 696e 646f 772c 2066 696c  era, window, fil
+00023bc0: 7465 7273 2c20 6361 6d65 7261 3364 3d4e  ters, camera3d=N
+00023bd0: 6f6e 652c 2065 6d70 6861 7369 7a65 5f72  one, emphasize_r
+00023be0: 6f69 3d46 616c 7365 293a 0d0a 2020 2020  oi=False):..    
+00023bf0: 2020 2020 7365 5f66 7261 6d65 2e75 7064      se_frame.upd
+00023c00: 6174 655f 6d6f 6465 6c5f 6d61 7472 6978  ate_model_matrix
+00023c10: 2829 0d0a 2020 2020 2020 2020 676c 426c  ()..        glBl
+00023c20: 656e 6446 756e 6328 474c 5f53 5243 5f41  endFunc(GL_SRC_A
+00023c30: 4c50 4841 2c20 474c 5f4f 4e45 5f4d 494e  LPHA, GL_ONE_MIN
+00023c40: 5553 5f53 5243 5f41 4c50 4841 290d 0a20  US_SRC_ALPHA).. 
+00023c50: 2020 2020 2020 2067 6c42 6c65 6e64 4571         glBlendEq
+00023c60: 7561 7469 6f6e 2847 4c5f 4655 4e43 5f41  uation(GL_FUNC_A
+00023c70: 4444 290d 0a0d 0a20 2020 2020 2020 2073  DD)....        s
+00023c80: 656c 662e 6662 6f31 2e63 6c65 6172 2828  elf.fbo1.clear((
+00023c90: 302e 302c 2030 2e30 2c20 302e 302c 2031  0.0, 0.0, 0.0, 1
+00023ca0: 2e30 2929 0d0a 2020 2020 2020 2020 7365  .0))..        se
+00023cb0: 6c66 2e66 626f 322e 636c 6561 7228 2830  lf.fbo2.clear((0
+00023cc0: 2e30 2c20 302e 302c 2030 2e30 2c20 312e  .0, 0.0, 0.0, 1.
+00023cd0: 3029 290d 0a20 2020 2020 2020 2073 656c  0))..        sel
+00023ce0: 662e 6662 6f33 2e63 6c65 6172 2828 302e  f.fbo3.clear((0.
+00023cf0: 302c 2030 2e30 2c20 302e 302c 2032 2e30  0, 0.0, 0.0, 2.0
+00023d00: 2929 0d0a 0d0a 2020 2020 2020 2020 2320  ))....        # 
+00023d10: 6966 2061 6e79 2066 696c 7465 7273 2077  if any filters w
+00023d20: 696c 6c20 6265 2061 7070 6c69 6564 2062  ill be applied b
+00023d30: 656c 6f77 2c20 7265 7365 7420 7468 6520  elow, reset the 
+00023d40: 6672 616d 6527 7320 6461 7461 2074 6f20  frame's data to 
+00023d50: 7468 6520 6f72 6967 696e 616c 2072 6177  the original raw
+00023d60: 2070 6978 656c 2064 6174 610d 0a20 2020   pixel data..   
+00023d70: 2020 2020 2070 7864 203d 204e 6f6e 650d       pxd = None.
+00023d80: 0a20 2020 2020 2020 206f 7665 7272 6964  .        overrid
+00023d90: 655f 636f 6e74 7261 7374 5f72 6f69 203d  e_contrast_roi =
+00023da0: 2046 616c 7365 0d0a 2020 2020 2020 2020   False..        
+00023db0: 6966 2053 6567 6d65 6e74 6174 696f 6e45  if SegmentationE
+00023dc0: 6469 746f 722e 4652 414d 455f 5445 5854  ditor.FRAME_TEXT
+00023dd0: 5552 455f 5245 5155 4952 4553 5f55 5044  URE_REQUIRES_UPD
+00023de0: 4154 453a 0d0a 2020 2020 2020 2020 2020  ATE:..          
+00023df0: 2020 2320 7365 7420 7468 6520 6672 616d    # set the fram
+00023e00: 6527 7320 2e72 656e 6465 7265 645f 6461  e's .rendered_da
+00023e10: 7461 2074 6f20 7468 6520 7261 7720 696d  ta to the raw im
+00023e20: 6167 6520 6461 7461 202d 2074 6865 6e20  age data - then 
+00023e30: 7265 6e64 6572 2061 7320 7573 7561 6c2e  render as usual.
+00023e40: 0d0a 2020 2020 2020 2020 2020 2020 6366  ..            cf
+00023e50: 672e 7365 5f61 6374 6976 655f 6672 616d  g.se_active_fram
+00023e60: 652e 7265 6e64 6572 6564 5f64 6174 6120  e.rendered_data 
+00023e70: 3d20 6366 672e 7365 5f61 6374 6976 655f  = cfg.se_active_
+00023e80: 6672 616d 652e 6461 7461 0d0a 2020 2020  frame.data..    
+00023e90: 2020 2020 2020 2020 6366 672e 7365 5f61          cfg.se_a
+00023ea0: 6374 6976 655f 6672 616d 652e 7570 6461  ctive_frame.upda
+00023eb0: 7465 5f69 6d61 6765 5f74 6578 7475 7265  te_image_texture
+00023ec0: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
+00023ed0: 7078 6420 3d20 6366 672e 7365 5f61 6374  pxd = cfg.se_act
+00023ee0: 6976 655f 6672 616d 652e 7265 6e64 6572  ive_frame.render
+00023ef0: 6564 5f64 6174 610d 0a20 2020 2020 2020  ed_data..       
+00023f00: 2020 2020 206f 7665 7272 6964 655f 636f       override_co
+00023f10: 6e74 7261 7374 5f72 6f69 203d 2054 7275  ntrast_roi = Tru
+00023f20: 650d 0a0d 0a20 2020 2020 2020 2023 2072  e....        # r
+00023f30: 656e 6465 7220 7468 6520 696d 6167 6520  ender the image 
+00023f40: 746f 2061 2066 7261 6d65 6275 6666 6572  to a framebuffer
+00023f50: 0d0a 2020 2020 2020 2020 6661 6b65 5f63  ..        fake_c
+00023f60: 616d 6572 615f 6d61 7472 6978 203d 206e  amera_matrix = n
+00023f70: 702e 6d61 7472 6978 285b 5b32 202f 2073  p.matrix([[2 / s
+00023f80: 656c 662e 6662 6f31 2e77 6964 7468 2c20  elf.fbo1.width, 
+00023f90: 302c 2030 2c20 305d 2c20 5b30 2c20 3220  0, 0, 0], [0, 2 
+00023fa0: 2f20 7365 6c66 2e66 626f 312e 6865 6967  / self.fbo1.heig
+00023fb0: 6874 2c20 302c 2030 5d2c 205b 302c 2030  ht, 0, 0], [0, 0
+00023fc0: 2c20 2d32 202f 2031 3030 2c20 305d 2c20  , -2 / 100, 0], 
+00023fd0: 5b30 2c20 302c 2030 2c20 315d 5d29 0d0a  [0, 0, 0, 1]])..
+00023fe0: 2020 2020 2020 2020 7365 6c66 2e66 626f          self.fbo
+00023ff0: 312e 6269 6e64 2829 0d0a 2020 2020 2020  1.bind()..      
+00024000: 2020 7365 6c66 2e71 7561 645f 7368 6164    self.quad_shad
+00024010: 6572 2e62 696e 6428 290d 0a20 2020 2020  er.bind()..     
+00024020: 2020 2073 655f 6672 616d 652e 7175 6164     se_frame.quad
+00024030: 5f76 612e 6269 6e64 2829 0d0a 2020 2020  _va.bind()..    
+00024040: 2020 2020 7365 5f66 7261 6d65 2e74 6578      se_frame.tex
+00024050: 7475 7265 2e62 696e 6428 3029 0d0a 2020  ture.bind(0)..  
+00024060: 2020 2020 2020 7365 6c66 2e71 7561 645f        self.quad_
+00024070: 7368 6164 6572 2e75 6e69 666f 726d 6d61  shader.uniformma
+00024080: 7434 2822 6361 6d65 7261 4d61 7472 6978  t4("cameraMatrix
+00024090: 222c 2066 616b 655f 6361 6d65 7261 5f6d  ", fake_camera_m
+000240a0: 6174 7269 7829 0d0a 2020 2020 2020 2020  atrix)..        
+000240b0: 7365 6c66 2e71 7561 645f 7368 6164 6572  self.quad_shader
+000240c0: 2e75 6e69 666f 726d 6d61 7434 2822 6d6f  .uniformmat4("mo
+000240d0: 6465 6c4d 6174 7269 7822 2c20 6e70 2e69  delMatrix", np.i
+000240e0: 6465 6e74 6974 7928 3429 290d 0a20 2020  dentity(4))..   
+000240f0: 2020 2020 2073 656c 662e 7175 6164 5f73       self.quad_s
+00024100: 6861 6465 722e 756e 6966 6f72 6d31 6628  hader.uniform1f(
+00024110: 2261 6c70 6861 222c 2073 655f 6672 616d  "alpha", se_fram
+00024120: 652e 616c 7068 6129 0d0a 2020 2020 2020  e.alpha)..      
+00024130: 2020 7365 6c66 2e71 7561 645f 7368 6164    self.quad_shad
+00024140: 6572 2e75 6e69 666f 726d 3166 2822 636f  er.uniform1f("co
+00024150: 6e74 7261 7374 4d69 6e22 2c20 302e 3029  ntrastMin", 0.0)
+00024160: 0d0a 2020 2020 2020 2020 7365 6c66 2e71  ..        self.q
+00024170: 7561 645f 7368 6164 6572 2e75 6e69 666f  uad_shader.unifo
+00024180: 726d 3166 2822 636f 6e74 7261 7374 4d61  rm1f("contrastMa
+00024190: 7822 2c20 312e 3029 0d0a 2020 2020 2020  x", 1.0)..      
+000241a0: 2020 676c 4472 6177 456c 656d 656e 7473    glDrawElements
+000241b0: 2847 4c5f 5452 4941 4e47 4c45 532c 2073  (GL_TRIANGLES, s
+000241c0: 655f 6672 616d 652e 7175 6164 5f76 612e  e_frame.quad_va.
+000241d0: 696e 6465 7842 7566 6665 722e 6765 7443  indexBuffer.getC
+000241e0: 6f75 6e74 2829 2c20 474c 5f55 4e53 4947  ount(), GL_UNSIG
+000241f0: 4e45 445f 5348 4f52 542c 204e 6f6e 6529  NED_SHORT, None)
+00024200: 0d0a 2020 2020 2020 2020 7365 6c66 2e71  ..        self.q
+00024210: 7561 645f 7368 6164 6572 2e75 6e62 696e  uad_shader.unbin
+00024220: 6428 290d 0a20 2020 2020 2020 2073 655f  d()..        se_
+00024230: 6672 616d 652e 7175 6164 5f76 612e 756e  frame.quad_va.un
+00024240: 6269 6e64 2829 0d0a 2020 2020 2020 2020  bind()..        
+00024250: 676c 4163 7469 7665 5465 7874 7572 6528  glActiveTexture(
+00024260: 474c 5f54 4558 5455 5245 3029 0d0a 2020  GL_TEXTURE0)..  
+00024270: 2020 2020 2020 7365 6c66 2e66 626f 312e        self.fbo1.
+00024280: 756e 6269 6e64 2829 0d0a 2020 2020 2020  unbind()..      
+00024290: 2020 7769 6e64 6f77 2e73 6574 5f66 756c    window.set_ful
+000242a0: 6c5f 7669 6577 706f 7274 2829 0d0a 0d0a  l_viewport()....
+000242b0: 2020 2020 2020 2020 2320 6669 6c74 6572          # filter
+000242c0: 2066 7261 6d65 6275 6666 6572 202d 2062   framebuffer - b
+000242d0: 7574 206f 6e6c 7920 6966 2074 6865 2053  ut only if the S
+000242e0: 6567 6d65 6e74 6174 696f 6e45 6469 746f  egmentationEdito
+000242f0: 7220 7361 7973 2074 6861 7420 7468 6520  r says that the 
+00024300: 696d 6167 6520 6e65 6564 7320 7570 6461  image needs upda
+00024310: 7469 6e67 210d 0a20 2020 2020 2020 2069  ting!..        i
+00024320: 6620 5365 676d 656e 7461 7469 6f6e 4564  f SegmentationEd
+00024330: 6974 6f72 2e46 5241 4d45 5f54 4558 5455  itor.FRAME_TEXTU
+00024340: 5245 5f52 4551 5549 5245 535f 5550 4441  RE_REQUIRES_UPDA
+00024350: 5445 3a0d 0a20 2020 2020 2020 2020 2020  TE:..           
+00024360: 2073 656c 662e 6b65 726e 656c 5f66 696c   self.kernel_fil
+00024370: 7465 722e 6269 6e64 2829 0d0a 2020 2020  ter.bind()..    
+00024380: 2020 2020 2020 2020 636f 6d70 7574 655f          compute_
+00024390: 7369 7a65 203d 2028 696e 7428 6e70 2e63  size = (int(np.c
+000243a0: 6569 6c28 7365 5f66 7261 6d65 2e77 6964  eil(se_frame.wid
+000243b0: 7468 202f 2031 3629 292c 2069 6e74 286e  th / 16)), int(n
+000243c0: 702e 6365 696c 2873 655f 6672 616d 652e  p.ceil(se_frame.
+000243d0: 6865 6967 6874 202f 2031 3629 292c 2031  height / 16)), 1
+000243e0: 290d 0a20 2020 2020 2020 2020 2020 2066  )..            f
+000243f0: 6f72 2066 6c74 7220 696e 2066 696c 7465  or fltr in filte
+00024400: 7273 3a0d 0a20 2020 2020 2020 2020 2020  rs:..           
+00024410: 2020 2020 2069 6620 6e6f 7420 666c 7472       if not fltr
+00024420: 2e65 6e61 626c 6564 3a0d 0a20 2020 2020  .enabled:..     
+00024430: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00024440: 6f6e 7469 6e75 650d 0a20 2020 2020 2020  ontinue..       
+00024450: 2020 2020 2020 2020 2073 656c 662e 6b65           self.ke
+00024460: 726e 656c 5f66 696c 7465 722e 6269 6e64  rnel_filter.bind
+00024470: 2829 0d0a 0d0a 2020 2020 2020 2020 2020  ()....          
+00024480: 2020 2020 2020 2320 686f 7269 7a6f 6e74        # horizont
+00024490: 616c 2073 6861 6465 7220 7061 7373 0d0a  al shader pass..
+000244a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000244b0: 666c 7472 2e62 696e 6428 686f 7269 7a6f  fltr.bind(horizo
+000244c0: 6e74 616c 3d54 7275 6529 0d0a 2020 2020  ntal=True)..    
+000244d0: 2020 2020 2020 2020 2020 2020 676c 4269              glBi
+000244e0: 6e64 496d 6167 6554 6578 7475 7265 2830  ndImageTexture(0
+000244f0: 2c20 7365 6c66 2e66 626f 312e 7465 7874  , self.fbo1.text
+00024500: 7572 652e 7265 6e64 6572 6572 5f69 642c  ure.renderer_id,
+00024510: 2030 2c20 474c 5f46 414c 5345 2c20 302c   0, GL_FALSE, 0,
+00024520: 2047 4c5f 5245 4144 5f4f 4e4c 592c 2047   GL_READ_ONLY, G
+00024530: 4c5f 5247 4241 3332 4629 0d0a 2020 2020  L_RGBA32F)..    
+00024540: 2020 2020 2020 2020 2020 2020 676c 4269              glBi
+00024550: 6e64 496d 6167 6554 6578 7475 7265 2831  ndImageTexture(1
+00024560: 2c20 7365 6c66 2e66 626f 322e 7465 7874  , self.fbo2.text
+00024570: 7572 652e 7265 6e64 6572 6572 5f69 642c  ure.renderer_id,
+00024580: 2030 2c20 474c 5f46 414c 5345 2c20 302c   0, GL_FALSE, 0,
+00024590: 2047 4c5f 5752 4954 455f 4f4e 4c59 2c20   GL_WRITE_ONLY, 
+000245a0: 474c 5f52 4742 4133 3246 290d 0a20 2020  GL_RGBA32F)..   
+000245b0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+000245c0: 662e 6b65 726e 656c 5f66 696c 7465 722e  f.kernel_filter.
+000245d0: 756e 6966 6f72 6d31 6928 2264 6972 6563  uniform1i("direc
+000245e0: 7469 6f6e 222c 2030 290d 0a20 2020 2020  tion", 0)..     
+000245f0: 2020 2020 2020 2020 2020 2067 6c44 6973             glDis
+00024600: 7061 7463 6843 6f6d 7075 7465 282a 636f  patchCompute(*co
+00024610: 6d70 7574 655f 7369 7a65 290d 0a20 2020  mpute_size)..   
+00024620: 2020 2020 2020 2020 2020 2020 2067 6c4d               glM
+00024630: 656d 6f72 7942 6172 7269 6572 2847 4c5f  emoryBarrier(GL_
+00024640: 5348 4144 4552 5f49 4d41 4745 5f41 4343  SHADER_IMAGE_ACC
+00024650: 4553 535f 4241 5252 4945 525f 4249 5429  ESS_BARRIER_BIT)
+00024660: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+00024670: 2020 2020 2320 7665 7274 6963 616c 2073      # vertical s
+00024680: 6861 6465 7220 7061 7373 0d0a 2020 2020  hader pass..    
+00024690: 2020 2020 2020 2020 2020 2020 666c 7472              fltr
+000246a0: 2e62 696e 6428 686f 7269 7a6f 6e74 616c  .bind(horizontal
+000246b0: 3d46 616c 7365 290d 0a20 2020 2020 2020  =False)..       
+000246c0: 2020 2020 2020 2020 2067 6c42 696e 6449           glBindI
+000246d0: 6d61 6765 5465 7874 7572 6528 302c 2073  mageTexture(0, s
+000246e0: 656c 662e 6662 6f32 2e74 6578 7475 7265  elf.fbo2.texture
+000246f0: 2e72 656e 6465 7265 725f 6964 2c20 302c  .renderer_id, 0,
+00024700: 2047 4c5f 4641 4c53 452c 2030 2c20 474c   GL_FALSE, 0, GL
+00024710: 5f52 4541 445f 4f4e 4c59 2c20 474c 5f52  _READ_ONLY, GL_R
+00024720: 4742 4133 3246 290d 0a20 2020 2020 2020  GBA32F)..       
+00024730: 2020 2020 2020 2020 2067 6c42 696e 6449           glBindI
+00024740: 6d61 6765 5465 7874 7572 6528 312c 2073  mageTexture(1, s
+00024750: 656c 662e 6662 6f33 2e74 6578 7475 7265  elf.fbo3.texture
+00024760: 2e72 656e 6465 7265 725f 6964 2c20 302c  .renderer_id, 0,
+00024770: 2047 4c5f 4641 4c53 452c 2030 2c20 474c   GL_FALSE, 0, GL
+00024780: 5f57 5249 5445 5f4f 4e4c 592c 2047 4c5f  _WRITE_ONLY, GL_
+00024790: 5247 4241 3332 4629 0d0a 2020 2020 2020  RGBA32F)..      
+000247a0: 2020 2020 2020 2020 2020 7365 6c66 2e6b            self.k
+000247b0: 6572 6e65 6c5f 6669 6c74 6572 2e75 6e69  ernel_filter.uni
+000247c0: 666f 726d 3169 2822 6469 7265 6374 696f  form1i("directio
+000247d0: 6e22 2c20 3129 0d0a 2020 2020 2020 2020  n", 1)..        
+000247e0: 2020 2020 2020 2020 676c 4469 7370 6174          glDispat
+000247f0: 6368 436f 6d70 7574 6528 2a63 6f6d 7075  chCompute(*compu
+00024800: 7465 5f73 697a 6529 0d0a 2020 2020 2020  te_size)..      
+00024810: 2020 2020 2020 2020 2020 676c 4d65 6d6f            glMemo
+00024820: 7279 4261 7272 6965 7228 474c 5f53 4841  ryBarrier(GL_SHA
+00024830: 4445 525f 494d 4147 455f 4143 4345 5353  DER_IMAGE_ACCESS
+00024840: 5f42 4152 5249 4552 5f42 4954 290d 0a20  _BARRIER_BIT).. 
+00024850: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00024860: 6c74 722e 756e 6269 6e64 2829 0d0a 2020  ltr.unbind()..  
+00024870: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00024880: 6c66 2e6b 6572 6e65 6c5f 6669 6c74 6572  lf.kernel_filter
+00024890: 2e75 6e62 696e 6428 290d 0a0d 0a20 2020  .unbind()....   
+000248a0: 2020 2020 2020 2020 2020 2020 2023 206d               # m
+000248b0: 6978 2074 6865 2066 696c 7465 7265 6420  ix the filtered 
+000248c0: 616e 6420 7468 6520 6f72 6967 696e 616c  and the original
+000248d0: 2069 6d61 6765 0d0a 2020 2020 2020 2020   image..        
+000248e0: 2020 2020 2020 2020 7365 6c66 2e6d 6978          self.mix
+000248f0: 5f66 696c 7465 7265 642e 6269 6e64 2829  _filtered.bind()
+00024900: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00024910: 2020 676c 4269 6e64 496d 6167 6554 6578    glBindImageTex
+00024920: 7475 7265 2830 2c20 7365 6c66 2e66 626f  ture(0, self.fbo
+00024930: 332e 7465 7874 7572 652e 7265 6e64 6572  3.texture.render
+00024940: 6572 5f69 642c 2030 2c20 474c 5f46 414c  er_id, 0, GL_FAL
+00024950: 5345 2c20 302c 2047 4c5f 5245 4144 5f4f  SE, 0, GL_READ_O
+00024960: 4e4c 592c 2047 4c5f 5247 4241 3332 4629  NLY, GL_RGBA32F)
+00024970: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00024980: 2020 676c 4269 6e64 496d 6167 6554 6578    glBindImageTex
+00024990: 7475 7265 2831 2c20 7365 6c66 2e66 626f  ture(1, self.fbo
+000249a0: 312e 7465 7874 7572 652e 7265 6e64 6572  1.texture.render
+000249b0: 6572 5f69 642c 2030 2c20 474c 5f46 414c  er_id, 0, GL_FAL
+000249c0: 5345 2c20 302c 2047 4c5f 5245 4144 5f57  SE, 0, GL_READ_W
+000249d0: 5249 5445 2c20 474c 5f52 4742 4133 3246  RITE, GL_RGBA32F
+000249e0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+000249f0: 2020 2073 656c 662e 6d69 785f 6669 6c74     self.mix_filt
+00024a00: 6572 6564 2e75 6e69 666f 726d 3166 2822  ered.uniform1f("
+00024a10: 7374 7265 6e67 7468 222c 2066 6c74 722e  strength", fltr.
+00024a20: 7374 7265 6e67 7468 290d 0a20 2020 2020  strength)..     
+00024a30: 2020 2020 2020 2020 2020 2067 6c44 6973             glDis
+00024a40: 7061 7463 6843 6f6d 7075 7465 282a 636f  patchCompute(*co
+00024a50: 6d70 7574 655f 7369 7a65 290d 0a20 2020  mpute_size)..   
+00024a60: 2020 2020 2020 2020 2020 2020 2067 6c4d               glM
+00024a70: 656d 6f72 7942 6172 7269 6572 2847 4c5f  emoryBarrier(GL_
+00024a80: 5348 4144 4552 5f49 4d41 4745 5f41 4343  SHADER_IMAGE_ACC
+00024a90: 4553 535f 4241 5252 4945 525f 4249 5429  ESS_BARRIER_BIT)
+00024aa0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00024ab0: 2020 7365 6c66 2e6d 6978 5f66 696c 7465    self.mix_filte
+00024ac0: 7265 642e 756e 6269 6e64 2829 0d0a 0d0a  red.unbind()....
+00024ad0: 2020 2020 2020 2020 2020 2020 2320 7570              # up
+00024ae0: 6461 7465 2068 6973 746f 6772 616d 0d0a  date histogram..
+00024af0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00024b00: 2e66 626f 312e 6269 6e64 2829 0d0a 2020  .fbo1.bind()..  
+00024b10: 2020 2020 2020 2020 2020 7078 6420 3d20            pxd = 
+00024b20: 676c 5265 6164 5069 7865 6c73 2830 2c20  glReadPixels(0, 
+00024b30: 302c 2073 656c 662e 6662 6f31 2e77 6964  0, self.fbo1.wid
+00024b40: 7468 2c20 7365 6c66 2e66 626f 312e 6865  th, self.fbo1.he
+00024b50: 6967 6874 2c20 474c 5f52 4544 2c20 474c  ight, GL_RED, GL
+00024b60: 5f46 4c4f 4154 290d 0a20 2020 2020 2020  _FLOAT)..       
+00024b70: 2020 2020 2070 7864 203d 206e 702e 6672       pxd = np.fr
+00024b80: 6f6d 6275 6666 6572 2870 7864 2c20 6e70  ombuffer(pxd, np
+00024b90: 2e66 6c6f 6174 3332 292e 7265 7368 6170  .float32).reshap
+00024ba0: 6528 7365 6c66 2e66 626f 312e 6865 6967  e(self.fbo1.heig
+00024bb0: 6874 2c20 7365 6c66 2e66 626f 312e 7769  ht, self.fbo1.wi
+00024bc0: 6474 6829 0d0a 2020 2020 2020 2020 2020  dth)..          
+00024bd0: 2020 7365 6c66 2e66 626f 312e 756e 6269    self.fbo1.unbi
+00024be0: 6e64 2829 0d0a 2020 2020 2020 2020 2020  nd()..          
+00024bf0: 2020 7769 6e64 6f77 2e73 6574 5f66 756c    window.set_ful
+00024c00: 6c5f 7669 6577 706f 7274 2829 0d0a 0d0a  l_viewport()....
+00024c10: 2020 2020 2020 2020 2320 7265 6e64 6572          # render
+00024c20: 2074 6865 2066 7261 6d65 6275 6666 6572   the framebuffer
+00024c30: 2074 6f20 7468 6520 7363 7265 656e 0d0a   to the screen..
+00024c40: 2020 2020 2020 2020 7368 6164 6572 203d          shader =
+00024c50: 2073 656c 662e 7175 6164 5f73 6861 6465   self.quad_shade
+00024c60: 7220 6966 206e 6f74 2063 616d 6572 6133  r if not camera3
+00024c70: 6420 656c 7365 2073 656c 662e 7175 6164  d else self.quad
+00024c80: 5f33 645f 7368 6164 6572 0d0a 2020 2020  _3d_shader..    
+00024c90: 2020 2020 7670 6d61 7420 3d20 6361 6d65      vpmat = came
+00024ca0: 7261 2e76 6965 775f 7072 6f6a 6563 7469  ra.view_projecti
+00024cb0: 6f6e 5f6d 6174 7269 7820 6966 206e 6f74  on_matrix if not
+00024cc0: 2063 616d 6572 6133 6420 656c 7365 2063   camera3d else c
+00024cd0: 616d 6572 6133 642e 6d61 7472 6978 0d0a  amera3d.matrix..
+00024ce0: 2020 2020 2020 2020 7368 6164 6572 2e62          shader.b
+00024cf0: 696e 6428 290d 0a20 2020 2020 2020 2073  ind()..        s
+00024d00: 655f 6672 616d 652e 7175 6164 5f76 612e  e_frame.quad_va.
+00024d10: 6269 6e64 2829 0d0a 2020 2020 2020 2020  bind()..        
+00024d20: 7365 6c66 2e66 626f 312e 7465 7874 7572  self.fbo1.textur
+00024d30: 652e 6269 6e64 2830 290d 0a20 2020 2020  e.bind(0)..     
+00024d40: 2020 2073 6861 6465 722e 756e 6966 6f72     shader.unifor
+00024d50: 6d6d 6174 3428 2263 616d 6572 614d 6174  mmat4("cameraMat
+00024d60: 7269 7822 2c20 7670 6d61 7429 0d0a 2020  rix", vpmat)..  
+00024d70: 2020 2020 2020 7368 6164 6572 2e75 6e69        shader.uni
+00024d80: 666f 726d 6d61 7434 2822 6d6f 6465 6c4d  formmat4("modelM
+00024d90: 6174 7269 7822 2c20 7365 5f66 7261 6d65  atrix", se_frame
+00024da0: 2e74 7261 6e73 666f 726d 2e6d 6174 7269  .transform.matri
+00024db0: 7829 0d0a 2020 2020 2020 2020 6372 6f70  x)..        crop
+00024dc0: 5f78 5f6c 696d 7320 3d20 5b73 655f 6672  _x_lims = [se_fr
+00024dd0: 616d 652e 6372 6f70 5f72 6f69 5b30 5d20  ame.crop_roi[0] 
+00024de0: 2f20 7365 5f66 7261 6d65 2e77 6964 7468  / se_frame.width
+00024df0: 2c20 312e 3020 2d20 2873 655f 6672 616d  , 1.0 - (se_fram
+00024e00: 652e 7769 6474 6820 2d20 7365 5f66 7261  e.width - se_fra
+00024e10: 6d65 2e63 726f 705f 726f 695b 325d 2920  me.crop_roi[2]) 
+00024e20: 2f20 7365 5f66 7261 6d65 2e77 6964 7468  / se_frame.width
+00024e30: 5d0d 0a20 2020 2020 2020 2063 726f 705f  ]..        crop_
+00024e40: 795f 6c69 6d73 203d 205b 2873 655f 6672  y_lims = [(se_fr
+00024e50: 616d 652e 6865 6967 6874 202d 2073 655f  ame.height - se_
+00024e60: 6672 616d 652e 6372 6f70 5f72 6f69 5b33  frame.crop_roi[3
+00024e70: 5d29 202f 2073 655f 6672 616d 652e 6865  ]) / se_frame.he
+00024e80: 6967 6874 2c20 312e 3020 2d20 7365 5f66  ight, 1.0 - se_f
+00024e90: 7261 6d65 2e63 726f 705f 726f 695b 315d  rame.crop_roi[1]
+00024ea0: 202f 2073 655f 6672 616d 652e 6865 6967   / se_frame.heig
+00024eb0: 6874 5d0d 0a20 2020 2020 2020 2069 6620  ht]..        if 
+00024ec0: 6f76 6572 7269 6465 5f63 6f6e 7472 6173  override_contras
+00024ed0: 745f 726f 693a 0d0a 2020 2020 2020 2020  t_roi:..        
+00024ee0: 2020 2020 6372 6f70 5f78 5f6c 696d 7320      crop_x_lims 
+00024ef0: 3d20 5b30 2c20 315d 0d0a 2020 2020 2020  = [0, 1]..      
+00024f00: 2020 2020 2020 6372 6f70 5f79 5f6c 696d        crop_y_lim
+00024f10: 7320 3d20 5b30 2c20 315d 0d0a 2020 2020  s = [0, 1]..    
+00024f20: 2020 2020 7368 6164 6572 2e75 6e69 666f      shader.unifo
+00024f30: 726d 3266 2822 784c 696d 7322 2c20 6372  rm2f("xLims", cr
+00024f40: 6f70 5f78 5f6c 696d 7329 0d0a 2020 2020  op_x_lims)..    
+00024f50: 2020 2020 7368 6164 6572 2e75 6e69 666f      shader.unifo
+00024f60: 726d 3266 2822 794c 696d 7322 2c20 6372  rm2f("yLims", cr
+00024f70: 6f70 5f79 5f6c 696d 7329 0d0a 2020 2020  op_y_lims)..    
+00024f80: 2020 2020 7368 6164 6572 2e75 6e69 666f      shader.unifo
+00024f90: 726d 3166 2822 616c 7068 6122 2c20 7365  rm1f("alpha", se
+00024fa0: 5f66 7261 6d65 2e61 6c70 6861 2069 6620  _frame.alpha if 
+00024fb0: 6361 6d65 7261 3364 2069 7320 4e6f 6e65  camera3d is None
+00024fc0: 2065 6c73 6520 5365 676d 656e 7461 7469   else Segmentati
+00024fd0: 6f6e 4564 6974 6f72 2e50 4943 4b49 4e47  onEditor.PICKING
+00024fe0: 5f46 5241 4d45 5f41 4c50 4841 290d 0a20  _FRAME_ALPHA).. 
+00024ff0: 2020 2020 2020 2069 6620 6361 6d65 7261         if camera
+00025000: 3364 2069 7320 6e6f 7420 4e6f 6e65 3a0d  3d is not None:.
+00025010: 0a20 2020 2020 2020 2020 2020 2067 6c45  .            glE
+00025020: 6e61 626c 6528 474c 5f44 4550 5448 5f54  nable(GL_DEPTH_T
+00025030: 4553 5429 0d0a 2020 2020 2020 2020 2020  EST)..          
+00025040: 2020 7368 6164 6572 2e75 6e69 666f 726d    shader.uniform
+00025050: 3166 2822 7a5f 706f 7322 2c20 2873 655f  1f("z_pos", (se_
+00025060: 6672 616d 652e 6375 7272 656e 745f 736c  frame.current_sl
+00025070: 6963 6520 2d20 7365 5f66 7261 6d65 2e6e  ice - se_frame.n
+00025080: 5f73 6c69 6365 7320 2f20 3229 202a 2073  _slices / 2) * s
+00025090: 655f 6672 616d 652e 7069 7865 6c5f 7369  e_frame.pixel_si
+000250a0: 7a65 290d 0a20 2020 2020 2020 2020 2020  ze)..           
+000250b0: 2073 6861 6465 722e 756e 6966 6f72 6d31   shader.uniform1
+000250c0: 6628 2270 6978 656c 5f73 697a 6522 2c20  f("pixel_size", 
+000250d0: 7365 5f66 7261 6d65 2e70 6978 656c 5f73  se_frame.pixel_s
+000250e0: 697a 6529 2020 2320 5468 6973 2066 6163  ize)  # This fac
+000250f0: 746f 7220 7368 6f75 6c64 2062 6520 696e  tor should be in
+00025100: 2074 6865 2056 412c 2062 7574 2066 6978   the VA, but fix
+00025110: 696e 6720 7468 6174 206d 6573 7365 6420  ing that messed 
+00025120: 7570 2074 6865 2032 4420 7669 6577 202d  up the 2D view -
+00025130: 2063 6865 6170 2066 6978 2066 6f72 206e   cheap fix for n
+00025140: 6f77 0d0a 2020 2020 2020 2020 6966 2073  ow..        if s
+00025150: 655f 6672 616d 652e 696e 7665 7274 3a0d  e_frame.invert:.
+00025160: 0a20 2020 2020 2020 2020 2020 2073 6861  .            sha
+00025170: 6465 722e 756e 6966 6f72 6d31 6628 2263  der.uniform1f("c
+00025180: 6f6e 7472 6173 744d 696e 222c 2073 655f  ontrastMin", se_
+00025190: 6672 616d 652e 636f 6e74 7261 7374 5f6c  frame.contrast_l
+000251a0: 696d 735b 315d 290d 0a20 2020 2020 2020  ims[1])..       
+000251b0: 2020 2020 2073 6861 6465 722e 756e 6966       shader.unif
+000251c0: 6f72 6d31 6628 2263 6f6e 7472 6173 744d  orm1f("contrastM
+000251d0: 6178 222c 2073 655f 6672 616d 652e 636f  ax", se_frame.co
+000251e0: 6e74 7261 7374 5f6c 696d 735b 305d 290d  ntrast_lims[0]).
+000251f0: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
+00025200: 2020 2020 2020 2020 2020 2020 7368 6164              shad
+00025210: 6572 2e75 6e69 666f 726d 3166 2822 636f  er.uniform1f("co
+00025220: 6e74 7261 7374 4d69 6e22 2c20 7365 5f66  ntrastMin", se_f
+00025230: 7261 6d65 2e63 6f6e 7472 6173 745f 6c69  rame.contrast_li
+00025240: 6d73 5b30 5d29 0d0a 2020 2020 2020 2020  ms[0])..        
+00025250: 2020 2020 7368 6164 6572 2e75 6e69 666f      shader.unifo
+00025260: 726d 3166 2822 636f 6e74 7261 7374 4d61  rm1f("contrastMa
+00025270: 7822 2c20 7365 5f66 7261 6d65 2e63 6f6e  x", se_frame.con
+00025280: 7472 6173 745f 6c69 6d73 5b31 5d29 0d0a  trast_lims[1])..
+00025290: 2020 2020 2020 2020 676c 4472 6177 456c          glDrawEl
+000252a0: 656d 656e 7473 2847 4c5f 5452 4941 4e47  ements(GL_TRIANG
+000252b0: 4c45 532c 2073 655f 6672 616d 652e 7175  LES, se_frame.qu
+000252c0: 6164 5f76 612e 696e 6465 7842 7566 6665  ad_va.indexBuffe
+000252d0: 722e 6765 7443 6f75 6e74 2829 2c20 474c  r.getCount(), GL
+000252e0: 5f55 4e53 4947 4e45 445f 5348 4f52 542c  _UNSIGNED_SHORT,
+000252f0: 204e 6f6e 6529 0d0a 2020 2020 2020 2020   None)..        
+00025300: 7368 6164 6572 2e75 6e62 696e 6428 290d  shader.unbind().
+00025310: 0a20 2020 2020 2020 2073 655f 6672 616d  .        se_fram
+00025320: 652e 7175 6164 5f76 612e 756e 6269 6e64  e.quad_va.unbind
+00025330: 2829 0d0a 2020 2020 2020 2020 676c 4163  ()..        glAc
+00025340: 7469 7665 5465 7874 7572 6528 474c 5f54  tiveTexture(GL_T
+00025350: 4558 5455 5245 3029 0d0a 2020 2020 2020  EXTURE0)..      
+00025360: 2020 6966 2063 616d 6572 6133 6420 6973    if camera3d is
+00025370: 206e 6f74 204e 6f6e 653a 0d0a 2020 2020   not None:..    
+00025380: 2020 2020 2020 2020 676c 4469 7361 626c          glDisabl
+00025390: 6528 474c 5f44 4550 5448 5f54 4553 5429  e(GL_DEPTH_TEST)
+000253a0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+000253b0: 2070 7864 0d0a 0d0a 2020 2020 6465 6620   pxd....    def 
+000253c0: 7265 6e64 6572 5f6d 6f64 656c 7328 7365  render_models(se
+000253d0: 6c66 2c20 7365 5f66 7261 6d65 2c20 6361  lf, se_frame, ca
+000253e0: 6d65 7261 293a 0d0a 2020 2020 2020 2020  mera):..        
+000253f0: 2320 7265 6e64 6572 206f 7665 726c 6179  # render overlay
+00025400: 7320 2866 726f 6d20 6d6f 6465 6c73 290d  s (from models).
+00025410: 0a20 2020 2020 2020 2073 655f 6672 616d  .        se_fram
+00025420: 652e 7175 6164 5f76 612e 6269 6e64 2829  e.quad_va.bind()
+00025430: 0d0a 2020 2020 2020 2020 7365 6c66 2e66  ..        self.f
+00025440: 5f73 6567 6d65 6e74 6174 696f 6e5f 7368  _segmentation_sh
+00025450: 6164 6572 2e62 696e 6428 290d 0a20 2020  ader.bind()..   
+00025460: 2020 2020 2073 656c 662e 665f 7365 676d       self.f_segm
+00025470: 656e 7461 7469 6f6e 5f73 6861 6465 722e  entation_shader.
+00025480: 756e 6966 6f72 6d6d 6174 3428 2263 616d  uniformmat4("cam
+00025490: 6572 614d 6174 7269 7822 2c20 6361 6d65  eraMatrix", came
+000254a0: 7261 2e76 6965 775f 7072 6f6a 6563 7469  ra.view_projecti
+000254b0: 6f6e 5f6d 6174 7269 7829 0d0a 2020 2020  on_matrix)..    
+000254c0: 2020 2020 7365 6c66 2e66 5f73 6567 6d65      self.f_segme
+000254d0: 6e74 6174 696f 6e5f 7368 6164 6572 2e75  ntation_shader.u
+000254e0: 6e69 666f 726d 6d61 7434 2822 6d6f 6465  niformmat4("mode
+000254f0: 6c4d 6174 7269 7822 2c20 7365 5f66 7261  lMatrix", se_fra
+00025500: 6d65 2e74 7261 6e73 666f 726d 2e6d 6174  me.transform.mat
+00025510: 7269 7829 0d0a 2020 2020 2020 2020 7265  rix)..        re
+00025520: 6e64 6572 5f6c 6973 7420 3d20 636f 7079  nder_list = copy
+00025530: 2863 6667 2e73 655f 6d6f 6465 6c73 290d  (cfg.se_models).
+00025540: 0a20 2020 2020 2020 2069 6620 6366 672e  .        if cfg.
+00025550: 7365 5f61 6374 6976 655f 6d6f 6465 6c20  se_active_model 
+00025560: 696e 2072 656e 6465 725f 6c69 7374 3a0d  in render_list:.
+00025570: 0a20 2020 2020 2020 2020 2020 2072 656e  .            ren
+00025580: 6465 725f 6c69 7374 2e72 656d 6f76 6528  der_list.remove(
+00025590: 6366 672e 7365 5f61 6374 6976 655f 6d6f  cfg.se_active_mo
+000255a0: 6465 6c29 0d0a 2020 2020 2020 2020 2020  del)..          
+000255b0: 2020 7265 6e64 6572 5f6c 6973 742e 6170    render_list.ap
+000255c0: 7065 6e64 2863 6667 2e73 655f 6163 7469  pend(cfg.se_acti
+000255d0: 7665 5f6d 6f64 656c 290d 0a20 2020 2020  ve_model)..     
+000255e0: 2020 2066 6f72 206d 6f64 656c 2069 6e20     for model in 
+000255f0: 7265 6e64 6572 5f6c 6973 743a 0d0a 2020  render_list:..  
+00025600: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
+00025610: 206d 6f64 656c 2e61 6374 6976 6520 6f72   model.active or
+00025620: 206e 6f74 206d 6f64 656c 2e73 686f 773a   not model.show:
+00025630: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00025640: 2020 636f 6e74 696e 7565 0d0a 2020 2020    continue..    
+00025650: 2020 2020 2020 2020 6966 206d 6f64 656c          if model
+00025660: 2e64 6174 6120 6973 204e 6f6e 653a 0d0a  .data is None:..
+00025670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025680: 636f 6e74 696e 7565 0d0a 2020 2020 2020  continue..      
+00025690: 2020 2020 2020 6966 206d 6f64 656c 2e62        if model.b
+000256a0: 6c65 6e64 3a0d 0a20 2020 2020 2020 2020  lend:..         
+000256b0: 2020 2020 2020 2067 6c42 6c65 6e64 4675         glBlendFu
+000256c0: 6e63 2847 4c5f 4453 545f 434f 4c4f 522c  nc(GL_DST_COLOR,
+000256d0: 2047 4c5f 4453 545f 414c 5048 4129 0d0a   GL_DST_ALPHA)..
+000256e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000256f0: 676c 426c 656e 6445 7175 6174 696f 6e28  glBlendEquation(
+00025700: 474c 5f46 554e 435f 4144 4429 0d0a 2020  GL_FUNC_ADD)..  
+00025710: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
+00025720: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00025730: 2067 6c42 6c65 6e64 4675 6e63 2847 4c5f   glBlendFunc(GL_
+00025740: 5352 435f 414c 5048 412c 2047 4c5f 4f4e  SRC_ALPHA, GL_ON
+00025750: 455f 4d49 4e55 535f 5352 435f 414c 5048  E_MINUS_SRC_ALPH
+00025760: 4129 0d0a 2020 2020 2020 2020 2020 2020  A)..            
+00025770: 2020 2020 676c 426c 656e 6445 7175 6174      glBlendEquat
+00025780: 696f 6e28 474c 5f46 554e 435f 4144 4429  ion(GL_FUNC_ADD)
+00025790: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+000257a0: 6c66 2e66 5f73 6567 6d65 6e74 6174 696f  lf.f_segmentatio
+000257b0: 6e5f 7368 6164 6572 2e75 6e69 666f 726d  n_shader.uniform
+000257c0: 3166 2822 616c 7068 6122 2c20 6d6f 6465  1f("alpha", mode
+000257d0: 6c2e 616c 7068 6129 0d0a 2020 2020 2020  l.alpha)..      
+000257e0: 2020 2020 2020 636c 7220 3d20 6d6f 6465        clr = mode
+000257f0: 6c2e 636f 6c6f 7572 0d0a 2020 2020 2020  l.colour..      
+00025800: 2020 2020 2020 616c 7068 6120 3d20 6d6f        alpha = mo
+00025810: 6465 6c2e 616c 7068 610d 0a20 2020 2020  del.alpha..     
+00025820: 2020 2020 2020 2073 656c 662e 665f 7365         self.f_se
+00025830: 676d 656e 7461 7469 6f6e 5f73 6861 6465  gmentation_shade
+00025840: 722e 756e 6966 6f72 6d33 6628 2263 6f6c  r.uniform3f("col
+00025850: 6f75 7222 2c20 2863 6c72 5b30 5d20 2a20  our", (clr[0] * 
+00025860: 616c 7068 612c 2063 6c72 5b31 5d20 2a20  alpha, clr[1] * 
+00025870: 616c 7068 612c 2063 6c72 5b32 5d20 2a20  alpha, clr[2] * 
+00025880: 616c 7068 6129 290d 0a20 2020 2020 2020  alpha))..       
+00025890: 2020 2020 2073 656c 662e 665f 7365 676d       self.f_segm
+000258a0: 656e 7461 7469 6f6e 5f73 6861 6465 722e  entation_shader.
+000258b0: 756e 6966 6f72 6d31 6628 2274 6872 6573  uniform1f("thres
+000258c0: 686f 6c64 222c 206d 6f64 656c 2e74 6872  hold", model.thr
+000258d0: 6573 686f 6c64 290d 0a20 2020 2020 2020  eshold)..       
+000258e0: 2020 2020 206d 6f64 656c 2e74 6578 7475       model.textu
+000258f0: 7265 2e62 696e 6428 3029 0d0a 2020 2020  re.bind(0)..    
+00025900: 2020 2020 2020 2020 676c 4472 6177 456c          glDrawEl
+00025910: 656d 656e 7473 2847 4c5f 5452 4941 4e47  ements(GL_TRIANG
+00025920: 4c45 532c 2073 655f 6672 616d 652e 7175  LES, se_frame.qu
+00025930: 6164 5f76 612e 696e 6465 7842 7566 6665  ad_va.indexBuffe
+00025940: 722e 6765 7443 6f75 6e74 2829 2c20 474c  r.getCount(), GL
+00025950: 5f55 4e53 4947 4e45 445f 5348 4f52 542c  _UNSIGNED_SHORT,
+00025960: 204e 6f6e 6529 0d0a 2020 2020 2020 2020   None)..        
+00025970: 7365 5f66 7261 6d65 2e71 7561 645f 7661  se_frame.quad_va
+00025980: 2e75 6e62 696e 6428 290d 0a20 2020 2020  .unbind()..     
+00025990: 2020 2073 656c 662e 665f 7365 676d 656e     self.f_segmen
+000259a0: 7461 7469 6f6e 5f73 6861 6465 722e 756e  tation_shader.un
+000259b0: 6269 6e64 2829 0d0a 2020 2020 2020 2020  bind()..        
+000259c0: 676c 4163 7469 7665 5465 7874 7572 6528  glActiveTexture(
+000259d0: 474c 5f54 4558 5455 5245 3029 0d0a 0d0a  GL_TEXTURE0)....
+000259e0: 2020 2020 2020 2020 2320 7265 6e64 6572          # render
+000259f0: 2062 6f72 6465 720d 0a20 2020 2020 2020   border..       
+00025a00: 2067 6c42 6c65 6e64 4675 6e63 2847 4c5f   glBlendFunc(GL_
+00025a10: 5352 435f 414c 5048 412c 2047 4c5f 4f4e  SRC_ALPHA, GL_ON
+00025a20: 455f 4d49 4e55 535f 5352 435f 414c 5048  E_MINUS_SRC_ALPH
+00025a30: 4129 0d0a 2020 2020 2020 2020 676c 426c  A)..        glBl
+00025a40: 656e 6445 7175 6174 696f 6e28 474c 5f46  endEquation(GL_F
+00025a50: 554e 435f 4144 4429 0d0a 2020 2020 2020  UNC_ADD)..      
+00025a60: 2020 7365 6c66 2e62 6f72 6465 725f 7368    self.border_sh
+00025a70: 6164 6572 2e62 696e 6428 290d 0a20 2020  ader.bind()..   
+00025a80: 2020 2020 2073 655f 6672 616d 652e 626f       se_frame.bo
+00025a90: 7264 6572 5f76 612e 6269 6e64 2829 0d0a  rder_va.bind()..
+00025aa0: 2020 2020 2020 2020 7365 6c66 2e62 6f72          self.bor
+00025ab0: 6465 725f 7368 6164 6572 2e75 6e69 666f  der_shader.unifo
+00025ac0: 726d 6d61 7434 2822 6361 6d65 7261 4d61  rmmat4("cameraMa
+00025ad0: 7472 6978 222c 2063 616d 6572 612e 7669  trix", camera.vi
+00025ae0: 6577 5f70 726f 6a65 6374 696f 6e5f 6d61  ew_projection_ma
+00025af0: 7472 6978 290d 0a20 2020 2020 2020 2073  trix)..        s
+00025b00: 656c 662e 626f 7264 6572 5f73 6861 6465  elf.border_shade
+00025b10: 722e 756e 6966 6f72 6d6d 6174 3428 226d  r.uniformmat4("m
+00025b20: 6f64 656c 4d61 7472 6978 222c 2073 655f  odelMatrix", se_
+00025b30: 6672 616d 652e 7472 616e 7366 6f72 6d2e  frame.transform.
+00025b40: 6d61 7472 6978 290d 0a20 2020 2020 2020  matrix)..       
+00025b50: 2073 656c 662e 626f 7264 6572 5f73 6861   self.border_sha
+00025b60: 6465 722e 756e 6966 6f72 6d31 6628 227a  der.uniform1f("z
+00025b70: 5f70 6f73 222c 2030 290d 0a20 2020 2020  _pos", 0)..     
+00025b80: 2020 2073 656c 662e 626f 7264 6572 5f73     self.border_s
+00025b90: 6861 6465 722e 756e 6966 6f72 6d31 6628  hader.uniform1f(
+00025ba0: 2261 6c70 6861 222c 2031 2e30 290d 0a20  "alpha", 1.0).. 
+00025bb0: 2020 2020 2020 2067 6c44 7261 7745 6c65         glDrawEle
+00025bc0: 6d65 6e74 7328 474c 5f4c 494e 4553 2c20  ments(GL_LINES, 
+00025bd0: 7365 5f66 7261 6d65 2e62 6f72 6465 725f  se_frame.border_
+00025be0: 7661 2e69 6e64 6578 4275 6666 6572 2e67  va.indexBuffer.g
+00025bf0: 6574 436f 756e 7428 292c 2047 4c5f 554e  etCount(), GL_UN
+00025c00: 5349 474e 4544 5f53 484f 5254 2c20 4e6f  SIGNED_SHORT, No
+00025c10: 6e65 290d 0a20 2020 2020 2020 2073 656c  ne)..        sel
+00025c20: 662e 626f 7264 6572 5f73 6861 6465 722e  f.border_shader.
+00025c30: 756e 6269 6e64 2829 0d0a 2020 2020 2020  unbind()..      
+00025c40: 2020 7365 5f66 7261 6d65 2e62 6f72 6465    se_frame.borde
+00025c50: 725f 7661 2e75 6e62 696e 6428 290d 0a0d  r_va.unbind()...
+00025c60: 0a20 2020 2064 6566 2072 656e 6465 725f  .    def render_
+00025c70: 7365 676d 656e 7461 7469 6f6e 7328 7365  segmentations(se
+00025c80: 6c66 2c20 7365 5f66 7261 6d65 2c20 6361  lf, se_frame, ca
+00025c90: 6d65 7261 293a 0d0a 2020 2020 2020 2020  mera):..        
+00025ca0: 2222 220d 0a20 2020 2020 2020 2073 655f  """..        se_
+00025cb0: 6672 616d 653a 2074 6865 2053 4546 7261  frame: the SEFra
+00025cc0: 6d65 206f 626a 6563 7420 746f 2072 656e  me object to ren
+00025cd0: 6465 722e 0d0a 2020 2020 2020 2020 6361  der...        ca
+00025ce0: 6d65 7261 3a20 6120 4361 6d65 7261 206f  mera: a Camera o
+00025cf0: 626a 6563 7420 746f 2072 656e 6465 7220  bject to render 
+00025d00: 7769 7468 2e0d 0a20 2020 2020 2020 2077  with...        w
+00025d10: 696e 646f 773a 2074 6865 2057 696e 646f  indow: the Windo
+00025d20: 7720 6f62 6a65 6374 2028 746f 2077 6869  w object (to whi
+00025d30: 6368 2074 6865 2076 6965 7770 6f72 7420  ch the viewport 
+00025d40: 7369 7a65 2077 696c 6c20 6265 2072 6573  size will be res
+00025d50: 6574 290d 0a20 2020 2020 2020 2066 696c  et)..        fil
+00025d60: 7465 7273 3a20 6120 6c69 7374 206f 6620  ters: a list of 
+00025d70: 4669 6c74 6572 206f 626a 6563 746d 2c20  Filter objectm, 
+00025d80: 746f 2061 7070 6c79 2074 6f20 7468 6520  to apply to the 
+00025d90: 7365 5f66 7261 6d65 2070 6978 656c 6461  se_frame pixelda
+00025da0: 7461 2e0d 0a20 2020 2020 2020 2022 2222  ta...        """
+00025db0: 0d0a 0d0a 2020 2020 2020 2020 2320 7265  ....        # re
+00025dc0: 6e64 6572 2073 6567 6d65 6e74 6174 696f  nder segmentatio
+00025dd0: 6e20 6f76 6572 6c61 7973 0d0a 2020 2020  n overlays..    
+00025de0: 2020 2020 7365 5f66 7261 6d65 2e71 7561      se_frame.qua
+00025df0: 645f 7661 2e62 696e 6428 290d 0a20 2020  d_va.bind()..   
+00025e00: 2020 2020 2073 656c 662e 625f 7365 676d       self.b_segm
+00025e10: 656e 7461 7469 6f6e 5f73 6861 6465 722e  entation_shader.
+00025e20: 6269 6e64 2829 0d0a 2020 2020 2020 2020  bind()..        
+00025e30: 7365 6c66 2e62 5f73 6567 6d65 6e74 6174  self.b_segmentat
+00025e40: 696f 6e5f 7368 6164 6572 2e75 6e69 666f  ion_shader.unifo
+00025e50: 726d 6d61 7434 2822 6361 6d65 7261 4d61  rmmat4("cameraMa
+00025e60: 7472 6978 222c 2063 616d 6572 612e 7669  trix", camera.vi
+00025e70: 6577 5f70 726f 6a65 6374 696f 6e5f 6d61  ew_projection_ma
+00025e80: 7472 6978 290d 0a20 2020 2020 2020 2073  trix)..        s
+00025e90: 656c 662e 625f 7365 676d 656e 7461 7469  elf.b_segmentati
+00025ea0: 6f6e 5f73 6861 6465 722e 756e 6966 6f72  on_shader.unifor
+00025eb0: 6d6d 6174 3428 226d 6f64 656c 4d61 7472  mmat4("modelMatr
+00025ec0: 6978 222c 2073 655f 6672 616d 652e 7472  ix", se_frame.tr
+00025ed0: 616e 7366 6f72 6d2e 6d61 7472 6978 290d  ansform.matrix).
+00025ee0: 0a20 2020 2020 2020 2072 656e 6465 725f  .        render_
+00025ef0: 6c69 7374 203d 2063 6f70 7928 7365 5f66  list = copy(se_f
+00025f00: 7261 6d65 2e66 6561 7475 7265 7329 0d0a  rame.features)..
+00025f10: 2020 2020 2020 2020 6966 2073 655f 6672          if se_fr
+00025f20: 616d 652e 6163 7469 7665 5f66 6561 7475  ame.active_featu
+00025f30: 7265 2069 6e20 7265 6e64 6572 5f6c 6973  re in render_lis
+00025f40: 743a 0d0a 2020 2020 2020 2020 2020 2020  t:..            
+00025f50: 7265 6e64 6572 5f6c 6973 742e 7265 6d6f  render_list.remo
+00025f60: 7665 2873 655f 6672 616d 652e 6163 7469  ve(se_frame.acti
+00025f70: 7665 5f66 6561 7475 7265 290d 0a20 2020  ve_feature)..   
+00025f80: 2020 2020 2020 2020 2072 656e 6465 725f           render_
+00025f90: 6c69 7374 2e61 7070 656e 6428 7365 5f66  list.append(se_f
+00025fa0: 7261 6d65 2e61 6374 6976 655f 6665 6174  rame.active_feat
+00025fb0: 7572 6529 0d0a 2020 2020 2020 2020 666f  ure)..        fo
+00025fc0: 7220 7365 676d 656e 7461 7469 6f6e 2069  r segmentation i
+00025fd0: 6e20 7265 6e64 6572 5f6c 6973 743a 0d0a  n render_list:..
+00025fe0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00025ff0: 6567 6d65 6e74 6174 696f 6e2e 6869 6465  egmentation.hide
+00026000: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00026010: 2020 2063 6f6e 7469 6e75 650d 0a20 2020     continue..   
+00026020: 2020 2020 2020 2020 2069 6620 7365 676d           if segm
+00026030: 656e 7461 7469 6f6e 2e64 6174 6120 6973  entation.data is
+00026040: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
+00026050: 2020 2020 2020 2020 636f 6e74 696e 7565          continue
+00026060: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+00026070: 206e 6f74 2073 6567 6d65 6e74 6174 696f   not segmentatio
+00026080: 6e2e 636f 6e74 6f75 723a 0d0a 2020 2020  n.contour:..    
+00026090: 2020 2020 2020 2020 2020 2020 676c 426c              glBl
+000260a0: 656e 6446 756e 6328 474c 5f44 5354 5f43  endFunc(GL_DST_C
+000260b0: 4f4c 4f52 2c20 474c 5f44 5354 5f41 4c50  OLOR, GL_DST_ALP
+000260c0: 4841 290d 0a20 2020 2020 2020 2020 2020  HA)..           
+000260d0: 2020 2020 2067 6c42 6c65 6e64 4571 7561       glBlendEqua
+000260e0: 7469 6f6e 2847 4c5f 4655 4e43 5f41 4444  tion(GL_FUNC_ADD
+000260f0: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
+00026100: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+00026110: 2020 2020 2020 676c 426c 656e 6446 756e        glBlendFun
+00026120: 6328 474c 5f53 5243 5f41 4c50 4841 2c20  c(GL_SRC_ALPHA, 
+00026130: 474c 5f4f 4e45 5f4d 494e 5553 5f53 5243  GL_ONE_MINUS_SRC
+00026140: 5f41 4c50 4841 290d 0a20 2020 2020 2020  _ALPHA)..       
+00026150: 2020 2020 2020 2020 2067 6c42 6c65 6e64           glBlend
+00026160: 4571 7561 7469 6f6e 2847 4c5f 4655 4e43  Equation(GL_FUNC
+00026170: 5f41 4444 290d 0a20 2020 2020 2020 2020  _ADD)..         
+00026180: 2020 2073 656c 662e 625f 7365 676d 656e     self.b_segmen
+00026190: 7461 7469 6f6e 5f73 6861 6465 722e 756e  tation_shader.un
+000261a0: 6966 6f72 6d31 6628 2261 6c70 6861 222c  iform1f("alpha",
+000261b0: 2073 6567 6d65 6e74 6174 696f 6e2e 616c   segmentation.al
+000261c0: 7068 6129 0d0a 2020 2020 2020 2020 2020  pha)..          
+000261d0: 2020 636c 7220 3d20 7365 676d 656e 7461    clr = segmenta
+000261e0: 7469 6f6e 2e63 6f6c 6f75 720d 0a20 2020  tion.colour..   
+000261f0: 2020 2020 2020 2020 2061 6c70 6861 203d           alpha =
+00026200: 2073 6567 6d65 6e74 6174 696f 6e2e 616c   segmentation.al
+00026210: 7068 610d 0a20 2020 2020 2020 2020 2020  pha..           
+00026220: 2073 656c 662e 625f 7365 676d 656e 7461   self.b_segmenta
+00026230: 7469 6f6e 5f73 6861 6465 722e 756e 6966  tion_shader.unif
+00026240: 6f72 6d33 6628 2263 6f6c 6f75 7222 2c20  orm3f("colour", 
+00026250: 2863 6c72 5b30 5d20 2a20 616c 7068 612c  (clr[0] * alpha,
+00026260: 2063 6c72 5b31 5d20 2a20 616c 7068 612c   clr[1] * alpha,
+00026270: 2063 6c72 5b32 5d20 2a20 616c 7068 6129   clr[2] * alpha)
+00026280: 290d 0a20 2020 2020 2020 2020 2020 2073  )..            s
+00026290: 656c 662e 625f 7365 676d 656e 7461 7469  elf.b_segmentati
+000262a0: 6f6e 5f73 6861 6465 722e 756e 6966 6f72  on_shader.unifor
+000262b0: 6d31 6928 2263 6f6e 746f 7572 222c 2069  m1i("contour", i
+000262c0: 6e74 2873 6567 6d65 6e74 6174 696f 6e2e  nt(segmentation.
+000262d0: 636f 6e74 6f75 7229 290d 0a0d 0a20 2020  contour))....   
+000262e0: 2020 2020 2020 2020 2073 6567 6d65 6e74           segment
+000262f0: 6174 696f 6e2e 7465 7874 7572 652e 6269  ation.texture.bi
+00026300: 6e64 2830 290d 0a20 2020 2020 2020 2020  nd(0)..         
+00026310: 2020 2067 6c44 7261 7745 6c65 6d65 6e74     glDrawElement
+00026320: 7328 474c 5f54 5249 414e 474c 4553 2c20  s(GL_TRIANGLES, 
+00026330: 7365 5f66 7261 6d65 2e71 7561 645f 7661  se_frame.quad_va
+00026340: 2e69 6e64 6578 4275 6666 6572 2e67 6574  .indexBuffer.get
+00026350: 436f 756e 7428 292c 2047 4c5f 554e 5349  Count(), GL_UNSI
+00026360: 474e 4544 5f53 484f 5254 2c20 4e6f 6e65  GNED_SHORT, None
+00026370: 290d 0a20 2020 2020 2020 2073 655f 6672  )..        se_fr
+00026380: 616d 652e 7175 6164 5f76 612e 756e 6269  ame.quad_va.unbi
+00026390: 6e64 2829 0d0a 2020 2020 2020 2020 7365  nd()..        se
+000263a0: 6c66 2e62 5f73 6567 6d65 6e74 6174 696f  lf.b_segmentatio
+000263b0: 6e5f 7368 6164 6572 2e75 6e62 696e 6428  n_shader.unbind(
+000263c0: 290d 0a20 2020 2020 2020 2067 6c41 6374  )..        glAct
+000263d0: 6976 6554 6578 7475 7265 2847 4c5f 5445  iveTexture(GL_TE
+000263e0: 5854 5552 4530 290d 0a0d 0a20 2020 2020  XTURE0)....     
+000263f0: 2020 2023 2072 656e 6465 7220 626f 7264     # render bord
+00026400: 6572 0d0a 2020 2020 2020 2020 676c 426c  er..        glBl
+00026410: 656e 6446 756e 6328 474c 5f53 5243 5f41  endFunc(GL_SRC_A
+00026420: 4c50 4841 2c20 474c 5f4f 4e45 5f4d 494e  LPHA, GL_ONE_MIN
+00026430: 5553 5f53 5243 5f41 4c50 4841 290d 0a20  US_SRC_ALPHA).. 
+00026440: 2020 2020 2020 2067 6c42 6c65 6e64 4571         glBlendEq
+00026450: 7561 7469 6f6e 2847 4c5f 4655 4e43 5f41  uation(GL_FUNC_A
+00026460: 4444 290d 0a20 2020 2020 2020 2073 656c  DD)..        sel
+00026470: 662e 626f 7264 6572 5f73 6861 6465 722e  f.border_shader.
+00026480: 6269 6e64 2829 0d0a 2020 2020 2020 2020  bind()..        
+00026490: 7365 5f66 7261 6d65 2e62 6f72 6465 725f  se_frame.border_
+000264a0: 7661 2e62 696e 6428 290d 0a20 2020 2020  va.bind()..     
+000264b0: 2020 2073 656c 662e 626f 7264 6572 5f73     self.border_s
+000264c0: 6861 6465 722e 756e 6966 6f72 6d6d 6174  hader.uniformmat
+000264d0: 3428 2263 616d 6572 614d 6174 7269 7822  4("cameraMatrix"
+000264e0: 2c20 6361 6d65 7261 2e76 6965 775f 7072  , camera.view_pr
+000264f0: 6f6a 6563 7469 6f6e 5f6d 6174 7269 7829  ojection_matrix)
+00026500: 0d0a 2020 2020 2020 2020 7365 6c66 2e62  ..        self.b
+00026510: 6f72 6465 725f 7368 6164 6572 2e75 6e69  order_shader.uni
+00026520: 666f 726d 6d61 7434 2822 6d6f 6465 6c4d  formmat4("modelM
+00026530: 6174 7269 7822 2c20 7365 5f66 7261 6d65  atrix", se_frame
+00026540: 2e74 7261 6e73 666f 726d 2e6d 6174 7269  .transform.matri
+00026550: 7829 0d0a 2020 2020 2020 2020 7365 6c66  x)..        self
+00026560: 2e62 6f72 6465 725f 7368 6164 6572 2e75  .border_shader.u
+00026570: 6e69 666f 726d 3166 2822 7a5f 706f 7322  niform1f("z_pos"
+00026580: 2c20 3029 0d0a 2020 2020 2020 2020 7365  , 0)..        se
+00026590: 6c66 2e62 6f72 6465 725f 7368 6164 6572  lf.border_shader
+000265a0: 2e75 6e69 666f 726d 3166 2822 616c 7068  .uniform1f("alph
+000265b0: 6122 2c20 312e 3029 0d0a 2020 2020 2020  a", 1.0)..      
+000265c0: 2020 676c 4472 6177 456c 656d 656e 7473    glDrawElements
+000265d0: 2847 4c5f 4c49 4e45 532c 2073 655f 6672  (GL_LINES, se_fr
+000265e0: 616d 652e 626f 7264 6572 5f76 612e 696e  ame.border_va.in
+000265f0: 6465 7842 7566 6665 722e 6765 7443 6f75  dexBuffer.getCou
+00026600: 6e74 2829 2c20 474c 5f55 4e53 4947 4e45  nt(), GL_UNSIGNE
+00026610: 445f 5348 4f52 542c 204e 6f6e 6529 0d0a  D_SHORT, None)..
+00026620: 2020 2020 2020 2020 7365 6c66 2e62 6f72          self.bor
+00026630: 6465 725f 7368 6164 6572 2e75 6e62 696e  der_shader.unbin
+00026640: 6428 290d 0a20 2020 2020 2020 2073 655f  d()..        se_
+00026650: 6672 616d 652e 626f 7264 6572 5f76 612e  frame.border_va.
+00026660: 756e 6269 6e64 2829 0d0a 0d0a 2020 2020  unbind()....    
+00026670: 6465 6620 7265 6e64 6572 5f66 7261 6d65  def render_frame
+00026680: 5f62 6f72 6465 7228 7365 6c66 2c20 7365  _border(self, se
+00026690: 5f66 7261 6d65 2c20 6361 6d65 7261 293a  _frame, camera):
+000266a0: 0d0a 2020 2020 2020 2020 676c 426c 656e  ..        glBlen
+000266b0: 6446 756e 6328 474c 5f53 5243 5f41 4c50  dFunc(GL_SRC_ALP
+000266c0: 4841 2c20 474c 5f4f 4e45 5f4d 494e 5553  HA, GL_ONE_MINUS
+000266d0: 5f53 5243 5f41 4c50 4841 290d 0a20 2020  _SRC_ALPHA)..   
+000266e0: 2020 2020 2067 6c42 6c65 6e64 4571 7561       glBlendEqua
+000266f0: 7469 6f6e 2847 4c5f 4655 4e43 5f41 4444  tion(GL_FUNC_ADD
+00026700: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+00026710: 626f 7264 6572 5f73 6861 6465 722e 6269  border_shader.bi
+00026720: 6e64 2829 0d0a 2020 2020 2020 2020 7365  nd()..        se
+00026730: 5f66 7261 6d65 2e62 6f72 6465 725f 7661  _frame.border_va
+00026740: 2e62 696e 6428 290d 0a20 2020 2020 2020  .bind()..       
+00026750: 2073 656c 662e 626f 7264 6572 5f73 6861   self.border_sha
+00026760: 6465 722e 756e 6966 6f72 6d6d 6174 3428  der.uniformmat4(
+00026770: 2263 616d 6572 614d 6174 7269 7822 2c20  "cameraMatrix", 
+00026780: 6361 6d65 7261 2e76 6965 775f 7072 6f6a  camera.view_proj
+00026790: 6563 7469 6f6e 5f6d 6174 7269 7829 0d0a  ection_matrix)..
+000267a0: 2020 2020 2020 2020 7365 6c66 2e62 6f72          self.bor
+000267b0: 6465 725f 7368 6164 6572 2e75 6e69 666f  der_shader.unifo
+000267c0: 726d 6d61 7434 2822 6d6f 6465 6c4d 6174  rmmat4("modelMat
+000267d0: 7269 7822 2c20 7365 5f66 7261 6d65 2e74  rix", se_frame.t
+000267e0: 7261 6e73 666f 726d 2e6d 6174 7269 7829  ransform.matrix)
+000267f0: 0d0a 2020 2020 2020 2020 7365 6c66 2e62  ..        self.b
+00026800: 6f72 6465 725f 7368 6164 6572 2e75 6e69  order_shader.uni
+00026810: 666f 726d 3166 2822 7a5f 706f 7322 2c20  form1f("z_pos", 
+00026820: 2873 655f 6672 616d 652e 6375 7272 656e  (se_frame.curren
+00026830: 745f 736c 6963 6520 2d20 7365 5f66 7261  t_slice - se_fra
+00026840: 6d65 2e6e 5f73 6c69 6365 7320 2f20 3229  me.n_slices / 2)
+00026850: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+00026860: 626f 7264 6572 5f73 6861 6465 722e 756e  border_shader.un
+00026870: 6966 6f72 6d31 6628 2261 6c70 6861 222c  iform1f("alpha",
+00026880: 2053 6567 6d65 6e74 6174 696f 6e45 6469   SegmentationEdi
+00026890: 746f 722e 5049 434b 494e 475f 4652 414d  tor.PICKING_FRAM
+000268a0: 455f 414c 5048 4129 0d0a 2020 2020 2020  E_ALPHA)..      
+000268b0: 2020 676c 4472 6177 456c 656d 656e 7473    glDrawElements
+000268c0: 2847 4c5f 4c49 4e45 532c 2073 655f 6672  (GL_LINES, se_fr
+000268d0: 616d 652e 626f 7264 6572 5f76 612e 696e  ame.border_va.in
+000268e0: 6465 7842 7566 6665 722e 6765 7443 6f75  dexBuffer.getCou
+000268f0: 6e74 2829 2c20 474c 5f55 4e53 4947 4e45  nt(), GL_UNSIGNE
+00026900: 445f 5348 4f52 542c 204e 6f6e 6529 0d0a  D_SHORT, None)..
+00026910: 2020 2020 2020 2020 7365 6c66 2e62 6f72          self.bor
+00026920: 6465 725f 7368 6164 6572 2e75 6e62 696e  der_shader.unbin
+00026930: 6428 290d 0a20 2020 2020 2020 2073 655f  d()..        se_
+00026940: 6672 616d 652e 626f 7264 6572 5f76 612e  frame.border_va.
+00026950: 756e 6269 6e64 2829 0d0a 0d0a 2020 2020  unbind()....    
+00026960: 6465 6620 7265 6e64 6572 5f63 726f 705f  def render_crop_
+00026970: 6861 6e64 6c65 7328 7365 6c66 2c20 7365  handles(self, se
+00026980: 5f66 7261 6d65 2c20 6361 6d65 7261 2c20  _frame, camera, 
+00026990: 6861 6e64 6c65 7329 3a0d 0a20 2020 2020  handles):..     
+000269a0: 2020 2073 656c 662e 6963 6f6e 5f73 6861     self.icon_sha
+000269b0: 6465 722e 6269 6e64 2829 0d0a 2020 2020  der.bind()..    
+000269c0: 2020 2020 685f 7661 203d 2068 616e 646c      h_va = handl
+000269d0: 6573 5b30 5d2e 6765 745f 7661 2829 0d0a  es[0].get_va()..
+000269e0: 2020 2020 2020 2020 685f 7661 2e62 696e          h_va.bin
+000269f0: 6428 290d 0a20 2020 2020 2020 2068 616e  d()..        han
+00026a00: 646c 6573 5b30 5d2e 6765 745f 7465 7874  dles[0].get_text
+00026a10: 7572 6528 292e 6269 6e64 2830 290d 0a20  ure().bind(0).. 
+00026a20: 2020 2020 2020 2073 656c 662e 6963 6f6e         self.icon
+00026a30: 5f73 6861 6465 722e 756e 6966 6f72 6d6d  _shader.uniformm
+00026a40: 6174 3428 2263 616d 6572 614d 6174 7269  at4("cameraMatri
+00026a50: 7822 2c20 6361 6d65 7261 2e76 6965 775f  x", camera.view_
+00026a60: 7072 6f6a 6563 7469 6f6e 5f6d 6174 7269  projection_matri
+00026a70: 7829 0d0a 2020 2020 2020 2020 666f 7220  x)..        for 
+00026a80: 6820 696e 2068 616e 646c 6573 3a0d 0a20  h in handles:.. 
+00026a90: 2020 2020 2020 2020 2020 2068 2e63 6f6d             h.com
+00026aa0: 7075 7465 5f6d 6174 7269 7828 7365 5f66  pute_matrix(se_f
+00026ab0: 7261 6d65 2c20 6361 6d65 7261 290d 0a20  rame, camera).. 
+00026ac0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00026ad0: 6963 6f6e 5f73 6861 6465 722e 756e 6966  icon_shader.unif
+00026ae0: 6f72 6d6d 6174 3428 226d 6f64 656c 4d61  ormmat4("modelMa
+00026af0: 7472 6978 222c 2068 2e74 7261 6e73 666f  trix", h.transfo
+00026b00: 726d 2e6d 6174 7269 7829 0d0a 2020 2020  rm.matrix)..    
+00026b10: 2020 2020 2020 2020 7365 6c66 2e69 636f          self.ico
+00026b20: 6e5f 7368 6164 6572 2e75 6e69 666f 726d  n_shader.uniform
+00026b30: 3169 2822 696e 7665 7274 222c 2069 6e74  1i("invert", int
+00026b40: 2873 655f 6672 616d 652e 696e 7665 7274  (se_frame.invert
+00026b50: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
+00026b60: 676c 4472 6177 456c 656d 656e 7473 2847  glDrawElements(G
+00026b70: 4c5f 5452 4941 4e47 4c45 532c 2068 5f76  L_TRIANGLES, h_v
+00026b80: 612e 696e 6465 7842 7566 6665 722e 6765  a.indexBuffer.ge
+00026b90: 7443 6f75 6e74 2829 2c20 474c 5f55 4e53  tCount(), GL_UNS
+00026ba0: 4947 4e45 445f 5348 4f52 542c 204e 6f6e  IGNED_SHORT, Non
+00026bb0: 6529 0d0a 2020 2020 2020 2020 7365 6c66  e)..        self
+00026bc0: 2e69 636f 6e5f 7368 6164 6572 2e75 6e62  .icon_shader.unb
+00026bd0: 696e 6428 290d 0a20 2020 2020 2020 2068  ind()..        h
+00026be0: 5f76 612e 756e 6269 6e64 2829 0d0a 0d0a  _va.unbind()....
+00026bf0: 2020 2020 6465 6620 7265 6e64 6572 5f73      def render_s
+00026c00: 7572 6661 6365 5f6d 6f64 656c 7328 7365  urface_models(se
+00026c10: 6c66 2c20 7375 7266 6163 655f 6d6f 6465  lf, surface_mode
+00026c20: 6c73 2c20 6361 6d65 7261 2c20 616d 6269  ls, camera, ambi
+00026c30: 656e 745f 7374 7265 6e67 7468 2c20 7370  ent_strength, sp
+00026c40: 6f74 5f6c 6967 6874 293a 0d0a 2020 2020  ot_light):..    
+00026c50: 2020 2020 676c 456e 6162 6c65 2847 4c5f      glEnable(GL_
+00026c60: 4445 5054 485f 5445 5354 290d 0a20 2020  DEPTH_TEST)..   
+00026c70: 2020 2020 2073 656c 662e 7375 7266 6163       self.surfac
+00026c80: 655f 6d6f 6465 6c5f 7368 6164 6572 2e62  e_model_shader.b
+00026c90: 696e 6428 290d 0a20 2020 2020 2020 2073  ind()..        s
+00026ca0: 656c 662e 7375 7266 6163 655f 6d6f 6465  elf.surface_mode
+00026cb0: 6c5f 7368 6164 6572 2e75 6e69 666f 726d  l_shader.uniform
+00026cc0: 6d61 7434 2822 7670 4d61 7422 2c20 6361  mat4("vpMat", ca
+00026cd0: 6d65 7261 2e6d 6174 7269 7829 0d0a 2020  mera.matrix)..  
+00026ce0: 2020 2020 2020 7365 6c66 2e73 7572 6661        self.surfa
+00026cf0: 6365 5f6d 6f64 656c 5f73 6861 6465 722e  ce_model_shader.
+00026d00: 756e 6966 6f72 6d33 6628 2276 6965 7744  uniform3f("viewD
+00026d10: 6972 222c 2063 616d 6572 612e 6765 745f  ir", camera.get_
+00026d20: 7669 6577 5f64 6972 6563 7469 6f6e 2829  view_direction()
+00026d30: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+00026d40: 7375 7266 6163 655f 6d6f 6465 6c5f 7368  surface_model_sh
+00026d50: 6164 6572 2e75 6e69 666f 726d 3366 2822  ader.uniform3f("
+00026d60: 6c69 6768 7444 6972 222c 2073 706f 745f  lightDir", spot_
+00026d70: 6c69 6768 742e 7665 6329 0d0a 2020 2020  light.vec)..    
+00026d80: 2020 2020 7365 6c66 2e73 7572 6661 6365      self.surface
+00026d90: 5f6d 6f64 656c 5f73 6861 6465 722e 756e  _model_shader.un
+00026da0: 6966 6f72 6d31 6628 2261 6d62 6965 6e74  iform1f("ambient
+00026db0: 5374 7265 6e67 7468 222c 2061 6d62 6965  Strength", ambie
+00026dc0: 6e74 5f73 7472 656e 6774 6829 0d0a 2020  nt_strength)..  
+00026dd0: 2020 2020 2020 7365 6c66 2e73 7572 6661        self.surfa
+00026de0: 6365 5f6d 6f64 656c 5f73 6861 6465 722e  ce_model_shader.
+00026df0: 756e 6966 6f72 6d31 6628 226c 6967 6874  uniform1f("light
+00026e00: 5374 7265 6e67 7468 222c 2073 706f 745f  Strength", spot_
+00026e10: 6c69 6768 742e 7374 7265 6e67 7468 290d  light.strength).
+00026e20: 0a20 2020 2020 2020 2073 656c 662e 7375  .        self.su
+00026e30: 7266 6163 655f 6d6f 6465 6c5f 7368 6164  rface_model_shad
+00026e40: 6572 2e75 6e69 666f 726d 3366 2822 6c69  er.uniform3f("li
+00026e50: 6768 7443 6f6c 6f75 7222 2c20 7370 6f74  ghtColour", spot
+00026e60: 5f6c 6967 6874 2e63 6f6c 6f75 7229 0d0a  _light.colour)..
+00026e70: 2020 2020 2020 2020 7365 6c66 2e73 7572          self.sur
+00026e80: 6661 6365 5f6d 6f64 656c 5f73 6861 6465  face_model_shade
+00026e90: 722e 756e 6966 6f72 6d31 6928 2273 7479  r.uniform1i("sty
+00026ea0: 6c65 222c 2053 6567 6d65 6e74 6174 696f  le", Segmentatio
+00026eb0: 6e45 6469 746f 722e 5345 4c45 4354 4544  nEditor.SELECTED
+00026ec0: 5f52 454e 4445 525f 5354 594c 4529 0d0a  _RENDER_STYLE)..
+00026ed0: 2020 2020 2020 2020 676c 456e 6162 6c65          glEnable
+00026ee0: 2847 4c5f 4445 5054 485f 5445 5354 290d  (GL_DEPTH_TEST).
+00026ef0: 0a20 2020 2020 2020 2061 6c70 6861 5f73  .        alpha_s
+00026f00: 6f72 7465 645f 7375 7266 6163 655f 6d6f  orted_surface_mo
+00026f10: 6465 6c73 203d 2073 6f72 7465 6428 7375  dels = sorted(su
+00026f20: 7266 6163 655f 6d6f 6465 6c73 2c20 6b65  rface_models, ke
+00026f30: 793d 6c61 6d62 6461 2078 3a20 782e 616c  y=lambda x: x.al
+00026f40: 7068 612c 2072 6576 6572 7365 3d54 7275  pha, reverse=Tru
+00026f50: 6529 0d0a 2020 2020 2020 2020 666f 7220  e)..        for 
+00026f60: 7320 696e 2061 6c70 6861 5f73 6f72 7465  s in alpha_sorte
+00026f70: 645f 7375 7266 6163 655f 6d6f 6465 6c73  d_surface_models
+00026f80: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
+00026f90: 6620 732e 6869 6465 3a0d 0a20 2020 2020  f s.hide:..     
+00026fa0: 2020 2020 2020 2020 2020 2063 6f6e 7469             conti
+00026fb0: 6e75 650d 0a20 2020 2020 2020 2020 2020  nue..           
+00026fc0: 2073 656c 662e 7375 7266 6163 655f 6d6f   self.surface_mo
+00026fd0: 6465 6c5f 7368 6164 6572 2e75 6e69 666f  del_shader.unifo
+00026fe0: 726d 3466 2822 636f 6c6f 7222 2c20 5b2a  rm4f("color", [*
+00026ff0: 732e 636f 6c6f 7572 2c20 732e 616c 7068  s.colour, s.alph
+00027000: 615d 290d 0a20 2020 2020 2020 2020 2020  a])..           
+00027010: 2066 6f72 2062 6c6f 6220 696e 2073 2e62   for blob in s.b
+00027020: 6c6f 6273 2e76 616c 7565 7328 293a 0d0a  lobs.values():..
+00027030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027040: 6966 2062 6c6f 622e 636f 6d70 6c65 7465  if blob.complete
+00027050: 2061 6e64 206e 6f74 2062 6c6f 622e 6869   and not blob.hi
+00027060: 6465 3a0d 0a20 2020 2020 2020 2020 2020  de:..           
+00027070: 2020 2020 2020 2020 2062 6c6f 622e 7661           blob.va
+00027080: 2e62 696e 6428 290d 0a20 2020 2020 2020  .bind()..       
+00027090: 2020 2020 2020 2020 2020 2020 2067 6c44               glD
+000270a0: 7261 7745 6c65 6d65 6e74 7328 474c 5f54  rawElements(GL_T
+000270b0: 5249 414e 474c 4553 2c20 626c 6f62 2e76  RIANGLES, blob.v
+000270c0: 612e 696e 6465 7842 7566 6665 722e 6765  a.indexBuffer.ge
+000270d0: 7443 6f75 6e74 2829 2c20 474c 5f55 4e53  tCount(), GL_UNS
+000270e0: 4947 4e45 445f 494e 542c 204e 6f6e 6529  IGNED_INT, None)
+000270f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00027100: 2020 2020 2020 626c 6f62 2e76 612e 756e        blob.va.un
+00027110: 6269 6e64 2829 0d0a 2020 2020 2020 2020  bind()..        
+00027120: 7365 6c66 2e73 7572 6661 6365 5f6d 6f64  self.surface_mod
+00027130: 656c 5f73 6861 6465 722e 756e 6269 6e64  el_shader.unbind
+00027140: 2829 0d0a 2020 2020 2020 2020 676c 4469  ()..        glDi
+00027150: 7361 626c 6528 474c 5f44 4550 5448 5f54  sable(GL_DEPTH_T
+00027160: 4553 5429 0d0a 0d0a 2020 2020 6465 6620  EST)....    def 
+00027170: 7265 6e64 6572 5f73 7572 6661 6365 5f6d  render_surface_m
+00027180: 6f64 656c 5f70 6172 7469 636c 6573 2873  odel_particles(s
+00027190: 656c 662c 2073 7572 6661 6365 5f6d 6f64  elf, surface_mod
+000271a0: 656c 732c 2063 616d 6572 6129 3a0d 0a20  els, camera):.. 
+000271b0: 2020 2020 2020 2069 6620 5365 676d 656e         if Segmen
+000271c0: 7461 7469 6f6e 4564 6974 6f72 2e52 454e  tationEditor.REN
+000271d0: 4445 525f 5041 5254 4943 4c45 535f 5852  DER_PARTICLES_XR
+000271e0: 4159 3a0d 0a20 2020 2020 2020 2020 2020  AY:..           
+000271f0: 2067 6c44 6973 6162 6c65 2847 4c5f 4445   glDisable(GL_DE
+00027200: 5054 485f 5445 5354 290d 0a20 2020 2020  PTH_TEST)..     
+00027210: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00027220: 2020 2020 2020 676c 456e 6162 6c65 2847        glEnable(G
+00027230: 4c5f 4445 5054 485f 5445 5354 290d 0a20  L_DEPTH_TEST).. 
+00027240: 2020 2020 2020 2061 6c70 6861 5f73 6f72         alpha_sor
+00027250: 7465 645f 7375 7266 6163 655f 6d6f 6465  ted_surface_mode
+00027260: 6c73 203d 2073 6f72 7465 6428 7375 7266  ls = sorted(surf
+00027270: 6163 655f 6d6f 6465 6c73 2c20 6b65 793d  ace_models, key=
+00027280: 6c61 6d62 6461 2078 3a20 782e 616c 7068  lambda x: x.alph
+00027290: 612c 2072 6576 6572 7365 3d54 7275 6529  a, reverse=True)
+000272a0: 0d0a 2020 2020 2020 2020 7365 6c66 2e70  ..        self.p
+000272b0: 6172 7469 636c 655f 7661 2e62 696e 6428  article_va.bind(
+000272c0: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+000272d0: 7061 7274 6963 6c65 5f73 6861 6465 722e  particle_shader.
+000272e0: 6269 6e64 2829 0d0a 2020 2020 2020 2020  bind()..        
+000272f0: 7365 6c66 2e70 6172 7469 636c 655f 7368  self.particle_sh
+00027300: 6164 6572 2e75 6e69 666f 726d 6d61 7434  ader.uniformmat4
+00027310: 2822 7670 4d61 7422 2c20 6361 6d65 7261  ("vpMat", camera
+00027320: 2e6d 6174 7269 7829 0d0a 2020 2020 2020  .matrix)..      
+00027330: 2020 666f 7220 7320 696e 2061 6c70 6861    for s in alpha
+00027340: 5f73 6f72 7465 645f 7375 7266 6163 655f  _sorted_surface_
+00027350: 6d6f 6465 6c73 3a0d 0a20 2020 2020 2020  models:..       
+00027360: 2020 2020 2069 6620 732e 6869 6465 3a0d       if s.hide:.
+00027370: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00027380: 2063 6f6e 7469 6e75 650d 0a20 2020 2020   continue..     
+00027390: 2020 2020 2020 2069 6620 732e 7061 7274         if s.part
+000273a0: 6963 6c65 5f73 697a 6520 3e20 302e 303a  icle_size > 0.0:
+000273b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000273c0: 2020 7365 6c66 2e70 6172 7469 636c 655f    self.particle_
+000273d0: 7368 6164 6572 2e75 6e69 666f 726d 3366  shader.uniform3f
+000273e0: 2822 7061 7274 6963 6c65 436f 6c6f 7572  ("particleColour
+000273f0: 222c 2073 2e70 6172 7469 636c 655f 636f  ", s.particle_co
+00027400: 6c6f 7572 290d 0a20 2020 2020 2020 2020  lour)..         
+00027410: 2020 2020 2020 2073 656c 662e 7061 7274         self.part
+00027420: 6963 6c65 5f73 6861 6465 722e 756e 6966  icle_shader.unif
+00027430: 6f72 6d31 6628 2270 6172 7469 636c 6553  orm1f("particleS
+00027440: 697a 6522 2c20 732e 7061 7274 6963 6c65  ize", s.particle
+00027450: 5f73 697a 6529 0d0a 2020 2020 2020 2020  _size)..        
+00027460: 2020 2020 2020 2020 7365 6c66 2e70 6172          self.par
+00027470: 7469 636c 655f 7368 6164 6572 2e75 6e69  ticle_shader.uni
+00027480: 666f 726d 3166 2822 7069 7865 6c53 697a  form1f("pixelSiz
+00027490: 6522 2c20 732e 7069 7865 6c5f 7369 7a65  e", s.pixel_size
+000274a0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+000274b0: 2020 2073 656c 662e 7061 7274 6963 6c65     self.particle
+000274c0: 5f73 6861 6465 722e 756e 6966 6f72 6d33  _shader.uniform3
+000274d0: 6628 226f 7269 6769 6e22 2c20 732e 6365  f("origin", s.ce
+000274e0: 6e74 6572 5f78 797a 202f 2032 2e30 290d  nter_xyz / 2.0).
+000274f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00027500: 2066 6f72 2070 2069 6e20 732e 7061 7274   for p in s.part
+00027510: 6963 6c65 733a 0d0a 2020 2020 2020 2020  icles:..        
+00027520: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00027530: 2e70 6172 7469 636c 655f 7368 6164 6572  .particle_shader
+00027540: 2e75 6e69 666f 726d 3366 2822 7061 7274  .uniform3f("part
+00027550: 6963 6c65 506f 7369 7469 6f6e 222c 2070  iclePosition", p
+00027560: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00027570: 2020 2020 2020 2067 6c44 7261 7745 6c65         glDrawEle
+00027580: 6d65 6e74 7328 474c 5f54 5249 414e 474c  ments(GL_TRIANGL
+00027590: 4553 2c20 7365 6c66 2e70 6172 7469 636c  ES, self.particl
+000275a0: 655f 7661 2e69 6e64 6578 4275 6666 6572  e_va.indexBuffer
+000275b0: 2e67 6574 436f 756e 7428 292c 2047 4c5f  .getCount(), GL_
+000275c0: 554e 5349 474e 4544 5f53 484f 5254 2c20  UNSIGNED_SHORT, 
+000275d0: 4e6f 6e65 290d 0a20 2020 2020 2020 2073  None)..        s
+000275e0: 656c 662e 7061 7274 6963 6c65 5f76 612e  elf.particle_va.
+000275f0: 756e 6269 6e64 2829 0d0a 2020 2020 2020  unbind()..      
+00027600: 2020 7365 6c66 2e70 6172 7469 636c 655f    self.particle_
+00027610: 7368 6164 6572 2e75 6e62 696e 6428 290d  shader.unbind().
+00027620: 0a20 2020 2020 2020 2067 6c44 6973 6162  .        glDisab
+00027630: 6c65 2847 4c5f 4445 5054 485f 5445 5354  le(GL_DEPTH_TEST
+00027640: 290d 0a0d 0a0d 0a0d 0a20 2020 2064 6566  )........    def
+00027650: 2072 656e 6465 725f 6c69 6e65 5f76 6128   render_line_va(
+00027660: 7365 6c66 2c20 7661 2c20 6361 6d65 7261  self, va, camera
+00027670: 293a 0d0a 2020 2020 2020 2020 676c 456e  ):..        glEn
+00027680: 6162 6c65 2847 4c5f 4445 5054 485f 5445  able(GL_DEPTH_TE
+00027690: 5354 290d 0a20 2020 2020 2020 2073 656c  ST)..        sel
+000276a0: 662e 6c69 6e65 5f33 645f 7368 6164 6572  f.line_3d_shader
+000276b0: 2e62 696e 6428 290d 0a20 2020 2020 2020  .bind()..       
+000276c0: 2073 656c 662e 6c69 6e65 5f33 645f 7368   self.line_3d_sh
+000276d0: 6164 6572 2e75 6e69 666f 726d 6d61 7434  ader.uniformmat4
+000276e0: 2822 6361 6d65 7261 4d61 7472 6978 222c  ("cameraMatrix",
+000276f0: 2063 616d 6572 612e 6d61 7472 6978 290d   camera.matrix).
+00027700: 0a20 2020 2020 2020 2076 612e 6269 6e64  .        va.bind
+00027710: 2829 0d0a 2020 2020 2020 2020 676c 4472  ()..        glDr
+00027720: 6177 456c 656d 656e 7473 2847 4c5f 4c49  awElements(GL_LI
+00027730: 4e45 532c 2076 612e 696e 6465 7842 7566  NES, va.indexBuf
+00027740: 6665 722e 6765 7443 6f75 6e74 2829 2c20  fer.getCount(), 
+00027750: 474c 5f55 4e53 4947 4e45 445f 5348 4f52  GL_UNSIGNED_SHOR
+00027760: 542c 204e 6f6e 6529 0d0a 2020 2020 2020  T, None)..      
+00027770: 2020 7661 2e75 6e62 696e 6428 290d 0a20    va.unbind().. 
+00027780: 2020 2020 2020 2073 656c 662e 6c69 6e65         self.line
+00027790: 5f33 645f 7368 6164 6572 2e75 6e62 696e  _3d_shader.unbin
+000277a0: 6428 290d 0a20 2020 2020 2020 2067 6c44  d()..        glD
+000277b0: 6973 6162 6c65 2847 4c5f 4445 5054 485f  isable(GL_DEPTH_
+000277c0: 5445 5354 290d 0a0d 0a20 2020 2064 6566  TEST)....    def
+000277d0: 2072 6179 5f74 7261 6365 5f6f 7665 726c   ray_trace_overl
+000277e0: 6179 2873 656c 662c 2077 696e 646f 775f  ay(self, window_
+000277f0: 7369 7a65 2c20 7365 5f66 7261 6d65 2c20  size, se_frame, 
+00027800: 6361 6d65 7261 2c20 626f 785f 7661 293a  camera, box_va):
+00027810: 0d0a 2020 2020 2020 2020 6966 2073 655f  ..        if se_
+00027820: 6672 616d 652e 6f76 6572 6c61 7920 6973  frame.overlay is
+00027830: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
+00027840: 2020 2020 7265 7475 726e 0d0a 0d0a 2020      return....  
+00027850: 2020 2020 2020 2320 3120 2d20 5265 6e64        # 1 - Rend
+00027860: 6572 696e 6720 6120 6465 7074 6820 6d61  ering a depth ma
+00027870: 736b 2074 6f20 6669 6e64 2077 6865 7265  sk to find where
+00027880: 2074 6f20 5354 4152 5420 7361 6d70 6c69   to START sampli
+00027890: 6e67 2072 6179 732e 0d0a 2020 2020 2020  ng rays...      
+000278a0: 2020 6966 2073 656c 662e 7261 795f 7472    if self.ray_tr
+000278b0: 6163 655f 6662 6f5f 7369 7a65 2021 3d20  ace_fbo_size != 
+000278c0: 7769 6e64 6f77 5f73 697a 653a 0d0a 2020  window_size:..  
+000278d0: 2020 2020 2020 2020 2020 7365 6c66 2e72            self.r
+000278e0: 6179 5f74 7261 6365 5f66 626f 5f73 697a  ay_trace_fbo_siz
+000278f0: 6520 3d20 7769 6e64 6f77 5f73 697a 650d  e = window_size.
+00027900: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00027910: 662e 7261 795f 7472 6163 655f 6662 6f5f  f.ray_trace_fbo_
+00027920: 6120 3d20 4672 616d 6542 7566 6665 7228  a = FrameBuffer(
+00027930: 7769 6e64 6f77 5f73 697a 655b 305d 2c20  window_size[0], 
+00027940: 7769 6e64 6f77 5f73 697a 655b 315d 2c20  window_size[1], 
+00027950: 2272 6762 6133 3266 2229 0d0a 2020 2020  "rgba32f")..    
+00027960: 2020 2020 2020 2020 7365 6c66 2e72 6179          self.ray
+00027970: 5f74 7261 6365 5f66 626f 5f62 203d 2046  _trace_fbo_b = F
+00027980: 7261 6d65 4275 6666 6572 2877 696e 646f  rameBuffer(windo
+00027990: 775f 7369 7a65 5b30 5d2c 2077 696e 646f  w_size[0], windo
+000279a0: 775f 7369 7a65 5b31 5d2c 2022 7267 6261  w_size[1], "rgba
+000279b0: 3332 6622 290d 0a0d 0a20 2020 2020 2020  32f")....       
+000279c0: 2073 656c 662e 7261 795f 7472 6163 655f   self.ray_trace_
+000279d0: 6662 6f5f 612e 6269 6e64 2829 0d0a 2020  fbo_a.bind()..  
+000279e0: 2020 2020 2020 676c 436c 6561 7244 6570        glClearDep
+000279f0: 7468 2831 2e30 290d 0a20 2020 2020 2020  th(1.0)..       
+00027a00: 2067 6c45 6e61 626c 6528 474c 5f44 4550   glEnable(GL_DEP
+00027a10: 5448 5f54 4553 5429 0d0a 2020 2020 2020  TH_TEST)..      
+00027a20: 2020 676c 4465 7074 6846 756e 6328 474c    glDepthFunc(GL
+00027a30: 5f4c 4553 5329 0d0a 2020 2020 2020 2020  _LESS)..        
+00027a40: 676c 4465 7074 684d 6173 6b28 474c 5f54  glDepthMask(GL_T
+00027a50: 5255 4529 0d0a 2020 2020 2020 2020 676c  RUE)..        gl
+00027a60: 436c 6561 7228 474c 5f44 4550 5448 5f42  Clear(GL_DEPTH_B
+00027a70: 5546 4645 525f 4249 5429 0d0a 0d0a 2020  UFFER_BIT)....  
+00027a80: 2020 2020 2020 7365 6c66 2e64 6570 7468        self.depth
+00027a90: 5f6d 6173 6b5f 7368 6164 6572 2e62 696e  _mask_shader.bin
+00027aa0: 6428 290d 0a20 2020 2020 2020 2073 656c  d()..        sel
+00027ab0: 662e 6465 7074 685f 6d61 736b 5f73 6861  f.depth_mask_sha
+00027ac0: 6465 722e 756e 6966 6f72 6d6d 6174 3428  der.uniformmat4(
+00027ad0: 2276 704d 6174 222c 2063 616d 6572 612e  "vpMat", camera.
+00027ae0: 6d61 7472 6978 290d 0a20 2020 2020 2020  matrix)..       
+00027af0: 2073 656c 662e 6465 7074 685f 6d61 736b   self.depth_mask
+00027b00: 5f73 6861 6465 722e 756e 6966 6f72 6d31  _shader.uniform1
+00027b10: 6928 226f 7665 7272 6964 655f 7a22 2c20  i("override_z", 
+00027b20: 3029 0d0a 2020 2020 2020 2020 7365 6c66  0)..        self
+00027b30: 2e64 6570 7468 5f6d 6173 6b5f 7368 6164  .depth_mask_shad
+00027b40: 6572 2e75 6e69 666f 726d 3166 2822 6f76  er.uniform1f("ov
+00027b50: 6572 7269 6465 5f7a 5f76 616c 222c 2030  erride_z_val", 0
+00027b60: 2e30 290d 0a20 2020 2020 2020 2062 6f78  .0)..        box
+00027b70: 5f76 612e 6269 6e64 2829 2020 2320 626f  _va.bind()  # bo
+00027b80: 7820 6465 7074 6820 6d61 736b 0d0a 2020  x depth mask..  
+00027b90: 2020 2020 2020 676c 4472 6177 456c 656d        glDrawElem
+00027ba0: 656e 7473 2847 4c5f 5452 4941 4e47 4c45  ents(GL_TRIANGLE
+00027bb0: 532c 2062 6f78 5f76 612e 696e 6465 7842  S, box_va.indexB
+00027bc0: 7566 6665 722e 6765 7443 6f75 6e74 2829  uffer.getCount()
+00027bd0: 2c20 474c 5f55 4e53 4947 4e45 445f 5348  , GL_UNSIGNED_SH
+00027be0: 4f52 542c 204e 6f6e 6529 0d0a 2020 2020  ORT, None)..    
+00027bf0: 2020 2020 626f 785f 7661 2e75 6e62 696e      box_va.unbin
+00027c00: 6428 290d 0a20 2020 2020 2020 2073 656c  d()..        sel
+00027c10: 662e 6465 7074 685f 6d61 736b 5f73 6861  f.depth_mask_sha
+00027c20: 6465 722e 756e 6269 6e64 2829 0d0a 2020  der.unbind()..  
+00027c30: 2020 2020 2020 7365 6c66 2e72 6179 5f74        self.ray_t
+00027c40: 7261 6365 5f66 626f 5f61 2e75 6e62 696e  race_fbo_a.unbin
+00027c50: 6428 2830 2c20 302c 2077 696e 646f 775f  d((0, 0, window_
+00027c60: 7369 7a65 5b30 5d2c 2077 696e 646f 775f  size[0], window_
+00027c70: 7369 7a65 5b31 5d29 290d 0a0d 0a20 2020  size[1]))....   
+00027c80: 2020 2020 2023 202d 2052 656e 6465 7269       # - Renderi
+00027c90: 6e67 2061 2064 6570 7468 206d 6173 6b20  ng a depth mask 
+00027ca0: 746f 2066 696e 6420 7768 6572 6520 746f  to find where to
+00027cb0: 2053 544f 5020 7361 6d70 6c69 6e67 2072   STOP sampling r
+00027cc0: 6179 730d 0a20 2020 2020 2020 2073 656c  ays..        sel
+00027cd0: 662e 7261 795f 7472 6163 655f 6662 6f5f  f.ray_trace_fbo_
+00027ce0: 622e 6269 6e64 2829 0d0a 2020 2020 2020  b.bind()..      
+00027cf0: 2020 676c 436c 6561 7244 6570 7468 2830    glClearDepth(0
+00027d00: 2e30 290d 0a20 2020 2020 2020 2067 6c45  .0)..        glE
+00027d10: 6e61 626c 6528 474c 5f44 4550 5448 5f54  nable(GL_DEPTH_T
+00027d20: 4553 5429 0d0a 2020 2020 2020 2020 676c  EST)..        gl
+00027d30: 4465 7074 6846 756e 6328 474c 5f47 5245  DepthFunc(GL_GRE
+00027d40: 4154 4552 290d 0a20 2020 2020 2020 2067  ATER)..        g
+00027d50: 6c44 6570 7468 4d61 736b 2847 4c5f 5452  lDepthMask(GL_TR
+00027d60: 5545 290d 0a20 2020 2020 2020 2067 6c43  UE)..        glC
+00027d70: 6c65 6172 2847 4c5f 4445 5054 485f 4255  lear(GL_DEPTH_BU
+00027d80: 4646 4552 5f42 4954 290d 0a0d 0a20 2020  FFER_BIT)....   
+00027d90: 2020 2020 2073 656c 662e 6465 7074 685f       self.depth_
+00027da0: 6d61 736b 5f73 6861 6465 722e 6269 6e64  mask_shader.bind
+00027db0: 2829 0d0a 2020 2020 2020 2020 7365 6c66  ()..        self
+00027dc0: 2e64 6570 7468 5f6d 6173 6b5f 7368 6164  .depth_mask_shad
+00027dd0: 6572 2e75 6e69 666f 726d 6d61 7434 2822  er.uniformmat4("
+00027de0: 7670 4d61 7422 2c20 6361 6d65 7261 2e6d  vpMat", camera.m
+00027df0: 6174 7269 7829 0d0a 2020 2020 2020 2020  atrix)..        
+00027e00: 7365 6c66 2e64 6570 7468 5f6d 6173 6b5f  self.depth_mask_
+00027e10: 7368 6164 6572 2e75 6e69 666f 726d 3169  shader.uniform1i
+00027e20: 2822 6f76 6572 7269 6465 5f7a 222c 2030  ("override_z", 0
+00027e30: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+00027e40: 6465 7074 685f 6d61 736b 5f73 6861 6465  depth_mask_shade
+00027e50: 722e 756e 6966 6f72 6d31 6628 226f 7665  r.uniform1f("ove
+00027e60: 7272 6964 655f 7a5f 7661 6c22 2c20 302e  rride_z_val", 0.
+00027e70: 3029 0d0a 2020 2020 2020 2020 626f 785f  0)..        box_
+00027e80: 7661 2e62 696e 6428 290d 0a20 2020 2020  va.bind()..     
+00027e90: 2020 2067 6c44 7261 7745 6c65 6d65 6e74     glDrawElement
+00027ea0: 7328 474c 5f54 5249 414e 474c 4553 2c20  s(GL_TRIANGLES, 
+00027eb0: 626f 785f 7661 2e69 6e64 6578 4275 6666  box_va.indexBuff
+00027ec0: 6572 2e67 6574 436f 756e 7428 292c 2047  er.getCount(), G
+00027ed0: 4c5f 554e 5349 474e 4544 5f53 484f 5254  L_UNSIGNED_SHORT
+00027ee0: 2c20 4e6f 6e65 290d 0a20 2020 2020 2020  , None)..       
+00027ef0: 2062 6f78 5f76 612e 756e 6269 6e64 2829   box_va.unbind()
+00027f00: 0d0a 2020 2020 2020 2020 6966 2053 6567  ..        if Seg
+00027f10: 6d65 6e74 6174 696f 6e45 6469 746f 722e  mentationEditor.
+00027f20: 5049 434b 494e 475f 4652 414d 455f 414c  PICKING_FRAME_AL
+00027f30: 5048 4120 213d 2030 2e30 3a20 2023 2066  PHA != 0.0:  # f
+00027f40: 7261 6d65 2075 7365 6420 696e 2074 6865  rame used in the
+00027f50: 2064 6570 7468 206d 6173 6b20 6173 2077   depth mask as w
+00027f60: 656c 6c0d 0a20 2020 2020 2020 2020 2020  ell..           
+00027f70: 2067 6c44 6570 7468 4675 6e63 2847 4c5f   glDepthFunc(GL_
+00027f80: 4c45 5353 290d 0a20 2020 2020 2020 2020  LESS)..         
+00027f90: 2020 2073 656c 662e 6465 7074 685f 6d61     self.depth_ma
+00027fa0: 736b 5f73 6861 6465 722e 756e 6966 6f72  sk_shader.unifor
+00027fb0: 6d31 6928 226f 7665 7272 6964 655f 7a22  m1i("override_z"
+00027fc0: 2c20 3129 0d0a 2020 2020 2020 2020 2020  , 1)..          
+00027fd0: 2020 7365 6c66 2e64 6570 7468 5f6d 6173    self.depth_mas
+00027fe0: 6b5f 7368 6164 6572 2e75 6e69 666f 726d  k_shader.uniform
+00027ff0: 3166 2822 6f76 6572 7269 6465 5f7a 5f76  1f("override_z_v
+00028000: 616c 222c 2028 7365 5f66 7261 6d65 2e63  al", (se_frame.c
+00028010: 7572 7265 6e74 5f73 6c69 6365 202d 2073  urrent_slice - s
+00028020: 655f 6672 616d 652e 6e5f 736c 6963 6573  e_frame.n_slices
+00028030: 202f 2032 2920 2a20 7365 5f66 7261 6d65   / 2) * se_frame
+00028040: 2e70 6978 656c 5f73 697a 6529 0d0a 2020  .pixel_size)..  
+00028050: 2020 2020 2020 2020 2020 7365 6c66 2e64            self.d
+00028060: 6570 7468 5f6d 6173 6b5f 7368 6164 6572  epth_mask_shader
+00028070: 2e75 6e69 666f 726d 3166 2822 7069 7865  .uniform1f("pixe
+00028080: 6c5f 7369 7a65 222c 2073 655f 6672 616d  l_size", se_fram
+00028090: 652e 7069 7865 6c5f 7369 7a65 290d 0a20  e.pixel_size).. 
+000280a0: 2020 2020 2020 2020 2020 2073 655f 6672             se_fr
+000280b0: 616d 652e 7175 6164 5f76 612e 6269 6e64  ame.quad_va.bind
+000280c0: 2829 2020 2320 6672 616d 6520 6465 7074  ()  # frame dept
+000280d0: 6820 6d61 736b 2061 7320 7765 6c6c 2e0d  h mask as well..
+000280e0: 0a20 2020 2020 2020 2020 2020 2067 6c44  .            glD
+000280f0: 7261 7745 6c65 6d65 6e74 7328 474c 5f54  rawElements(GL_T
+00028100: 5249 414e 474c 4553 2c20 7365 5f66 7261  RIANGLES, se_fra
+00028110: 6d65 2e71 7561 645f 7661 2e69 6e64 6578  me.quad_va.index
+00028120: 4275 6666 6572 2e67 6574 436f 756e 7428  Buffer.getCount(
+00028130: 292c 2047 4c5f 554e 5349 474e 4544 5f53  ), GL_UNSIGNED_S
+00028140: 484f 5254 2c20 4e6f 6e65 290d 0a20 2020  HORT, None)..   
+00028150: 2020 2020 2020 2020 2073 655f 6672 616d           se_fram
+00028160: 652e 7175 6164 5f76 612e 756e 6269 6e64  e.quad_va.unbind
+00028170: 2829 0d0a 2020 2020 2020 2020 7365 6c66  ()..        self
+00028180: 2e64 6570 7468 5f6d 6173 6b5f 7368 6164  .depth_mask_shad
+00028190: 6572 2e75 6e62 696e 6428 290d 0a20 2020  er.unbind()..   
+000281a0: 2020 2020 2073 656c 662e 7261 795f 7472       self.ray_tr
+000281b0: 6163 655f 6662 6f5f 622e 756e 6269 6e64  ace_fbo_b.unbind
+000281c0: 2828 302c 2030 2c20 7769 6e64 6f77 5f73  ((0, 0, window_s
+000281d0: 697a 655b 305d 2c20 7769 6e64 6f77 5f73  ize[0], window_s
+000281e0: 697a 655b 315d 2929 0d0a 0d0a 2020 2020  ize[1]))....    
+000281f0: 2020 2020 676c 4465 7074 6846 756e 6328      glDepthFunc(
+00028200: 474c 5f4c 4553 5329 0d0a 2020 2020 2020  GL_LESS)..      
+00028210: 2020 676c 436c 6561 7244 6570 7468 2831    glClearDepth(1
+00028220: 2e30 290d 0a20 2020 2020 2020 2023 2032  .0)..        # 2
+00028230: 202d 2072 6179 2074 7261 6369 6e67 0d0a   - ray tracing..
+00028240: 2020 2020 2020 2020 7365 6c66 2e72 6179          self.ray
+00028250: 5f74 7261 6365 5f73 6861 6465 722e 6269  _trace_shader.bi
+00028260: 6e64 2829 0d0a 2020 2020 2020 2020 7365  nd()..        se
+00028270: 6c66 2e72 6179 5f74 7261 6365 5f73 6861  lf.ray_trace_sha
+00028280: 6465 722e 756e 6966 6f72 6d6d 6174 3428  der.uniformmat4(
+00028290: 2269 704d 6174 222c 2063 616d 6572 612e  "ipMat", camera.
+000282a0: 6970 6d61 7429 0d0a 2020 2020 2020 2020  ipmat)..        
+000282b0: 7365 6c66 2e72 6179 5f74 7261 6365 5f73  self.ray_trace_s
+000282c0: 6861 6465 722e 756e 6966 6f72 6d6d 6174  hader.uniformmat
+000282d0: 3428 2269 764d 6174 222c 2063 616d 6572  4("ivMat", camer
+000282e0: 612e 6976 6d61 7429 0d0a 2020 2020 2020  a.ivmat)..      
+000282f0: 2020 7365 6c66 2e72 6179 5f74 7261 6365    self.ray_trace
+00028300: 5f73 6861 6465 722e 756e 6966 6f72 6d6d  _shader.uniformm
+00028310: 6174 3428 2270 4d61 7422 2c20 6361 6d65  at4("pMat", came
+00028320: 7261 2e70 6d61 7429 0d0a 2020 2020 2020  ra.pmat)..      
+00028330: 2020 7365 6c66 2e72 6179 5f74 7261 6365    self.ray_trace
+00028340: 5f73 6861 6465 722e 756e 6966 6f72 6d31  _shader.uniform1
+00028350: 6628 226e 6561 7222 2c20 6361 6d65 7261  f("near", camera
+00028360: 2e63 6c69 705f 6e65 6172 290d 0a20 2020  .clip_near)..   
+00028370: 2020 2020 2073 656c 662e 7261 795f 7472       self.ray_tr
+00028380: 6163 655f 7368 6164 6572 2e75 6e69 666f  ace_shader.unifo
+00028390: 726d 3166 2822 6661 7222 2c20 6361 6d65  rm1f("far", came
+000283a0: 7261 2e63 6c69 705f 6661 7229 0d0a 2020  ra.clip_far)..  
+000283b0: 2020 2020 2020 7365 6c66 2e72 6179 5f74        self.ray_t
+000283c0: 7261 6365 5f73 6861 6465 722e 756e 6966  race_shader.unif
+000283d0: 6f72 6d32 6628 2276 6965 7770 6f72 7453  orm2f("viewportS
+000283e0: 697a 6522 2c20 7769 6e64 6f77 5f73 697a  ize", window_siz
+000283f0: 6529 0d0a 2020 2020 2020 2020 7365 6c66  e)..        self
+00028400: 2e72 6179 5f74 7261 6365 5f73 6861 6465  .ray_trace_shade
+00028410: 722e 756e 6966 6f72 6d31 6628 227a 4c69  r.uniform1f("zLi
+00028420: 6d22 2c20 7365 5f66 7261 6d65 2e6e 5f73  m", se_frame.n_s
+00028430: 6c69 6365 7320 2a20 7365 5f66 7261 6d65  lices * se_frame
+00028440: 2e70 6978 656c 5f73 697a 6520 2f20 322e  .pixel_size / 2.
+00028450: 3029 0d0a 2020 2020 2020 2020 7365 6c66  0)..        self
+00028460: 2e72 6179 5f74 7261 6365 5f73 6861 6465  .ray_trace_shade
+00028470: 722e 756e 6966 6f72 6d31 6628 2270 6978  r.uniform1f("pix
+00028480: 656c 5369 7a65 222c 2073 655f 6672 616d  elSize", se_fram
+00028490: 652e 7069 7865 6c5f 7369 7a65 290d 0a20  e.pixel_size).. 
+000284a0: 2020 2020 2020 2073 656c 662e 7261 795f         self.ray_
+000284b0: 7472 6163 655f 7368 6164 6572 2e75 6e69  trace_shader.uni
+000284c0: 666f 726d 3266 2822 696d 6753 697a 6522  form2f("imgSize"
+000284d0: 2c20 5b73 655f 6672 616d 652e 6f76 6572  , [se_frame.over
+000284e0: 6c61 792e 7369 7a65 5b31 5d2c 2073 655f  lay.size[1], se_
+000284f0: 6672 616d 652e 6f76 6572 6c61 792e 7369  frame.overlay.si
+00028500: 7a65 5b30 5d5d 290d 0a20 2020 2020 2020  ze[0]])..       
+00028510: 2073 656c 662e 7261 795f 7472 6163 655f   self.ray_trace_
+00028520: 7368 6164 6572 2e75 6e69 666f 726d 3169  shader.uniform1i
+00028530: 2822 7374 796c 6522 2c20 5365 676d 656e  ("style", Segmen
+00028540: 7461 7469 6f6e 4564 6974 6f72 2e42 4c45  tationEditor.BLE
+00028550: 4e44 5f4d 4f44 4553 5f33 445b 5365 676d  ND_MODES_3D[Segm
+00028560: 656e 7461 7469 6f6e 4564 6974 6f72 2e42  entationEditor.B
+00028570: 4c45 4e44 5f4d 4f44 4553 5f4c 4953 545f  LEND_MODES_LIST_
+00028580: 3344 5b53 6567 6d65 6e74 6174 696f 6e45  3D[SegmentationE
+00028590: 6469 746f 722e 4f56 4552 4c41 595f 424c  ditor.OVERLAY_BL
+000285a0: 454e 445f 4d4f 4445 5f33 445d 5d5b 335d  END_MODE_3D]][3]
+000285b0: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+000285c0: 7261 795f 7472 6163 655f 7368 6164 6572  ray_trace_shader
+000285d0: 2e75 6e69 666f 726d 3166 2822 696e 7465  .uniform1f("inte
+000285e0: 6e73 6974 7922 2c20 5365 676d 656e 7461  nsity", Segmenta
+000285f0: 7469 6f6e 4564 6974 6f72 2e4f 5645 524c  tionEditor.OVERL
+00028600: 4159 5f49 4e54 454e 5349 5459 290d 0a20  AY_INTENSITY).. 
+00028610: 2020 2020 2020 2073 655f 6672 616d 652e         se_frame.
+00028620: 6f76 6572 6c61 792e 7465 7874 7572 652e  overlay.texture.
+00028630: 6269 6e64 2830 2920 2023 206f 7665 726c  bind(0)  # overl
+00028640: 6179 2069 6d61 6765 2c20 746f 2072 6561  ay image, to rea
+00028650: 6420 6672 6f6d 0d0a 2020 2020 2020 2020  d from..        
+00028660: 676c 4163 7469 7665 5465 7874 7572 6528  glActiveTexture(
+00028670: 474c 5f54 4558 5455 5245 3020 2b20 3129  GL_TEXTURE0 + 1)
+00028680: 2020 2320 6465 7074 6820 6275 6666 6572    # depth buffer
+00028690: 2c20 746f 2072 6561 6420 6672 6f6d 0d0a  , to read from..
+000286a0: 2020 2020 2020 2020 676c 4269 6e64 5465          glBindTe
+000286b0: 7874 7572 6528 474c 5f54 4558 5455 5245  xture(GL_TEXTURE
+000286c0: 5f32 442c 2073 656c 662e 7261 795f 7472  _2D, self.ray_tr
+000286d0: 6163 655f 6662 6f5f 612e 6465 7074 685f  ace_fbo_a.depth_
+000286e0: 7465 7874 7572 655f 7265 6e64 6572 6572  texture_renderer
+000286f0: 5f69 6429 0d0a 2020 2020 2020 2020 676c  _id)..        gl
+00028700: 4163 7469 7665 5465 7874 7572 6528 474c  ActiveTexture(GL
+00028710: 5f54 4558 5455 5245 3020 2b20 3229 0d0a  _TEXTURE0 + 2)..
+00028720: 2020 2020 2020 2020 676c 4269 6e64 5465          glBindTe
+00028730: 7874 7572 6528 474c 5f54 4558 5455 5245  xture(GL_TEXTURE
+00028740: 5f32 442c 2073 656c 662e 7261 795f 7472  _2D, self.ray_tr
+00028750: 6163 655f 6662 6f5f 622e 6465 7074 685f  ace_fbo_b.depth_
+00028760: 7465 7874 7572 655f 7265 6e64 6572 6572  texture_renderer
+00028770: 5f69 6429 0d0a 2020 2020 2020 2020 7365  _id)..        se
+00028780: 6c66 2e72 6179 5f74 7261 6365 5f66 626f  lf.ray_trace_fbo
+00028790: 5f61 2e74 6578 7475 7265 2e62 696e 645f  _a.texture.bind_
+000287a0: 696d 6167 655f 736c 6f74 2833 2c20 3129  image_slot(3, 1)
+000287b0: 2020 2320 6662 6f20 7465 7874 7572 652c    # fbo texture,
+000287c0: 2074 6f20 7772 6974 6520 746f 0d0a 2020   to write to..  
+000287d0: 2020 2020 2020 676c 4469 7370 6174 6368        glDispatch
+000287e0: 436f 6d70 7574 6528 696e 7428 7769 6e64  Compute(int(wind
+000287f0: 6f77 5f73 697a 655b 305d 202f 2f20 3136  ow_size[0] // 16
+00028800: 2920 2b20 312c 2069 6e74 2877 696e 646f  ) + 1, int(windo
+00028810: 775f 7369 7a65 5b31 5d20 2f2f 2031 3629  w_size[1] // 16)
+00028820: 202b 2031 2c20 3129 0d0a 2020 2020 2020   + 1, 1)..      
+00028830: 2020 676c 4d65 6d6f 7279 4261 7272 6965    glMemoryBarrie
+00028840: 7228 474c 5f53 4841 4445 525f 494d 4147  r(GL_SHADER_IMAG
+00028850: 455f 4143 4345 5353 5f42 4152 5249 4552  E_ACCESS_BARRIER
+00028860: 5f42 4954 290d 0a20 2020 2020 2020 2053  _BIT)..        S
+00028870: 6567 6d65 6e74 6174 696f 6e45 6469 746f  egmentationEdito
+00028880: 722e 5649 4557 5f52 4551 5549 5245 535f  r.VIEW_REQUIRES_
+00028890: 5550 4441 5445 203d 2046 616c 7365 0d0a  UPDATE = False..
+000288a0: 0d0a 2020 2020 6465 6620 7265 6e64 6572  ..    def render
+000288b0: 5f6f 7665 726c 6179 5f33 6428 7365 6c66  _overlay_3d(self
+000288c0: 2c20 616c 7068 612c 2069 6e74 656e 7369  , alpha, intensi
+000288d0: 7479 293a 0d0a 2020 2020 2020 2020 2320  ty):..        # 
+000288e0: 6164 6420 6f76 6572 6c61 7920 696d 6167  add overlay imag
+000288f0: 6520 746f 2077 6861 7465 7665 7220 6861  e to whatever ha
+00028900: 7320 6265 656e 2072 656e 6465 7265 6420  s been rendered 
+00028910: 6265 666f 7265 2e0d 0a20 2020 2020 2020  before...       
+00028920: 2062 6c65 6e64 5f6d 6f64 6520 3d20 5365   blend_mode = Se
+00028930: 676d 656e 7461 7469 6f6e 4564 6974 6f72  gmentationEditor
+00028940: 2e42 4c45 4e44 5f4d 4f44 4553 5f33 445b  .BLEND_MODES_3D[
+00028950: 5365 676d 656e 7461 7469 6f6e 4564 6974  SegmentationEdit
+00028960: 6f72 2e42 4c45 4e44 5f4d 4f44 4553 5f4c  or.BLEND_MODES_L
+00028970: 4953 545f 3344 5b53 6567 6d65 6e74 6174  IST_3D[Segmentat
+00028980: 696f 6e45 6469 746f 722e 4f56 4552 4c41  ionEditor.OVERLA
+00028990: 595f 424c 454e 445f 4d4f 4445 5f33 445d  Y_BLEND_MODE_3D]
+000289a0: 5d0d 0a20 2020 2020 2020 2067 6c42 6c65  ]..        glBle
+000289b0: 6e64 4675 6e63 2862 6c65 6e64 5f6d 6f64  ndFunc(blend_mod
+000289c0: 655b 305d 2c20 626c 656e 645f 6d6f 6465  e[0], blend_mode
+000289d0: 5b31 5d29 0d0a 2020 2020 2020 2020 676c  [1])..        gl
+000289e0: 426c 656e 6445 7175 6174 696f 6e28 626c  BlendEquation(bl
+000289f0: 656e 645f 6d6f 6465 5b32 5d29 0d0a 2020  end_mode[2])..  
+00028a00: 2020 2020 2020 676c 4469 7361 626c 6528        glDisable(
+00028a10: 474c 5f44 4550 5448 5f54 4553 5429 0d0a  GL_DEPTH_TEST)..
+00028a20: 2020 2020 2020 2020 7365 6c66 2e6f 7665          self.ove
+00028a30: 726c 6179 5f62 6c65 6e64 5f73 6861 6465  rlay_blend_shade
+00028a40: 722e 6269 6e64 2829 0d0a 2020 2020 2020  r.bind()..      
+00028a50: 2020 7365 6c66 2e6f 7665 726c 6179 5f62    self.overlay_b
+00028a60: 6c65 6e64 5f73 6861 6465 722e 756e 6966  lend_shader.unif
+00028a70: 6f72 6d31 6628 2261 6c70 6861 222c 2061  orm1f("alpha", a
+00028a80: 6c70 6861 290d 0a20 2020 2020 2020 2073  lpha)..        s
+00028a90: 656c 662e 6f76 6572 6c61 795f 626c 656e  elf.overlay_blen
+00028aa0: 645f 7368 6164 6572 2e75 6e69 666f 726d  d_shader.uniform
+00028ab0: 3166 2822 696e 7465 6e73 6974 7922 2c20  1f("intensity", 
+00028ac0: 696e 7465 6e73 6974 7929 0d0a 2020 2020  intensity)..    
+00028ad0: 2020 2020 7365 6c66 2e72 6179 5f74 7261      self.ray_tra
+00028ae0: 6365 5f66 626f 5f61 2e74 6578 7475 7265  ce_fbo_a.texture
+00028af0: 2e62 696e 6428 3029 0d0a 2020 2020 2020  .bind(0)..      
+00028b00: 2020 7365 6c66 2e6e 6463 5f73 6372 6565    self.ndc_scree
+00028b10: 6e5f 7661 2e62 696e 6428 290d 0a20 2020  n_va.bind()..   
+00028b20: 2020 2020 2067 6c44 7261 7745 6c65 6d65       glDrawEleme
+00028b30: 6e74 7328 474c 5f54 5249 414e 474c 4553  nts(GL_TRIANGLES
+00028b40: 2c20 7365 6c66 2e6e 6463 5f73 6372 6565  , self.ndc_scree
+00028b50: 6e5f 7661 2e69 6e64 6578 4275 6666 6572  n_va.indexBuffer
+00028b60: 2e67 6574 436f 756e 7428 292c 2047 4c5f  .getCount(), GL_
+00028b70: 554e 5349 474e 4544 5f53 484f 5254 2c20  UNSIGNED_SHORT, 
+00028b80: 4e6f 6e65 290d 0a20 2020 2020 2020 2073  None)..        s
+00028b90: 656c 662e 6e64 635f 7363 7265 656e 5f76  elf.ndc_screen_v
+00028ba0: 612e 756e 6269 6e64 2829 0d0a 2020 2020  a.unbind()..    
+00028bb0: 2020 2020 7365 6c66 2e6f 7665 726c 6179      self.overlay
+00028bc0: 5f62 6c65 6e64 5f73 6861 6465 722e 756e  _blend_shader.un
+00028bd0: 6269 6e64 2829 0d0a 2020 2020 2020 2020  bind()..        
+00028be0: 676c 426c 656e 6446 756e 6328 474c 5f53  glBlendFunc(GL_S
+00028bf0: 5243 5f41 4c50 4841 2c20 474c 5f4f 4e45  RC_ALPHA, GL_ONE
+00028c00: 5f4d 494e 5553 5f53 5243 5f41 4c50 4841  _MINUS_SRC_ALPHA
+00028c10: 290d 0a20 2020 2020 2020 2067 6c42 6c65  )..        glBle
+00028c20: 6e64 4571 7561 7469 6f6e 2847 4c5f 4655  ndEquation(GL_FU
+00028c30: 4e43 5f41 4444 290d 0a0d 0a20 2020 2064  NC_ADD)....    d
+00028c40: 6566 2061 6464 5f6c 696e 6528 7365 6c66  ef add_line(self
+00028c50: 2c20 7374 6172 745f 7879 2c20 7374 6f70  , start_xy, stop
+00028c60: 5f78 792c 2063 6f6c 6f75 722c 2073 7562  _xy, colour, sub
+00028c70: 7472 6163 743d 4661 6c73 6529 3a0d 0a20  tract=False):.. 
+00028c80: 2020 2020 2020 2069 6620 7375 6274 7261         if subtra
+00028c90: 6374 3a0d 0a20 2020 2020 2020 2020 2020  ct:..           
+00028ca0: 2073 656c 662e 6c69 6e65 5f6c 6973 745f   self.line_list_
+00028cb0: 732e 6170 7065 6e64 2828 7374 6172 745f  s.append((start_
+00028cc0: 7879 2c20 7374 6f70 5f78 792c 2063 6f6c  xy, stop_xy, col
+00028cd0: 6f75 7229 290d 0a20 2020 2020 2020 2065  our))..        e
+00028ce0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+00028cf0: 2020 7365 6c66 2e6c 696e 655f 6c69 7374    self.line_list
+00028d00: 2e61 7070 656e 6428 2873 7461 7274 5f78  .append((start_x
+00028d10: 792c 2073 746f 705f 7879 2c20 636f 6c6f  y, stop_xy, colo
+00028d20: 7572 2929 0d0a 0d0a 2020 2020 6465 6620  ur))....    def 
+00028d30: 6164 645f 6369 7263 6c65 2873 656c 662c  add_circle(self,
+00028d40: 2063 656e 7465 725f 7879 2c20 7261 6469   center_xy, radi
+00028d50: 7573 2c20 636f 6c6f 7572 2c20 7365 676d  us, colour, segm
+00028d60: 656e 7473 3d33 322c 2073 7562 7472 6163  ents=32, subtrac
+00028d70: 743d 4661 6c73 6529 3a0d 0a20 2020 2020  t=False):..     
+00028d80: 2020 2074 6865 7461 203d 2030 0d0a 2020     theta = 0..  
+00028d90: 2020 2020 2020 7374 6172 745f 7879 203d        start_xy =
+00028da0: 2028 6365 6e74 6572 5f78 795b 305d 202b   (center_xy[0] +
+00028db0: 2072 6164 6975 7320 2a20 6e70 2e63 6f73   radius * np.cos
+00028dc0: 2874 6865 7461 292c 2063 656e 7465 725f  (theta), center_
+00028dd0: 7879 5b31 5d20 2b20 7261 6469 7573 202a  xy[1] + radius *
+00028de0: 206e 702e 7369 6e28 7468 6574 6129 290d   np.sin(theta)).
+00028df0: 0a20 2020 2020 2020 2066 6f72 2069 2069  .        for i i
+00028e00: 6e20 7261 6e67 6528 7365 676d 656e 7473  n range(segments
+00028e10: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+00028e20: 7468 6574 6120 3d20 2869 202a 2032 202a  theta = (i * 2 *
+00028e30: 206e 702e 7069 202f 2028 7365 676d 656e   np.pi / (segmen
+00028e40: 7473 202d 2031 2929 0d0a 2020 2020 2020  ts - 1))..      
+00028e50: 2020 2020 2020 7374 6f70 5f78 7920 3d20        stop_xy = 
+00028e60: 2863 656e 7465 725f 7879 5b30 5d20 2b20  (center_xy[0] + 
+00028e70: 7261 6469 7573 202a 206e 702e 636f 7328  radius * np.cos(
+00028e80: 7468 6574 6129 2c20 6365 6e74 6572 5f78  theta), center_x
+00028e90: 795b 315d 202b 2072 6164 6975 7320 2a20  y[1] + radius * 
+00028ea0: 6e70 2e73 696e 2874 6865 7461 2929 0d0a  np.sin(theta))..
+00028eb0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00028ec0: 7562 7472 6163 743a 0d0a 2020 2020 2020  ubtract:..      
+00028ed0: 2020 2020 2020 2020 2020 7365 6c66 2e6c            self.l
+00028ee0: 696e 655f 6c69 7374 5f73 2e61 7070 656e  ine_list_s.appen
+00028ef0: 6428 2873 7461 7274 5f78 792c 2073 746f  d((start_xy, sto
+00028f00: 705f 7879 2c20 636f 6c6f 7572 2929 0d0a  p_xy, colour))..
+00028f10: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00028f20: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00028f30: 2020 2073 656c 662e 6c69 6e65 5f6c 6973     self.line_lis
+00028f40: 742e 6170 7065 6e64 2828 7374 6172 745f  t.append((start_
+00028f50: 7879 2c20 7374 6f70 5f78 792c 2063 6f6c  xy, stop_xy, col
+00028f60: 6f75 7229 290d 0a20 2020 2020 2020 2020  our))..         
+00028f70: 2020 2073 7461 7274 5f78 7920 3d20 2863     start_xy = (c
+00028f80: 656e 7465 725f 7879 5b30 5d20 2b20 7261  enter_xy[0] + ra
+00028f90: 6469 7573 202a 206e 702e 636f 7328 7468  dius * np.cos(th
+00028fa0: 6574 6129 2c20 6365 6e74 6572 5f78 795b  eta), center_xy[
+00028fb0: 315d 202b 2072 6164 6975 7320 2a20 6e70  1] + radius * np
+00028fc0: 2e73 696e 2874 6865 7461 2929 0d0a 0d0a  .sin(theta))....
+00028fd0: 2020 2020 6465 6620 6164 645f 7371 7561      def add_squa
+00028fe0: 7265 2873 656c 662c 2063 656e 7465 725f  re(self, center_
+00028ff0: 7879 2c20 7369 7a65 2c20 636f 6c6f 7572  xy, size, colour
+00029000: 2c20 7375 6274 7261 6374 3d46 616c 7365  , subtract=False
+00029010: 293a 0d0a 2020 2020 2020 2020 626f 7474  ):..        bott
+00029020: 6f6d 203d 2063 656e 7465 725f 7879 5b31  om = center_xy[1
+00029030: 5d20 2d20 7369 7a65 202f 2032 0d0a 2020  ] - size / 2..  
+00029040: 2020 2020 2020 746f 7020 3d20 6365 6e74        top = cent
+00029050: 6572 5f78 795b 315d 202b 2073 697a 6520  er_xy[1] + size 
+00029060: 2f20 320d 0a20 2020 2020 2020 206c 6566  / 2..        lef
+00029070: 7420 3d20 6365 6e74 6572 5f78 795b 305d  t = center_xy[0]
+00029080: 202d 2073 697a 6520 2f20 320d 0a20 2020   - size / 2..   
+00029090: 2020 2020 2072 6967 6874 203d 2063 656e       right = cen
+000290a0: 7465 725f 7879 5b30 5d20 2b20 7369 7a65  ter_xy[0] + size
+000290b0: 202f 2032 0d0a 2020 2020 2020 2020 6966   / 2..        if
+000290c0: 2073 7562 7472 6163 743a 0d0a 2020 2020   subtract:..    
+000290d0: 2020 2020 2020 2020 7365 6c66 2e6c 696e          self.lin
+000290e0: 655f 6c69 7374 5f73 2e61 7070 656e 6428  e_list_s.append(
+000290f0: 2828 6c65 6674 2c20 626f 7474 6f6d 292c  ((left, bottom),
+00029100: 2028 7269 6768 742c 2062 6f74 746f 6d29   (right, bottom)
+00029110: 2c20 636f 6c6f 7572 2929 0d0a 2020 2020  , colour))..    
+00029120: 2020 2020 2020 2020 7365 6c66 2e6c 696e          self.lin
+00029130: 655f 6c69 7374 5f73 2e61 7070 656e 6428  e_list_s.append(
+00029140: 2828 6c65 6674 2c20 746f 7029 2c20 2872  ((left, top), (r
+00029150: 6967 6874 2c20 746f 7029 2c20 636f 6c6f  ight, top), colo
+00029160: 7572 2929 0d0a 2020 2020 2020 2020 2020  ur))..          
+00029170: 2020 7365 6c66 2e6c 696e 655f 6c69 7374    self.line_list
+00029180: 5f73 2e61 7070 656e 6428 2828 6c65 6674  _s.append(((left
+00029190: 2c20 626f 7474 6f6d 292c 2028 6c65 6674  , bottom), (left
+000291a0: 2c20 746f 7029 2c20 636f 6c6f 7572 2929  , top), colour))
+000291b0: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+000291c0: 6c66 2e6c 696e 655f 6c69 7374 5f73 2e61  lf.line_list_s.a
+000291d0: 7070 656e 6428 2828 7269 6768 742c 2062  ppend(((right, b
+000291e0: 6f74 746f 6d29 2c20 2872 6967 6874 2c20  ottom), (right, 
+000291f0: 746f 7029 2c20 636f 6c6f 7572 2929 0d0a  top), colour))..
+00029200: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+00029210: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00029220: 6c69 6e65 5f6c 6973 742e 6170 7065 6e64  line_list.append
+00029230: 2828 286c 6566 742c 2062 6f74 746f 6d29  (((left, bottom)
+00029240: 2c20 2872 6967 6874 2c20 626f 7474 6f6d  , (right, bottom
+00029250: 292c 2063 6f6c 6f75 7229 290d 0a20 2020  ), colour))..   
+00029260: 2020 2020 2020 2020 2073 656c 662e 6c69           self.li
+00029270: 6e65 5f6c 6973 742e 6170 7065 6e64 2828  ne_list.append((
+00029280: 286c 6566 742c 2074 6f70 292c 2028 7269  (left, top), (ri
+00029290: 6768 742c 2074 6f70 292c 2063 6f6c 6f75  ght, top), colou
+000292a0: 7229 290d 0a20 2020 2020 2020 2020 2020  r))..           
+000292b0: 2073 656c 662e 6c69 6e65 5f6c 6973 742e   self.line_list.
+000292c0: 6170 7065 6e64 2828 286c 6566 742c 2062  append(((left, b
+000292d0: 6f74 746f 6d29 2c20 286c 6566 742c 2074  ottom), (left, t
+000292e0: 6f70 292c 2063 6f6c 6f75 7229 290d 0a20  op), colour)).. 
+000292f0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00029300: 6c69 6e65 5f6c 6973 742e 6170 7065 6e64  line_list.append
+00029310: 2828 2872 6967 6874 2c20 626f 7474 6f6d  (((right, bottom
+00029320: 292c 2028 7269 6768 742c 2074 6f70 292c  ), (right, top),
+00029330: 2063 6f6c 6f75 7229 290d 0a0d 0a20 2020   colour))....   
+00029340: 2064 6566 2072 656e 6465 725f 6c69 6e65   def render_line
+00029350: 7328 7365 6c66 2c20 6361 6d65 7261 293a  s(self, camera):
+00029360: 0d0a 2020 2020 2020 2020 6465 6620 7265  ..        def re
+00029370: 6e64 6572 5f6c 696e 6573 5f69 6e5f 6c69  nder_lines_in_li
+00029380: 7374 286c 696e 655f 6c69 7374 293a 0d0a  st(line_list):..
+00029390: 2020 2020 2020 2020 2020 2020 2320 6d61              # ma
+000293a0: 6b65 2056 410d 0a20 2020 2020 2020 2020  ke VA..         
+000293b0: 2020 2076 6572 7469 6365 7320 3d20 6c69     vertices = li
+000293c0: 7374 2829 0d0a 2020 2020 2020 2020 2020  st()..          
+000293d0: 2020 696e 6469 6365 7320 3d20 6c69 7374    indices = list
+000293e0: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
+000293f0: 6920 3d20 300d 0a20 2020 2020 2020 2020  i = 0..         
+00029400: 2020 2066 6f72 206c 696e 6520 696e 206c     for line in l
+00029410: 696e 655f 6c69 7374 3a0d 0a20 2020 2020  ine_list:..     
+00029420: 2020 2020 2020 2020 2020 2076 6572 7469             verti
+00029430: 6365 7320 2b3d 205b 2a6c 696e 655b 305d  ces += [*line[0]
+00029440: 2c20 2a6c 696e 655b 325d 5b3a 335d 5d0d  , *line[2][:3]].
+00029450: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00029460: 2076 6572 7469 6365 7320 2b3d 205b 2a6c   vertices += [*l
+00029470: 696e 655b 315d 2c20 2a6c 696e 655b 325d  ine[1], *line[2]
+00029480: 5b3a 335d 5d0d 0a20 2020 2020 2020 2020  [:3]]..         
+00029490: 2020 2020 2020 2069 6e64 6963 6573 202b         indices +
+000294a0: 3d20 5b32 2a69 2c20 322a 692b 315d 0d0a  = [2*i, 2*i+1]..
+000294b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000294c0: 6920 2b3d 2031 0d0a 2020 2020 2020 2020  i += 1..        
+000294d0: 2020 2020 7365 6c66 2e6c 696e 655f 7661      self.line_va
+000294e0: 2e75 7064 6174 6528 5665 7274 6578 4275  .update(VertexBu
+000294f0: 6666 6572 2876 6572 7469 6365 7329 2c20  ffer(vertices), 
+00029500: 496e 6465 7842 7566 6665 7228 696e 6469  IndexBuffer(indi
+00029510: 6365 7329 290d 0a0d 0a20 2020 2020 2020  ces))....       
+00029520: 2020 2020 2023 206c 6175 6e63 680d 0a20       # launch.. 
+00029530: 2020 2020 2020 2020 2020 2067 6c42 6c65             glBle
+00029540: 6e64 4675 6e63 2847 4c5f 5352 435f 414c  ndFunc(GL_SRC_AL
+00029550: 5048 412c 2047 4c5f 4f4e 455f 4d49 4e55  PHA, GL_ONE_MINU
+00029560: 535f 5352 435f 414c 5048 4129 0d0a 2020  S_SRC_ALPHA)..  
+00029570: 2020 2020 2020 2020 2020 676c 426c 656e            glBlen
+00029580: 6445 7175 6174 696f 6e28 474c 5f46 554e  dEquation(GL_FUN
+00029590: 435f 4144 4429 0d0a 2020 2020 2020 2020  C_ADD)..        
+000295a0: 2020 2020 7365 6c66 2e6c 696e 655f 7368      self.line_sh
+000295b0: 6164 6572 2e62 696e 6428 290d 0a20 2020  ader.bind()..   
+000295c0: 2020 2020 2020 2020 2073 656c 662e 6c69           self.li
+000295d0: 6e65 5f76 612e 6269 6e64 2829 0d0a 2020  ne_va.bind()..  
+000295e0: 2020 2020 2020 2020 2020 7365 6c66 2e6c            self.l
+000295f0: 696e 655f 7368 6164 6572 2e75 6e69 666f  ine_shader.unifo
+00029600: 726d 6d61 7434 2822 6361 6d65 7261 4d61  rmmat4("cameraMa
+00029610: 7472 6978 222c 2063 616d 6572 612e 7669  trix", camera.vi
+00029620: 6577 5f70 726f 6a65 6374 696f 6e5f 6d61  ew_projection_ma
+00029630: 7472 6978 290d 0a20 2020 2020 2020 2020  trix)..         
+00029640: 2020 2067 6c44 7261 7745 6c65 6d65 6e74     glDrawElement
+00029650: 7328 474c 5f4c 494e 4553 2c20 7365 6c66  s(GL_LINES, self
+00029660: 2e6c 696e 655f 7661 2e69 6e64 6578 4275  .line_va.indexBu
+00029670: 6666 6572 2e67 6574 436f 756e 7428 292c  ffer.getCount(),
+00029680: 2047 4c5f 554e 5349 474e 4544 5f53 484f   GL_UNSIGNED_SHO
+00029690: 5254 2c20 4e6f 6e65 290d 0a20 2020 2020  RT, None)..     
+000296a0: 2020 2020 2020 2073 656c 662e 6c69 6e65         self.line
+000296b0: 5f73 6861 6465 722e 756e 6269 6e64 2829  _shader.unbind()
+000296c0: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+000296d0: 6c66 2e6c 696e 655f 7661 2e75 6e62 696e  lf.line_va.unbin
+000296e0: 6428 290d 0a0d 0a20 2020 2020 2020 2067  d()....        g
+000296f0: 6c42 6c65 6e64 4675 6e63 2847 4c5f 4f4e  lBlendFunc(GL_ON
+00029700: 455f 4d49 4e55 535f 4453 545f 434f 4c4f  E_MINUS_DST_COLO
+00029710: 522c 2047 4c5f 4f4e 455f 4d49 4e55 535f  R, GL_ONE_MINUS_
+00029720: 5352 435f 434f 4c4f 5229 0d0a 2020 2020  SRC_COLOR)..    
+00029730: 2020 2020 676c 426c 656e 6445 7175 6174      glBlendEquat
+00029740: 696f 6e28 474c 5f46 554e 435f 4144 4429  ion(GL_FUNC_ADD)
+00029750: 0d0a 2020 2020 2020 2020 7265 6e64 6572  ..        render
+00029760: 5f6c 696e 6573 5f69 6e5f 6c69 7374 2873  _lines_in_list(s
+00029770: 656c 662e 6c69 6e65 5f6c 6973 745f 7329  elf.line_list_s)
+00029780: 0d0a 0d0a 2020 2020 2020 2020 676c 426c  ....        glBl
+00029790: 656e 6446 756e 6328 474c 5f53 5243 5f41  endFunc(GL_SRC_A
+000297a0: 4c50 4841 2c20 474c 5f4f 4e45 5f4d 494e  LPHA, GL_ONE_MIN
+000297b0: 5553 5f53 5243 5f41 4c50 4841 290d 0a20  US_SRC_ALPHA).. 
+000297c0: 2020 2020 2020 2067 6c42 6c65 6e64 4571         glBlendEq
+000297d0: 7561 7469 6f6e 2847 4c5f 4655 4e43 5f41  uation(GL_FUNC_A
+000297e0: 4444 290d 0a20 2020 2020 2020 2072 656e  DD)..        ren
+000297f0: 6465 725f 6c69 6e65 735f 696e 5f6c 6973  der_lines_in_lis
+00029800: 7428 7365 6c66 2e6c 696e 655f 6c69 7374  t(self.line_list
+00029810: 290d 0a0d 0a20 2020 2020 2020 2073 656c  )....        sel
+00029820: 662e 6c69 6e65 5f6c 6973 745f 7320 3d20  f.line_list_s = 
+00029830: 6c69 7374 2829 0d0a 2020 2020 2020 2020  list()..        
+00029840: 7365 6c66 2e6c 696e 655f 6c69 7374 203d  self.line_list =
+00029850: 206c 6973 7428 290d 0a0d 0a20 2020 2064   list()....    d
+00029860: 6566 2072 656e 6465 725f 6472 6177 5f6c  ef render_draw_l
+00029870: 6973 7428 7365 6c66 2c20 6361 6d65 7261  ist(self, camera
+00029880: 293a 0d0a 2020 2020 2020 2020 7365 6c66  ):..        self
+00029890: 2e72 656e 6465 725f 6c69 6e65 7328 6361  .render_lines(ca
+000298a0: 6d65 7261 290d 0a0d 0a20 2020 2064 6566  mera)....    def
+000298b0: 2072 656e 6465 725f 6f76 6572 6c61 7928   render_overlay(
+000298c0: 7365 6c66 2c20 7365 5f66 7261 6d65 2c20  self, se_frame, 
+000298d0: 6361 6d65 7261 2c20 626c 656e 645f 6d6f  camera, blend_mo
+000298e0: 6465 2c20 616c 7068 6129 3a0d 0a20 2020  de, alpha):..   
+000298f0: 2020 2020 2069 6620 7365 5f66 7261 6d65       if se_frame
+00029900: 2e6f 7665 726c 6179 2069 7320 4e6f 6e65  .overlay is None
+00029910: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
+00029920: 6574 7572 6e0d 0a20 2020 2020 2020 2069  eturn..        i
+00029930: 6620 616c 7068 6120 3d3d 2030 2e30 3a0d  f alpha == 0.0:.
+00029940: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00029950: 7572 6e0d 0a20 2020 2020 2020 2067 6c42  urn..        glB
+00029960: 6c65 6e64 4675 6e63 2862 6c65 6e64 5f6d  lendFunc(blend_m
+00029970: 6f64 655b 305d 2c20 626c 656e 645f 6d6f  ode[0], blend_mo
+00029980: 6465 5b31 5d29 0d0a 2020 2020 2020 2020  de[1])..        
+00029990: 676c 426c 656e 6445 7175 6174 696f 6e28  glBlendEquation(
+000299a0: 626c 656e 645f 6d6f 6465 5b32 5d29 0d0a  blend_mode[2])..
+000299b0: 2020 2020 2020 2020 676c 4469 7361 626c          glDisabl
+000299c0: 6528 474c 5f44 4550 5448 5f54 4553 5429  e(GL_DEPTH_TEST)
+000299d0: 0d0a 2020 2020 2020 2020 7368 6164 6572  ..        shader
+000299e0: 5f62 6c65 6e64 5f63 6f64 6520 3d20 626c  _blend_code = bl
+000299f0: 656e 645f 6d6f 6465 5b33 5d0d 0a20 2020  end_mode[3]..   
+00029a00: 2020 2020 2073 655f 6672 616d 652e 7175       se_frame.qu
+00029a10: 6164 5f76 612e 6269 6e64 2829 0d0a 2020  ad_va.bind()..  
+00029a20: 2020 2020 2020 7365 5f66 7261 6d65 2e6f        se_frame.o
+00029a30: 7665 726c 6179 2e74 6578 7475 7265 2e62  verlay.texture.b
+00029a40: 696e 6428 290d 0a20 2020 2020 2020 2073  ind()..        s
+00029a50: 656c 662e 6f76 6572 6c61 795f 7368 6164  elf.overlay_shad
+00029a60: 6572 2e62 696e 6428 290d 0a20 2020 2020  er.bind()..     
+00029a70: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00029a80: 2863 616d 6572 612c 2043 616d 6572 6133  (camera, Camera3
+00029a90: 4429 3a0d 0a20 2020 2020 2020 2020 2020  D):..           
+00029aa0: 2073 656c 662e 6f76 6572 6c61 795f 7368   self.overlay_sh
+00029ab0: 6164 6572 2e75 6e69 666f 726d 3169 2822  ader.uniform1i("
+00029ac0: 7265 6e64 6572 5f33 6422 2c20 3129 0d0a  render_3d", 1)..
+00029ad0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00029ae0: 2e6f 7665 726c 6179 5f73 6861 6465 722e  .overlay_shader.
+00029af0: 756e 6966 6f72 6d31 6628 2269 6e74 656e  uniform1f("inten
+00029b00: 7369 7479 222c 2053 6567 6d65 6e74 6174  sity", Segmentat
+00029b10: 696f 6e45 6469 746f 722e 4f56 4552 4c41  ionEditor.OVERLA
+00029b20: 595f 494e 5445 4e53 4954 5929 0d0a 2020  Y_INTENSITY)..  
+00029b30: 2020 2020 2020 2020 2020 7365 6c66 2e6f            self.o
+00029b40: 7665 726c 6179 5f73 6861 6465 722e 756e  verlay_shader.un
+00029b50: 6966 6f72 6d31 6628 227a 5f70 6f73 222c  iform1f("z_pos",
+00029b60: 2028 7365 5f66 7261 6d65 2e63 7572 7265   (se_frame.curre
+00029b70: 6e74 5f73 6c69 6365 202d 2073 655f 6672  nt_slice - se_fr
+00029b80: 616d 652e 6e5f 736c 6963 6573 202f 2032  ame.n_slices / 2
+00029b90: 2920 2a20 7365 5f66 7261 6d65 2e70 6978  ) * se_frame.pix
+00029ba0: 656c 5f73 697a 6529 0d0a 2020 2020 2020  el_size)..      
+00029bb0: 2020 2020 2020 7365 6c66 2e6f 7665 726c        self.overl
+00029bc0: 6179 5f73 6861 6465 722e 756e 6966 6f72  ay_shader.unifor
+00029bd0: 6d31 6628 2270 6978 656c 5f73 697a 6522  m1f("pixel_size"
+00029be0: 2c20 7365 5f66 7261 6d65 2e70 6978 656c  , se_frame.pixel
+00029bf0: 5f73 697a 6529 2020 2320 5468 6973 2066  _size)  # This f
+00029c00: 6163 746f 7220 7368 6f75 6c64 2062 6520  actor should be 
+00029c10: 696e 2074 6865 2056 412c 2062 7574 2066  in the VA, but f
+00029c20: 6978 696e 6720 7468 6174 206d 6573 7365  ixing that messe
+00029c30: 6420 7570 2074 6865 2032 4420 7669 6577  d up the 2D view
+00029c40: 202d 2063 6865 6170 2066 6978 2066 6f72   - cheap fix for
+00029c50: 206e 6f77 0d0a 2020 2020 2020 2020 656c   now..        el
+00029c60: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+00029c70: 2073 656c 662e 6f76 6572 6c61 795f 7368   self.overlay_sh
+00029c80: 6164 6572 2e75 6e69 666f 726d 3169 2822  ader.uniform1i("
+00029c90: 7265 6e64 6572 5f33 6422 2c20 3029 0d0a  render_3d", 0)..
+00029ca0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00029cb0: 2e6f 7665 726c 6179 5f73 6861 6465 722e  .overlay_shader.
+00029cc0: 756e 6966 6f72 6d31 6628 2269 6e74 656e  uniform1f("inten
+00029cd0: 7369 7479 222c 2031 2e30 290d 0a20 2020  sity", 1.0)..   
+00029ce0: 2020 2020 2073 656c 662e 6f76 6572 6c61       self.overla
+00029cf0: 795f 7368 6164 6572 2e75 6e69 666f 726d  y_shader.uniform
+00029d00: 6d61 7434 2822 6361 6d65 7261 4d61 7472  mat4("cameraMatr
+00029d10: 6978 222c 2063 616d 6572 612e 7669 6577  ix", camera.view
+00029d20: 5f70 726f 6a65 6374 696f 6e5f 6d61 7472  _projection_matr
+00029d30: 6978 290d 0a20 2020 2020 2020 2073 656c  ix)..        sel
+00029d40: 662e 6f76 6572 6c61 795f 7368 6164 6572  f.overlay_shader
+00029d50: 2e75 6e69 666f 726d 6d61 7434 2822 6d6f  .uniformmat4("mo
+00029d60: 6465 6c4d 6174 7269 7822 2c20 7365 5f66  delMatrix", se_f
+00029d70: 7261 6d65 2e74 7261 6e73 666f 726d 2e6d  rame.transform.m
+00029d80: 6174 7269 7829 0d0a 2020 2020 2020 2020  atrix)..        
+00029d90: 7365 6c66 2e6f 7665 726c 6179 5f73 6861  self.overlay_sha
+00029da0: 6465 722e 756e 6966 6f72 6d31 6628 2261  der.uniform1f("a
+00029db0: 6c70 6861 222c 2061 6c70 6861 290d 0a20  lpha", alpha).. 
+00029dc0: 2020 2020 2020 2073 656c 662e 6f76 6572         self.over
+00029dd0: 6c61 795f 7368 6164 6572 2e75 6e69 666f  lay_shader.unifo
+00029de0: 726d 3169 2822 7368 6164 6572 5f62 6c65  rm1i("shader_ble
+00029df0: 6e64 5f63 6f64 6522 2c20 7368 6164 6572  nd_code", shader
+00029e00: 5f62 6c65 6e64 5f63 6f64 6529 0d0a 2020  _blend_code)..  
+00029e10: 2020 2020 2020 676c 4472 6177 456c 656d        glDrawElem
+00029e20: 656e 7473 2847 4c5f 5452 4941 4e47 4c45  ents(GL_TRIANGLE
+00029e30: 532c 2073 655f 6672 616d 652e 7175 6164  S, se_frame.quad
+00029e40: 5f76 612e 696e 6465 7842 7566 6665 722e  _va.indexBuffer.
+00029e50: 6765 7443 6f75 6e74 2829 2c20 474c 5f55  getCount(), GL_U
+00029e60: 4e53 4947 4e45 445f 5348 4f52 542c 204e  NSIGNED_SHORT, N
+00029e70: 6f6e 6529 0d0a 2020 2020 2020 2020 7365  one)..        se
+00029e80: 6c66 2e6f 7665 726c 6179 5f73 6861 6465  lf.overlay_shade
+00029e90: 722e 756e 6269 6e64 2829 0d0a 2020 2020  r.unbind()..    
+00029ea0: 2020 2020 7365 5f66 7261 6d65 2e71 7561      se_frame.qua
+00029eb0: 645f 7661 2e75 6e62 696e 6428 290d 0a20  d_va.unbind().. 
+00029ec0: 2020 2020 2020 2067 6c41 6374 6976 6554         glActiveT
+00029ed0: 6578 7475 7265 2847 4c5f 5445 5854 5552  exture(GL_TEXTUR
+00029ee0: 4530 290d 0a0d 0a0d 0a63 6c61 7373 2043  E0)......class C
+00029ef0: 616d 6572 613a 0d0a 2020 2020 6465 6620  amera:..    def 
+00029f00: 5f5f 696e 6974 5f5f 2873 656c 6629 3a0d  __init__(self):.
+00029f10: 0a20 2020 2020 2020 2073 656c 662e 7669  .        self.vi
+00029f20: 6577 5f6d 6174 7269 7820 3d20 6e70 2e69  ew_matrix = np.i
+00029f30: 6465 6e74 6974 7928 3429 0d0a 2020 2020  dentity(4)..    
+00029f40: 2020 2020 7365 6c66 2e70 726f 6a65 6374      self.project
+00029f50: 696f 6e5f 6d61 7472 6978 203d 206e 702e  ion_matrix = np.
+00029f60: 6964 656e 7469 7479 2834 290d 0a20 2020  identity(4)..   
+00029f70: 2020 2020 2073 656c 662e 7669 6577 5f70       self.view_p
+00029f80: 726f 6a65 6374 696f 6e5f 6d61 7472 6978  rojection_matrix
+00029f90: 203d 206e 702e 6964 656e 7469 7479 2834   = np.identity(4
+00029fa0: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+00029fb0: 706f 7369 7469 6f6e 203d 206e 702e 7a65  position = np.ze
+00029fc0: 726f 7328 3329 0d0a 2020 2020 2020 2020  ros(3)..        
+00029fd0: 7365 6c66 2e7a 6f6f 6d20 3d20 312e 300d  self.zoom = 1.0.
+00029fe0: 0a20 2020 2020 2020 2073 656c 662e 7072  .        self.pr
+00029ff0: 6f6a 6563 7469 6f6e 5f77 6964 7468 203d  ojection_width =
+0002a000: 2031 0d0a 2020 2020 2020 2020 7365 6c66   1..        self
+0002a010: 2e70 726f 6a65 6374 696f 6e5f 6865 6967  .projection_heig
+0002a020: 6874 203d 2031 0d0a 2020 2020 2020 2020  ht = 1..        
+0002a030: 7365 6c66 2e73 6574 5f70 726f 6a65 6374  self.set_project
+0002a040: 696f 6e5f 6d61 7472 6978 2863 6667 2e77  ion_matrix(cfg.w
+0002a050: 696e 646f 775f 7769 6474 682c 2063 6667  indow_width, cfg
+0002a060: 2e77 696e 646f 775f 6865 6967 6874 290d  .window_height).
+0002a070: 0a0d 0a20 2020 2064 6566 2063 7572 736f  ...    def curso
+0002a080: 725f 746f 5f77 6f72 6c64 5f70 6f73 6974  r_to_world_posit
+0002a090: 696f 6e28 7365 6c66 2c20 6375 7273 6f72  ion(self, cursor
+0002a0a0: 5f70 6f73 293a 0d0a 2020 2020 2020 2020  _pos):..        
+0002a0b0: 2222 220d 0a20 2020 2020 2020 2063 7572  """..        cur
+0002a0c0: 736f 725f 7075 733a 206c 6973 742c 205b  sor_pus: list, [
+0002a0d0: 782c 2079 5d0d 0a20 2020 2020 2020 2072  x, y]..        r
+0002a0e0: 6574 7572 6e73 3a20 5b77 6f72 6c64 5f70  eturns: [world_p
+0002a0f0: 6f73 5f78 2c20 776f 726c 645f 706f 735f  os_x, world_pos_
+0002a100: 795d 0d0a 2020 2020 2020 2020 436f 6e76  y]..        Conv
+0002a110: 6572 7473 2061 6e20 696e 7075 7420 6375  erts an input cu
+0002a120: 7273 6f72 2070 6f73 6974 696f 6e20 746f  rsor position to
+0002a130: 2063 6f72 7265 7370 6f6e 6469 6e67 2077   corresponding w
+0002a140: 6f72 6c64 2070 6f73 6974 696f 6e2e 2041  orld position. A
+0002a150: 7373 756d 696e 6720 6f72 7468 6f67 7261  ssuming orthogra
+0002a160: 7068 6963 2070 726f 6a65 6374 696f 6e20  phic projection 
+0002a170: 6d61 7472 6978 2e0d 0a20 2020 2020 2020  matrix...       
+0002a180: 2022 2222 0d0a 2020 2020 2020 2020 696e   """..        in
+0002a190: 7665 7273 655f 6d61 7472 6978 203d 206e  verse_matrix = n
+0002a1a0: 702e 6c69 6e61 6c67 2e69 6e76 2873 656c  p.linalg.inv(sel
+0002a1b0: 662e 7669 6577 5f70 726f 6a65 6374 696f  f.view_projectio
+0002a1c0: 6e5f 6d61 7472 6978 290d 0a20 2020 2020  n_matrix)..     
+0002a1d0: 2020 2077 696e 646f 775f 636f 6f72 6469     window_coordi
+0002a1e0: 6e61 7465 7320 3d20 2832 202a 2063 7572  nates = (2 * cur
+0002a1f0: 736f 725f 706f 735b 305d 202f 2063 6667  sor_pos[0] / cfg
+0002a200: 2e77 696e 646f 775f 7769 6474 6820 2d20  .window_width - 
+0002a210: 312c 2031 202d 2032 202a 2063 7572 736f  1, 1 - 2 * curso
+0002a220: 725f 706f 735b 315d 202f 2063 6667 2e77  r_pos[1] / cfg.w
+0002a230: 696e 646f 775f 6865 6967 6874 290d 0a20  indow_height).. 
+0002a240: 2020 2020 2020 2077 696e 646f 775f 7665         window_ve
+0002a250: 6320 3d20 6e70 2e6d 6174 7269 7828 5b2a  c = np.matrix([*
+0002a260: 7769 6e64 6f77 5f63 6f6f 7264 696e 6174  window_coordinat
+0002a270: 6573 2c20 312e 302c 2031 2e30 5d29 2e54  es, 1.0, 1.0]).T
+0002a280: 0d0a 2020 2020 2020 2020 776f 726c 645f  ..        world_
+0002a290: 7665 6320 3d20 2869 6e76 6572 7365 5f6d  vec = (inverse_m
+0002a2a0: 6174 7269 7820 2a20 7769 6e64 6f77 5f76  atrix * window_v
+0002a2b0: 6563 290d 0a20 2020 2020 2020 2072 6574  ec)..        ret
+0002a2c0: 7572 6e20 5b66 6c6f 6174 2877 6f72 6c64  urn [float(world
+0002a2d0: 5f76 6563 5b30 5d29 2c20 666c 6f61 7428  _vec[0]), float(
+0002a2e0: 776f 726c 645f 7665 635b 315d 295d 0d0a  world_vec[1])]..
+0002a2f0: 0d0a 2020 2020 6465 6620 776f 726c 645f  ..    def world_
+0002a300: 746f 5f73 6372 6565 6e5f 706f 7369 7469  to_screen_positi
+0002a310: 6f6e 2873 656c 662c 2077 6f72 6c64 5f70  on(self, world_p
+0002a320: 6f73 6974 696f 6e29 3a0d 0a20 2020 2020  osition):..     
+0002a330: 2020 2076 6563 203d 206e 702e 6d61 7472     vec = np.matr
+0002a340: 6978 285b 776f 726c 645f 706f 7369 7469  ix([world_positi
+0002a350: 6f6e 5b30 5d2c 2077 6f72 6c64 5f70 6f73  on[0], world_pos
+0002a360: 6974 696f 6e5b 315d 2c20 302e 302c 2031  ition[1], 0.0, 1
+0002a370: 2e30 5d29 2e54 0d0a 2020 2020 2020 2020  .0]).T..        
+0002a380: 7665 635f 6f75 7420 3d20 7365 6c66 2e76  vec_out = self.v
+0002a390: 6965 775f 7072 6f6a 6563 7469 6f6e 5f6d  iew_projection_m
+0002a3a0: 6174 7269 7820 2a20 7665 630d 0a20 2020  atrix * vec..   
+0002a3b0: 2020 2020 2073 6372 6565 6e5f 7820 3d20       screen_x = 
+0002a3c0: 696e 7428 2831 202b 2066 6c6f 6174 2876  int((1 + float(v
+0002a3d0: 6563 5f6f 7574 5b30 5d29 2920 2a20 7365  ec_out[0])) * se
+0002a3e0: 6c66 2e70 726f 6a65 6374 696f 6e5f 7769  lf.projection_wi
+0002a3f0: 6474 6820 2f20 322e 3029 0d0a 2020 2020  dth / 2.0)..    
+0002a400: 2020 2020 7363 7265 656e 5f79 203d 2069      screen_y = i
+0002a410: 6e74 2828 3120 2d20 666c 6f61 7428 7665  nt((1 - float(ve
+0002a420: 635f 6f75 745b 315d 2929 202a 2073 656c  c_out[1])) * sel
+0002a430: 662e 7072 6f6a 6563 7469 6f6e 5f68 6569  f.projection_hei
+0002a440: 6768 7420 2f20 322e 3029 0d0a 2020 2020  ght / 2.0)..    
+0002a450: 2020 2020 7265 7475 726e 205b 7363 7265      return [scre
+0002a460: 656e 5f78 2c20 7363 7265 656e 5f79 5d0d  en_x, screen_y].
+0002a470: 0a0d 0a20 2020 2064 6566 2073 6574 5f70  ...    def set_p
+0002a480: 726f 6a65 6374 696f 6e5f 6d61 7472 6978  rojection_matrix
+0002a490: 2873 656c 662c 2077 696e 646f 775f 7769  (self, window_wi
+0002a4a0: 6474 682c 2077 696e 646f 775f 6865 6967  dth, window_heig
+0002a4b0: 6874 293a 0d0a 2020 2020 2020 2020 7365  ht):..        se
+0002a4c0: 6c66 2e70 726f 6a65 6374 696f 6e5f 6d61  lf.projection_ma
+0002a4d0: 7472 6978 203d 206e 702e 6d61 7472 6978  trix = np.matrix
+0002a4e0: 285b 0d0a 2020 2020 2020 2020 2020 2020  ([..            
+0002a4f0: 5b32 202f 2077 696e 646f 775f 7769 6474  [2 / window_widt
+0002a500: 682c 2030 2c20 302c 2030 5d2c 0d0a 2020  h, 0, 0, 0],..  
+0002a510: 2020 2020 2020 2020 2020 5b30 2c20 3220            [0, 2 
+0002a520: 2f20 7769 6e64 6f77 5f68 6569 6768 742c  / window_height,
+0002a530: 2030 2c20 305d 2c0d 0a20 2020 2020 2020   0, 0],..       
+0002a540: 2020 2020 205b 302c 2030 2c20 2d32 202f       [0, 0, -2 /
+0002a550: 2031 3030 2c20 305d 2c0d 0a20 2020 2020   100, 0],..     
+0002a560: 2020 2020 2020 205b 302c 2030 2c20 302c         [0, 0, 0,
+0002a570: 2031 5d2c 0d0a 2020 2020 2020 2020 5d29   1],..        ])
+0002a580: 0d0a 2020 2020 2020 2020 7365 6c66 2e70  ..        self.p
+0002a590: 726f 6a65 6374 696f 6e5f 7769 6474 6820  rojection_width 
+0002a5a0: 3d20 7769 6e64 6f77 5f77 6964 7468 0d0a  = window_width..
+0002a5b0: 2020 2020 2020 2020 7365 6c66 2e70 726f          self.pro
+0002a5c0: 6a65 6374 696f 6e5f 6865 6967 6874 203d  jection_height =
+0002a5d0: 2077 696e 646f 775f 6865 6967 6874 0d0a   window_height..
+0002a5e0: 0d0a 2020 2020 6465 6620 6f6e 5f75 7064  ..    def on_upd
+0002a5f0: 6174 6528 7365 6c66 293a 0d0a 2020 2020  ate(self):..    
+0002a600: 2020 2020 7365 6c66 2e76 6965 775f 6d61      self.view_ma
+0002a610: 7472 6978 203d 206e 702e 6d61 7472 6978  trix = np.matrix
+0002a620: 285b 0d0a 2020 2020 2020 2020 2020 2020  ([..            
+0002a630: 5b73 656c 662e 7a6f 6f6d 2c20 302e 302c  [self.zoom, 0.0,
+0002a640: 2030 2e30 2c20 7365 6c66 2e70 6f73 6974   0.0, self.posit
+0002a650: 696f 6e5b 305d 202a 2073 656c 662e 7a6f  ion[0] * self.zo
+0002a660: 6f6d 5d2c 0d0a 2020 2020 2020 2020 2020  om],..          
+0002a670: 2020 5b30 2e30 2c20 7365 6c66 2e7a 6f6f    [0.0, self.zoo
+0002a680: 6d2c 2030 2e30 2c20 7365 6c66 2e70 6f73  m, 0.0, self.pos
+0002a690: 6974 696f 6e5b 315d 202a 2073 656c 662e  ition[1] * self.
+0002a6a0: 7a6f 6f6d 5d2c 0d0a 2020 2020 2020 2020  zoom],..        
+0002a6b0: 2020 2020 5b30 2e30 2c20 302e 302c 2031      [0.0, 0.0, 1
+0002a6c0: 2e30 2c20 7365 6c66 2e70 6f73 6974 696f  .0, self.positio
+0002a6d0: 6e5b 325d 5d2c 0d0a 2020 2020 2020 2020  n[2]],..        
+0002a6e0: 2020 2020 5b30 2e30 2c20 302e 302c 2030      [0.0, 0.0, 0
+0002a6f0: 2e30 2c20 312e 305d 2c0d 0a20 2020 2020  .0, 1.0],..     
+0002a700: 2020 205d 290d 0a20 2020 2020 2020 2073     ])..        s
+0002a710: 656c 662e 7669 6577 5f70 726f 6a65 6374  elf.view_project
+0002a720: 696f 6e5f 6d61 7472 6978 203d 206e 702e  ion_matrix = np.
+0002a730: 6d61 746d 756c 2873 656c 662e 7072 6f6a  matmul(self.proj
+0002a740: 6563 7469 6f6e 5f6d 6174 7269 782c 2073  ection_matrix, s
+0002a750: 656c 662e 7669 6577 5f6d 6174 7269 7829  elf.view_matrix)
+0002a760: 0d0a 0d0a 0d0a 636c 6173 7320 4c69 6768  ......class Ligh
+0002a770: 7433 443a 0d0a 2020 2020 6465 6620 5f5f  t3D:..    def __
+0002a780: 696e 6974 5f5f 2873 656c 6629 3a0d 0a20  init__(self):.. 
+0002a790: 2020 2020 2020 2073 656c 662e 636f 6c6f         self.colo
+0002a7a0: 7572 203d 2028 312e 302c 2031 2e30 2c20  ur = (1.0, 1.0, 
+0002a7b0: 312e 3029 0d0a 2020 2020 2020 2020 7365  1.0)..        se
+0002a7c0: 6c66 2e76 6563 203d 2028 302e 302c 2031  lf.vec = (0.0, 1
+0002a7d0: 2e30 2c20 302e 3029 0d0a 2020 2020 2020  .0, 0.0)..      
+0002a7e0: 2020 7365 6c66 2e79 6177 203d 2032 302e    self.yaw = 20.
+0002a7f0: 300d 0a20 2020 2020 2020 2073 656c 662e  0..        self.
+0002a800: 7069 7463 6820 3d20 302e 300d 0a20 2020  pitch = 0.0..   
+0002a810: 2020 2020 2073 656c 662e 7374 7265 6e67       self.streng
+0002a820: 7468 203d 2030 2e35 0d0a 0d0a 2020 2020  th = 0.5....    
+0002a830: 6465 6620 636f 6d70 7574 655f 7665 6328  def compute_vec(
+0002a840: 7365 6c66 2c20 6479 6177 3d30 2c20 6470  self, dyaw=0, dp
+0002a850: 6974 6368 3d30 293a 0d0a 2020 2020 2020  itch=0):..      
+0002a860: 2020 2320 4361 6c63 756c 6174 6520 7468    # Calculate th
+0002a870: 6520 6361 6d65 7261 2066 6f72 7761 7264  e camera forward
+0002a880: 2076 6563 746f 7220 6261 7365 6420 6f6e   vector based on
+0002a890: 2070 6974 6368 2061 6e64 2079 6177 0d0a   pitch and yaw..
+0002a8a0: 2020 2020 2020 2020 636f 735f 7069 7463          cos_pitc
+0002a8b0: 6820 3d20 6e70 2e63 6f73 286e 702e 7261  h = np.cos(np.ra
+0002a8c0: 6469 616e 7328 7365 6c66 2e70 6974 6368  dians(self.pitch
+0002a8d0: 202b 2064 7069 7463 6829 290d 0a20 2020   + dpitch))..   
+0002a8e0: 2020 2020 2073 696e 5f70 6974 6368 203d       sin_pitch =
+0002a8f0: 206e 702e 7369 6e28 6e70 2e72 6164 6961   np.sin(np.radia
+0002a900: 6e73 2873 656c 662e 7069 7463 6820 2b20  ns(self.pitch + 
+0002a910: 6470 6974 6368 2929 0d0a 2020 2020 2020  dpitch))..      
+0002a920: 2020 636f 735f 7961 7720 3d20 6e70 2e63    cos_yaw = np.c
+0002a930: 6f73 286e 702e 7261 6469 616e 7328 7365  os(np.radians(se
+0002a940: 6c66 2e79 6177 202b 2064 7961 7729 290d  lf.yaw + dyaw)).
+0002a950: 0a20 2020 2020 2020 2073 696e 5f79 6177  .        sin_yaw
+0002a960: 203d 206e 702e 7369 6e28 6e70 2e72 6164   = np.sin(np.rad
+0002a970: 6961 6e73 2873 656c 662e 7961 7720 2b20  ians(self.yaw + 
+0002a980: 6479 6177 2929 0d0a 0d0a 2020 2020 2020  dyaw))....      
+0002a990: 2020 666f 7277 6172 6420 3d20 6e70 2e61    forward = np.a
+0002a9a0: 7272 6179 285b 2d63 6f73 5f70 6974 6368  rray([-cos_pitch
+0002a9b0: 202a 2073 696e 5f79 6177 2c20 7369 6e5f   * sin_yaw, sin_
+0002a9c0: 7069 7463 682c 202d 636f 735f 7069 7463  pitch, -cos_pitc
+0002a9d0: 6820 2a20 636f 735f 7961 775d 290d 0a20  h * cos_yaw]).. 
+0002a9e0: 2020 2020 2020 2073 656c 662e 7665 6320         self.vec 
+0002a9f0: 3d20 666f 7277 6172 640d 0a0d 0a0d 0a63  = forward......c
+0002aa00: 6c61 7373 2043 616d 6572 6133 443a 0d0a  lass Camera3D:..
+0002aa10: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
+0002aa20: 2873 656c 6629 3a0d 0a20 2020 2020 2020  (self):..       
+0002aa30: 2073 656c 662e 7669 6577 5f6d 6174 7269   self.view_matri
+0002aa40: 7820 3d20 6e70 2e65 7965 2834 290d 0a20  x = np.eye(4).. 
+0002aa50: 2020 2020 2020 2073 656c 662e 7072 6f6a         self.proj
+0002aa60: 6563 7469 6f6e 5f6d 6174 7269 7820 3d20  ection_matrix = 
+0002aa70: 6e70 2e65 7965 2834 290d 0a20 2020 2020  np.eye(4)..     
+0002aa80: 2020 2073 656c 662e 7669 6577 5f70 726f     self.view_pro
+0002aa90: 6a65 6374 696f 6e5f 6d61 7472 6978 203d  jection_matrix =
+0002aaa0: 206e 702e 6579 6528 3429 0d0a 2020 2020   np.eye(4)..    
+0002aab0: 2020 2020 7365 6c66 2e66 6f63 7573 203d      self.focus =
+0002aac0: 206e 702e 7a65 726f 7328 3329 0d0a 2020   np.zeros(3)..  
+0002aad0: 2020 2020 2020 7365 6c66 2e70 6974 6368        self.pitch
+0002aae0: 203d 2030 2e30 0d0a 2020 2020 2020 2020   = 0.0..        
+0002aaf0: 7365 6c66 2e79 6177 203d 2031 3830 2e30  self.yaw = 180.0
+0002ab00: 0d0a 2020 2020 2020 2020 7365 6c66 2e64  ..        self.d
+0002ab10: 6973 7461 6e63 6520 3d20 3131 3230 2e30  istance = 1120.0
+0002ab20: 0d0a 2020 2020 2020 2020 7365 6c66 2e63  ..        self.c
+0002ab30: 6c69 705f 6e65 6172 203d 2031 652d 310d  lip_near = 1e-1.
+0002ab40: 0a20 2020 2020 2020 2073 656c 662e 636c  .        self.cl
+0002ab50: 6970 5f66 6172 203d 2031 6534 0d0a 2020  ip_far = 1e4..  
+0002ab60: 2020 2020 2020 7365 6c66 2e70 726f 6a65        self.proje
+0002ab70: 6374 696f 6e5f 7769 6474 6820 3d20 310d  ction_width = 1.
+0002ab80: 0a20 2020 2020 2020 2073 656c 662e 7072  .        self.pr
+0002ab90: 6f6a 6563 7469 6f6e 5f68 6569 6768 7420  ojection_height 
+0002aba0: 3d20 310d 0a20 2020 2020 2020 2073 656c  = 1..        sel
+0002abb0: 662e 7365 745f 7072 6f6a 6563 7469 6f6e  f.set_projection
+0002abc0: 5f6d 6174 7269 7828 6366 672e 7769 6e64  _matrix(cfg.wind
+0002abd0: 6f77 5f77 6964 7468 2c20 6366 672e 7769  ow_width, cfg.wi
+0002abe0: 6e64 6f77 5f68 6569 6768 7429 0d0a 0d0a  ndow_height)....
+0002abf0: 2020 2020 6465 6620 7365 745f 7072 6f6a      def set_proj
+0002ac00: 6563 7469 6f6e 5f6d 6174 7269 7828 7365  ection_matrix(se
+0002ac10: 6c66 2c20 7769 6e64 6f77 5f77 6964 7468  lf, window_width
+0002ac20: 2c20 7769 6e64 6f77 5f68 6569 6768 7429  , window_height)
+0002ac30: 3a0d 0a20 2020 2020 2020 2073 656c 662e  :..        self.
+0002ac40: 7072 6f6a 6563 7469 6f6e 5f77 6964 7468  projection_width
+0002ac50: 203d 2077 696e 646f 775f 7769 6474 680d   = window_width.
+0002ac60: 0a20 2020 2020 2020 2073 656c 662e 7072  .        self.pr
+0002ac70: 6f6a 6563 7469 6f6e 5f68 6569 6768 7420  ojection_height 
+0002ac80: 3d20 7769 6e64 6f77 5f68 6569 6768 740d  = window_height.
+0002ac90: 0a20 2020 2020 2020 2073 656c 662e 7570  .        self.up
+0002aca0: 6461 7465 5f70 726f 6a65 6374 696f 6e5f  date_projection_
+0002acb0: 6d61 7472 6978 2829 0d0a 0d0a 2020 2020  matrix()....    
+0002acc0: 6465 6620 6375 7273 6f72 5f64 656c 7461  def cursor_delta
+0002acd0: 5f74 6f5f 776f 726c 645f 6465 6c74 6128  _to_world_delta(
+0002ace0: 7365 6c66 2c20 6375 7273 6f72 5f64 656c  self, cursor_del
+0002acf0: 7461 293a 0d0a 2020 2020 2020 2020 7365  ta):..        se
+0002ad00: 6c66 2e79 6177 202a 3d20 2d31 0d0a 2020  lf.yaw *= -1..  
+0002ad10: 2020 2020 2020 6361 6d65 7261 5f72 6967        camera_rig
+0002ad20: 6874 203d 206e 702e 6372 6f73 7328 5b30  ht = np.cross([0
+0002ad30: 2c20 312c 2030 5d2c 2073 656c 662e 6765  , 1, 0], self.ge
+0002ad40: 745f 666f 7277 6172 6428 2929 0d0a 2020  t_forward())..  
+0002ad50: 2020 2020 2020 6361 6d65 7261 5f75 7020        camera_up 
+0002ad60: 3d20 6e70 2e63 726f 7373 2863 616d 6572  = np.cross(camer
+0002ad70: 615f 7269 6768 742c 2073 656c 662e 6765  a_right, self.ge
+0002ad80: 745f 666f 7277 6172 6428 2929 0d0a 2020  t_forward())..  
+0002ad90: 2020 2020 2020 7365 6c66 2e79 6177 202a        self.yaw *
+0002ada0: 3d20 2d31 0d0a 2020 2020 2020 2020 7265  = -1..        re
+0002adb0: 7475 726e 2063 7572 736f 725f 6465 6c74  turn cursor_delt
+0002adc0: 615b 305d 202a 2063 616d 6572 615f 7269  a[0] * camera_ri
+0002add0: 6768 7420 2b20 6375 7273 6f72 5f64 656c  ght + cursor_del
+0002ade0: 7461 5b31 5d20 2a20 6361 6d65 7261 5f75  ta[1] * camera_u
+0002adf0: 700d 0a0d 0a20 2020 2064 6566 2067 6574  p....    def get
+0002ae00: 5f66 6f72 7761 7264 2873 656c 6629 3a0d  _forward(self):.
+0002ae10: 0a20 2020 2020 2020 2023 2043 616c 6375  .        # Calcu
+0002ae20: 6c61 7465 2074 6865 2063 616d 6572 6120  late the camera 
+0002ae30: 666f 7277 6172 6420 7665 6374 6f72 2062  forward vector b
+0002ae40: 6173 6564 206f 6e20 7069 7463 6820 616e  ased on pitch an
+0002ae50: 6420 7961 770d 0a20 2020 2020 2020 2063  d yaw..        c
+0002ae60: 6f73 5f70 6974 6368 203d 206e 702e 636f  os_pitch = np.co
+0002ae70: 7328 6e70 2e72 6164 6961 6e73 2873 656c  s(np.radians(sel
+0002ae80: 662e 7069 7463 6829 290d 0a20 2020 2020  f.pitch))..     
+0002ae90: 2020 2073 696e 5f70 6974 6368 203d 206e     sin_pitch = n
+0002aea0: 702e 7369 6e28 6e70 2e72 6164 6961 6e73  p.sin(np.radians
+0002aeb0: 2873 656c 662e 7069 7463 6829 290d 0a20  (self.pitch)).. 
+0002aec0: 2020 2020 2020 2063 6f73 5f79 6177 203d         cos_yaw =
+0002aed0: 206e 702e 636f 7328 6e70 2e72 6164 6961   np.cos(np.radia
+0002aee0: 6e73 2873 656c 662e 7961 7729 290d 0a20  ns(self.yaw)).. 
+0002aef0: 2020 2020 2020 2073 696e 5f79 6177 203d         sin_yaw =
+0002af00: 206e 702e 7369 6e28 6e70 2e72 6164 6961   np.sin(np.radia
+0002af10: 6e73 2873 656c 662e 7961 7729 290d 0a0d  ns(self.yaw))...
+0002af20: 0a20 2020 2020 2020 2066 6f72 7761 7264  .        forward
+0002af30: 203d 206e 702e 6172 7261 7928 5b2d 636f   = np.array([-co
+0002af40: 735f 7069 7463 6820 2a20 7369 6e5f 7961  s_pitch * sin_ya
+0002af50: 772c 2073 696e 5f70 6974 6368 2c20 2d63  w, sin_pitch, -c
+0002af60: 6f73 5f70 6974 6368 202a 2063 6f73 5f79  os_pitch * cos_y
+0002af70: 6177 5d29 0d0a 2020 2020 2020 2020 7265  aw])..        re
+0002af80: 7475 726e 2066 6f72 7761 7264 0d0a 0d0a  turn forward....
+0002af90: 2020 2020 4070 726f 7065 7274 790d 0a20      @property.. 
+0002afa0: 2020 2064 6566 206d 6174 7269 7828 7365     def matrix(se
+0002afb0: 6c66 293a 0d0a 2020 2020 2020 2020 7265  lf):..        re
+0002afc0: 7475 726e 2073 656c 662e 7669 6577 5f70  turn self.view_p
+0002afd0: 726f 6a65 6374 696f 6e5f 6d61 7472 6978  rojection_matrix
+0002afe0: 0d0a 0d0a 2020 2020 4070 726f 7065 7274  ....    @propert
+0002aff0: 790d 0a20 2020 2064 6566 2076 706d 6174  y..    def vpmat
+0002b000: 2873 656c 6629 3a0d 0a20 2020 2020 2020  (self):..       
+0002b010: 2072 6574 7572 6e20 7365 6c66 2e76 6965   return self.vie
+0002b020: 775f 7072 6f6a 6563 7469 6f6e 5f6d 6174  w_projection_mat
+0002b030: 7269 780d 0a0d 0a20 2020 2040 7072 6f70  rix....    @prop
+0002b040: 6572 7479 0d0a 2020 2020 6465 6620 6976  erty..    def iv
+0002b050: 706d 6174 2873 656c 6629 3a0d 0a20 2020  pmat(self):..   
+0002b060: 2020 2020 2072 6574 7572 6e20 6e70 2e6c       return np.l
+0002b070: 696e 616c 672e 696e 7628 7365 6c66 2e76  inalg.inv(self.v
+0002b080: 6965 775f 7072 6f6a 6563 7469 6f6e 5f6d  iew_projection_m
+0002b090: 6174 7269 7829 0d0a 0d0a 2020 2020 4070  atrix)....    @p
+0002b0a0: 726f 7065 7274 790d 0a20 2020 2064 6566  roperty..    def
+0002b0b0: 2070 6d61 7428 7365 6c66 293a 0d0a 2020   pmat(self):..  
+0002b0c0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0002b0d0: 662e 7072 6f6a 6563 7469 6f6e 5f6d 6174  f.projection_mat
+0002b0e0: 7269 780d 0a0d 0a20 2020 2040 7072 6f70  rix....    @prop
+0002b0f0: 6572 7479 0d0a 2020 2020 6465 6620 766d  erty..    def vm
+0002b100: 6174 2873 656c 6629 3a0d 0a20 2020 2020  at(self):..     
+0002b110: 2020 2072 6574 7572 6e20 7365 6c66 2e76     return self.v
+0002b120: 6965 775f 6d61 7472 6978 0d0a 0d0a 2020  iew_matrix....  
+0002b130: 2020 4070 726f 7065 7274 790d 0a20 2020    @property..   
+0002b140: 2064 6566 2069 706d 6174 2873 656c 6629   def ipmat(self)
+0002b150: 3a0d 0a20 2020 2020 2020 2072 6574 7572  :..        retur
+0002b160: 6e20 6e70 2e6c 696e 616c 672e 696e 7628  n np.linalg.inv(
+0002b170: 7365 6c66 2e70 726f 6a65 6374 696f 6e5f  self.projection_
+0002b180: 6d61 7472 6978 290d 0a0d 0a20 2020 2040  matrix)....    @
+0002b190: 7072 6f70 6572 7479 0d0a 2020 2020 6465  property..    de
+0002b1a0: 6620 6976 6d61 7428 7365 6c66 293a 0d0a  f ivmat(self):..
+0002b1b0: 2020 2020 2020 2020 7265 7475 726e 206e          return n
+0002b1c0: 702e 6c69 6e61 6c67 2e69 6e76 2873 656c  p.linalg.inv(sel
+0002b1d0: 662e 7669 6577 5f6d 6174 7269 7829 0d0a  f.view_matrix)..
+0002b1e0: 0d0a 2020 2020 6465 6620 6f6e 5f75 7064  ..    def on_upd
+0002b1f0: 6174 6528 7365 6c66 293a 0d0a 2020 2020  ate(self):..    
+0002b200: 2020 2020 7365 6c66 2e75 7064 6174 655f      self.update_
+0002b210: 7072 6f6a 6563 7469 6f6e 5f6d 6174 7269  projection_matri
+0002b220: 7828 290d 0a20 2020 2020 2020 2073 656c  x()..        sel
+0002b230: 662e 7570 6461 7465 5f76 6965 775f 7072  f.update_view_pr
+0002b240: 6f6a 6563 7469 6f6e 5f6d 6174 7269 7828  ojection_matrix(
+0002b250: 290d 0a0d 0a20 2020 2064 6566 2075 7064  )....    def upd
+0002b260: 6174 655f 7072 6f6a 6563 7469 6f6e 5f6d  ate_projection_m
+0002b270: 6174 7269 7828 7365 6c66 293a 0d0a 2020  atrix(self):..  
+0002b280: 2020 2020 2020 6173 7065 6374 5f72 6174        aspect_rat
+0002b290: 696f 203d 2073 656c 662e 7072 6f6a 6563  io = self.projec
+0002b2a0: 7469 6f6e 5f77 6964 7468 202f 2073 656c  tion_width / sel
+0002b2b0: 662e 7072 6f6a 6563 7469 6f6e 5f68 6569  f.projection_hei
+0002b2c0: 6768 740d 0a20 2020 2020 2020 2073 656c  ght..        sel
+0002b2d0: 662e 7072 6f6a 6563 7469 6f6e 5f6d 6174  f.projection_mat
+0002b2e0: 7269 7820 3d20 4361 6d65 7261 3344 2e63  rix = Camera3D.c
+0002b2f0: 7265 6174 655f 7065 7273 7065 6374 6976  reate_perspectiv
+0002b300: 655f 6d61 7472 6978 2836 302e 302c 2061  e_matrix(60.0, a
+0002b310: 7370 6563 745f 7261 7469 6f2c 2073 656c  spect_ratio, sel
+0002b320: 662e 636c 6970 5f6e 6561 722c 2073 656c  f.clip_near, sel
+0002b330: 662e 636c 6970 5f66 6172 290d 0a20 2020  f.clip_far)..   
+0002b340: 2020 2020 2073 656c 662e 7570 6461 7465       self.update
+0002b350: 5f76 6965 775f 7072 6f6a 6563 7469 6f6e  _view_projection
+0002b360: 5f6d 6174 7269 7828 290d 0a0d 0a20 2020  _matrix()....   
+0002b370: 2040 7374 6174 6963 6d65 7468 6f64 0d0a   @staticmethod..
+0002b380: 2020 2020 6465 6620 6372 6561 7465 5f70      def create_p
+0002b390: 6572 7370 6563 7469 7665 5f6d 6174 7269  erspective_matri
+0002b3a0: 7828 666f 762c 2061 7370 6563 745f 7261  x(fov, aspect_ra
+0002b3b0: 7469 6f2c 206e 6561 722c 2066 6172 293a  tio, near, far):
+0002b3c0: 0d0a 2020 2020 2020 2020 5320 3d20 3120  ..        S = 1 
+0002b3d0: 2f20 286e 702e 7461 6e28 302e 3520 2a20  / (np.tan(0.5 * 
+0002b3e0: 666f 7620 2f20 3138 302e 3020 2a20 6e70  fov / 180.0 * np
+0002b3f0: 2e70 6929 290d 0a20 2020 2020 2020 2066  .pi))..        f
+0002b400: 203d 2066 6172 0d0a 2020 2020 2020 2020   = far..        
+0002b410: 6e20 3d20 6e65 6172 0d0a 0d0a 2020 2020  n = near....    
+0002b420: 2020 2020 7072 6f6a 6563 7469 6f6e 5f6d      projection_m
+0002b430: 6174 7269 7820 3d20 6e70 2e7a 6572 6f73  atrix = np.zeros
+0002b440: 2828 342c 2034 2929 0d0a 2020 2020 2020  ((4, 4))..      
+0002b450: 2020 7072 6f6a 6563 7469 6f6e 5f6d 6174    projection_mat
+0002b460: 7269 785b 302c 2030 5d20 3d20 5320 2f20  rix[0, 0] = S / 
+0002b470: 6173 7065 6374 5f72 6174 696f 0d0a 2020  aspect_ratio..  
+0002b480: 2020 2020 2020 7072 6f6a 6563 7469 6f6e        projection
+0002b490: 5f6d 6174 7269 785b 312c 2031 5d20 3d20  _matrix[1, 1] = 
+0002b4a0: 530d 0a20 2020 2020 2020 2070 726f 6a65  S..        proje
+0002b4b0: 6374 696f 6e5f 6d61 7472 6978 5b32 2c20  ction_matrix[2, 
+0002b4c0: 325d 203d 202d 6620 2f20 2866 202d 206e  2] = -f / (f - n
+0002b4d0: 290d 0a20 2020 2020 2020 2070 726f 6a65  )..        proje
+0002b4e0: 6374 696f 6e5f 6d61 7472 6978 5b33 2c20  ction_matrix[3, 
+0002b4f0: 325d 203d 202d 310d 0a20 2020 2020 2020  2] = -1..       
+0002b500: 2070 726f 6a65 6374 696f 6e5f 6d61 7472   projection_matr
+0002b510: 6978 5b32 2c20 335d 203d 202d 6620 2a20  ix[2, 3] = -f * 
+0002b520: 6e20 2f20 2866 202d 206e 290d 0a0d 0a20  n / (f - n).... 
+0002b530: 2020 2020 2020 2072 6574 7572 6e20 7072         return pr
+0002b540: 6f6a 6563 7469 6f6e 5f6d 6174 7269 780d  ojection_matrix.
+0002b550: 0a0d 0a20 2020 2064 6566 2075 7064 6174  ...    def updat
+0002b560: 655f 7669 6577 5f70 726f 6a65 6374 696f  e_view_projectio
+0002b570: 6e5f 6d61 7472 6978 2873 656c 6629 3a0d  n_matrix(self):.
+0002b580: 0a20 2020 2020 2020 2065 7965 5f70 6f73  .        eye_pos
+0002b590: 6974 696f 6e20 3d20 7365 6c66 2e63 616c  ition = self.cal
+0002b5a0: 6375 6c61 7465 5f72 656c 6174 6976 655f  culate_relative_
+0002b5b0: 706f 7369 7469 6f6e 2873 656c 662e 666f  position(self.fo
+0002b5c0: 6375 732c 2073 656c 662e 7069 7463 682c  cus, self.pitch,
+0002b5d0: 2073 656c 662e 7961 772c 2073 656c 662e   self.yaw, self.
+0002b5e0: 6469 7374 616e 6365 290d 0a20 2020 2020  distance)..     
+0002b5f0: 2020 2073 656c 662e 7669 6577 5f6d 6174     self.view_mat
+0002b600: 7269 7820 3d20 7365 6c66 2e63 7265 6174  rix = self.creat
+0002b610: 655f 6c6f 6f6b 5f61 745f 6d61 7472 6978  e_look_at_matrix
+0002b620: 2865 7965 5f70 6f73 6974 696f 6e2c 2073  (eye_position, s
+0002b630: 656c 662e 666f 6375 7329 0d0a 2020 2020  elf.focus)..    
+0002b640: 2020 2020 7365 6c66 2e76 6965 775f 7072      self.view_pr
+0002b650: 6f6a 6563 7469 6f6e 5f6d 6174 7269 7820  ojection_matrix 
+0002b660: 3d20 7365 6c66 2e70 726f 6a65 6374 696f  = self.projectio
+0002b670: 6e5f 6d61 7472 6978 2040 2073 656c 662e  n_matrix @ self.
+0002b680: 7669 6577 5f6d 6174 7269 780d 0a0d 0a20  view_matrix.... 
+0002b690: 2020 2064 6566 2067 6574 5f76 6965 775f     def get_view_
+0002b6a0: 6469 7265 6374 696f 6e28 7365 6c66 293a  direction(self):
+0002b6b0: 0d0a 2020 2020 2020 2020 6579 655f 706f  ..        eye_po
+0002b6c0: 7369 7469 6f6e 203d 2073 656c 662e 6361  sition = self.ca
+0002b6d0: 6c63 756c 6174 655f 7265 6c61 7469 7665  lculate_relative
+0002b6e0: 5f70 6f73 6974 696f 6e28 7365 6c66 2e66  _position(self.f
+0002b6f0: 6f63 7573 2c20 7365 6c66 2e70 6974 6368  ocus, self.pitch
+0002b700: 2c20 7365 6c66 2e79 6177 2c20 7365 6c66  , self.yaw, self
+0002b710: 2e64 6973 7461 6e63 6529 0d0a 2020 2020  .distance)..    
+0002b720: 2020 2020 666f 6375 735f 706f 7369 7469      focus_positi
+0002b730: 6f6e 203d 206e 702e 6172 7261 7928 7365  on = np.array(se
+0002b740: 6c66 2e66 6f63 7573 290d 0a20 2020 2020  lf.focus)..     
+0002b750: 2020 2076 6965 775f 6469 7220 3d20 6579     view_dir = ey
+0002b760: 655f 706f 7369 7469 6f6e 202d 2066 6f63  e_position - foc
+0002b770: 7573 5f70 6f73 6974 696f 6e0d 0a20 2020  us_position..   
+0002b780: 2020 2020 2076 6965 775f 6469 7220 2f3d       view_dir /=
+0002b790: 206e 702e 7375 6d28 7669 6577 5f64 6972   np.sum(view_dir
+0002b7a0: 2a2a 3229 2a2a 302e 350d 0a20 2020 2020  **2)**0.5..     
+0002b7b0: 2020 2072 6574 7572 6e20 7669 6577 5f64     return view_d
+0002b7c0: 6972 0d0a 0d0a 2020 2020 4073 7461 7469  ir....    @stati
+0002b7d0: 636d 6574 686f 640d 0a20 2020 2064 6566  cmethod..    def
+0002b7e0: 2063 616c 6375 6c61 7465 5f72 656c 6174   calculate_relat
+0002b7f0: 6976 655f 706f 7369 7469 6f6e 2862 6173  ive_position(bas
+0002b800: 655f 706f 7369 7469 6f6e 2c20 7069 7463  e_position, pitc
+0002b810: 682c 2079 6177 2c20 6469 7374 616e 6365  h, yaw, distance
+0002b820: 293a 0d0a 2020 2020 2020 2020 636f 735f  ):..        cos_
+0002b830: 7069 7463 6820 3d20 6e70 2e63 6f73 286e  pitch = np.cos(n
+0002b840: 702e 7261 6469 616e 7328 7069 7463 6829  p.radians(pitch)
+0002b850: 290d 0a20 2020 2020 2020 2073 696e 5f70  )..        sin_p
+0002b860: 6974 6368 203d 206e 702e 7369 6e28 6e70  itch = np.sin(np
+0002b870: 2e72 6164 6961 6e73 2870 6974 6368 2929  .radians(pitch))
+0002b880: 0d0a 2020 2020 2020 2020 636f 735f 7961  ..        cos_ya
+0002b890: 7720 3d20 6e70 2e63 6f73 286e 702e 7261  w = np.cos(np.ra
+0002b8a0: 6469 616e 7328 7961 7729 290d 0a20 2020  dians(yaw))..   
+0002b8b0: 2020 2020 2073 696e 5f79 6177 203d 206e       sin_yaw = n
+0002b8c0: 702e 7369 6e28 6e70 2e72 6164 6961 6e73  p.sin(np.radians
+0002b8d0: 2879 6177 2929 0d0a 0d0a 2020 2020 2020  (yaw))....      
+0002b8e0: 2020 666f 7277 6172 6420 3d20 6e70 2e61    forward = np.a
+0002b8f0: 7272 6179 285b 0d0a 2020 2020 2020 2020  rray([..        
+0002b900: 2020 2020 636f 735f 7069 7463 6820 2a20      cos_pitch * 
+0002b910: 7369 6e5f 7961 772c 0d0a 2020 2020 2020  sin_yaw,..      
+0002b920: 2020 2020 2020 7369 6e5f 7069 7463 682c        sin_pitch,
+0002b930: 0d0a 2020 2020 2020 2020 2020 2020 2d63  ..            -c
+0002b940: 6f73 5f70 6974 6368 202a 2063 6f73 5f79  os_pitch * cos_y
+0002b950: 6177 0d0a 2020 2020 2020 2020 5d29 0d0a  aw..        ])..
+0002b960: 2020 2020 2020 2020 666f 7277 6172 6420          forward 
+0002b970: 3d20 666f 7277 6172 6420 2f20 6e70 2e6c  = forward / np.l
+0002b980: 696e 616c 672e 6e6f 726d 2866 6f72 7761  inalg.norm(forwa
+0002b990: 7264 290d 0a0d 0a20 2020 2020 2020 2072  rd)....        r
+0002b9a0: 656c 6174 6976 655f 706f 7369 7469 6f6e  elative_position
+0002b9b0: 203d 2062 6173 655f 706f 7369 7469 6f6e   = base_position
+0002b9c0: 202b 2066 6f72 7761 7264 202a 2064 6973   + forward * dis
+0002b9d0: 7461 6e63 650d 0a0d 0a20 2020 2020 2020  tance....       
+0002b9e0: 2072 6574 7572 6e20 7265 6c61 7469 7665   return relative
+0002b9f0: 5f70 6f73 6974 696f 6e0d 0a0d 0a20 2020  _position....   
+0002ba00: 2040 7374 6174 6963 6d65 7468 6f64 0d0a   @staticmethod..
+0002ba10: 2020 2020 6465 6620 6372 6561 7465 5f6c      def create_l
+0002ba20: 6f6f 6b5f 6174 5f6d 6174 7269 7828 6579  ook_at_matrix(ey
+0002ba30: 652c 2070 6f73 6974 696f 6e29 3a0d 0a20  e, position):.. 
+0002ba40: 2020 2020 2020 2066 6f72 7761 7264 203d         forward =
+0002ba50: 2043 616d 6572 6133 442e 6e6f 726d 616c   Camera3D.normal
+0002ba60: 697a 6528 706f 7369 7469 6f6e 202d 2065  ize(position - e
+0002ba70: 7965 290d 0a20 2020 2020 2020 2072 6967  ye)..        rig
+0002ba80: 6874 203d 2043 616d 6572 6133 442e 6e6f  ht = Camera3D.no
+0002ba90: 726d 616c 697a 6528 6e70 2e63 726f 7373  rmalize(np.cross
+0002baa0: 2866 6f72 7761 7264 2c20 6e70 2e61 7272  (forward, np.arr
+0002bab0: 6179 285b 302c 2031 2c20 305d 2929 290d  ay([0, 1, 0]))).
+0002bac0: 0a20 2020 2020 2020 2075 7020 3d20 6e70  .        up = np
+0002bad0: 2e63 726f 7373 2872 6967 6874 2c20 666f  .cross(right, fo
+0002bae0: 7277 6172 6429 0d0a 0d0a 2020 2020 2020  rward)....      
+0002baf0: 2020 6c6f 6f6b 5f61 745f 6d61 7472 6978    look_at_matrix
+0002bb00: 203d 206e 702e 6579 6528 3429 0d0a 2020   = np.eye(4)..  
+0002bb10: 2020 2020 2020 6c6f 6f6b 5f61 745f 6d61        look_at_ma
+0002bb20: 7472 6978 5b30 2c20 3a33 5d20 3d20 7269  trix[0, :3] = ri
+0002bb30: 6768 740d 0a20 2020 2020 2020 206c 6f6f  ght..        loo
+0002bb40: 6b5f 6174 5f6d 6174 7269 785b 312c 203a  k_at_matrix[1, :
+0002bb50: 335d 203d 2075 700d 0a20 2020 2020 2020  3] = up..       
+0002bb60: 206c 6f6f 6b5f 6174 5f6d 6174 7269 785b   look_at_matrix[
+0002bb70: 322c 203a 335d 203d 202d 666f 7277 6172  2, :3] = -forwar
+0002bb80: 640d 0a20 2020 2020 2020 206c 6f6f 6b5f  d..        look_
+0002bb90: 6174 5f6d 6174 7269 785b 3a33 2c20 335d  at_matrix[:3, 3]
+0002bba0: 203d 202d 6e70 2e64 6f74 286c 6f6f 6b5f   = -np.dot(look_
+0002bbb0: 6174 5f6d 6174 7269 785b 3a33 2c20 3a33  at_matrix[:3, :3
+0002bbc0: 5d2c 2065 7965 290d 0a20 2020 2020 2020  ], eye)..       
+0002bbd0: 2072 6574 7572 6e20 6c6f 6f6b 5f61 745f   return look_at_
+0002bbe0: 6d61 7472 6978 0d0a 0d0a 2020 2020 4073  matrix....    @s
+0002bbf0: 7461 7469 636d 6574 686f 640d 0a20 2020  taticmethod..   
+0002bc00: 2064 6566 206e 6f72 6d61 6c69 7a65 2876   def normalize(v
+0002bc10: 293a 0d0a 2020 2020 2020 2020 6e6f 726d  ):..        norm
+0002bc20: 203d 206e 702e 6c69 6e61 6c67 2e6e 6f72   = np.linalg.nor
+0002bc30: 6d28 7629 0d0a 2020 2020 2020 2020 6966  m(v)..        if
+0002bc40: 206e 6f72 6d20 3d3d 2030 3a0d 0a20 2020   norm == 0:..   
+0002bc50: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0002bc60: 760d 0a20 2020 2020 2020 2072 6574 7572  v..        retur
+0002bc70: 6e20 7620 2f20 6e6f 726d 0d0a 0d0a 0d0a  n v / norm......
+0002bc80: 636c 6173 7320 5175 6575 6564 4578 706f  class QueuedExpo
+0002bc90: 7274 3a0d 0a20 2020 2064 6566 205f 5f69  rt:..    def __i
+0002bca0: 6e69 745f 5f28 7365 6c66 2c20 6469 7265  nit__(self, dire
+0002bcb0: 6374 6f72 792c 2064 6174 6173 6574 2c20  ctory, dataset, 
+0002bcc0: 6d6f 6465 6c73 2c20 6261 7463 685f 7369  models, batch_si
+0002bcd0: 7a65 2c20 6578 706f 7274 5f6f 7665 726c  ze, export_overl
+0002bce0: 6179 293a 0d0a 2020 2020 2020 2020 7365  ay):..        se
+0002bcf0: 6c66 2e74 6167 203d 2064 6174 6173 6574  lf.tag = dataset
+0002bd00: 2e70 6174 680d 0a20 2020 2020 2020 2073  .path..        s
+0002bd10: 656c 662e 6469 7265 6374 6f72 7920 3d20  elf.directory = 
+0002bd20: 6469 7265 6374 6f72 790d 0a20 2020 2020  directory..     
+0002bd30: 2020 2073 656c 662e 6461 7461 7365 7420     self.dataset 
+0002bd40: 3d20 6461 7461 7365 740d 0a20 2020 2020  = dataset..     
+0002bd50: 2020 2073 656c 662e 6d6f 6465 6c73 203d     self.models =
+0002bd60: 206d 6f64 656c 730d 0a20 2020 2020 2020   models..       
+0002bd70: 2073 656c 662e 6578 706f 7274 5f6f 7665   self.export_ove
+0002bd80: 726c 6179 203d 2065 7870 6f72 745f 6f76  rlay = export_ov
+0002bd90: 6572 6c61 790d 0a20 2020 2020 2020 2073  erlay..        s
+0002bda0: 656c 662e 7072 6f63 6573 7320 3d20 4261  elf.process = Ba
+0002bdb0: 636b 6772 6f75 6e64 5072 6f63 6573 7328  ckgroundProcess(
+0002bdc0: 7365 6c66 2e64 6f5f 6578 706f 7274 2c20  self.do_export, 
+0002bdd0: 2829 2c20 6e61 6d65 3d66 227b 7365 6c66  (), name=f"{self
+0002bde0: 2e64 6174 6173 6574 2e74 6974 6c65 7d20  .dataset.title} 
+0002bdf0: 6578 706f 7274 2229 0d0a 2020 2020 2020  export")..      
+0002be00: 2020 6966 2073 656c 662e 6d6f 6465 6c73    if self.models
+0002be10: 2021 3d20 5b5d 3a0d 0a20 2020 2020 2020   != []:..       
+0002be20: 2020 2020 2073 656c 662e 636f 6c6f 7572       self.colour
+0002be30: 203d 2073 656c 662e 6d6f 6465 6c73 5b30   = self.models[0
+0002be40: 5d2e 636f 6c6f 7572 0d0a 2020 2020 2020  ].colour..      
+0002be50: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+0002be60: 2020 2020 2073 656c 662e 636f 6c6f 7572       self.colour
+0002be70: 203d 2028 302e 302c 2030 2e30 2c20 302e   = (0.0, 0.0, 0.
+0002be80: 3029 0d0a 2020 2020 2020 2020 7365 6c66  0)..        self
+0002be90: 2e62 6174 6368 5f73 697a 6520 3d20 6261  .batch_size = ba
+0002bea0: 7463 685f 7369 7a65 0d0a 0d0a 2020 2020  tch_size....    
+0002beb0: 6465 6620 646f 5f65 7870 6f72 7428 7365  def do_export(se
+0002bec0: 6c66 2c20 7072 6f63 6573 7329 3a0d 0a20  lf, process):.. 
+0002bed0: 2020 2020 2020 2074 7279 3a0d 0a20 2020         try:..   
+0002bee0: 2020 2020 2020 2020 2070 726f 6365 7373           process
+0002bef0: 2e73 6574 5f70 726f 6772 6573 7328 302e  .set_progress(0.
+0002bf00: 3030 3031 290d 0a20 2020 2020 2020 2020  0001)..         
+0002bf10: 2020 2073 7461 7274 5f74 696d 6520 3d20     start_time = 
+0002bf20: 7469 6d65 2e74 696d 6528 290d 0a20 2020  time.time()..   
+0002bf30: 2020 2020 2020 2020 2070 7269 6e74 2866           print(f
+0002bf40: 2251 7565 7565 6445 7870 6f72 7420 2d20  "QueuedExport - 
+0002bf50: 6c6f 6164 696e 6720 6461 7461 7365 7420  loading dataset 
+0002bf60: 7b73 656c 662e 6461 7461 7365 742e 7061  {self.dataset.pa
+0002bf70: 7468 7d22 290d 0a20 2020 2020 2020 2020  th}")..         
+0002bf80: 2020 2072 782c 2072 7920 3d20 7365 6c66     rx, ry = self
+0002bf90: 2e64 6174 6173 6574 2e67 6574 5f72 6f69  .dataset.get_roi
+0002bfa0: 5f69 6e64 6963 6573 2829 0d0a 2020 2020  _indices()..    
+0002bfb0: 2020 2020 2020 2020 6d72 6364 203d 206e          mrcd = n
+0002bfc0: 702e 6172 7261 7928 6d72 6366 696c 652e  p.array(mrcfile.
+0002bfd0: 6f70 656e 2873 656c 662e 6461 7461 7365  open(self.datase
+0002bfe0: 742e 7061 7468 2c20 6d6f 6465 3d27 7227  t.path, mode='r'
+0002bff0: 2c20 7065 726d 6973 7369 7665 3d54 7275  , permissive=Tru
+0002c000: 6529 2e64 6174 615b 3a2c 203a 2c20 3a5d  e).data[:, :, :]
+0002c010: 290d 0a20 2020 2020 2020 2020 2020 2074  )..            t
+0002c020: 6172 6765 745f 7479 7065 5f64 6963 7420  arget_type_dict 
+0002c030: 3d20 7b6e 702e 666c 6f61 7433 323a 206e  = {np.float32: n
+0002c040: 702e 6474 7970 6528 2766 6c6f 6174 3332  p.dtype('float32
+0002c050: 2729 2c20 666c 6f61 743a 206e 702e 6474  '), float: np.dt
+0002c060: 7970 6528 2766 6c6f 6174 3332 2729 2c20  ype('float32'), 
+0002c070: 6e70 2e64 7479 7065 2827 696e 7438 2729  np.dtype('int8')
+0002c080: 3a20 6e70 2e64 7479 7065 2827 7569 6e74  : np.dtype('uint
+0002c090: 3827 292c 206e 702e 6474 7970 6528 2769  8'), np.dtype('i
+0002c0a0: 6e74 3136 2729 3a20 6e70 2e64 7479 7065  nt16'): np.dtype
+0002c0b0: 2827 666c 6f61 7433 3227 297d 0d0a 2020  ('float32')}..  
+0002c0c0: 2020 2020 2020 2020 2020 6966 206d 7263            if mrc
+0002c0d0: 642e 6474 7970 6520 6e6f 7420 696e 2074  d.dtype not in t
+0002c0e0: 6172 6765 745f 7479 7065 5f64 6963 743a  arget_type_dict:
+0002c0f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0002c100: 2020 6d72 6364 203d 206d 7263 642e 6173    mrcd = mrcd.as
+0002c110: 7479 7065 2866 6c6f 6174 2c20 636f 7079  type(float, copy
+0002c120: 3d46 616c 7365 290d 0a20 2020 2020 2020  =False)..       
+0002c130: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+0002c140: 2020 2020 2020 2020 2020 2020 6d72 6364              mrcd
+0002c150: 203d 206e 702e 6172 7261 7928 6d72 6364   = np.array(mrcd
+0002c160: 2e61 7374 7970 6528 7461 7267 6574 5f74  .astype(target_t
+0002c170: 7970 655f 6469 6374 5b6d 7263 642e 6474  ype_dict[mrcd.dt
+0002c180: 7970 655d 2c20 636f 7079 3d46 616c 7365  ype], copy=False
+0002c190: 292c 2064 7479 7065 3d6e 702e 6474 7970  ), dtype=np.dtyp
+0002c1a0: 6528 2766 6c6f 6174 3332 2729 290d 0a20  e('float32')).. 
+0002c1b0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0002c1c0: 6368 6563 6b5f 7374 6f70 5f72 6571 7565  check_stop_reque
+0002c1d0: 7374 2829 0d0a 2020 2020 2020 2020 2020  st()..          
+0002c1e0: 2020 6e5f 736c 6963 6573 203d 206d 7263    n_slices = mrc
+0002c1f0: 642e 7368 6170 655b 305d 0d0a 2020 2020  d.shape[0]..    
+0002c200: 2020 2020 2020 2020 6e5f 736c 6963 6573          n_slices
+0002c210: 5f74 6f74 616c 203d 2028 7365 6c66 2e64  _total = (self.d
+0002c220: 6174 6173 6574 2e65 7870 6f72 745f 746f  ataset.export_to
+0002c230: 7020 2d20 7365 6c66 2e64 6174 6173 6574  p - self.dataset
+0002c240: 2e65 7870 6f72 745f 626f 7474 6f6d 2920  .export_bottom) 
+0002c250: 2a20 6d61 7828 312c 206c 656e 2873 656c  * max(1, len(sel
+0002c260: 662e 6d6f 6465 6c73 2929 0d0a 2020 2020  f.models))..    
+0002c270: 2020 2020 2020 2020 6e5f 736c 6963 6573          n_slices
+0002c280: 5f63 6f6d 706c 6574 6520 3d20 300d 0a20  _complete = 0.. 
+0002c290: 2020 2020 2020 2020 2020 2073 6567 6d65             segme
+0002c2a0: 6e74 6174 696f 6e73 203d 206e 702e 7a65  ntations = np.ze
+0002c2b0: 726f 7328 286c 656e 2873 656c 662e 6d6f  ros((len(self.mo
+0002c2c0: 6465 6c73 292c 202a 6d72 6364 2e73 6861  dels), *mrcd.sha
+0002c2d0: 7065 292c 2064 7479 7065 3d6e 702e 7569  pe), dtype=np.ui
+0002c2e0: 6e74 3829 0d0a 2020 2020 2020 2020 2020  nt8)..          
+0002c2f0: 2020 6d5f 6964 7820 3d20 300d 0a20 2020    m_idx = 0..   
+0002c300: 2020 2020 2020 2020 2066 6f72 206d 2069           for m i
+0002c310: 6e20 7365 6c66 2e6d 6f64 656c 733a 0d0a  n self.models:..
+0002c320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c330: 7072 696e 7428 6622 5175 6575 6564 4578  print(f"QueuedEx
+0002c340: 706f 7274 202d 2061 7070 6c79 696e 6720  port - applying 
+0002c350: 6d6f 6465 6c20 7b6d 2e74 6974 6c65 7d20  model {m.title} 
+0002c360: 287b 6d2e 696e 666f 7d29 2229 0d0a 2020  ({m.info})")..  
+0002c370: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0002c380: 6c66 2e63 6f6c 6f75 7220 3d20 6d2e 636f  lf.colour = m.co
+0002c390: 6c6f 7572 0d0a 2020 2020 2020 2020 2020  lour..          
+0002c3a0: 2020 2020 2020 736c 6963 6573 5f74 6f5f        slices_to_
+0002c3b0: 7072 6f63 6573 7320 3d20 6c69 7374 2872  process = list(r
+0002c3c0: 616e 6765 2873 656c 662e 6461 7461 7365  ange(self.datase
+0002c3d0: 742e 6578 706f 7274 5f62 6f74 746f 6d2c  t.export_bottom,
+0002c3e0: 2073 656c 662e 6461 7461 7365 742e 6578   self.dataset.ex
+0002c3f0: 706f 7274 5f74 6f70 2929 0d0a 2020 2020  port_top))..    
+0002c400: 2020 2020 2020 2020 2020 2020 7768 696c              whil
+0002c410: 6520 6c65 6e28 736c 6963 6573 5f74 6f5f  e len(slices_to_
+0002c420: 7072 6f63 6573 7329 203e 2030 3a0d 0a20  process) > 0:.. 
+0002c430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c440: 2020 2073 656c 662e 6368 6563 6b5f 7374     self.check_st
+0002c450: 6f70 5f72 6571 7565 7374 2829 0d0a 2020  op_request()..  
+0002c460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c470: 2020 696e 6469 6365 7320 3d20 6c69 7374    indices = list
+0002c480: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
+0002c490: 2020 2020 2020 2020 696d 6167 6573 203d          images =
+0002c4a0: 206c 6973 7428 290d 0a20 2020 2020 2020   list()..       
+0002c4b0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+0002c4c0: 2069 2069 6e20 7261 6e67 6528 7365 6c66   i in range(self
+0002c4d0: 2e62 6174 6368 5f73 697a 6529 3a0d 0a20  .batch_size):.. 
+0002c4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c4f0: 2020 2020 2020 2069 6620 6c65 6e28 736c         if len(sl
+0002c500: 6963 6573 5f74 6f5f 7072 6f63 6573 7329  ices_to_process)
+0002c510: 203e 2030 3a0d 0a20 2020 2020 2020 2020   > 0:..         
+0002c520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c530: 2020 2069 6e64 6963 6573 2e61 7070 656e     indices.appen
+0002c540: 6428 736c 6963 6573 5f74 6f5f 7072 6f63  d(slices_to_proc
+0002c550: 6573 732e 706f 7028 3029 290d 0a20 2020  ess.pop(0))..   
+0002c560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c570: 2020 2020 2020 2020 2069 6d61 6765 732e           images.
+0002c580: 6170 7065 6e64 286d 7263 645b 696e 6469  append(mrcd[indi
+0002c590: 6365 735b 2d31 5d2c 2072 785b 305d 3a72  ces[-1], rx[0]:r
+0002c5a0: 785b 315d 2c20 7279 5b30 5d3a 7279 5b31  x[1], ry[0]:ry[1
+0002c5b0: 5d5d 290d 0a20 2020 2020 2020 2020 2020  ]])..           
+0002c5c0: 2020 2020 2020 2020 2073 6567 5f69 6d61           seg_ima
+0002c5d0: 6765 7320 3d20 6d2e 6170 706c 795f 746f  ges = m.apply_to
+0002c5e0: 5f6d 756c 7469 706c 655f 736c 6963 6573  _multiple_slices
+0002c5f0: 2869 6d61 6765 732c 2073 656c 662e 6461  (images, self.da
+0002c600: 7461 7365 742e 7069 7865 6c5f 7369 7a65  taset.pixel_size
+0002c610: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0002c620: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
+0002c630: 7261 6e67 6528 6c65 6e28 696e 6469 6365  range(len(indice
+0002c640: 7329 293a 0d0a 2020 2020 2020 2020 2020  s)):..          
+0002c650: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0002c660: 676d 656e 7461 7469 6f6e 735b 6d5f 6964  gmentations[m_id
+0002c670: 782c 2069 6e64 6963 6573 5b69 5d2c 2072  x, indices[i], r
+0002c680: 785b 305d 3a72 785b 315d 2c20 7279 5b30  x[0]:rx[1], ry[0
+0002c690: 5d3a 7279 5b31 5d5d 203d 2028 7365 675f  ]:ry[1]] = (seg_
+0002c6a0: 696d 6167 6573 5b69 5d20 2a20 3235 3529  images[i] * 255)
+0002c6b0: 2e61 7374 7970 6528 6e70 2e75 696e 7438  .astype(np.uint8
+0002c6c0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0002c6d0: 2020 2020 2020 2020 2020 206e 5f73 6c69             n_sli
+0002c6e0: 6365 735f 636f 6d70 6c65 7465 202b 3d20  ces_complete += 
+0002c6f0: 310d 0a20 2020 2020 2020 2020 2020 2020  1..             
+0002c700: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0002c710: 7072 6f63 6573 732e 7365 745f 7072 6f67  process.set_prog
+0002c720: 7265 7373 286d 696e 285b 302e 3939 392c  ress(min([0.999,
+0002c730: 206e 5f73 6c69 6365 735f 636f 6d70 6c65   n_slices_comple
+0002c740: 7465 202f 206e 5f73 6c69 6365 735f 746f  te / n_slices_to
+0002c750: 7461 6c5d 2929 0d0a 0d0a 2020 2020 2020  tal]))....      
+0002c760: 2020 2020 2020 2020 2020 6d5f 6964 7820            m_idx 
+0002c770: 2b3d 2031 0d0a 2020 2020 2020 2020 2020  += 1..          
+0002c780: 2020 7365 6c66 2e63 6865 636b 5f73 746f    self.check_sto
+0002c790: 705f 7265 7175 6573 7428 290d 0a20 2020  p_request()..   
+0002c7a0: 2020 2020 2020 2020 2023 2061 7070 6c79           # apply
+0002c7b0: 2063 6f6d 7065 7469 7469 6f6e 0d0a 2020   competition..  
+0002c7c0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+0002c7d0: 6622 5175 6575 6564 4578 706f 7274 202d  f"QueuedExport -
+0002c7e0: 206d 6f64 656c 2063 6f6d 7065 7469 7469   model competiti
+0002c7f0: 6f6e 2229 0d0a 2020 2020 2020 2020 2020  on")..          
+0002c800: 2020 656d 6973 7369 6f6e 5f69 6e64 6963    emission_indic
+0002c810: 6573 203d 206c 6973 7428 290d 0a20 2020  es = list()..   
+0002c820: 2020 2020 2020 2020 2061 6273 6f72 7074           absorpt
+0002c830: 696f 6e5f 696e 6469 6365 7320 3d20 6c69  ion_indices = li
+0002c840: 7374 2829 0d0a 2020 2020 2020 2020 2020  st()..          
+0002c850: 2020 6920 3d20 300d 0a20 2020 2020 2020    i = 0..       
+0002c860: 2020 2020 2066 6f72 206d 2069 6e20 7365       for m in se
+0002c870: 6c66 2e6d 6f64 656c 733a 0d0a 2020 2020  lf.models:..    
+0002c880: 2020 2020 2020 2020 2020 2020 6966 206d              if m
+0002c890: 2e65 6d69 743a 0d0a 2020 2020 2020 2020  .emit:..        
+0002c8a0: 2020 2020 2020 2020 2020 2020 656d 6973              emis
+0002c8b0: 7369 6f6e 5f69 6e64 6963 6573 2e61 7070  sion_indices.app
+0002c8c0: 656e 6428 6929 0d0a 2020 2020 2020 2020  end(i)..        
+0002c8d0: 2020 2020 2020 2020 6966 206d 2e61 6273          if m.abs
+0002c8e0: 6f72 623a 0d0a 2020 2020 2020 2020 2020  orb:..          
+0002c8f0: 2020 2020 2020 2020 2020 6162 736f 7270            absorp
+0002c900: 7469 6f6e 5f69 6e64 6963 6573 2e61 7070  tion_indices.app
+0002c910: 656e 6428 6929 0d0a 2020 2020 2020 2020  end(i)..        
+0002c920: 2020 2020 2020 2020 6920 2b3d 2031 0d0a          i += 1..
+0002c930: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+0002c940: 656e 2865 6d69 7373 696f 6e5f 696e 6469  en(emission_indi
+0002c950: 6365 7329 203e 3d20 3120 616e 6420 6c65  ces) >= 1 and le
+0002c960: 6e28 6162 736f 7270 7469 6f6e 5f69 6e64  n(absorption_ind
+0002c970: 6963 6573 2920 3e3d 2031 3a0d 0a20 2020  ices) >= 1:..   
+0002c980: 2020 2020 2020 2020 2020 2020 206d 6178               max
+0002c990: 5f6d 6170 203d 206e 702e 6d61 7828 7365  _map = np.max(se
+0002c9a0: 676d 656e 7461 7469 6f6e 735b 656d 6973  gmentations[emis
+0002c9b0: 7369 6f6e 5f69 6e64 6963 6573 2c20 3a2c  sion_indices, :,
+0002c9c0: 203a 2c20 3a5d 2c20 6178 6973 3d30 290d   :, :], axis=0).
+0002c9d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002c9e0: 2066 6f72 2069 2069 6e20 6162 736f 7270   for i in absorp
+0002c9f0: 7469 6f6e 5f69 6e64 6963 6573 3a0d 0a20  tion_indices:.. 
+0002ca00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ca10: 2020 2073 656c 662e 6368 6563 6b5f 7374     self.check_st
+0002ca20: 6f70 5f72 6571 7565 7374 2829 0d0a 2020  op_request()..  
+0002ca30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ca40: 2020 7365 676d 656e 7461 7469 6f6e 735b    segmentations[
+0002ca50: 692c 203a 2c20 3a2c 203a 5d5b 7365 676d  i, :, :, :][segm
+0002ca60: 656e 7461 7469 6f6e 735b 692c 203a 2c20  entations[i, :, 
+0002ca70: 3a2c 203a 5d20 3c20 6d61 785f 6d61 705d  :, :] < max_map]
+0002ca80: 203d 2030 0d0a 0d0a 2020 2020 2020 2020   = 0....        
+0002ca90: 2020 2020 2320 6170 706c 7920 696e 7465      # apply inte
+0002caa0: 7261 6374 696f 6e73 0d0a 2020 2020 2020  ractions..      
+0002cab0: 2020 2020 2020 7072 696e 7428 6622 5175        print(f"Qu
+0002cac0: 6575 6564 4578 706f 7274 202d 206d 6f64  euedExport - mod
+0002cad0: 656c 2069 6e74 6572 6163 7469 6f6e 7322  el interactions"
+0002cae0: 290d 0a20 2020 2020 2020 2020 2020 2066  )..            f
+0002caf0: 6f72 2069 6e74 6572 6163 7469 6f6e 2069  or interaction i
+0002cb00: 6e20 4d6f 6465 6c49 6e74 6572 6163 7469  n ModelInteracti
+0002cb10: 6f6e 2e61 6c6c 3a0d 0a20 2020 2020 2020  on.all:..       
+0002cb20: 2020 2020 2020 2020 2074 6172 6765 745f           target_
+0002cb30: 6d6f 6465 6c20 3d20 696e 7465 7261 6374  model = interact
+0002cb40: 696f 6e2e 7061 7265 6e74 0d0a 2020 2020  ion.parent..    
+0002cb50: 2020 2020 2020 2020 2020 2020 736f 7572              sour
+0002cb60: 6365 5f6d 6f64 656c 203d 2069 6e74 6572  ce_model = inter
+0002cb70: 6163 7469 6f6e 2e70 6172 746e 6572 0d0a  action.partner..
+0002cb80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cb90: 6966 2074 6172 6765 745f 6d6f 6465 6c20  if target_model 
+0002cba0: 696e 2073 656c 662e 6d6f 6465 6c73 2061  in self.models a
+0002cbb0: 6e64 2073 6f75 7263 655f 6d6f 6465 6c20  nd source_model 
+0002cbc0: 696e 2073 656c 662e 6d6f 6465 6c73 3a0d  in self.models:.
+0002cbd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002cbe0: 2020 2020 2074 6172 6765 745f 6964 7820       target_idx 
+0002cbf0: 3d20 7365 6c66 2e6d 6f64 656c 732e 696e  = self.models.in
+0002cc00: 6465 7828 7461 7267 6574 5f6d 6f64 656c  dex(target_model
+0002cc10: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0002cc20: 2020 2020 2020 2073 6f75 7263 655f 6964         source_id
+0002cc30: 7820 3d20 7365 6c66 2e6d 6f64 656c 732e  x = self.models.
+0002cc40: 696e 6465 7828 736f 7572 6365 5f6d 6f64  index(source_mod
+0002cc50: 656c 290d 0a20 2020 2020 2020 2020 2020  el)..           
+0002cc60: 2020 2020 2020 2020 2066 6f72 2069 2069           for i i
+0002cc70: 6e20 7261 6e67 6528 7365 6c66 2e64 6174  n range(self.dat
+0002cc80: 6173 6574 2e65 7870 6f72 745f 626f 7474  aset.export_bott
+0002cc90: 6f6d 2c20 7365 6c66 2e64 6174 6173 6574  om, self.dataset
+0002cca0: 2e65 7870 6f72 745f 746f 7029 3a0d 0a20  .export_top):.. 
+0002ccb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ccc0: 2020 2020 2020 2073 656c 662e 6368 6563         self.chec
+0002ccd0: 6b5f 7374 6f70 5f72 6571 7565 7374 2829  k_stop_request()
+0002cce0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0002ccf0: 2020 2020 2020 2020 2020 7365 676d 656e            segmen
+0002cd00: 7461 7469 6f6e 735b 7461 7267 6574 5f69  tations[target_i
+0002cd10: 6478 2c20 692c 203a 2c20 3a5d 203d 2069  dx, i, :, :] = i
+0002cd20: 6e74 6572 6163 7469 6f6e 2e61 7070 6c79  nteraction.apply
+0002cd30: 5f74 6f5f 696d 6167 6573 2873 656c 662e  _to_images(self.
+0002cd40: 6461 7461 7365 742e 7069 7865 6c5f 7369  dataset.pixel_si
+0002cd50: 7a65 2c20 7365 676d 656e 7461 7469 6f6e  ze, segmentation
+0002cd60: 735b 736f 7572 6365 5f69 6478 2c20 692c  s[source_idx, i,
+0002cd70: 203a 2c20 3a5d 2c20 7365 676d 656e 7461   :, :], segmenta
+0002cd80: 7469 6f6e 735b 7461 7267 6574 5f69 6478  tions[target_idx
+0002cd90: 2c20 692c 203a 2c20 3a5d 290d 0a0d 0a20  , i, :, :]).... 
+0002cda0: 2020 2020 2020 2020 2020 2023 2073 6176             # sav
+0002cdb0: 6520 7468 6520 6d72 6320 6669 6c65 730d  e the mrc files.
+0002cdc0: 0a20 2020 2020 2020 2020 2020 2069 203d  .            i =
+0002cdd0: 2030 0d0a 2020 2020 2020 2020 2020 2020   0..            
+0002cde0: 7365 6c66 2e63 6f6c 6f75 7220 3d20 6366  self.colour = cf
+0002cdf0: 672e 434f 4c4f 5552 5f50 4f53 4954 4956  g.COLOUR_POSITIV
+0002ce00: 455b 303a 335d 0d0a 2020 2020 2020 2020  E[0:3]..        
+0002ce10: 2020 2020 666f 7220 6d20 696e 2073 656c      for m in sel
+0002ce20: 662e 6d6f 6465 6c73 3a0d 0a20 2020 2020  f.models:..     
+0002ce30: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0002ce40: 6368 6563 6b5f 7374 6f70 5f72 6571 7565  check_stop_reque
+0002ce50: 7374 2829 0d0a 2020 2020 2020 2020 2020  st()..          
+0002ce60: 2020 2020 2020 7072 696e 7428 6622 5175        print(f"Qu
+0002ce70: 6575 6564 4578 706f 7274 202d 2073 6176  euedExport - sav
+0002ce80: 696e 6720 6f75 7470 7574 206f 6620 6d6f  ing output of mo
+0002ce90: 6465 6c20 7b6d 2e69 6e66 6f7d 2229 0d0a  del {m.info}")..
+0002cea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ceb0: 6f75 745f 7061 7468 203d 206f 732e 7061  out_path = os.pa
+0002cec0: 7468 2e6a 6f69 6e28 7365 6c66 2e64 6972  th.join(self.dir
+0002ced0: 6563 746f 7279 2c20 6f73 2e70 6174 682e  ectory, os.path.
+0002cee0: 7370 6c69 7465 7874 2873 656c 662e 6461  splitext(self.da
+0002cef0: 7461 7365 742e 7469 746c 6529 5b30 5d2b  taset.title)[0]+
+0002cf00: 225f 5f22 2b6d 2e74 6974 6c65 2b22 2e6d  "__"+m.title+".m
+0002cf10: 7263 2229 0d0a 2020 2020 2020 2020 2020  rc")..          
+0002cf20: 2020 2020 2020 7769 7468 206d 7263 6669        with mrcfi
+0002cf30: 6c65 2e6e 6577 286f 7574 5f70 6174 682c  le.new(out_path,
+0002cf40: 206f 7665 7277 7269 7465 3d54 7275 6529   overwrite=True)
+0002cf50: 2061 7320 6d72 633a 0d0a 2020 2020 2020   as mrc:..      
+0002cf60: 2020 2020 2020 2020 2020 2020 2020 7320                s 
+0002cf70: 3d20 7365 676d 656e 7461 7469 6f6e 735b  = segmentations[
+0002cf80: 692c 203a 2c20 3a2c 203a 5d2e 7371 7565  i, :, :, :].sque
+0002cf90: 657a 6528 290d 0a20 2020 2020 2020 2020  eze()..         
+0002cfa0: 2020 2020 2020 2020 2020 206d 7263 2e73             mrc.s
+0002cfb0: 6574 5f64 6174 6128 7329 0d0a 2020 2020  et_data(s)..    
+0002cfc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cfd0: 6d72 632e 766f 7865 6c5f 7369 7a65 203d  mrc.voxel_size =
+0002cfe0: 2073 656c 662e 6461 7461 7365 742e 7069   self.dataset.pi
+0002cff0: 7865 6c5f 7369 7a65 202a 2031 302e 300d  xel_size * 10.0.
+0002d000: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002d010: 206e 5f73 6c69 6365 735f 636f 6d70 6c65   n_slices_comple
+0002d020: 7465 202b 3d20 6e5f 736c 6963 6573 0d0a  te += n_slices..
+0002d030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d040: 6920 2b3d 2031 0d0a 0d0a 2020 2020 2020  i += 1....      
+0002d050: 2020 2020 2020 2320 6578 706f 7274 206f        # export o
+0002d060: 7665 726c 6179 0d0a 2020 2020 2020 2020  verlay..        
+0002d070: 2020 2020 7365 6c66 2e63 6865 636b 5f73      self.check_s
+0002d080: 746f 705f 7265 7175 6573 7428 290d 0a20  top_request().. 
+0002d090: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+0002d0a0: 6c66 2e65 7870 6f72 745f 6f76 6572 6c61  lf.export_overla
+0002d0b0: 7920 616e 6420 7365 6c66 2e64 6174 6173  y and self.datas
+0002d0c0: 6574 2e6f 7665 726c 6179 2069 7320 6e6f  et.overlay is no
+0002d0d0: 7420 4e6f 6e65 3a0d 0a20 2020 2020 2020  t None:..       
+0002d0e0: 2020 2020 2020 2020 2070 7269 6e74 2866           print(f
+0002d0f0: 2251 7565 7565 6445 7870 6f72 7420 2d20  "QueuedExport - 
+0002d100: 6578 706f 7274 696e 6720 6f76 6572 6c61  exporting overla
+0002d110: 7922 290d 0a20 2020 2020 2020 2020 2020  y")..           
+0002d120: 2020 2020 206f 7665 726c 6179 5f67 7261       overlay_gra
+0002d130: 7973 6361 6c65 203d 206e 702e 7375 6d28  yscale = np.sum(
+0002d140: 7365 6c66 2e64 6174 6173 6574 2e6f 7665  self.dataset.ove
+0002d150: 726c 6179 2e70 7864 202a 2a20 322c 2061  rlay.pxd ** 2, a
+0002d160: 7869 733d 3229 0d0a 2020 2020 2020 2020  xis=2)..        
+0002d170: 2020 2020 2020 2020 6f76 6572 6c61 795f          overlay_
+0002d180: 6772 6179 7363 616c 6520 2f3d 206e 702e  grayscale /= np.
+0002d190: 616d 6178 286f 7665 726c 6179 5f67 7261  amax(overlay_gra
+0002d1a0: 7973 6361 6c65 290d 0a20 2020 2020 2020  yscale)..       
+0002d1b0: 2020 2020 2020 2020 206f 7665 726c 6179           overlay
+0002d1c0: 5f67 7261 7973 6361 6c65 202a 3d20 3235  _grayscale *= 25
+0002d1d0: 350d 0a20 2020 2020 2020 2020 2020 2020  5..             
+0002d1e0: 2020 206f 7665 726c 6179 5f67 7261 7973     overlay_grays
+0002d1f0: 6361 6c65 202d 3d20 3132 380d 0a20 2020  cale -= 128..   
+0002d200: 2020 2020 2020 2020 2020 2020 206f 7665               ove
+0002d210: 726c 6179 5f67 7261 7973 6361 6c65 203d  rlay_grayscale =
+0002d220: 206f 7665 726c 6179 5f67 7261 7973 6361   overlay_graysca
+0002d230: 6c65 2e61 7374 7970 6528 6e70 2e69 6e74  le.astype(np.int
+0002d240: 3829 0d0a 2020 2020 2020 2020 2020 2020  8)..            
+0002d250: 2020 2020 6f76 6572 6c61 795f 766f 6c75      overlay_volu
+0002d260: 6d65 203d 206e 702e 7469 6c65 286f 7665  me = np.tile(ove
+0002d270: 726c 6179 5f67 7261 7973 6361 6c65 5b6e  rlay_grayscale[n
+0002d280: 702e 6e65 7761 7869 732c 203a 2c20 3a5d  p.newaxis, :, :]
+0002d290: 2c20 286e 5f73 6c69 6365 732c 2031 2c20  , (n_slices, 1, 
+0002d2a0: 3129 290d 0a20 2020 2020 2020 2020 2020  1))..           
+0002d2b0: 2020 2020 206f 7574 5f70 6174 6820 3d20       out_path = 
+0002d2c0: 6f73 2e70 6174 682e 6a6f 696e 2873 656c  os.path.join(sel
+0002d2d0: 662e 6469 7265 6374 6f72 792c 2073 656c  f.directory, sel
+0002d2e0: 662e 6461 7461 7365 742e 7469 746c 6520  f.dataset.title 
+0002d2f0: 2b20 225f 6f76 6572 6c61 792e 6d72 6322  + "_overlay.mrc"
+0002d300: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0002d310: 2020 2077 6974 6820 6d72 6366 696c 652e     with mrcfile.
+0002d320: 6e65 7728 6f75 745f 7061 7468 2c20 6f76  new(out_path, ov
+0002d330: 6572 7772 6974 653d 5472 7565 2920 6173  erwrite=True) as
+0002d340: 206d 7263 3a0d 0a20 2020 2020 2020 2020   mrc:..         
+0002d350: 2020 2020 2020 2020 2020 206d 7263 2e73             mrc.s
+0002d360: 6574 5f64 6174 6128 6f76 6572 6c61 795f  et_data(overlay_
+0002d370: 766f 6c75 6d65 290d 0a20 2020 2020 2020  volume)..       
+0002d380: 2020 2020 2020 2020 2020 2020 206d 7263               mrc
+0002d390: 2e76 6f78 656c 5f73 697a 6520 3d20 7365  .voxel_size = se
+0002d3a0: 6c66 2e64 6174 6173 6574 2e70 6978 656c  lf.dataset.pixel
+0002d3b0: 5f73 697a 6520 2a20 3130 2e30 0d0a 0d0a  _size * 10.0....
+0002d3c0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0002d3d0: 2e70 726f 6365 7373 2e73 6574 5f70 726f  .process.set_pro
+0002d3e0: 6772 6573 7328 312e 3029 0d0a 2020 2020  gress(1.0)..    
+0002d3f0: 2020 2020 2020 2020 7072 696e 7428 6622          print(f"
+0002d400: 5175 6575 6564 4578 706f 7274 202d 2064  QueuedExport - d
+0002d410: 6f6e 6521 2028 7b74 696d 652e 7469 6d65  one! ({time.time
+0002d420: 2829 202d 2073 7461 7274 5f74 696d 653a  () - start_time:
+0002d430: 2e32 667d 2073 2e29 5c6e 2229 0d0a 0d0a  .2f} s.)\n")....
+0002d440: 2020 2020 2020 2020 6578 6365 7074 2045          except E
+0002d450: 7863 6570 7469 6f6e 2061 7320 653a 0d0a  xception as e:..
+0002d460: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+0002d470: 6f74 2022 7465 726d 696e 6174 6564 2062  ot "terminated b
+0002d480: 7920 7573 6572 2220 696e 2073 7472 2865  y user" in str(e
+0002d490: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+0002d4a0: 2020 2020 6366 672e 7365 745f 6572 726f      cfg.set_erro
+0002d4b0: 7228 652c 2022 2229 0d0a 2020 2020 2020  r(e, "")..      
+0002d4c0: 2020 2020 2020 7072 696e 7428 2241 6e20        print("An 
+0002d4d0: 6973 7375 6520 7761 7320 656e 636f 756e  issue was encoun
+0002d4e0: 7465 7265 6420 6475 7269 6e67 2065 7870  tered during exp
+0002d4f0: 6f72 745c 6e22 0d0a 2020 2020 2020 2020  ort\n"..        
+0002d500: 2020 2020 2020 2020 2020 6622 5c74 4461            f"\tDa
+0002d510: 7461 7365 743a 207b 7365 6c66 2e64 6174  taset: {self.dat
+0002d520: 6173 6574 2e70 6174 687d 5c6e 220d 0a20  aset.path}\n".. 
+0002d530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d540: 2066 225c 7445 7272 6f72 3a20 222c 2065   f"\tError: ", e
+0002d550: 290d 0a20 2020 2020 2020 2020 2020 2073  )..            s
+0002d560: 656c 662e 7072 6f63 6573 732e 7365 745f  elf.process.set_
+0002d570: 7072 6f67 7265 7373 2831 2e30 290d 0a0d  progress(1.0)...
+0002d580: 0a20 2020 2064 6566 2063 6865 636b 5f73  .    def check_s
+0002d590: 746f 705f 7265 7175 6573 7428 7365 6c66  top_request(self
+0002d5a0: 293a 0d0a 2020 2020 2020 2020 6966 2073  ):..        if s
+0002d5b0: 656c 662e 7072 6f63 6573 732e 7374 6f70  elf.process.stop
+0002d5c0: 5f72 6571 7565 7374 2e69 735f 7365 7428  _request.is_set(
+0002d5d0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+0002d5e0: 7261 6973 6520 4578 6365 7074 696f 6e28  raise Exception(
+0002d5f0: 2251 7565 7565 6445 7870 6f72 7420 2d20  "QueuedExport - 
+0002d600: 7072 6f63 6573 7320 7465 726d 696e 6174  process terminat
+0002d610: 6564 2062 7920 7573 6572 2e20 2229 0d0a  ed by user. ")..
+0002d620: 0d0a 2020 2020 6465 6620 7374 6172 7428  ..    def start(
+0002d630: 7365 6c66 293a 0d0a 2020 2020 2020 2020  self):..        
+0002d640: 7365 6c66 2e70 726f 6365 7373 2e73 6574  self.process.set
+0002d650: 5f70 726f 6772 6573 7328 302e 3030 3031  _progress(0.0001
+0002d660: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+0002d670: 7072 6f63 6573 732e 7374 6172 7428 290d  process.start().
+0002d680: 0a0d 0a20 2020 2064 6566 2073 746f 7028  ...    def stop(
+0002d690: 7365 6c66 293a 0d0a 2020 2020 2020 2020  self):..        
+0002d6a0: 6966 2073 656c 662e 7072 6f63 6573 732e  if self.process.
+0002d6b0: 7468 7265 6164 2069 7320 6e6f 7420 4e6f  thread is not No
+0002d6c0: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
+0002d6d0: 2073 656c 662e 7072 6f63 6573 732e 7374   self.process.st
+0002d6e0: 6f70 5f72 6571 7565 7374 2e73 6574 2829  op_request.set()
+0002d6f0: 0d0a 0d0a 0d0a 636c 6173 7320 5175 6575  ......class Queu
+0002d700: 6564 4578 7472 6163 743a 0d0a 2020 2020  edExtract:..    
+0002d710: 6465 6620 5f5f 696e 6974 5f5f 2873 656c  def __init__(sel
+0002d720: 662c 206d 7263 7061 7468 2c20 7468 7265  f, mrcpath, thre
+0002d730: 7368 6f6c 642c 206d 696e 5f73 697a 652c  shold, min_size,
+0002d740: 206d 696e 5f73 7061 6369 6e67 2c20 7361   min_spacing, sa
+0002d750: 7665 5f64 6972 2c20 6269 6e6e 696e 673d  ve_dir, binning=
+0002d760: 3129 3a0d 0a20 2020 2020 2020 2073 656c  1):..        sel
+0002d770: 662e 7461 6720 3d20 6d72 6370 6174 680d  f.tag = mrcpath.
+0002d780: 0a20 2020 2020 2020 2073 656c 662e 7061  .        self.pa
+0002d790: 7468 203d 206d 7263 7061 7468 0d0a 2020  th = mrcpath..  
+0002d7a0: 2020 2020 2020 7365 6c66 2e74 6872 6573        self.thres
+0002d7b0: 686f 6c64 203d 2074 6872 6573 686f 6c64  hold = threshold
+0002d7c0: 0d0a 2020 2020 2020 2020 7365 6c66 2e6d  ..        self.m
+0002d7d0: 696e 5f73 697a 6520 3d20 6d69 6e5f 7369  in_size = min_si
+0002d7e0: 7a65 0d0a 2020 2020 2020 2020 7365 6c66  ze..        self
+0002d7f0: 2e6d 696e 5f73 7061 6369 6e67 203d 206d  .min_spacing = m
+0002d800: 696e 5f73 7061 6369 6e67 0d0a 2020 2020  in_spacing..    
+0002d810: 2020 2020 7365 6c66 2e62 696e 6e69 6e67      self.binning
+0002d820: 203d 2062 696e 6e69 6e67 0d0a 2020 2020   = binning..    
+0002d830: 2020 2020 7365 6c66 2e64 6972 203d 2073      self.dir = s
+0002d840: 6176 655f 6469 720d 0a20 2020 2020 2020  ave_dir..       
+0002d850: 2073 656c 662e 636f 6c6f 7572 203d 2028   self.colour = (
+0002d860: 302e 322c 2030 2e39 2c20 302e 3229 0d0a  0.2, 0.9, 0.2)..
+0002d870: 2020 2020 2020 2020 7365 6c66 2e70 726f          self.pro
+0002d880: 6365 7373 203d 2042 6163 6b67 726f 756e  cess = Backgroun
+0002d890: 6450 726f 6365 7373 2873 656c 662e 646f  dProcess(self.do
+0002d8a0: 5f65 7870 6f72 742c 2028 292c 206e 616d  _export, (), nam
+0002d8b0: 653d 6622 7b73 656c 662e 7061 7468 7d20  e=f"{self.path} 
+0002d8c0: 6669 6e64 2063 6f6f 7264 732e 2229 0d0a  find coords.")..
+0002d8d0: 0d0a 2020 2020 6465 6620 646f 5f65 7870  ..    def do_exp
+0002d8e0: 6f72 7428 7365 6c66 2c20 7072 6f63 6573  ort(self, proces
+0002d8f0: 7329 3a0d 0a20 2020 2020 2020 2074 7279  s):..        try
+0002d900: 3a0d 0a20 2020 2020 2020 2020 2020 2067  :..            g
+0002d910: 6574 5f6d 6178 696d 615f 3364 5f77 6174  et_maxima_3d_wat
+0002d920: 6572 7368 6564 286d 7263 7061 7468 3d73  ershed(mrcpath=s
+0002d930: 656c 662e 7061 7468 2c20 7468 7265 7368  elf.path, thresh
+0002d940: 6f6c 643d 7365 6c66 2e74 6872 6573 686f  old=self.thresho
+0002d950: 6c64 2c20 6d69 6e5f 7370 6163 696e 673d  ld, min_spacing=
+0002d960: 7365 6c66 2e6d 696e 5f73 7061 6369 6e67  self.min_spacing
+0002d970: 2c20 6d69 6e5f 7369 7a65 3d73 656c 662e  , min_size=self.
+0002d980: 6d69 6e5f 7369 7a65 2c20 7361 7665 5f64  min_size, save_d
+0002d990: 6972 3d73 656c 662e 6469 722c 2070 726f  ir=self.dir, pro
+0002d9a0: 6365 7373 3d73 656c 662e 7072 6f63 6573  cess=self.proces
+0002d9b0: 732c 2062 696e 6e69 6e67 3d73 656c 662e  s, binning=self.
+0002d9c0: 6269 6e6e 696e 6729 0d0a 2020 2020 2020  binning)..      
+0002d9d0: 2020 2020 2020 666f 7220 7320 696e 2063        for s in c
+0002d9e0: 6667 2e73 655f 7375 7266 6163 655f 6d6f  fg.se_surface_mo
+0002d9f0: 6465 6c73 3a0d 0a20 2020 2020 2020 2020  dels:..         
+0002da00: 2020 2020 2020 2069 6620 732e 7061 7468         if s.path
+0002da10: 203d 3d20 7365 6c66 2e70 6174 683a 0d0a   == self.path:..
+0002da20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002da30: 2020 2020 732e 6669 6e64 5f63 6f6f 7264      s.find_coord
+0002da40: 696e 6174 6573 2829 0d0a 2020 2020 2020  inates()..      
+0002da50: 2020 6578 6365 7074 2045 7863 6570 7469    except Excepti
+0002da60: 6f6e 2061 7320 653a 0d0a 2020 2020 2020  on as e:..      
+0002da70: 2020 2020 2020 6366 672e 7365 745f 6572        cfg.set_er
+0002da80: 726f 7228 652c 2022 4572 726f 7220 696e  ror(e, "Error in
+0002da90: 2051 7565 7565 6445 7874 7261 6374 2028   QueuedExtract (
+0002daa0: 6669 6e64 696e 6720 636f 6f72 6469 6e61  finding coordina
+0002dab0: 7465 7320 696e 2061 202e 6d72 6329 202d  tes in a .mrc) -
+0002dac0: 2073 6565 2064 6574 6169 6c73 2062 656c   see details bel
+0002dad0: 6f77 2e22 290d 0a20 2020 2020 2020 2070  ow.")..        p
+0002dae0: 726f 6365 7373 2e73 6574 5f70 726f 6772  rocess.set_progr
+0002daf0: 6573 7328 312e 3029 0d0a 0d0a 2020 2020  ess(1.0)....    
+0002db00: 6465 6620 6368 6563 6b5f 7374 6f70 5f72  def check_stop_r
+0002db10: 6571 7565 7374 2873 656c 6629 3a0d 0a20  equest(self):.. 
+0002db20: 2020 2020 2020 2069 6620 7365 6c66 2e70         if self.p
+0002db30: 726f 6365 7373 2e73 746f 705f 7265 7175  rocess.stop_requ
+0002db40: 6573 742e 6973 5f73 6574 2829 3a0d 0a20  est.is_set():.. 
+0002db50: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0002db60: 2045 7863 6570 7469 6f6e 2822 5175 6575   Exception("Queu
+0002db70: 6564 4578 706f 7274 202d 2070 726f 6365  edExport - proce
+0002db80: 7373 2074 6572 6d69 6e61 7465 6420 6279  ss terminated by
+0002db90: 2075 7365 722e 2022 290d 0a0d 0a20 2020   user. ")....   
+0002dba0: 2064 6566 2073 7461 7274 2873 656c 6629   def start(self)
+0002dbb0: 3a0d 0a20 2020 2020 2020 2073 656c 662e  :..        self.
+0002dbc0: 7072 6f63 6573 732e 7365 745f 7072 6f67  process.set_prog
+0002dbd0: 7265 7373 2830 2e30 3030 3129 0d0a 2020  ress(0.0001)..  
+0002dbe0: 2020 2020 2020 7365 6c66 2e70 726f 6365        self.proce
+0002dbf0: 7373 2e73 7461 7274 2829 0d0a 0d0a 2020  ss.start()....  
+0002dc00: 2020 6465 6620 7374 6f70 2873 656c 6629    def stop(self)
+0002dc10: 3a0d 0a20 2020 2020 2020 2069 6620 7365  :..        if se
+0002dc20: 6c66 2e70 726f 6365 7373 2e74 6872 6561  lf.process.threa
+0002dc30: 6420 6973 206e 6f74 204e 6f6e 653a 0d0a  d is not None:..
+0002dc40: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0002dc50: 2e70 726f 6365 7373 2e73 746f 705f 7265  .process.stop_re
+0002dc60: 7175 6573 742e 7365 7428 290d 0a0d 0a0d  quest.set().....
+0002dc70: 0a63 6c61 7373 2057 6f72 6c64 5370 6163  .class WorldSpac
+0002dc80: 6549 636f 6e3a 0d0a 2020 2020 2320 7468  eIcon:..    # th
+0002dc90: 6973 2063 6c61 7373 2069 7320 6f6e 6c79  is class is only
+0002dca0: 2075 7365 6420 746f 2072 656e 6465 7220   used to render 
+0002dcb0: 616e 6420 696e 7465 7261 6374 2077 6974  and interact wit
+0002dcc0: 6820 7468 6520 5365 676d 656e 7461 7469  h the Segmentati
+0002dcd0: 6f6e 4564 6974 6f72 2063 726f 7020 6861  onEditor crop ha
+0002dce0: 6e64 6c65 732e 2066 6169 726c 7920 7370  ndles. fairly sp
+0002dcf0: 6563 6966 6963 2069 6d70 6c65 6d65 6e74  ecific implement
+0002dd00: 6174 696f 6e0d 0a20 2020 2063 726f 705f  ation..    crop_
+0002dd10: 6963 6f6e 5f76 6120 3d20 4e6f 6e65 0d0a  icon_va = None..
+0002dd20: 2020 2020 6372 6f70 5f69 636f 6e5f 7465      crop_icon_te
+0002dd30: 7874 7572 6520 3d20 4e6f 6e65 0d0a 2020  xture = None..  
+0002dd40: 2020 4d49 4e5f 5349 5a45 203d 2031 3238    MIN_SIZE = 128
+0002dd50: 0d0a 0d0a 2020 2020 6465 6620 5f5f 696e  ....    def __in
+0002dd60: 6974 5f5f 2873 656c 662c 2063 6f72 6e65  it__(self, corne
+0002dd70: 725f 6964 783d 3029 3a0d 0a20 2020 2020  r_idx=0):..     
+0002dd80: 2020 2069 6620 576f 726c 6453 7061 6365     if WorldSpace
+0002dd90: 4963 6f6e 2e63 726f 705f 6963 6f6e 5f76  Icon.crop_icon_v
+0002dda0: 6120 6973 204e 6f6e 653a 0d0a 2020 2020  a is None:..    
+0002ddb0: 2020 2020 2020 2020 576f 726c 6453 7061          WorldSpa
+0002ddc0: 6365 4963 6f6e 2e69 6e69 745f 6f70 656e  ceIcon.init_open
+0002ddd0: 676c 5f6f 626a 7328 290d 0a0d 0a20 2020  gl_objs()....   
+0002dde0: 2020 2020 2073 656c 662e 7472 616e 7366       self.transf
+0002ddf0: 6f72 6d20 3d20 5472 616e 7366 6f72 6d28  orm = Transform(
+0002de00: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+0002de10: 636f 726e 6572 5f69 6478 203d 2063 6f72  corner_idx = cor
+0002de20: 6e65 725f 6964 780d 0a20 2020 2020 2020  ner_idx..       
+0002de30: 2073 656c 662e 636f 726e 6572 5f70 6f73   self.corner_pos
+0002de40: 6974 696f 6e73 5f6c 6f63 616c 203d 205b  itions_local = [
+0002de50: 5b30 2c20 305d 2c20 5b31 2c20 305d 2c20  [0, 0], [1, 0], 
+0002de60: 5b30 2c20 2d31 5d2c 205b 312c 202d 315d  [0, -1], [1, -1]
+0002de70: 5d0d 0a20 2020 2020 2020 2073 656c 662e  ]..        self.
+0002de80: 636f 726e 6572 5f70 6f73 6974 696f 6e73  corner_positions
+0002de90: 203d 205b 5b30 2c20 305d 2c20 5b31 2c20   = [[0, 0], [1, 
+0002dea0: 305d 2c20 5b30 2c20 2d31 5d2c 205b 312c  0], [0, -1], [1,
+0002deb0: 202d 315d 5d0d 0a20 2020 2020 2020 2073   -1]]..        s
+0002dec0: 656c 662e 7061 7265 6e74 203d 204e 6f6e  elf.parent = Non
+0002ded0: 650d 0a20 2020 2020 2020 2073 656c 662e  e..        self.
+0002dee0: 6163 7469 7665 203d 2046 616c 7365 0d0a  active = False..
+0002def0: 2020 2020 2020 2020 7365 6c66 2e6d 6f76          self.mov
+0002df00: 696e 675f 656e 7469 7265 5f72 6f69 203d  ing_entire_roi =
+0002df10: 2046 616c 7365 0d0a 0d0a 2020 2020 6465   False....    de
+0002df20: 6620 6765 745f 7661 2873 656c 6629 3a0d  f get_va(self):.
+0002df30: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0002df40: 576f 726c 6453 7061 6365 4963 6f6e 2e63  WorldSpaceIcon.c
+0002df50: 726f 705f 6963 6f6e 5f76 610d 0a0d 0a20  rop_icon_va.... 
+0002df60: 2020 2064 6566 2067 6574 5f74 6578 7475     def get_textu
+0002df70: 7265 2873 656c 6629 3a0d 0a20 2020 2020  re(self):..     
+0002df80: 2020 2072 6574 7572 6e20 576f 726c 6453     return WorldS
+0002df90: 7061 6365 4963 6f6e 2e63 726f 705f 6963  paceIcon.crop_ic
+0002dfa0: 6f6e 5f74 6578 7475 7265 0d0a 0d0a 2020  on_texture....  
+0002dfb0: 2020 4073 7461 7469 636d 6574 686f 640d    @staticmethod.
+0002dfc0: 0a20 2020 2064 6566 2069 6e69 745f 6f70  .    def init_op
+0002dfd0: 656e 676c 5f6f 626a 7328 293a 0d0a 2020  engl_objs():..  
+0002dfe0: 2020 2020 2020 2320 6372 6f70 2069 636f        # crop ico
+0002dff0: 6e0d 0a20 2020 2020 2020 2069 636f 6e5f  n..        icon_
+0002e000: 7665 7274 6963 6573 203d 205b 302c 2030  vertices = [0, 0
+0002e010: 2c20 302c 2030 2c0d 0a20 2020 2020 2020  , 0, 0,..       
+0002e020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e030: 2020 312c 2030 2c20 312c 2030 2c0d 0a20    1, 0, 1, 0,.. 
+0002e040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e050: 2020 2020 2020 2020 302c 202d 312c 2030          0, -1, 0
+0002e060: 2c20 312c 0d0a 2020 2020 2020 2020 2020  , 1,..          
+0002e070: 2020 2020 2020 2020 2020 2020 2020 2031                 1
+0002e080: 2c20 2d31 2c20 312c 2031 5d0d 0a20 2020  , -1, 1, 1]..   
+0002e090: 2020 2020 2069 636f 6e5f 696e 6469 6365       icon_indice
+0002e0a0: 7320 3d20 5b30 2c20 312c 2032 2c20 322c  s = [0, 1, 2, 2,
+0002e0b0: 2031 2c20 335d 0d0a 2020 2020 2020 2020   1, 3]..        
+0002e0c0: 576f 726c 6453 7061 6365 4963 6f6e 2e63  WorldSpaceIcon.c
+0002e0d0: 726f 705f 6963 6f6e 5f76 6120 3d20 5665  rop_icon_va = Ve
+0002e0e0: 7274 6578 4172 7261 7928 5665 7274 6578  rtexArray(Vertex
+0002e0f0: 4275 6666 6572 2869 636f 6e5f 7665 7274  Buffer(icon_vert
+0002e100: 6963 6573 292c 2049 6e64 6578 4275 6666  ices), IndexBuff
+0002e110: 6572 2869 636f 6e5f 696e 6469 6365 7329  er(icon_indices)
+0002e120: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0002e130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e150: 2020 2020 2061 7474 7269 6275 7465 5f66       attribute_f
+0002e160: 6f72 6d61 743d 2278 7975 7622 290d 0a20  ormat="xyuv").. 
+0002e170: 2020 2020 2020 2057 6f72 6c64 5370 6163         WorldSpac
+0002e180: 6549 636f 6e2e 6372 6f70 5f69 636f 6e5f  eIcon.crop_icon_
+0002e190: 7465 7874 7572 6520 3d20 5465 7874 7572  texture = Textur
+0002e1a0: 6528 666f 726d 6174 3d22 7267 6261 3332  e(format="rgba32
+0002e1b0: 6622 290d 0a20 2020 2020 2020 2070 7864  f")..        pxd
+0002e1c0: 5f69 636f 6e5f 6372 6f70 203d 206e 702e  _icon_crop = np.
+0002e1d0: 6173 6172 7261 7928 496d 6167 652e 6f70  asarray(Image.op
+0002e1e0: 656e 286f 732e 7061 7468 2e6a 6f69 6e28  en(os.path.join(
+0002e1f0: 6366 672e 726f 6f74 2c20 2269 636f 6e73  cfg.root, "icons
+0002e200: 222c 2022 6963 6f6e 5f63 726f 705f 3235  ", "icon_crop_25
+0002e210: 362e 706e 6722 2929 292e 6173 7479 7065  6.png"))).astype
+0002e220: 280d 0a20 2020 2020 2020 2020 2020 206e  (..            n
+0002e230: 702e 666c 6f61 7433 3229 202f 2032 3535  p.float32) / 255
+0002e240: 2e30 0d0a 2020 2020 2020 2020 576f 726c  .0..        Worl
+0002e250: 6453 7061 6365 4963 6f6e 2e63 726f 705f  dSpaceIcon.crop_
+0002e260: 6963 6f6e 5f74 6578 7475 7265 2e75 7064  icon_texture.upd
+0002e270: 6174 6528 7078 645f 6963 6f6e 5f63 726f  ate(pxd_icon_cro
+0002e280: 7029 0d0a 0d0a 2020 2020 6465 6620 6166  p)....    def af
+0002e290: 6665 6374 5f63 726f 7028 7365 6c66 2c20  fect_crop(self, 
+0002e2a0: 7069 7865 6c5f 636f 6f72 6469 6e61 7465  pixel_coordinate
+0002e2b0: 293a 0d0a 2020 2020 2020 2020 6420 3d20  ):..        d = 
+0002e2c0: 576f 726c 6453 7061 6365 4963 6f6e 2e4d  WorldSpaceIcon.M
+0002e2d0: 494e 5f53 495a 450d 0a20 2020 2020 2020  IN_SIZE..       
+0002e2e0: 2023 2320 7468 6973 206d 6574 686f 6420   ## this method 
+0002e2f0: 6973 2063 616c 6c65 6420 7768 656e 2074  is called when t
+0002e300: 6865 2063 726f 7020 6861 6e64 6c65 2069  he crop handle i
+0002e310: 7320 6d6f 7665 642c 206f 6e74 6f20 7069  s moved, onto pi
+0002e320: 7865 6c5f 636f 6f72 6469 6e61 7465 0d0a  xel_coordinate..
+0002e330: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+0002e340: 636f 726e 6572 5f69 6478 203d 3d20 303a  corner_idx == 0:
+0002e350: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+0002e360: 6c66 2e70 6172 656e 742e 6372 6f70 5f72  lf.parent.crop_r
+0002e370: 6f69 5b30 5d20 3d20 7069 7865 6c5f 636f  oi[0] = pixel_co
+0002e380: 6f72 6469 6e61 7465 5b30 5d0d 0a20 2020  ordinate[0]..   
+0002e390: 2020 2020 2020 2020 2073 656c 662e 7061           self.pa
+0002e3a0: 7265 6e74 2e63 726f 705f 726f 695b 305d  rent.crop_roi[0]
+0002e3b0: 203d 2063 6c61 6d70 2873 656c 662e 7061   = clamp(self.pa
+0002e3c0: 7265 6e74 2e63 726f 705f 726f 695b 305d  rent.crop_roi[0]
+0002e3d0: 2c20 302c 2073 656c 662e 7061 7265 6e74  , 0, self.parent
+0002e3e0: 2e63 726f 705f 726f 695b 325d 202d 2064  .crop_roi[2] - d
+0002e3f0: 290d 0a20 2020 2020 2020 2020 2020 2073  )..            s
+0002e400: 656c 662e 7061 7265 6e74 2e63 726f 705f  elf.parent.crop_
+0002e410: 726f 695b 315d 203d 2028 7365 6c66 2e70  roi[1] = (self.p
+0002e420: 6172 656e 742e 6865 6967 6874 202d 2070  arent.height - p
+0002e430: 6978 656c 5f63 6f6f 7264 696e 6174 655b  ixel_coordinate[
+0002e440: 315d 290d 0a20 2020 2020 2020 2020 2020  1])..           
+0002e450: 2073 656c 662e 7061 7265 6e74 2e63 726f   self.parent.cro
+0002e460: 705f 726f 695b 315d 203d 2063 6c61 6d70  p_roi[1] = clamp
+0002e470: 2873 656c 662e 7061 7265 6e74 2e63 726f  (self.parent.cro
+0002e480: 705f 726f 695b 315d 2c20 302c 2073 656c  p_roi[1], 0, sel
+0002e490: 662e 7061 7265 6e74 2e63 726f 705f 726f  f.parent.crop_ro
+0002e4a0: 695b 335d 202d 2064 290d 0a20 2020 2020  i[3] - d)..     
+0002e4b0: 2020 2065 6c69 6620 7365 6c66 2e63 6f72     elif self.cor
+0002e4c0: 6e65 725f 6964 7820 3d3d 2031 3a0d 0a20  ner_idx == 1:.. 
+0002e4d0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0002e4e0: 7061 7265 6e74 2e63 726f 705f 726f 695b  parent.crop_roi[
+0002e4f0: 325d 203d 2073 656c 662e 7061 7265 6e74  2] = self.parent
+0002e500: 2e77 6964 7468 202d 2028 7365 6c66 2e70  .width - (self.p
+0002e510: 6172 656e 742e 7769 6474 6820 2d20 7069  arent.width - pi
+0002e520: 7865 6c5f 636f 6f72 6469 6e61 7465 5b30  xel_coordinate[0
+0002e530: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
+0002e540: 7365 6c66 2e70 6172 656e 742e 6372 6f70  self.parent.crop
+0002e550: 5f72 6f69 5b32 5d20 3d20 636c 616d 7028  _roi[2] = clamp(
+0002e560: 7365 6c66 2e70 6172 656e 742e 6372 6f70  self.parent.crop
+0002e570: 5f72 6f69 5b32 5d2c 2073 656c 662e 7061  _roi[2], self.pa
+0002e580: 7265 6e74 2e63 726f 705f 726f 695b 305d  rent.crop_roi[0]
+0002e590: 202b 2064 2c20 7365 6c66 2e70 6172 656e   + d, self.paren
+0002e5a0: 742e 7769 6474 6829 0d0a 2020 2020 2020  t.width)..      
+0002e5b0: 2020 2020 2020 7365 6c66 2e70 6172 656e        self.paren
+0002e5c0: 742e 6372 6f70 5f72 6f69 5b31 5d20 3d20  t.crop_roi[1] = 
+0002e5d0: 2873 656c 662e 7061 7265 6e74 2e68 6569  (self.parent.hei
+0002e5e0: 6768 7420 2d20 7069 7865 6c5f 636f 6f72  ght - pixel_coor
+0002e5f0: 6469 6e61 7465 5b31 5d29 0d0a 2020 2020  dinate[1])..    
+0002e600: 2020 2020 2020 2020 7365 6c66 2e70 6172          self.par
+0002e610: 656e 742e 6372 6f70 5f72 6f69 5b31 5d20  ent.crop_roi[1] 
+0002e620: 3d20 636c 616d 7028 7365 6c66 2e70 6172  = clamp(self.par
+0002e630: 656e 742e 6372 6f70 5f72 6f69 5b31 5d2c  ent.crop_roi[1],
+0002e640: 2030 2c20 7365 6c66 2e70 6172 656e 742e   0, self.parent.
+0002e650: 6372 6f70 5f72 6f69 5b33 5d20 2d20 6429  crop_roi[3] - d)
+0002e660: 0d0a 2020 2020 2020 2020 656c 6966 2073  ..        elif s
+0002e670: 656c 662e 636f 726e 6572 5f69 6478 203d  elf.corner_idx =
+0002e680: 3d20 323a 0d0a 2020 2020 2020 2020 2020  = 2:..          
+0002e690: 2020 7365 6c66 2e70 6172 656e 742e 6372    self.parent.cr
+0002e6a0: 6f70 5f72 6f69 5b32 5d20 3d20 7365 6c66  op_roi[2] = self
+0002e6b0: 2e70 6172 656e 742e 7769 6474 6820 2d20  .parent.width - 
+0002e6c0: 2873 656c 662e 7061 7265 6e74 2e77 6964  (self.parent.wid
+0002e6d0: 7468 202d 2070 6978 656c 5f63 6f6f 7264  th - pixel_coord
+0002e6e0: 696e 6174 655b 305d 290d 0a20 2020 2020  inate[0])..     
+0002e6f0: 2020 2020 2020 2073 656c 662e 7061 7265         self.pare
+0002e700: 6e74 2e63 726f 705f 726f 695b 325d 203d  nt.crop_roi[2] =
+0002e710: 2063 6c61 6d70 2873 656c 662e 7061 7265   clamp(self.pare
+0002e720: 6e74 2e63 726f 705f 726f 695b 325d 2c20  nt.crop_roi[2], 
+0002e730: 7365 6c66 2e70 6172 656e 742e 6372 6f70  self.parent.crop
+0002e740: 5f72 6f69 5b30 5d20 2b20 642c 2073 656c  _roi[0] + d, sel
+0002e750: 662e 7061 7265 6e74 2e77 6964 7468 290d  f.parent.width).
+0002e760: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0002e770: 662e 7061 7265 6e74 2e63 726f 705f 726f  f.parent.crop_ro
+0002e780: 695b 335d 203d 2028 7365 6c66 2e70 6172  i[3] = (self.par
+0002e790: 656e 742e 6865 6967 6874 202d 2070 6978  ent.height - pix
+0002e7a0: 656c 5f63 6f6f 7264 696e 6174 655b 315d  el_coordinate[1]
+0002e7b0: 290d 0a20 2020 2020 2020 2020 2020 2073  )..            s
+0002e7c0: 656c 662e 7061 7265 6e74 2e63 726f 705f  elf.parent.crop_
+0002e7d0: 726f 695b 335d 203d 2063 6c61 6d70 2873  roi[3] = clamp(s
+0002e7e0: 656c 662e 7061 7265 6e74 2e63 726f 705f  elf.parent.crop_
+0002e7f0: 726f 695b 335d 2c20 7365 6c66 2e70 6172  roi[3], self.par
+0002e800: 656e 742e 6372 6f70 5f72 6f69 5b31 5d20  ent.crop_roi[1] 
+0002e810: 2b20 642c 2073 656c 662e 7061 7265 6e74  + d, self.parent
+0002e820: 2e68 6569 6768 7429 0d0a 2020 2020 2020  .height)..      
+0002e830: 2020 656c 6966 2073 656c 662e 636f 726e    elif self.corn
+0002e840: 6572 5f69 6478 203d 3d20 333a 0d0a 2020  er_idx == 3:..  
+0002e850: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
+0002e860: 6172 656e 742e 6372 6f70 5f72 6f69 5b30  arent.crop_roi[0
+0002e870: 5d20 3d20 7069 7865 6c5f 636f 6f72 6469  ] = pixel_coordi
+0002e880: 6e61 7465 5b30 5d0d 0a20 2020 2020 2020  nate[0]..       
+0002e890: 2020 2020 2073 656c 662e 7061 7265 6e74       self.parent
+0002e8a0: 2e63 726f 705f 726f 695b 305d 203d 2063  .crop_roi[0] = c
+0002e8b0: 6c61 6d70 2873 656c 662e 7061 7265 6e74  lamp(self.parent
+0002e8c0: 2e63 726f 705f 726f 695b 305d 2c20 302c  .crop_roi[0], 0,
+0002e8d0: 2073 656c 662e 7061 7265 6e74 2e63 726f   self.parent.cro
+0002e8e0: 705f 726f 695b 325d 202d 2064 290d 0a20  p_roi[2] - d).. 
+0002e8f0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0002e900: 7061 7265 6e74 2e63 726f 705f 726f 695b  parent.crop_roi[
+0002e910: 335d 203d 2028 7365 6c66 2e70 6172 656e  3] = (self.paren
+0002e920: 742e 6865 6967 6874 202d 2070 6978 656c  t.height - pixel
+0002e930: 5f63 6f6f 7264 696e 6174 655b 315d 290d  _coordinate[1]).
+0002e940: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0002e950: 662e 7061 7265 6e74 2e63 726f 705f 726f  f.parent.crop_ro
+0002e960: 695b 335d 203d 2063 6c61 6d70 2873 656c  i[3] = clamp(sel
+0002e970: 662e 7061 7265 6e74 2e63 726f 705f 726f  f.parent.crop_ro
+0002e980: 695b 335d 2c20 7365 6c66 2e70 6172 656e  i[3], self.paren
+0002e990: 742e 6372 6f70 5f72 6f69 5b31 5d20 2b20  t.crop_roi[1] + 
+0002e9a0: 642c 2073 656c 662e 7061 7265 6e74 2e68  d, self.parent.h
+0002e9b0: 6569 6768 7429 0d0a 0d0a 2020 2020 6465  eight)....    de
+0002e9c0: 6620 6d6f 7665 5f63 726f 705f 726f 6928  f move_crop_roi(
+0002e9d0: 7365 6c66 2c20 6478 2c20 6479 293a 0d0a  self, dx, dy):..
+0002e9e0: 2020 2020 2020 2020 7465 7374 5f72 6f69          test_roi
+0002e9f0: 203d 2063 6f70 7928 7365 6c66 2e70 6172   = copy(self.par
+0002ea00: 656e 742e 6372 6f70 5f72 6f69 290d 0a20  ent.crop_roi).. 
+0002ea10: 2020 2020 2020 2074 6573 745f 726f 695b         test_roi[
+0002ea20: 305d 202b 3d20 6478 0d0a 2020 2020 2020  0] += dx..      
+0002ea30: 2020 7465 7374 5f72 6f69 5b32 5d20 2b3d    test_roi[2] +=
+0002ea40: 2064 780d 0a20 2020 2020 2020 2074 6573   dx..        tes
+0002ea50: 745f 726f 695b 315d 202b 3d20 6479 0d0a  t_roi[1] += dy..
+0002ea60: 2020 2020 2020 2020 7465 7374 5f72 6f69          test_roi
+0002ea70: 5b33 5d20 2b3d 2064 790d 0a0d 0a20 2020  [3] += dy....   
+0002ea80: 2020 2020 2069 6620 7465 7374 5f72 6f69       if test_roi
+0002ea90: 5b30 5d20 3e20 3020 616e 6420 7465 7374  [0] > 0 and test
+0002eaa0: 5f72 6f69 5b32 5d20 3c20 7365 6c66 2e70  _roi[2] < self.p
+0002eab0: 6172 656e 742e 7769 6474 683a 0d0a 2020  arent.width:..  
+0002eac0: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
+0002ead0: 6172 656e 742e 6372 6f70 5f72 6f69 5b30  arent.crop_roi[0
+0002eae0: 5d20 3d20 7465 7374 5f72 6f69 5b30 5d0d  ] = test_roi[0].
+0002eaf0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0002eb00: 662e 7061 7265 6e74 2e63 726f 705f 726f  f.parent.crop_ro
+0002eb10: 695b 325d 203d 2074 6573 745f 726f 695b  i[2] = test_roi[
+0002eb20: 325d 0d0a 2020 2020 2020 2020 2020 2020  2]..            
+0002eb30: 7365 6c66 2e70 6172 656e 742e 6372 6f70  self.parent.crop
+0002eb40: 5f72 6f69 5b30 5d20 3d20 636c 616d 7028  _roi[0] = clamp(
+0002eb50: 7365 6c66 2e70 6172 656e 742e 6372 6f70  self.parent.crop
+0002eb60: 5f72 6f69 5b30 5d2c 2030 2c20 7365 6c66  _roi[0], 0, self
+0002eb70: 2e70 6172 656e 742e 7769 6474 6829 0d0a  .parent.width)..
+0002eb80: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0002eb90: 2e70 6172 656e 742e 6372 6f70 5f72 6f69  .parent.crop_roi
+0002eba0: 5b32 5d20 3d20 636c 616d 7028 7365 6c66  [2] = clamp(self
+0002ebb0: 2e70 6172 656e 742e 6372 6f70 5f72 6f69  .parent.crop_roi
+0002ebc0: 5b32 5d2c 2030 2c20 7365 6c66 2e70 6172  [2], 0, self.par
+0002ebd0: 656e 742e 7769 6474 6829 0d0a 2020 2020  ent.width)..    
+0002ebe0: 2020 2020 6966 2074 6573 745f 726f 695b      if test_roi[
+0002ebf0: 315d 203e 2030 2061 6e64 2074 6573 745f  1] > 0 and test_
+0002ec00: 726f 695b 335d 203c 2073 656c 662e 7061  roi[3] < self.pa
+0002ec10: 7265 6e74 2e68 6569 6768 743a 0d0a 2020  rent.height:..  
+0002ec20: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
+0002ec30: 6172 656e 742e 6372 6f70 5f72 6f69 5b31  arent.crop_roi[1
+0002ec40: 5d20 3d20 7465 7374 5f72 6f69 5b31 5d0d  ] = test_roi[1].
+0002ec50: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0002ec60: 662e 7061 7265 6e74 2e63 726f 705f 726f  f.parent.crop_ro
+0002ec70: 695b 335d 203d 2074 6573 745f 726f 695b  i[3] = test_roi[
+0002ec80: 335d 0d0a 2020 2020 2020 2020 2020 2020  3]..            
+0002ec90: 7365 6c66 2e70 6172 656e 742e 6372 6f70  self.parent.crop
+0002eca0: 5f72 6f69 5b31 5d20 3d20 636c 616d 7028  _roi[1] = clamp(
+0002ecb0: 7365 6c66 2e70 6172 656e 742e 6372 6f70  self.parent.crop
+0002ecc0: 5f72 6f69 5b31 5d2c 2030 2c20 7365 6c66  _roi[1], 0, self
+0002ecd0: 2e70 6172 656e 742e 6865 6967 6874 290d  .parent.height).
+0002ece0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0002ecf0: 662e 7061 7265 6e74 2e63 726f 705f 726f  f.parent.crop_ro
+0002ed00: 695b 335d 203d 2063 6c61 6d70 2873 656c  i[3] = clamp(sel
+0002ed10: 662e 7061 7265 6e74 2e63 726f 705f 726f  f.parent.crop_ro
+0002ed20: 695b 335d 2c20 302c 2073 656c 662e 7061  i[3], 0, self.pa
+0002ed30: 7265 6e74 2e68 6569 6768 7429 0d0a 0d0a  rent.height)....
+0002ed40: 2020 2020 6465 6620 636f 6e76 6572 745f      def convert_
+0002ed50: 6372 6f70 5f72 6f69 5f74 6f5f 696e 7465  crop_roi_to_inte
+0002ed60: 6765 7273 2873 656c 6629 3a0d 0a20 2020  gers(self):..   
+0002ed70: 2020 2020 2066 6f72 2069 2069 6e20 7261       for i in ra
+0002ed80: 6e67 6528 3429 3a0d 0a20 2020 2020 2020  nge(4):..       
+0002ed90: 2020 2020 2073 656c 662e 7061 7265 6e74       self.parent
+0002eda0: 2e63 726f 705f 726f 695b 695d 203d 2069  .crop_roi[i] = i
+0002edb0: 6e74 2873 656c 662e 7061 7265 6e74 2e63  nt(self.parent.c
+0002edc0: 726f 705f 726f 695b 695d 290d 0a0d 0a20  rop_roi[i]).... 
+0002edd0: 2020 2064 6566 2063 6f6d 7075 7465 5f6d     def compute_m
+0002ede0: 6174 7269 7828 7365 6c66 2c20 7365 5f66  atrix(self, se_f
+0002edf0: 7261 6d65 2c20 6361 6d65 7261 293a 0d0a  rame, camera):..
+0002ee00: 2020 2020 2020 2020 7365 6c66 2e70 6172          self.par
+0002ee10: 656e 7420 3d20 7365 5f66 7261 6d65 0d0a  ent = se_frame..
+0002ee20: 2020 2020 2020 2020 6670 6f73 203d 2073          fpos = s
+0002ee30: 655f 6672 616d 652e 7472 616e 7366 6f72  e_frame.transfor
+0002ee40: 6d2e 7472 616e 736c 6174 696f 6e0d 0a20  m.translation.. 
+0002ee50: 2020 2020 2020 2066 7820 3d20 5b2d 312c         fx = [-1,
+0002ee60: 2031 2c20 312c 202d 315d 0d0a 2020 2020   1, 1, -1]..    
+0002ee70: 2020 2020 6679 203d 205b 312c 2031 2c20      fy = [1, 1, 
+0002ee80: 2d31 2c20 2d31 5d0d 0a20 2020 2020 2020  -1, -1]..       
+0002ee90: 2023 2066 696e 6420 706f 7369 7469 6f6e   # find position
+0002eea0: 206f 6620 7468 6520 636f 726e 6572 206f   of the corner o
+0002eeb0: 6620 7468 6520 6672 616d 6520 7468 6174  f the frame that
+0002eec0: 2074 6869 7320 6861 6e64 6c65 2062 656c   this handle bel
+0002eed0: 6f6e 6773 2074 6f0d 0a20 2020 2020 2020  ongs to..       
+0002eee0: 2064 7820 3d20 300d 0a20 2020 2020 2020   dx = 0..       
+0002eef0: 2064 7920 3d20 300d 0a20 2020 2020 2020   dy = 0..       
+0002ef00: 2069 6620 7365 6c66 2e63 6f72 6e65 725f   if self.corner_
+0002ef10: 6964 7820 3d3d 2030 3a0d 0a20 2020 2020  idx == 0:..     
+0002ef20: 2020 2020 2020 2064 7820 3d20 7365 5f66         dx = se_f
+0002ef30: 7261 6d65 2e63 726f 705f 726f 695b 305d  rame.crop_roi[0]
+0002ef40: 0d0a 2020 2020 2020 2020 2020 2020 6479  ..            dy
+0002ef50: 203d 202d 7365 5f66 7261 6d65 2e63 726f   = -se_frame.cro
+0002ef60: 705f 726f 695b 315d 0d0a 2020 2020 2020  p_roi[1]..      
+0002ef70: 2020 656c 6966 2073 656c 662e 636f 726e    elif self.corn
+0002ef80: 6572 5f69 6478 203d 3d20 313a 0d0a 2020  er_idx == 1:..  
+0002ef90: 2020 2020 2020 2020 2020 6478 203d 202d            dx = -
+0002efa0: 2873 655f 6672 616d 652e 7769 6474 6820  (se_frame.width 
+0002efb0: 2d20 7365 5f66 7261 6d65 2e63 726f 705f  - se_frame.crop_
+0002efc0: 726f 695b 325d 290d 0a20 2020 2020 2020  roi[2])..       
+0002efd0: 2020 2020 2064 7920 3d20 2d73 655f 6672       dy = -se_fr
+0002efe0: 616d 652e 6372 6f70 5f72 6f69 5b31 5d0d  ame.crop_roi[1].
+0002eff0: 0a20 2020 2020 2020 2065 6c69 6620 7365  .        elif se
+0002f000: 6c66 2e63 6f72 6e65 725f 6964 7820 3d3d  lf.corner_idx ==
+0002f010: 2032 3a0d 0a20 2020 2020 2020 2020 2020   2:..           
+0002f020: 2064 7820 3d20 2d28 7365 5f66 7261 6d65   dx = -(se_frame
+0002f030: 2e77 6964 7468 202d 2073 655f 6672 616d  .width - se_fram
+0002f040: 652e 6372 6f70 5f72 6f69 5b32 5d29 0d0a  e.crop_roi[2])..
+0002f050: 2020 2020 2020 2020 2020 2020 6479 203d              dy =
+0002f060: 2073 655f 6672 616d 652e 6865 6967 6874   se_frame.height
+0002f070: 202d 2073 655f 6672 616d 652e 6372 6f70   - se_frame.crop
+0002f080: 5f72 6f69 5b33 5d0d 0a20 2020 2020 2020  _roi[3]..       
+0002f090: 2065 6c69 6620 7365 6c66 2e63 6f72 6e65   elif self.corne
+0002f0a0: 725f 6964 7820 3d3d 2033 3a0d 0a20 2020  r_idx == 3:..   
+0002f0b0: 2020 2020 2020 2020 2064 7820 3d20 7365           dx = se
+0002f0c0: 5f66 7261 6d65 2e63 726f 705f 726f 695b  _frame.crop_roi[
+0002f0d0: 305d 0d0a 2020 2020 2020 2020 2020 2020  0]..            
+0002f0e0: 6479 203d 2073 655f 6672 616d 652e 6865  dy = se_frame.he
+0002f0f0: 6967 6874 202d 2073 655f 6672 616d 652e  ight - se_frame.
+0002f100: 6372 6f70 5f72 6f69 5b33 5d0d 0a20 2020  crop_roi[3]..   
+0002f110: 2020 2020 2073 656c 662e 7472 616e 7366       self.transf
+0002f120: 6f72 6d2e 7472 616e 736c 6174 696f 6e5b  orm.translation[
+0002f130: 305d 203d 2066 706f 735b 305d 202b 2028  0] = fpos[0] + (
+0002f140: 302e 3520 2a20 6678 5b73 656c 662e 636f  0.5 * fx[self.co
+0002f150: 726e 6572 5f69 6478 5d20 2a20 7365 5f66  rner_idx] * se_f
+0002f160: 7261 6d65 2e77 6964 7468 202b 2064 7829  rame.width + dx)
+0002f170: 202a 2073 655f 6672 616d 652e 7069 7865   * se_frame.pixe
+0002f180: 6c5f 7369 7a65 0d0a 2020 2020 2020 2020  l_size..        
+0002f190: 7365 6c66 2e74 7261 6e73 666f 726d 2e74  self.transform.t
+0002f1a0: 7261 6e73 6c61 7469 6f6e 5b31 5d20 3d20  ranslation[1] = 
+0002f1b0: 6670 6f73 5b31 5d20 2b20 2830 2e35 202a  fpos[1] + (0.5 *
+0002f1c0: 2066 795b 7365 6c66 2e63 6f72 6e65 725f   fy[self.corner_
+0002f1d0: 6964 785d 202a 2073 655f 6672 616d 652e  idx] * se_frame.
+0002f1e0: 6865 6967 6874 202b 2064 7929 202a 2073  height + dy) * s
+0002f1f0: 655f 6672 616d 652e 7069 7865 6c5f 7369  e_frame.pixel_si
+0002f200: 7a65 0d0a 2020 2020 2020 2020 7365 6c66  ze..        self
+0002f210: 2e74 7261 6e73 666f 726d 2e72 6f74 6174  .transform.rotat
+0002f220: 696f 6e20 3d20 2d73 656c 662e 636f 726e  ion = -self.corn
+0002f230: 6572 5f69 6478 202a 2039 302e 300d 0a20  er_idx * 90.0.. 
+0002f240: 2020 2020 2020 2073 656c 662e 7472 616e         self.tran
+0002f250: 7366 6f72 6d2e 7363 616c 6520 3d20 3135  sform.scale = 15
+0002f260: 2e30 202f 2063 616d 6572 612e 7a6f 6f6d  .0 / camera.zoom
+0002f270: 0d0a 2020 2020 2020 2020 7365 6c66 2e74  ..        self.t
+0002f280: 7261 6e73 666f 726d 2e63 6f6d 7075 7465  ransform.compute
+0002f290: 5f6d 6174 7269 7828 290d 0a0d 0a20 2020  _matrix()....   
+0002f2a0: 2020 2020 2023 2073 6574 2069 636f 6e27       # set icon'
+0002f2b0: 7320 636f 726e 6572 2070 6f73 6974 696f  s corner positio
+0002f2c0: 6e73 0d0a 2020 2020 2020 2020 666f 7220  ns..        for 
+0002f2d0: 6920 696e 2072 616e 6765 2834 293a 0d0a  i in range(4):..
+0002f2e0: 2020 2020 2020 2020 2020 2020 6c6f 6361              loca
+0002f2f0: 6c5f 636f 726e 6572 5f70 6f73 203d 2074  l_corner_pos = t
+0002f300: 7570 6c65 2873 656c 662e 636f 726e 6572  uple(self.corner
+0002f310: 5f70 6f73 6974 696f 6e73 5f6c 6f63 616c  _positions_local
+0002f320: 5b69 5d29 0d0a 2020 2020 2020 2020 2020  [i])..          
+0002f330: 2020 7665 6320 3d20 6e70 2e6d 6174 7269    vec = np.matri
+0002f340: 7828 5b2a 6c6f 6361 6c5f 636f 726e 6572  x([*local_corner
+0002f350: 5f70 6f73 2c20 302e 302c 2031 2e30 5d29  _pos, 0.0, 1.0])
+0002f360: 2e54 0d0a 2020 2020 2020 2020 2020 2020  .T..            
+0002f370: 776f 726c 645f 636f 726e 6572 5f70 6f73  world_corner_pos
+0002f380: 203d 2073 656c 662e 7472 616e 7366 6f72   = self.transfor
+0002f390: 6d2e 6d61 7472 6978 202a 2076 6563 0d0a  m.matrix * vec..
+0002f3a0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0002f3b0: 2e63 6f72 6e65 725f 706f 7369 7469 6f6e  .corner_position
+0002f3c0: 735b 695d 203d 205b 666c 6f61 7428 776f  s[i] = [float(wo
+0002f3d0: 726c 645f 636f 726e 6572 5f70 6f73 5b30  rld_corner_pos[0
+0002f3e0: 5d29 2c20 666c 6f61 7428 776f 726c 645f  ]), float(world_
+0002f3f0: 636f 726e 6572 5f70 6f73 5b31 5d29 5d0d  corner_pos[1])].
+0002f400: 0a0d 0a20 2020 2064 6566 2069 735f 686f  ...    def is_ho
+0002f410: 7665 7265 6428 7365 6c66 2c20 6361 6d65  vered(self, came
+0002f420: 7261 2c20 6375 7273 6f72 5f70 6f73 6974  ra, cursor_posit
+0002f430: 696f 6e29 3a0d 0a20 2020 2020 2020 2050  ion):..        P
+0002f440: 203d 2063 616d 6572 612e 6375 7273 6f72   = camera.cursor
+0002f450: 5f74 6f5f 776f 726c 645f 706f 7369 7469  _to_world_positi
+0002f460: 6f6e 2863 7572 736f 725f 706f 7369 7469  on(cursor_positi
+0002f470: 6f6e 290d 0a20 2020 2020 2020 2041 203d  on)..        A =
+0002f480: 2073 656c 662e 636f 726e 6572 5f70 6f73   self.corner_pos
+0002f490: 6974 696f 6e73 5b30 5d0d 0a20 2020 2020  itions[0]..     
+0002f4a0: 2020 2042 203d 2073 656c 662e 636f 726e     B = self.corn
+0002f4b0: 6572 5f70 6f73 6974 696f 6e73 5b31 5d0d  er_positions[1].
+0002f4c0: 0a20 2020 2020 2020 2044 203d 2073 656c  .        D = sel
+0002f4d0: 662e 636f 726e 6572 5f70 6f73 6974 696f  f.corner_positio
+0002f4e0: 6e73 5b33 5d0d 0a20 2020 2020 2020 2061  ns[3]..        a
+0002f4f0: 7020 3d20 5b50 5b30 5d20 2d20 415b 305d  p = [P[0] - A[0]
+0002f500: 2c20 505b 315d 202d 2041 5b31 5d5d 0d0a  , P[1] - A[1]]..
+0002f510: 2020 2020 2020 2020 6162 203d 205b 425b          ab = [B[
+0002f520: 305d 202d 2041 5b30 5d2c 2042 5b31 5d20  0] - A[0], B[1] 
+0002f530: 2d20 415b 315d 5d0d 0a20 2020 2020 2020  - A[1]]..       
+0002f540: 2061 6420 3d20 5b44 5b30 5d20 2d20 415b   ad = [D[0] - A[
+0002f550: 305d 2c20 445b 315d 202d 2041 5b31 5d5d  0], D[1] - A[1]]
+0002f560: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0002f570: 2028 3020 3c20 6170 5b30 5d20 2a20 6162   (0 < ap[0] * ab
+0002f580: 5b30 5d20 2b20 6170 5b31 5d20 2a20 6162  [0] + ap[1] * ab
+0002f590: 5b31 5d20 3c20 6162 5b30 5d20 2a2a 2032  [1] < ab[0] ** 2
+0002f5a0: 202b 2061 625b 315d 202a 2a20 3229 2061   + ab[1] ** 2) a
+0002f5b0: 6e64 2028 3020 3c20 6170 5b30 5d20 2a20  nd (0 < ap[0] * 
+0002f5c0: 6164 5b30 5d20 2b20 6170 5b31 5d20 2a20  ad[0] + ap[1] * 
+0002f5d0: 6164 5b31 5d20 3c20 6164 5b30 5d20 2a2a  ad[1] < ad[0] **
+0002f5e0: 2032 202b 2061 645b 315d 202a 2a20 3229   2 + ad[1] ** 2)
+0002f5f0: 0d0a 0d0a                                ....
```

### Comparing `Ais-cryoET-1.0.24/Ais/core/util.py` & `Ais-cryoET-1.0.25/Ais/core/util.py`

 * *Files identical despite different names*

### Comparing `Ais-cryoET-1.0.24/Ais/core/widgets.py` & `Ais-cryoET-1.0.25/Ais/core/widgets.py`

 * *Files identical despite different names*

### Comparing `Ais-cryoET-1.0.24/Ais/core/window.py` & `Ais-cryoET-1.0.25/Ais/core/window.py`

 * *Files identical despite different names*

### Comparing `Ais-cryoET-1.0.24/Ais/icons/LOGO_Pom_1024.png` & `Ais-cryoET-1.0.25/Ais/icons/LOGO_Pom_1024.png`

 * *Files identical despite different names*

### Comparing `Ais-cryoET-1.0.24/Ais/icons/LOGO_Pom_128.png` & `Ais-cryoET-1.0.25/Ais/icons/LOGO_Pom_128.png`

 * *Files identical despite different names*

### Comparing `Ais-cryoET-1.0.24/Ais/icons/LOGO_Pom_2048.png` & `Ais-cryoET-1.0.25/Ais/icons/LOGO_Pom_2048.png`

 * *Files identical despite different names*

### Comparing `Ais-cryoET-1.0.24/Ais/icons/LOGO_Pom_256.png` & `Ais-cryoET-1.0.25/Ais/icons/LOGO_Pom_256.png`

 * *Files identical despite different names*

### Comparing `Ais-cryoET-1.0.24/Ais/icons/LOGO_Pom_512.png` & `Ais-cryoET-1.0.25/Ais/icons/LOGO_Pom_512.png`

 * *Files identical despite different names*

### Comparing `Ais-cryoET-1.0.24/Ais/icons/icon_blender_256.png` & `Ais-cryoET-1.0.25/Ais/icons/icon_blender_256.png`

 * *Files identical despite different names*

### Comparing `Ais-cryoET-1.0.24/Ais/icons/icon_chimerax_256.png` & `Ais-cryoET-1.0.25/Ais/icons/icon_chimerax_256.png`

 * *Files identical despite different names*

### Comparing `Ais-cryoET-1.0.24/Ais/icons/icon_close_256.png` & `Ais-cryoET-1.0.25/Ais/icons/icon_close_256.png`

 * *Files identical despite different names*

### Comparing `Ais-cryoET-1.0.24/Ais/icons/icon_crop_256.png` & `Ais-cryoET-1.0.25/Ais/icons/icon_crop_256.png`

 * *Files identical despite different names*

### Comparing `Ais-cryoET-1.0.24/Ais/icons/icon_obj_256.png` & `Ais-cryoET-1.0.25/Ais/icons/icon_obj_256.png`

 * *Files identical despite different names*

### Comparing `Ais-cryoET-1.0.24/Ais/icons/icon_stop_256.png` & `Ais-cryoET-1.0.25/Ais/icons/icon_stop_256.png`

 * *Files identical despite different names*

### Comparing `Ais-cryoET-1.0.24/Ais/main.py` & `Ais-cryoET-1.0.25/Ais/main.py`

 * *Files identical despite different names*

### Comparing `Ais-cryoET-1.0.24/Ais/models/eman2.py` & `Ais-cryoET-1.0.25/Ais/models/eman2.py`

 * *Files identical despite different names*

### Comparing `Ais-cryoET-1.0.24/Ais/models/inceptionnet.py` & `Ais-cryoET-1.0.25/Ais/models/inceptionnet.py`

 * *Files identical despite different names*

### Comparing `Ais-cryoET-1.0.24/Ais/models/model_template.py` & `Ais-cryoET-1.0.25/Ais/models/model_template.py`

 * *Files identical despite different names*

### Comparing `Ais-cryoET-1.0.24/Ais/models/pix2pix.py` & `Ais-cryoET-1.0.25/Ais/models/pix2pix.py`

 * *Files identical despite different names*

### Comparing `Ais-cryoET-1.0.24/Ais/models/resnet.py` & `Ais-cryoET-1.0.25/Ais/models/resnet.py`

 * *Files identical despite different names*

### Comparing `Ais-cryoET-1.0.24/Ais/models/unet_deep.py` & `Ais-cryoET-1.0.25/Ais/models/unet_deep.py`

 * *Files identical despite different names*

### Comparing `Ais-cryoET-1.0.24/Ais/models/unet_dropout.py` & `Ais-cryoET-1.0.25/Ais/models/unet_dropout.py`

 * *Files identical despite different names*

### Comparing `Ais-cryoET-1.0.24/Ais/models/unet_lite.py` & `Ais-cryoET-1.0.25/Ais/models/unet_lite.py`

 * *Files identical despite different names*

### Comparing `Ais-cryoET-1.0.24/Ais/models/vggnet.py` & `Ais-cryoET-1.0.25/Ais/models/vggnet.py`

 * *Files identical despite different names*

### Comparing `Ais-cryoET-1.0.24/Ais/models/vggnet_plus.py` & `Ais-cryoET-1.0.25/Ais/models/vggnet_plus.py`

 * *Files identical despite different names*

### Comparing `Ais-cryoET-1.0.24/Ais/shaders/se_binary_segmentation_shader.glsl` & `Ais-cryoET-1.0.25/Ais/shaders/se_binary_segmentation_shader.glsl`

 * *Files identical despite different names*

### Comparing `Ais-cryoET-1.0.24/Ais/shaders/se_compute_kernel_filter.glsl` & `Ais-cryoET-1.0.25/Ais/shaders/se_compute_kernel_filter.glsl`

 * *Files identical despite different names*

### Comparing `Ais-cryoET-1.0.24/Ais/shaders/se_compute_mix.glsl` & `Ais-cryoET-1.0.25/Ais/shaders/se_compute_mix.glsl`

 * *Files identical despite different names*

### Comparing `Ais-cryoET-1.0.24/Ais/shaders/se_float_segmentation_shader.glsl` & `Ais-cryoET-1.0.25/Ais/shaders/se_float_segmentation_shader.glsl`

 * *Files identical despite different names*

### Comparing `Ais-cryoET-1.0.24/Ais/shaders/se_icon_shader.glsl` & `Ais-cryoET-1.0.25/Ais/shaders/se_icon_shader.glsl`

 * *Files identical despite different names*

### Comparing `Ais-cryoET-1.0.24/Ais/shaders/se_overlay_ray_trace_shader.glsl` & `Ais-cryoET-1.0.25/Ais/shaders/se_overlay_ray_trace_shader.glsl`

 * *Files identical despite different names*

### Comparing `Ais-cryoET-1.0.24/Ais/shaders/se_overlay_shader.glsl` & `Ais-cryoET-1.0.25/Ais/shaders/se_overlay_shader.glsl`

 * *Files identical despite different names*

### Comparing `Ais-cryoET-1.0.24/Ais/shaders/se_quad_3d_shader.glsl` & `Ais-cryoET-1.0.25/Ais/shaders/se_quad_3d_shader.glsl`

 * *Files identical despite different names*

### Comparing `Ais-cryoET-1.0.24/Ais/shaders/se_quad_shader.glsl` & `Ais-cryoET-1.0.25/Ais/shaders/se_quad_shader.glsl`

 * *Files identical despite different names*

### Comparing `Ais-cryoET-1.0.24/Ais/shaders/se_surface_model_shader.glsl` & `Ais-cryoET-1.0.25/Ais/shaders/se_surface_model_shader.glsl`

 * *Files identical despite different names*

### Comparing `Ais-cryoET-1.0.24/Ais_cryoET.egg-info/PKG-INFO` & `Ais-cryoET-1.0.25/Ais_cryoET.egg-info/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: Ais-cryoET
-Version: 1.0.24
+Version: 1.0.25
 Summary: Segmentation of cryo-electron tomography data - https://ais-cryoet.readthedocs.org/ https://aiscryoet.org/
 Home-page: https://github.com/bionanopatterning/Ais
 Author: mgflast
 Author-email: m.g.f.last@lumc.nl
 License: GPL v3
 Platform: UNKNOWN
 Description-Content-Type: text/markdown
```

### Comparing `Ais-cryoET-1.0.24/Ais_cryoET.egg-info/SOURCES.txt` & `Ais-cryoET-1.0.25/Ais_cryoET.egg-info/SOURCES.txt`

 * *Files identical despite different names*

### Comparing `Ais-cryoET-1.0.24/PKG-INFO` & `Ais-cryoET-1.0.25/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: Ais-cryoET
-Version: 1.0.24
+Version: 1.0.25
 Summary: Segmentation of cryo-electron tomography data - https://ais-cryoet.readthedocs.org/ https://aiscryoet.org/
 Home-page: https://github.com/bionanopatterning/Ais
 Author: mgflast
 Author-email: m.g.f.last@lumc.nl
 License: GPL v3
 Platform: UNKNOWN
 Description-Content-Type: text/markdown
```

### Comparing `Ais-cryoET-1.0.24/README.md` & `Ais-cryoET-1.0.25/README.md`

 * *Files identical despite different names*

### Comparing `Ais-cryoET-1.0.24/setup.py` & `Ais-cryoET-1.0.25/setup.py`

 * *Files 1% similar despite different names*

```diff
@@ -8,15 +8,15 @@
 # twine upload dist/*
 
 with open("README.md", "r", encoding="utf-8") as f:
     long_description = f.read()
 
 setup(
     name='Ais-cryoET',
-    version='1.0.24',
+    version='1.0.25',
     packages=find_packages(),
     entry_points={'console_scripts': ['ais=Ais.main:main', 'ais-cryoet=Ais.main:main']},
     url='https://github.com/bionanopatterning/Ais',
     license='GPL v3',
     author='mgflast',
     author_email='m.g.f.last@lumc.nl',
     description='Segmentation of cryo-electron tomography data - https://ais-cryoet.readthedocs.org/ https://aiscryoet.org/',
```

